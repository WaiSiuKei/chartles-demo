var t=Object.defineProperty,e=(e,r,o)=>((e,r,o)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o)(e,"symbol"!=typeof r?r+"":r,o);import{aO as r,aj as o}from"./index-5gyre0hA.js";import{D as i}from"./toolPaneView-BkZhzbTB.js";import{P as s,r as n,c as a}from"./primitive-DimAP9Zo.js";import"./baseTool-BM5mqL4_.js";import"./formatter-BMswhHnL.js";import"./numericFormatter-DcPXx81O.js";import"./text-BFLAaZ9z.js";import"./priceLabelPriceAxisView-CKrbEFjY.js";import"./timeLabelTimeAxisView-DLVMuesT.js";import"./axisPaneView-B6qY_qE1.js";import"./text-BhorOBkg.js";import"./ctx-BQtFq0AI.js";import"./composite-CCMtJLBO.js";import"./line-BKuOqRrm.js";import"./rectangle-E0x1RaIQ.js";class c extends s{stopPrice(){return this.entryPrice()+this.properties().stopLevel/this.ownerSourceBase()}profitPrice(){return this.entryPrice()-this.properties().profitLevel/this.ownerSourceBase()}calculatePL(t){return this.entryPrice()-t}prepareStopPrice(t){t=this._roundPrice(t);const e=this.entryPrice()+1/this.ownerSourceBase();return Math.max(t,e)}prepareProfitPrice(t){t=this._roundPrice(t);const e=this.entryPrice()-1/this.ownerSourceBase();return Math.min(t,e)}_checkStopPrice(t){const e=this.stopPrice(),r=this.profitPrice(),{high:o,low:i}=t.customValues;return o>=e?e:i<=r?r:null}_amountTarget(t,e,r,o,i){const s=this._closePointCurrencyRate();return null===s?NaN:n(t+(r-e)*o*i/s)}_amountStop(t,e,r,o,i){const s=this._closePointCurrencyRate();return null===s?NaN:n(t-(e-r)*o*i/s)}}class p extends i{constructor(){super(...arguments),e(this,"type",r)}createPrimitive(t){const e=a(t);return new c({id:this.id,points:[],linecolor:"#808080",linewidth:1,textcolor:"#ffffff",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",fillBackground:!0,stopBackground:"#F23645",profitBackground:"#089981",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"#667b8b",compact:!1,riskDisplayMode:"percents",accountSize:1e3,lotSize:1,risk:25,alwaysShowStats:!1,showPriceLabels:!0,currency:"NONE",stopLevel:e,profitLevel:e,formatTextTarget:t=>this.chartService.invokeWithinContext((e=>e.get(o).t("tool.position.target",t))),formatTextStop:t=>this.chartService.invokeWithinContext((e=>e.get(o).t("tool.position.stop",t))),formatStatusAndPnl:t=>this.chartService.invokeWithinContext((e=>e.get(o).t("tool.position.pnl",t))),formatQty:t=>this.chartService.invokeWithinContext((e=>e.get(o).t("tool.position.qty",t))),formatRatio:t=>this.chartService.invokeWithinContext((e=>e.get(o).t("tool.position.ratio",t))),openText:this.chartService.invokeWithinContext((t=>t.get(o).t("tool.position.open"))),closeText:this.chartService.invokeWithinContext((t=>t.get(o).t("tool.position.close")))},...this.resetArgs)}}export{p as ShortPositionTool};
