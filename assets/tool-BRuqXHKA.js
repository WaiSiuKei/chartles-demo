var e=Object.defineProperty,t=(t,i,r)=>((t,i,r)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r)(t,"symbol"!=typeof i?i+"":i,r);import{y as i,z as r,u as s,A as n,cm as o,aM as l,e as a}from"./index-5gyre0hA.js";import{V as h,H as d}from"./text-BhorOBkg.js";import{g as c}from"./toolPaneView-BkZhzbTB.js";import{b as p,B as m,a as u}from"./textPaneView-LQytaZVw.js";import{T as x}from"./timeLabelTimeAxisView-DLVMuesT.js";import"./PlusTextRendererDecorator-h8tsWFCo.js";import{C as w}from"./composite-CCMtJLBO.js";import{V as _}from"./verticalLine-EvGXqPib.js";import{T as f}from"./renderer-CaYvdS1S.js";import"./text-BFLAaZ9z.js";import"./ctx-BQtFq0AI.js";import"./baseTool-BM5mqL4_.js";class g extends p{constructor(){super(...arguments),t(this,"_lineRenderer",new _),t(this,"_renderer",new w(this._hitTestCollector)),t(this,"_labelRenderer",new f(new i(r.MovePoint)))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const e=this.points();if(0===(null==e?void 0:e.length))return;const{mediaSize:{width:t,height:l}}=this._source.getScope(),a=this._source.properties();let h;this._placeHolderMode();let d=!0;const c={x:e[0].x,lineColor:a.linecolor,lineWidth:a.linewidth,lineStyle:a.linestyle,excludeBoundaries:h},p=c.lineWidth/2+1;if(d=d&&(c.x<-p||c.x>t+p),this._lineRenderer.setData(c),this._lineRenderer.setHitTest(new i(r.MovePoint,{})),this._renderer.insert(this._lineRenderer,0),!d&&1===e.length&&!this._isTextEditMode()){const t=new s(e[0].x,.9*l),i=new n(t,{pointIndex:0,resizeDirections:o});this._renderer.append(this.createLineAnchor({points:[i]},0))}}_needLabelExclusionPath(e){const t=this._source.properties(),i="horizontal"===t.textOrientation,r=t.text;if(i)return""!==r.trim();if("center"!==t.horzLabelsAlign)return!1;const s=e.getLinesInfo().lines;if(s.length%2==0)return!1;return""!==s[Math.floor(s.length/2)].text.trim()}}class b extends m{constructor(){super(...arguments),t(this,"_line",new g(this,this.model,this.editingHelper)),t(this,"_paneView",[this._line]),t(this,"_timeAxisViews",[new x(Object.create(null))])}pointsCount(){return 1}updateAllViews(){if(!this.controlPoints.length)return;const e=[];for(let t=0;t<this.controlPoints.length;t++){const i=this.controlPoints[t],r=this.pointToScreenPoint(i);if(!r)return;e.push(new n(r,{pointIndex:t}))}this.controlPoints.forEach(((t,i)=>{this._timeAxisViews[i].update(this._calculateTimeAxisViewData(t.time,e[i].x))})),this._paneView[0].update({points:e})}isCreationFinished(){return this._line.isCreationFinished()}startTextEditing(){return this._line.startTextEditing()}}class T extends u{constructor(){super(...arguments),t(this,"type",l)}createPrimitive(e){const t=c(e);return new b({id:this.id,points:[],linecolor:"#2962FF",linewidth:2,linestyle:0,extendLine:!0,showTime:!0,showLabel:!1,horzLabelsAlign:d.Center,vertLabelsAlign:h.Middle,textColor:"#2962FF",textOrientation:"vertical",fontSize:14,bold:!1,italic:!1,text:"",wordWrap:!0,placeholder:t.t("tool.text.common.addText")},...this.getTextResetArgs(e))}finishDrawing(){a(this._drawingSession).finishDrawing()}}export{T as VerticalLineTool};
