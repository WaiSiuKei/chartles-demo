var e=Object.defineProperty,t=(t,r,n)=>((t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n)(t,"symbol"!=typeof r?r+"":r,n);import{y as r,z as n,e as s,r as i,ag as o}from"./index-5gyre0hA.js";import{g as a,b as l}from"./formatter-BMswhHnL.js";import{L as d}from"./line-BKuOqRrm.js";import{B as f,b as h}from"./text-BhorOBkg.js";import{T as p}from"./toolPaneView-BkZhzbTB.js";var g=Object.defineProperty,c=Object.getOwnPropertyDescriptor;class m extends p{constructor(){super(...arguments),t(this,"_labelsRenderers",new Map),t(this,"_textRenderers",new Map),t(this,"_levelLineRenderers",new Map)}get _percentageFormatter(){return a()}get _numericFormatter(){return l()}getTextRenderer(e){let t=this._textRenderers.get(e);return t||(t=new f,this._labelsRenderers.set(e,t)),t}getLabelRenderer(e){let t=this._labelsRenderers.get(e);return t||(t=new f(new r(n.MovePoint)),this._labelsRenderers.set(e,t)),t}getLevelLineRenderer(e){return s(this._levelLineRenderers.has(e)?this._levelLineRenderers.get(e):this._levelLineRenderers.set(e,new d).get(e))}_updateLabelForLevel(e){const t=this.getLabelRenderer(e.levelIndex),r=this._source.properties(),n=Boolean(r.showCoeffs),s=Boolean(r.showPrices);if(!n&&!s)return null;const i=e.coeff;let o="";if(n){o+=r.coeffsAsPercents??!1?this._percentageFormatter.format(100*i,{signPositive:!1,tailSize:2}):this._numericFormatter.format(i)}return s&&(o+=" ("+e.price+")"),this._updateRendererLabel(e,t,o),t}_updateRendererLabel(e,t,r){if(!r&&void 0===e.decorator)return null;const{leftPoint:n,rightPoint:s,horzAlign:o,extendLeft:a,extendRight:l,...d}=e,[f,p]=h({horzAlign:o,extendLeft:a,extendRight:l,width:this._source.getScope().mediaSize.width,leftPoint:n,rightPoint:s});return t.setData({points:[f],text:r??"",horzAlign:p,offsetX:4,offsetY:0,fontFamily:i,fontSize:12,...d}),t}}((e,t,r)=>{for(var n,s=c(t,r),i=e.length-1;i>=0;i--)(n=e[i])&&(s=n(t,r,s)||s);s&&g(t,r,s)})([o],m.prototype,"_numericFormatter");export{m as F};
