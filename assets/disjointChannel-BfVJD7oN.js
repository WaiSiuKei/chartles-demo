var e=Object.defineProperty,t=(t,n,s)=>((t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s)(t,"symbol"!=typeof n?n+"":n,s);import{B as n,bM as s,c8 as r,c9 as i,bO as l,L as a,ca as d,e as o,u as c,cb as h,cc as u,cd as p,ce as _}from"./index-5gyre0hA.js";import{P as f}from"./parallelChannel-DC2OIzzc.js";class b extends n{constructor(){super(),t(this,"_parallelChannelRenderer"),t(this,"_intersectionRenderer"),t(this,"_selectedRenderer"),this._parallelChannelRenderer=new f,this._intersectionRenderer=new g,this._selectedRenderer=this._intersectionRenderer}setData(e){if(e.points.length<4)return;const[t,n,d,o]=e.points,c=s(t,n),h=s(d,o),u=r(t,n,d).distance,p=r(t,n,o).distance;if(c||h||u<1e-6&&p<1e-6)return void(this._selectedRenderer=null);null!==i(l(t,n),l(d,o))?(this._intersectionRenderer.setData(e),this._selectedRenderer=this._intersectionRenderer):(this._parallelChannelRenderer.setData({line1:{color:"rgba(0,0,0,0)",lineStyle:a.solid,lineWidth:0,points:[t,n]},line2:{color:"rgba(0,0,0,0)",lineStyle:a.solid,lineWidth:0,points:[o,d]},extendLeft:e.extendleft,extendRight:e.extendright,skipLines:!0,fillBackground:!0,backColor:e.backcolor,hittestOnBackground:e.hittestOnBackground}),this._selectedRenderer=this._parallelChannelRenderer)}hitTest(e,t){return this._selectedRenderer?this._selectedRenderer.hitTest(e,t):null}drawImpl(e){this._selectedRenderer&&this._selectedRenderer.drawImpl(e)}}class g extends n{hitTest(e){return this._data&&this._data.hittestOnBackground,null}drawImpl(e){return new d(e.context,e.mediaSize,e.bitmapSize).useMediaCoordinateSpace((e=>{if(!this._data||this._data.points.length<4)return;const t=e.context,n=this._data.backcolor;t.fillStyle=n;for(const s of this._visiblePolygons(e.mediaSize)){t.beginPath(),t.moveTo(s[0].x,s[0].y);for(let e=1;e<s.length;e++)t.lineTo(s[e].x,s[e].y);t.fill()}}))}_visiblePolygons(e){const t=o(this._data),[n,s,r,a]=t.points;if(e.width<=0||e.height<=0)return[];const d=i(l(n,s),l(r,a));if(null===d)return[];const u=[new c(0,0),new c(e.width,0),new c(e.width,e.height),new c(0,e.height)],p=[];{const e=n.subtract(s).add(d),i=a.subtract(r).add(d);let l=h(u,d,e,[i,i]);l=x(l,t),l=h(l,i,d,[e,e]),null!==l&&p.push(l)}{const e=s.subtract(n).add(d),i=r.subtract(a).add(d);let l=h(u,d,e,[i,i]);l=x(l,t),l=h(l,i,d,[e,e]),null!==l&&p.push(l)}return p}}function R(e,t,n){if(null===e)return null;const s=u(1,0,-n),r=p(s,new c(t,0));return _(e,r)}function x(e,t){const[n,s]=t.points;return t.extendleft||(e=R(e,n.x,s.x)),t.extendright||(e=R(e,s.x,n.x)),e}export{b as D};
