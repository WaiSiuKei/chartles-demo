var w3=Object.defineProperty;var Ru=ie=>{throw TypeError(ie)};var y3=(ie,te,ee)=>te in ie?w3(ie,te,{enumerable:!0,configurable:!0,writable:!0,value:ee}):ie[te]=ee;var Ee=(ie,te,ee)=>y3(ie,typeof te!="symbol"?te+"":te,ee),Qc=(ie,te,ee)=>te.has(ie)||Ru("Cannot "+ee);var Qr=(ie,te,ee)=>(Qc(ie,te,"read from private field"),ee?ee.call(ie):te.get(ie)),Mo=(ie,te,ee)=>te.has(ie)?Ru("Cannot add the same private member more than once"):te instanceof WeakSet?te.add(ie):te.set(ie,ee),Ho=(ie,te,ee,ne)=>(Qc(ie,te,"write to private field"),ne?ne.call(ie,ee):te.set(ie,ee),ee),Va=(ie,te,ee)=>(Qc(ie,te,"access private method"),ee);(function(){const te=document.createElement("link").relList;if(te&&te.supports&&te.supports("modulepreload"))return;for(const re of document.querySelectorAll('link[rel="modulepreload"]'))ne(re);new MutationObserver(re=>{for(const se of re)if(se.type==="childList")for(const ae of se.addedNodes)ae.tagName==="LINK"&&ae.rel==="modulepreload"&&ne(ae)}).observe(document,{childList:!0,subtree:!0});function ee(re){const se={};return re.integrity&&(se.integrity=re.integrity),re.referrerPolicy&&(se.referrerPolicy=re.referrerPolicy),re.crossOrigin==="use-credentials"?se.credentials="include":re.crossOrigin==="anonymous"?se.credentials="omit":se.credentials="same-origin",se}function ne(re){if(re.ep)return;re.ep=!0;const se=ee(re);fetch(re.href,se)}})();function findFirstIdxMonotonousOrArrLen(ie,te,ee=0,ne=ie.length){let re=ee,se=ne;for(;re<se;){const ae=Math.floor((re+se)/2);te(ie[ae])?se=ae:re=ae+1}return re}function coalesce(ie){return ie.filter(te=>!!te)}function topStep(ie,te,ee,ne,re){for(const se=ee.length;ne<re;ne++){const ae=ie[ne];if(te(ae,ee[se-1])<0){ee.pop();const le=findFirstIdxMonotonousOrArrLen(ee,ce=>te(ae,ce)<0);ee.splice(le,0,ae)}}}function top(ie,te,ee){const ne=ie.slice(0,ee).sort(te);return topStep(ie,te,ne,ee,ie.length),ne}function upperbound(ie,te,ee,ne=0,re=ie.length){let se=re-ne;for(;se>0;){const ae=se>>1,le=ne+ae;ee(te,ie[le])?se=ae:(ne=le+1,se-=ae+1)}return ne}function format$2(ie,te){let ee;return te.length===0?ee=ie:ee=ie.replace(/\{(\d+)\}/g,(ne,re)=>{const se=re[0];return typeof te[se]<"u"?te[se]:ne}),ee}function localize$1(ie,te,...ee){return format$2(te,ee)}const nls={localize:localize$1};function isString(ie){return typeof ie=="string"}function isFiniteNumber(ie){return typeof ie=="number"&&!isNaN(ie)}function isNumber$1(ie){return typeof ie=="number"}function isUndefined(ie){return typeof ie>"u"}function isDefined(ie){return!isUndefinedOrNull(ie)}function isUndefinedOrNull(ie){return isUndefined(ie)||ie===null}function illegalState(ie){return new Error(`Illegal state: ${ie}`)}class ErrorHandler{constructor(){Ee(this,"unexpectedErrorHandler");Ee(this,"listeners");this.listeners=[],this.unexpectedErrorHandler=function(te){setTimeout(()=>{throw te.stack?new Error(te.message+`

`+te.stack):te},0)}}addListener(te){return this.listeners.push(te),()=>{this._removeListener(te)}}emit(te){this.listeners.forEach(ee=>{ee(te)})}_removeListener(te){this.listeners.splice(this.listeners.indexOf(te),1)}setUnexpectedErrorHandler(te){this.unexpectedErrorHandler=te}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(te){this.unexpectedErrorHandler(te),this.emit(te)}onUnexpectedExternalError(te){this.unexpectedErrorHandler(te)}}const errorHandler=new ErrorHandler;function onUnexpectedError(ie){isCancellationError(ie)||errorHandler.onUnexpectedError(ie)}const canceledName="Canceled";function isCancellationError(ie){return ie instanceof CancellationError?!0:ie instanceof Error&&ie.name===canceledName&&ie.message===canceledName}function illegalArgument(ie){return new Error(`Illegal argument: ${ie}`)}class CancellationError extends Error{constructor(){super(canceledName),this.name=this.message}}class BugIndicatingError extends Error{constructor(te){super(te||"An unexpected bug occurred."),Object.setPrototypeOf(this,BugIndicatingError.prototype)}}function NOTREACHED(...ie){throw ie.length&&console.error(...ie),new Error("not reached")}function NOTIMPLEMENTED(...ie){ie.length&&console.error(...ie)}function toErrorMessage(ie=null,te=!1){if(!ie)return nls.localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(ie)){const ee=coalesce(ie),ne=toErrorMessage(ee[0],te);return ee.length>1?nls.localize("error.moreErrors","{0} ({1} errors in total)",ne,ee.length):ne}if(isString(ie))return ie;if(ie.detail){const ee=ie.detail;if(ee.error)return exceptionToErrorMessage(ee.error,te);if(ee.exception)return exceptionToErrorMessage(ee.exception,te)}return ie.stack?exceptionToErrorMessage(ie,te):ie.message?ie.message:nls.localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function exceptionToErrorMessage(ie,te){return te&&(ie.stack||ie.stacktrace)?nls.localize("stackTrace.format","{0}: {1}",detectSystemErrorMessage(ie),stackToString(ie.stack)||stackToString(ie.stacktrace)):detectSystemErrorMessage(ie)}function stackToString(ie){return Array.isArray(ie)?ie.join(`
`):ie}function detectSystemErrorMessage(ie){return ie.message||nls.localize("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}const{userAgent:userAgent$1}=navigator,isWindows=userAgent$1.indexOf("Windows")>=0,isMacintosh=userAgent$1.indexOf("Macintosh")>=0;userAgent$1.indexOf("Linux")>=0;const isMobile=userAgent$1.indexOf("Mobi")>=0,isIOS=(userAgent$1.indexOf("Macintosh")>=0||userAgent$1.indexOf("iPad")>=0||userAgent$1.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,isAndroid=!!(userAgent$1&&userAgent$1.indexOf("Android")>=0);var OperatingSystem=(ie=>(ie[ie.Windows=1]="Windows",ie[ie.Macintosh=2]="Macintosh",ie[ie.Linux=3]="Linux",ie))(OperatingSystem||{});const OS=isMacintosh||isIOS?2:isWindows?1:3,$globalThis=globalThis,setTimeout0IsFaster=typeof $globalThis.postMessage=="function"&&!$globalThis.importScripts,setTimeout0=(()=>{if(setTimeout0IsFaster){const ie=[];$globalThis.addEventListener("message",ee=>{if(ee.data&&ee.data.vscodeScheduleAsyncWork)for(let ne=0,re=ie.length;ne<re;ne++){const se=ie[ne];if(se.id===ee.data.vscodeScheduleAsyncWork){ie.splice(ne,1),se.callback();return}}});let te=0;return ee=>{const ne=++te;ie.push({id:ne,callback:ee}),$globalThis.postMessage({vscodeScheduleAsyncWork:ne},"*")}}return ie=>setTimeout(ie)})();let _runWhenIdle;class IdleDeadline{constructor(te,ee){this.didTimeout=te,this.timeRemaining=ee}}(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?_runWhenIdle=(ie,te,ee)=>{setTimeout0(()=>{if(ne)return;const re=Date.now()+15,se=new IdleDeadline(!0,()=>Math.max(0,re-Date.now()));te(Object.freeze(se))});let ne=!1;return{dispose(){ne||(ne=!0)}}}:_runWhenIdle=(ie,te,ee)=>{const ne=ie.requestIdleCallback(te,typeof ee=="number"?{timeout:ee}:void 0);let re=!1;return{dispose(){re||(re=!0,ie.cancelIdleCallback(ne))}}}})();class AbstractIdleValue{constructor(te,ee){Ee(this,"_executor");Ee(this,"_handle");Ee(this,"_didRun",!1);Ee(this,"_value");Ee(this,"_error");this._executor=()=>{try{this._value=ee()}catch(ne){this._error=ne}finally{this._didRun=!0}},this._handle=_runWhenIdle(te,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class GlobalIdleValue extends AbstractIdleValue{constructor(te){super(globalThis,te)}}class DeferredPromise{constructor(){Ee(this,"completeCallback");Ee(this,"errorCallback");Ee(this,"outcome");Ee(this,"p");this.p=new Promise((te,ee)=>{this.completeCallback=te,this.errorCallback=ee})}get isRejected(){var te;return((te=this.outcome)==null?void 0:te.outcome)===1}get isResolved(){var te;return((te=this.outcome)==null?void 0:te.outcome)===0}get isSettled(){return!!this.outcome}get value(){var te,ee;return((te=this.outcome)==null?void 0:te.outcome)===0?(ee=this.outcome)==null?void 0:ee.value:void 0}complete(te){return new Promise(ee=>{this.completeCallback(te),this.outcome={outcome:0,value:te},ee()})}error(te){return new Promise(ee=>{this.errorCallback(te),this.outcome={outcome:1,value:te},ee()})}cancel(){return this.error(new CancellationError)}}class Barrier{constructor(){Ee(this,"_isOpen");Ee(this,"_promise");Ee(this,"_completePromise");this._isOpen=!1,this._promise=new Promise(te=>{this._completePromise=te})}isOpen(){return this._isOpen}open(){this._isOpen=!0,this._completePromise(!0)}wait(){return this._promise}}class RunOnceScheduler{constructor(te,ee){Ee(this,"runner");Ee(this,"timeoutToken");Ee(this,"timeout");Ee(this,"timeoutHandler");this.timeoutToken=-1,this.runner=te,this.timeout=ee,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(te=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,te)}get delay(){return this.timeout}set delay(te){this.timeout=te}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){var te;(te=this.runner)==null||te.call(this)}}var Promises;(ie=>{async function te(ee){let ne;const re=await Promise.all(ee.map(se=>se.then(ae=>ae,ae=>{ne||(ne=ae)})));if(typeof ne<"u")throw ne;return re}ie.settled=te})(Promises||(Promises={}));function wait(ie){return new Promise(te=>{setTimeout(()=>te(),ie)})}function tick$1(ie){Promise.resolve().then(()=>ie())}class IntervalCounter{constructor(te,ee=()=>Date.now()){Ee(this,"lastIncrementTime",0);Ee(this,"value",0);this.interval=te,this.nowFn=ee}increment(){const te=this.nowFn();return te-this.lastIncrementTime>this.interval&&(this.lastIncrementTime=te,this.value=0),this.value++,this.value}}class GenericRegistry{constructor(){Ee(this,"map",new Map)}add(te){const ee=te.id;this.map.has(ee)&&NOTIMPLEMENTED(),this.map.set(ee,te)}remove(te){this.map.delete(te)}has(te){return this.map.has(te)}value(te){return this.map.get(te)}values(){return Array.from(this.map.values())}dispose(){this.map.clear()}}var ChartStyleType=(ie=>(ie[ie.Bar=0]="Bar",ie[ie.Candle=1]="Candle",ie[ie.Line=2]="Line",ie[ie.Area=3]="Area",ie[ie.HollowCandle=9]="HollowCandle",ie))(ChartStyleType||{});const chartStyleRegistry=new class extends GenericRegistry{};function isOhlcSeries(ie){return[0,1,9].includes(ie)}const iconArea=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="m25.35 5.35-9.5 9.5-.35.36-.35-.36-4.65-4.64-8.15 8.14-.7-.7 8.5-8.5.35-.36.35.36 4.65 4.64 9.15-9.14.7.7ZM2 21h1v1H2v-1Zm2-1H3v1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1V9h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v-1h-1v-1h-1v-1h-1v-1h-1v-1h-1v1H9v1H8v1H7v1H6v1H5v1H4v1Zm1 0v1H4v-1h1Zm1 0H5v-1h1v1Zm1 0v1H6v-1h1Zm0-1H6v-1h1v1Zm1 0H7v1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v1h1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v1h-1v-1h-1v-1h-1v-1h-1v-1h-1v-1h-1v1H9v1H8v1H7v1h1v1Zm1 0v1H8v-1h1Zm0-1H8v-1h1v1Zm1 0H9v1h1v1h1v-1h1v1h1v-1h1v1h1v-1h-1v-1h-1v-1h-1v-1h-1v-1h-1v1H9v1h1v1Zm1 0v1h-1v-1h1Zm0-1v-1h-1v1h1Zm0 0v1h1v1h1v-1h-1v-1h-1Zm6 2v-1h1v1h-1Zm2 0v1h-1v-1h1Zm0-1h-1v-1h1v1Zm1 0h-1v1h1v1h1v-1h1v1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v-1h1v-1h-1v1h-1v1h-1v1h-1v1h1v1Zm1 0h-1v1h1v-1Zm0-1h1v1h-1v-1Zm0-1h1v-1h-1v1Zm0 0v1h-1v-1h1Zm-4 3v1h-1v-1h1Z"></path></svg>
`,iconBar=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M19 6h-1v7h-3v1h3v8h1v-3h3v-1h-3V6ZM11 7h-1v13H7v1h3v2h1V10h3V9h-3V7Z"></path></svg>
`,iconCandle=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path d="M17 11v6h3v-6h-3zm-.5-1h4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5z"></path><path d="M18 7h1v3.5h-1zm0 10.5h1V21h-1z"></path><path d="M9 8v12h3V8H9zm-.5-1h4a.5.5 0 0 1 .5.5v13a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 .5-.5z"></path><path d="M10 4h1v3.5h-1zm0 16.5h1V24h-1z"></path></svg>
`,iconHollowCandle=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path d="M17 11v6h3v-6h-3zm-.5-1h4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5z"></path><path d="M18 7h1v3.5h-1zm0 10.5h1V21h-1z"></path><path d="M9 8v11h3V8H9zm-.5-1h4a.5.5 0 0 1 .5.5v12a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5v-12a.5.5 0 0 1 .5-.5z"></path><path d="M10 4h1v5h-1zm0 14h1v5h-1zM8.5 9H10v1H8.5zM11 9h1.5v1H11zm-1 1h1v1h-1zm-1.5 1H10v1H8.5zm2.5 0h1.5v1H11zm-1 1h1v1h-1zm-1.5 1H10v1H8.5zm2.5 0h1.5v1H11zm-1 1h1v1h-1zm-1.5 1H10v1H8.5zm2.5 0h1.5v1H11zm-1 1h1v1h-1zm-1.5 1H10v1H8.5zm2.5 0h1.5v1H11z"></path></svg>
`,iconLine=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="m25.39 7.31-8.83 10.92-6.02-5.47-7.16 8.56-.76-.64 7.82-9.36 6 5.45L24.61 6.7l.78.62Z"></path></svg>
`,chartStylePreset=[{id:ChartStyleType.Bar,icon:iconBar,label:"chartStyle.bar"},{id:ChartStyleType.Candle,icon:iconCandle,label:"chartStyle.candle"},{id:ChartStyleType.HollowCandle,icon:iconHollowCandle,label:"chartStyle.hollowCandle"},{id:ChartStyleType.Line,icon:iconLine,label:"chartStyle.line"},{id:ChartStyleType.Area,icon:iconArea,label:"chartStyle.area"}];chartStylePreset.forEach(ie=>{chartStyleRegistry.add(ie)});const chartLayoutRegistry=new class extends GenericRegistry{},i1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" d="M2.5 1C1.67 1 1 1.67 1 2.5v12c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5h-14ZM0 2.5A2.5 2.5 0 0 1 2.5 0h14A2.5 2.5 0 0 1 19 2.5v12a2.5 2.5 0 0 1-2.5 2.5h-14A2.5 2.5 0 0 1 0 14.5v-12Z"></path></svg>
`,i2_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v15H2.5A1.5 1.5 0 0 1 1 14.5v-12ZM10 16h6.5c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5H10v15ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i2_2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1h14c.83 0 1.5.67 1.5 1.5V8H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V9H1Zm1.5-9A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i3_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1h14c.83 0 1.5.67 1.5 1.5V5H1V2.5ZM1 6v5h17V6H1Zm17 6H1v2.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V12ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i3_2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H6v15H2.5A1.5 1.5 0 0 1 1 14.5v-12ZM7 16h5V1H7v15Zm6-15v15h3.5c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5H13ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i3_3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v15H2.5A1.5 1.5 0 0 1 1 14.5v-12ZM10 16h6.5c.83 0 1.5-.67 1.5-1.5V9h-8v7Zm8-8V2.5c0-.83-.67-1.5-1.5-1.5H10v7h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i3_4=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v7H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V9H1Zm17-1V2.5c0-.83-.67-1.5-1.5-1.5H10v7h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i3_5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1h14c.83 0 1.5.67 1.5 1.5V8H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H9V9H1Zm9 7h6.5c.83 0 1.5-.67 1.5-1.5V9h-8v7ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i3_6=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v7H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H9V9H1Zm9 7h6.5c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5H10v15ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v7H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H9V9H1Zm9 7h6.5c.83 0 1.5-.67 1.5-1.5V9h-8v7Zm8-8V2.5c0-.83-.67-1.5-1.5-1.5H10v7h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H4v15H2.5A1.5 1.5 0 0 1 1 14.5v-12ZM5 16h4V1H5v15Zm5-15v15h4V1h-4Zm5 0v15h1.5c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5H15ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1h14c.83 0 1.5.67 1.5 1.5V4H1V2.5ZM1 5v3h17V5H1Zm17 4H1v3h17V9Zm0 4H1v1.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V13ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_4=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v15H2.5A1.5 1.5 0 0 1 1 14.5v-12ZM10 16h6.5c.83 0 1.5-.67 1.5-1.5V12h-8v4Zm8-5V6h-8v5h8Zm0-6V2.5c0-.83-.67-1.5-1.5-1.5H10v4h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M2 3.5C2 2.67 2.67 2 3.5 2H11v4H2V3.5ZM2 7v5h9V7H2Zm0 6v2.5c0 .83.67 1.5 1.5 1.5H11v-4H2Zm10 4h5.5c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5H12v15ZM3.5 1A2.5 2.5 0 0 0 1 3.5v12A2.5 2.5 0 0 0 3.5 18h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 17.5 1h-14Z"></path></svg>
`,i4_6=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1h14c.83 0 1.5.67 1.5 1.5V8H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H6V9H1Zm6 7h5V9H7v7Zm6 0h3.5c.83 0 1.5-.67 1.5-1.5V9h-5v7ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_7=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v7H1V2.5ZM1 9v3h17V9H1Zm17-1V2.5c0-.83-.67-1.5-1.5-1.5H10v7h8Zm0 5H1v1.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V13ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i4_8=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M3.5 2C2.67 2 2 2.67 2 3.5v12c0 .83.67 1.5 1.5 1.5H6V2H3.5ZM11 17H7V2h4v15Zm1 0h5.5c.83 0 1.5-.67 1.5-1.5V10h-7v7Zm7-8V3.5c0-.83-.67-1.5-1.5-1.5H12v7h7ZM1 3.5A2.5 2.5 0 0 1 3.5 1h14A2.5 2.5 0 0 1 20 3.5v12a2.5 2.5 0 0 1-2.5 2.5h-14A2.5 2.5 0 0 1 1 15.5v-12Z"></path></svg>
`,i5_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1h14c.83 0 1.5.67 1.5 1.5V8H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H4V9H1Zm4 7h4V9H5v7Zm5 0h4V9h-4v7Zm5 0h1.5c.83 0 1.5-.67 1.5-1.5V9h-3v7ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i5_2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v15H2.5A1.5 1.5 0 0 1 1 14.5v-12ZM10 16h6.5c.83 0 1.5-.67 1.5-1.5V13h-8v3Zm8-4V9h-8v3h8Zm0-4V5h-8v3h8Zm0-4V2.5c0-.83-.67-1.5-1.5-1.5H10v3h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i5_3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v7H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H6V9H1Zm6 7h5V9H7v7Zm6 0h3.5c.83 0 1.5-.67 1.5-1.5V9h-5v7Zm5-8V2.5c0-.83-.67-1.5-1.5-1.5H10v7h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i5_4=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M2 3.5C2 2.67 2.67 2 3.5 2H7v7H2V3.5ZM2 10v5.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V10h-8v7h-1v-7H2Zm17-1V3.5c0-.83-.67-1.5-1.5-1.5H14v7h5Zm-6-7H8v7h5V2ZM3.5 1A2.5 2.5 0 0 0 1 3.5v12A2.5 2.5 0 0 0 3.5 18h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 17.5 1h-14Z"></path></svg>
`,i5_5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M19 3.5c0-.83-.67-1.5-1.5-1.5H17v15h.5c.83 0 1.5-.67 1.5-1.5v-12Zm-17 12c0 .83.67 1.5 1.5 1.5H4V2h-.5C2.67 2 2 2.67 2 3.5v12ZM1.01 3.24A2.5 2.5 0 0 1 3.5 1h14A2.5 2.5 0 0 1 20 3.5v12a2.5 2.5 0 0 1-2.5 2.5h-14A2.5 2.5 0 0 1 1 15.5v-12l.01-.26ZM5 17h3V2H5v15Zm11 0h-3V2h3v15ZM12 2v15H9V2h3Z"></path></svg>
`,i5_6=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 3.5A2.5 2.5 0 0 1 3.5 1h14A2.5 2.5 0 0 1 20 3.5v12a2.5 2.5 0 0 1-2.5 2.5h-14A2.5 2.5 0 0 1 1 15.5v-12ZM3.5 2h14c.83 0 1.5.67 1.5 1.5V4H2v-.5C2 2.67 2.67 2 3.5 2ZM2 5v2h17V5H2Zm17 3H2v3h17V8Zm0 4H2v2h17v-2Zm0 3H2v.5c0 .83.67 1.5 1.5 1.5h14c.83 0 1.5-.67 1.5-1.5V15Z"></path></svg>
`,i6_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H6v7H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H6V9H1Zm6 7h5V9H7v7Zm6 0h3.5c.83 0 1.5-.67 1.5-1.5V9h-5v7Zm5-8V2.5c0-.83-.67-1.5-1.5-1.5H13v7h5Zm-6-7H7v7h5V1ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i6_2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v4H1V2.5ZM1 6v5h8V6H1Zm0 6v2.5c0 .83.67 1.5 1.5 1.5H9v-4H1Zm9 4h6.5c.83 0 1.5-.67 1.5-1.5V12h-8v4Zm8-5V6h-8v5h8Zm0-6V2.5c0-.83-.67-1.5-1.5-1.5H10v4h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i6_3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 3.5A2.5 2.5 0 0 1 3.5 1h14A2.5 2.5 0 0 1 20 3.5v12a2.5 2.5 0 0 1-2.5 2.5h-14A2.5 2.5 0 0 1 1 15.5v-12ZM11 2h6.5c.83 0 1.5.67 1.5 1.5V9h-8V2Zm-1 0H3.5C2.67 2 2 2.67 2 3.5V9h8V2Zm-8 8v5.5c0 .83.67 1.5 1.5 1.5H5v-7H2Zm4 7h4v-7H6v7Zm5 0h4v-7h-4v7Zm5 0h1.5c.83 0 1.5-.67 1.5-1.5V10h-3v7Z"></path></svg>
`,i6_4=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M2 3.5C2 2.67 2.67 2 3.5 2H4v15h-.5A1.5 1.5 0 0 1 2 15.5v-12ZM5 17h2V2H5v15ZM8 2v15h2V2H8Zm3 0v15h2V2h-2Zm3 0v15h2V2h-2Zm3 0v15h.5c.83 0 1.5-.67 1.5-1.5v-12c0-.83-.67-1.5-1.5-1.5H17ZM3.5 1A2.5 2.5 0 0 0 1 3.5v12A2.5 2.5 0 0 0 3.5 18h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 17.5 1h-14Z"></path></svg>
`,i6_5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19" fill="none"><rect width="18" height="16" stroke="currentColor" rx="2" x="1.5" y="1.5"></rect><path fill="currentColor" d="M1.5 4h18v1h-18V4Z"></path><path fill="currentColor" d="M2 7h18v1H2V7Z" opacity=".65"></path><path fill="currentColor" d="M1.5 10h18v1h-18v-1Z" opacity=".25"></path><path fill="currentColor" d="M1.5 13h18v1h-18v-1Z" opacity=".05"></path></svg>
`,i7_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19" fill="none"><rect width="18" height="16" stroke="currentColor" rx="2" x="1.5" y="1.5"></rect><path fill="currentColor" d="M4 17V2h1v15H4Z"></path><path fill="currentColor" d="M7 17V2h1v15H7Z" opacity=".85"></path><path fill="currentColor" d="M10 17V2h1v15h-1Z" opacity=".65"></path><path fill="currentColor" d="M13 17V2h1v15h-1Z" opacity=".25"></path><path fill="currentColor" d="M16 17V2h1v15h-1Z" opacity=".05"></path></svg>
`,i8_1=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H4v7H1V2.5ZM1 9v5.5c0 .83.67 1.5 1.5 1.5H4V9H1Zm4 7h4V9H5v7Zm5 0h4V9h-4v7Zm5 0h1.5c.83 0 1.5-.67 1.5-1.5V9h-3v7Zm3-8V2.5c0-.83-.67-1.5-1.5-1.5H15v7h3Zm-4-7h-4v7h4V1ZM9 1H5v7h4V1ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i8_2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 21 19" width="21" height="19"><path fill="currentColor" fill-rule="evenodd" d="M1 2.5C1 1.67 1.67 1 2.5 1H9v3H1V2.5ZM1 5v3h8V5H1Zm0 4v3h8V9H1Zm0 4v1.5c0 .83.67 1.5 1.5 1.5H9v-3H1Zm9 3h6.5c.83 0 1.5-.67 1.5-1.5V13h-8v3Zm8-4V9h-8v3h8Zm0-4V5h-8v3h8Zm0-4V2.5c0-.83-.67-1.5-1.5-1.5H10v3h8ZM2.5 0A2.5 2.5 0 0 0 0 2.5v12A2.5 2.5 0 0 0 2.5 17h14a2.5 2.5 0 0 0 2.5-2.5v-12A2.5 2.5 0 0 0 16.5 0h-14Z"></path></svg>
`,i8_3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19" fill="none"><rect width="18" height="16" stroke="currentColor" rx="2" x="1.5" y="1.5"></rect><path fill="currentColor" d="M4 17V2h1v15H4Z"></path><path fill="currentColor" d="M7 17V2h1v15H7Z" opacity=".85"></path><path fill="currentColor" d="M10 17V2h1v15h-1Z" opacity=".65"></path><path fill="currentColor" d="M13 17V2h1v15h-1Z" opacity=".25"></path><path fill="currentColor" d="M16 17V2h1v15h-1Z" opacity=".05"></path></svg>
`,i8_4=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 19" width="21" height="19" fill="none"><rect width="18" height="16" stroke="currentColor" rx="2" x="1.5" y="1.5"></rect><path fill="currentColor" d="M1.5 4h18v1h-18V4Z"></path><path fill="currentColor" d="M2 7h18v1H2V7Z" opacity=".65"></path><path fill="currentColor" d="M1.5 10h18v1h-18v-1Z" opacity=".25"></path><path fill="currentColor" d="M1.5 13h18v1h-18v-1Z" opacity=".05"></path></svg>
`,layoutPresets={1:[{id:"s",slotCount:1,icon:i1,layout:{gridTemplate:`
"a"`}}],2:[{id:"2h",slotCount:2,icon:i2_1,layout:{gridTemplate:`
"a b"`}},{id:"2v",slotCount:2,icon:i2_2,layout:{gridTemplate:`
"a"
"b"`}}],3:[{id:"3v",slotCount:3,icon:i3_1,layout:{gridTemplate:`
"a"
"b"
"c"`}},{id:"3h",slotCount:3,icon:i3_2,layout:{gridTemplate:`
"a b c"`}},{id:"3s",slotCount:3,icon:i3_3,layout:{gridTemplate:`
"a b"
"a c"`}},{id:"2-1",slotCount:3,icon:i3_4,layout:{gridTemplate:`
"a b"
"c c"`}},{id:"1-2",slotCount:3,icon:i3_5,layout:{gridTemplate:`
"a a"
"b c"`}},{id:"3r",slotCount:3,icon:i3_6,layout:{gridTemplate:`
"a c"
"b c"`}}],4:[{id:"4",slotCount:4,icon:i4_1,layout:{gridTemplate:`
"a b"
"c d"`}},{id:"4h",slotCount:4,icon:i4_2,layout:{gridTemplate:`
"a b c d"`}},{id:"4v",slotCount:4,icon:i4_3,layout:{gridTemplate:`
"a"
"b"
"c"
"d"`}},{id:"4s",slotCount:4,icon:i4_4,layout:{gridTemplate:`
"a b"
"a c"
"a d"`}},{id:"4s-l",slotCount:4,icon:i4_5,layout:{gridTemplate:`
"a d"
"b d"
"c d"`}},{id:"1-3",slotCount:4,icon:i4_6,layout:{gridTemplate:`
"a a a"
"b c d"`}},{id:"2-2",slotCount:4,icon:i4_7,layout:{gridTemplate:`
"a b" 2fr
"c c" 1fr
"d d" 1fr
`}},{id:"2-2-l",slotCount:4,icon:i4_8,layout:{gridTemplate:`
"a b c"
"a b d" / 1fr 1fr 2fr
`}}],5:[{id:"1-4",slotCount:5,icon:i5_1,layout:{gridTemplate:`
"a a a a"
"b c d e"
`}},{id:"5s",slotCount:5,icon:i5_2,layout:{gridTemplate:`
"a b"
"a c"
"a d"
"a e"
`}},{id:"2-3",slotCount:5,icon:i5_3,layout:{gridTemplate:`
"a a a b b b"
"c c d d e e"`}},{id:"3-2",slotCount:5,icon:i5_4,layout:{gridTemplate:`
"a a b b c c"
"d d d e e e"`}},{id:"5h",slotCount:5,icon:i5_5,layout:{gridTemplate:`
"a b c d e"`}},{id:"5v",slotCount:5,icon:i5_6,layout:{gridTemplate:`
"a"
"b"
"c"
"d"
"e"
`}}],6:[{id:"6",slotCount:6,icon:i6_1,layout:{gridTemplate:`
"a b c"
"d e f"`}},{id:"6c",slotCount:6,icon:i6_2,layout:{gridTemplate:`
"a b"
"c d"
"e f"`}},{id:"2-4",slotCount:6,icon:i6_3,layout:{gridTemplate:`
"a a b b"
"c d e f"`}},{id:"6h",slotCount:6,icon:i6_4,layout:{gridTemplate:`
"a b c d e f"`}},{id:"6v",slotCount:6,icon:i6_5,layout:{gridTemplate:`
"a"
"b"
"c"
"d"
"e"
"f"`}}],7:[{id:"7h",slotCount:7,icon:i7_1,layout:{gridTemplate:`
"a b c d e f g"`}}],8:[{id:"8",slotCount:8,icon:i8_1,layout:{gridTemplate:`
"a b c d"
"e f g h"
`}},{id:"8c",slotCount:8,icon:i8_2,layout:{gridTemplate:`
"a b"
"c d"
"e f"
"g h"
`}},{id:"8h",slotCount:8,icon:i8_3,layout:{gridTemplate:`
"a b c d e f g h"`}},{id:"8v",slotCount:8,icon:i8_4,layout:{gridTemplate:`
"a"
"b"
"c"
"d"
"e"
"f"
"g"
"h"`}}],length:9};Array.from(layoutPresets).forEach(ie=>{ie&&ie.forEach(te=>{chartLayoutRegistry.add(te)})});var KeyCode=(ie=>(ie[ie.Unknown=0]="Unknown",ie[ie.Backspace=8]="Backspace",ie[ie.Tab=9]="Tab",ie[ie.Enter=13]="Enter",ie[ie.Shift=16]="Shift",ie[ie.Ctrl=17]="Ctrl",ie[ie.Alt=18]="Alt",ie[ie.Esc=27]="Esc",ie[ie.Space=32]="Space",ie[ie.LeftArrow=37]="LeftArrow",ie[ie.UpArrow=38]="UpArrow",ie[ie.RightArrow=39]="RightArrow",ie[ie.DownArrow=40]="DownArrow",ie[ie.Delete=46]="Delete",ie[ie.Digit0=48]="Digit0",ie[ie.Digit1=49]="Digit1",ie[ie.Digit2=50]="Digit2",ie[ie.Digit3=51]="Digit3",ie[ie.Digit4=52]="Digit4",ie[ie.Digit5=53]="Digit5",ie[ie.Digit6=54]="Digit6",ie[ie.Digit7=55]="Digit7",ie[ie.Digit8=56]="Digit8",ie[ie.Digit9=57]="Digit9",ie[ie.KeyA=65]="KeyA",ie[ie.KeyB=66]="KeyB",ie[ie.KeyC=67]="KeyC",ie[ie.KeyD=68]="KeyD",ie[ie.KeyE=69]="KeyE",ie[ie.KeyF=70]="KeyF",ie[ie.KeyG=71]="KeyG",ie[ie.KeyH=72]="KeyH",ie[ie.KeyI=73]="KeyI",ie[ie.KeyJ=74]="KeyJ",ie[ie.KeyK=75]="KeyK",ie[ie.KeyL=76]="KeyL",ie[ie.KeyM=77]="KeyM",ie[ie.KeyN=78]="KeyN",ie[ie.KeyO=79]="KeyO",ie[ie.KeyP=80]="KeyP",ie[ie.KeyQ=81]="KeyQ",ie[ie.KeyR=82]="KeyR",ie[ie.KeyS=83]="KeyS",ie[ie.KeyT=84]="KeyT",ie[ie.KeyU=85]="KeyU",ie[ie.KeyV=86]="KeyV",ie[ie.KeyW=87]="KeyW",ie[ie.KeyX=88]="KeyX",ie[ie.KeyY=89]="KeyY",ie[ie.KeyZ=90]="KeyZ",ie[ie.Meta=91]="Meta",ie[ie.Equal=187]="Equal",ie[ie.Minus=189]="Minus",ie[ie.Slash=191]="Slash",ie[ie.Backslash=220]="Backslash",ie))(KeyCode||{}),KeyMod=(ie=>(ie[ie.CtrlCmd=2048]="CtrlCmd",ie[ie.Shift=1024]="Shift",ie[ie.Alt=512]="Alt",ie[ie.WinCtrl=256]="WinCtrl",ie))(KeyMod||{});const keyCodeToChar={8:"Backspace",9:"Tab",13:"Enter",46:"Del",27:"Esc",32:"Space",37:"←",39:"→",38:"↑",40:"↓",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",189:"-",187:"=",191:"/"};var KeyCodeUtils;(ie=>{function te(ee){return keyCodeToChar[ee]}ie.toString=te})(KeyCodeUtils||(KeyCodeUtils={}));function decodeKeybinding(ie,te=OS){if(typeof ie=="number"){if(ie===0)return null;const ee=(ie&65535)>>>0,ne=(ie&4294901760)>>>16;return ne!==0?new Keybinding([createSimpleKeybinding(ee,te),createSimpleKeybinding(ne,te)]):new Keybinding([createSimpleKeybinding(ee,te)])}else{const ee=[];for(let ne=0;ne<ie.length;ne++)ee.push(createSimpleKeybinding(ie[ne],te));return new Keybinding(ee)}}function createSimpleKeybinding(ie,te){const ee=!!(ie&2048),ne=!!(ie&256),re=te===OperatingSystem.Macintosh?ne:ee,se=!!(ie&1024),ae=!!(ie&512),le=te===OperatingSystem.Macintosh?ee:ne,ce=ie&255;return new KeyCodeChord(re,se,ae,le,ce)}class KeyCodeChord{constructor(te,ee,ne,re,se){this.ctrlKey=te,this.shiftKey=ee,this.altKey=ne,this.metaKey=re,this.keyCode=se}equals(te){return te instanceof KeyCodeChord&&this.ctrlKey===te.ctrlKey&&this.shiftKey===te.shiftKey&&this.altKey===te.altKey&&this.metaKey===te.metaKey&&this.keyCode===te.keyCode}getHashCode(){const te=this.ctrlKey?"1":"0",ee=this.shiftKey?"1":"0",ne=this.altKey?"1":"0",re=this.metaKey?"1":"0";return`K${te}${ee}${ne}${re}${this.keyCode}`}isModifierKey(){return this.keyCode===KeyCode.Unknown||this.keyCode===KeyCode.Ctrl||this.keyCode===KeyCode.Meta||this.keyCode===KeyCode.Alt||this.keyCode===KeyCode.Shift}toKeybinding(){return new Keybinding([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===KeyCode.Ctrl||this.shiftKey&&this.keyCode===KeyCode.Shift||this.altKey&&this.keyCode===KeyCode.Alt||this.metaKey&&this.keyCode===KeyCode.Meta}}class Keybinding{constructor(te){Ee(this,"chords");if(te.length===0)throw illegalArgument("chords");this.chords=te}getHashCode(){let te="";for(let ee=0,ne=this.chords.length;ee<ne;ee++)ee!==0&&(te+=";"),te+=this.chords[ee].getHashCode();return te}equals(te){if(te===null||this.chords.length!==te.chords.length)return!1;for(let ee=0;ee<this.chords.length;ee++)if(!this.chords[ee].equals(te.chords[ee]))return!1;return!0}}const userAgent=navigator.userAgent,isFirefox=userAgent.indexOf("Firefox")>=0,isWebKit=userAgent.indexOf("AppleWebKit")>=0,isChrome=userAgent.indexOf("Chrome")>=0;!isChrome&&userAgent.indexOf("Safari")>=0;userAgent.indexOf("Electron/")>=0;function extractKeyCode(ie){const te=ie.keyCode;if(te!==3){if(!isFirefox){if(isWebKit){if(isMacintosh&&te===93)return KeyCode.Meta;if(!isMacintosh&&te===92)return KeyCode.Meta}}}return te}const ctrlKeyMod=isMacintosh?KeyMod.WinCtrl:KeyMod.CtrlCmd,altKeyMod=KeyMod.Alt,shiftKeyMod=KeyMod.Shift,metaKeyMod=isMacintosh?KeyMod.CtrlCmd:KeyMod.WinCtrl;class StandardKeyboardEvent{constructor(te){Ee(this,"_standardKeyboardEventBrand",!0);Ee(this,"browserEvent");Ee(this,"target");Ee(this,"ctrlKey");Ee(this,"shiftKey");Ee(this,"altKey");Ee(this,"metaKey");Ee(this,"altGraphKey");Ee(this,"keyCode");Ee(this,"code");Ee(this,"_asKeybinding");Ee(this,"_asKeyCodeChord");var ne;const ee=te;this.browserEvent=ee,this.target=ee.target,this.ctrlKey=ee.ctrlKey,this.shiftKey=ee.shiftKey,this.altKey=ee.altKey,this.metaKey=ee.metaKey,this.altGraphKey=(ne=ee.getModifierState)==null?void 0:ne.call(ee,"AltGraph"),this.keyCode=extractKeyCode(ee),this.code=ee.code,this.ctrlKey=this.ctrlKey||this.keyCode===KeyCode.Ctrl,this.altKey=this.altKey||this.keyCode===KeyCode.Alt,this.shiftKey=this.shiftKey||this.keyCode===KeyCode.Shift,this.metaKey=this.metaKey||this.keyCode===KeyCode.Meta,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(te){return this._asKeybinding===te}_computeKeybinding(){let te=KeyCode.Unknown;this.keyCode!==KeyCode.Ctrl&&this.keyCode!==KeyCode.Shift&&this.keyCode!==KeyCode.Alt&&this.keyCode!==KeyCode.Meta&&(te=this.keyCode);let ee=0;return this.ctrlKey&&(ee|=ctrlKeyMod),this.altKey&&(ee|=altKeyMod),this.shiftKey&&(ee|=shiftKeyMod),this.metaKey&&(ee|=metaKeyMod),ee|=te,ee}_computeKeyCodeChord(){let te=KeyCode.Unknown;return this.keyCode!==KeyCode.Ctrl&&this.keyCode!==KeyCode.Shift&&this.keyCode!==KeyCode.Alt&&this.keyCode!==KeyCode.Meta&&(te=this.keyCode),new KeyCodeChord(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,te)}}class StandardMouseEvent{constructor(te){Ee(this,"browserEvent");Ee(this,"leftButton");Ee(this,"middleButton");Ee(this,"rightButton");Ee(this,"buttons");Ee(this,"target");Ee(this,"detail");Ee(this,"posx");Ee(this,"posy");Ee(this,"ctrlKey");Ee(this,"shiftKey");Ee(this,"altKey");Ee(this,"metaKey");Ee(this,"timestamp");this.timestamp=te.timeStamp,this.browserEvent=te,this.leftButton=te.button===0,this.middleButton=te.button===1,this.rightButton=te.button===2,this.buttons=te.buttons,this.target=te.target,this.detail=te.detail||1,te.type==="dblclick"&&(this.detail=2),this.ctrlKey=te.ctrlKey,this.shiftKey=te.shiftKey,this.altKey=te.altKey,this.metaKey=te.metaKey,this.posx=te.clientX,this.posy=te.clientY}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}const{getWindow}=function(){return{getWindow(ie){var ne;const te=ie;if((ne=te==null?void 0:te.ownerDocument)!=null&&ne.defaultView)return te.ownerDocument.defaultView.window;const ee=ie;return ee!=null&&ee.view?ee.view.window:window}}}(),EventType$1={CLICK:"click",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_LEAVE:"mouseleave",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",DRAG_START:"dragstart",DRAG:"drag",DROP:"drop",DRAG_END:"dragend"};class DomListener{constructor(te,ee,ne,re){Ee(this,"_handler");Ee(this,"_node");Ee(this,"_type");Ee(this,"_options");this._node=te,this._type=ee,this._handler=ne,this._options=re||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function addDisposableListener(ie,te,ee,ne){return new DomListener(ie,te,ee,ne)}function _wrapAsStandardMouseEvent(ie){return function(te){return ie(new StandardMouseEvent(te))}}function _wrapAsStandardKeyboardEvent(ie){return function(te){return ie(new StandardKeyboardEvent(te))}}const addStandardDisposableListener=function(te,ee,ne,re){let se=ne;return ee==="click"||ee==="mousedown"?se=_wrapAsStandardMouseEvent(ne):(ee==="keydown"||ee==="keypress"||ee==="keyup")&&(se=_wrapAsStandardKeyboardEvent(ne)),addDisposableListener(te,ee,se,re)};function isKeyboardEvent(ie){return ie instanceof KeyboardEvent||ie instanceof getWindow(ie).KeyboardEvent}let scheduleAtNextAnimationFrame;class AnimationFrameQueueItem{constructor(te,ee=0){Ee(this,"_runner");Ee(this,"priority");Ee(this,"_canceled");this._runner=te,this.priority=ee,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(te){onUnexpectedError(te)}}static sort(te,ee){return ee.priority-te.priority}}(function(){let ie,te=!1;const ee=()=>{te=!1;const ne=ie.slice();for(ie.length=0;ne.length>0;)ne.sort(AnimationFrameQueueItem.sort),ne.shift().execute()};scheduleAtNextAnimationFrame=(ne,re=0)=>{const se=new AnimationFrameQueueItem(ne,re);let ae=ie;return ae||(ae=[],ie=ae),ae.push(se),te||(te=!0,window.requestAnimationFrame(()=>ee())),se}})();function runWhenIdle(ie,te){return _runWhenIdle(window,ie,te)}function getDomNodePagePosition(ie){const te=ie.getBoundingClientRect(),ee=getWindow(ie);return{left:te.left+ee.scrollX,top:te.top+ee.scrollY,width:te.width,height:te.height}}function ensure(ie){if(ie===null)throw new Error("Value is null");if(ie===void 0)throw new Error("Value is undefined");if(ie===!1)throw new Error("Value is falsy");return ie}function should(ie,te="unexpected state"){if(ie===!1||isUndefinedOrNull(ie))throw typeof te=="string"?new BugIndicatingError(`Assertion Failed: ${te}`):te}function createSingleCallFunction(ie,te){const ee=this;let ne=!1,re;return function(){return ne||(ne=!0,re=ie.apply(ee,arguments)),re}}var Iterable;(ie=>{function te(ne){return ne&&typeof ne=="object"&&typeof ne[Symbol.iterator]=="function"}ie.is=te;function ee(ne){return ne[Symbol.iterator]().next().value}ie.first=ee})(Iterable||(Iterable={}));function isDisposable(ie){return typeof ie=="object"&&ie!==null&&typeof ie.dispose=="function"&&ie.dispose.length===0}function dispose(ie){if(Iterable.is(ie)){const te=[];for(const ee of ie)if(ee)try{ee.dispose()}catch(ne){te.push(ne)}if(te.length===1)throw te[0];if(te.length>1)throw new AggregateError(te,"Encountered errors while disposing of store");return Array.isArray(ie)?[]:ie}else if(ie)return ie.dispose(),ie}function toDisposable(ie){return{dispose:createSingleCallFunction(()=>{ie()})}}function combinedDisposable(...ie){return toDisposable(()=>dispose(ie))}class DisposableStore{constructor(){Ee(this,"_toDispose",new Set);Ee(this,"_isDisposed",!1)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{dispose(this._toDispose)}finally{this._toDispose.clear()}}add(te){if(!te)return te;if(te===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(te),te}delete(te){if(te){if(te===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(te),te.dispose()}}deleteAndLeak(te){te&&this._toDispose.has(te)&&this._toDispose.delete(te)}}Ee(DisposableStore,"DISABLE_DISPOSED_WARNING",!1);class Disposable{constructor(){Ee(this,"_store",new DisposableStore);Ee(this,"_disposed",!1)}dispose(){this._disposed=!0,this._store.dispose()}_register(te){if(te===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(te)}}Ee(Disposable,"None",Object.freeze({dispose(){}}));class DisposableMap{constructor(){Ee(this,"_store",new Map);Ee(this,"_isDisposed",!1)}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{dispose(this._store.values())}finally{this._store.clear()}}has(te){return this._store.has(te)}get size(){return this._store.size}get(te){return this._store.get(te)}set(te,ee,ne=!1){var re;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),ne||(re=this._store.get(te))==null||re.dispose(),this._store.set(te,ee)}deleteAndDispose(te){var ee;(ee=this._store.get(te))==null||ee.dispose(),this._store.delete(te)}deleteAndLeak(te){const ee=this._store.get(te);return this._store.delete(te),ee}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}var _util;(ie=>{ie.serviceIds=new Map,ie.DI_TARGET="$di$target",ie.DI_DEPENDENCIES="$di$dependencies";function te(ee){return ee[ie.DI_DEPENDENCIES]||[]}ie.getServiceDependencies=te})(_util||(_util={}));const IInstantiationService=createDecorator$1("instantiationService");function storeServiceDependency(ie,te,ee){te[_util.DI_TARGET]===te?te[_util.DI_DEPENDENCIES].push({id:ie,index:ee}):(te[_util.DI_DEPENDENCIES]=[{id:ie,index:ee}],te[_util.DI_TARGET]=te)}function createDecorator$1(ie){if(_util.serviceIds.has(ie))return _util.serviceIds.get(ie);const te=function(ee,ne,re){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");storeServiceDependency(te,ee,re)};return te.toString=()=>ie,_util.serviceIds.set(ie,te),te}const IChartService=createDecorator$1("chartService"),IChartGuiService=createDecorator$1("chartGuiService"),IChartManagementService=createDecorator$1("chartManagementService"),HideDrawingsBit=1,HideIndicatorsBit=2,HidePositionsAndOrdersBit=4,IChartContributionRegistry=createDecorator$1("chartContributionRegistry");var ChartContributionInstantiation=(ie=>(ie[ie.Eager=0]="Eager",ie[ie.AfterFirstRender=1]="AfterFirstRender",ie[ie.Eventually=2]="Eventually",ie[ie.Lazy=3]="Lazy",ie))(ChartContributionInstantiation||{});class ChartContributionRegistry{constructor(){Ee(this,"_serviceBrand");Ee(this,"contributions",[])}register(te,ee,ne){this.contributions.push({id:te,ctor:ee,instantiation:ne})}getContributions(){return this.contributions}dispose(){this.contributions.length=0}}function isObject(ie){var te=typeof ie;return ie!=null&&(te=="object"||te=="function")}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root$y=freeGlobal||freeSelf||Function("return this")(),now=function(){return root$y.Date.now()},reWhitespace=/\s/;function trimmedEndIndex(ie){for(var te=ie.length;te--&&reWhitespace.test(ie.charAt(te)););return te}var reTrimStart=/^\s+/;function baseTrim(ie){return ie&&ie.slice(0,trimmedEndIndex(ie)+1).replace(reTrimStart,"")}var Symbol$1=root$y.Symbol,objectProto$h=Object.prototype,hasOwnProperty$e=objectProto$h.hasOwnProperty,nativeObjectToString$1=objectProto$h.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(ie){var te=hasOwnProperty$e.call(ie,symToStringTag$1),ee=ie[symToStringTag$1];try{ie[symToStringTag$1]=void 0;var ne=!0}catch{}var re=nativeObjectToString$1.call(ie);return ne&&(te?ie[symToStringTag$1]=ee:delete ie[symToStringTag$1]),re}var objectProto$g=Object.prototype,nativeObjectToString=objectProto$g.toString;function objectToString(ie){return nativeObjectToString.call(ie)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(ie){return ie==null?ie===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(ie)?getRawTag(ie):objectToString(ie)}function isObjectLike(ie){return ie!=null&&typeof ie=="object"}var symbolTag$3="[object Symbol]";function isSymbol(ie){return typeof ie=="symbol"||isObjectLike(ie)&&baseGetTag(ie)==symbolTag$3}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(ie){if(typeof ie=="number")return ie;if(isSymbol(ie))return NAN;if(isObject(ie)){var te=typeof ie.valueOf=="function"?ie.valueOf():ie;ie=isObject(te)?te+"":te}if(typeof ie!="string")return ie===0?ie:+ie;ie=baseTrim(ie);var ee=reIsBinary.test(ie);return ee||reIsOctal.test(ie)?freeParseInt(ie.slice(2),ee?2:8):reIsBadHex.test(ie)?NAN:+ie}var FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin=Math.min;function debounce$1(ie,te,ee){var ne,re,se,ae,le,ce,he=0,fe=!1,Ae=!1,pe=!0;if(typeof ie!="function")throw new TypeError(FUNC_ERROR_TEXT$1);te=toNumber(te)||0,isObject(ee)&&(fe=!!ee.leading,Ae="maxWait"in ee,se=Ae?nativeMax$1(toNumber(ee.maxWait)||0,te):se,pe="trailing"in ee?!!ee.trailing:pe);function Oe(Ze){var Ye=ne,qe=re;return ne=re=void 0,he=Ze,ae=ie.apply(qe,Ye),ae}function Fe(Ze){return he=Ze,le=setTimeout(He,te),fe?Oe(Ze):ae}function Ne(Ze){var Ye=Ze-ce,qe=Ze-he,nr=te-Ye;return Ae?nativeMin(nr,se-qe):nr}function ze(Ze){var Ye=Ze-ce,qe=Ze-he;return ce===void 0||Ye>=te||Ye<0||Ae&&qe>=se}function He(){var Ze=now();if(ze(Ze))return We(Ze);le=setTimeout(He,Ne(Ze))}function We(Ze){return le=void 0,pe&&ne?Oe(Ze):(ne=re=void 0,ae)}function je(){le!==void 0&&clearTimeout(le),he=0,ne=ce=re=le=void 0}function Ue(){return le===void 0?ae:We(now())}function Ge(){var Ze=now(),Ye=ze(Ze);if(ne=arguments,re=this,ce=Ze,Ye){if(le===void 0)return Fe(ce);if(Ae)return clearTimeout(le),le=setTimeout(He,te),Oe(ce)}return le===void 0&&(le=setTimeout(He,te)),ae}return Ge.cancel=je,Ge.flush=Ue,Ge}function createDecorator(ie){return(te,ee,ne)=>{let re=null,se=null;if(typeof ne.value=="function"?(re="value",se=ne.value):typeof ne.get=="function"&&(re="get",se=ne.get),!se||typeof ee=="symbol")throw new Error("not supported");ne[re]=ie(se,ee)}}function debounce(ie,te){return createDecorator(ee=>{const ne=debounce$1(ee,ie,te);return function(...re){ne.apply(this,re)}})}function memoize$1(ie,te,ee){let ne=null,re=null;if(typeof ee.value=="function"?(ne="value",re=ee.value,re.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof ee.get=="function"&&(ne="get",re=ee.get),!re)throw new Error("not supported");const se=`$memoize$${te}`;ee[ne]=function(...ae){return Object.prototype.hasOwnProperty.call(this,se)||Object.defineProperty(this,se,{configurable:!1,enumerable:!1,writable:!1,value:re.apply(this,ae)}),this[se]}}var Event$1;(ie=>{ie.None=()=>Disposable.None;function te(ee){return(ne,re=null,se)=>{let ae=!1,le;return le=ee(ce=>{if(!ae)return le?le.dispose():ae=!0,ne.call(re,ce)},null,se),ae&&le.dispose(),le}}ie.once=te})(Event$1||(Event$1={}));let id=0;class UniqueContainer{constructor(te){Ee(this,"stack");Ee(this,"id",id++);this.value=te}}class Stacktrace{constructor(te){this.value=te}static create(){const te=new Error;return new Stacktrace(te.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class EventDeliveryQueuePrivate{constructor(){Ee(this,"i",-1);Ee(this,"end",0);Ee(this,"current");Ee(this,"value")}enqueue(te,ee,ne){this.i=0,this.end=ne,this.current=te,this.value=ee}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}const compactionThreshold=2;class Emitter{constructor(te){Ee(this,"_options");Ee(this,"_leakageMon");Ee(this,"_perfMon");Ee(this,"_disposed");Ee(this,"_event");Ee(this,"_listeners");Ee(this,"_deliveryQueue");Ee(this,"_size",0);var ee;this._options=te,this._deliveryQueue=(ee=this._options)==null?void 0:ee.deliveryQueue}dispose(){var te,ee,ne,re;this._disposed||(this._disposed=!0,((te=this._deliveryQueue)==null?void 0:te.current)===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),(ne=(ee=this._options)==null?void 0:ee.onDidRemoveLastListener)==null||ne.call(ee),(re=this._leakageMon)==null||re.dispose())}get event(){return this._event??(this._event=(te,ee,ne)=>{var le,ce,he,fe,Ae,pe,Oe;if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const Fe=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(Fe);const Ne=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],ze=new ListenerRefusalError(`${Fe}. HINT: Stack shows most frequent listener (${Ne[1]}-times)`,Ne[0]);return(((le=this._options)==null?void 0:le.onListenerError)||onUnexpectedError)(ze),Disposable.None}if(this._disposed)return Disposable.None;ee&&(te=te.bind(ee));const re=new UniqueContainer(te);let se;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(re.stack=Stacktrace.create(),se=this._leakageMon.check(re.stack,this._size+1)),this._listeners?this._listeners instanceof UniqueContainer?(this._deliveryQueue??(this._deliveryQueue=new EventDeliveryQueuePrivate),this._listeners=[this._listeners,re]):this._listeners.push(re):((he=(ce=this._options)==null?void 0:ce.onWillAddFirstListener)==null||he.call(ce,this),this._listeners=re,(Ae=(fe=this._options)==null?void 0:fe.onDidAddFirstListener)==null||Ae.call(fe,this)),(Oe=(pe=this._options)==null?void 0:pe.onDidAddListener)==null||Oe.call(pe,this),this._size++;const ae=toDisposable(()=>{se==null||se(),this._removeListener(re)});return ne instanceof DisposableStore?ne.add(ae):Array.isArray(ne)&&ne.push(ae),ae}),this._event}_removeListener(te){var se,ae,le,ce;if((ae=(se=this._options)==null?void 0:se.onWillRemoveListener)==null||ae.call(se,this),!this._listeners)return;if(this._size===1){this._listeners=void 0,(ce=(le=this._options)==null?void 0:le.onDidRemoveLastListener)==null||ce.call(le,this),this._size=0;return}const ee=this._listeners,ne=ee.indexOf(te);if(ne===-1)throw new Error("Attempted to dispose unknown listener");this._size--,ee[ne]=void 0;const re=this._deliveryQueue.current===this;if(this._size*compactionThreshold<=ee.length){let he=0;for(let fe=0;fe<ee.length;fe++)ee[fe]?ee[he++]=ee[fe]:re&&he<this._deliveryQueue.end&&(this._deliveryQueue.end--,he<this._deliveryQueue.i&&this._deliveryQueue.i--);ee.length=he}}_deliver(te,ee){var re;if(!te)return;const ne=((re=this._options)==null?void 0:re.onListenerError)||onUnexpectedError;if(!ne){te.value(ee);return}try{te.value(ee)}catch(se){ne(se)}}_deliverQueue(te){const ee=te.current._listeners;for(;te.i<te.end;)this._deliver(ee[te.i++],te.value);te.reset()}fire(te){var ee,ne,re,se;if((ee=this._deliveryQueue)!=null&&ee.current&&(this._deliverQueue(this._deliveryQueue),(ne=this._perfMon)==null||ne.stop()),(re=this._perfMon)==null||re.start(this._size),this._listeners)if(this._listeners instanceof UniqueContainer)this._deliver(this._listeners,te);else{const ae=this._deliveryQueue;ae.enqueue(this,te,this._listeners.length),this._deliverQueue(ae)}(se=this._perfMon)==null||se.stop()}hasListeners(){return this._size>0}}const createEventDeliveryQueue=()=>new EventDeliveryQueuePrivate;class ListenerRefusalError extends Error{constructor(te,ee){super(te),this.name="ListenerRefusalError",this.stack=ee}}const DEV=!1;var is_array=Array.isArray,index_of=Array.prototype.indexOf,array_from=Array.from,define_property=Object.defineProperty,get_descriptor=Object.getOwnPropertyDescriptor,get_descriptors=Object.getOwnPropertyDescriptors,object_prototype=Object.prototype,array_prototype=Array.prototype,get_prototype_of=Object.getPrototypeOf,is_extensible=Object.isExtensible;function is_function(ie){return typeof ie=="function"}const noop$1=()=>{};function run(ie){return ie()}function run_all(ie){for(var te=0;te<ie.length;te++)ie[te]()}function deferred(){var ie,te,ee=new Promise((ne,re)=>{ie=ne,te=re});return{promise:ee,resolve:ie,reject:te}}const DERIVED=2,EFFECT=4,RENDER_EFFECT=8,BLOCK_EFFECT=16,BRANCH_EFFECT=32,ROOT_EFFECT=64,BOUNDARY_EFFECT=128,UNOWNED=256,DISCONNECTED=512,CLEAN=1024,DIRTY=2048,MAYBE_DIRTY=4096,INERT=8192,DESTROYED=16384,EFFECT_RAN=32768,EFFECT_TRANSPARENT=65536,INSPECT_EFFECT=1<<17,HEAD_EFFECT=1<<18,EFFECT_PRESERVED=1<<19,USER_EFFECT=1<<20,REACTION_IS_UPDATING=1<<21,ASYNC=1<<22,ERROR_VALUE=1<<23,STATE_SYMBOL=Symbol("$state"),LEGACY_PROPS=Symbol("legacy props"),LOADING_ATTR_SYMBOL=Symbol(""),STALE_REACTION=new class extends Error{constructor(){super(...arguments);Ee(this,"name","StaleReactionError");Ee(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function await_outside_boundary(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function lifecycle_outside_component(ie){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function async_derived_orphan(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function effect_in_teardown(ie){throw new Error("https://svelte.dev/e/effect_in_teardown")}function effect_in_unowned_derived(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function effect_orphan(ie){throw new Error("https://svelte.dev/e/effect_orphan")}function effect_update_depth_exceeded(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function props_invalid_value(ie){throw new Error("https://svelte.dev/e/props_invalid_value")}function state_descriptors_fixed(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function state_prototype_fixed(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function state_unsafe_mutation(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const EACH_ITEM_REACTIVE=1,EACH_INDEX_REACTIVE=2,EACH_IS_CONTROLLED=4,EACH_IS_ANIMATED=8,EACH_ITEM_IMMUTABLE=16,PROPS_IS_IMMUTABLE=1,PROPS_IS_RUNES=2,PROPS_IS_UPDATED=4,PROPS_IS_BINDABLE=8,PROPS_IS_LAZY_INITIAL=16,TEMPLATE_FRAGMENT=1,TEMPLATE_USE_IMPORT_NODE=2,UNINITIALIZED=Symbol(),NAMESPACE_HTML="http://www.w3.org/1999/xhtml",NAMESPACE_SVG="http://www.w3.org/2000/svg",ATTACHMENT_KEY="@attach";function select_multiple_invalid_value(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let hydrating=!1;function equals(ie){return ie===this.v}function safe_not_equal(ie,te){return ie!=ie?te==te:ie!==te||ie!==null&&typeof ie=="object"||typeof ie=="function"}function not_equal(ie,te){return ie!==te}function safe_equals(ie){return!safe_not_equal(ie,this.v)}let legacy_mode_flag=!1,tracing_mode_flag=!1;function enable_legacy_mode_flag(){legacy_mode_flag=!0}let component_context=null;function set_component_context(ie){component_context=ie}function getContext(ie){return get_or_init_context_map().get(ie)}function setContext(ie,te){return get_or_init_context_map().set(ie,te),te}function push(ie,te=!1,ee){component_context={p:component_context,c:null,e:null,s:ie,x:null,l:legacy_mode_flag&&!te?{s:null,u:null,$:[]}:null}}function pop(ie){var te=component_context,ee=te.e;if(ee!==null){te.e=null;for(var ne of ee)create_user_effect(ne)}return ie!==void 0&&(te.x=ie),component_context=te.p,ie??{}}function is_runes(){return!legacy_mode_flag||component_context!==null&&component_context.l===null}function get_or_init_context_map(ie){return component_context===null&&lifecycle_outside_component(),component_context.c??(component_context.c=new Map(get_parent_context(component_context)||void 0))}function get_parent_context(ie){let te=ie.p;for(;te!==null;){const ee=te.c;if(ee!==null)return ee;te=te.p}return null}const adjustments=new WeakMap;function handle_error(ie){var te=active_effect;if(te===null)return active_reaction.f|=ERROR_VALUE,ie;if((te.f&EFFECT_RAN)===0){if((te.f&BOUNDARY_EFFECT)===0)throw!te.parent&&ie instanceof Error&&apply_adjustments(ie),ie;te.b.error(ie)}else invoke_error_boundary(ie,te)}function invoke_error_boundary(ie,te){for(;te!==null;){if((te.f&BOUNDARY_EFFECT)!==0)try{te.b.error(ie);return}catch(ee){ie=ee}te=te.parent}throw ie instanceof Error&&apply_adjustments(ie),ie}function apply_adjustments(ie){const te=adjustments.get(ie);te&&(define_property(ie,"message",{value:te.message}),define_property(ie,"stack",{value:te.stack}))}let micro_tasks=[],idle_tasks=[];function run_micro_tasks(){var ie=micro_tasks;micro_tasks=[],run_all(ie)}function run_idle_tasks(){var ie=idle_tasks;idle_tasks=[],run_all(ie)}function queue_micro_task(ie){micro_tasks.length===0&&queueMicrotask(run_micro_tasks),micro_tasks.push(ie)}function flush_tasks(){micro_tasks.length>0&&run_micro_tasks(),idle_tasks.length>0&&run_idle_tasks()}function get_pending_boundary(){for(var ie=active_effect.b;ie!==null&&!ie.has_pending_snippet();)ie=ie.parent;return ie===null&&await_outside_boundary(),ie}function derived$1(ie){var te=DERIVED|DIRTY,ee=active_reaction!==null&&(active_reaction.f&DERIVED)!==0?active_reaction:null;return active_effect===null||ee!==null&&(ee.f&UNOWNED)!==0?te|=UNOWNED:active_effect.f|=EFFECT_PRESERVED,{ctx:component_context,deps:null,effects:null,equals,f:te,fn:ie,reactions:null,rv:0,v:UNINITIALIZED,wv:0,parent:ee??active_effect,ac:null}}function async_derived(ie,te){let ee=active_effect;ee===null&&async_derived_orphan();var ne=ee.b,re=void 0,se=source(UNINITIALIZED),ae=null,le=!active_reaction;return async_effect(()=>{try{var ce=ie()}catch(Oe){ce=Promise.reject(Oe)}var he=()=>ce;re=(ae==null?void 0:ae.then(he,he))??Promise.resolve(ce),ae=re;var fe=current_batch,Ae=ne.pending;le&&(ne.update_pending_count(1),Ae||fe.increment());const pe=(Oe,Fe=void 0)=>{ae=null,Ae||fe.activate(),Fe?Fe!==STALE_REACTION&&(se.f|=ERROR_VALUE,internal_set(se,Fe)):((se.f&ERROR_VALUE)!==0&&(se.f^=ERROR_VALUE),internal_set(se,Oe)),le&&(ne.update_pending_count(-1),Ae||fe.decrement()),unset_context()};if(re.then(pe,Oe=>pe(null,Oe||"unknown")),fe)return()=>{queueMicrotask(()=>fe.neuter())}}),new Promise(ce=>{function he(fe){function Ae(){fe===re?ce(se):he(re)}fe.then(Ae,Ae)}he(re)})}function user_derived(ie){const te=derived$1(ie);return push_reaction_value(te),te}function derived_safe_equal(ie){const te=derived$1(ie);return te.equals=safe_equals,te}function destroy_derived_effects(ie){var te=ie.effects;if(te!==null){ie.effects=null;for(var ee=0;ee<te.length;ee+=1)destroy_effect(te[ee])}}function get_derived_parent_effect(ie){for(var te=ie.parent;te!==null;){if((te.f&DERIVED)===0)return te;te=te.parent}return null}function execute_derived(ie){var te,ee=active_effect;set_active_effect(get_derived_parent_effect(ie));try{destroy_derived_effects(ie),te=update_reaction(ie)}finally{set_active_effect(ee)}return te}function update_derived(ie){var te=execute_derived(ie);if(ie.equals(te)||(ie.v=te,ie.wv=increment_write_version()),!is_destroying_effect)if(batch_deriveds!==null)batch_deriveds.set(ie,ie.v);else{var ee=(skip_reaction||(ie.f&UNOWNED)!==0)&&ie.deps!==null?MAYBE_DIRTY:CLEAN;set_signal_status(ie,ee)}}function flatten$1(ie,te,ee){const ne=is_runes()?derived$1:derived_safe_equal;if(te.length===0){ee(ie.map(ne));return}var re=current_batch,se=active_effect,ae=capture(),le=get_pending_boundary();Promise.all(te.map(ce=>async_derived(ce))).then(ce=>{re==null||re.activate(),ae();try{ee([...ie.map(ne),...ce])}catch(he){(se.f&DESTROYED)===0&&invoke_error_boundary(he,se)}re==null||re.deactivate(),unset_context()}).catch(ce=>{le.error(ce)})}function capture(){var ie=active_effect,te=active_reaction,ee=component_context;return function(){set_active_effect(ie),set_active_reaction(te),set_component_context(ee)}}function unset_context(){set_active_effect(null),set_active_reaction(null),set_component_context(null)}const batches=new Set;let current_batch=null,previous_batch=null,batch_deriveds=null,effect_pending_updates=new Set,tasks=[];function dequeue(){const ie=tasks.shift();tasks.length>0&&queueMicrotask(dequeue),ie()}let queued_root_effects=[],last_scheduled_effect=null,is_flushing=!1,is_flushing_sync=!1;var p0,g0,Fa,O0,k0,qa,m0,Qa,Ba,_0,V0,F0,ca,ku,Cl,Jc;const Ml=class Ml{constructor(){Mo(this,ca);Ee(this,"current",new Map);Mo(this,p0,new Map);Mo(this,g0,new Set);Mo(this,Fa,0);Mo(this,O0,null);Mo(this,k0,!1);Mo(this,qa,[]);Mo(this,m0,[]);Mo(this,Qa,[]);Mo(this,Ba,[]);Mo(this,_0,[]);Mo(this,V0,[]);Mo(this,F0,[]);Ee(this,"skipped_effects",new Set)}process(te){var se;queued_root_effects=[],previous_batch=null;var ee=null;if(batches.size>1){ee=new Map,batch_deriveds=new Map;for(const[ae,le]of this.current)ee.set(ae,{v:ae.v,wv:ae.wv}),ae.v=le;for(const ae of batches)if(ae!==this)for(const[le,ce]of Qr(ae,p0))ee.has(le)||(ee.set(le,{v:le.v,wv:le.wv}),le.v=ce)}for(const ae of te)Va(this,ca,ku).call(this,ae);if(Qr(this,qa).length===0&&Qr(this,Fa)===0){Va(this,ca,Jc).call(this);var ne=Qr(this,Qa),re=Qr(this,Ba);Ho(this,Qa,[]),Ho(this,Ba,[]),Ho(this,_0,[]),previous_batch=current_batch,current_batch=null,flush_queued_effects(ne),flush_queued_effects(re),current_batch===null?current_batch=this:batches.delete(this),(se=Qr(this,O0))==null||se.resolve()}else Va(this,ca,Cl).call(this,Qr(this,Qa)),Va(this,ca,Cl).call(this,Qr(this,Ba)),Va(this,ca,Cl).call(this,Qr(this,_0));if(ee){for(const[ae,{v:le,wv:ce}]of ee)ae.wv<=ce&&(ae.v=le);batch_deriveds=null}for(const ae of Qr(this,qa))update_effect(ae);for(const ae of Qr(this,m0))update_effect(ae);Ho(this,qa,[]),Ho(this,m0,[])}capture(te,ee){Qr(this,p0).has(te)||Qr(this,p0).set(te,ee),this.current.set(te,te.v)}activate(){current_batch=this}deactivate(){current_batch=null,previous_batch=null;for(const te of effect_pending_updates)if(effect_pending_updates.delete(te),te(),current_batch!==null)break}neuter(){Ho(this,k0,!0)}flush(){queued_root_effects.length>0?flush_effects():Va(this,ca,Jc).call(this),current_batch===this&&(Qr(this,Fa)===0&&batches.delete(this),this.deactivate())}increment(){Ho(this,Fa,Qr(this,Fa)+1)}decrement(){if(Ho(this,Fa,Qr(this,Fa)-1),Qr(this,Fa)===0){for(const te of Qr(this,V0))set_signal_status(te,DIRTY),schedule_effect(te);for(const te of Qr(this,F0))set_signal_status(te,MAYBE_DIRTY),schedule_effect(te);Ho(this,Qa,[]),Ho(this,Ba,[]),this.flush()}else this.deactivate()}add_callback(te){Qr(this,g0).add(te)}settled(){return(Qr(this,O0)??Ho(this,O0,deferred())).promise}static ensure(){if(current_batch===null){const te=current_batch=new Ml;batches.add(current_batch),is_flushing_sync||Ml.enqueue(()=>{current_batch===te&&te.flush()})}return current_batch}static enqueue(te){tasks.length===0&&queueMicrotask(dequeue),tasks.unshift(te)}};p0=new WeakMap,g0=new WeakMap,Fa=new WeakMap,O0=new WeakMap,k0=new WeakMap,qa=new WeakMap,m0=new WeakMap,Qa=new WeakMap,Ba=new WeakMap,_0=new WeakMap,V0=new WeakMap,F0=new WeakMap,ca=new WeakSet,ku=function(te){var fe;te.f^=CLEAN;for(var ee=te.first;ee!==null;){var ne=ee.f,re=(ne&(BRANCH_EFFECT|ROOT_EFFECT))!==0,se=re&&(ne&CLEAN)!==0,ae=se||(ne&INERT)!==0||this.skipped_effects.has(ee);if(!ae&&ee.fn!==null){if(re)ee.f^=CLEAN;else if((ne&CLEAN)===0)if((ne&EFFECT)!==0)Qr(this,Ba).push(ee);else if((ne&ASYNC)!==0){var le=(fe=ee.b)!=null&&fe.pending?Qr(this,m0):Qr(this,qa);le.push(ee)}else is_dirty(ee)&&((ee.f&BLOCK_EFFECT)!==0&&Qr(this,_0).push(ee),update_effect(ee));var ce=ee.first;if(ce!==null){ee=ce;continue}}var he=ee.parent;for(ee=ee.next;ee===null&&he!==null;)ee=he.next,he=he.parent}},Cl=function(te){for(const ee of te)((ee.f&DIRTY)!==0?Qr(this,V0):Qr(this,F0)).push(ee),set_signal_status(ee,CLEAN);te.length=0},Jc=function(){if(!Qr(this,k0))for(const te of Qr(this,g0))te();Qr(this,g0).clear()};let Batch=Ml;function flushSync(ie){var te=is_flushing_sync;is_flushing_sync=!0;try{for(var ee;;){if(flush_tasks(),queued_root_effects.length===0&&(current_batch==null||current_batch.flush(),queued_root_effects.length===0))return last_scheduled_effect=null,ee;flush_effects()}}finally{is_flushing_sync=te}}function flush_effects(){var ie=is_updating_effect;is_flushing=!0;try{var te=0;for(set_is_updating_effect(!0);queued_root_effects.length>0;){var ee=Batch.ensure();if(te++>1e3){var ne,re;infinite_loop_guard()}ee.process(queued_root_effects),old_values.clear()}}finally{is_flushing=!1,set_is_updating_effect(ie),last_scheduled_effect=null}}function infinite_loop_guard(){try{effect_update_depth_exceeded()}catch(ie){invoke_error_boundary(ie,last_scheduled_effect)}}function flush_queued_effects(ie){var te=ie.length;if(te!==0){for(var ee=0;ee<te;){var ne=ie[ee++];if((ne.f&(DESTROYED|INERT))===0&&is_dirty(ne)){var re=current_batch?current_batch.current.size:0;if(update_effect(ne),ne.deps===null&&ne.first===null&&ne.nodes_start===null&&(ne.teardown===null&&ne.ac===null?unlink_effect(ne):ne.fn=null),current_batch!==null&&current_batch.current.size>re&&(ne.f&USER_EFFECT)!==0)break}}for(;ee<te;)schedule_effect(ie[ee++])}}function schedule_effect(ie){for(var te=last_scheduled_effect=ie;te.parent!==null;){te=te.parent;var ee=te.f;if(is_flushing&&te===active_effect&&(ee&BLOCK_EFFECT)!==0)return;if((ee&(ROOT_EFFECT|BRANCH_EFFECT))!==0){if((ee&CLEAN)===0)return;te.f^=CLEAN}}queued_root_effects.push(te)}const old_values=new Map;function source(ie,te){var ee={f:0,v:ie,reactions:null,equals,rv:0,wv:0};return ee}function state(ie,te){const ee=source(ie);return push_reaction_value(ee),ee}function mutable_source(ie,te=!1,ee=!0){var re;const ne=source(ie);return te||(ne.equals=safe_equals),legacy_mode_flag&&ee&&component_context!==null&&component_context.l!==null&&((re=component_context.l).s??(re.s=[])).push(ne),ne}function set(ie,te,ee=!1){active_reaction!==null&&(!untracking||(active_reaction.f&INSPECT_EFFECT)!==0)&&is_runes()&&(active_reaction.f&(DERIVED|BLOCK_EFFECT|ASYNC|INSPECT_EFFECT))!==0&&!(current_sources!=null&&current_sources.includes(ie))&&state_unsafe_mutation();let ne=ee?proxy(te):te;return internal_set(ie,ne)}function internal_set(ie,te){if(!ie.equals(te)){var ee=ie.v;is_destroying_effect?old_values.set(ie,te):old_values.set(ie,ee),ie.v=te;var ne=Batch.ensure();ne.capture(ie,ee),(ie.f&DERIVED)!==0&&((ie.f&DIRTY)!==0&&execute_derived(ie),set_signal_status(ie,(ie.f&UNOWNED)===0?CLEAN:MAYBE_DIRTY)),ie.wv=increment_write_version(),mark_reactions(ie,DIRTY),is_runes()&&active_effect!==null&&(active_effect.f&CLEAN)!==0&&(active_effect.f&(BRANCH_EFFECT|ROOT_EFFECT))===0&&(untracked_writes===null?set_untracked_writes([ie]):untracked_writes.push(ie))}return te}function increment(ie){set(ie,ie.v+1)}function mark_reactions(ie,te){var ee=ie.reactions;if(ee!==null)for(var ne=is_runes(),re=ee.length,se=0;se<re;se++){var ae=ee[se],le=ae.f;if(!(!ne&&ae===active_effect)){var ce=(le&DIRTY)===0;ce&&set_signal_status(ae,te),(le&DERIVED)!==0?mark_reactions(ae,MAYBE_DIRTY):ce&&schedule_effect(ae)}}}function proxy(ie){if(typeof ie!="object"||ie===null||STATE_SYMBOL in ie)return ie;const te=get_prototype_of(ie);if(te!==object_prototype&&te!==array_prototype)return ie;var ee=new Map,ne=is_array(ie),re=state(0),se=update_version,ae=le=>{if(update_version===se)return le();var ce=active_reaction,he=update_version;set_active_reaction(null),set_update_version(se);var fe=le();return set_active_reaction(ce),set_update_version(he),fe};return ne&&ee.set("length",state(ie.length)),new Proxy(ie,{defineProperty(le,ce,he){(!("value"in he)||he.configurable===!1||he.enumerable===!1||he.writable===!1)&&state_descriptors_fixed();var fe=ee.get(ce);return fe===void 0?fe=ae(()=>{var Ae=state(he.value);return ee.set(ce,Ae),Ae}):set(fe,he.value,!0),!0},deleteProperty(le,ce){var he=ee.get(ce);if(he===void 0){if(ce in le){const fe=ae(()=>state(UNINITIALIZED));ee.set(ce,fe),increment(re)}}else set(he,UNINITIALIZED),increment(re);return!0},get(le,ce,he){var Oe;if(ce===STATE_SYMBOL)return ie;var fe=ee.get(ce),Ae=ce in le;if(fe===void 0&&(!Ae||(Oe=get_descriptor(le,ce))!=null&&Oe.writable)&&(fe=ae(()=>{var Fe=proxy(Ae?le[ce]:UNINITIALIZED),Ne=state(Fe);return Ne}),ee.set(ce,fe)),fe!==void 0){var pe=get$2(fe);return pe===UNINITIALIZED?void 0:pe}return Reflect.get(le,ce,he)},getOwnPropertyDescriptor(le,ce){var he=Reflect.getOwnPropertyDescriptor(le,ce);if(he&&"value"in he){var fe=ee.get(ce);fe&&(he.value=get$2(fe))}else if(he===void 0){var Ae=ee.get(ce),pe=Ae==null?void 0:Ae.v;if(Ae!==void 0&&pe!==UNINITIALIZED)return{enumerable:!0,configurable:!0,value:pe,writable:!0}}return he},has(le,ce){var pe;if(ce===STATE_SYMBOL)return!0;var he=ee.get(ce),fe=he!==void 0&&he.v!==UNINITIALIZED||Reflect.has(le,ce);if(he!==void 0||active_effect!==null&&(!fe||(pe=get_descriptor(le,ce))!=null&&pe.writable)){he===void 0&&(he=ae(()=>{var Oe=fe?proxy(le[ce]):UNINITIALIZED,Fe=state(Oe);return Fe}),ee.set(ce,he));var Ae=get$2(he);if(Ae===UNINITIALIZED)return!1}return fe},set(le,ce,he,fe){var je;var Ae=ee.get(ce),pe=ce in le;if(ne&&ce==="length")for(var Oe=he;Oe<Ae.v;Oe+=1){var Fe=ee.get(Oe+"");Fe!==void 0?set(Fe,UNINITIALIZED):Oe in le&&(Fe=ae(()=>state(UNINITIALIZED)),ee.set(Oe+"",Fe))}if(Ae===void 0)(!pe||(je=get_descriptor(le,ce))!=null&&je.writable)&&(Ae=ae(()=>state(void 0)),set(Ae,proxy(he)),ee.set(ce,Ae));else{pe=Ae.v!==UNINITIALIZED;var Ne=ae(()=>proxy(he));set(Ae,Ne)}var ze=Reflect.getOwnPropertyDescriptor(le,ce);if(ze!=null&&ze.set&&ze.set.call(fe,he),!pe){if(ne&&typeof ce=="string"){var He=ee.get("length"),We=Number(ce);Number.isInteger(We)&&We>=He.v&&set(He,We+1)}increment(re)}return!0},ownKeys(le){get$2(re);var ce=Reflect.ownKeys(le).filter(Ae=>{var pe=ee.get(Ae);return pe===void 0||pe.v!==UNINITIALIZED});for(var[he,fe]of ee)fe.v!==UNINITIALIZED&&!(he in le)&&ce.push(he);return ce},setPrototypeOf(){state_prototype_fixed()}})}function get_proxied_value(ie){try{if(ie!==null&&typeof ie=="object"&&STATE_SYMBOL in ie)return ie[STATE_SYMBOL]}catch{}return ie}function is$1(ie,te){return Object.is(get_proxied_value(ie),get_proxied_value(te))}var $window,is_firefox,first_child_getter,next_sibling_getter;function init_operations(){if($window===void 0){$window=window,is_firefox=/Firefox/.test(navigator.userAgent);var ie=Element.prototype,te=Node.prototype,ee=Text.prototype;first_child_getter=get_descriptor(te,"firstChild").get,next_sibling_getter=get_descriptor(te,"nextSibling").get,is_extensible(ie)&&(ie.__click=void 0,ie.__className=void 0,ie.__attributes=null,ie.__style=void 0,ie.__e=void 0),is_extensible(ee)&&(ee.__t=void 0)}}function create_text(ie=""){return document.createTextNode(ie)}function get_first_child(ie){return first_child_getter.call(ie)}function get_next_sibling(ie){return next_sibling_getter.call(ie)}function child(ie,te){return get_first_child(ie)}function first_child(ie,te){{var ee=get_first_child(ie);return ee instanceof Comment&&ee.data===""?get_next_sibling(ee):ee}}function sibling(ie,te=1,ee=!1){let ne=ie;for(;te--;)ne=get_next_sibling(ne);return ne}function clear_text_content(ie){ie.textContent=""}function should_defer_append(){return!1}function validate_effect(ie){active_effect===null&&active_reaction===null&&effect_orphan(),active_reaction!==null&&(active_reaction.f&UNOWNED)!==0&&active_effect===null&&effect_in_unowned_derived(),is_destroying_effect&&effect_in_teardown()}function push_effect(ie,te){var ee=te.last;ee===null?te.last=te.first=ie:(ee.next=ie,ie.prev=ee,te.last=ie)}function create_effect(ie,te,ee,ne=!0){var re=active_effect;re!==null&&(re.f&INERT)!==0&&(ie|=INERT);var se={ctx:component_context,deps:null,nodes_start:null,nodes_end:null,f:ie|DIRTY,first:null,fn:te,last:null,next:null,parent:re,b:re&&re.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(ee)try{update_effect(se),se.f|=EFFECT_RAN}catch(ce){throw destroy_effect(se),ce}else te!==null&&schedule_effect(se);var ae=ee&&se.deps===null&&se.first===null&&se.nodes_start===null&&se.teardown===null&&(se.f&EFFECT_PRESERVED)===0;if(!ae&&ne&&(re!==null&&push_effect(se,re),active_reaction!==null&&(active_reaction.f&DERIVED)!==0&&(ie&ROOT_EFFECT)===0)){var le=active_reaction;(le.effects??(le.effects=[])).push(se)}return se}function teardown(ie){const te=create_effect(RENDER_EFFECT,null,!1);return set_signal_status(te,CLEAN),te.teardown=ie,te}function user_effect(ie){validate_effect();var te=active_effect.f,ee=!active_reaction&&(te&BRANCH_EFFECT)!==0&&(te&EFFECT_RAN)===0;if(ee){var ne=component_context;(ne.e??(ne.e=[])).push(ie)}else return create_user_effect(ie)}function create_user_effect(ie){return create_effect(EFFECT|USER_EFFECT,ie,!1)}function user_pre_effect(ie){return validate_effect(),create_effect(RENDER_EFFECT|USER_EFFECT,ie,!0)}function component_root(ie){Batch.ensure();const te=create_effect(ROOT_EFFECT,ie,!0);return(ee={})=>new Promise(ne=>{ee.outro?pause_effect(te,()=>{destroy_effect(te),ne(void 0)}):(destroy_effect(te),ne(void 0))})}function effect(ie){return create_effect(EFFECT,ie,!1)}function async_effect(ie){return create_effect(ASYNC|EFFECT_PRESERVED,ie,!0)}function render_effect(ie,te=0){return create_effect(RENDER_EFFECT|te,ie,!0)}function template_effect(ie,te=[],ee=[]){flatten$1(te,ee,ne=>{create_effect(RENDER_EFFECT,()=>ie(...ne.map(get$2)),!0)})}function block(ie,te=0){var ee=create_effect(BLOCK_EFFECT|te,ie,!0);return ee}function branch(ie,te=!0){return create_effect(BRANCH_EFFECT,ie,!0,te)}function execute_effect_teardown(ie){var te=ie.teardown;if(te!==null){const ee=is_destroying_effect,ne=active_reaction;set_is_destroying_effect(!0),set_active_reaction(null);try{te.call(null)}finally{set_is_destroying_effect(ee),set_active_reaction(ne)}}}function destroy_effect_children(ie,te=!1){var re;var ee=ie.first;for(ie.first=ie.last=null;ee!==null;){(re=ee.ac)==null||re.abort(STALE_REACTION);var ne=ee.next;(ee.f&ROOT_EFFECT)!==0?ee.parent=null:destroy_effect(ee,te),ee=ne}}function destroy_block_effect_children(ie){for(var te=ie.first;te!==null;){var ee=te.next;(te.f&BRANCH_EFFECT)===0&&destroy_effect(te),te=ee}}function destroy_effect(ie,te=!0){var ee=!1;(te||(ie.f&HEAD_EFFECT)!==0)&&ie.nodes_start!==null&&ie.nodes_end!==null&&(remove_effect_dom(ie.nodes_start,ie.nodes_end),ee=!0),destroy_effect_children(ie,te&&!ee),remove_reactions(ie,0),set_signal_status(ie,DESTROYED);var ne=ie.transitions;if(ne!==null)for(const se of ne)se.stop();execute_effect_teardown(ie);var re=ie.parent;re!==null&&re.first!==null&&unlink_effect(ie),ie.next=ie.prev=ie.teardown=ie.ctx=ie.deps=ie.fn=ie.nodes_start=ie.nodes_end=ie.ac=null}function remove_effect_dom(ie,te){for(;ie!==null;){var ee=ie===te?null:get_next_sibling(ie);ie.remove(),ie=ee}}function unlink_effect(ie){var te=ie.parent,ee=ie.prev,ne=ie.next;ee!==null&&(ee.next=ne),ne!==null&&(ne.prev=ee),te!==null&&(te.first===ie&&(te.first=ne),te.last===ie&&(te.last=ee))}function pause_effect(ie,te){var ee=[];pause_children(ie,ee,!0),run_out_transitions(ee,()=>{destroy_effect(ie),te&&te()})}function run_out_transitions(ie,te){var ee=ie.length;if(ee>0){var ne=()=>--ee||te();for(var re of ie)re.out(ne)}else te()}function pause_children(ie,te,ee){if((ie.f&INERT)===0){if(ie.f^=INERT,ie.transitions!==null)for(const ae of ie.transitions)(ae.is_global||ee)&&te.push(ae);for(var ne=ie.first;ne!==null;){var re=ne.next,se=(ne.f&EFFECT_TRANSPARENT)!==0||(ne.f&BRANCH_EFFECT)!==0;pause_children(ne,te,se?ee:!1),ne=re}}}function resume_effect(ie){resume_children(ie,!0)}function resume_children(ie,te){if((ie.f&INERT)!==0){ie.f^=INERT,(ie.f&CLEAN)===0&&(set_signal_status(ie,DIRTY),schedule_effect(ie));for(var ee=ie.first;ee!==null;){var ne=ee.next,re=(ee.f&EFFECT_TRANSPARENT)!==0||(ee.f&BRANCH_EFFECT)!==0;resume_children(ee,re?te:!1),ee=ne}if(ie.transitions!==null)for(const se of ie.transitions)(se.is_global||te)&&se.in()}}let is_updating_effect=!1;function set_is_updating_effect(ie){is_updating_effect=ie}let is_destroying_effect=!1;function set_is_destroying_effect(ie){is_destroying_effect=ie}let active_reaction=null,untracking=!1;function set_active_reaction(ie){active_reaction=ie}let active_effect=null;function set_active_effect(ie){active_effect=ie}let current_sources=null;function push_reaction_value(ie){active_reaction!==null&&(current_sources===null?current_sources=[ie]:current_sources.push(ie))}let new_deps=null,skipped_deps=0,untracked_writes=null;function set_untracked_writes(ie){untracked_writes=ie}let write_version=1,read_version=0,update_version=read_version;function set_update_version(ie){update_version=ie}let skip_reaction=!1;function increment_write_version(){return++write_version}function is_dirty(ie){var Ae;var te=ie.f;if((te&DIRTY)!==0)return!0;if((te&MAYBE_DIRTY)!==0){var ee=ie.deps,ne=(te&UNOWNED)!==0;if(ee!==null){var re,se,ae=(te&DISCONNECTED)!==0,le=ne&&active_effect!==null&&!skip_reaction,ce=ee.length;if((ae||le)&&(active_effect===null||(active_effect.f&DESTROYED)===0)){var he=ie,fe=he.parent;for(re=0;re<ce;re++)se=ee[re],(ae||!((Ae=se==null?void 0:se.reactions)!=null&&Ae.includes(he)))&&(se.reactions??(se.reactions=[])).push(he);ae&&(he.f^=DISCONNECTED),le&&fe!==null&&(fe.f&UNOWNED)===0&&(he.f^=UNOWNED)}for(re=0;re<ce;re++)if(se=ee[re],is_dirty(se)&&update_derived(se),se.wv>ie.wv)return!0}(!ne||active_effect!==null&&!skip_reaction)&&set_signal_status(ie,CLEAN)}return!1}function schedule_possible_effect_self_invalidation(ie,te,ee=!0){var ne=ie.reactions;if(ne!==null&&!(current_sources!=null&&current_sources.includes(ie)))for(var re=0;re<ne.length;re++){var se=ne[re];(se.f&DERIVED)!==0?schedule_possible_effect_self_invalidation(se,te,!1):te===se&&(ee?set_signal_status(se,DIRTY):(se.f&CLEAN)!==0&&set_signal_status(se,MAYBE_DIRTY),schedule_effect(se))}}function update_reaction(ie){var Fe;var te=new_deps,ee=skipped_deps,ne=untracked_writes,re=active_reaction,se=skip_reaction,ae=current_sources,le=component_context,ce=untracking,he=update_version,fe=ie.f;new_deps=null,skipped_deps=0,untracked_writes=null,skip_reaction=(fe&UNOWNED)!==0&&(untracking||!is_updating_effect||active_reaction===null),active_reaction=(fe&(BRANCH_EFFECT|ROOT_EFFECT))===0?ie:null,current_sources=null,set_component_context(ie.ctx),untracking=!1,update_version=++read_version,ie.ac!==null&&(ie.ac.abort(STALE_REACTION),ie.ac=null);try{ie.f|=REACTION_IS_UPDATING;var Ae=(0,ie.fn)(),pe=ie.deps;if(new_deps!==null){var Oe;if(remove_reactions(ie,skipped_deps),pe!==null&&skipped_deps>0)for(pe.length=skipped_deps+new_deps.length,Oe=0;Oe<new_deps.length;Oe++)pe[skipped_deps+Oe]=new_deps[Oe];else ie.deps=pe=new_deps;if(!skip_reaction||(fe&DERIVED)!==0&&ie.reactions!==null)for(Oe=skipped_deps;Oe<pe.length;Oe++)((Fe=pe[Oe]).reactions??(Fe.reactions=[])).push(ie)}else pe!==null&&skipped_deps<pe.length&&(remove_reactions(ie,skipped_deps),pe.length=skipped_deps);if(is_runes()&&untracked_writes!==null&&!untracking&&pe!==null&&(ie.f&(DERIVED|MAYBE_DIRTY|DIRTY))===0)for(Oe=0;Oe<untracked_writes.length;Oe++)schedule_possible_effect_self_invalidation(untracked_writes[Oe],ie);return re!==null&&re!==ie&&(read_version++,untracked_writes!==null&&(ne===null?ne=untracked_writes:ne.push(...untracked_writes))),(ie.f&ERROR_VALUE)!==0&&(ie.f^=ERROR_VALUE),Ae}catch(Ne){return handle_error(Ne)}finally{ie.f^=REACTION_IS_UPDATING,new_deps=te,skipped_deps=ee,untracked_writes=ne,active_reaction=re,skip_reaction=se,current_sources=ae,set_component_context(le),untracking=ce,update_version=he}}function remove_reaction(ie,te){let ee=te.reactions;if(ee!==null){var ne=index_of.call(ee,ie);if(ne!==-1){var re=ee.length-1;re===0?ee=te.reactions=null:(ee[ne]=ee[re],ee.pop())}}ee===null&&(te.f&DERIVED)!==0&&(new_deps===null||!new_deps.includes(te))&&(set_signal_status(te,MAYBE_DIRTY),(te.f&(UNOWNED|DISCONNECTED))===0&&(te.f^=DISCONNECTED),destroy_derived_effects(te),remove_reactions(te,0))}function remove_reactions(ie,te){var ee=ie.deps;if(ee!==null)for(var ne=te;ne<ee.length;ne++)remove_reaction(ie,ee[ne])}function update_effect(ie){var te=ie.f;if((te&DESTROYED)===0){set_signal_status(ie,CLEAN);var ee=active_effect,ne=is_updating_effect;active_effect=ie,is_updating_effect=!0;try{(te&BLOCK_EFFECT)!==0?destroy_block_effect_children(ie):destroy_effect_children(ie),execute_effect_teardown(ie);var re=update_reaction(ie);ie.teardown=typeof re=="function"?re:null,ie.wv=write_version;var se;DEV&&tracing_mode_flag&&(ie.f&DIRTY)!==0&&ie.deps}finally{is_updating_effect=ne,active_effect=ee}}}async function tick(){await Promise.resolve(),flushSync()}function get$2(ie){var te=ie.f,ee=(te&DERIVED)!==0;if(active_reaction!==null&&!untracking){var ne=active_effect!==null&&(active_effect.f&DESTROYED)!==0;if(!ne&&!(current_sources!=null&&current_sources.includes(ie))){var re=active_reaction.deps;if((active_reaction.f&REACTION_IS_UPDATING)!==0)ie.rv<read_version&&(ie.rv=read_version,new_deps===null&&re!==null&&re[skipped_deps]===ie?skipped_deps++:new_deps===null?new_deps=[ie]:(!skip_reaction||!new_deps.includes(ie))&&new_deps.push(ie));else{(active_reaction.deps??(active_reaction.deps=[])).push(ie);var se=ie.reactions;se===null?ie.reactions=[active_reaction]:se.includes(active_reaction)||se.push(active_reaction)}}}else if(ee&&ie.deps===null&&ie.effects===null){var ae=ie,le=ae.parent;le!==null&&(le.f&UNOWNED)===0&&(ae.f^=UNOWNED)}if(is_destroying_effect){if(old_values.has(ie))return old_values.get(ie);if(ee){ae=ie;var ce=ae.v;return((ae.f&CLEAN)===0&&ae.reactions!==null||depends_on_old_values(ae))&&(ce=execute_derived(ae)),old_values.set(ae,ce),ce}}else if(ee){if(ae=ie,batch_deriveds!=null&&batch_deriveds.has(ae))return batch_deriveds.get(ae);is_dirty(ae)&&update_derived(ae)}if((ie.f&ERROR_VALUE)!==0)throw ie.v;return ie.v}function depends_on_old_values(ie){if(ie.v===UNINITIALIZED)return!0;if(ie.deps===null)return!1;for(const te of ie.deps)if(old_values.has(te)||(te.f&DERIVED)!==0&&depends_on_old_values(te))return!0;return!1}function untrack(ie){var te=untracking;try{return untracking=!0,ie()}finally{untracking=te}}const STATUS_MASK=-7169;function set_signal_status(ie,te){ie.f=ie.f&STATUS_MASK|te}function deep_read_state(ie){if(!(typeof ie!="object"||!ie||ie instanceof EventTarget)){if(STATE_SYMBOL in ie)deep_read(ie);else if(!Array.isArray(ie))for(let te in ie){const ee=ie[te];typeof ee=="object"&&ee&&STATE_SYMBOL in ee&&deep_read(ee)}}}function deep_read(ie,te=new Set){if(typeof ie=="object"&&ie!==null&&!(ie instanceof EventTarget)&&!te.has(ie)){te.add(ie),ie instanceof Date&&ie.getTime();for(let ne in ie)try{deep_read(ie[ne],te)}catch{}const ee=get_prototype_of(ie);if(ee!==Object.prototype&&ee!==Array.prototype&&ee!==Map.prototype&&ee!==Set.prototype&&ee!==Date.prototype){const ne=get_descriptors(ee);for(let re in ne){const se=ne[re].get;if(se)try{se.call(ie)}catch{}}}}}function is_capture_event(ie){return ie.endsWith("capture")&&ie!=="gotpointercapture"&&ie!=="lostpointercapture"}const DELEGATED_EVENTS=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function is_delegated(ie){return DELEGATED_EVENTS.includes(ie)}const ATTRIBUTE_ALIASES={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function normalize_attribute(ie){return ie=ie.toLowerCase(),ATTRIBUTE_ALIASES[ie]??ie}const PASSIVE_EVENTS=["touchstart","touchmove"];function is_passive_event(ie){return PASSIVE_EVENTS.includes(ie)}function autofocus(ie,te){if(te){const ee=document.body;ie.autofocus=!0,queue_micro_task(()=>{document.activeElement===ee&&ie.focus()})}}let listening_to_form_reset=!1,form_reset_listener=null;function add_form_reset_listener(){listening_to_form_reset||(listening_to_form_reset=!0,form_reset_listener=ie=>{Promise.resolve().then(()=>{var te;if(!ie.defaultPrevented)for(const ee of ie.target.elements)(te=ee.__on_r)==null||te.call(ee)})},document.addEventListener("reset",form_reset_listener,{capture:!0}))}function remove_form_reset_listener(){listening_to_form_reset&&(listening_to_form_reset=!1,document.removeEventListener("reset",form_reset_listener,{capture:!0}))}function without_reactive_context(ie){var te=active_reaction,ee=active_effect;set_active_reaction(null),set_active_effect(null);try{return ie()}finally{set_active_reaction(te),set_active_effect(ee)}}function listen_to_event_and_reset_event(ie,te,ee,ne=ee){ie.addEventListener(te,()=>without_reactive_context(ee));const re=ie.__on_r;re?ie.__on_r=()=>{re(),ne(!0)}:ie.__on_r=()=>ne(!0),add_form_reset_listener()}const all_registered_events=new Set,root_event_handles=new Set;function create_event(ie,te,ee,ne={}){function re(se){if(ne.capture||handle_event_propagation.call(te,se),!se.cancelBubble)return without_reactive_context(()=>ee==null?void 0:ee.call(this,se))}return ie.startsWith("pointer")||ie.startsWith("touch")||ie==="wheel"?queue_micro_task(()=>{te.addEventListener(ie,re,ne)}):te.addEventListener(ie,re,ne),re}function on$1(ie,te,ee,ne={}){var re=create_event(te,ie,ee,ne);return()=>{ie.removeEventListener(te,re,ne)}}function event(ie,te,ee,ne,re){var se={capture:ne,passive:re},ae=create_event(ie,te,ee,se);(te===document.body||te===window||te===document||te instanceof HTMLMediaElement)&&teardown(()=>{te.removeEventListener(ie,ae,se)})}function delegate(ie){for(var te=0;te<ie.length;te++)all_registered_events.add(ie[te]);for(var ee of root_event_handles)ee(ie)}let last_propagated_event=null;function handle_event_propagation(ie){var We;var te=this,ee=te.ownerDocument,ne=ie.type,re=((We=ie.composedPath)==null?void 0:We.call(ie))||[],se=re[0]||ie.target;last_propagated_event=ie;var ae=0,le=last_propagated_event===ie&&ie.__root;if(le){var ce=re.indexOf(le);if(ce!==-1&&(te===document||te===window)){ie.__root=te;return}var he=re.indexOf(te);if(he===-1)return;ce<=he&&(ae=ce)}if(se=re[ae]||ie.target,se!==te){define_property(ie,"currentTarget",{configurable:!0,get(){return se||ee}});var fe=active_reaction,Ae=active_effect;set_active_reaction(null),set_active_effect(null);try{for(var pe,Oe=[];se!==null;){var Fe=se.assignedSlot||se.parentNode||se.host||null;try{var Ne=se["__"+ne];if(Ne!=null&&(!se.disabled||ie.target===se))if(is_array(Ne)){var[ze,...He]=Ne;ze.apply(se,[ie,...He])}else Ne.call(se,ie)}catch(je){pe?Oe.push(je):pe=je}if(ie.cancelBubble||Fe===te||Fe===null)break;se=Fe}if(pe){for(let je of Oe)queueMicrotask(()=>{throw je});throw pe}}finally{ie.__root=te,delete ie.currentTarget,set_active_reaction(fe),set_active_effect(Ae)}}}function clear_event_propagation(){last_propagated_event=null}function create_fragment_from_html(ie){var te=document.createElement("template");return te.innerHTML=ie.replaceAll("<!>","<!---->"),te.content}function assign_nodes(ie,te){var ee=active_effect;ee.nodes_start===null&&(ee.nodes_start=ie,ee.nodes_end=te)}function from_html(ie,te){var ee=(te&TEMPLATE_FRAGMENT)!==0,ne=(te&TEMPLATE_USE_IMPORT_NODE)!==0,re,se=!ie.startsWith("<!>");return()=>{re===void 0&&(re=create_fragment_from_html(se?ie:"<!>"+ie),ee||(re=get_first_child(re)));var ae=ne||is_firefox?document.importNode(re,!0):re.cloneNode(!0);if(ee){var le=get_first_child(ae),ce=ae.lastChild;assign_nodes(le,ce)}else assign_nodes(ae,ae);return ae}}function from_namespace(ie,te,ee="svg"){var ne=!ie.startsWith("<!>"),re=`<${ee}>${ne?ie:"<!>"+ie}</${ee}>`,se;return()=>{if(!se){var ae=create_fragment_from_html(re),le=get_first_child(ae);se=get_first_child(le)}var ce=se.cloneNode(!0);return assign_nodes(ce,ce),ce}}function from_svg(ie,te){return from_namespace(ie,te,"svg")}function text(ie=""){{var te=create_text(ie+"");return assign_nodes(te,te),te}}function comment(){var ie=document.createDocumentFragment(),te=document.createComment(""),ee=create_text();return ie.append(te,ee),assign_nodes(te,ee),ie}function append(ie,te){ie!==null&&ie.before(te)}function set_text(ie,te){var ee=te==null?"":typeof te=="object"?te+"":te;ee!==(ie.__t??(ie.__t=ie.nodeValue))&&(ie.__t=ee,ie.nodeValue=ee+"")}function mount(ie,te){return _mount(ie,te)}const document_listeners=new Map;function _mount(ie,{target:te,anchor:ee,props:ne={},events:re,context:se,intro:ae=!0}){init_operations();var le=new Set,ce=Ae=>{for(var pe=0;pe<Ae.length;pe++){var Oe=Ae[pe];if(!le.has(Oe)){le.add(Oe);var Fe=is_passive_event(Oe);te.addEventListener(Oe,handle_event_propagation,{passive:Fe});var Ne=document_listeners.get(Oe);Ne===void 0?(document.addEventListener(Oe,handle_event_propagation,{passive:Fe}),document_listeners.set(Oe,1)):document_listeners.set(Oe,Ne+1)}}};ce(array_from(all_registered_events)),root_event_handles.add(ce);var he=void 0,fe=component_root(()=>{var Ae=ee??te.appendChild(create_text());return branch(()=>{if(se){push({});var pe=component_context;pe.c=se}re&&(ne.$$events=re),he=ie(Ae,ne)||{},se&&pop()}),()=>{var Fe;for(var pe of le){te.removeEventListener(pe,handle_event_propagation);var Oe=document_listeners.get(pe);--Oe===0?(document.removeEventListener(pe,handle_event_propagation),document_listeners.delete(pe)):document_listeners.set(pe,Oe)}root_event_handles.delete(ce),Ae!==ee&&((Fe=Ae.parentNode)==null||Fe.removeChild(Ae))}});return mounted_components.set(he,fe),he}let mounted_components=new WeakMap;function unmount(ie,te){const ee=mounted_components.get(ie);return ee?(mounted_components.delete(ie),ee(te)):Promise.resolve()}function if_block(ie,te,ee=!1){var ne=ie,re=null,se=null,ae=UNINITIALIZED,le=ee?EFFECT_TRANSPARENT:0,ce=!1;const he=(Oe,Fe=!0)=>{ce=!0,pe(Fe,Oe)};var fe=null;function Ae(){fe!==null&&(fe.lastChild.remove(),ne.before(fe),fe=null);var Oe=ae?re:se,Fe=ae?se:re;Oe&&resume_effect(Oe),Fe&&pause_effect(Fe,()=>{ae?se=null:re=null})}const pe=(Oe,Fe)=>{if(ae!==(ae=Oe)){var Ne=should_defer_append(),ze=ne;if(Ne&&(fe=document.createDocumentFragment(),fe.append(ze=create_text())),ae?re??(re=Fe&&branch(()=>Fe(ze))):se??(se=Fe&&branch(()=>Fe(ze))),Ne){var He=current_batch,We=ae?re:se,je=ae?se:re;We&&He.skipped_effects.delete(We),je&&He.skipped_effects.add(je),He.add_callback(Ae)}else Ae()}};block(()=>{ce=!1,te(he),ce||pe(null,null)},le)}function key(ie,te,ee){var ne=ie,re=UNINITIALIZED,se,ae,le=null,ce=is_runes()?not_equal:safe_not_equal;function he(){se&&pause_effect(se),le!==null&&(le.lastChild.remove(),ne.before(le),le=null),se=ae}block(()=>{if(ce(re,re=te())){var fe=ne,Ae=should_defer_append();Ae&&(le=document.createDocumentFragment(),le.append(fe=create_text())),ae=branch(()=>ee(fe)),Ae?current_batch.add_callback(he):he()}})}function index(ie,te){return te}function pause_effects(ie,te,ee){for(var ne=ie.items,re=[],se=te.length,ae=0;ae<se;ae++)pause_children(te[ae].e,re,!0);var le=se>0&&re.length===0&&ee!==null;if(le){var ce=ee.parentNode;clear_text_content(ce),ce.append(ee),ne.clear(),link(ie,te[0].prev,te[se-1].next)}run_out_transitions(re,()=>{for(var he=0;he<se;he++){var fe=te[he];le||(ne.delete(fe.k),link(ie,fe.prev,fe.next)),destroy_effect(fe.e,!le)}})}function each(ie,te,ee,ne,re,se=null){var ae=ie,le={flags:te,items:new Map,first:null},ce=(te&EACH_IS_CONTROLLED)!==0;if(ce){var he=ie;ae=he.appendChild(create_text())}var fe=null,Ae=!1,pe=new Map,Oe=derived_safe_equal(()=>{var He=ee();return is_array(He)?He:He==null?[]:array_from(He)}),Fe,Ne;function ze(){reconcile(Ne,Fe,le,pe,ae,re,te,ne,ee),se!==null&&(Fe.length===0?fe?resume_effect(fe):fe=branch(()=>se(ae)):fe!==null&&pause_effect(fe,()=>{fe=null}))}block(()=>{Ne??(Ne=active_effect),Fe=get$2(Oe);var He=Fe.length;if(!(Ae&&He===0)){Ae=He===0;var We,je,Ue,Ge;if(should_defer_append()){var Ze=new Set,Ye=current_batch;for(je=0;je<He;je+=1){Ue=Fe[je],Ge=ne(Ue,je);var qe=le.items.get(Ge)??pe.get(Ge);qe?(te&(EACH_ITEM_REACTIVE|EACH_INDEX_REACTIVE))!==0&&update_item(qe,Ue,je,te):(We=create_item(null,le,null,null,Ue,Ge,je,re,te,ee,!0),pe.set(Ge,We)),Ze.add(Ge)}for(const[nr,ir]of le.items)Ze.has(nr)||Ye.skipped_effects.add(ir.e);Ye.add_callback(ze)}else ze();get$2(Oe)}})}function reconcile(ie,te,ee,ne,re,se,ae,le,ce){var Pr,mr,Er,dr;var he=(ae&EACH_IS_ANIMATED)!==0,fe=(ae&(EACH_ITEM_REACTIVE|EACH_INDEX_REACTIVE))!==0,Ae=te.length,pe=ee.items,Oe=ee.first,Fe=Oe,Ne,ze=null,He,We=[],je=[],Ue,Ge,Ze,Ye;if(he)for(Ye=0;Ye<Ae;Ye+=1)Ue=te[Ye],Ge=le(Ue,Ye),Ze=pe.get(Ge),Ze!==void 0&&((Pr=Ze.a)==null||Pr.measure(),(He??(He=new Set)).add(Ze));for(Ye=0;Ye<Ae;Ye+=1){if(Ue=te[Ye],Ge=le(Ue,Ye),Ze=pe.get(Ge),Ze===void 0){var qe=ne.get(Ge);if(qe!==void 0){ne.delete(Ge),pe.set(Ge,qe);var nr=ze?ze.next:Fe;link(ee,ze,qe),link(ee,qe,nr),move(qe,nr,re),ze=qe}else{var ir=Fe?Fe.e.nodes_start:re;ze=create_item(ir,ee,ze,ze===null?ee.first:ze.next,Ue,Ge,Ye,se,ae,ce)}pe.set(Ge,ze),We=[],je=[],Fe=ze.next;continue}if(fe&&update_item(Ze,Ue,Ye,ae),(Ze.e.f&INERT)!==0&&(resume_effect(Ze.e),he&&((mr=Ze.a)==null||mr.unfix(),(He??(He=new Set)).delete(Ze))),Ze!==Fe){if(Ne!==void 0&&Ne.has(Ze)){if(We.length<je.length){var tr=je[0],or;ze=tr.prev;var Jt=We[0],rr=We[We.length-1];for(or=0;or<We.length;or+=1)move(We[or],tr,re);for(or=0;or<je.length;or+=1)Ne.delete(je[or]);link(ee,Jt.prev,rr.next),link(ee,ze,Jt),link(ee,rr,tr),Fe=tr,ze=rr,Ye-=1,We=[],je=[]}else Ne.delete(Ze),move(Ze,Fe,re),link(ee,Ze.prev,Ze.next),link(ee,Ze,ze===null?ee.first:ze.next),link(ee,ze,Ze),ze=Ze;continue}for(We=[],je=[];Fe!==null&&Fe.k!==Ge;)(Fe.e.f&INERT)===0&&(Ne??(Ne=new Set)).add(Fe),je.push(Fe),Fe=Fe.next;if(Fe===null)continue;Ze=Fe}We.push(Ze),ze=Ze,Fe=Ze.next}if(Fe!==null||Ne!==void 0){for(var lr=Ne===void 0?[]:array_from(Ne);Fe!==null;)(Fe.e.f&INERT)===0&&lr.push(Fe),Fe=Fe.next;var ur=lr.length;if(ur>0){var Sr=(ae&EACH_IS_CONTROLLED)!==0&&Ae===0?re:null;if(he){for(Ye=0;Ye<ur;Ye+=1)(Er=lr[Ye].a)==null||Er.measure();for(Ye=0;Ye<ur;Ye+=1)(dr=lr[Ye].a)==null||dr.fix()}pause_effects(ee,lr,Sr)}}he&&queue_micro_task(()=>{var Cr;if(He!==void 0)for(Ze of He)(Cr=Ze.a)==null||Cr.apply()}),ie.first=ee.first&&ee.first.e,ie.last=ze&&ze.e;for(var xr of ne.values())destroy_effect(xr.e);ne.clear()}function update_item(ie,te,ee,ne){(ne&EACH_ITEM_REACTIVE)!==0&&internal_set(ie.v,te),(ne&EACH_INDEX_REACTIVE)!==0?internal_set(ie.i,ee):ie.i=ee}function create_item(ie,te,ee,ne,re,se,ae,le,ce,he,fe){var Ae=(ce&EACH_ITEM_REACTIVE)!==0,pe=(ce&EACH_ITEM_IMMUTABLE)===0,Oe=Ae?pe?mutable_source(re,!1,!1):source(re):re,Fe=(ce&EACH_INDEX_REACTIVE)===0?ae:source(ae),Ne={i:Fe,v:Oe,k:se,a:null,e:null,prev:ee,next:ne};try{if(ie===null){var ze=document.createDocumentFragment();ze.append(ie=create_text())}return Ne.e=branch(()=>le(ie,Oe,Fe,he),hydrating),Ne.e.prev=ee&&ee.e,Ne.e.next=ne&&ne.e,ee===null?fe||(te.first=Ne):(ee.next=Ne,ee.e.next=Ne.e),ne!==null&&(ne.prev=Ne,ne.e.prev=Ne.e),Ne}finally{}}function move(ie,te,ee){for(var ne=ie.next?ie.next.e.nodes_start:ee,re=te?te.e.nodes_start:ee,se=ie.e.nodes_start;se!==null&&se!==ne;){var ae=get_next_sibling(se);re.before(se),se=ae}}function link(ie,te,ee){te===null?ie.first=ee:(te.next=ee,te.e.next=ee&&ee.e),ee!==null&&(ee.prev=te,ee.e.prev=te&&te.e)}function html(ie,te,ee=!1,ne=!1,re=!1){var se=ie,ae="";template_effect(()=>{var le=active_effect;if(ae!==(ae=te()??"")&&(le.nodes_start!==null&&(remove_effect_dom(le.nodes_start,le.nodes_end),le.nodes_start=le.nodes_end=null),ae!=="")){var ce=ae+"";ee?ce=`<svg>${ce}</svg>`:ne&&(ce=`<math>${ce}</math>`);var he=create_fragment_from_html(ce);if((ee||ne)&&(he=get_first_child(he)),assign_nodes(get_first_child(he),he.lastChild),ee||ne)for(;get_first_child(he);)se.before(get_first_child(he));else se.before(he)}})}function slot(ie,te,ee,ne,re){var le;var se=(le=te.$$slots)==null?void 0:le[ee],ae=!1;se===!0&&(se=te.children,ae=!0),se===void 0||se(ie,ae?()=>ne:ne)}function snippet(ie,te,...ee){var ne=ie,re=noop$1,se;block(()=>{re!==(re=te())&&(se&&(destroy_effect(se),se=null),se=branch(()=>re(ne,...ee)))},EFFECT_TRANSPARENT)}function component(ie,te,ee){var ne=ie,re,se,ae=null,le=null;function ce(){se&&(pause_effect(se),se=null),ae&&(ae.lastChild.remove(),ne.before(ae),ae=null),se=le,le=null}block(()=>{if(re!==(re=te())){var he=should_defer_append();if(re){var fe=ne;he&&(ae=document.createDocumentFragment(),ae.append(fe=create_text())),le=branch(()=>ee(fe,re))}he?current_batch.add_callback(ce):ce()}},EFFECT_TRANSPARENT)}function element(ie,te,ee,ne,re,se){var ae,le,ce=null,he=ie,fe;block(()=>{const Ae=te()||null;var pe=Ae==="svg"?NAMESPACE_SVG:null;Ae!==ae&&(fe&&(Ae===null?pause_effect(fe,()=>{fe=null,le=null}):Ae===le?resume_effect(fe):destroy_effect(fe)),Ae&&Ae!==le&&(fe=branch(()=>{if(ce=pe?document.createElementNS(pe,Ae):document.createElement(Ae),assign_nodes(ce,ce),ne){var Oe=ce.appendChild(create_text());ne(ce,Oe)}active_effect.nodes_end=ce,he.before(ce)})),ae=Ae,ae&&(le=ae))},EFFECT_TRANSPARENT)}function action(ie,te,ee){effect(()=>{var ne=untrack(()=>te(ie,ee==null?void 0:ee())||{});if(ee&&(ne!=null&&ne.update)){var re=!1,se={};render_effect(()=>{var ae=ee();deep_read_state(ae),re&&safe_not_equal(se,ae)&&(se=ae,ne.update(ae))}),re=!0}if(ne!=null&&ne.destroy)return()=>ne.destroy()})}function attach(ie,te){var ee=void 0,ne;block(()=>{ee!==(ee=te())&&(ne&&(destroy_effect(ne),ne=null),ee&&(ne=branch(()=>{effect(()=>ee(ie))})))})}function r$2(ie){var te,ee,ne="";if(typeof ie=="string"||typeof ie=="number")ne+=ie;else if(typeof ie=="object")if(Array.isArray(ie)){var re=ie.length;for(te=0;te<re;te++)ie[te]&&(ee=r$2(ie[te]))&&(ne&&(ne+=" "),ne+=ee)}else for(ee in ie)ie[ee]&&(ne&&(ne+=" "),ne+=ee);return ne}function clsx$1(){for(var ie,te,ee=0,ne="",re=arguments.length;ee<re;ee++)(ie=arguments[ee])&&(te=r$2(ie))&&(ne&&(ne+=" "),ne+=te);return ne}function clsx(ie){return typeof ie=="object"?clsx$1(ie):ie??""}const whitespace=[...` 	
\r\f \v\uFEFF`];function to_class(ie,te,ee){var ne=ie==null?"":""+ie;if(te&&(ne=ne?ne+" "+te:te),ee){for(var re in ee)if(ee[re])ne=ne?ne+" "+re:re;else if(ne.length)for(var se=re.length,ae=0;(ae=ne.indexOf(re,ae))>=0;){var le=ae+se;(ae===0||whitespace.includes(ne[ae-1]))&&(le===ne.length||whitespace.includes(ne[le]))?ne=(ae===0?"":ne.substring(0,ae))+ne.substring(le+1):ae=le}}return ne===""?null:ne}function append_styles(ie,te=!1){var ee=te?" !important;":";",ne="";for(var re in ie){var se=ie[re];se!=null&&se!==""&&(ne+=" "+re+": "+se+ee)}return ne}function to_css_name(ie){return ie[0]!=="-"||ie[1]!=="-"?ie.toLowerCase():ie}function to_style(ie,te){if(te){var ee="",ne,re;if(Array.isArray(te)?(ne=te[0],re=te[1]):ne=te,ie){ie=String(ie).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var se=!1,ae=0,le=!1,ce=[];ne&&ce.push(...Object.keys(ne).map(to_css_name)),re&&ce.push(...Object.keys(re).map(to_css_name));var he=0,fe=-1;const Ne=ie.length;for(var Ae=0;Ae<Ne;Ae++){var pe=ie[Ae];if(le?pe==="/"&&ie[Ae-1]==="*"&&(le=!1):se?se===pe&&(se=!1):pe==="/"&&ie[Ae+1]==="*"?le=!0:pe==='"'||pe==="'"?se=pe:pe==="("?ae++:pe===")"&&ae--,!le&&se===!1&&ae===0){if(pe===":"&&fe===-1)fe=Ae;else if(pe===";"||Ae===Ne-1){if(fe!==-1){var Oe=to_css_name(ie.substring(he,fe).trim());if(!ce.includes(Oe)){pe!==";"&&Ae++;var Fe=ie.substring(he,Ae).trim();ee+=" "+Fe+";"}}he=Ae+1,fe=-1}}}}return ne&&(ee+=append_styles(ne)),re&&(ee+=append_styles(re,!0)),ee=ee.trim(),ee===""?null:ee}return ie==null?null:String(ie)}function set_class(ie,te,ee,ne,re,se){var ae=ie.__className;if(ae!==ee||ae===void 0){var le=to_class(ee,ne,se);le==null?ie.removeAttribute("class"):te?ie.className=le:ie.setAttribute("class",le),ie.__className=ee}else if(se&&re!==se)for(var ce in se){var he=!!se[ce];(re==null||he!==!!re[ce])&&ie.classList.toggle(ce,he)}return se}function update_styles(ie,te={},ee,ne){for(var re in ee){var se=ee[re];te[re]!==se&&(ee[re]==null?ie.style.removeProperty(re):ie.style.setProperty(re,se,ne))}}function set_style(ie,te,ee,ne){var re=ie.__style;if(re!==te){var se=to_style(te,ne);se==null?ie.removeAttribute("style"):ie.style.cssText=se,ie.__style=te}else ne&&(Array.isArray(ne)?(update_styles(ie,ee==null?void 0:ee[0],ne[0]),update_styles(ie,ee==null?void 0:ee[1],ne[1],"important")):update_styles(ie,ee,ne));return ne}function select_option(ie,te,ee=!1){if(ie.multiple){if(te==null)return;if(!is_array(te))return select_multiple_invalid_value();for(var ne of ie.options)ne.selected=te.includes(get_option_value(ne));return}for(ne of ie.options){var re=get_option_value(ne);if(is$1(re,te)){ne.selected=!0;return}}(!ee||te!==void 0)&&(ie.selectedIndex=-1)}function init_select(ie){var te=new MutationObserver(()=>{select_option(ie,ie.__value)});te.observe(ie,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),teardown(()=>{te.disconnect()})}function get_option_value(ie){return"__value"in ie?ie.__value:ie.value}const CLASS=Symbol("class"),STYLE=Symbol("style"),IS_CUSTOM_ELEMENT=Symbol("is custom element"),IS_HTML=Symbol("is html");function set_selected(ie,te){te?ie.hasAttribute("selected")||ie.setAttribute("selected",""):ie.removeAttribute("selected")}function set_attribute(ie,te,ee,ne){var re=get_attributes(ie);re[te]!==(re[te]=ee)&&(te==="loading"&&(ie[LOADING_ATTR_SYMBOL]=ee),ee==null?ie.removeAttribute(te):typeof ee!="string"&&get_setters(ie).includes(te)?ie[te]=ee:ie.setAttribute(te,ee))}function set_attributes(ie,te,ee,ne,re=!1){var se=get_attributes(ie),ae=se[IS_CUSTOM_ELEMENT],le=!se[IS_HTML],ce=te||{},he=ie.tagName==="OPTION";for(var fe in te)fe in ee||(ee[fe]=null);ee.class?ee.class=clsx(ee.class):(ne||ee[CLASS])&&(ee.class=null),ee[STYLE]&&(ee.style??(ee.style=null));var Ae=get_setters(ie);for(const We in ee){let je=ee[We];if(he&&We==="value"&&je==null){ie.value=ie.__value="",ce[We]=je;continue}if(We==="class"){var pe=ie.namespaceURI==="http://www.w3.org/1999/xhtml";set_class(ie,pe,je,ne,te==null?void 0:te[CLASS],ee[CLASS]),ce[We]=je,ce[CLASS]=ee[CLASS];continue}if(We==="style"){set_style(ie,je,te==null?void 0:te[STYLE],ee[STYLE]),ce[We]=je,ce[STYLE]=ee[STYLE];continue}var Oe=ce[We];if(!(je===Oe&&!(je===void 0&&ie.hasAttribute(We)))){ce[We]=je;var Fe=We[0]+We[1];if(Fe!=="$$")if(Fe==="on"){const Ue={},Ge="$$"+We;let Ze=We.slice(2);var Ne=is_delegated(Ze);if(is_capture_event(Ze)&&(Ze=Ze.slice(0,-7),Ue.capture=!0),!Ne&&Oe){if(je!=null)continue;ie.removeEventListener(Ze,ce[Ge],Ue),ce[Ge]=null}if(je!=null)if(Ne)ie[`__${Ze}`]=je,delegate([Ze]);else{let Ye=function(qe){ce[We].call(this,qe)};ce[Ge]=create_event(Ze,ie,Ye,Ue)}else Ne&&(ie[`__${Ze}`]=void 0)}else if(We==="style")set_attribute(ie,We,je);else if(We==="autofocus")autofocus(ie,!!je);else if(!ae&&(We==="__value"||We==="value"&&je!=null))ie.value=ie.__value=je;else if(We==="selected"&&he)set_selected(ie,je);else{var ze=We;le||(ze=normalize_attribute(ze));var He=ze==="defaultValue"||ze==="defaultChecked";if(je==null&&!ae&&!He)if(se[We]=null,ze==="value"||ze==="checked"){let Ue=ie;const Ge=te===void 0;if(ze==="value"){let Ze=Ue.defaultValue;Ue.removeAttribute(ze),Ue.defaultValue=Ze,Ue.value=Ue.__value=Ge?Ze:null}else{let Ze=Ue.defaultChecked;Ue.removeAttribute(ze),Ue.defaultChecked=Ze,Ue.checked=Ge?Ze:!1}}else ie.removeAttribute(We);else He||Ae.includes(ze)&&(ae||typeof je!="string")?(ie[ze]=je,ze in se&&(se[ze]=UNINITIALIZED)):typeof je!="function"&&set_attribute(ie,ze,je)}}}return ce}function attribute_effect(ie,te,ee=[],ne=[],re,se=!1){flatten$1(ee,ne,ae=>{var le=void 0,ce={},he=ie.nodeName==="SELECT",fe=!1;if(block(()=>{var pe=te(...ae.map(get$2)),Oe=set_attributes(ie,le,pe,re,se);fe&&he&&"value"in pe&&select_option(ie,pe.value);for(let Ne of Object.getOwnPropertySymbols(ce))pe[Ne]||destroy_effect(ce[Ne]);for(let Ne of Object.getOwnPropertySymbols(pe)){var Fe=pe[Ne];Ne.description===ATTACHMENT_KEY&&(!le||Fe!==le[Ne])&&(ce[Ne]&&destroy_effect(ce[Ne]),ce[Ne]=branch(()=>attach(ie,()=>Fe))),Oe[Ne]=Fe}le=Oe}),he){var Ae=ie;effect(()=>{select_option(Ae,le.value,!0),init_select(Ae)})}fe=!0})}function get_attributes(ie){return ie.__attributes??(ie.__attributes={[IS_CUSTOM_ELEMENT]:ie.nodeName.includes("-"),[IS_HTML]:ie.namespaceURI===NAMESPACE_HTML})}var setters_cache=new Map;function get_setters(ie){var te=setters_cache.get(ie.nodeName);if(te)return te;setters_cache.set(ie.nodeName,te=[]);for(var ee,ne=ie,re=Element.prototype;re!==ne;){ee=get_descriptors(ne);for(var se in ee)ee[se].set&&te.push(se);ne=get_prototype_of(ne)}return te}function bind_value(ie,te,ee=te){var ne=is_runes(),re=new WeakSet;listen_to_event_and_reset_event(ie,"input",se=>{var ae=se?ie.defaultValue:ie.value;if(ae=is_numberlike_input(ie)?to_number(ae):ae,ee(ae),current_batch!==null&&re.add(current_batch),ne&&ae!==(ae=te())){var le=ie.selectionStart,ce=ie.selectionEnd;ie.value=ae??"",ce!==null&&(ie.selectionStart=le,ie.selectionEnd=Math.min(ce,ie.value.length))}}),untrack(te)==null&&ie.value&&(ee(is_numberlike_input(ie)?to_number(ie.value):ie.value),current_batch!==null&&re.add(current_batch)),render_effect(()=>{var se=te();if(ie===document.activeElement){var ae=previous_batch??current_batch;if(re.has(ae))return}is_numberlike_input(ie)&&se===to_number(ie.value)||ie.type==="date"&&!se&&!ie.value||se!==ie.value&&(ie.value=se??"")})}function is_numberlike_input(ie){var te=ie.type;return te==="number"||te==="range"}function to_number(ie){return ie===""?null:+ie}var Na,v0,B0,El,Vu;const Dl=class Dl{constructor(te){Mo(this,El);Mo(this,Na,new WeakMap);Mo(this,v0);Mo(this,B0);Ho(this,B0,te)}observe(te,ee){var ne=Qr(this,Na).get(te)||new Set;return ne.add(ee),Qr(this,Na).set(te,ne),Va(this,El,Vu).call(this).observe(te,Qr(this,B0)),()=>{var re=Qr(this,Na).get(te);re.delete(ee),re.size===0&&(Qr(this,Na).delete(te),Qr(this,v0).unobserve(te))}}};Na=new WeakMap,v0=new WeakMap,B0=new WeakMap,El=new WeakSet,Vu=function(){return Qr(this,v0)??Ho(this,v0,new ResizeObserver(te=>{for(var ee of te){Dl.entries.set(ee.target,ee);for(var ne of Qr(this,Na).get(ee.target)||[])ne(ee)}}))},Ee(Dl,"entries",new WeakMap);let ResizeObserverSingleton=Dl;var resize_observer_content_box=new ResizeObserverSingleton({box:"content-box"});function bind_resize_observer(ie,te,ee){var ne=resize_observer_content_box,re=ne.observe(ie,se=>ee(se[te]));teardown(re)}function is_bound_this(ie,te){return ie===te||(ie==null?void 0:ie[STATE_SYMBOL])===te}function bind_this(ie={},te,ee,ne){return effect(()=>{var re,se;return render_effect(()=>{re=se,se=[],untrack(()=>{ie!==ee(...se)&&(te(ie,...se),re&&is_bound_this(ee(...re),ie)&&te(null,...re))})}),()=>{queue_micro_task(()=>{se&&is_bound_this(ee(...se),ie)&&te(null,...se)})}}),ie}function init$1(ie=!1){const te=component_context,ee=te.l.u;if(!ee)return;let ne=()=>deep_read_state(te.s);if(ie){let re=0,se={};const ae=derived$1(()=>{let le=!1;const ce=te.s;for(const he in ce)ce[he]!==se[he]&&(se[he]=ce[he],le=!0);return le&&re++,re});ne=()=>get$2(ae)}ee.b.length&&user_pre_effect(()=>{observe_all(te,ne),run_all(ee.b)}),user_effect(()=>{const re=untrack(()=>ee.m.map(run));return()=>{for(const se of re)typeof se=="function"&&se()}}),ee.a.length&&user_effect(()=>{observe_all(te,ne),run_all(ee.a)})}function observe_all(ie,te){if(ie.l.s)for(const ee of ie.l.s)get$2(ee);te()}function subscribe_to_store(ie,te,ee){if(ie==null)return te(void 0),ee&&ee(void 0),noop$1;const ne=untrack(()=>ie.subscribe(te,ee));return ne.unsubscribe?()=>ne.unsubscribe():ne}const subscriber_queue=[];function readable(ie,te){return{subscribe:writable(ie,te).subscribe}}function writable(ie,te=noop$1){let ee=null;const ne=new Set;function re(le){if(safe_not_equal(ie,le)&&(ie=le,ee)){const ce=!subscriber_queue.length;for(const he of ne)he[1](),subscriber_queue.push(he,ie);if(ce){for(let he=0;he<subscriber_queue.length;he+=2)subscriber_queue[he][0](subscriber_queue[he+1]);subscriber_queue.length=0}}}function se(le){re(le(ie))}function ae(le,ce=noop$1){const he=[le,ce];return ne.add(he),ne.size===1&&(ee=te(re,se)||noop$1),le(ie),()=>{ne.delete(he),ne.size===0&&ee&&(ee(),ee=null)}}return{set:re,update:se,subscribe:ae}}function derived(ie,te,ee){const ne=!Array.isArray(ie),re=ne?[ie]:ie;if(!re.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const se=te.length<2;return readable(ee,(ae,le)=>{let ce=!1;const he=[];let fe=0,Ae=noop$1;const pe=()=>{if(fe)return;Ae();const Fe=te(ne?he[0]:he,ae,le);se?ae(Fe):Ae=typeof Fe=="function"?Fe:noop$1},Oe=re.map((Fe,Ne)=>subscribe_to_store(Fe,ze=>{he[Ne]=ze,fe&=~(1<<Ne),ce&&pe()},()=>{fe|=1<<Ne}));return ce=!0,pe(),function(){run_all(Oe),Ae(),ce=!1}})}function get$1(ie){let te;return subscribe_to_store(ie,ee=>te=ee)(),te}let is_store_binding=!1,IS_UNMOUNTED=Symbol();function store_get(ie,te,ee){const ne=ee[te]??(ee[te]={store:null,source:mutable_source(void 0),unsubscribe:noop$1});if(ne.store!==ie&&!(IS_UNMOUNTED in ee))if(ne.unsubscribe(),ne.store=ie??null,ie==null)ne.source.v=void 0,ne.unsubscribe=noop$1;else{var re=!0;ne.unsubscribe=subscribe_to_store(ie,se=>{re?ne.source.v=se:set(ne.source,se)}),re=!1}return ie&&IS_UNMOUNTED in ee?get$1(ie):get$2(ne.source)}function store_set(ie,te){return ie.set(te),te}function setup_stores(){const ie={};function te(){teardown(()=>{for(var ee in ie)ie[ee].unsubscribe();define_property(ie,IS_UNMOUNTED,{enumerable:!1,value:!0})})}return[ie,te]}function capture_store_binding(ie){var te=is_store_binding;try{return is_store_binding=!1,[ie(),is_store_binding]}finally{is_store_binding=te}}const rest_props_handler={get(ie,te){if(!ie.exclude.includes(te))return ie.props[te]},set(ie,te){return!1},getOwnPropertyDescriptor(ie,te){if(!ie.exclude.includes(te)&&te in ie.props)return{enumerable:!0,configurable:!0,value:ie.props[te]}},has(ie,te){return ie.exclude.includes(te)?!1:te in ie.props},ownKeys(ie){return Reflect.ownKeys(ie.props).filter(te=>!ie.exclude.includes(te))}};function rest_props(ie,te,ee){return new Proxy({props:ie,exclude:te},rest_props_handler)}const spread_props_handler={get(ie,te){let ee=ie.props.length;for(;ee--;){let ne=ie.props[ee];if(is_function(ne)&&(ne=ne()),typeof ne=="object"&&ne!==null&&te in ne)return ne[te]}},set(ie,te,ee){let ne=ie.props.length;for(;ne--;){let re=ie.props[ne];is_function(re)&&(re=re());const se=get_descriptor(re,te);if(se&&se.set)return se.set(ee),!0}return!1},getOwnPropertyDescriptor(ie,te){let ee=ie.props.length;for(;ee--;){let ne=ie.props[ee];if(is_function(ne)&&(ne=ne()),typeof ne=="object"&&ne!==null&&te in ne){const re=get_descriptor(ne,te);return re&&!re.configurable&&(re.configurable=!0),re}}},has(ie,te){if(te===STATE_SYMBOL||te===LEGACY_PROPS)return!1;for(let ee of ie.props)if(is_function(ee)&&(ee=ee()),ee!=null&&te in ee)return!0;return!1},ownKeys(ie){const te=[];for(let ee of ie.props)if(is_function(ee)&&(ee=ee()),!!ee){for(const ne in ee)te.includes(ne)||te.push(ne);for(const ne of Object.getOwnPropertySymbols(ee))te.includes(ne)||te.push(ne)}return te}};function spread_props(...ie){return new Proxy({props:ie},spread_props_handler)}function prop(ie,te,ee,ne){var je;var re=!legacy_mode_flag||(ee&PROPS_IS_RUNES)!==0,se=(ee&PROPS_IS_BINDABLE)!==0,ae=(ee&PROPS_IS_LAZY_INITIAL)!==0,le=ne,ce=!0,he=()=>(ce&&(ce=!1,le=ae?untrack(ne):ne),le),fe;if(se){var Ae=STATE_SYMBOL in ie||LEGACY_PROPS in ie;fe=((je=get_descriptor(ie,te))==null?void 0:je.set)??(Ae&&te in ie?Ue=>ie[te]=Ue:void 0)}var pe,Oe=!1;se?[pe,Oe]=capture_store_binding(()=>ie[te]):pe=ie[te],pe===void 0&&ne!==void 0&&(pe=he(),fe&&(re&&props_invalid_value(),fe(pe)));var Fe;if(re?Fe=()=>{var Ue=ie[te];return Ue===void 0?he():(ce=!0,Ue)}:Fe=()=>{var Ue=ie[te];return Ue!==void 0&&(le=void 0),Ue===void 0?le:Ue},re&&(ee&PROPS_IS_UPDATED)===0)return Fe;if(fe){var Ne=ie.$$legacy;return function(Ue,Ge){return arguments.length>0?((!re||!Ge||Ne||Oe)&&fe(Ge?Fe():Ue),Ue):Fe()}}var ze=!1,He=((ee&PROPS_IS_IMMUTABLE)!==0?derived$1:derived_safe_equal)(()=>(ze=!1,Fe()));se&&get$2(He);var We=active_effect;return function(Ue,Ge){if(arguments.length>0){const Ze=Ge?get$2(He):re&&se?proxy(Ue):Ue;return set(He,Ze),ze=!0,le!==void 0&&(le=Ze),Ue}return is_destroying_effect&&ze||(We.f&DESTROYED)!==0?He.v:get$2(He)}}function onMount(ie){component_context===null&&lifecycle_outside_component(),legacy_mode_flag&&component_context.l!==null?init_update_callbacks(component_context).m.push(ie):user_effect(()=>{const te=untrack(ie);if(typeof te=="function")return te})}function onDestroy(ie){component_context===null&&lifecycle_outside_component(),onMount(()=>()=>untrack(ie))}function init_update_callbacks(ie){var te=ie.l;return te.u??(te.u={a:[],b:[],m:[]})}const IConfigurationService=createDecorator$1("configurationService");var MagnetMode=(ie=>(ie[ie.Normal=0]="Normal",ie[ie.StrongMagnet=1]="StrongMagnet",ie[ie.WeakMagnet=2]="WeakMagnet",ie))(MagnetMode||{});const DemoCursorMask=64,EraserCursorMask=32;var PaneCursor=(ie=>(ie[ie.unset=0]="unset",ie[ie.cross=0]="cross",ie[ie.dot=1]="dot",ie[ie.pointer=2]="pointer",ie[ie.arrow=3]="arrow",ie[ie.grabbing=4]="grabbing",ie[ie.ew=5]="ew",ie[ie.ns=6]="ns",ie[ie.nesw=7]="nesw",ie[ie.nwse=8]="nwse",ie[ie.text=9]="text",ie[ie.zoomIn=10]="zoomIn",ie[ie.eraser=EraserCursorMask]="eraser",ie[ie.demonstration=DemoCursorMask]="demonstration",ie))(PaneCursor||{});function showDemoCursor(ie){return(ie&DemoCursorMask)!==0}function showCursor(ie,te){return te===PaneCursor.demonstration?showDemoCursor(ie):(ie&-65)===te}function getCursorString(ie){return showCursor(ie,PaneCursor.eraser)&&ie!==PaneCursor.eraser&&(ie=PaneCursor.eraser),PaneCursor[ie]}function arrayMap(ie,te){for(var ee=-1,ne=ie==null?0:ie.length,re=Array(ne);++ee<ne;)re[ee]=te(ie[ee],ee,ie);return re}var isArray=Array.isArray,symbolProto$2=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(ie){if(typeof ie=="string")return ie;if(isArray(ie))return arrayMap(ie,baseToString)+"";if(isSymbol(ie))return symbolToString?symbolToString.call(ie):"";var te=ie+"";return te=="0"&&1/ie==-1/0?"-0":te}var INFINITY=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(ie){if(!ie)return ie===0?ie:0;if(ie=toNumber(ie),ie===INFINITY||ie===-1/0){var te=ie<0?-1:1;return te*MAX_INTEGER}return ie===ie?ie:0}function toInteger(ie){var te=toFinite(ie),ee=te%1;return te===te?ee?te-ee:te:0}function identity$1(ie){return ie}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(ie){if(!isObject(ie))return!1;var te=baseGetTag(ie);return te==funcTag$2||te==genTag$1||te==asyncTag||te==proxyTag}var coreJsData=root$y["__core-js_shared__"],maskSrcKey=function(){var ie=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return ie?"Symbol(src)_1."+ie:""}();function isMasked(ie){return!!maskSrcKey&&maskSrcKey in ie}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(ie){if(ie!=null){try{return funcToString$2.call(ie)}catch{}try{return ie+""}catch{}}return""}var reRegExpChar$1=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$f=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$d=objectProto$f.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$d).replace(reRegExpChar$1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(ie){if(!isObject(ie)||isMasked(ie))return!1;var te=isFunction$1(ie)?reIsNative:reIsHostCtor;return te.test(toSource(ie))}function getValue(ie,te){return ie==null?void 0:ie[te]}function getNative(ie,te){var ee=getValue(ie,te);return baseIsNative(ee)?ee:void 0}var WeakMap$1=getNative(root$y,"WeakMap"),objectCreate=Object.create,baseCreate=function(){function ie(){}return function(te){if(!isObject(te))return{};if(objectCreate)return objectCreate(te);ie.prototype=te;var ee=new ie;return ie.prototype=void 0,ee}}();function apply(ie,te,ee){switch(ee.length){case 0:return ie.call(te);case 1:return ie.call(te,ee[0]);case 2:return ie.call(te,ee[0],ee[1]);case 3:return ie.call(te,ee[0],ee[1],ee[2])}return ie.apply(te,ee)}function copyArray(ie,te){var ee=-1,ne=ie.length;for(te||(te=Array(ne));++ee<ne;)te[ee]=ie[ee];return te}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(ie){var te=0,ee=0;return function(){var ne=nativeNow(),re=HOT_SPAN-(ne-ee);if(ee=ne,re>0){if(++te>=HOT_COUNT)return arguments[0]}else te=0;return ie.apply(void 0,arguments)}}function constant(ie){return function(){return ie}}var defineProperty=function(){try{var ie=getNative(Object,"defineProperty");return ie({},"",{}),ie}catch{}}(),baseSetToString=defineProperty?function(ie,te){return defineProperty(ie,"toString",{configurable:!0,enumerable:!1,value:constant(te),writable:!0})}:identity$1,setToString=shortOut(baseSetToString);function arrayEach(ie,te){for(var ee=-1,ne=ie==null?0:ie.length;++ee<ne&&te(ie[ee],ee,ie)!==!1;);return ie}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(ie,te){var ee=typeof ie;return te=te??MAX_SAFE_INTEGER$1,!!te&&(ee=="number"||ee!="symbol"&&reIsUint.test(ie))&&ie>-1&&ie%1==0&&ie<te}function baseAssignValue(ie,te,ee){te=="__proto__"&&defineProperty?defineProperty(ie,te,{configurable:!0,enumerable:!0,value:ee,writable:!0}):ie[te]=ee}function eq(ie,te){return ie===te||ie!==ie&&te!==te}var objectProto$e=Object.prototype,hasOwnProperty$c=objectProto$e.hasOwnProperty;function assignValue(ie,te,ee){var ne=ie[te];(!(hasOwnProperty$c.call(ie,te)&&eq(ne,ee))||ee===void 0&&!(te in ie))&&baseAssignValue(ie,te,ee)}function copyObject(ie,te,ee,ne){var re=!ee;ee||(ee={});for(var se=-1,ae=te.length;++se<ae;){var le=te[se],ce=void 0;ce===void 0&&(ce=ie[le]),re?baseAssignValue(ee,le,ce):assignValue(ee,le,ce)}return ee}var nativeMax=Math.max;function overRest(ie,te,ee){return te=nativeMax(te===void 0?ie.length-1:te,0),function(){for(var ne=arguments,re=-1,se=nativeMax(ne.length-te,0),ae=Array(se);++re<se;)ae[re]=ne[te+re];re=-1;for(var le=Array(te+1);++re<te;)le[re]=ne[re];return le[te]=ee(ae),apply(ie,this,le)}}function baseRest(ie,te){return setToString(overRest(ie,te,identity$1),ie+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(ie){return typeof ie=="number"&&ie>-1&&ie%1==0&&ie<=MAX_SAFE_INTEGER}function isArrayLike(ie){return ie!=null&&isLength(ie.length)&&!isFunction$1(ie)}function isIterateeCall(ie,te,ee){if(!isObject(ee))return!1;var ne=typeof te;return(ne=="number"?isArrayLike(ee)&&isIndex(te,ee.length):ne=="string"&&te in ee)?eq(ee[te],ie):!1}function createAssigner(ie){return baseRest(function(te,ee){var ne=-1,re=ee.length,se=re>1?ee[re-1]:void 0,ae=re>2?ee[2]:void 0;for(se=ie.length>3&&typeof se=="function"?(re--,se):void 0,ae&&isIterateeCall(ee[0],ee[1],ae)&&(se=re<3?void 0:se,re=1),te=Object(te);++ne<re;){var le=ee[ne];le&&ie(te,le,ne,se)}return te})}var objectProto$d=Object.prototype;function isPrototype(ie){var te=ie&&ie.constructor,ee=typeof te=="function"&&te.prototype||objectProto$d;return ie===ee}function baseTimes(ie,te){for(var ee=-1,ne=Array(ie);++ee<ie;)ne[ee]=te(ee);return ne}var argsTag$3="[object Arguments]";function baseIsArguments(ie){return isObjectLike(ie)&&baseGetTag(ie)==argsTag$3}var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty,propertyIsEnumerable$1=objectProto$c.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(ie){return isObjectLike(ie)&&hasOwnProperty$b.call(ie,"callee")&&!propertyIsEnumerable$1.call(ie,"callee")};function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$y.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$7="[object Map]",numberTag$4="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$7="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$7]=typedArrayTags[numberTag$4]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$7]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(ie){return isObjectLike(ie)&&isLength(ie.length)&&!!typedArrayTags[baseGetTag(ie)]}function baseUnary(ie){return function(te){return ie(te)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var ie=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return ie||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty;function arrayLikeKeys(ie,te){var ee=isArray(ie),ne=!ee&&isArguments(ie),re=!ee&&!ne&&isBuffer(ie),se=!ee&&!ne&&!re&&isTypedArray(ie),ae=ee||ne||re||se,le=ae?baseTimes(ie.length,String):[],ce=le.length;for(var he in ie)(te||hasOwnProperty$a.call(ie,he))&&!(ae&&(he=="length"||re&&(he=="offset"||he=="parent")||se&&(he=="buffer"||he=="byteLength"||he=="byteOffset")||isIndex(he,ce)))&&le.push(he);return le}function overArg(ie,te){return function(ee){return ie(te(ee))}}var nativeKeys=overArg(Object.keys,Object),objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseKeys(ie){if(!isPrototype(ie))return nativeKeys(ie);var te=[];for(var ee in Object(ie))hasOwnProperty$9.call(ie,ee)&&ee!="constructor"&&te.push(ee);return te}function keys$1(ie){return isArrayLike(ie)?arrayLikeKeys(ie):baseKeys(ie)}function nativeKeysIn(ie){var te=[];if(ie!=null)for(var ee in Object(ie))te.push(ee);return te}var objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function baseKeysIn(ie){if(!isObject(ie))return nativeKeysIn(ie);var te=isPrototype(ie),ee=[];for(var ne in ie)ne=="constructor"&&(te||!hasOwnProperty$8.call(ie,ne))||ee.push(ne);return ee}function keysIn(ie){return isArrayLike(ie)?arrayLikeKeys(ie,!0):baseKeysIn(ie)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(ie,te){if(isArray(ie))return!1;var ee=typeof ie;return ee=="number"||ee=="symbol"||ee=="boolean"||ie==null||isSymbol(ie)?!0:reIsPlainProp.test(ie)||!reIsDeepProp.test(ie)||te!=null&&ie in Object(te)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(ie){var te=this.has(ie)&&delete this.__data__[ie];return this.size-=te?1:0,te}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function hashGet(ie){var te=this.__data__;if(nativeCreate){var ee=te[ie];return ee===HASH_UNDEFINED$2?void 0:ee}return hasOwnProperty$7.call(te,ie)?te[ie]:void 0}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function hashHas(ie){var te=this.__data__;return nativeCreate?te[ie]!==void 0:hasOwnProperty$6.call(te,ie)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(ie,te){var ee=this.__data__;return this.size+=this.has(ie)?0:1,ee[ie]=nativeCreate&&te===void 0?HASH_UNDEFINED$1:te,this}function Hash(ie){var te=-1,ee=ie==null?0:ie.length;for(this.clear();++te<ee;){var ne=ie[te];this.set(ne[0],ne[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(ie,te){for(var ee=ie.length;ee--;)if(eq(ie[ee][0],te))return ee;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(ie){var te=this.__data__,ee=assocIndexOf(te,ie);if(ee<0)return!1;var ne=te.length-1;return ee==ne?te.pop():splice.call(te,ee,1),--this.size,!0}function listCacheGet(ie){var te=this.__data__,ee=assocIndexOf(te,ie);return ee<0?void 0:te[ee][1]}function listCacheHas(ie){return assocIndexOf(this.__data__,ie)>-1}function listCacheSet(ie,te){var ee=this.__data__,ne=assocIndexOf(ee,ie);return ne<0?(++this.size,ee.push([ie,te])):ee[ne][1]=te,this}function ListCache(ie){var te=-1,ee=ie==null?0:ie.length;for(this.clear();++te<ee;){var ne=ie[te];this.set(ne[0],ne[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$y,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(ie){var te=typeof ie;return te=="string"||te=="number"||te=="symbol"||te=="boolean"?ie!=="__proto__":ie===null}function getMapData(ie,te){var ee=ie.__data__;return isKeyable(te)?ee[typeof te=="string"?"string":"hash"]:ee.map}function mapCacheDelete(ie){var te=getMapData(this,ie).delete(ie);return this.size-=te?1:0,te}function mapCacheGet(ie){return getMapData(this,ie).get(ie)}function mapCacheHas(ie){return getMapData(this,ie).has(ie)}function mapCacheSet(ie,te){var ee=getMapData(this,ie),ne=ee.size;return ee.set(ie,te),this.size+=ee.size==ne?0:1,this}function MapCache(ie){var te=-1,ee=ie==null?0:ie.length;for(this.clear();++te<ee;){var ne=ie[te];this.set(ne[0],ne[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT="Expected a function";function memoize(ie,te){if(typeof ie!="function"||te!=null&&typeof te!="function")throw new TypeError(FUNC_ERROR_TEXT);var ee=function(){var ne=arguments,re=te?te.apply(this,ne):ne[0],se=ee.cache;if(se.has(re))return se.get(re);var ae=ie.apply(this,ne);return ee.cache=se.set(re,ae)||se,ae};return ee.cache=new(memoize.Cache||MapCache),ee}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(ie){var te=memoize(ie,function(ne){return ee.size===MAX_MEMOIZE_SIZE&&ee.clear(),ne}),ee=te.cache;return te}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(ie){var te=[];return ie.charCodeAt(0)===46&&te.push(""),ie.replace(rePropName,function(ee,ne,re,se){te.push(re?se.replace(reEscapeChar,"$1"):ne||ee)}),te});function toString(ie){return ie==null?"":baseToString(ie)}function castPath(ie,te){return isArray(ie)?ie:isKey(ie,te)?[ie]:stringToPath(toString(ie))}function toKey(ie){if(typeof ie=="string"||isSymbol(ie))return ie;var te=ie+"";return te=="0"&&1/ie==-1/0?"-0":te}function baseGet(ie,te){te=castPath(te,ie);for(var ee=0,ne=te.length;ie!=null&&ee<ne;)ie=ie[toKey(te[ee++])];return ee&&ee==ne?ie:void 0}function get(ie,te,ee){var ne=ie==null?void 0:baseGet(ie,te);return ne===void 0?ee:ne}function arrayPush(ie,te){for(var ee=-1,ne=te.length,re=ie.length;++ee<ne;)ie[re+ee]=te[ee];return ie}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(ie){return isArray(ie)||isArguments(ie)||!!(spreadableSymbol&&ie&&ie[spreadableSymbol])}function baseFlatten(ie,te,ee,ne,re){var se=-1,ae=ie.length;for(ee||(ee=isFlattenable),re||(re=[]);++se<ae;){var le=ie[se];ee(le)?arrayPush(re,le):re[re.length]=le}return re}function flatten(ie){var te=ie==null?0:ie.length;return te?baseFlatten(ie):[]}function flatRest(ie){return setToString(overRest(ie,void 0,flatten),ie+"")}var getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$6=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$5=objectProto$6.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(ie){if(!isObjectLike(ie)||baseGetTag(ie)!=objectTag$3)return!1;var te=getPrototype(ie);if(te===null)return!0;var ee=hasOwnProperty$5.call(te,"constructor")&&te.constructor;return typeof ee=="function"&&ee instanceof ee&&funcToString.call(ee)==objectCtorString}function baseSlice(ie,te,ee){var ne=-1,re=ie.length;te<0&&(te=-te>re?0:re+te),ee=ee>re?re:ee,ee<0&&(ee+=re),re=te>ee?0:ee-te>>>0,te>>>=0;for(var se=Array(re);++ne<re;)se[ne]=ie[ne+te];return se}function basePropertyOf(ie){return function(te){return ie==null?void 0:ie[te]}}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(ie){var te=this.__data__,ee=te.delete(ie);return this.size=te.size,ee}function stackGet(ie){return this.__data__.get(ie)}function stackHas(ie){return this.__data__.has(ie)}var LARGE_ARRAY_SIZE=200;function stackSet(ie,te){var ee=this.__data__;if(ee instanceof ListCache){var ne=ee.__data__;if(!Map$1||ne.length<LARGE_ARRAY_SIZE-1)return ne.push([ie,te]),this.size=++ee.size,this;ee=this.__data__=new MapCache(ne)}return ee.set(ie,te),this.size=ee.size,this}function Stack(ie){var te=this.__data__=new ListCache(ie);this.size=te.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(ie,te){return ie&&copyObject(te,keys$1(te),ie)}function baseAssignIn(ie,te){return ie&&copyObject(te,keysIn(te),ie)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root$y.Buffer:void 0,allocUnsafe=Buffer?Buffer.allocUnsafe:void 0;function cloneBuffer(ie,te){if(te)return ie.slice();var ee=ie.length,ne=allocUnsafe?allocUnsafe(ee):new ie.constructor(ee);return ie.copy(ne),ne}function arrayFilter(ie,te){for(var ee=-1,ne=ie==null?0:ie.length,re=0,se=[];++ee<ne;){var ae=ie[ee];te(ae,ee,ie)&&(se[re++]=ae)}return se}function stubArray(){return[]}var objectProto$5=Object.prototype,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(ie){return ie==null?[]:(ie=Object(ie),arrayFilter(nativeGetSymbols$1(ie),function(te){return propertyIsEnumerable.call(ie,te)}))}:stubArray;function copySymbols(ie,te){return copyObject(ie,getSymbols(ie),te)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(ie){for(var te=[];ie;)arrayPush(te,getSymbols(ie)),ie=getPrototype(ie);return te}:stubArray;function copySymbolsIn(ie,te){return copyObject(ie,getSymbolsIn(ie),te)}function baseGetAllKeys(ie,te,ee){var ne=te(ie);return isArray(ie)?ne:arrayPush(ne,ee(ie))}function getAllKeys(ie){return baseGetAllKeys(ie,keys$1,getSymbols)}function getAllKeysIn(ie){return baseGetAllKeys(ie,keysIn,getSymbolsIn)}var DataView=getNative(root$y,"DataView"),Promise$1=getNative(root$y,"Promise"),Set$1=getNative(root$y,"Set"),mapTag$6="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$6="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$3||Map$1&&getTag(new Map$1)!=mapTag$6||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$6||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(ie){var te=baseGetTag(ie),ee=te==objectTag$2?ie.constructor:void 0,ne=ee?toSource(ee):"";if(ne)switch(ne){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$6;case promiseCtorString:return promiseTag;case setCtorString:return setTag$6;case weakMapCtorString:return weakMapTag$1}return te});var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function initCloneArray(ie){var te=ie.length,ee=new ie.constructor(te);return te&&typeof ie[0]=="string"&&hasOwnProperty$4.call(ie,"index")&&(ee.index=ie.index,ee.input=ie.input),ee}var Uint8Array$1=root$y.Uint8Array;function cloneArrayBuffer(ie){var te=new ie.constructor(ie.byteLength);return new Uint8Array$1(te).set(new Uint8Array$1(ie)),te}function cloneDataView(ie,te){var ee=te?cloneArrayBuffer(ie.buffer):ie.buffer;return new ie.constructor(ee,ie.byteOffset,ie.byteLength)}var reFlags=/\w*$/;function cloneRegExp(ie){var te=new ie.constructor(ie.source,reFlags.exec(ie));return te.lastIndex=ie.lastIndex,te}var symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(ie){return symbolValueOf$1?Object(symbolValueOf$1.call(ie)):{}}function cloneTypedArray(ie,te){var ee=te?cloneArrayBuffer(ie.buffer):ie.buffer;return new ie.constructor(ee,ie.byteOffset,ie.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$5="[object Map]",numberTag$3="[object Number]",regexpTag$2="[object RegExp]",setTag$5="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(ie,te,ee){var ne=ie.constructor;switch(te){case arrayBufferTag$2:return cloneArrayBuffer(ie);case boolTag$2:case dateTag$2:return new ne(+ie);case dataViewTag$2:return cloneDataView(ie,ee);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(ie,ee);case mapTag$5:return new ne;case numberTag$3:case stringTag$2:return new ne(ie);case regexpTag$2:return cloneRegExp(ie);case setTag$5:return new ne;case symbolTag$2:return cloneSymbol(ie)}}function initCloneObject(ie){return typeof ie.constructor=="function"&&!isPrototype(ie)?baseCreate(getPrototype(ie)):{}}var mapTag$4="[object Map]";function baseIsMap(ie){return isObjectLike(ie)&&getTag(ie)==mapTag$4}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$4="[object Set]";function baseIsSet(ie){return isObjectLike(ie)&&getTag(ie)==setTag$4}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$3="[object Map]",numberTag$2="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$3="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$3]=cloneableTags[numberTag$2]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$3]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(ie,te,ee,ne,re,se){var ae,le=te&CLONE_DEEP_FLAG$2,ce=te&CLONE_FLAT_FLAG$1,he=te&CLONE_SYMBOLS_FLAG$2;if(ee&&(ae=re?ee(ie,ne,re,se):ee(ie)),ae!==void 0)return ae;if(!isObject(ie))return ie;var fe=isArray(ie);if(fe){if(ae=initCloneArray(ie),!le)return copyArray(ie,ae)}else{var Ae=getTag(ie),pe=Ae==funcTag||Ae==genTag;if(isBuffer(ie))return cloneBuffer(ie,le);if(Ae==objectTag$1||Ae==argsTag$1||pe&&!re){if(ae=ce||pe?{}:initCloneObject(ie),!le)return ce?copySymbolsIn(ie,baseAssignIn(ae,ie)):copySymbols(ie,baseAssign(ae,ie))}else{if(!cloneableTags[Ae])return re?ie:{};ae=initCloneByTag(ie,Ae,le)}}se||(se=new Stack);var Oe=se.get(ie);if(Oe)return Oe;se.set(ie,ae),isSet(ie)?ie.forEach(function(ze){ae.add(baseClone(ze,te,ee,ze,ie,se))}):isMap(ie)&&ie.forEach(function(ze,He){ae.set(He,baseClone(ze,te,ee,He,ie,se))});var Fe=he?ce?getAllKeysIn:getAllKeys:ce?keysIn:keys$1,Ne=fe?void 0:Fe(ie);return arrayEach(Ne||ie,function(ze,He){Ne&&(He=ze,ze=ie[He]),assignValue(ae,He,baseClone(ze,te,ee,He,ie,se))}),ae}var CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(ie){return baseClone(ie,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(ie){return this.__data__.set(ie,HASH_UNDEFINED),this}function setCacheHas(ie){return this.__data__.has(ie)}function SetCache(ie){var te=-1,ee=ie==null?0:ie.length;for(this.__data__=new MapCache;++te<ee;)this.add(ie[te])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(ie,te){for(var ee=-1,ne=ie==null?0:ie.length;++ee<ne;)if(te(ie[ee],ee,ie))return!0;return!1}function cacheHas(ie,te){return ie.has(te)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(ie,te,ee,ne,re,se){var ae=ee&COMPARE_PARTIAL_FLAG$5,le=ie.length,ce=te.length;if(le!=ce&&!(ae&&ce>le))return!1;var he=se.get(ie),fe=se.get(te);if(he&&fe)return he==te&&fe==ie;var Ae=-1,pe=!0,Oe=ee&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(se.set(ie,te),se.set(te,ie);++Ae<le;){var Fe=ie[Ae],Ne=te[Ae];if(ne)var ze=ae?ne(Ne,Fe,Ae,te,ie,se):ne(Fe,Ne,Ae,ie,te,se);if(ze!==void 0){if(ze)continue;pe=!1;break}if(Oe){if(!arraySome(te,function(He,We){if(!cacheHas(Oe,We)&&(Fe===He||re(Fe,He,ee,ne,se)))return Oe.push(We)})){pe=!1;break}}else if(!(Fe===Ne||re(Fe,Ne,ee,ne,se))){pe=!1;break}}return se.delete(ie),se.delete(te),pe}function mapToArray(ie){var te=-1,ee=Array(ie.size);return ie.forEach(function(ne,re){ee[++te]=[re,ne]}),ee}function setToArray(ie){var te=-1,ee=Array(ie.size);return ie.forEach(function(ne){ee[++te]=ne}),ee}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag="[object RegExp]",setTag$2="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(ie,te,ee,ne,re,se,ae){switch(ee){case dataViewTag:if(ie.byteLength!=te.byteLength||ie.byteOffset!=te.byteOffset)return!1;ie=ie.buffer,te=te.buffer;case arrayBufferTag:return!(ie.byteLength!=te.byteLength||!se(new Uint8Array$1(ie),new Uint8Array$1(te)));case boolTag:case dateTag:case numberTag$1:return eq(+ie,+te);case errorTag:return ie.name==te.name&&ie.message==te.message;case regexpTag:case stringTag:return ie==te+"";case mapTag$2:var le=mapToArray;case setTag$2:var ce=ne&COMPARE_PARTIAL_FLAG$4;if(le||(le=setToArray),ie.size!=te.size&&!ce)return!1;var he=ae.get(ie);if(he)return he==te;ne|=COMPARE_UNORDERED_FLAG$2,ae.set(ie,te);var fe=equalArrays(le(ie),le(te),ne,re,se,ae);return ae.delete(ie),fe;case symbolTag:if(symbolValueOf)return symbolValueOf.call(ie)==symbolValueOf.call(te)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function equalObjects(ie,te,ee,ne,re,se){var ae=ee&COMPARE_PARTIAL_FLAG$3,le=getAllKeys(ie),ce=le.length,he=getAllKeys(te),fe=he.length;if(ce!=fe&&!ae)return!1;for(var Ae=ce;Ae--;){var pe=le[Ae];if(!(ae?pe in te:hasOwnProperty$3.call(te,pe)))return!1}var Oe=se.get(ie),Fe=se.get(te);if(Oe&&Fe)return Oe==te&&Fe==ie;var Ne=!0;se.set(ie,te),se.set(te,ie);for(var ze=ae;++Ae<ce;){pe=le[Ae];var He=ie[pe],We=te[pe];if(ne)var je=ae?ne(We,He,pe,te,ie,se):ne(He,We,pe,ie,te,se);if(!(je===void 0?He===We||re(He,We,ee,ne,se):je)){Ne=!1;break}ze||(ze=pe=="constructor")}if(Ne&&!ze){var Ue=ie.constructor,Ge=te.constructor;Ue!=Ge&&"constructor"in ie&&"constructor"in te&&!(typeof Ue=="function"&&Ue instanceof Ue&&typeof Ge=="function"&&Ge instanceof Ge)&&(Ne=!1)}return se.delete(ie),se.delete(te),Ne}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function baseIsEqualDeep(ie,te,ee,ne,re,se){var ae=isArray(ie),le=isArray(te),ce=ae?arrayTag:getTag(ie),he=le?arrayTag:getTag(te);ce=ce==argsTag?objectTag:ce,he=he==argsTag?objectTag:he;var fe=ce==objectTag,Ae=he==objectTag,pe=ce==he;if(pe&&isBuffer(ie)){if(!isBuffer(te))return!1;ae=!0,fe=!1}if(pe&&!fe)return se||(se=new Stack),ae||isTypedArray(ie)?equalArrays(ie,te,ee,ne,re,se):equalByTag(ie,te,ce,ee,ne,re,se);if(!(ee&COMPARE_PARTIAL_FLAG$2)){var Oe=fe&&hasOwnProperty$2.call(ie,"__wrapped__"),Fe=Ae&&hasOwnProperty$2.call(te,"__wrapped__");if(Oe||Fe){var Ne=Oe?ie.value():ie,ze=Fe?te.value():te;return se||(se=new Stack),re(Ne,ze,ee,ne,se)}}return pe?(se||(se=new Stack),equalObjects(ie,te,ee,ne,re,se)):!1}function baseIsEqual(ie,te,ee,ne,re){return ie===te?!0:ie==null||te==null||!isObjectLike(ie)&&!isObjectLike(te)?ie!==ie&&te!==te:baseIsEqualDeep(ie,te,ee,ne,baseIsEqual,re)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(ie,te,ee,ne){var re=ee.length,se=re;if(ie==null)return!se;for(ie=Object(ie);re--;){var ae=ee[re];if(ae[2]?ae[1]!==ie[ae[0]]:!(ae[0]in ie))return!1}for(;++re<se;){ae=ee[re];var le=ae[0],ce=ie[le],he=ae[1];if(ae[2]){if(ce===void 0&&!(le in ie))return!1}else{var fe=new Stack,Ae;if(!(Ae===void 0?baseIsEqual(he,ce,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,ne,fe):Ae))return!1}}return!0}function isStrictComparable(ie){return ie===ie&&!isObject(ie)}function getMatchData(ie){for(var te=keys$1(ie),ee=te.length;ee--;){var ne=te[ee],re=ie[ne];te[ee]=[ne,re,isStrictComparable(re)]}return te}function matchesStrictComparable(ie,te){return function(ee){return ee==null?!1:ee[ie]===te&&(te!==void 0||ie in Object(ee))}}function baseMatches(ie){var te=getMatchData(ie);return te.length==1&&te[0][2]?matchesStrictComparable(te[0][0],te[0][1]):function(ee){return ee===ie||baseIsMatch(ee,ie,te)}}function baseHasIn(ie,te){return ie!=null&&te in Object(ie)}function hasPath(ie,te,ee){te=castPath(te,ie);for(var ne=-1,re=te.length,se=!1;++ne<re;){var ae=toKey(te[ne]);if(!(se=ie!=null&&ee(ie,ae)))break;ie=ie[ae]}return se||++ne!=re?se:(re=ie==null?0:ie.length,!!re&&isLength(re)&&isIndex(ae,re)&&(isArray(ie)||isArguments(ie)))}function hasIn(ie,te){return ie!=null&&hasPath(ie,te,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(ie,te){return isKey(ie)&&isStrictComparable(te)?matchesStrictComparable(toKey(ie),te):function(ee){var ne=get(ee,ie);return ne===void 0&&ne===te?hasIn(ee,ie):baseIsEqual(te,ne,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(ie){return function(te){return te==null?void 0:te[ie]}}function basePropertyDeep(ie){return function(te){return baseGet(te,ie)}}function property(ie){return isKey(ie)?baseProperty(toKey(ie)):basePropertyDeep(ie)}function baseIteratee(ie){return typeof ie=="function"?ie:ie==null?identity$1:typeof ie=="object"?isArray(ie)?baseMatchesProperty(ie[0],ie[1]):baseMatches(ie):property(ie)}function arrayAggregator(ie,te,ee,ne){for(var re=-1,se=ie==null?0:ie.length;++re<se;){var ae=ie[re];te(ne,ae,ee(ae),ie)}return ne}function createBaseFor(ie){return function(te,ee,ne){for(var re=-1,se=Object(te),ae=ne(te),le=ae.length;le--;){var ce=ae[++re];if(ee(se[ce],ce,se)===!1)break}return te}}var baseFor=createBaseFor();function baseForOwn(ie,te){return ie&&baseFor(ie,te,keys$1)}function createBaseEach(ie,te){return function(ee,ne){if(ee==null)return ee;if(!isArrayLike(ee))return ie(ee,ne);for(var re=ee.length,se=-1,ae=Object(ee);++se<re&&ne(ae[se],se,ae)!==!1;);return ee}}var baseEach=createBaseEach(baseForOwn);function baseAggregator(ie,te,ee,ne){return baseEach(ie,function(re,se,ae){te(ne,re,ee(re),ae)}),ne}function createAggregator(ie,te){return function(ee,ne){var re=isArray(ee)?arrayAggregator:baseAggregator,se=te?te():{};return re(ee,ie,baseIteratee(ne),se)}}function assignMergeValue(ie,te,ee){(ee!==void 0&&!eq(ie[te],ee)||ee===void 0&&!(te in ie))&&baseAssignValue(ie,te,ee)}function isArrayLikeObject(ie){return isObjectLike(ie)&&isArrayLike(ie)}function safeGet(ie,te){if(!(te==="constructor"&&typeof ie[te]=="function")&&te!="__proto__")return ie[te]}function toPlainObject(ie){return copyObject(ie,keysIn(ie))}function baseMergeDeep(ie,te,ee,ne,re,se,ae){var le=safeGet(ie,ee),ce=safeGet(te,ee),he=ae.get(ce);if(he){assignMergeValue(ie,ee,he);return}var fe=se?se(le,ce,ee+"",ie,te,ae):void 0,Ae=fe===void 0;if(Ae){var pe=isArray(ce),Oe=!pe&&isBuffer(ce),Fe=!pe&&!Oe&&isTypedArray(ce);fe=ce,pe||Oe||Fe?isArray(le)?fe=le:isArrayLikeObject(le)?fe=copyArray(le):Oe?(Ae=!1,fe=cloneBuffer(ce,!0)):Fe?(Ae=!1,fe=cloneTypedArray(ce,!0)):fe=[]:isPlainObject(ce)||isArguments(ce)?(fe=le,isArguments(le)?fe=toPlainObject(le):(!isObject(le)||isFunction$1(le))&&(fe=initCloneObject(ce))):Ae=!1}Ae&&(ae.set(ce,fe),re(fe,ce,ne,se,ae),ae.delete(ce)),assignMergeValue(ie,ee,fe)}function baseMerge(ie,te,ee,ne,re){ie!==te&&baseFor(te,function(se,ae){if(re||(re=new Stack),isObject(se))baseMergeDeep(ie,te,ae,ee,baseMerge,ne,re);else{var le=ne?ne(safeGet(ie,ae),se,ae+"",ie,te,re):void 0;le===void 0&&(le=se),assignMergeValue(ie,ae,le)}},keysIn)}function last$1(ie){var te=ie==null?0:ie.length;return te?ie[te-1]:void 0}function baseToPairs(ie,te){return arrayMap(te,function(ee){return[ee,ie[ee]]})}function setToPairs(ie){var te=-1,ee=Array(ie.size);return ie.forEach(function(ne){ee[++te]=[ne,ne]}),ee}var mapTag$1="[object Map]",setTag$1="[object Set]";function createToPairs(ie){return function(te){var ee=getTag(te);return ee==mapTag$1?mapToArray(te):ee==setTag$1?setToPairs(te):baseToPairs(te,ie(te))}}var toPairs=createToPairs(keys$1),htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},escapeHtmlChar=basePropertyOf(htmlEscapes),reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(ie){return ie=toString(ie),ie&&reHasUnescapedHtml.test(ie)?ie.replace(reUnescapedHtml,escapeHtmlChar):ie}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source);function escapeRegExp(ie){return ie=toString(ie),ie&&reHasRegExpChar.test(ie)?ie.replace(reRegExpChar,"\\$&"):ie}var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty,groupBy=createAggregator(function(ie,te,ee){hasOwnProperty$1.call(ie,ee)?ie[ee].push(te):baseAssignValue(ie,ee,[te])});function baseValues(ie,te){return arrayMap(te,function(ee){return ie[ee]})}function values(ie){return ie==null?[]:baseValues(ie,keys$1(ie))}function parent(ie,te){return te.length<2?ie:baseGet(ie,baseSlice(te,0,-1))}var mapTag="[object Map]",setTag="[object Set]",objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function isEmpty(ie){if(ie==null)return!0;if(isArrayLike(ie)&&(isArray(ie)||typeof ie=="string"||typeof ie.splice=="function"||isBuffer(ie)||isTypedArray(ie)||isArguments(ie)))return!ie.length;var te=getTag(ie);if(te==mapTag||te==setTag)return!ie.size;if(isPrototype(ie))return!baseKeys(ie).length;for(var ee in ie)if(hasOwnProperty.call(ie,ee))return!1;return!0}function isEqual(ie,te){return baseIsEqual(ie,te)}function isInteger(ie){return typeof ie=="number"&&ie==toInteger(ie)}var numberTag="[object Number]";function isNumber(ie){return typeof ie=="number"||isObjectLike(ie)&&baseGetTag(ie)==numberTag}var merge=createAssigner(function(ie,te,ee){baseMerge(ie,te,ee)});function baseUnset(ie,te){return te=castPath(te,ie),ie=parent(ie,te),ie==null||delete ie[toKey(last$1(te))]}function customOmitClone(ie){return isPlainObject(ie)?void 0:ie}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,omit=flatRest(function(ie,te){var ee={};if(ie==null)return ee;var ne=!1;te=arrayMap(te,function(se){return se=castPath(se,ie),ne||(ne=se.length>1),se}),copyObject(ie,getAllKeysIn(ie),ee),ne&&(ee=baseClone(ee,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone));for(var re=te.length;re--;)baseUnset(ee,te[re]);return ee});function baseSortedUniq(ie,te){for(var ee=-1,ne=ie.length,re=0,se=[];++ee<ne;){var ae=ie[ee],le=te?te(ae):ae;if(!ee||!eq(le,ce)){var ce=le;se[re++]=ae===0?0:ae}}return se}function sortedUniqBy(ie,te){return ie&&ie.length?baseSortedUniq(ie,baseIteratee(te)):[]}const IDatafeedService=createDecorator$1("datafeedService"),shortcutEvent=Object.freeze(function(ie,te){const ee=setTimeout(ie.bind(te),0);return{dispose(){clearTimeout(ee)}}});var CancellationToken;(ie=>{function te(ee){return ee===ie.None||ee===ie.Cancelled||ee instanceof MutableToken?!0:!ee||typeof ee!="object"?!1:typeof ee.isCancellationRequested=="boolean"&&typeof ee.onCancellationRequested=="function"}ie.isCancellationToken=te,ie.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Event$1.None}),ie.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:shortcutEvent})})(CancellationToken||(CancellationToken={}));class MutableToken{constructor(){Ee(this,"_isCancelled",!1);Ee(this,"_emitter",null)}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?shortcutEvent:(this._emitter||(this._emitter=new Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}class CancellationTokenSource{constructor(te){Ee(this,"_token");Ee(this,"_parentListener");this._parentListener=te&&te.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new MutableToken),this._token}cancel(){this._token?this._token instanceof MutableToken&&this._token.cancel():this._token=CancellationToken.Cancelled}dispose(te=!1){var ee;te&&this.cancel(),(ee=this._parentListener)==null||ee.dispose(),this._token?this._token instanceof MutableToken&&this._token.dispose():this._token=CancellationToken.None}}const generateUuid=function(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);const ie=new Uint8Array(16),te=[];for(let ee=0;ee<256;ee++)te.push(ee.toString(16).padStart(2,"0"));return function(){crypto.getRandomValues(ie),ie[6]=ie[6]&15|64,ie[8]=ie[8]&63|128;let ne=0,re="";return re+=te[ie[ne++]],re+=te[ie[ne++]],re+=te[ie[ne++]],re+=te[ie[ne++]],re+="-",re+=te[ie[ne++]],re+=te[ie[ne++]],re+="-",re+=te[ie[ne++]],re+=te[ie[ne++]],re+="-",re+=te[ie[ne++]],re+=te[ie[ne++]],re+="-",re+=te[ie[ne++]],re+=te[ie[ne++]],re+=te[ie[ne++]],re+=te[ie[ne++]],re+=te[ie[ne++]],re+=te[ie[ne++]],re}}();var extendStatics=function(ie,te){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,ne){ee.__proto__=ne}||function(ee,ne){for(var re in ne)Object.prototype.hasOwnProperty.call(ne,re)&&(ee[re]=ne[re])},extendStatics(ie,te)};function __extends(ie,te){if(typeof te!="function"&&te!==null)throw new TypeError("Class extends value "+String(te)+" is not a constructor or null");extendStatics(ie,te);function ee(){this.constructor=ie}ie.prototype=te===null?Object.create(te):(ee.prototype=te.prototype,new ee)}var __assign=function(){return __assign=Object.assign||function(te){for(var ee,ne=1,re=arguments.length;ne<re;ne++){ee=arguments[ne];for(var se in ee)Object.prototype.hasOwnProperty.call(ee,se)&&(te[se]=ee[se])}return te},__assign.apply(this,arguments)};function __values(ie){var te=typeof Symbol=="function"&&Symbol.iterator,ee=te&&ie[te],ne=0;if(ee)return ee.call(ie);if(ie&&typeof ie.length=="number")return{next:function(){return ie&&ne>=ie.length&&(ie=void 0),{value:ie&&ie[ne++],done:!ie}}};throw new TypeError(te?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(ie,te){var ee=typeof Symbol=="function"&&ie[Symbol.iterator];if(!ee)return ie;var ne=ee.call(ie),re,se=[],ae;try{for(;(te===void 0||te-- >0)&&!(re=ne.next()).done;)se.push(re.value)}catch(le){ae={error:le}}finally{try{re&&!re.done&&(ee=ne.return)&&ee.call(ne)}finally{if(ae)throw ae.error}}return se}function __spreadArray(ie,te,ee){if(ee||arguments.length===2)for(var ne=0,re=te.length,se;ne<re;ne++)(se||!(ne in te))&&(se||(se=Array.prototype.slice.call(te,0,ne)),se[ne]=te[ne]);return ie.concat(se||Array.prototype.slice.call(te))}typeof SuppressedError=="function"&&SuppressedError;function isFunction(ie){return typeof ie=="function"}function createErrorClass(ie){var te=function(ne){Error.call(ne),ne.stack=new Error().stack},ee=ie(te);return ee.prototype=Object.create(Error.prototype),ee.prototype.constructor=ee,ee}var UnsubscriptionError=createErrorClass(function(ie){return function(ee){ie(this),this.message=ee?ee.length+` errors occurred during unsubscription:
`+ee.map(function(ne,re){return re+1+") "+ne.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=ee}});function arrRemove(ie,te){if(ie){var ee=ie.indexOf(te);0<=ee&&ie.splice(ee,1)}}var Subscription=function(){function ie(te){this.initialTeardown=te,this.closed=!1,this._parentage=null,this._finalizers=null}return ie.prototype.unsubscribe=function(){var te,ee,ne,re,se;if(!this.closed){this.closed=!0;var ae=this._parentage;if(ae)if(this._parentage=null,Array.isArray(ae))try{for(var le=__values(ae),ce=le.next();!ce.done;ce=le.next()){var he=ce.value;he.remove(this)}}catch(Ne){te={error:Ne}}finally{try{ce&&!ce.done&&(ee=le.return)&&ee.call(le)}finally{if(te)throw te.error}}else ae.remove(this);var fe=this.initialTeardown;if(isFunction(fe))try{fe()}catch(Ne){se=Ne instanceof UnsubscriptionError?Ne.errors:[Ne]}var Ae=this._finalizers;if(Ae){this._finalizers=null;try{for(var pe=__values(Ae),Oe=pe.next();!Oe.done;Oe=pe.next()){var Fe=Oe.value;try{execFinalizer(Fe)}catch(Ne){se=se??[],Ne instanceof UnsubscriptionError?se=__spreadArray(__spreadArray([],__read(se)),__read(Ne.errors)):se.push(Ne)}}}catch(Ne){ne={error:Ne}}finally{try{Oe&&!Oe.done&&(re=pe.return)&&re.call(pe)}finally{if(ne)throw ne.error}}}if(se)throw new UnsubscriptionError(se)}},ie.prototype.add=function(te){var ee;if(te&&te!==this)if(this.closed)execFinalizer(te);else{if(te instanceof ie){if(te.closed||te._hasParent(this))return;te._addParent(this)}(this._finalizers=(ee=this._finalizers)!==null&&ee!==void 0?ee:[]).push(te)}},ie.prototype._hasParent=function(te){var ee=this._parentage;return ee===te||Array.isArray(ee)&&ee.includes(te)},ie.prototype._addParent=function(te){var ee=this._parentage;this._parentage=Array.isArray(ee)?(ee.push(te),ee):ee?[ee,te]:te},ie.prototype._removeParent=function(te){var ee=this._parentage;ee===te?this._parentage=null:Array.isArray(ee)&&arrRemove(ee,te)},ie.prototype.remove=function(te){var ee=this._finalizers;ee&&arrRemove(ee,te),te instanceof ie&&te._removeParent(this)},ie.EMPTY=function(){var te=new ie;return te.closed=!0,te}(),ie}();Subscription.EMPTY;function isSubscription(ie){return ie instanceof Subscription||ie&&"closed"in ie&&isFunction(ie.remove)&&isFunction(ie.add)&&isFunction(ie.unsubscribe)}function execFinalizer(ie){isFunction(ie)?ie():ie.unsubscribe()}var config$1={Promise:void 0},timeoutProvider={setTimeout:function(ie,te){for(var ee=[],ne=2;ne<arguments.length;ne++)ee[ne-2]=arguments[ne];return setTimeout.apply(void 0,__spreadArray([ie,te],__read(ee)))},clearTimeout:function(ie){return clearTimeout(ie)},delegate:void 0};function reportUnhandledError(ie){timeoutProvider.setTimeout(function(){throw ie})}function noop(){}function errorContext(ie){ie()}var Subscriber=function(ie){__extends(te,ie);function te(ee){var ne=ie.call(this)||this;return ne.isStopped=!1,ee?(ne.destination=ee,isSubscription(ee)&&ee.add(ne)):ne.destination=EMPTY_OBSERVER,ne}return te.create=function(ee,ne,re){return new SafeSubscriber(ee,ne,re)},te.prototype.next=function(ee){this.isStopped||this._next(ee)},te.prototype.error=function(ee){this.isStopped||(this.isStopped=!0,this._error(ee))},te.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},te.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,ie.prototype.unsubscribe.call(this),this.destination=null)},te.prototype._next=function(ee){this.destination.next(ee)},te.prototype._error=function(ee){try{this.destination.error(ee)}finally{this.unsubscribe()}},te.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},te}(Subscription),ConsumerObserver=function(){function ie(te){this.partialObserver=te}return ie.prototype.next=function(te){var ee=this.partialObserver;if(ee.next)try{ee.next(te)}catch(ne){handleUnhandledError(ne)}},ie.prototype.error=function(te){var ee=this.partialObserver;if(ee.error)try{ee.error(te)}catch(ne){handleUnhandledError(ne)}else handleUnhandledError(te)},ie.prototype.complete=function(){var te=this.partialObserver;if(te.complete)try{te.complete()}catch(ee){handleUnhandledError(ee)}},ie}(),SafeSubscriber=function(ie){__extends(te,ie);function te(ee,ne,re){var se=ie.call(this)||this,ae;return isFunction(ee)||!ee?ae={next:ee??void 0,error:ne??void 0,complete:re??void 0}:ae=ee,se.destination=new ConsumerObserver(ae),se}return te}(Subscriber);function handleUnhandledError(ie){reportUnhandledError(ie)}function defaultErrorHandler(ie){throw ie}var EMPTY_OBSERVER={closed:!0,next:noop,error:defaultErrorHandler,complete:noop},observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function identity(ie){return ie}function pipeFromArray(ie){return ie.length===0?identity:ie.length===1?ie[0]:function(ee){return ie.reduce(function(ne,re){return re(ne)},ee)}}var Observable$1=function(){function ie(te){te&&(this._subscribe=te)}return ie.prototype.lift=function(te){var ee=new ie;return ee.source=this,ee.operator=te,ee},ie.prototype.subscribe=function(te,ee,ne){var re=this,se=isSubscriber(te)?te:new SafeSubscriber(te,ee,ne);return errorContext(function(){var ae=re,le=ae.operator,ce=ae.source;se.add(le?le.call(se,ce):ce?re._subscribe(se):re._trySubscribe(se))}),se},ie.prototype._trySubscribe=function(te){try{return this._subscribe(te)}catch(ee){te.error(ee)}},ie.prototype.forEach=function(te,ee){var ne=this;return ee=getPromiseCtor(ee),new ee(function(re,se){var ae=new SafeSubscriber({next:function(le){try{te(le)}catch(ce){se(ce),ae.unsubscribe()}},error:se,complete:re});ne.subscribe(ae)})},ie.prototype._subscribe=function(te){var ee;return(ee=this.source)===null||ee===void 0?void 0:ee.subscribe(te)},ie.prototype[observable]=function(){return this},ie.prototype.pipe=function(){for(var te=[],ee=0;ee<arguments.length;ee++)te[ee]=arguments[ee];return pipeFromArray(te)(this)},ie.prototype.toPromise=function(te){var ee=this;return te=getPromiseCtor(te),new te(function(ne,re){var se;ee.subscribe(function(ae){return se=ae},function(ae){return re(ae)},function(){return ne(se)})})},ie.create=function(te){return new ie(te)},ie}();function getPromiseCtor(ie){var te;return(te=ie??config$1.Promise)!==null&&te!==void 0?te:Promise}function isObserver(ie){return ie&&isFunction(ie.next)&&isFunction(ie.error)&&isFunction(ie.complete)}function isSubscriber(ie){return ie&&ie instanceof Subscriber||isObserver(ie)&&isSubscription(ie)}function hasLift(ie){return isFunction(ie==null?void 0:ie.lift)}function operate(ie){return function(te){if(hasLift(te))return te.lift(function(ee){try{return ie(ee,this)}catch(ne){this.error(ne)}});throw new TypeError("Unable to lift unknown Observable type")}}function createOperatorSubscriber(ie,te,ee,ne,re){return new OperatorSubscriber(ie,te,ee,ne,re)}var OperatorSubscriber=function(ie){__extends(te,ie);function te(ee,ne,re,se,ae,le){var ce=ie.call(this,ee)||this;return ce.onFinalize=ae,ce.shouldUnsubscribe=le,ce._next=ne?function(he){try{ne(he)}catch(fe){ee.error(fe)}}:ie.prototype._next,ce._error=se?function(he){try{se(he)}catch(fe){ee.error(fe)}finally{this.unsubscribe()}}:ie.prototype._error,ce._complete=re?function(){try{re()}catch(he){ee.error(he)}finally{this.unsubscribe()}}:ie.prototype._complete,ce}return te.prototype.unsubscribe=function(){var ee;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var ne=this.closed;ie.prototype.unsubscribe.call(this),!ne&&((ee=this.onFinalize)===null||ee===void 0||ee.call(this))}},te}(Subscriber),dateTimestampProvider={now:function(){return Date.now()}},Action=function(ie){__extends(te,ie);function te(ee,ne){return ie.call(this)||this}return te.prototype.schedule=function(ee,ne){return this},te}(Subscription),intervalProvider={setInterval:function(ie,te){for(var ee=[],ne=2;ne<arguments.length;ne++)ee[ne-2]=arguments[ne];return setInterval.apply(void 0,__spreadArray([ie,te],__read(ee)))},clearInterval:function(ie){return clearInterval(ie)},delegate:void 0},AsyncAction=function(ie){__extends(te,ie);function te(ee,ne){var re=ie.call(this,ee,ne)||this;return re.scheduler=ee,re.work=ne,re.pending=!1,re}return te.prototype.schedule=function(ee,ne){var re;if(ne===void 0&&(ne=0),this.closed)return this;this.state=ee;var se=this.id,ae=this.scheduler;return se!=null&&(this.id=this.recycleAsyncId(ae,se,ne)),this.pending=!0,this.delay=ne,this.id=(re=this.id)!==null&&re!==void 0?re:this.requestAsyncId(ae,this.id,ne),this},te.prototype.requestAsyncId=function(ee,ne,re){return re===void 0&&(re=0),intervalProvider.setInterval(ee.flush.bind(ee,this),re)},te.prototype.recycleAsyncId=function(ee,ne,re){if(re===void 0&&(re=0),re!=null&&this.delay===re&&this.pending===!1)return ne;ne!=null&&intervalProvider.clearInterval(ne)},te.prototype.execute=function(ee,ne){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var re=this._execute(ee,ne);if(re)return re;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},te.prototype._execute=function(ee,ne){var re=!1,se;try{this.work(ee)}catch(ae){re=!0,se=ae||new Error("Scheduled action threw falsy error")}if(re)return this.unsubscribe(),se},te.prototype.unsubscribe=function(){if(!this.closed){var ee=this,ne=ee.id,re=ee.scheduler,se=re.actions;this.work=this.state=this.scheduler=null,this.pending=!1,arrRemove(se,this),ne!=null&&(this.id=this.recycleAsyncId(re,ne,null)),this.delay=null,ie.prototype.unsubscribe.call(this)}},te}(Action),Scheduler=function(){function ie(te,ee){ee===void 0&&(ee=ie.now),this.schedulerActionCtor=te,this.now=ee}return ie.prototype.schedule=function(te,ee,ne){return ee===void 0&&(ee=0),new this.schedulerActionCtor(this,te).schedule(ne,ee)},ie.now=dateTimestampProvider.now,ie}(),AsyncScheduler=function(ie){__extends(te,ie);function te(ee,ne){ne===void 0&&(ne=Scheduler.now);var re=ie.call(this,ee,ne)||this;return re.actions=[],re._active=!1,re}return te.prototype.flush=function(ee){var ne=this.actions;if(this._active){ne.push(ee);return}var re;this._active=!0;do if(re=ee.execute(ee.state,ee.delay))break;while(ee=ne.shift());if(this._active=!1,re){for(;ee=ne.shift();)ee.unsubscribe();throw re}},te}(Scheduler),asyncScheduler=new AsyncScheduler(AsyncAction);function isScheduler(ie){return ie&&isFunction(ie.schedule)}function last(ie){return ie[ie.length-1]}function popScheduler(ie){return isScheduler(last(ie))?ie.pop():void 0}function executeSchedule(ie,te,ee,ne,re){ne===void 0&&(ne=0),re===void 0&&(re=!1);var se=te.schedule(function(){ee(),re?ie.add(this.schedule(null,ne)):this.unsubscribe()},ne);if(ie.add(se),!re)return se}function filter(ie,te){return operate(function(ee,ne){var re=0;ee.subscribe(createOperatorSubscriber(ne,function(se){return ie.call(te,se,re++)&&ne.next(se)}))})}function bufferTime(ie){for(var te,ee,ne=[],re=1;re<arguments.length;re++)ne[re-1]=arguments[re];var se=(te=popScheduler(ne))!==null&&te!==void 0?te:asyncScheduler,ae=(ee=ne[0])!==null&&ee!==void 0?ee:null,le=ne[1]||1/0;return operate(function(ce,he){var fe=[],Ae=!1,pe=function(Ne){var ze=Ne.buffer,He=Ne.subs;He.unsubscribe(),arrRemove(fe,Ne),he.next(ze),Ae&&Oe()},Oe=function(){if(fe){var Ne=new Subscription;he.add(Ne);var ze=[],He={buffer:ze,subs:Ne};fe.push(He),executeSchedule(Ne,se,function(){return pe(He)},ie)}};ae!==null&&ae>=0?executeSchedule(he,se,Oe,ae,!0):Ae=!0,Oe();var Fe=createOperatorSubscriber(he,function(Ne){var ze,He,We=fe.slice();try{for(var je=__values(We),Ue=je.next();!Ue.done;Ue=je.next()){var Ge=Ue.value,Ze=Ge.buffer;Ze.push(Ne),le<=Ze.length&&pe(Ge)}}catch(Ye){ze={error:Ye}}finally{try{Ue&&!Ue.done&&(He=je.return)&&He.call(je)}finally{if(ze)throw ze.error}}},function(){for(;fe!=null&&fe.length;)he.next(fe.shift().buffer);Fe==null||Fe.unsubscribe(),he.complete(),he.unsubscribe()},void 0,function(){return fe=null});ce.subscribe(Fe)})}var __defProp$5=Object.defineProperty,__getOwnPropDesc$o=Object.getOwnPropertyDescriptor,__decorateClass$o=(ie,te,ee,ne)=>{for(var re=__getOwnPropDesc$o(te,ee),se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(te,ee,re)||re);return re&&__defProp$5(te,ee,re),re};class Session{constructor(te,ee,ne,re){Ee(this,"symbolInfo",Object.create(null));Ee(this,"subscription",null);Ee(this,"loadMores",new Set);this.cancellationTokenSource=te,this.cancellationToken=ee,this.symbol=ne,this.resolution=re}add(te){this.loadMores.add(te)}remove(te){this.loadMores.delete(te)}dispose(){var te;this.cancellationTokenSource.dispose(!0),(te=this.subscription)==null||te.unsubscribe(),this.loadMores.values().forEach(ee=>ee.dispose(!0))}}class ChartDataLoader extends Disposable{constructor(ee){super();Ee(this,"_session",null);this.datafeed=ee,this._register(toDisposable(()=>this._cancelCurrentSession()))}load(ee,ne,re,se,ae,le,ce){this._cancelCurrentSession();const he=new CancellationTokenSource,fe=he.token,Ae=generateUuid(),pe=new Session(he,fe,ee,re);this._session=pe,this.datafeed.resolveSymbol(ee,Oe=>{if(fe.isCancellationRequested)return;se(Oe),this._session.symbolInfo=Oe;let Fe=!1,Ne=null;this.datafeed.getBars(Oe,re,{from:0,to:new Date().getTime()/1e3,countBack:ne,firstDataRequest:!0},(He,We)=>{if(!fe.isCancellationRequested){if(Fe=!0,Ne!=null&&Ne.length){for(Ne.sort((je,Ue)=>je.time-Ue.time);Ne.length;){const je=last$1(He),Ue=Ne.shift();je&&je.time===Ue.time?Object.assign(je,Ue):He.push(Ue)}Ne=null}ae(He,We)}},He=>{fe.isCancellationRequested||(ce(He),this.datafeed.unsubscribeBars(Ae))},fe);const ze=new Observable$1(He=>{const We=je=>{if(!fe.isCancellationRequested)return Fe?He.next(je):(Ne||(Ne=[]),Ne.push(je)),()=>{this.datafeed.unsubscribeBars(Ae)}};return this.datafeed.subscribeBars(Oe,re,We,Ae,()=>{}),()=>{this.datafeed.unsubscribeBars(Ae)}}).pipe(bufferTime(200),filter(He=>He.length>0));pe.subscription=ze.subscribe(He=>{const We=groupBy(He,Ue=>Ue.time);values(We).map(Ue=>Ue.reduce((Ge,Ze)=>(Ge.high=Math.max(Ge.high,Ze.close),Ge.low=Math.min(Ge.low,Ze.close),Ge.close=Ze.close,Ge))).sort((Ue,Ge)=>Ue.time-Ge.time).forEach(Ue=>le(Ue))})},Oe=>{fe.isCancellationRequested||ce(Oe)},fe)}loadMore(ee,ne,re,se,ae){const le=this._session;if(!le||le.symbol!==ee||le.resolution!==ne)return;const ce=new CancellationTokenSource,he=ce.token;le.add(ce),this.datafeed.getBars(le.symbolInfo,le.resolution,{from:0,to:re.to-1,countBack:re.countBack,firstDataRequest:!0},(fe,Ae)=>{he.isCancellationRequested||(se(fe,Ae),le.remove(ce))},fe=>{he.isCancellationRequested||(ae==null||ae(fe),le.remove(ce))},he)}_cancelCurrentSession(){this._session&&(this._session.dispose(),this._session=null)}}__decorateClass$o([debounce(500,{maxWait:500,trailing:!0})],ChartDataLoader.prototype,"loadMore");var __getOwnPropDesc$n=Object.getOwnPropertyDescriptor,__decorateClass$n=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$n(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$k=(ie,te)=>(ee,ne)=>te(ee,ne,ie),ChartDataStatus=(ie=>(ie[ie.idle=0]="idle",ie[ie.startLoading=1]="startLoading",ie[ie.symbolInfoResolved=2]="symbolInfoResolved",ie[ie.dataLoaded=3]="dataLoaded",ie[ie.error=4]="error",ie))(ChartDataStatus||{}),DataStatus=(ie=>(ie[ie.error=-1]="error",ie[ie.idle=0]="idle",ie[ie.symbolInfoResolved=1]="symbolInfoResolved",ie[ie.historyResolved=2]="historyResolved",ie[ie.realtimeConnected=3]="realtimeConnected",ie[ie.changingSymbol=4]="changingSymbol",ie))(DataStatus||{});class AbstractChartDataSource extends Disposable{constructor(ee,ne,re){super();Ee(this,"_dataLoader");Ee(this,"_status",0);Ee(this,"_onDataChanged",new Emitter);Ee(this,"onDataChanged",this._onDataChanged.event);Ee(this,"phaseWhen",new Map);this._ctx=ee,this._chart=ne,this._register(this._dataLoader=new ChartDataLoader(re))}get status(){return this._status}set status(ee){if(this._status===ee)return;this._status=ee;const ne=this.phaseWhen.get(this._status);ne&&(ne.open(),this.phaseWhen.delete(this._status))}load(ee,ne){if(should(this._status===0||this._status===4),!this.symbol())return Promise.resolve(!1);const re=new DeferredPromise;return this._dataLoader.load(this.symbol(),this._ctx.countBack(),this.resolution(),se=>{should(this._status===0||this._status===4),this._status=1,ee==null||ee(se)},se=>{should(this._status===1),this._status=2,this.setBars(sortedUniqBy(se,ae=>ae.time)),re.complete(!0)},se=>{should(this._status===2||this._status===1||this._status===3),this._status=3,this.setBar(se)},se=>{this._status=-1,ne==null||ne(se),re.complete(!1)}),re.p}_registerListeners(){const ee=ne=>{if(ne&&ne.from<1){const re=this.data();if(!this.data().length)return;const se=re[0];this._dataLoader.loadMore(this.symbol(),this.resolution(),{to:se.time,countBack:Math.ceil(Math.abs(ne.from)+100)},ae=>{const le=ae.concat(this.data());le.sort((ce,he)=>ce.time-he.time),this.setBars(sortedUniqBy(le,ce=>ce.time))})}};this._chart.timeScale().subscribeVisibleLogicalRangeChange(ee),this._register(toDisposable(()=>{this._chart.timeScale().unsubscribeVisibleLogicalRangeChange(ee)}))}async when(ee){if(ee<=this._status)return;let ne=this.phaseWhen.get(ee);ne||(ne=new Barrier,this.phaseWhen.set(ee,ne)),await ne.wait()}}let StudyDataSource=class extends AbstractChartDataSource{constructor(te,ee,ne,re,se){super(ne,re,se);Ee(this,"_data",[]);this._symbol=te,this._resolution=ee}data(){return this._data}symbol(){return this._symbol}resolution(){return this._resolution}setResolution(te){return this._resolution=te,this.load()}setBars(te){this._data=barsToSingleValueData(te,"close"),this._onDataChanged.fire("full")}setBar(te){const ee=barToSingleValueData(te,"close"),ne=last$1(this._data);ne&&ne.time===ee.time?this._data[this._data.length-1]=ee:this._data.push(ee),this._onDataChanged.fire("update")}loadData(te){return this.load(te)}};StudyDataSource=__decorateClass$n([__decorateParam$k(4,IDatafeedService)],StudyDataSource);function barsToOhlcData(ie,te,ee){let ne=-1/0;return ie.map(re=>{const se=isSeriesData(re)?re.customValues:re,ae=se.close>=ne?te:ee;return ne=se.close,{open:se.open,high:se.high,low:se.low,close:se.close,volume:se.volume,time:re.time,color:ae,customValues:{open:se.open,high:se.high,low:se.low,close:se.close,volume:se.volume}}})}function barsToSingleValueData(ie,te){return ie.map(ee=>{const ne=isSeriesData(ee)?ee.customValues:ee;return{time:ee.time,value:ne[te],customValues:{open:ne.open,high:ne.high,low:ne.low,close:ne.close}}})}function barToSingleValueData(ie,te){const ee=isSeriesData(ie)?ie.customValues:ie;return{time:ie.time,value:ee[te],customValues:{open:ee.open,high:ee.high,low:ee.low,close:ee.close}}}function isSeriesData(ie){return"customValues"in ie}function size$1(ie){const te=ie.width,ee=ie.height;if(te<0)throw new Error("Negative width is not allowed for Size");if(ee<0)throw new Error("Negative height is not allowed for Size");return{width:te,height:ee}}function isSizeEqual(ie,te){return ie.width==te.width&&ie.height===te.height}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(ie,te,ee)=>{let ne;const re=formatDistanceLocale[ie];return typeof re=="string"?ne=re:te===1?ne=re.one:ne=re.other.replace("{{count}}",te.toString()),ee!=null&&ee.addSuffix?ee.comparison&&ee.comparison>0?"in "+ne:ne+" ago":ne};function buildFormatLongFn(ie){return(te={})=>{const ee=te.width?String(te.width):ie.defaultWidth;return ie.formats[ee]||ie.formats[ie.defaultWidth]}}const dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(ie,te,ee,ne)=>formatRelativeLocale[ie];function buildLocalizeFn(ie){return(te,ee)=>{const ne=ee!=null&&ee.context?String(ee.context):"standalone";let re;if(ne==="formatting"&&ie.formattingValues){const ae=ie.defaultFormattingWidth||ie.defaultWidth,le=ee!=null&&ee.width?String(ee.width):ae;re=ie.formattingValues[le]||ie.formattingValues[ae]}else{const ae=ie.defaultWidth,le=ee!=null&&ee.width?String(ee.width):ie.defaultWidth;re=ie.values[le]||ie.values[ae]}const se=ie.argumentCallback?ie.argumentCallback(te):te;return re[se]}}const eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(ie,te)=>{const ee=Number(ie),ne=ee%100;if(ne>20||ne<10)switch(ne%10){case 1:return ee+"st";case 2:return ee+"nd";case 3:return ee+"rd"}return ee+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:ie=>ie-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(ie){return(te,ee={})=>{const ne=ee.width,re=ne&&ie.matchPatterns[ne]||ie.matchPatterns[ie.defaultMatchWidth],se=te.match(re);if(!se)return null;const ae=se[0],le=ne&&ie.parsePatterns[ne]||ie.parsePatterns[ie.defaultParseWidth],ce=Array.isArray(le)?findIndex(le,Ae=>Ae.test(ae)):findKey(le,Ae=>Ae.test(ae));let he;he=ie.valueCallback?ie.valueCallback(ce):ce,he=ee.valueCallback?ee.valueCallback(he):he;const fe=te.slice(ae.length);return{value:he,rest:fe}}}function findKey(ie,te){for(const ee in ie)if(Object.prototype.hasOwnProperty.call(ie,ee)&&te(ie[ee]))return ee}function findIndex(ie,te){for(let ee=0;ee<ie.length;ee++)if(te(ie[ee]))return ee}function buildMatchPatternFn(ie){return(te,ee={})=>{const ne=te.match(ie.matchPattern);if(!ne)return null;const re=ne[0],se=te.match(ie.parsePattern);if(!se)return null;let ae=ie.valueCallback?ie.valueCallback(se[0]):se[0];ae=ee.valueCallback?ee.valueCallback(ae):ae;const le=te.slice(re.length);return{value:ae,rest:le}}}const matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:ie=>parseInt(ie,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:ie=>ie+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};let defaultOptions$1={};function getDefaultOptions$1(){return defaultOptions$1}const millisecondsInWeek=6048e5,millisecondsInDay=864e5,constructFromSymbol=Symbol.for("constructDateFrom");function constructFrom(ie,te){return typeof ie=="function"?ie(te):ie&&typeof ie=="object"&&constructFromSymbol in ie?ie[constructFromSymbol](te):ie instanceof Date?new ie.constructor(te):new Date(te)}function toDate$1(ie,te){return constructFrom(te||ie,ie)}function getTimezoneOffsetInMilliseconds$1(ie){const te=toDate$1(ie),ee=new Date(Date.UTC(te.getFullYear(),te.getMonth(),te.getDate(),te.getHours(),te.getMinutes(),te.getSeconds(),te.getMilliseconds()));return ee.setUTCFullYear(te.getFullYear()),+ie-+ee}function normalizeDates(ie,...te){const ee=constructFrom.bind(null,te.find(ne=>typeof ne=="object"));return te.map(ee)}function startOfDay(ie,te){const ee=toDate$1(ie,te==null?void 0:te.in);return ee.setHours(0,0,0,0),ee}function differenceInCalendarDays(ie,te,ee){const[ne,re]=normalizeDates(ee==null?void 0:ee.in,ie,te),se=startOfDay(ne),ae=startOfDay(re),le=+se-getTimezoneOffsetInMilliseconds$1(se),ce=+ae-getTimezoneOffsetInMilliseconds$1(ae);return Math.round((le-ce)/millisecondsInDay)}function startOfYear(ie,te){const ee=toDate$1(ie,te==null?void 0:te.in);return ee.setFullYear(ee.getFullYear(),0,1),ee.setHours(0,0,0,0),ee}function getDayOfYear(ie,te){const ee=toDate$1(ie,te==null?void 0:te.in);return differenceInCalendarDays(ee,startOfYear(ee))+1}function startOfWeek(ie,te){var le,ce,he,fe;const ee=getDefaultOptions$1(),ne=(te==null?void 0:te.weekStartsOn)??((ce=(le=te==null?void 0:te.locale)==null?void 0:le.options)==null?void 0:ce.weekStartsOn)??ee.weekStartsOn??((fe=(he=ee.locale)==null?void 0:he.options)==null?void 0:fe.weekStartsOn)??0,re=toDate$1(ie,te==null?void 0:te.in),se=re.getDay(),ae=(se<ne?7:0)+se-ne;return re.setDate(re.getDate()-ae),re.setHours(0,0,0,0),re}function startOfISOWeek(ie,te){return startOfWeek(ie,{...te,weekStartsOn:1})}function getISOWeekYear(ie,te){const ee=toDate$1(ie,te==null?void 0:te.in),ne=ee.getFullYear(),re=constructFrom(ee,0);re.setFullYear(ne+1,0,4),re.setHours(0,0,0,0);const se=startOfISOWeek(re),ae=constructFrom(ee,0);ae.setFullYear(ne,0,4),ae.setHours(0,0,0,0);const le=startOfISOWeek(ae);return ee.getTime()>=se.getTime()?ne+1:ee.getTime()>=le.getTime()?ne:ne-1}function startOfISOWeekYear(ie,te){const ee=getISOWeekYear(ie,te),ne=constructFrom(ie,0);return ne.setFullYear(ee,0,4),ne.setHours(0,0,0,0),startOfISOWeek(ne)}function getISOWeek(ie,te){const ee=toDate$1(ie,te==null?void 0:te.in),ne=+startOfISOWeek(ee)-+startOfISOWeekYear(ee);return Math.round(ne/millisecondsInWeek)+1}function getWeekYear(ie,te){var fe,Ae,pe,Oe;const ee=toDate$1(ie,te==null?void 0:te.in),ne=ee.getFullYear(),re=getDefaultOptions$1(),se=(te==null?void 0:te.firstWeekContainsDate)??((Ae=(fe=te==null?void 0:te.locale)==null?void 0:fe.options)==null?void 0:Ae.firstWeekContainsDate)??re.firstWeekContainsDate??((Oe=(pe=re.locale)==null?void 0:pe.options)==null?void 0:Oe.firstWeekContainsDate)??1,ae=constructFrom((te==null?void 0:te.in)||ie,0);ae.setFullYear(ne+1,0,se),ae.setHours(0,0,0,0);const le=startOfWeek(ae,te),ce=constructFrom((te==null?void 0:te.in)||ie,0);ce.setFullYear(ne,0,se),ce.setHours(0,0,0,0);const he=startOfWeek(ce,te);return+ee>=+le?ne+1:+ee>=+he?ne:ne-1}function startOfWeekYear(ie,te){var le,ce,he,fe;const ee=getDefaultOptions$1(),ne=(te==null?void 0:te.firstWeekContainsDate)??((ce=(le=te==null?void 0:te.locale)==null?void 0:le.options)==null?void 0:ce.firstWeekContainsDate)??ee.firstWeekContainsDate??((fe=(he=ee.locale)==null?void 0:he.options)==null?void 0:fe.firstWeekContainsDate)??1,re=getWeekYear(ie,te),se=constructFrom((te==null?void 0:te.in)||ie,0);return se.setFullYear(re,0,ne),se.setHours(0,0,0,0),startOfWeek(se,te)}function getWeek(ie,te){const ee=toDate$1(ie,te==null?void 0:te.in),ne=+startOfWeek(ee,te)-+startOfWeekYear(ee,te);return Math.round(ne/millisecondsInWeek)+1}function addLeadingZeros$2(ie,te){const ee=ie<0?"-":"",ne=Math.abs(ie).toString().padStart(te,"0");return ee+ne}const lightFormatters={y(ie,te){const ee=ie.getFullYear(),ne=ee>0?ee:1-ee;return addLeadingZeros$2(te==="yy"?ne%100:ne,te.length)},M(ie,te){const ee=ie.getMonth();return te==="M"?String(ee+1):addLeadingZeros$2(ee+1,2)},d(ie,te){return addLeadingZeros$2(ie.getDate(),te.length)},a(ie,te){const ee=ie.getHours()/12>=1?"pm":"am";switch(te){case"a":case"aa":return ee.toUpperCase();case"aaa":return ee;case"aaaaa":return ee[0];case"aaaa":default:return ee==="am"?"a.m.":"p.m."}},h(ie,te){return addLeadingZeros$2(ie.getHours()%12||12,te.length)},H(ie,te){return addLeadingZeros$2(ie.getHours(),te.length)},m(ie,te){return addLeadingZeros$2(ie.getMinutes(),te.length)},s(ie,te){return addLeadingZeros$2(ie.getSeconds(),te.length)},S(ie,te){const ee=te.length,ne=ie.getMilliseconds(),re=Math.trunc(ne*Math.pow(10,ee-3));return addLeadingZeros$2(re,te.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters$1={G:function(ie,te,ee){const ne=ie.getFullYear()>0?1:0;switch(te){case"G":case"GG":case"GGG":return ee.era(ne,{width:"abbreviated"});case"GGGGG":return ee.era(ne,{width:"narrow"});case"GGGG":default:return ee.era(ne,{width:"wide"})}},y:function(ie,te,ee){if(te==="yo"){const ne=ie.getFullYear(),re=ne>0?ne:1-ne;return ee.ordinalNumber(re,{unit:"year"})}return lightFormatters.y(ie,te)},Y:function(ie,te,ee,ne){const re=getWeekYear(ie,ne),se=re>0?re:1-re;if(te==="YY"){const ae=se%100;return addLeadingZeros$2(ae,2)}return te==="Yo"?ee.ordinalNumber(se,{unit:"year"}):addLeadingZeros$2(se,te.length)},R:function(ie,te){const ee=getISOWeekYear(ie);return addLeadingZeros$2(ee,te.length)},u:function(ie,te){const ee=ie.getFullYear();return addLeadingZeros$2(ee,te.length)},Q:function(ie,te,ee){const ne=Math.ceil((ie.getMonth()+1)/3);switch(te){case"Q":return String(ne);case"QQ":return addLeadingZeros$2(ne,2);case"Qo":return ee.ordinalNumber(ne,{unit:"quarter"});case"QQQ":return ee.quarter(ne,{width:"abbreviated",context:"formatting"});case"QQQQQ":return ee.quarter(ne,{width:"narrow",context:"formatting"});case"QQQQ":default:return ee.quarter(ne,{width:"wide",context:"formatting"})}},q:function(ie,te,ee){const ne=Math.ceil((ie.getMonth()+1)/3);switch(te){case"q":return String(ne);case"qq":return addLeadingZeros$2(ne,2);case"qo":return ee.ordinalNumber(ne,{unit:"quarter"});case"qqq":return ee.quarter(ne,{width:"abbreviated",context:"standalone"});case"qqqqq":return ee.quarter(ne,{width:"narrow",context:"standalone"});case"qqqq":default:return ee.quarter(ne,{width:"wide",context:"standalone"})}},M:function(ie,te,ee){const ne=ie.getMonth();switch(te){case"M":case"MM":return lightFormatters.M(ie,te);case"Mo":return ee.ordinalNumber(ne+1,{unit:"month"});case"MMM":return ee.month(ne,{width:"abbreviated",context:"formatting"});case"MMMMM":return ee.month(ne,{width:"narrow",context:"formatting"});case"MMMM":default:return ee.month(ne,{width:"wide",context:"formatting"})}},L:function(ie,te,ee){const ne=ie.getMonth();switch(te){case"L":return String(ne+1);case"LL":return addLeadingZeros$2(ne+1,2);case"Lo":return ee.ordinalNumber(ne+1,{unit:"month"});case"LLL":return ee.month(ne,{width:"abbreviated",context:"standalone"});case"LLLLL":return ee.month(ne,{width:"narrow",context:"standalone"});case"LLLL":default:return ee.month(ne,{width:"wide",context:"standalone"})}},w:function(ie,te,ee,ne){const re=getWeek(ie,ne);return te==="wo"?ee.ordinalNumber(re,{unit:"week"}):addLeadingZeros$2(re,te.length)},I:function(ie,te,ee){const ne=getISOWeek(ie);return te==="Io"?ee.ordinalNumber(ne,{unit:"week"}):addLeadingZeros$2(ne,te.length)},d:function(ie,te,ee){return te==="do"?ee.ordinalNumber(ie.getDate(),{unit:"date"}):lightFormatters.d(ie,te)},D:function(ie,te,ee){const ne=getDayOfYear(ie);return te==="Do"?ee.ordinalNumber(ne,{unit:"dayOfYear"}):addLeadingZeros$2(ne,te.length)},E:function(ie,te,ee){const ne=ie.getDay();switch(te){case"E":case"EE":case"EEE":return ee.day(ne,{width:"abbreviated",context:"formatting"});case"EEEEE":return ee.day(ne,{width:"narrow",context:"formatting"});case"EEEEEE":return ee.day(ne,{width:"short",context:"formatting"});case"EEEE":default:return ee.day(ne,{width:"wide",context:"formatting"})}},e:function(ie,te,ee,ne){const re=ie.getDay(),se=(re-ne.weekStartsOn+8)%7||7;switch(te){case"e":return String(se);case"ee":return addLeadingZeros$2(se,2);case"eo":return ee.ordinalNumber(se,{unit:"day"});case"eee":return ee.day(re,{width:"abbreviated",context:"formatting"});case"eeeee":return ee.day(re,{width:"narrow",context:"formatting"});case"eeeeee":return ee.day(re,{width:"short",context:"formatting"});case"eeee":default:return ee.day(re,{width:"wide",context:"formatting"})}},c:function(ie,te,ee,ne){const re=ie.getDay(),se=(re-ne.weekStartsOn+8)%7||7;switch(te){case"c":return String(se);case"cc":return addLeadingZeros$2(se,te.length);case"co":return ee.ordinalNumber(se,{unit:"day"});case"ccc":return ee.day(re,{width:"abbreviated",context:"standalone"});case"ccccc":return ee.day(re,{width:"narrow",context:"standalone"});case"cccccc":return ee.day(re,{width:"short",context:"standalone"});case"cccc":default:return ee.day(re,{width:"wide",context:"standalone"})}},i:function(ie,te,ee){const ne=ie.getDay(),re=ne===0?7:ne;switch(te){case"i":return String(re);case"ii":return addLeadingZeros$2(re,te.length);case"io":return ee.ordinalNumber(re,{unit:"day"});case"iii":return ee.day(ne,{width:"abbreviated",context:"formatting"});case"iiiii":return ee.day(ne,{width:"narrow",context:"formatting"});case"iiiiii":return ee.day(ne,{width:"short",context:"formatting"});case"iiii":default:return ee.day(ne,{width:"wide",context:"formatting"})}},a:function(ie,te,ee){const re=ie.getHours()/12>=1?"pm":"am";switch(te){case"a":case"aa":return ee.dayPeriod(re,{width:"abbreviated",context:"formatting"});case"aaa":return ee.dayPeriod(re,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return ee.dayPeriod(re,{width:"narrow",context:"formatting"});case"aaaa":default:return ee.dayPeriod(re,{width:"wide",context:"formatting"})}},b:function(ie,te,ee){const ne=ie.getHours();let re;switch(ne===12?re=dayPeriodEnum.noon:ne===0?re=dayPeriodEnum.midnight:re=ne/12>=1?"pm":"am",te){case"b":case"bb":return ee.dayPeriod(re,{width:"abbreviated",context:"formatting"});case"bbb":return ee.dayPeriod(re,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return ee.dayPeriod(re,{width:"narrow",context:"formatting"});case"bbbb":default:return ee.dayPeriod(re,{width:"wide",context:"formatting"})}},B:function(ie,te,ee){const ne=ie.getHours();let re;switch(ne>=17?re=dayPeriodEnum.evening:ne>=12?re=dayPeriodEnum.afternoon:ne>=4?re=dayPeriodEnum.morning:re=dayPeriodEnum.night,te){case"B":case"BB":case"BBB":return ee.dayPeriod(re,{width:"abbreviated",context:"formatting"});case"BBBBB":return ee.dayPeriod(re,{width:"narrow",context:"formatting"});case"BBBB":default:return ee.dayPeriod(re,{width:"wide",context:"formatting"})}},h:function(ie,te,ee){if(te==="ho"){let ne=ie.getHours()%12;return ne===0&&(ne=12),ee.ordinalNumber(ne,{unit:"hour"})}return lightFormatters.h(ie,te)},H:function(ie,te,ee){return te==="Ho"?ee.ordinalNumber(ie.getHours(),{unit:"hour"}):lightFormatters.H(ie,te)},K:function(ie,te,ee){const ne=ie.getHours()%12;return te==="Ko"?ee.ordinalNumber(ne,{unit:"hour"}):addLeadingZeros$2(ne,te.length)},k:function(ie,te,ee){let ne=ie.getHours();return ne===0&&(ne=24),te==="ko"?ee.ordinalNumber(ne,{unit:"hour"}):addLeadingZeros$2(ne,te.length)},m:function(ie,te,ee){return te==="mo"?ee.ordinalNumber(ie.getMinutes(),{unit:"minute"}):lightFormatters.m(ie,te)},s:function(ie,te,ee){return te==="so"?ee.ordinalNumber(ie.getSeconds(),{unit:"second"}):lightFormatters.s(ie,te)},S:function(ie,te){return lightFormatters.S(ie,te)},X:function(ie,te,ee){const ne=ie.getTimezoneOffset();if(ne===0)return"Z";switch(te){case"X":return formatTimezoneWithOptionalMinutes$1(ne);case"XXXX":case"XX":return formatTimezone$1(ne);case"XXXXX":case"XXX":default:return formatTimezone$1(ne,":")}},x:function(ie,te,ee){const ne=ie.getTimezoneOffset();switch(te){case"x":return formatTimezoneWithOptionalMinutes$1(ne);case"xxxx":case"xx":return formatTimezone$1(ne);case"xxxxx":case"xxx":default:return formatTimezone$1(ne,":")}},O:function(ie,te,ee){const ne=ie.getTimezoneOffset();switch(te){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort$1(ne,":");case"OOOO":default:return"GMT"+formatTimezone$1(ne,":")}},z:function(ie,te,ee){const ne=ie.getTimezoneOffset();switch(te){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort$1(ne,":");case"zzzz":default:return"GMT"+formatTimezone$1(ne,":")}},t:function(ie,te,ee){const ne=Math.trunc(+ie/1e3);return addLeadingZeros$2(ne,te.length)},T:function(ie,te,ee){return addLeadingZeros$2(+ie,te.length)}};function formatTimezoneShort$1(ie,te=""){const ee=ie>0?"-":"+",ne=Math.abs(ie),re=Math.trunc(ne/60),se=ne%60;return se===0?ee+String(re):ee+String(re)+te+addLeadingZeros$2(se,2)}function formatTimezoneWithOptionalMinutes$1(ie,te){return ie%60===0?(ie>0?"-":"+")+addLeadingZeros$2(Math.abs(ie)/60,2):formatTimezone$1(ie,te)}function formatTimezone$1(ie,te=""){const ee=ie>0?"-":"+",ne=Math.abs(ie),re=addLeadingZeros$2(Math.trunc(ne/60),2),se=addLeadingZeros$2(ne%60,2);return ee+re+te+se}const dateLongFormatter=(ie,te)=>{switch(ie){case"P":return te.date({width:"short"});case"PP":return te.date({width:"medium"});case"PPP":return te.date({width:"long"});case"PPPP":default:return te.date({width:"full"})}},timeLongFormatter=(ie,te)=>{switch(ie){case"p":return te.time({width:"short"});case"pp":return te.time({width:"medium"});case"ppp":return te.time({width:"long"});case"pppp":default:return te.time({width:"full"})}},dateTimeLongFormatter=(ie,te)=>{const ee=ie.match(/(P+)(p+)?/)||[],ne=ee[1],re=ee[2];if(!re)return dateLongFormatter(ie,te);let se;switch(ne){case"P":se=te.dateTime({width:"short"});break;case"PP":se=te.dateTime({width:"medium"});break;case"PPP":se=te.dateTime({width:"long"});break;case"PPPP":default:se=te.dateTime({width:"full"});break}return se.replace("{{date}}",dateLongFormatter(ne,te)).replace("{{time}}",timeLongFormatter(re,te))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(ie){return dayOfYearTokenRE.test(ie)}function isProtectedWeekYearToken(ie){return weekYearTokenRE.test(ie)}function warnOrThrowProtectedError(ie,te,ee){const ne=message(ie,te,ee);if(console.warn(ne),throwTokens.includes(ie))throw new RangeError(ne)}function message(ie,te,ee){const ne=ie[0]==="Y"?"years":"days of the month";return`Use \`${ie.toLowerCase()}\` instead of \`${ie}\` (in \`${te}\`) for formatting ${ne} to the input \`${ee}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function isDate(ie){return ie instanceof Date||typeof ie=="object"&&Object.prototype.toString.call(ie)==="[object Date]"}function isValid(ie){return!(!isDate(ie)&&typeof ie!="number"||isNaN(+toDate$1(ie)))}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format$1(ie,te,ee){var fe,Ae,pe,Oe,Fe,Ne,ze,He;const ne=getDefaultOptions$1(),re=(ee==null?void 0:ee.locale)??ne.locale??enUS,se=(ee==null?void 0:ee.firstWeekContainsDate)??((Ae=(fe=ee==null?void 0:ee.locale)==null?void 0:fe.options)==null?void 0:Ae.firstWeekContainsDate)??ne.firstWeekContainsDate??((Oe=(pe=ne.locale)==null?void 0:pe.options)==null?void 0:Oe.firstWeekContainsDate)??1,ae=(ee==null?void 0:ee.weekStartsOn)??((Ne=(Fe=ee==null?void 0:ee.locale)==null?void 0:Fe.options)==null?void 0:Ne.weekStartsOn)??ne.weekStartsOn??((He=(ze=ne.locale)==null?void 0:ze.options)==null?void 0:He.weekStartsOn)??0,le=toDate$1(ie,ee==null?void 0:ee.in);if(!isValid(le))throw new RangeError("Invalid time value");let ce=te.match(longFormattingTokensRegExp).map(We=>{const je=We[0];if(je==="p"||je==="P"){const Ue=longFormatters[je];return Ue(We,re.formatLong)}return We}).join("").match(formattingTokensRegExp).map(We=>{if(We==="''")return{isToken:!1,value:"'"};const je=We[0];if(je==="'")return{isToken:!1,value:cleanEscapedString(We)};if(formatters$1[je])return{isToken:!0,value:We};if(je.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+je+"`");return{isToken:!1,value:We}});re.localize.preprocessor&&(ce=re.localize.preprocessor(le,ce));const he={firstWeekContainsDate:se,weekStartsOn:ae,locale:re};return ce.map(We=>{if(!We.isToken)return We.value;const je=We.value;(!(ee!=null&&ee.useAdditionalWeekYearTokens)&&isProtectedWeekYearToken(je)||!(ee!=null&&ee.useAdditionalDayOfYearTokens)&&isProtectedDayOfYearToken(je))&&warnOrThrowProtectedError(je,te,String(ie));const Ue=formatters$1[je[0]];return Ue(le,je,re.localize,he)}).join("")}function cleanEscapedString(ie){const te=ie.match(escapedStringRegExp);return te?te[1].replace(doubleQuoteRegExp,"'"):ie}function getDefaultOptions(){return Object.assign({},getDefaultOptions$1())}function tzIntlTimeZoneName(ie,te,ee){const ne=getDefaultOptions(),re=getDTF(ie,ee.timeZone,ee.locale??ne.locale);return"formatToParts"in re?partsTimeZone(re,te):hackyTimeZone(re,te)}function partsTimeZone(ie,te){const ee=ie.formatToParts(te);for(let ne=ee.length-1;ne>=0;--ne)if(ee[ne].type==="timeZoneName")return ee[ne].value}function hackyTimeZone(ie,te){const ee=ie.format(te).replace(/\u200E/g,""),ne=/ [\w-+ ]+$/.exec(ee);return ne?ne[0].substr(1):""}function getDTF(ie,te,ee){return new Intl.DateTimeFormat(ee?[ee.code,"en-US"]:void 0,{timeZone:te,timeZoneName:ie})}function tzTokenizeDate(ie,te){const ee=getDateTimeFormat(te);return"formatToParts"in ee?partsOffset(ee,ie):hackyOffset(ee,ie)}const typeToPos={year:0,month:1,day:2,hour:3,minute:4,second:5};function partsOffset(ie,te){try{const ee=ie.formatToParts(te),ne=[];for(let re=0;re<ee.length;re++){const se=typeToPos[ee[re].type];se!==void 0&&(ne[se]=parseInt(ee[re].value,10))}return ne}catch(ee){if(ee instanceof RangeError)return[NaN];throw ee}}function hackyOffset(ie,te){const ee=ie.format(te),ne=/(\d+)\/(\d+)\/(\d+),? (\d+):(\d+):(\d+)/.exec(ee);return[parseInt(ne[3],10),parseInt(ne[1],10),parseInt(ne[2],10),parseInt(ne[4],10),parseInt(ne[5],10),parseInt(ne[6],10)]}const dtfCache={},testDateFormatted=new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date("2014-06-25T04:00:00.123Z")),hourCycleSupported=testDateFormatted==="06/25/2014, 00:00:00"||testDateFormatted==="‎06‎/‎25‎/‎2014‎ ‎00‎:‎00‎:‎00";function getDateTimeFormat(ie){return dtfCache[ie]||(dtfCache[ie]=hourCycleSupported?new Intl.DateTimeFormat("en-US",{hourCycle:"h23",timeZone:ie,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:ie,year:"numeric",month:"numeric",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),dtfCache[ie]}function newDateUTC(ie,te,ee,ne,re,se,ae){const le=new Date(0);return le.setUTCFullYear(ie,te,ee),le.setUTCHours(ne,re,se,ae),le}const MILLISECONDS_IN_HOUR$1=36e5,MILLISECONDS_IN_MINUTE$2=6e4,patterns$1={timezoneZ:/^(Z)$/,timezoneHH:/^([+-]\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function tzParseTimezone(ie,te,ee){if(!ie)return 0;let ne=patterns$1.timezoneZ.exec(ie);if(ne)return 0;let re,se;if(ne=patterns$1.timezoneHH.exec(ie),ne)return re=parseInt(ne[1],10),validateTimezone(re)?-(re*MILLISECONDS_IN_HOUR$1):NaN;if(ne=patterns$1.timezoneHHMM.exec(ie),ne){re=parseInt(ne[2],10);const ae=parseInt(ne[3],10);return validateTimezone(re,ae)?(se=Math.abs(re)*MILLISECONDS_IN_HOUR$1+ae*MILLISECONDS_IN_MINUTE$2,ne[1]==="+"?-se:se):NaN}if(isValidTimezoneIANAString(ie)){te=new Date(te||Date.now());const ae=ee?te:toUtcDate(te),le=calcOffset(ae,ie);return-(ee?le:fixOffset(te,le,ie))}return NaN}function toUtcDate(ie){return newDateUTC(ie.getFullYear(),ie.getMonth(),ie.getDate(),ie.getHours(),ie.getMinutes(),ie.getSeconds(),ie.getMilliseconds())}function calcOffset(ie,te){const ee=tzTokenizeDate(ie,te),ne=newDateUTC(ee[0],ee[1]-1,ee[2],ee[3]%24,ee[4],ee[5],0).getTime();let re=ie.getTime();const se=re%1e3;return re-=se>=0?se:1e3+se,ne-re}function fixOffset(ie,te,ee){let re=ie.getTime()-te;const se=calcOffset(new Date(re),ee);if(te===se)return te;re-=se-te;const ae=calcOffset(new Date(re),ee);return se===ae?se:Math.max(se,ae)}function validateTimezone(ie,te){return-23<=ie&&ie<=23&&(te==null||0<=te&&te<=59)}const validIANATimezoneCache={};function isValidTimezoneIANAString(ie){if(validIANATimezoneCache[ie])return!0;try{return new Intl.DateTimeFormat(void 0,{timeZone:ie}),validIANATimezoneCache[ie]=!0,!0}catch{return!1}}const MILLISECONDS_IN_MINUTE$1=60*1e3,formatters={X:function(ie,te,ee){const ne=getTimeZoneOffset(ee.timeZone,ie);if(ne===0)return"Z";switch(te){case"X":return formatTimezoneWithOptionalMinutes(ne);case"XXXX":case"XX":return formatTimezone(ne);case"XXXXX":case"XXX":default:return formatTimezone(ne,":")}},x:function(ie,te,ee){const ne=getTimeZoneOffset(ee.timeZone,ie);switch(te){case"x":return formatTimezoneWithOptionalMinutes(ne);case"xxxx":case"xx":return formatTimezone(ne);case"xxxxx":case"xxx":default:return formatTimezone(ne,":")}},O:function(ie,te,ee){const ne=getTimeZoneOffset(ee.timeZone,ie);switch(te){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(ne,":");case"OOOO":default:return"GMT"+formatTimezone(ne,":")}},z:function(ie,te,ee){switch(te){case"z":case"zz":case"zzz":return tzIntlTimeZoneName("short",ie,ee);case"zzzz":default:return tzIntlTimeZoneName("long",ie,ee)}}};function getTimeZoneOffset(ie,te){const ee=ie?tzParseTimezone(ie,te,!0)/MILLISECONDS_IN_MINUTE$1:(te==null?void 0:te.getTimezoneOffset())??0;if(Number.isNaN(ee))throw new RangeError("Invalid time zone specified: "+ie);return ee}function addLeadingZeros$1(ie,te){const ee=ie<0?"-":"";let ne=Math.abs(ie).toString();for(;ne.length<te;)ne="0"+ne;return ee+ne}function formatTimezone(ie,te=""){const ee=ie>0?"-":"+",ne=Math.abs(ie),re=addLeadingZeros$1(Math.floor(ne/60),2),se=addLeadingZeros$1(Math.floor(ne%60),2);return ee+re+te+se}function formatTimezoneWithOptionalMinutes(ie,te){return ie%60===0?(ie>0?"-":"+")+addLeadingZeros$1(Math.abs(ie)/60,2):formatTimezone(ie,te)}function formatTimezoneShort(ie,te=""){const ee=ie>0?"-":"+",ne=Math.abs(ie),re=Math.floor(ne/60),se=ne%60;return se===0?ee+String(re):ee+String(re)+te+addLeadingZeros$1(se,2)}function getTimezoneOffsetInMilliseconds(ie){const te=new Date(Date.UTC(ie.getFullYear(),ie.getMonth(),ie.getDate(),ie.getHours(),ie.getMinutes(),ie.getSeconds(),ie.getMilliseconds()));return te.setUTCFullYear(ie.getFullYear()),+ie-+te}const tzPattern=/(Z|[+-]\d{2}(?::?\d{2})?| UTC| [a-zA-Z]+\/[a-zA-Z_]+(?:\/[a-zA-Z_]+)?)$/,MILLISECONDS_IN_HOUR=36e5,MILLISECONDS_IN_MINUTE=6e4,DEFAULT_ADDITIONAL_DIGITS=2,patterns={dateTimePattern:/^([0-9W+-]+)(T| )(.*)/,datePattern:/^([0-9W+-]+)(.*)/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timeZone:tzPattern};function toDate(ie,te={}){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(ie===null)return new Date(NaN);const ee=te.additionalDigits==null?DEFAULT_ADDITIONAL_DIGITS:Number(te.additionalDigits);if(ee!==2&&ee!==1&&ee!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(ie instanceof Date||typeof ie=="object"&&Object.prototype.toString.call(ie)==="[object Date]")return new Date(ie.getTime());if(typeof ie=="number"||Object.prototype.toString.call(ie)==="[object Number]")return new Date(ie);if(Object.prototype.toString.call(ie)!=="[object String]")return new Date(NaN);const ne=splitDateString(ie),{year:re,restDateString:se}=parseYear(ne.date,ee),ae=parseDate(se,re);if(ae===null||isNaN(ae.getTime()))return new Date(NaN);if(ae){const le=ae.getTime();let ce=0,he;if(ne.time&&(ce=parseTime(ne.time),ce===null||isNaN(ce)))return new Date(NaN);if(ne.timeZone||te.timeZone){if(he=tzParseTimezone(ne.timeZone||te.timeZone,new Date(le+ce)),isNaN(he))return new Date(NaN)}else he=getTimezoneOffsetInMilliseconds(new Date(le+ce)),he=getTimezoneOffsetInMilliseconds(new Date(le+ce+he));return new Date(le+ce+he)}else return new Date(NaN)}function splitDateString(ie){const te={};let ee=patterns.dateTimePattern.exec(ie),ne;if(ee?(te.date=ee[1],ne=ee[3]):(ee=patterns.datePattern.exec(ie),ee?(te.date=ee[1],ne=ee[2]):(te.date=null,ne=ie)),ne){const re=patterns.timeZone.exec(ne);re?(te.time=ne.replace(re[1],""),te.timeZone=re[1].trim()):te.time=ne}return te}function parseYear(ie,te){if(ie){const ee=patterns.YYY[te],ne=patterns.YYYYY[te];let re=patterns.YYYY.exec(ie)||ne.exec(ie);if(re){const se=re[1];return{year:parseInt(se,10),restDateString:ie.slice(se.length)}}if(re=patterns.YY.exec(ie)||ee.exec(ie),re){const se=re[1];return{year:parseInt(se,10)*100,restDateString:ie.slice(se.length)}}}return{year:null}}function parseDate(ie,te){if(te===null)return null;let ee,ne,re;if(!ie||!ie.length)return ee=new Date(0),ee.setUTCFullYear(te),ee;let se=patterns.MM.exec(ie);if(se)return ee=new Date(0),ne=parseInt(se[1],10)-1,validateDate(te,ne)?(ee.setUTCFullYear(te,ne),ee):new Date(NaN);if(se=patterns.DDD.exec(ie),se){ee=new Date(0);const ae=parseInt(se[1],10);return validateDayOfYearDate(te,ae)?(ee.setUTCFullYear(te,0,ae),ee):new Date(NaN)}if(se=patterns.MMDD.exec(ie),se){ee=new Date(0),ne=parseInt(se[1],10)-1;const ae=parseInt(se[2],10);return validateDate(te,ne,ae)?(ee.setUTCFullYear(te,ne,ae),ee):new Date(NaN)}if(se=patterns.Www.exec(ie),se)return re=parseInt(se[1],10)-1,validateWeekDate(re)?dayOfISOWeekYear(te,re):new Date(NaN);if(se=patterns.WwwD.exec(ie),se){re=parseInt(se[1],10)-1;const ae=parseInt(se[2],10)-1;return validateWeekDate(re,ae)?dayOfISOWeekYear(te,re,ae):new Date(NaN)}return null}function parseTime(ie){let te,ee,ne=patterns.HH.exec(ie);if(ne)return te=parseFloat(ne[1].replace(",",".")),validateTime(te)?te%24*MILLISECONDS_IN_HOUR:NaN;if(ne=patterns.HHMM.exec(ie),ne)return te=parseInt(ne[1],10),ee=parseFloat(ne[2].replace(",",".")),validateTime(te,ee)?te%24*MILLISECONDS_IN_HOUR+ee*MILLISECONDS_IN_MINUTE:NaN;if(ne=patterns.HHMMSS.exec(ie),ne){te=parseInt(ne[1],10),ee=parseInt(ne[2],10);const re=parseFloat(ne[3].replace(",","."));return validateTime(te,ee,re)?te%24*MILLISECONDS_IN_HOUR+ee*MILLISECONDS_IN_MINUTE+re*1e3:NaN}return null}function dayOfISOWeekYear(ie,te,ee){te=te||0,ee=ee||0;const ne=new Date(0);ne.setUTCFullYear(ie,0,4);const re=ne.getUTCDay()||7,se=te*7+ee+1-re;return ne.setUTCDate(ne.getUTCDate()+se),ne}const DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],DAYS_IN_MONTH_LEAP_YEAR=[31,29,31,30,31,30,31,31,30,31,30,31];function isLeapYearIndex(ie){return ie%400===0||ie%4===0&&ie%100!==0}function validateDate(ie,te,ee){if(te<0||te>11)return!1;if(ee!=null){if(ee<1)return!1;const ne=isLeapYearIndex(ie);if(ne&&ee>DAYS_IN_MONTH_LEAP_YEAR[te]||!ne&&ee>DAYS_IN_MONTH[te])return!1}return!0}function validateDayOfYearDate(ie,te){if(te<1)return!1;const ee=isLeapYearIndex(ie);return!(ee&&te>366||!ee&&te>365)}function validateWeekDate(ie,te){return!(ie<0||ie>52||te!=null&&(te<0||te>6))}function validateTime(ie,te,ee){return!(ie<0||ie>=25||te!=null&&(te<0||te>=60)||ee!=null&&(ee<0||ee>=60))}const tzFormattingTokensRegExp=/([xXOz]+)|''|'(''|[^'])+('|$)/g;function format(ie,te,ee={}){te=String(te);const ne=te.match(tzFormattingTokensRegExp);if(ne){const re=toDate(ee.originalDate||ie,ee);te=ne.reduce(function(se,ae){if(ae[0]==="'")return se;const le=se.indexOf(ae),ce=se[le-1]==="'",he=se.replace(ae,"'"+formatters[ae[0]](re,ae,ee)+"'");return ce?he.substring(0,le-1)+he.substring(le+1):he},te)}return format$1(ie,te,ee)}function toZonedTime(ie,te,ee){ie=toDate(ie,ee);const ne=tzParseTimezone(te,ie,!0),re=new Date(ie.getTime()-ne),se=new Date(0);return se.setFullYear(re.getUTCFullYear(),re.getUTCMonth(),re.getUTCDate()),se.setHours(re.getUTCHours(),re.getUTCMinutes(),re.getUTCSeconds(),re.getUTCMilliseconds()),se}function formatInTimeZone(ie,te,ee,ne){return ne={...ne,timeZone:te,originalDate:ie},format(toZonedTime(ie,te,{timeZone:ne.timeZone}),ee,ne)}function size(ie){var te=ie.width,ee=ie.height;if(te<0)throw new Error("Negative width is not allowed for Size");if(ee<0)throw new Error("Negative height is not allowed for Size");return{width:te,height:ee}}function equalSizes(ie,te){return ie.width===te.width&&ie.height===te.height}var Observable=function(){function ie(te){var ee=this;this._resolutionListener=function(){return ee._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=te,this._installResolutionListener()}return ie.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(ie.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),ie.prototype.subscribe=function(te){var ee=this,ne={next:te};return this._observers.push(ne),{unsubscribe:function(){ee._observers=ee._observers.filter(function(re){return re!==ne})}}},ie.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var te=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(te,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},ie.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},ie.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},ie.prototype._onResolutionChanged=function(){var te=this;this._observers.forEach(function(ee){return ee.next(te._window.devicePixelRatio)}),this._reinstallResolutionListener()},ie}();function createObservable(ie){return new Observable(ie)}var DevicePixelContentBoxBinding=function(){function ie(te,ee,ne){var re;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=te,this._canvasElementClientSize=size({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=ee??function(se){return se},this._allowResizeObserver=(re=ne==null?void 0:ne.allowResizeObserver)!==null&&re!==void 0?re:!0,this._chooseAndInitObserver()}return ie.prototype.dispose=function(){var te,ee;if(this._canvasElement===null)throw new Error("Object is disposed");(te=this._canvasElementResizeObserver)===null||te===void 0||te.disconnect(),this._canvasElementResizeObserver=null,(ee=this._devicePixelRatioObservable)===null||ee===void 0||ee.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(ie.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"bitmapSize",{get:function(){return size({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),ie.prototype.resizeCanvasElement=function(te){this._canvasElementClientSize=size(te),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},ie.prototype.subscribeBitmapSizeChanged=function(te){this._bitmapSizeChangedListeners.push(te)},ie.prototype.unsubscribeBitmapSizeChanged=function(te){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(ee){return ee!==te})},Object.defineProperty(ie.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),ie.prototype.subscribeSuggestedBitmapSizeChanged=function(te){this._suggestedBitmapSizeChangedListeners.push(te)},ie.prototype.unsubscribeSuggestedBitmapSizeChanged=function(te){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(ee){return ee!==te})},ie.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var te=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(te),this._emitSuggestedBitmapSizeChanged(te,this._suggestedBitmapSize)}},ie.prototype._resizeBitmap=function(te){var ee=this.bitmapSize;equalSizes(ee,te)||(this.canvasElement.width=te.width,this.canvasElement.height=te.height,this._emitBitmapSizeChanged(ee,te))},ie.prototype._emitBitmapSizeChanged=function(te,ee){var ne=this;this._bitmapSizeChangedListeners.forEach(function(re){return re.call(ne,te,ee)})},ie.prototype._suggestNewBitmapSize=function(te){var ee=this._suggestedBitmapSize,ne=size(this._transformBitmapSize(te,this._canvasElementClientSize)),re=equalSizes(this.bitmapSize,ne)?null:ne;ee===null&&re===null||ee!==null&&re!==null&&equalSizes(ee,re)||(this._suggestedBitmapSize=re,this._emitSuggestedBitmapSizeChanged(ee,re))},ie.prototype._emitSuggestedBitmapSizeChanged=function(te,ee){var ne=this;this._suggestedBitmapSizeChangedListeners.forEach(function(re){return re.call(ne,te,ee)})},ie.prototype._chooseAndInitObserver=function(){var te=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}isDevicePixelContentBoxSupported().then(function(ee){return ee?te._initResizeObserver():te._initDevicePixelRatioObservable()})},ie.prototype._initDevicePixelRatioObservable=function(){var te=this;if(this._canvasElement!==null){var ee=canvasElementWindow(this._canvasElement);if(ee===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=createObservable(ee),this._devicePixelRatioObservable.subscribe(function(){return te._invalidateBitmapSize()}),this._invalidateBitmapSize()}},ie.prototype._invalidateBitmapSize=function(){var te,ee;if(this._canvasElement!==null){var ne=canvasElementWindow(this._canvasElement);if(ne!==null){var re=(ee=(te=this._devicePixelRatioObservable)===null||te===void 0?void 0:te.value)!==null&&ee!==void 0?ee:ne.devicePixelRatio,se=this._canvasElement.getClientRects(),ae=se[0]!==void 0?predictedBitmapSize(se[0],re):size({width:this._canvasElementClientSize.width*re,height:this._canvasElementClientSize.height*re});this._suggestNewBitmapSize(ae)}}},ie.prototype._initResizeObserver=function(){var te=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(ee){var ne=ee.find(function(ae){return ae.target===te._canvasElement});if(!(!ne||!ne.devicePixelContentBoxSize||!ne.devicePixelContentBoxSize[0])){var re=ne.devicePixelContentBoxSize[0],se=size({width:re.inlineSize,height:re.blockSize});te._suggestNewBitmapSize(se)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},ie}();function bindTo(ie,te){return new DevicePixelContentBoxBinding(ie,te.transform,te.options)}function canvasElementWindow(ie){return ie.ownerDocument.defaultView}function isDevicePixelContentBoxSupported(){return new Promise(function(ie){var te=new ResizeObserver(function(ee){ie(ee.every(function(ne){return"devicePixelContentBoxSize"in ne})),te.disconnect()});te.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function predictedBitmapSize(ie,te){return size({width:Math.round(ie.left*te+ie.width*te)-Math.round(ie.left*te),height:Math.round(ie.top*te+ie.height*te)-Math.round(ie.top*te)})}var CanvasRenderingTarget2D=function(){function ie(te,ee,ne){if(ee.width===0||ee.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=ee,ne.width===0||ne.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=ne,this._context=te}return ie.prototype.useMediaCoordinateSpace=function(te){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),te({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},ie.prototype.useBitmapCoordinateSpace=function(te){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),te({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(ie.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(ie.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),ie}();function tryCreateCanvasRenderingTarget2D(ie,te){var ee=ie.canvasElementClientSize;if(ee.width===0||ee.height===0)return null;var ne=ie.bitmapSize;if(ne.width===0||ne.height===0)return null;var re=ie.canvasElement.getContext("2d",te);return re===null?null:new CanvasRenderingTarget2D(re,ee,ne)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.7-dev+202508010838
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const e$1={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var r$1,h;function a$1(ie,te){const ee={0:[],1:[ie.lineWidth,ie.lineWidth],2:[2*ie.lineWidth,2*ie.lineWidth],3:[6*ie.lineWidth,6*ie.lineWidth],4:[ie.lineWidth,4*ie.lineWidth]}[te];ie.setLineDash(ee)}function l$1(ie,te,ee,ne){ie.beginPath();const re=ie.lineWidth%2?.5:0;ie.moveTo(ee,te+re),ie.lineTo(ne,te+re),ie.stroke()}function o$1(ie,te){if(!ie)throw new Error("Assertion failed"+(te?": "+te:""))}function _(ie){if(ie===void 0)throw new Error("Value is undefined");return ie}function u$1(ie){if(ie===null)throw new Error("Value is null");return ie}function c(ie){return u$1(_(ie))}(function(ie){ie[ie.Simple=0]="Simple",ie[ie.WithSteps=1]="WithSteps",ie[ie.Curved=2]="Curved"})(r$1||(r$1={})),function(ie){ie[ie.Solid=0]="Solid",ie[ie.Dotted=1]="Dotted",ie[ie.Dashed=2]="Dashed",ie[ie.LargeDashed=3]="LargeDashed",ie[ie.SparseDotted=4]="SparseDotted"}(h||(h={}));let d$1=class{constructor(){this.t=[]}i(te,ee,ne){const re={h:te,l:ee,o:ne===!0};this.t.push(re)}_(te){const ee=this.t.findIndex(ne=>te===ne.h);ee>-1&&this.t.splice(ee,1)}u(te){this.t=this.t.filter(ee=>ee.l!==te)}p(te,ee,ne){const re=[...this.t];this.t=this.t.filter(se=>!se.o),re.forEach(se=>se.h(te,ee,ne))}v(){return this.t.length>0}m(){this.t=[]}};function f(ie,...te){for(const ee of te)for(const ne in ee)ee[ne]!==void 0&&Object.prototype.hasOwnProperty.call(ee,ne)&&!["__proto__","constructor","prototype"].includes(ne)&&(typeof ee[ne]!="object"||ie[ne]===void 0||Array.isArray(ee[ne])?ie[ne]=ee[ne]:f(ie[ne],ee[ne]));return ie}function p(ie){return typeof ie=="number"&&isFinite(ie)}function v(ie){return typeof ie=="number"&&ie%1==0}function m(ie){return typeof ie=="string"}function w(ie){return typeof ie=="boolean"}function M$2(ie){const te=ie;if(!te||typeof te!="object")return te;let ee,ne,re;for(ne in ee=Array.isArray(te)?[]:{},te)te.hasOwnProperty(ne)&&(re=te[ne],ee[ne]=re&&typeof re=="object"?M$2(re):re);return ee}function g(ie){return ie!==null}function b(ie){return ie===null?void 0:ie}const x="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function S$1(ie,te,ee){return te===void 0&&(te=x),`${ee=ee!==void 0?`${ee} `:""}${ie}px ${te}`}let C$1=class{constructor(te){this.M={S:1,C:5,P:NaN,k:"",T:"",R:"",D:"",I:"",B:0,V:0,A:0,L:0,O:0},this.N=te}W(){const te=this.M,ee=this.F(),ne=this.H();return te.P===ee&&te.T===ne||(te.P=ee,te.T=ne,te.k=S$1(ee,ne),te.L=2.5/12*ee,te.B=te.L,te.V=ee/12*te.C,te.A=ee/12*te.C,te.O=0),te.R=this.U(),te.D=this.$(),te.I=this.q(),this.M}U(){return this.N.W().layout.textColor}$(){const te=this.N.W().rightPriceScale.background;return te?te.type==="solid"?te.color:te.topColor:this.N.Y()}q(){const te=this.N.W().rightPriceScale.background;return te?te.type==="solid"?te.color:te.bottomColor:this.N.j()}F(){return this.N.W().layout.fontSize}H(){return this.N.W().layout.fontFamily}};function P$1(ie){return ie<0?0:ie>255?255:Math.round(ie)||0}function y(ie){return .199*ie[0]+.687*ie[1]+.114*ie[2]}let k$1=class{constructor(te,ee){this.K=new Map,this.X=te,ee&&(this.K=ee)}G(te,ee){if(te==="transparent")return te;const ne=this.Z(te),re=ne[3];return`rgba(${ne[0]}, ${ne[1]}, ${ne[2]}, ${ee*re})`}J(te){const ee=this.Z(te);return{tt:`rgb(${ee[0]}, ${ee[1]}, ${ee[2]})`,it:y(ee)>160?"black":"white"}}st(te){return y(this.Z(te))}nt(te,ee,ne){const[re,se,ae,le]=this.Z(te),[ce,he,fe,Ae]=this.Z(ee),pe=[P$1(re+ne*(ce-re)),P$1(se+ne*(he-se)),P$1(ae+ne*(fe-ae)),(Oe=le+ne*(Ae-le),Oe<=0||Oe>1?Math.min(Math.max(Oe,0),1):Math.round(1e4*Oe)/1e4)];var Oe;return`rgba(${pe[0]}, ${pe[1]}, ${pe[2]}, ${pe[3]})`}Z(te){const ee=this.K.get(te);if(ee)return ee;const ne=function(ae){const le=document.createElement("div");le.style.display="none",document.body.appendChild(le),le.style.color=ae;const ce=window.getComputedStyle(le).color;return document.body.removeChild(le),ce}(te),re=ne.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!re){if(this.X.length)for(const ae of this.X){const le=ae(te);if(le)return this.K.set(te,le),le}throw new Error(`Failed to parse color: ${te}`)}const se=[parseInt(re[1],10),parseInt(re[2],10),parseInt(re[3],10),re[4]?parseFloat(re[4]):1];return this.K.set(te,se),se}};class T{constructor(){this.et=[]}rt(te){this.et=te}ht(te,ee,ne){this.et.forEach(re=>{re.ht(te,ee,ne)})}}class R{ht(te,ee,ne){te.useBitmapCoordinateSpace(re=>this.lt(re,ee,ne))}}class D extends R{constructor(){super(...arguments),this.ot=null}_t(te){this.ot=te}lt({context:te,horizontalPixelRatio:ee,verticalPixelRatio:ne}){if(this.ot===null||this.ot.ut===null)return;const re=this.ot.ut,se=this.ot,ae=Math.max(1,Math.floor(ee))%2/2,le=ce=>{te.beginPath();for(let he=re.to-1;he>=re.from;--he){const fe=se.ct[he],Ae=Math.round(fe.dt*ee)+ae,pe=fe.ft*ne,Oe=ce*ne+ae;te.moveTo(Ae,pe),te.arc(Ae,pe,Oe,0,2*Math.PI)}te.fill()};se.vt>0&&(te.fillStyle=se.wt,le(se.Mt+se.vt)),te.fillStyle=se.gt,le(se.Mt)}}function I(){return{ct:[{dt:0,ft:0,bt:0,xt:0}],gt:"",wt:"",Mt:0,vt:0,ut:null}}const B={from:0,to:1};class V{constructor(te,ee,ne){this.St=new T,this.Ct=[],this.Pt=[],this.yt=!0,this.N=te,this.kt=ee,this.Tt=ne,this.St.rt(this.Ct)}Rt(te){this.Dt(),this.yt=!0}It(){return this.yt&&(this.Bt(),this.yt=!1),this.St}Dt(){const te=this.Tt.Vt();te.length!==this.Ct.length&&(this.Pt=te.map(I),this.Ct=this.Pt.map(ee=>{const ne=new D;return ne._t(ee),ne}),this.St.rt(this.Ct))}Bt(){const te=this.kt.W().mode===2||!this.kt.Et(),ee=this.Tt.At(),ne=this.kt.zt(),re=this.N.Lt();this.Dt(),ee.forEach((se,ae)=>{const le=this.Pt[ae],ce=se.Ot(ne),he=se.Nt();!te&&ce!==null&&se.Et()&&he!==null?(le.gt=ce.Wt,le.Mt=ce.Mt,le.vt=ce.Ft,le.ct[0].xt=ce.xt,le.ct[0].ft=se.Ut().Ht(ce.xt,he.$t),le.wt=ce.qt??this.N.Yt(le.ct[0].ft/se.Ut().jt()),le.ct[0].bt=ne,le.ct[0].dt=re.Kt(ne),le.ut=B):le.ut=null})}}class E extends R{constructor(te){super(),this.Xt=te}lt({context:te,bitmapSize:ee,horizontalPixelRatio:ne,verticalPixelRatio:re}){if(this.Xt===null)return;const se=this.Xt.Gt.Et,ae=this.Xt.Zt.Et;if(!se&&!ae)return;const le=Math.round(this.Xt.dt*ne),ce=Math.round(this.Xt.ft*re);te.lineCap="butt",se&&le>=0&&(te.lineWidth=Math.floor(this.Xt.Gt.vt*ne),te.strokeStyle=this.Xt.Gt.R,te.fillStyle=this.Xt.Gt.R,a$1(te,this.Xt.Gt.Jt),function(he,fe,Ae,pe){he.beginPath();const Oe=he.lineWidth%2?.5:0;he.moveTo(fe+Oe,Ae),he.lineTo(fe+Oe,pe),he.stroke()}(te,le,0,ee.height)),ae&&ce>=0&&(te.lineWidth=Math.floor(this.Xt.Zt.vt*re),te.strokeStyle=this.Xt.Zt.R,te.fillStyle=this.Xt.Zt.R,a$1(te,this.Xt.Zt.Jt),l$1(te,ce,0,ee.width))}}let A$1=class{constructor(te,ee){this.yt=!0,this.Qt={Gt:{vt:1,Jt:0,R:"",Et:!1},Zt:{vt:1,Jt:0,R:"",Et:!1},dt:0,ft:0},this.ti=new E(this.Qt),this.ii=te,this.Tt=ee}Rt(){this.yt=!0}It(te){return this.yt&&(this.Bt(),this.yt=!1),this.ti}Bt(){const te=this.ii.Et(),ee=this.Tt.si().W().crosshair,ne=this.Qt;if(ee.mode===2)return ne.Zt.Et=!1,void(ne.Gt.Et=!1);ne.Zt.Et=te&&this.ii.ni(this.Tt),ne.Gt.Et=te&&this.ii.ei(),ne.Zt.vt=ee.horzLine.width,ne.Zt.Jt=ee.horzLine.style,ne.Zt.R=ee.horzLine.color,ne.Gt.vt=ee.vertLine.width,ne.Gt.Jt=ee.vertLine.style,ne.Gt.R=ee.vertLine.color,ne.dt=this.ii.ri(),ne.ft=this.ii.hi()}};function z(ie,te,ee,ne,re,se){ie.fillRect(te+se,ee,ne-2*se,se),ie.fillRect(te+se,ee+re-se,ne-2*se,se),ie.fillRect(te,ee,se,re),ie.fillRect(te+ne-se,ee,se,re)}function L(ie,te,ee,ne,re,se){ie.save(),ie.globalCompositeOperation="copy",ie.fillStyle=se,ie.fillRect(te,ee,ne,re),ie.restore()}function O(ie,te,ee,ne,re,se){ie.beginPath(),ie.roundRect?ie.roundRect(te,ee,ne,re,se):(ie.lineTo(te+ne-se[1],ee),se[1]!==0&&ie.arcTo(te+ne,ee,te+ne,ee+se[1],se[1]),ie.lineTo(te+ne,ee+re-se[2]),se[2]!==0&&ie.arcTo(te+ne,ee+re,te+ne-se[2],ee+re,se[2]),ie.lineTo(te+se[3],ee+re),se[3]!==0&&ie.arcTo(te,ee+re,te,ee+re-se[3],se[3]),ie.lineTo(te,ee+se[0]),se[0]!==0&&ie.arcTo(te,ee,te+se[0],ee,se[0]))}function N(ie,te,ee,ne,re,se,ae=0,le=[0,0,0,0],ce=""){if(ie.save(),!ae||!ce||ce===se)return O(ie,te,ee,ne,re,le),ie.fillStyle=se,ie.fill(),void ie.restore();const he=ae/2;var fe;O(ie,te+he,ee+he,ne-ae,re-ae,(fe=-he,le.map(Ae=>Ae===0?Ae:Ae+fe))),se!=="transparent"&&(ie.fillStyle=se,ie.fill()),ce!=="transparent"&&(ie.lineWidth=ae,ie.strokeStyle=ce,ie.closePath(),ie.stroke()),ie.restore()}function W(ie,te,ee,ne,re,se,ae){ie.save(),ie.globalCompositeOperation="copy";const le=ie.createLinearGradient(0,0,0,re);le.addColorStop(0,se),le.addColorStop(1,ae),ie.fillStyle=le,ie.fillRect(te,ee,ne,re),ie.restore()}class F{constructor(te,ee){this._t(te,ee)}_t(te,ee){this.Xt=te,this.ai=ee}jt(te,ee){return this.Xt.Et?te.P+te.L+te.B:0}ht(te,ee,ne,re){if(!this.Xt.Et||this.Xt.li.length===0)return;const se=this.Xt.R,ae=this.ai.tt,le=this.Xt.oi,ce=te.useBitmapCoordinateSpace(he=>{const fe=he.context;fe.font=ee.k;const Ae=this._i(he,ee,ne,re,le),pe=Ae.ui;return Ae.ci?N(fe,pe.di,pe.fi,pe.pi,pe.mi,ae,pe.wi,[pe.Mt,0,0,pe.Mt],le||ae):N(fe,pe.Mi,pe.fi,pe.pi,pe.mi,ae,pe.wi,[0,pe.Mt,pe.Mt,0],le||ae),this.Xt.gi&&(fe.fillStyle=se,fe.fillRect(pe.Mi,pe.bi,pe.xi-pe.Mi,pe.Si)),this.Xt.Ci&&(fe.fillStyle=ee.D,fe.fillRect(Ae.ci?pe.Pi-pe.wi:0,pe.fi,pe.wi,pe.yi-pe.fi)),Ae});te.useMediaCoordinateSpace(({context:he})=>{const fe=ce.ki;he.font=ee.k,he.textAlign=ce.ci?"right":"left",he.textBaseline="middle",he.fillStyle=se,he.fillText(this.Xt.li,fe.Ti,(fe.fi+fe.yi)/2+fe.Ri)})}_i(te,ee,ne,re,se){const{context:ae,bitmapSize:le,mediaSize:ce,horizontalPixelRatio:he,verticalPixelRatio:fe}=te,Ae=this.Xt.gi||!this.Xt.Di?ee.C:0,pe=this.Xt.Ii||se?ee.S:0,Oe=ee.L+this.ai.Bi,Fe=ee.B+this.ai.Vi,Ne=ee.V,ze=ee.A,He=this.Xt.li,We=ee.P,je=ne.yMidCorrection(ae,He),Ue=Math.ceil(ne.measureText(ae,He)),Ge=We+Oe+Fe,Ze=ee.S+Ne+ze+Ue+Ae,Ye=Math.max(1,Math.floor(fe));let qe=Math.round(Ge*fe);qe%2!=Ye%2&&(qe+=1);const nr=pe>0?Math.max(1,Math.floor(pe*he)):0,ir=Math.round(Ze*he),tr=Math.round(Ae*he),or=this.ai.Ei??this.ai.Ai,Jt=Math.round(or*fe)-Math.floor(.5*fe),rr=Math.floor(Jt+Ye/2-qe/2),lr=rr+qe,ur=re==="right",Sr=ur?ce.width-pe:pe,xr=ur?le.width-nr:nr;let Pr,mr,Er;return ur?(Pr=xr-ir,mr=xr-tr,Er=Sr-Ae-Ne-pe):(Pr=xr+ir,mr=xr+tr,Er=Sr+Ae+Ne),{ci:ur,ui:{fi:rr,bi:Jt,yi:lr,pi:ir,mi:qe,Mt:2*he,wi:nr,di:Pr,Mi:xr,xi:mr,Si:Ye,Pi:le.width},ki:{fi:rr/fe,yi:lr/fe,Ti:Er,Ri:je}}}}class H{constructor(te){this.zi={Ai:0,tt:"#000",Vi:0,Bi:0},this.Li={li:"",Et:!1,gi:!0,Di:!1,qt:"",R:"#FFF",Ci:!1,Ii:!1},this.Oi={li:"",Et:!1,gi:!1,Di:!0,qt:"",R:"#FFF",Ci:!0,Ii:!0},this.yt=!0,this.Ni=new(te||F)(this.Li,this.zi),this.Wi=new(te||F)(this.Oi,this.zi)}li(){return this.Fi(),this.Li.li}Ai(){return this.Fi(),this.zi.Ai}Rt(){this.yt=!0}jt(te,ee=!1){return Math.max(this.Ni.jt(te,ee),this.Wi.jt(te,ee))}Hi(){return this.zi.Ei||0}Ui(te){this.zi.Ei=te}$i(){return this.Fi(),this.Li.Et||this.Oi.Et}qi(){return this.Fi(),this.Li.Et}It(te){return this.Fi(),this.Li.gi=this.Li.gi&&te.W().ticksVisible,this.Oi.gi=this.Oi.gi&&te.W().ticksVisible,this.Ni._t(this.Li,this.zi),this.Wi._t(this.Oi,this.zi),this.Ni}Yi(){return this.Fi(),this.Ni._t(this.Li,this.zi),this.Wi._t(this.Oi,this.zi),this.Wi}Fi(){this.yt&&(this.Li.gi=!0,this.Oi.gi=!1,this.ji(this.Li,this.Oi,this.zi))}}class U extends H{constructor(te,ee,ne){super(),this.ii=te,this.Ki=ee,this.Xi=ne}ji(te,ee,ne){if(te.Et=!1,this.ii.W().mode===2)return;const re=this.ii.W().horzLine;if(!re.labelVisible)return;const se=this.Ki.Nt();if(!this.ii.Et()||this.Ki.Gi()||se===null)return;const ae=this.Ki.Zi().J(re.labelBackgroundColor);ne.tt=ae.tt,te.R=ae.it;const le=2/12*this.Ki.P();ne.Bi=le,ne.Vi=le;const ce=this.Xi(this.Ki);ne.Ai=ce.Ai,te.li=this.Ki.Ji(ce.xt,se),te.Et=!0}}const $=/[1-9]/g;class q{constructor(){this.Xt=null}_t(te){this.Xt=te}ht(te,ee){if(this.Xt===null||this.Xt.Et===!1||this.Xt.li.length===0)return;const ne=te.useMediaCoordinateSpace(({context:pe})=>(pe.font=ee.k,Math.round(ee.Qi.measureText(pe,u$1(this.Xt).li,$))));if(ne<=0)return;const re=ee.ts,se=ne+2*re,ae=se/2,le=this.Xt.ss;let ce=this.Xt.Ai,he=Math.floor(ce-ae)+.5;he<0?(ce+=Math.abs(0-he),he=Math.floor(ce-ae)+.5):he+se>le&&(ce-=Math.abs(le-(he+se)),he=Math.floor(ce-ae)+.5);const fe=he+se,Ae=Math.ceil(0+ee.S+ee.C+ee.L+ee.P+ee.B);te.useBitmapCoordinateSpace(({context:pe,horizontalPixelRatio:Oe,verticalPixelRatio:Fe})=>{const Ne=u$1(this.Xt);pe.fillStyle=Ne.tt;const ze=Math.round(he*Oe),He=Math.round(0*Fe),We=Math.round(fe*Oe),je=Math.round(Ae*Fe),Ue=Math.round(2*Oe);if(pe.beginPath(),pe.moveTo(ze,He),pe.lineTo(ze,je-Ue),pe.arcTo(ze,je,ze+Ue,je,Ue),pe.lineTo(We-Ue,je),pe.arcTo(We,je,We,je-Ue,Ue),pe.lineTo(We,He),pe.fill(),Ne.gi){const Ge=Math.round(Ne.Ai*Oe),Ze=He,Ye=Math.round((Ze+ee.C)*Fe);pe.fillStyle=Ne.R;const qe=Math.max(1,Math.floor(Oe)),nr=Math.floor(.5*Oe);pe.fillRect(Ge-nr,Ze,qe,Ye-Ze)}}),te.useMediaCoordinateSpace(({context:pe})=>{const Oe=u$1(this.Xt),Fe=0+ee.S+ee.C+ee.L+ee.P/2;pe.font=ee.k,pe.textAlign="left",pe.textBaseline="middle",pe.fillStyle=Oe.R;const Ne=ee.Qi.yMidCorrection(pe,"Apr0");pe.translate(he+re,Fe+Ne),pe.fillText(Oe.li,0,0)})}}class Y{constructor(te,ee,ne){this.yt=!0,this.ti=new q,this.Qt={Et:!1,tt:"#4c525e",R:"white",li:"",ss:0,Ai:NaN,gi:!0},this.kt=te,this.ns=ee,this.Xi=ne}Rt(){this.yt=!0}It(){return this.yt&&(this.Bt(),this.yt=!1),this.ti._t(this.Qt),this.ti}Bt(){const te=this.Qt;if(te.Et=!1,this.kt.W().mode===2)return;const ee=this.kt.W().vertLine;if(!ee.labelVisible)return;const ne=this.ns.Lt();if(ne.Gi())return;te.ss=ne.ss();const re=this.Xi();if(re===null)return;te.Ai=re.Ai;const se=ne.es(this.kt.zt());te.li=ne.rs(u$1(se)),te.Et=!0;const ae=this.ns.Zi().J(ee.labelBackgroundColor);te.tt=ae.tt,te.R=ae.it,te.gi=ne.W().ticksVisible}}class j{constructor(){this.hs=null,this.ls=0}_s(){return this.ls}us(te){this.ls=te}Ut(){return this.hs}cs(te){this.hs=te}ds(te){return[]}fs(){return[]}Et(){return!0}}var K;(function(ie){ie[ie.Normal=0]="Normal",ie[ie.Magnet=1]="Magnet",ie[ie.Hidden=2]="Hidden",ie[ie.MagnetOHLC=3]="MagnetOHLC",ie[ie.MagnetOHLCWeak=4]="MagnetOHLCWeak"})(K||(K={}));class X extends j{constructor(te,ee){super(),this.Tt=null,this.ps=NaN,this.vs=0,this.ws=!1,this.Ms=new Map,this.gs=!1,this.bs=new WeakMap,this.xs=new WeakMap,this.Ss=NaN,this.Cs=NaN,this.Ps=NaN,this.ys=NaN,this.ns=te,this.ks=ee,this.Ts=((re,se)=>ae=>{const le=se(),ce=re();if(ae===u$1(this.Tt).Rs())return{xt:ce,Ai:le};{const he=u$1(ae.Nt());return{xt:ae.Ds(le,he),Ai:le}}})(()=>this.ps,()=>this.Cs);const ne=((re,se)=>()=>{const ae=this.ns.Lt().Is(re()),le=se();return ae&&Number.isFinite(le)?{bt:ae,Ai:le}:null})(()=>this.vs,()=>this.ri());this.Bs=new Y(this,te,ne)}W(){return this.ks}Vs(te,ee){this.Ps=te,this.ys=ee}Es(){this.Ps=NaN,this.ys=NaN}As(){return this.Ps}zs(){return this.ys}Ls(te,ee,ne){this.gs||(this.gs=!0),this.ws=!0,this.Os(te,ee,ne)}Ns(){return{x:this.Ss,y:this.Cs}}Ws(){return this.Tt}zt(){return this.vs}ri(){return this.Ss}hi(){return this.Cs}Et(){return this.ws}Fs(){this.ws=!1,this.Hs(),this.ps=NaN,this.Ss=NaN,this.Cs=NaN,this.Tt=null,this.Es(),this.Us()}$s(te){let ee=this.bs.get(te);ee||(ee=new A$1(this,te),this.bs.set(te,ee));let ne=this.xs.get(te);return ne||(ne=new V(this.ns,this,te),this.xs.set(te,ne)),[ee,ne]}ni(te){return te===this.Tt&&this.ks.horzLine.visible}ei(){return this.ks.vertLine.visible}qs(te,ee){this.ws&&this.Tt===te||this.Ms.clear();const ne=[];return this.Tt===te&&ne.push(this.Ys(this.Ms,ee,this.Ts)),ne}fs(){return this.ws?[this.Bs]:[]}js(){return this.Tt}Us(){this.ns.Ks().forEach(te=>{var ee,ne;(ee=this.bs.get(te))==null||ee.Rt(),(ne=this.xs.get(te))==null||ne.Rt()}),this.Ms.forEach(te=>te.Rt()),this.Bs.Rt()}Xs(te){return te&&!te.Rs().Gi()?te.Rs():null}Os(te,ee,ne){this.Gs(te,ee,ne)&&this.Us()}Gs(te,ee,ne){const re=this.Ss,se=this.Cs,ae=this.ps,le=this.vs,ce=this.Tt,he=this.Xs(ne);this.vs=te,this.Ss=isNaN(te)?NaN:this.ns.Lt().Kt(te),this.Tt=ne;const fe=he!==null?he.Nt():null;return he!==null&&fe!==null?(this.ps=ee,this.Cs=he.Ht(ee,fe)):(this.ps=NaN,this.Cs=NaN),re!==this.Ss||se!==this.Cs||le!==this.vs||ae!==this.ps||ce!==this.Tt}Hs(){const te=this.ns.Zs().map(ne=>ne.Qs().Js()).filter(g),ee=te.length===0?null:Math.max(...te);this.vs=ee!==null?ee:NaN}Ys(te,ee,ne){let re=te.get(ee);return re===void 0&&(re=new U(this,ee,ne),te.set(ee,re)),re}}function G(ie){return ie==="left"||ie==="right"}class Z{constructor(te){this.tn=new Map,this.sn=[],this.nn=te}en(te,ee){const ne=function(re,se){return re===void 0?se:{rn:Math.max(re.rn,se.rn),hn:re.hn||se.hn}}(this.tn.get(te),ee);this.tn.set(te,ne)}an(){return this.nn}ln(te){const ee=this.tn.get(te);return ee===void 0?{rn:this.nn}:{rn:Math.max(this.nn,ee.rn),hn:ee.hn}}_n(){this.un(),this.sn=[{cn:0}]}dn(te){this.un(),this.sn=[{cn:1,$t:te}]}fn(te){this.pn(),this.sn.push({cn:5,$t:te})}un(){this.pn(),this.sn.push({cn:6})}vn(){this.un(),this.sn=[{cn:4}]}mn(te){this.un(),this.sn.push({cn:2,$t:te})}wn(te){this.un(),this.sn.push({cn:3,$t:te})}Mn(){return this.sn}gn(te){for(const ee of te.sn)this.bn(ee);this.nn=Math.max(this.nn,te.nn),te.tn.forEach((ee,ne)=>{this.en(ne,ee)})}static xn(){return new Z(2)}static Sn(){return new Z(3)}bn(te){switch(te.cn){case 0:this._n();break;case 1:this.dn(te.$t);break;case 2:this.mn(te.$t);break;case 3:this.wn(te.$t);break;case 4:this.vn();break;case 5:this.fn(te.$t);break;case 6:this.pn()}}pn(){const te=this.sn.findIndex(ee=>ee.cn===5);te!==-1&&this.sn.splice(te,1)}}const J=".";function Q(ie,te){if(!p(ie))return"n/a";if(!v(te))throw new TypeError("invalid length");if(te<0||te>16)throw new TypeError("invalid length");return te===0?ie.toString():("0000000000000000"+ie.toString()).slice(-te)}class tt{constructor(te,ee){if(ee||(ee=1),p(te)&&v(te)||(te=100),te<0)throw new TypeError("invalid base");this.Ki=te,this.Cn=ee,this.Pn()}format(te){const ee=te<0?"−":"";return te=Math.abs(te),ee+this.yn(te)}Pn(){if(this._fractionalLength=0,this.Ki>0&&this.Cn>0){let te=this.Ki;for(;te>1;)te/=10,this._fractionalLength++}}yn(te){const ee=this.Ki/this.Cn;let ne=Math.floor(te),re="";const se=this._fractionalLength!==void 0?this._fractionalLength:NaN;if(ee>1){let ae=+(Math.round(te*ee)-ne*ee).toFixed(this._fractionalLength);ae>=ee&&(ae-=ee,ne+=1),re=J+Q(+ae.toFixed(this._fractionalLength)*this.Cn,se)}else ne=Math.round(ne*ee)/ee,se>0&&(re=J+Q(0,se));return ne.toFixed(0)+re}}class it extends tt{constructor(te=100){super(te)}format(te){return`${super.format(te)}%`}}class st{constructor(te){this.kn=te}format(te){let ee="";return te<0&&(ee="-",te=-te),te<995?ee+this.Tn(te):te<999995?ee+this.Tn(te/1e3)+"K":te<999999995?(te=1e3*Math.round(te/1e3),ee+this.Tn(te/1e6)+"M"):(te=1e6*Math.round(te/1e6),ee+this.Tn(te/1e9)+"B")}Tn(te){let ee;const ne=Math.pow(10,this.kn);return ee=(te=Math.round(te*ne)/ne)>=1e-15&&te<1?te.toFixed(this.kn).replace(/\.?0+$/,""):String(te),ee.replace(/(\.[1-9]*)0+$/,(re,se)=>se)}}const nt=/[2-9]/g;class et{constructor(te=50){this.Rn=0,this.Dn=1,this.In=1,this.Bn={},this.Vn=new Map,this.En=te}reset(){this.Rn=0,this.Vn.clear(),this.Dn=1,this.In=1,this.Bn={}}measureText(te,ee,ne){return this.getMetrics(te,ee,ne).width}yMidCorrection(te,ee,ne){const re=this.getMetrics(te,ee,ne);return((re.actualBoundingBoxAscent||0)-(re.actualBoundingBoxDescent||0))/2}getMetrics(te,ee,ne){const re=ne||nt,se=String(ee).replace(re,"0");if(this.Vn.has(se))return _(this.Vn.get(se)).An;if(this.Rn===this.En){const le=this.Bn[this.In];delete this.Bn[this.In],this.Vn.delete(le),this.In++,this.Rn--}te.save(),te.textBaseline="middle";const ae=te.measureText(se);return te.restore(),ae.width===0&&ee.length||(this.Vn.set(se,{An:ae,zn:this.Dn}),this.Bn[this.Dn]=se,this.Rn++,this.Dn++),ae}}class rt{constructor(te){this.Ln=null,this.M=null,this.On="right",this.Nn=te}Wn(te,ee,ne){this.Ln=te,this.M=ee,this.On=ne}ht(te){this.M!==null&&this.Ln!==null&&this.Ln.ht(te,this.M,this.Nn,this.On)}}class ht{constructor(te,ee,ne){this.Fn=te,this.Nn=new et(50),this.Hn=ee,this.N=ne,this.F=-1,this.ti=new rt(this.Nn)}It(){const te=this.N.Un(this.Hn);if(te===null)return null;const ee=te.$n(this.Hn)?te.qn():this.Hn.Ut();if(ee===null)return null;const ne=te.Yn(ee);if(ne==="overlay")return null;const re=this.N.jn();return re.P!==this.F&&(this.F=re.P,this.Nn.reset()),this.ti.Wn(this.Fn.Yi(),re,ne),this.ti}}class at extends R{constructor(){super(...arguments),this.Xt=null}_t(te){this.Xt=te}Kn(te,ee){var ae;if(!((ae=this.Xt)!=null&&ae.Et))return null;const{ft:ne,vt:re,Xn:se}=this.Xt;return ee>=ne-re-7&&ee<=ne+re+7?{hitTestData:this.Xt,externalId:se}:null}lt({context:te,bitmapSize:ee,horizontalPixelRatio:ne,verticalPixelRatio:re}){if(this.Xt===null||this.Xt.Et===!1)return;const se=Math.round(this.Xt.ft*re);se<0||se>ee.height||(te.lineCap="butt",te.strokeStyle=this.Xt.R,te.lineWidth=Math.floor(this.Xt.vt*ne),a$1(te,this.Xt.Jt),l$1(te,se,0,ee.width))}}class lt{constructor(te){this.Gn={ft:0,R:"rgba(0, 0, 0, 0)",vt:1,Jt:0,Et:!1},this.Zn=new at,this.yt=!0,this.Jn=te,this.Qn=te.si(),this.Zn._t(this.Gn)}Rt(){this.yt=!0}It(){return this.Jn.Et()?(this.yt&&(this.te(),this.yt=!1),this.Zn):null}}class ot extends lt{constructor(te){super(te)}te(){this.Gn.Et=!1;const te=this.Jn.Ut(),ee=te.ie().ie;if(ee!==2&&ee!==3)return;const ne=this.Jn.W();if(!ne.baseLineVisible||!this.Jn.Et())return;const re=this.Jn.Nt();re!==null&&(this.Gn.Et=!0,this.Gn.ft=te.Ht(re.$t,re.$t),this.Gn.R=ne.baseLineColor,this.Gn.vt=ne.baseLineWidth,this.Gn.Jt=ne.baseLineStyle)}}class _t extends R{constructor(){super(...arguments),this.Xt=null}_t(te){this.Xt=te}se(){return this.Xt}lt({context:te,horizontalPixelRatio:ee,verticalPixelRatio:ne}){const re=this.Xt;if(re===null)return;const se=Math.max(1,Math.floor(ee)),ae=se%2/2,le=Math.round(re.ne.x*ee)+ae,ce=re.ne.y*ne;te.fillStyle=re.ee,te.beginPath();const he=Math.max(2,1.5*re.re)*ee;te.arc(le,ce,he,0,2*Math.PI,!1),te.fill(),te.fillStyle=re.he,te.beginPath(),te.arc(le,ce,re.Mt*ee,0,2*Math.PI,!1),te.fill(),te.lineWidth=se,te.strokeStyle=re.ae,te.beginPath(),te.arc(le,ce,re.Mt*ee+se/2,0,2*Math.PI,!1),te.stroke()}}const ut=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class ct{constructor(te){this.ti=new _t,this.yt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.Me=te}ge(){this.we=this.me-1,this.Rt()}be(){if(this.Rt(),this.Me.W().lastPriceAnimation===2){const te=performance.now(),ee=this.we-te;if(ee>0)return void(ee<650&&(this.we+=2600));this.me=te,this.we=te+2600}}Rt(){this.yt=!0}xe(){this.ve=!0}Et(){return this.Me.W().lastPriceAnimation!==0}Se(){switch(this.Me.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}It(){return this.yt?(this.Bt(),this.yt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.ti}Bt(){this.ti._t(null);const te=this.Me.si().Lt(),ee=te.Pe(),ne=this.Me.Nt();if(ee===null||ne===null)return;const re=this.Me.ye(!0);if(re.ke||!ee.Te(re.Re))return;const se={x:te.Kt(re.Re),y:this.Me.Ut().Ht(re.xt,ne.$t)},ae=re.R,le=this.Me.W().lineWidth,ce=this.De(this.Ie(),ae);this.ti._t({ee:ae,re:le,he:ce.he,ae:ce.ae,Mt:ce.Mt,ne:se})}Ce(){const te=this.ti.se();if(te!==null){const ee=this.De(this.Ie(),te.ee);te.he=ee.he,te.ae=ee.ae,te.Mt=ee.Mt}}Ie(){return this.Se()?performance.now()-this.me:2599}Be(te,ee,ne,re){const se=ne+(re-ne)*ee;return this.Me.si().Zi().G(te,se)}De(te,ee){const ne=te%2600/2600;let re;for(const he of ut)if(ne>=he.le&&ne<=he.oe){re=he;break}o$1(re!==void 0,"Last price animation internal logic error");const se=(ne-re.le)/(re.oe-re.le);return{he:this.Be(ee,se,re.ce,re.de),ae:this.Be(ee,se,re.fe,re.pe),Mt:(ae=se,le=re._e,ce=re.ue,le+(ce-le)*ae)};var ae,le,ce}}class dt extends lt{constructor(te){super(te)}te(){const te=this.Gn;te.Et=!1;const ee=this.Jn.W();if(!ee.priceLineVisible||!this.Jn.Et())return;const ne=this.Jn.ye(ee.priceLineSource===0);ne.ke||(te.Et=!0,te.ft=ne.Ai,te.R=this.Jn.Ve(ne.R),te.vt=ee.priceLineWidth,te.Jt=ee.priceLineStyle)}}class ft extends H{constructor(te){super(),this.ii=te}ji(te,ee,ne){te.Et=!1,ee.Et=!1;const re=this.ii;if(!re.Et())return;const se=re.W(),ae=se.lastValueVisible,le=re.Ee()!=="",ce=se.seriesLastValueMode===0,he=re.ye(!1);if(he.ke)return;ae&&(te.li=this.Ae(he,ae,ce),te.Et=te.li.length!==0),(le||ce)&&(ee.li=this.ze(he,ae,le,ce),ee.Et=ee.li.length>0);const fe=re.Ve(he.R),Ae=this.ii.si().Zi().J(fe);ne.tt=Ae.tt,ne.Ai=he.Ai,ee.qt=re.si().Yt(he.Ai/re.Ut().jt()),te.qt=fe,te.R=Ae.it,ee.R=Ae.it}ze(te,ee,ne,re){let se="";const ae=this.ii.Ee();return ne&&ae.length!==0&&(se+=`${ae} `),ee&&re&&(se+=this.ii.Ut().Le()?te.Oe:te.Ne),se.trim()}Ae(te,ee,ne){return ee?ne?this.ii.Ut().Le()?te.Ne:te.Oe:te.li:""}}function pt(ie,te,ee,ne){const re=Number.isFinite(te),se=Number.isFinite(ee);return re&&se?ie(te,ee):re||se?re?te:ee:ne}class vt{constructor(te,ee){this.We=te,this.Fe=ee}He(te){return te!==null&&this.We===te.We&&this.Fe===te.Fe}Ue(){return new vt(this.We,this.Fe)}$e(){return this.We}qe(){return this.Fe}Ye(){return this.Fe-this.We}Gi(){return this.Fe===this.We||Number.isNaN(this.Fe)||Number.isNaN(this.We)}gn(te){return te===null?this:new vt(pt(Math.min,this.$e(),te.$e(),-1/0),pt(Math.max,this.qe(),te.qe(),1/0))}je(te){if(!p(te)||this.Fe-this.We===0)return;const ee=.5*(this.Fe+this.We);let ne=this.Fe-ee,re=this.We-ee;ne*=te,re*=te,this.Fe=ee+ne,this.We=ee+re}Ke(te){p(te)&&(this.Fe+=te,this.We+=te)}Xe(){return{minValue:this.We,maxValue:this.Fe}}static Ge(te){return te===null?null:new vt(te.minValue,te.maxValue)}}class mt{constructor(te,ee){this.Ze=te,this.Je=ee||null}Qe(){return this.Ze}tr(){return this.Je}Xe(){return{priceRange:this.Ze===null?null:this.Ze.Xe(),margins:this.Je||void 0}}static Ge(te){return te===null?null:new mt(vt.Ge(te.priceRange),te.margins)}}class wt extends lt{constructor(te,ee){super(te),this.ir=ee}te(){const te=this.Gn;te.Et=!1;const ee=this.ir.W();if(!this.Jn.Et()||!ee.lineVisible)return;const ne=this.ir.sr();ne!==null&&(te.Et=!0,te.ft=ne,te.R=ee.color,te.vt=ee.lineWidth,te.Jt=ee.lineStyle,te.Xn=this.ir.W().id)}}class Mt extends H{constructor(te,ee){super(),this.Me=te,this.ir=ee}ji(te,ee,ne){te.Et=!1,ee.Et=!1;const re=this.ir.W(),se=re.axisLabelVisible,ae=re.title!=="",le=this.Me;if(!se||!le.Et())return;const ce=this.ir.sr();if(ce===null)return;ae&&(ee.li=re.title,ee.Et=!0),ee.qt=le.si().Yt(ce/le.Ut().jt()),te.li=this.nr(re.price),te.Et=!0;const he=this.Me.si().Zi().J(re.axisLabelColor||re.color);ne.tt=he.tt;const fe=re.axisLabelTextColor||he.it;te.R=fe,ee.R=fe,ne.Ai=ce}nr(te){const ee=this.Me.Nt();return ee===null?"":this.Me.Ut().Ji(te,ee.$t)}}class gt{constructor(te,ee){this.Me=te,this.ks=ee,this.er=new wt(te,this),this.Fn=new Mt(te,this),this.rr=new ht(this.Fn,te,te.si())}hr(te){f(this.ks,te),this.Rt(),this.Me.si().ar()}W(){return this.ks}lr(){return this.er}_r(){return this.rr}ur(){return this.Fn}Rt(){this.er.Rt(),this.Fn.Rt()}sr(){const te=this.Me,ee=te.Ut();if(te.si().Lt().Gi()||ee.Gi())return null;const ne=te.Nt();return ne===null?null:ee.Ht(this.ks.price,ne.$t)}}class bt extends j{constructor(te){super(),this.ns=te}si(){return this.ns}}const xt={Bar:(ie,te,ee,ne)=>{const re=te.upColor,se=te.downColor,ae=u$1(ie(ee,ne)),le=c(ae.$t[0])<=c(ae.$t[3]);return{cr:ae.R??(le?re:se)}},Candlestick:(ie,te,ee,ne)=>{const re=te.upColor,se=te.downColor,ae=te.borderUpColor,le=te.borderDownColor,ce=te.wickUpColor,he=te.wickDownColor,fe=u$1(ie(ee,ne)),Ae=c(fe.$t[0])<=c(fe.$t[3]);return{cr:fe.R??(Ae?re:se),dr:fe.qt??(Ae?ae:le),pr:fe.vr??(Ae?ce:he)}},HollowCandlestick:(ie,te,ee,ne)=>{const re=te.upColor,se=te.downColor,ae=te.borderUpColor,le=te.borderDownColor,ce=te.wickUpColor,he=te.wickDownColor,fe=u$1(ie(ee,ne)),Ae=ie(ee-1),pe=c(fe.$t[0]),Oe=Ae?c(Ae.$t[3]):pe,Fe=c(fe.$t[3]),Ne=Oe<=Fe,ze=Fe<pe;return{cr:fe.R??(Ne?re:se),dr:fe.qt??(Ne?ae:le),pr:fe.vr??(Ne?ce:he),mr:ze}},Custom:(ie,te,ee,ne)=>({cr:u$1(ie(ee,ne)).R??te.color}),Area:(ie,te,ee,ne)=>{const re=u$1(ie(ee,ne));return{cr:re.gt??te.lineColor,gt:re.gt??te.lineColor,wr:re.wr??te.topColor,Mr:re.Mr??te.bottomColor}},Baseline:(ie,te,ee,ne)=>{const re=u$1(ie(ee,ne));return{cr:re.$t[3]>=te.baseValue.price?te.topLineColor:te.bottomLineColor,gr:re.gr??te.topLineColor,br:re.br??te.bottomLineColor,Sr:re.Sr??te.topFillColor1,Cr:re.Cr??te.topFillColor2,Pr:re.Pr??te.bottomFillColor1,yr:re.yr??te.bottomFillColor2}},Line:(ie,te,ee,ne)=>{const re=u$1(ie(ee,ne));return{cr:re.R??te.color,gt:re.R??te.color}},Histogram:(ie,te,ee,ne)=>({cr:u$1(ie(ee,ne)).R??te.color})};class St{constructor(te){this.kr=(ee,ne)=>ne!==void 0?ne.$t:this.Me.Qs().Tr(ee),this.Me=te,this.Rr=xt[te.Dr()]}Ir(te,ee){return this.Rr(this.kr,this.Me.W(),te,ee)}}function Ct(ie,te,ee,ne,re=0,se=te.length){let ae=se-re;for(;0<ae;){const le=ae>>1,ce=re+le;ne(te[ce],ee)===ie?(re=ce+1,ae-=le+1):ae=le}return re}const Pt=Ct.bind(null,!0),yt=Ct.bind(null,!1);var kt;(function(ie){ie[ie.NearestLeft=-1]="NearestLeft",ie[ie.None=0]="None",ie[ie.NearestRight=1]="NearestRight"})(kt||(kt={}));const Tt=30;class Rt{constructor(){this.Br=[],this.Vr=new Map,this.Er=new Map,this.Ar=[]}zr(){return this.Lr()>0?this.Br[this.Br.length-1]:null}Or(){return this.Lr()>0?this.Nr(0):null}Js(){return this.Lr()>0?this.Nr(this.Br.length-1):null}Lr(){return this.Br.length}Gi(){return this.Lr()===0}Te(te){return this.Wr(te,0)!==null}Tr(te){return this.Fr(te)}Fr(te,ee=0){const ne=this.Wr(te,ee);return ne===null?null:{...this.Hr(ne),Re:this.Nr(ne)}}Ur(){return this.Br}$r(te,ee,ne){if(this.Gi())return null;let re=null;for(const se of ne)re=Dt(re,this.qr(te,ee,se));return re}_t(te){this.Er.clear(),this.Vr.clear(),this.Br=te,this.Ar=te.map(ee=>ee.Re)}Yr(){return this.Ar}Nr(te){return this.Br[te].Re}Hr(te){return this.Br[te]}Wr(te,ee){const ne=this.jr(te);if(ne===null&&ee!==0)switch(ee){case-1:return this.Kr(te);case 1:return this.Xr(te);default:throw new TypeError("Unknown search mode")}return ne}Kr(te){let ee=this.Gr(te);return ee>0&&(ee-=1),ee!==this.Br.length&&this.Nr(ee)<te?ee:null}Xr(te){const ee=this.Zr(te);return ee!==this.Br.length&&te<this.Nr(ee)?ee:null}jr(te){const ee=this.Gr(te);return ee===this.Br.length||te<this.Br[ee].Re?null:ee}Gr(te){return Pt(this.Br,te,(ee,ne)=>ee.Re<ne)}Zr(te){return yt(this.Br,te,(ee,ne)=>ee.Re>ne)}Jr(te,ee,ne){let re=null;for(let se=te;se<ee;se++){const ae=this.Br[se].$t[ne];Number.isNaN(ae)||(re===null?re={Qr:ae,th:ae}:(ae<re.Qr&&(re.Qr=ae),ae>re.th&&(re.th=ae)))}return re}qr(te,ee,ne){if(this.Gi())return null;let re=null;const se=u$1(this.Or()),ae=u$1(this.Js()),le=Math.max(te,se),ce=Math.min(ee,ae),he=Math.ceil(le/Tt)*Tt,fe=Math.max(he,Math.floor(ce/Tt)*Tt);{const pe=this.Gr(le),Oe=this.Zr(Math.min(ce,he,ee));re=Dt(re,this.Jr(pe,Oe,ne))}let Ae=this.Vr.get(ne);Ae===void 0&&(Ae=new Map,this.Vr.set(ne,Ae));for(let pe=Math.max(he+1,le);pe<fe;pe+=Tt){const Oe=Math.floor(pe/Tt);let Fe=Ae.get(Oe);if(Fe===void 0){const Ne=this.Gr(Oe*Tt),ze=this.Zr((Oe+1)*Tt-1);Fe=this.Jr(Ne,ze,ne),Ae.set(Oe,Fe)}re=Dt(re,Fe)}{const pe=this.Gr(fe),Oe=this.Zr(ce);re=Dt(re,this.Jr(pe,Oe,ne))}return re}}function Dt(ie,te){return ie===null?te:te===null?ie:{Qr:Math.min(ie.Qr,te.Qr),th:Math.max(ie.th,te.th)}}class It{constructor(te){this.ih=te}ht(te,ee,ne){this.ih.draw(te)}sh(te,ee,ne){var re,se;(se=(re=this.ih).drawBackground)==null||se.call(re,te)}}class Bt{constructor(te){this.Vn=null,this.nh=te}It(){var ne;const te=this.nh.renderer();if(te===null)return null;if(((ne=this.Vn)==null?void 0:ne.eh)===te)return this.Vn.rh;const ee=new It(te);return this.Vn={eh:te,rh:ee},ee}hh(){var te,ee;return((ee=(te=this.nh).zOrder)==null?void 0:ee.call(te))??"normal"}}class Vt{constructor(te){this.ah=null,this.oh=te}_h(){return this.oh}Us(){var te,ee;(ee=(te=this.oh).updateAllViews)==null||ee.call(te)}$s(){var ne,re,se;const te=((re=(ne=this.oh).paneViews)==null?void 0:re.call(ne))??[];if(((se=this.ah)==null?void 0:se.eh)===te)return this.ah.rh;const ee=te.map(ae=>new Bt(ae));return this.ah={eh:te,rh:ee},ee}Kn(te,ee){var ne,re;return((re=(ne=this.oh).hitTest)==null?void 0:re.call(ne,te,ee))??null}}let Et=class extends Vt{ds(){return[]}};class At{constructor(te){this.ih=te}ht(te,ee,ne){this.ih.draw(te)}sh(te,ee,ne){var re,se;(se=(re=this.ih).drawBackground)==null||se.call(re,te)}}class zt{constructor(te){this.Vn=null,this.nh=te}It(){var ne;const te=this.nh.renderer();if(te===null)return null;if(((ne=this.Vn)==null?void 0:ne.eh)===te)return this.Vn.rh;const ee=new At(te);return this.Vn={eh:te,rh:ee},ee}hh(){var te,ee;return((ee=(te=this.nh).zOrder)==null?void 0:ee.call(te))??"normal"}}function Lt(ie){var te,ee,ne,re;return{li:ie.text(),Ai:ie.coordinate(),Ei:(te=ie.fixedCoordinate)==null?void 0:te.call(ie),R:ie.textColor(),tt:ie.backColor(),uh:(ee=ie.borderColor)==null?void 0:ee.call(ie),Et:((ne=ie.visible)==null?void 0:ne.call(ie))??!0,gi:((re=ie.tickVisible)==null?void 0:re.call(ie))??!0}}class Ot{constructor(te,ee){this.ti=new q,this.dh=te,this.fh=ee}It(){return this.ti._t({ss:this.fh.ss(),...Lt(this.dh)}),this.ti}}class Nt extends H{constructor(te,ee){super(),this.dh=te,this.Ki=ee}ji(te,ee,ne){const re=Lt(this.dh);ne.tt=re.tt,te.R=re.R,te.oi=re.uh;const se=2/12*this.Ki.P();ne.Bi=se,ne.Vi=se,ne.Ai=re.Ai,ne.Ei=re.Ei,te.li=re.li,te.Et=re.Et,te.gi=re.gi}}class Wt extends Vt{constructor(te,ee){super(te),this.ph=null,this.mh=null,this.wh=null,this.Mh=null,this.Me=ee}fs(){var re,se,ae;const te=((se=(re=this.oh).timeAxisViews)==null?void 0:se.call(re))??[];if(((ae=this.ph)==null?void 0:ae.eh)===te)return this.ph.rh;const ee=this.Me.si().Lt(),ne=te.map(le=>new Ot(le,ee));return this.ph={eh:te,rh:ne},ne}qs(){var re,se,ae;const te=((se=(re=this.oh).priceAxisViews)==null?void 0:se.call(re))??[];if(((ae=this.mh)==null?void 0:ae.eh)===te)return this.mh.rh;const ee=this.Me.Ut(),ne=te.map(le=>new Nt(le,ee));return this.mh={eh:te,rh:ne},ne}gh(){var ne,re,se;const te=((re=(ne=this.oh).priceAxisPaneViews)==null?void 0:re.call(ne))??[];if(((se=this.wh)==null?void 0:se.eh)===te)return this.wh.rh;const ee=te.map(ae=>new zt(ae));return this.wh={eh:te,rh:ee},ee}bh(){var ne,re,se;const te=((re=(ne=this.oh).timeAxisPaneViews)==null?void 0:re.call(ne))??[];if(((se=this.Mh)==null?void 0:se.eh)===te)return this.Mh.rh;const ee=te.map(ae=>new zt(ae));return this.Mh={eh:te,rh:ee},ee}xh(te,ee){var ne,re;return((re=(ne=this.oh).autoscaleInfo)==null?void 0:re.call(ne,te,ee))??null}}function Ft(ie,te,ee,ne){ie.forEach(re=>{te(re).forEach(se=>{se.hh()===ee&&ne.push(se)})})}function Ht(ie){return ie.$s()}function Ut(ie){return ie.gh()}function $t(ie){return ie.bh()}const qt=["Area","Line","Baseline"];class Yt extends bt{constructor(te,ee,ne,re,se){super(te),this.Xt=new Rt,this.er=new dt(this),this.Sh=[],this.Ch=new ot(this),this.Ph=null,this.yh=null,this.kh=null,this.Th=[],this.ks=ne,this.Rh=ee;const ae=new ft(this);this.Ms=[ae],this.rr=new ht(ae,this,te),qt.includes(this.Rh)&&(this.Ph=new ct(this)),this.Dh(),this.nh=re(this,this.si(),se)}m(){this.kh!==null&&clearTimeout(this.kh)}Ve(te){return this.ks.priceLineColor||te}ye(te){const ee={ke:!0},ne=this.Ut();if(this.si().Lt().Gi()||ne.Gi()||this.Xt.Gi())return ee;const re=this.si().Lt().Pe(),se=this.Nt();if(re===null||se===null)return ee;let ae,le;if(te){const Ae=this.Xt.zr();if(Ae===null)return ee;ae=Ae,le=Ae.Re}else{const Ae=this.Xt.Fr(re.Pi(),-1);if(Ae===null||(ae=this.Xt.Tr(Ae.Re),ae===null))return ee;le=Ae.Re}const ce=ae.$t[3],he=this.Ih().Ir(le,{$t:ae}),fe=ne.Ht(ce,se.$t);return{ke:!1,xt:ce,li:ne.Ji(ce,se.$t),Oe:ne.Bh(ce),Ne:ne.Vh(ce,se.$t),R:he.cr,Ai:fe,Re:le}}Ih(){return this.yh!==null||(this.yh=new St(this)),this.yh}W(){return this.ks}hr(te){const ee=te.priceScaleId;ee!==void 0&&ee!==this.ks.priceScaleId&&this.si().Eh(this,ee),f(this.ks,te),te.priceFormat!==void 0&&(this.Dh(),this.si().Ah()),this.si().zh(this),this.si().Lh(),this.nh.Rt("options")}_t(te,ee){this.Xt._t(te),this.nh.Rt("data"),this.Ph!==null&&(ee&&ee.Oh?this.Ph.be():te.length===0&&this.Ph.ge());const ne=this.si().Un(this);this.si().Nh(ne),this.si().zh(this),this.si().Lh(),this.si().ar()}Wh(te){const ee=new gt(this,te);return this.Sh.push(ee),this.si().zh(this),ee}Fh(te){const ee=this.Sh.indexOf(te);ee!==-1&&this.Sh.splice(ee,1),this.si().zh(this)}Hh(){return this.Sh}Dr(){return this.Rh}Nt(){const te=this.Uh();return te===null?null:{$t:te.$t[3],$h:te.bt}}Uh(){const te=this.si().Lt().Pe();if(te===null)return null;const ee=te.qh();return this.Xt.Fr(ee,1)}Qs(){return this.Xt}Yh(te){const ee=this.Xt.Tr(te);return ee===null?null:this.Rh==="Bar"||this.Rh==="Candlestick"||this.Rh==="Custom"?{jh:ee.$t[0],Kh:ee.$t[1],Xh:ee.$t[2],Gh:ee.$t[3]}:ee.$t[3]}Zh(te){const ee=[];Ft(this.Th,Ht,"top",ee);const ne=this.Ph;return ne!==null&&ne.Et()&&(this.kh===null&&ne.Se()&&(this.kh=setTimeout(()=>{this.kh=null,this.si().Jh()},0)),ne.xe(),ee.unshift(ne)),ee}$s(){const te=[];this.Qh()||te.push(this.Ch),te.push(this.nh,this.er);const ee=this.Sh.map(ne=>ne.lr());return te.push(...ee),Ft(this.Th,Ht,"normal",te),te}ta(){return this.ia(Ht,"bottom")}sa(){return this.ia(Ht,"under")}na(te){return this.ia(Ut,te)}ea(te){return this.ia($t,te)}ra(te,ee){return this.Th.map(ne=>ne.Kn(te,ee)).filter(ne=>ne!==null)}ds(){return[this.rr,...this.Sh.map(te=>te._r())]}qs(te,ee){if(ee!==this.hs&&!this.Qh())return[];const ne=[...this.Ms];for(const re of this.Sh)ne.push(re.ur());return this.Th.forEach(re=>{ne.push(...re.qs())}),ne}fs(){const te=[];return this.Th.forEach(ee=>{te.push(...ee.fs())}),te}xh(te,ee){if(this.ks.autoscaleInfoProvider!==void 0){const ne=this.ks.autoscaleInfoProvider(()=>{const re=this.ha(te,ee);return re===null?null:re.Xe()});return mt.Ge(ne)}return this.ha(te,ee)}aa(){return this.ks.priceFormat.minMove}la(){return this.oa}Us(){var te;this.nh.Rt();for(const ee of this.Ms)ee.Rt();for(const ee of this.Sh)ee.Rt();this.er.Rt(),this.Ch.Rt(),(te=this.Ph)==null||te.Rt(),this.Th.forEach(ee=>ee.Us())}Ut(){return u$1(super.Ut())}Ot(te){if(!((this.Rh==="Line"||this.Rh==="Area"||this.Rh==="Baseline")&&this.ks.crosshairMarkerVisible))return null;const ee=this.Xt.Tr(te);return ee===null?null:{xt:ee.$t[3],Mt:this._a(),qt:this.ua(),Ft:this.ca(),Wt:this.da(te)}}Ee(){return this.ks.title}Et(){return this.ks.visible}fa(te){this.Th.push(new Wt(te,this))}pa(te){this.Th=this.Th.filter(ee=>ee._h()!==te)}va(){return this.Th.slice().map(te=>te._h())}ma(){if(this.Rh==="Custom")return te=>this.nh.wa(te)}Ma(){if(this.Rh==="Custom")return te=>this.nh.ga(te)}ba(){return this.Xt.Yr()}Qh(){return!G(this.Ut().xa())}ha(te,ee){if(!v(te)||!v(ee)||this.Xt.Gi())return null;const ne=this.Rh==="Line"||this.Rh==="Area"||this.Rh==="Baseline"||this.Rh==="Histogram"?[3]:[2,1],re=this.Xt.$r(te,ee,ne);let se=re!==null?new vt(re.Qr,re.th):null,ae=null;if(this.Dr()==="Histogram"){const le=this.ks.base,ce=new vt(le,le);se=se!==null?se.gn(ce):ce}return this.Th.forEach(le=>{const ce=le.xh(te,ee);if(ce!=null&&ce.priceRange){const he=new vt(ce.priceRange.minValue,ce.priceRange.maxValue);se=se!==null?se.gn(he):he}ce!=null&&ce.margins&&(ae=ce.margins)}),new mt(se,ae)}_a(){switch(this.Rh){case"Line":case"Area":case"Baseline":return this.ks.crosshairMarkerRadius}return 0}ua(){switch(this.Rh){case"Line":case"Area":case"Baseline":{const te=this.ks.crosshairMarkerBorderColor;if(te.length!==0)return te}}return null}ca(){switch(this.Rh){case"Line":case"Area":case"Baseline":return this.ks.crosshairMarkerBorderWidth}return 0}da(te){switch(this.Rh){case"Line":case"Area":case"Baseline":{const ee=this.ks.crosshairMarkerBackgroundColor;if(ee.length!==0)return ee}}return this.Ih().Ir(te).cr}Dh(){switch(this.ks.priceFormat.type){case"custom":this.oa={format:this.ks.priceFormat.formatter};break;case"volume":this.oa=new st(this.ks.priceFormat.precision);break;case"percent":this.oa=new it(this.ks.priceFormat.precision);break;default:{const te=Math.pow(10,this.ks.priceFormat.precision);this.oa=new tt(te,this.ks.priceFormat.minMove*te)}}this.hs!==null&&this.hs.Sa()}ia(te,ee){const ne=[];return Ft(this.Th,te,ee,ne),ne}}const jt=[3],Kt=[0,1,2,3];class Xt{constructor(te){this.ks=te}Ca(te,ee,ne){let re=te;if(this.ks.mode===0)return re;const se=ne.Rs(),ae=se.Nt();if(ae===null)return re;const le=se.Ht(te,ae),ce=ne.Pa().filter(pe=>pe instanceof Yt).reduce((pe,Oe)=>{if(ne.$n(Oe)||!Oe.Et())return pe;const Fe=Oe.Ut(),Ne=Oe.Qs();if(Fe.Gi()||!Ne.Te(ee))return pe;const ze=Ne.Tr(ee);if(ze===null)return pe;const He=c(Oe.Nt()),We=this.ks.mode===1?jt:Kt;return pe.concat(We.map(je=>Fe.Ht(ze.$t[je],He.$t)))},[]);if(ce.length===0)return re;ce.sort((pe,Oe)=>Math.abs(pe-le)-Math.abs(Oe-le));const he=ce[0],fe=this.ks.mode===1||this.ks.mode===3,Ae=this.ks.mode===4&&Math.abs(he-le)<50;return re=fe||Ae?se.Ds(he,ae):te,re}}function Gt(ie,te,ee){return Math.min(Math.max(ie,te),ee)}function Zt(ie,te,ee){return te-ie<=ee}class Qt extends R{constructor(){super(...arguments),this.Xt=null}_t(te){this.Xt=te}lt({context:te,bitmapSize:ee,horizontalPixelRatio:ne,verticalPixelRatio:re}){if(this.Xt===null)return;const se=Math.max(1,Math.floor(ne));te.lineWidth=se,function(ae,le){ae.save(),ae.lineWidth%2&&ae.translate(.5,.5),le(),ae.restore()}(te,()=>{const ae=u$1(this.Xt);if(ae.ya){te.strokeStyle=ae.ka,a$1(te,ae.Ta),te.beginPath();for(const le of ae.Ra){const ce=Math.round(le.Da*ne);te.moveTo(ce,-se),te.lineTo(ce,ee.height+se)}te.stroke()}if(ae.Ia){te.strokeStyle=ae.Ba,a$1(te,ae.Va),te.beginPath();for(const le of ae.Ea){const ce=Math.round(le.Da*re);te.moveTo(-se,ce),te.lineTo(ee.width+se,ce)}te.stroke()}})}}class ti{constructor(te){this.ti=new Qt,this.yt=!0,this.Tt=te}Rt(){this.yt=!0}It(){if(this.yt){const te=this.Tt.si().W().grid,ee={Ia:te.horzLines.visible,ya:te.vertLines.visible,Ba:te.horzLines.color,ka:te.vertLines.color,Va:te.horzLines.style,Ta:te.vertLines.style,Ea:this.Tt.Rs().Aa(),Ra:(this.Tt.si().Lt().Aa()||[]).map(ne=>({Da:ne.coord}))};this.ti._t(ee),this.yt=!1}return this.ti}}class ii{constructor(te){this.nh=new ti(te)}lr(){return this.nh}}const si={za:4,La:1e-4};function ni(ie,te){const ee=100*(ie-te)/te;return te<0?-ee:ee}function ei(ie,te){const ee=ni(ie.$e(),te),ne=ni(ie.qe(),te);return new vt(ee,ne)}function ri(ie,te){const ee=100*(ie-te)/te+100;return te<0?-ee:ee}function hi(ie,te){const ee=ri(ie.$e(),te),ne=ri(ie.qe(),te);return new vt(ee,ne)}function ai(ie,te){const ee=Math.abs(ie);if(ee<1e-15)return 0;const ne=Math.log10(ee+te.La)+te.za;return ie<0?-ne:ne}function li(ie,te){const ee=Math.abs(ie);if(ee<1e-15)return 0;const ne=Math.pow(10,ee-te.za)-te.La;return ie<0?-ne:ne}function oi(ie,te){if(ie===null)return null;const ee=ai(ie.$e(),te),ne=ai(ie.qe(),te);return new vt(ee,ne)}function _i(ie,te){if(ie===null)return null;const ee=li(ie.$e(),te),ne=li(ie.qe(),te);return new vt(ee,ne)}function ui(ie){if(ie===null)return si;const te=Math.abs(ie.qe()-ie.$e());if(te>=1||te<1e-15)return si;const ee=Math.ceil(Math.abs(Math.log10(te))),ne=si.za+ee;return{za:ne,La:1/Math.pow(10,ne)}}class ci{constructor(te,ee){if(this.Oa=te,this.Na=ee,function(ne){if(ne<0)return!1;for(let re=ne;re>1;re/=10)if(re%10!=0)return!1;return!0}(this.Oa))this.Wa=[2,2.5,2];else{this.Wa=[];for(let ne=this.Oa;ne!==1;){if(ne%2==0)this.Wa.push(2),ne/=2;else{if(ne%5!=0)throw new Error("unexpected base");this.Wa.push(2,2.5),ne/=5}if(this.Wa.length>100)throw new Error("something wrong with base")}}}Fa(te,ee,ne){const re=this.Oa===0?0:1/this.Oa;let se=Math.pow(10,Math.max(0,Math.ceil(Math.log10(te-ee)))),ae=0,le=this.Na[0];for(;;){const Ae=Zt(se,re,1e-14)&&se>re+1e-14,pe=Zt(se,ne*le,1e-14),Oe=Zt(se,1,1e-14);if(!(Ae&&pe&&Oe))break;se/=le,le=this.Na[++ae%this.Na.length]}if(se<=re+1e-14&&(se=re),se=Math.max(1,se),this.Wa.length>0&&(ce=se,he=1,fe=1e-14,Math.abs(ce-he)<fe))for(ae=0,le=this.Wa[0];Zt(se,ne*le,1e-14)&&se>re+1e-14;)se/=le,le=this.Wa[++ae%this.Wa.length];var ce,he,fe;return se}}class di{constructor(te,ee,ne,re){this.Ha=[],this.Ki=te,this.Oa=ee,this.Ua=ne,this.$a=re}Fa(te,ee){if(te<ee)throw new Error("high < low");const ne=this.Ki.jt(),re=(te-ee)*this.qa()/ne,se=new ci(this.Oa,[2,2.5,2]),ae=new ci(this.Oa,[2,2,2.5]),le=new ci(this.Oa,[2.5,2,2]),ce=[];return ce.push(se.Fa(te,ee,re),ae.Fa(te,ee,re),le.Fa(te,ee,re)),function(he){if(he.length<1)throw Error("array is empty");let fe=he[0];for(let Ae=1;Ae<he.length;++Ae)he[Ae]<fe&&(fe=he[Ae]);return fe}(ce)}Ya(){const te=this.Ki,ee=te.Nt();if(ee===null)return void(this.Ha=[]);const ne=te.jt(),re=this.Ua(ne-1,ee),se=this.Ua(0,ee),ae=this.Ki.W().entireTextOnly?this.ja()/2:0,le=ae,ce=ne-1-ae,he=Math.max(re,se),fe=Math.min(re,se);if(he===fe)return void(this.Ha=[]);const Ae=this.Fa(he,fe);if(this.Ka(ee,Ae,he,fe,le,ce),te.Xa()&&this.Ga(Ae,fe,he)){const pe=this.Ki.Za();this.Ja(ee,Ae,le,ce,pe,2*pe)}}Aa(){return this.Ha}ja(){return this.Ki.P()}qa(){return Math.ceil(2.5*this.ja())}Ka(te,ee,ne,re,se,ae){const le=this.Ha,ce=this.Ki;let he=ne%ee;he+=he<0?ee:0;const fe=ne>=re?1:-1;let Ae=null,pe=0;for(let Oe=ne-he;Oe>re;Oe-=ee){const Fe=this.$a(Oe,te,!0);Ae!==null&&Math.abs(Fe-Ae)<this.qa()||Fe<se||Fe>ae||(pe<le.length?(le[pe].Da=Fe,le[pe].Qa=ce.tl(Oe)):le.push({Da:Fe,Qa:ce.tl(Oe)}),pe++,Ae=Fe,ce.il()&&(ee=this.Fa(Oe*fe,re)))}le.length=pe}Ja(te,ee,ne,re,se,ae){const le=this.Ha,ce=this.sl(te,ne,se,ae),he=this.sl(te,re,-ae,-se),fe=this.$a(0,te,!0)-this.$a(ee,te,!0);le.length>0&&le[0].Da-ce.Da<fe/2&&le.shift(),le.length>0&&he.Da-le[le.length-1].Da<fe/2&&le.pop(),le.unshift(ce),le.push(he)}sl(te,ee,ne,re){const se=(ne+re)/2,ae=this.Ua(ee+ne,te),le=this.Ua(ee+re,te),ce=Math.min(ae,le),he=Math.max(ae,le),fe=Math.max(.1,this.Fa(he,ce)),Ae=this.Ua(ee+se,te),pe=Ae-Ae%fe,Oe=this.$a(pe,te,!0);return{Qa:this.Ki.tl(pe),Da:Oe}}Ga(te,ee,ne){let re=c(this.Ki.Qe());return this.Ki.il()&&(re=_i(re,this.Ki.nl())),re.$e()-ee<te&&ne-re.qe()<te}}function fi(ie){return ie.slice().sort((te,ee)=>u$1(te._s())-u$1(ee._s()))}var pi;(function(ie){ie[ie.Normal=0]="Normal",ie[ie.Logarithmic=1]="Logarithmic",ie[ie.Percentage=2]="Percentage",ie[ie.IndexedTo100=3]="IndexedTo100"})(pi||(pi={}));const vi=new it,mi=new tt(100,1);class wi{constructor(te,ee,ne,re,se){this.el=0,this.rl=null,this.Ze=null,this.hl=null,this.al={ll:!1,ol:null},this._l=!1,this.ul=0,this.cl=0,this.dl=new d$1,this.fl=new d$1,this.pl=[],this.vl=null,this.ml=null,this.wl=null,this.Ml=null,this.gl=null,this.oa=mi,this.bl=ui(null),this.xl=te,this.ks=ee,this.Sl=ne,this.Cl=re,this.Pl=se,this.yl=new di(this,100,this.kl.bind(this),this.Tl.bind(this))}xa(){return this.xl}W(){return this.ks}hr(te){if(f(this.ks,te),this.Sa(),te.mode!==void 0&&this.Rl({ie:te.mode}),te.scaleMargins!==void 0){const ee=_(te.scaleMargins.top),ne=_(te.scaleMargins.bottom);if(ee<0||ee>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${ee}`);if(ne<0||ne>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${ne}`);if(ee+ne>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${ee+ne}`);this.Dl(),this.wl=null}}Il(){return this.ks.autoScale}Bl(){return this._l}il(){return this.ks.mode===1}Le(){return this.ks.mode===2}Vl(){return this.ks.mode===3}nl(){return this.bl}ie(){return{hn:this.ks.autoScale,El:this.ks.invertScale,ie:this.ks.mode}}Rl(te){const ee=this.ie();let ne=null;te.hn!==void 0&&(this.ks.autoScale=te.hn),te.ie!==void 0&&(this.ks.mode=te.ie,te.ie!==2&&te.ie!==3||(this.ks.autoScale=!0),this.al.ll=!1),ee.ie===1&&te.ie!==ee.ie&&(function(se,ae){if(se===null)return!1;const le=li(se.$e(),ae),ce=li(se.qe(),ae);return isFinite(le)&&isFinite(ce)}(this.Ze,this.bl)?(ne=_i(this.Ze,this.bl),ne!==null&&this.Al(ne)):this.ks.autoScale=!0),te.ie===1&&te.ie!==ee.ie&&(ne=oi(this.Ze,this.bl),ne!==null&&this.Al(ne));const re=ee.ie!==this.ks.mode;re&&(ee.ie===2||this.Le())&&this.Sa(),re&&(ee.ie===3||this.Vl())&&this.Sa(),te.El!==void 0&&ee.El!==te.El&&(this.ks.invertScale=te.El,this.zl()),this.fl.p(ee,this.ie())}Ll(){return this.fl}P(){return this.Sl.fontSize}jt(){return this.el}Ol(te){this.el!==te&&(this.el=te,this.Dl(),this.wl=null)}Nl(){if(this.rl)return this.rl;const te=this.jt()-this.Wl()-this.Fl();return this.rl=te,te}Qe(){return this.Hl(),this.Ze}Al(te,ee){const ne=this.Ze;(ee||ne===null&&te!==null||ne!==null&&!ne.He(te))&&(this.wl=null,this.Ze=te)}Ul(te){this.Al(te),this.$l(te!==null)}Gi(){return this.Hl(),this.el===0||!this.Ze||this.Ze.Gi()}ql(te){return this.El()?te:this.jt()-1-te}Ht(te,ee){return this.Le()?te=ni(te,ee):this.Vl()&&(te=ri(te,ee)),this.Tl(te,ee)}Yl(te,ee,ne){this.Hl();const re=this.Fl(),se=u$1(this.Qe()),ae=se.$e(),le=se.qe(),ce=this.Nl()-1,he=this.El(),fe=ce/(le-ae),Ae=ne===void 0?0:ne.from,pe=ne===void 0?te.length:ne.to,Oe=this.jl();for(let Fe=Ae;Fe<pe;Fe++){const Ne=te[Fe],ze=Ne.xt;if(isNaN(ze))continue;let He=ze;Oe!==null&&(He=Oe(Ne.xt,ee));const We=re+fe*(He-ae),je=he?We:this.el-1-We;Ne.ft=je}}Kl(te,ee,ne){this.Hl();const re=this.Fl(),se=u$1(this.Qe()),ae=se.$e(),le=se.qe(),ce=this.Nl()-1,he=this.El(),fe=ce/(le-ae),Ae=ne===void 0?0:ne.from,pe=ne===void 0?te.length:ne.to,Oe=this.jl();for(let Fe=Ae;Fe<pe;Fe++){const Ne=te[Fe];let ze=Ne.jh,He=Ne.Kh,We=Ne.Xh,je=Ne.Gh;Oe!==null&&(ze=Oe(Ne.jh,ee),He=Oe(Ne.Kh,ee),We=Oe(Ne.Xh,ee),je=Oe(Ne.Gh,ee));let Ue=re+fe*(ze-ae),Ge=he?Ue:this.el-1-Ue;Ne.Xl=Ge,Ue=re+fe*(He-ae),Ge=he?Ue:this.el-1-Ue,Ne.Gl=Ge,Ue=re+fe*(We-ae),Ge=he?Ue:this.el-1-Ue,Ne.Zl=Ge,Ue=re+fe*(je-ae),Ge=he?Ue:this.el-1-Ue,Ne.Jl=Ge}}Ds(te,ee){const ne=this.kl(te,ee);return this.Ql(ne,ee)}Ql(te,ee){let ne=te;return this.Le()?ne=function(re,se){return se<0&&(re=-re),re/100*se+se}(ne,ee):this.Vl()&&(ne=function(re,se){return re-=100,se<0&&(re=-re),re/100*se+se}(ne,ee)),ne}Pa(){return this.pl}Vt(){return this.ml||(this.ml=fi(this.pl)),this.ml}io(te){this.pl.indexOf(te)===-1&&(this.pl.push(te),this.Sa(),this.so())}no(te){const ee=this.pl.indexOf(te);if(ee===-1)throw new Error("source is not attached to scale");this.pl.splice(ee,1),this.pl.length===0&&(this.Rl({hn:!0}),this.Al(null)),this.Sa(),this.so()}Nt(){let te=null;for(const ee of this.pl){const ne=ee.Nt();ne!==null&&(te===null||ne.$h<te.$h)&&(te=ne)}return te===null?null:te.$t}El(){return this.ks.invertScale}Aa(){const te=this.Nt()===null;if(this.wl!==null&&(te||this.wl.eo===te))return this.wl.Aa;this.yl.Ya();const ee=this.yl.Aa();return this.wl={Aa:ee,eo:te},this.dl.p(),ee}ro(){return this.dl}ho(te){this.Le()||this.Vl()||this.Ml===null&&this.hl===null&&(this.Gi()||(this.Ml=this.el-te,this.hl=u$1(this.Qe()).Ue()))}ao(te){if(this.Le()||this.Vl()||this.Ml===null)return;this.Rl({hn:!1}),(te=this.el-te)<0&&(te=0);let ee=(this.Ml+.2*(this.el-1))/(te+.2*(this.el-1));const ne=u$1(this.hl).Ue();ee=Math.max(ee,.1),ne.je(ee),this.Al(ne)}lo(){this.Le()||this.Vl()||(this.Ml=null,this.hl=null)}oo(te){this.Il()||this.gl===null&&this.hl===null&&(this.Gi()||(this.gl=te,this.hl=u$1(this.Qe()).Ue()))}_o(te){if(this.Il()||this.gl===null)return;const ee=u$1(this.Qe()).Ye()/(this.Nl()-1);let ne=te-this.gl;this.El()&&(ne*=-1);const re=ne*ee,se=u$1(this.hl).Ue();se.Ke(re),this.Al(se,!0),this.wl=null}uo(){this.Il()||this.gl!==null&&(this.gl=null,this.hl=null)}la(){return this.oa||this.Sa(),this.oa}Ji(te,ee){switch(this.ks.mode){case 2:return this.co(ni(te,ee));case 3:return this.la().format(ri(te,ee));default:return this.nr(te)}}tl(te){switch(this.ks.mode){case 2:return this.co(te);case 3:return this.la().format(te);default:return this.nr(te)}}Bh(te){return this.nr(te,u$1(this.vl).la())}Vh(te,ee){return te=ni(te,ee),this.co(te,vi)}do(){return this.pl}fo(te){this.al={ol:te,ll:!1}}Us(){this.pl.forEach(te=>te.Us())}Xa(){return this.ks.ensureEdgeTickMarksVisible&&this.Il()}Za(){return this.P()/2}Sa(){this.wl=null;let te=1/0;this.vl=null;for(const ne of this.pl)ne._s()<te&&(te=ne._s(),this.vl=ne);let ee=100;this.vl!==null&&(ee=Math.round(1/this.vl.aa())),this.oa=mi,this.Le()?(this.oa=vi,ee=100):this.Vl()?(this.oa=new tt(100,1),ee=100):this.vl!==null&&(this.oa=this.vl.la()),this.yl=new di(this,ee,this.kl.bind(this),this.Tl.bind(this)),this.yl.Ya()}so(){this.ml=null}Zi(){return this.Pl}$l(te){this._l=te}Wl(){return this.El()?this.ks.scaleMargins.bottom*this.jt()+this.cl:this.ks.scaleMargins.top*this.jt()+this.ul}Fl(){return this.El()?this.ks.scaleMargins.top*this.jt()+this.ul:this.ks.scaleMargins.bottom*this.jt()+this.cl}Hl(){this.al.ll||(this.al.ll=!0,this.po())}Dl(){this.rl=null}Tl(te,ee){if(this.Hl(),this.Gi())return 0;te=this.il()&&te?ai(te,this.bl):te;const ne=u$1(this.Qe()),re=this.Fl()+(this.Nl()-1)*(te-ne.$e())/ne.Ye();return this.ql(re)}kl(te,ee){if(this.Hl(),this.Gi())return 0;const ne=this.ql(te),re=u$1(this.Qe()),se=re.$e()+re.Ye()*((ne-this.Fl())/(this.Nl()-1));return this.il()?li(se,this.bl):se}zl(){this.wl=null,this.yl.Ya()}po(){if(this.Bl()&&!this.Il())return;const te=this.al.ol;if(te===null)return;let ee=null;const ne=this.do();let re=0,se=0;for(const ce of ne){if(!ce.Et())continue;const he=ce.Nt();if(he===null)continue;const fe=ce.xh(te.qh(),te.Pi());let Ae=fe&&fe.Qe();if(Ae!==null){switch(this.ks.mode){case 1:Ae=oi(Ae,this.bl);break;case 2:Ae=ei(Ae,he.$t);break;case 3:Ae=hi(Ae,he.$t)}if(ee=ee===null?Ae:ee.gn(u$1(Ae)),fe!==null){const pe=fe.tr();pe!==null&&(re=Math.max(re,pe.above),se=Math.max(se,pe.below))}}}if(this.Xa()&&(re=Math.max(re,this.Za()),se=Math.max(se,this.Za())),re===this.ul&&se===this.cl||(this.ul=re,this.cl=se,this.wl=null,this.Dl()),ee!==null){if(ee.$e()===ee.qe()){const ce=this.vl,he=5*(ce===null||this.Le()||this.Vl()?1:ce.aa());this.il()&&(ee=_i(ee,this.bl)),ee=new vt(ee.$e()-he,ee.qe()+he),this.il()&&(ee=oi(ee,this.bl))}if(this.il()){const ce=_i(ee,this.bl),he=ui(ce);if(ae=he,le=this.bl,ae.za!==le.za||ae.La!==le.La){const fe=this.hl!==null?_i(this.hl,this.bl):null;this.bl=he,ee=oi(ce,he),fe!==null&&(this.hl=oi(fe,he))}}this.Al(ee)}else this.Ze===null&&(this.Al(new vt(-.5,.5)),this.bl=ui(null));var ae,le}jl(){return this.Le()?ni:this.Vl()?ri:this.il()?te=>ai(te,this.bl):null}vo(te,ee,ne){return ee===void 0?(ne===void 0&&(ne=this.la()),ne.format(te)):ee(te)}nr(te,ee){return this.vo(te,this.Cl.priceFormatter,ee)}co(te,ee){return this.vo(te,this.Cl.percentageFormatter,ee)}}function Mi(ie){return ie instanceof Yt}class gi{constructor(te,ee){this.pl=[],this.mo=new Map,this.el=0,this.wo=0,this.Mo=1,this.ml=null,this.bo=!1,this.xo=new d$1,this.Th=[],this.fh=te,this.ns=ee,this.So=new ii(this);const ne=ee.W();this.Co=this.Po("left",ne.leftPriceScale),this.yo=this.Po("right",ne.rightPriceScale),this.Co.Ll().i(this.ko.bind(this,this.Co),this),this.yo.Ll().i(this.ko.bind(this,this.yo),this),this.To(ne)}To(te){if(te.leftPriceScale&&this.Co.hr(te.leftPriceScale),te.rightPriceScale&&this.yo.hr(te.rightPriceScale),te.localization&&(this.Co.Sa(),this.yo.Sa()),te.overlayPriceScales){const ee=Array.from(this.mo.values());for(const ne of ee){const re=u$1(ne[0].Ut());re.hr(te.overlayPriceScales),te.localization&&re.Sa()}}}Ro(te){switch(te){case"left":return this.Co;case"right":return this.yo}return this.mo.has(te)?_(this.mo.get(te))[0].Ut():null}m(){this.si().Do().u(this),this.Co.Ll().u(this),this.yo.Ll().u(this),this.pl.forEach(te=>{te.m&&te.m()}),this.Th=this.Th.filter(te=>{const ee=te._h();return ee.detached&&ee.detached(),!1}),this.xo.p()}Io(){return this.Mo}Bo(te){this.Mo=te}si(){return this.ns}ss(){return this.wo}jt(){return this.el}Vo(te){this.wo=te,this.Eo()}Ol(te){this.el=te,this.Co.Ol(te),this.yo.Ol(te),this.pl.forEach(ee=>{if(this.$n(ee)){const ne=ee.Ut();ne!==null&&ne.Ol(te)}}),this.Eo()}Ao(te){this.bo=te}zo(){return this.bo}Lo(){return this.pl.filter(Mi)}Pa(){return this.pl}$n(te){const ee=te.Ut();return ee===null||this.Co!==ee&&this.yo!==ee}io(te,ee,ne){this.Oo(te,ee,ne?te._s():this.pl.length)}no(te,ee){const ne=this.pl.indexOf(te);o$1(ne!==-1,"removeDataSource: invalid data source"),this.pl.splice(ne,1),ee||this.pl.forEach((ae,le)=>ae.us(le));const re=u$1(te.Ut()).xa();if(this.mo.has(re)){const ae=_(this.mo.get(re)),le=ae.indexOf(te);le!==-1&&(ae.splice(le,1),ae.length===0&&this.mo.delete(re))}const se=te.Ut();se&&se.Pa().indexOf(te)>=0&&(se.no(te),this.No(se)),this.ml=null}Yn(te){return te===this.Co?"left":te===this.yo?"right":"overlay"}Wo(){return this.Co}Fo(){return this.yo}Ho(te,ee){te.ho(ee)}Uo(te,ee){te.ao(ee),this.Eo()}$o(te){te.lo()}qo(te,ee){te.oo(ee)}Yo(te,ee){te._o(ee),this.Eo()}jo(te){te.uo()}Eo(){this.pl.forEach(te=>{te.Us()})}Rs(){let te=null;return this.ns.W().rightPriceScale.visible&&this.yo.Pa().length!==0?te=this.yo:this.ns.W().leftPriceScale.visible&&this.Co.Pa().length!==0?te=this.Co:this.pl.length!==0&&(te=this.pl[0].Ut()),te===null&&(te=this.yo),te}qn(){let te=null;return this.ns.W().rightPriceScale.visible?te=this.yo:this.ns.W().leftPriceScale.visible&&(te=this.Co),te}No(te){te!==null&&te.Il()&&this.Ko(te)}Xo(te){const ee=this.fh.Pe();te.Rl({hn:!0}),ee!==null&&te.fo(ee),this.Eo()}Go(){this.Ko(this.Co),this.Ko(this.yo)}Zo(){this.No(this.Co),this.No(this.yo),this.pl.forEach(te=>{this.$n(te)&&this.No(te.Ut())}),this.Eo(),this.ns.ar()}Vt(){return this.ml===null&&(this.ml=fi(this.pl)),this.ml}Jo(te,ee){ee=Gt(ee,0,this.pl.length-1);const ne=this.pl.indexOf(te);o$1(ne!==-1,"setSeriesOrder: invalid data source"),this.pl.splice(ne,1),this.pl.splice(ee,0,te),this.pl.forEach((re,se)=>re.us(se)),this.ml=null;for(const re of[this.Co,this.yo])re.so(),re.Sa();this.ns.ar()}At(){return this.Vt().filter(Mi)}Qo(){return this.xo}t_(){return this.So}fa(te){this.Th.push(new Et(te))}pa(te){this.Th=this.Th.filter(ee=>ee._h()!==te),te.detached&&te.detached(),this.ns.ar()}va(){return this.Th}ra(te,ee){return this.Th.map(ne=>ne.Kn(te,ee)).filter(ne=>ne!==null)}Ko(te){const ee=te.do();if(ee&&ee.length>0&&!this.fh.Gi()){const ne=this.fh.Pe();ne!==null&&te.fo(ne)}te.Us()}Oo(te,ee,ne){let re=this.Ro(ee);if(re===null&&(re=this.Po(ee,this.ns.W().overlayPriceScales)),this.pl.splice(ne,0,te),!G(ee)){const se=this.mo.get(ee)||[];se.push(te),this.mo.set(ee,se)}te.us(ne),re.io(te),te.cs(re),this.No(re),this.ml=null}ko(te,ee,ne){ee.ie!==ne.ie&&this.Ko(te)}Po(te,ee){const ne={visible:!0,autoScale:!0,...M$2(ee)},re=new wi(te,ne,this.ns.W().layout,this.ns.W().localization,this.ns.Zi());return re.Ol(this.jt()),re}}function bi(ie){return{i_:ie.i_,s_:{externalId:ie.n_.externalId},e_:ie.n_.cursorStyle}}function xi(ie,te,ee,ne){for(const re of ie){const se=re.It(ne);if(se!==null&&se.Kn){const ae=se.Kn(te,ee);if(ae!==null)return{r_:re,s_:ae}}}return null}function Si(ie){return ie.$s!==void 0}function Ci(ie,te,ee){const ne=[ie,...ie.Vt()],re=function(se,ae,le){var pe;let ce,he;for(const Oe of se){const Fe=((pe=Oe.ra)==null?void 0:pe.call(Oe,ae,le))??[];for(const Ne of Fe)fe=Ne.zOrder,Ae=ce==null?void 0:ce.zOrder,(!Ae||fe==="top"&&Ae!=="top"||fe==="normal"&&Ae==="bottom")&&(ce=Ne,he=Oe)}var fe,Ae;return ce&&he?{n_:ce,i_:he}:null}(ne,te,ee);if((re==null?void 0:re.n_.zOrder)==="top")return bi(re);for(const se of ne){if(re&&re.i_===se&&re.n_.zOrder!=="bottom"&&!re.n_.isBackground)return bi(re);if(Si(se)){const ae=xi(se.$s(ie),te,ee,ie);if(ae!==null)return{i_:se,r_:ae.r_,s_:ae.s_}}if(re&&re.i_===se&&re.n_.zOrder!=="bottom"&&re.n_.isBackground)return bi(re)}return re!=null&&re.n_?bi(re):null}class Pi{constructor(te,ee,ne=50){this.Rn=0,this.Dn=1,this.In=1,this.Vn=new Map,this.Bn=new Map,this.h_=te,this.a_=ee,this.En=ne}l_(te){const ee=te.time,ne=this.a_.cacheKey(ee),re=this.Vn.get(ne);if(re!==void 0)return re.o_;if(this.Rn===this.En){const ae=this.Bn.get(this.In);this.Bn.delete(this.In),this.Vn.delete(_(ae)),this.In++,this.Rn--}const se=this.h_(te);return this.Vn.set(ne,{o_:se,zn:this.Dn}),this.Bn.set(this.Dn,ne),this.Rn++,this.Dn++,se}}class yi{constructor(te,ee){o$1(te<=ee,"right should be >= left"),this.__=te,this.u_=ee}qh(){return this.__}Pi(){return this.u_}c_(){return this.u_-this.__+1}Te(te){return this.__<=te&&te<=this.u_}He(te){return this.__===te.qh()&&this.u_===te.Pi()}}function ki(ie,te){return ie===null||te===null?ie===te:ie.He(te)}class Ti{constructor(){this.d_=new Map,this.Vn=null,this.f_=!1}p_(te){this.f_=te,this.Vn=null}v_(te,ee){this.m_(ee),this.Vn=null;for(let ne=ee;ne<te.length;++ne){const re=te[ne];let se=this.d_.get(re.timeWeight);se===void 0&&(se=[],this.d_.set(re.timeWeight,se)),se.push({index:ne,time:re.time,weight:re.timeWeight,originalTime:re.originalTime})}}w_(te,ee,ne,re,se){const ae=Math.ceil(ee/te);return this.Vn!==null&&this.Vn.M_===ae&&se===this.Vn.g_&&ne===this.Vn.b_||(this.Vn={g_:se,b_:ne,Aa:this.x_(ae,ne,re),M_:ae}),this.Vn.Aa}m_(te){if(te===0)return void this.d_.clear();const ee=[];this.d_.forEach((ne,re)=>{te<=ne[0].index?ee.push(re):ne.splice(Pt(ne,te,se=>se.index<te),1/0)});for(const ne of ee)this.d_.delete(ne)}x_(te,ee,ne){let re=[];const se=ae=>!ee||ne.has(ae.index);for(const ae of Array.from(this.d_.keys()).sort((le,ce)=>ce-le)){if(!this.d_.get(ae))continue;const le=re;re=[];const ce=le.length;let he=0;const fe=_(this.d_.get(ae)),Ae=fe.length;let pe=1/0,Oe=-1/0;for(let Fe=0;Fe<Ae;Fe++){const Ne=fe[Fe],ze=Ne.index;for(;he<ce;){const He=le[he],We=He.index;if(!(We<ze&&se(He))){pe=We;break}he++,re.push(He),Oe=We,pe=1/0}if(pe-ze>=te&&ze-Oe>=te&&se(Ne))re.push(Ne),Oe=ze;else if(this.f_)return le}for(;he<ce;he++)se(le[he])&&re.push(le[he])}return re}}class Ri{constructor(te){this.S_=te}C_(){return this.S_===null?null:new yi(Math.floor(this.S_.qh()),Math.ceil(this.S_.Pi()))}P_(){return this.S_}static y_(){return new Ri(null)}}function Di(ie,te){return ie.weight>te.weight?ie:te}class Ii{constructor(te,ee,ne,re){this.wo=0,this.k_=null,this.T_=[],this.gl=null,this.Ml=null,this.R_=new Ti,this.D_=new Map,this.I_=Ri.y_(),this.B_=!0,this.V_=new d$1,this.E_=new d$1,this.A_=new d$1,this.z_=null,this.L_=null,this.O_=new Map,this.N_=-1,this.W_=[],this.ks=ee,this.Cl=ne,this.F_=ee.rightOffset,this.H_=ee.barSpacing,this.ns=te,this.a_=re,this.U_(),this.R_.p_(ee.uniformDistribution),this.q_()}W(){return this.ks}Y_(te){f(this.Cl,te),this.j_(),this.U_()}hr(te,ee){f(this.ks,te),this.ks.fixLeftEdge&&this.K_(),this.ks.fixRightEdge&&this.X_(),te.barSpacing!==void 0&&this.ns.mn(te.barSpacing),te.rightOffset!==void 0&&this.ns.wn(te.rightOffset),te.minBarSpacing===void 0&&te.maxBarSpacing===void 0||this.ns.mn(te.barSpacing??this.H_),te.ignoreWhitespaceIndices!==void 0&&te.ignoreWhitespaceIndices!==this.ks.ignoreWhitespaceIndices&&this.q_(),this.j_(),this.U_(),this.A_.p()}Is(te){var ee;return((ee=this.T_[te])==null?void 0:ee.time)??null}es(te){return this.T_[te]??null}G_(te,ee){if(this.T_.length<1)return null;if(this.a_.key(te)>this.a_.key(this.T_[this.T_.length-1].time))return ee?this.T_.length-1:null;const ne=Pt(this.T_,this.a_.key(te),(re,se)=>this.a_.key(re.time)<se);return this.a_.key(te)<this.a_.key(this.T_[ne].time)?ee?ne:null:ne}Gi(){return this.wo===0||this.T_.length===0||this.k_===null}Z_(){return this.T_.length>0}Pe(){return this.J_(),this.I_.C_()}Q_(){return this.J_(),this.I_.P_()}tu(){const te=this.Pe();if(te===null)return null;const ee={from:te.qh(),to:te.Pi()};return this.iu(ee)}iu(te){const ee=Math.round(te.from),ne=Math.round(te.to),re=u$1(this.su()),se=u$1(this.nu());return{from:u$1(this.es(Math.max(re,ee))),to:u$1(this.es(Math.min(se,ne)))}}eu(te){return{from:u$1(this.G_(te.from,!0)),to:u$1(this.G_(te.to,!0))}}ss(){return this.wo}Vo(te){if(!isFinite(te)||te<=0||this.wo===te)return;const ee=this.Q_(),ne=this.wo;if(this.wo=te,this.B_=!0,this.ks.lockVisibleTimeRangeOnResize&&ne!==0){const re=this.H_*te/ne;this.H_=re}if(this.ks.fixLeftEdge&&ee!==null&&ee.qh()<=0){const re=ne-te;this.F_-=Math.round(re/this.H_)+1,this.B_=!0}this.ru(),this.hu()}Kt(te){if(this.Gi()||!v(te))return 0;const ee=this.au()+this.F_-te;return this.wo-(ee+.5)*this.H_-1}lu(te,ee){const ne=this.au(),re=ee===void 0?0:ee.from,se=ee===void 0?te.length:ee.to;for(let ae=re;ae<se;ae++){const le=te[ae].bt,ce=ne+this.F_-le,he=this.wo-(ce+.5)*this.H_-1;te[ae].dt=he}}ou(te,ee){const ne=Math.ceil(this._u(te));return ee&&this.ks.ignoreWhitespaceIndices&&!this.uu(ne)?this.cu(ne):ne}wn(te){this.B_=!0,this.F_=te,this.hu(),this.ns.du(),this.ns.ar()}fu(){return this.H_}mn(te){this.pu(te),this.hu(),this.ns.du(),this.ns.ar()}vu(){return this.F_}Aa(){if(this.Gi())return null;if(this.L_!==null)return this.L_;const te=this.H_,ee=5*(this.ns.W().layout.fontSize+4)/8*(this.ks.tickMarkMaxCharacterLength||8),ne=Math.round(ee/te),re=u$1(this.Pe()),se=Math.max(re.qh(),re.qh()-ne),ae=Math.max(re.Pi(),re.Pi()-ne),le=this.R_.w_(te,ee,this.ks.ignoreWhitespaceIndices,this.O_,this.N_),ce=this.su()+ne,he=this.nu()-ne,fe=this.mu(),Ae=this.ks.fixLeftEdge||fe,pe=this.ks.fixRightEdge||fe;let Oe=0;for(const Fe of le){if(!(se<=Fe.index&&Fe.index<=ae))continue;let Ne;Oe<this.W_.length?(Ne=this.W_[Oe],Ne.coord=this.Kt(Fe.index),Ne.label=this.wu(Fe),Ne.weight=Fe.weight):(Ne={needAlignCoordinate:!1,coord:this.Kt(Fe.index),label:this.wu(Fe),weight:Fe.weight},this.W_.push(Ne)),this.H_>ee/2&&!fe?Ne.needAlignCoordinate=!1:Ne.needAlignCoordinate=Ae&&Fe.index<=ce||pe&&Fe.index>=he,Oe++}return this.W_.length=Oe,this.L_=this.W_,this.W_}Mu(){this.B_=!0,this.mn(this.ks.barSpacing),this.wn(this.ks.rightOffset)}gu(te){this.B_=!0,this.k_=te,this.hu(),this.K_()}bu(te,ee){const ne=this._u(te),re=this.fu(),se=re+ee*(re/10);this.mn(se),this.ks.rightBarStaysOnScroll||this.wn(this.vu()+(ne-this._u(te)))}ho(te){this.gl&&this.uo(),this.Ml===null&&this.z_===null&&(this.Gi()||(this.Ml=te,this.xu()))}ao(te){if(this.z_===null)return;const ee=Gt(this.wo-te,0,this.wo),ne=Gt(this.wo-u$1(this.Ml),0,this.wo);ee!==0&&ne!==0&&this.mn(this.z_.fu*ee/ne)}lo(){this.Ml!==null&&(this.Ml=null,this.Su())}oo(te){this.gl===null&&this.z_===null&&(this.Gi()||(this.gl=te,this.xu()))}_o(te){if(this.gl===null)return;const ee=(this.gl-te)/this.fu();this.F_=u$1(this.z_).vu+ee,this.B_=!0,this.hu()}uo(){this.gl!==null&&(this.gl=null,this.Su())}Cu(){this.Pu(this.ks.rightOffset)}Pu(te,ee=400){if(!isFinite(te))throw new RangeError("offset is required and must be finite number");if(!isFinite(ee)||ee<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const ne=this.F_,re=performance.now();this.ns.fn({yu:se=>(se-re)/ee>=1,Ns:se=>{const ae=(se-re)/ee;return ae>=1?te:ne+(te-ne)*ae}})}Rt(te,ee){this.B_=!0,this.T_=te,this.R_.v_(te,ee),this.hu()}ku(){return this.V_}Tu(){return this.E_}Ru(){return this.A_}au(){return this.k_||0}Du(te){const ee=te.c_();this.pu(this.wo/ee),this.F_=te.Pi()-this.au(),this.hu(),this.B_=!0,this.ns.du(),this.ns.ar()}Iu(){const te=this.su(),ee=this.nu();te!==null&&ee!==null&&this.Du(new yi(te,ee+this.ks.rightOffset))}Bu(te){const ee=new yi(te.from,te.to);this.Du(ee)}rs(te){return this.Cl.timeFormatter!==void 0?this.Cl.timeFormatter(te.originalTime):this.a_.formatHorzItem(te.time)}q_(){if(!this.ks.ignoreWhitespaceIndices)return;this.O_.clear();const te=this.ns.Zs();for(const ee of te)for(const ne of ee.ba())this.O_.set(ne,!0);this.N_++}Or(){return this.su()}Js(){return this.nu()}Vu(){return this.T_}mu(){const te=this.ns.W().handleScroll,ee=this.ns.W().handleScale;return!(te.horzTouchDrag||te.mouseWheel||te.pressedMouseMove||te.vertTouchDrag||ee.axisDoubleClickReset.time||ee.axisPressedMouseMove.time||ee.mouseWheel||ee.pinch)}su(){return this.T_.length===0?null:0}nu(){return this.T_.length===0?null:this.T_.length-1}Eu(te){return(this.wo-1-te)/this.H_}_u(te){const ee=this.Eu(te),ne=this.au()+this.F_-ee;return Math.round(1e6*ne)/1e6}pu(te){const ee=this.H_;this.H_=te,this.ru(),ee!==this.H_&&(this.B_=!0,this.Au())}J_(){if(!this.B_)return;if(this.B_=!1,this.Gi())return void this.zu(Ri.y_());const te=this.au(),ee=this.wo/this.H_,ne=this.F_+te,re=new yi(ne-ee+1,ne);this.zu(new Ri(re))}ru(){const te=Gt(this.H_,this.Lu(),this.Ou());this.H_!==te&&(this.H_=te,this.B_=!0)}Ou(){return this.ks.maxBarSpacing>0?this.ks.maxBarSpacing:.5*this.wo}Lu(){return this.ks.fixLeftEdge&&this.ks.fixRightEdge&&this.T_.length!==0?this.wo/this.T_.length:this.ks.minBarSpacing}hu(){const te=this.Nu();te!==null&&this.F_<te&&(this.F_=te,this.B_=!0);const ee=this.Wu();this.F_>ee&&(this.F_=ee,this.B_=!0)}Nu(){const te=this.su(),ee=this.k_;return te===null||ee===null?null:te-ee-1+(this.ks.fixLeftEdge?this.wo/this.H_:Math.min(2,this.T_.length))}Wu(){return this.ks.fixRightEdge?0:this.wo/this.H_-Math.min(2,this.T_.length)}xu(){this.z_={fu:this.fu(),vu:this.vu()}}Su(){this.z_=null}wu(te){let ee=this.D_.get(te.weight);return ee===void 0&&(ee=new Pi(ne=>this.Fu(ne),this.a_),this.D_.set(te.weight,ee)),ee.l_(te)}Fu(te){return this.a_.formatTickmark(te,this.Cl)}zu(te){const ee=this.I_;this.I_=te,ki(ee.C_(),this.I_.C_())||this.V_.p(),ki(ee.P_(),this.I_.P_())||this.E_.p(),this.Au()}Au(){this.L_=null}j_(){this.Au(),this.D_.clear()}U_(){this.a_.updateFormatter(this.Cl)}K_(){if(!this.ks.fixLeftEdge)return;const te=this.su();if(te===null)return;const ee=this.Pe();if(ee===null)return;const ne=ee.qh()-te;if(ne<0){const re=this.F_-ne-1;this.wn(re)}this.ru()}X_(){this.hu(),this.ru()}uu(te){return!this.ks.ignoreWhitespaceIndices||this.O_.get(te)||!1}cu(te){const ee=function*(re){const se=Math.round(re),ae=se<re;let le=1;for(;;)ae?(yield se+le,yield se-le):(yield se-le,yield se+le),le++}(te),ne=this.nu();for(;ne;){const re=ee.next().value;if(this.O_.get(re))return re;if(re<0||re>ne)break}return te}}var Bi,Vi,Ei,Ai,zi;(function(ie){ie[ie.OnTouchEnd=0]="OnTouchEnd",ie[ie.OnNextTap=1]="OnNextTap"})(Bi||(Bi={}));class Li{constructor(te,ee,ne){this.Hu=[],this.Uu=[],this.wo=0,this.$u=null,this.qu=new d$1,this.Yu=new d$1,this.ju=null,this.Ku=te,this.ks=ee,this.a_=ne,this.Pl=new k$1(this.ks.layout.colorParsers),this.Xu=new C$1(this),this.fh=new Ii(this,ee.timeScale,this.ks.localization,ne),this.kt=new X(this,ee.crosshair),this.Gu=new Xt(ee.crosshair),ee.addDefaultPane&&(this.Zu(0),this.Hu[0].Bo(2)),this.Ju=this.Qu(0),this.tc=this.Qu(1)}Ah(){this.sc(Z.Sn())}ar(){this.sc(Z.xn())}Jh(){this.sc(new Z(1))}zh(te){const ee=this.nc(te);this.sc(ee)}ec(){return this.$u}rc(te){var ne,re,se,ae;if(((ne=this.$u)==null?void 0:ne.i_)===(te==null?void 0:te.i_)&&((se=(re=this.$u)==null?void 0:re.s_)==null?void 0:se.externalId)===((ae=te==null?void 0:te.s_)==null?void 0:ae.externalId))return;const ee=this.$u;this.$u=te,ee!==null&&this.zh(ee.i_),te!==null&&te.i_!==(ee==null?void 0:ee.i_)&&this.zh(te.i_)}W(){return this.ks}hr(te){f(this.ks,te),this.Hu.forEach(ee=>ee.To(te)),te.timeScale!==void 0&&this.fh.hr(te.timeScale),te.localization!==void 0&&this.fh.Y_(te.localization),(te.leftPriceScale||te.rightPriceScale)&&this.qu.p(),this.Ju=this.Qu(0),this.tc=this.Qu(1),this.Ah()}hc(te,ee,ne=0){const re=this.Hu[ne];if(re===void 0)return;if(te==="left")return f(this.ks,{leftPriceScale:ee}),re.To({leftPriceScale:ee}),this.qu.p(),void this.Ah();if(te==="right")return f(this.ks,{rightPriceScale:ee}),re.To({rightPriceScale:ee}),this.qu.p(),void this.Ah();const se=this.ac(te,ne);se!==null&&(se.Ut.hr(ee),this.qu.p())}ac(te,ee){const ne=this.Hu[ee];if(ne===void 0)return null;const re=ne.Ro(te);return re!==null?{js:ne,Ut:re}:null}Lt(){return this.fh}Ks(){return this.Hu}lc(){return this.kt}oc(){return this.Yu}_c(te,ee){te.Ol(ee),this.du()}Vo(te){this.wo=te,this.fh.Vo(this.wo),this.Hu.forEach(ee=>ee.Vo(te)),this.du()}uc(te){this.Hu.length!==1&&(o$1(te>=0&&te<this.Hu.length,"Invalid pane index"),this.Hu.splice(te,1),this.Ah())}cc(te,ee){if(this.Hu.length<2)return;o$1(te>=0&&te<this.Hu.length,"Invalid pane index");const ne=this.Hu[te],re=this.Hu.reduce((Ae,pe)=>Ae+pe.Io(),0),se=this.Hu.reduce((Ae,pe)=>Ae+pe.jt(),0),ae=se-30*(this.Hu.length-1);ee=Math.min(ae,Math.max(30,ee));const le=re/se,ce=ne.jt();ne.Bo(ee*le);let he=ee-ce,fe=this.Hu.length-1;for(const Ae of this.Hu)if(Ae!==ne){const pe=Math.min(ae,Math.max(30,Ae.jt()-he/fe));he-=Ae.jt()-pe,fe-=1;const Oe=pe*le;Ae.Bo(Oe)}this.Ah()}dc(te,ee){o$1(te>=0&&te<this.Hu.length&&ee>=0&&ee<this.Hu.length,"Invalid pane index");const ne=this.Hu[te],re=this.Hu[ee];this.Hu[te]=re,this.Hu[ee]=ne,this.Ah()}fc(te,ee){if(o$1(te>=0&&te<this.Hu.length&&ee>=0&&ee<this.Hu.length,"Invalid pane index"),te===ee)return;const[ne]=this.Hu.splice(te,1);this.Hu.splice(ee,0,ne),this.Ah()}Ho(te,ee,ne){te.Ho(ee,ne)}Uo(te,ee,ne){te.Uo(ee,ne),this.Lh(),this.sc(this.vc(te,2))}$o(te,ee){te.$o(ee),this.sc(this.vc(te,2))}qo(te,ee,ne){ee.Il()||te.qo(ee,ne)}Yo(te,ee,ne){ee.Il()||(te.Yo(ee,ne),this.Lh(),this.sc(this.vc(te,2)))}jo(te,ee){ee.Il()||(te.jo(ee),this.sc(this.vc(te,2)))}Xo(te,ee){te.Xo(ee),this.sc(this.vc(te,2))}mc(te){this.fh.ho(te)}wc(te,ee){const ne=this.Lt();if(ne.Gi()||ee===0)return;const re=ne.ss();te=Math.max(1,Math.min(te,re)),ne.bu(te,ee),this.du()}Mc(te){this.gc(0),this.bc(te),this.xc()}Sc(te){this.fh.ao(te),this.du()}Cc(){this.fh.lo(),this.ar()}gc(te){this.fh.oo(te)}bc(te){this.fh._o(te),this.du()}xc(){this.fh.uo(),this.ar()}Zs(){return this.Uu}Pc(te,ee,ne,re,se){this.kt.Vs(te,ee);let ae=NaN,le=this.fh.ou(te,!0);const ce=this.fh.Pe();ce!==null&&(le=Math.min(Math.max(ce.qh(),le),ce.Pi()));const he=re.Rs(),fe=he.Nt();if(fe!==null&&(ae=he.Ds(ee,fe)),ae=this.Gu.Ca(ae,le,re),this.kt.Ls(le,ae,re),this.Jh(),!se){const Ae=Ci(re,te,ee);this.rc(Ae&&{i_:Ae.i_,s_:Ae.s_,e_:Ae.e_||null}),this.Yu.p(this.kt.zt(),{x:te,y:ee},ne)}}yc(){const te=this.kt.Ns(),ee=this.kt.Ws(),ne=ee?this.kc(ee):void 0;return{x:te.x,y:te.y,paneIndex:ne}}Tc(te,ee,ne){const re=ne.Rs(),se=re.Nt(),ae=re.Ht(te,u$1(se)),le=this.fh.G_(ee,!0),ce=this.fh.Kt(u$1(le));this.Pc(ce,ae,null,ne,!0)}Rc(te){this.lc().Fs(),this.Jh(),te||this.Yu.p(null,null,null)}Lh(){const te=this.kt.js();if(te!==null){const ee=this.kt.As(),ne=this.kt.zs();this.Pc(ee,ne,null,te)}this.kt.Us()}Dc(te,ee,ne){const re=this.fh.Is(0);ee!==void 0&&ne!==void 0&&this.fh.Rt(ee,ne);const se=this.fh.Is(0),ae=this.fh.au(),le=this.fh.Pe();if(le!==null&&re!==null&&se!==null){const ce=le.Te(ae),he=this.a_.key(re)>this.a_.key(se),fe=te!==null&&te>ae&&!he,Ae=this.fh.W().allowShiftVisibleRangeOnWhitespaceReplacement,pe=ce&&(ne!==void 0||Ae)&&this.fh.W().shiftVisibleRangeOnNewBar;if(fe&&!pe){const Oe=te-ae;this.fh.wn(this.fh.vu()-Oe)}}this.fh.gu(te)}Nh(te){te!==null&&te.Zo()}Un(te){if(function(ne){return ne instanceof gi}(te))return te;const ee=this.Hu.find(ne=>ne.Vt().includes(te));return ee===void 0?null:ee}du(){this.Hu.forEach(te=>te.Zo()),this.Lh()}m(){this.Hu.forEach(te=>te.m()),this.Hu.length=0,this.ks.localization.priceFormatter=void 0,this.ks.localization.percentageFormatter=void 0,this.ks.localization.timeFormatter=void 0}Ic(){return this.Xu}jn(){return this.Xu.W()}Do(){return this.qu}Bc(te,ee){const ne=this.Zu(ee);this.Vc(te,ne),this.Uu.push(te),this.Uu.length===1?this.Ah():this.ar()}Ec(te){const ee=this.Un(te),ne=this.Uu.indexOf(te);o$1(ne!==-1,"Series not found");const re=u$1(ee);this.Uu.splice(ne,1),re.no(te),te.m&&te.m(),this.fh.q_(),this.Ac(re)}Eh(te,ee){const ne=u$1(this.Un(te));ne.no(te,!0),ne.io(te,ee,!0)}Iu(){const te=Z.xn();te._n(),this.sc(te)}zc(te){const ee=Z.xn();ee.dn(te),this.sc(ee)}vn(){const te=Z.xn();te.vn(),this.sc(te)}mn(te){const ee=Z.xn();ee.mn(te),this.sc(ee)}wn(te){const ee=Z.xn();ee.wn(te),this.sc(ee)}fn(te){const ee=Z.xn();ee.fn(te),this.sc(ee)}un(){const te=Z.xn();te.un(),this.sc(te)}Lc(){return this.ks.rightPriceScale.visible?"right":"left"}Oc(te,ee){if(o$1(ee>=0,"Index should be greater or equal to 0"),ee===this.Nc(te))return;const ne=u$1(this.Un(te));ne.no(te);const re=this.Zu(ee);this.Vc(te,re),ne.Pa().length===0&&this.Ac(ne),this.Ah()}j(){return this.tc}Y(){return this.Ju}Yt(te){const ee=this.tc,ne=this.Ju;if(ee===ne)return ee;if(te=Math.max(0,Math.min(100,Math.round(100*te))),this.ju===null||this.ju.wr!==ne||this.ju.Mr!==ee)this.ju={wr:ne,Mr:ee,Wc:new Map};else{const se=this.ju.Wc.get(te);if(se!==void 0)return se}const re=this.Pl.nt(ne,ee,te/100);return this.ju.Wc.set(te,re),re}kc(te){return this.Hu.indexOf(te)}Zi(){return this.Pl}Fc(){return this.Hc()}Hc(te){const ee=new gi(this.fh,this);this.Hu.push(ee);const ne=te??this.Hu.length-1,re=Z.Sn();return re.en(ne,{rn:0,hn:!0}),this.sc(re),ee}Zu(te){return o$1(te>=0,"Index should be greater or equal to 0"),(te=Math.min(this.Hu.length,te))<this.Hu.length?this.Hu[te]:this.Hc(te)}Nc(te){return this.Hu.findIndex(ee=>ee.Lo().includes(te))}vc(te,ee){const ne=new Z(ee);if(te!==null){const re=this.Hu.indexOf(te);ne.en(re,{rn:ee})}return ne}nc(te,ee){return ee===void 0&&(ee=2),this.vc(this.Un(te),ee)}sc(te){this.Ku&&this.Ku(te),this.Hu.forEach(ee=>ee.t_().lr().Rt())}Vc(te,ee){const ne=te.W().priceScaleId,re=ne!==void 0?ne:this.Lc();ee.io(te,re),G(re)||te.hr(te.W())}Qu(te){const ee=this.ks.layout;return ee.background.type==="gradient"?te===0?ee.background.topColor:ee.background.bottomColor:ee.background.color}Ac(te){!te.zo()&&te.Pa().length===0&&this.Hu.length>1&&this.Hu.splice(this.kc(te),1)}}function Oi(ie){return!p(ie)&&!m(ie)}function Ni(ie){return p(ie)}(function(ie){ie[ie.Disabled=0]="Disabled",ie[ie.Continuous=1]="Continuous",ie[ie.OnDataUpdate=2]="OnDataUpdate"})(Vi||(Vi={})),function(ie){ie[ie.LastBar=0]="LastBar",ie[ie.LastVisible=1]="LastVisible"}(Ei||(Ei={})),function(ie){ie.Solid="solid",ie.VerticalGradient="gradient"}(Ai||(Ai={})),function(ie){ie[ie.Year=0]="Year",ie[ie.Month=1]="Month",ie[ie.DayOfMonth=2]="DayOfMonth",ie[ie.Time=3]="Time",ie[ie.TimeWithSeconds=4]="TimeWithSeconds"}(zi||(zi={}));const Wi=ie=>ie.getUTCFullYear();function Fi(ie,te,ee){return te.replace(/yyyy/g,(ne=>Q(Wi(ne),4))(ie)).replace(/yy/g,(ne=>Q(Wi(ne)%100,2))(ie)).replace(/MMMM/g,((ne,re)=>new Date(ne.getUTCFullYear(),ne.getUTCMonth(),1).toLocaleString(re,{month:"long"}))(ie,ee)).replace(/MMM/g,((ne,re)=>new Date(ne.getUTCFullYear(),ne.getUTCMonth(),1).toLocaleString(re,{month:"short"}))(ie,ee)).replace(/MM/g,(ne=>Q((re=>re.getUTCMonth()+1)(ne),2))(ie)).replace(/dd/g,(ne=>Q((re=>re.getUTCDate())(ne),2))(ie))}class Hi{constructor(te="yyyy-MM-dd",ee="default"){this.Uc=te,this.$c=ee}l_(te){return Fi(te,this.Uc,this.$c)}}class Ui{constructor(te){this.qc=te||"%h:%m:%s"}l_(te){return this.qc.replace("%h",Q(te.getUTCHours(),2)).replace("%m",Q(te.getUTCMinutes(),2)).replace("%s",Q(te.getUTCSeconds(),2))}}const $i={Yc:"yyyy-MM-dd",jc:"%h:%m:%s",Kc:" ",Xc:"default"};class qi{constructor(te={}){const ee={...$i,...te};this.Gc=new Hi(ee.Yc,ee.Xc),this.Zc=new Ui(ee.jc),this.Jc=ee.Kc}l_(te){return`${this.Gc.l_(te)}${this.Jc}${this.Zc.l_(te)}`}}function Yi(ie){return 60*ie*60*1e3}function ji(ie){return 60*ie*1e3}const Ki=[{Qc:(Xi=1,1e3*Xi),td:10},{Qc:ji(1),td:20},{Qc:ji(5),td:21},{Qc:ji(30),td:22},{Qc:Yi(1),td:30},{Qc:Yi(3),td:31},{Qc:Yi(6),td:32},{Qc:Yi(12),td:33}];var Xi;function Gi(ie,te){if(ie.getUTCFullYear()!==te.getUTCFullYear())return 70;if(ie.getUTCMonth()!==te.getUTCMonth())return 60;if(ie.getUTCDate()!==te.getUTCDate())return 50;for(let ee=Ki.length-1;ee>=0;--ee)if(Math.floor(te.getTime()/Ki[ee].Qc)!==Math.floor(ie.getTime()/Ki[ee].Qc))return Ki[ee].td;return 0}function Zi(ie){let te=ie;if(m(ie)&&(te=Qi(ie)),!Oi(te))throw new Error("time must be of type BusinessDay");const ee=new Date(Date.UTC(te.year,te.month-1,te.day,0,0,0,0));return{sd:Math.round(ee.getTime()/1e3),nd:te}}function Ji(ie){if(!Ni(ie))throw new Error("time must be of type isUTCTimestamp");return{sd:ie}}function Qi(ie){const te=new Date(ie);if(isNaN(te.getTime()))throw new Error(`Invalid date string=${ie}, expected format=yyyy-mm-dd`);return{day:te.getUTCDate(),month:te.getUTCMonth()+1,year:te.getUTCFullYear()}}function ts(ie){m(ie.time)&&(ie.time=Qi(ie.time))}class is{options(){return this.ks}setOptions(te){this.ks=te,this.updateFormatter(te.localization)}preprocessData(te){Array.isArray(te)?function(ee){ee.forEach(ts)}(te):ts(te)}createConverterToInternalObj(te){return u$1(function(ee){return ee.length===0?null:Oi(ee[0].time)||m(ee[0].time)?Zi:Ji}(te))}key(te){return typeof te=="object"&&"sd"in te?te.sd:this.key(this.convertHorzItemToInternal(te))}cacheKey(te){const ee=te;return ee.nd===void 0?new Date(1e3*ee.sd).getTime():new Date(Date.UTC(ee.nd.year,ee.nd.month-1,ee.nd.day)).getTime()}convertHorzItemToInternal(te){return Ni(ee=te)?Ji(ee):Oi(ee)?Zi(ee):Zi(Qi(ee));var ee}updateFormatter(te){if(!this.ks)return;const ee=te.dateFormat;this.ks.timeScale.timeVisible?this.ed=new qi({Yc:ee,jc:this.ks.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Kc:"   ",Xc:te.locale}):this.ed=new Hi(ee,te.locale)}formatHorzItem(te){const ee=te;return this.ed.l_(new Date(1e3*ee.sd))}formatTickmark(te,ee){const ne=function(se,ae,le){switch(se){case 0:case 10:return ae?le?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return ae?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(te.weight,this.ks.timeScale.timeVisible,this.ks.timeScale.secondsVisible),re=this.ks.timeScale;if(re.tickMarkFormatter!==void 0){const se=re.tickMarkFormatter(te.originalTime,ne,ee.locale);if(se!==null)return se}return function(se,ae,le){const ce={};switch(ae){case 0:ce.year="numeric";break;case 1:ce.month="short";break;case 2:ce.day="numeric";break;case 3:ce.hour12=!1,ce.hour="2-digit",ce.minute="2-digit";break;case 4:ce.hour12=!1,ce.hour="2-digit",ce.minute="2-digit",ce.second="2-digit"}const he=se.nd===void 0?new Date(1e3*se.sd):new Date(Date.UTC(se.nd.year,se.nd.month-1,se.nd.day));return new Date(he.getUTCFullYear(),he.getUTCMonth(),he.getUTCDate(),he.getUTCHours(),he.getUTCMinutes(),he.getUTCSeconds(),he.getUTCMilliseconds()).toLocaleString(le,ce)}(te.time,ne,ee.locale)}maxTickMarkWeight(te){let ee=te.reduce(Di,te[0]).weight;return ee>30&&ee<50&&(ee=30),ee}fillWeightsForPoints(te,ee){(function(ne,re=0){if(ne.length===0)return;let se=re===0?null:ne[re-1].time.sd,ae=se!==null?new Date(1e3*se):null,le=0;for(let ce=re;ce<ne.length;++ce){const he=ne[ce],fe=new Date(1e3*he.time.sd);ae!==null&&(he.timeWeight=Gi(fe,ae)),le+=he.time.sd-(se||he.time.sd),se=he.time.sd,ae=fe}if(re===0&&ne.length>1){const ce=Math.ceil(le/(ne.length-1)),he=new Date(1e3*(ne[0].time.sd-ce));ne[0].timeWeight=Gi(new Date(1e3*ne[0].time.sd),he)}})(te,ee)}static rd(te){return f({localization:{dateFormat:"dd MMM 'yy"}},te??{})}}const ss=typeof window<"u";function ns(){return!!ss&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function es(){return!!ss&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function rs(ie){return ie+ie%2}function hs(ie){ss&&window.chrome!==void 0&&ie.addEventListener("mousedown",te=>{if(te.button===1)return te.preventDefault(),!1})}class as{constructor(te,ee,ne){this.hd=0,this.ad=null,this.ld={dt:Number.NEGATIVE_INFINITY,ft:Number.POSITIVE_INFINITY},this.od=0,this._d=null,this.ud={dt:Number.NEGATIVE_INFINITY,ft:Number.POSITIVE_INFINITY},this.dd=null,this.fd=!1,this.pd=null,this.vd=null,this.md=!1,this.wd=!1,this.Md=!1,this.gd=null,this.bd=null,this.xd=null,this.Sd=null,this.Cd=null,this.Pd=null,this.yd=null,this.kd=0,this.Td=!1,this.Rd=!1,this.Dd=!1,this.Id=0,this.Bd=null,this.Vd=!es(),this.Ed=re=>{this.Ad(re)},this.zd=re=>{if(this.Ld(re)){const se=this.Od(re);if(++this.od,this._d&&this.od>1){const{Nd:ae}=this.Wd(_s(re),this.ud);ae<30&&!this.Md&&this.Fd(se,this.Ud.Hd),this.$d()}}else{const se=this.Od(re);if(++this.hd,this.ad&&this.hd>1){const{Nd:ae}=this.Wd(_s(re),this.ld);ae<5&&!this.wd&&this.qd(se,this.Ud.Yd),this.jd()}}},this.Kd=te,this.Ud=ee,this.ks=ne,this.Xd()}m(){this.gd!==null&&(this.gd(),this.gd=null),this.bd!==null&&(this.bd(),this.bd=null),this.Sd!==null&&(this.Sd(),this.Sd=null),this.Cd!==null&&(this.Cd(),this.Cd=null),this.Pd!==null&&(this.Pd(),this.Pd=null),this.xd!==null&&(this.xd(),this.xd=null),this.Gd(),this.jd()}Zd(te){this.Sd&&this.Sd();const ee=this.Jd.bind(this);if(this.Sd=()=>{this.Kd.removeEventListener("mousemove",ee)},this.Kd.addEventListener("mousemove",ee),this.Ld(te))return;const ne=this.Od(te);this.qd(ne,this.Ud.Qd),this.Vd=!0}jd(){this.ad!==null&&clearTimeout(this.ad),this.hd=0,this.ad=null,this.ld={dt:Number.NEGATIVE_INFINITY,ft:Number.POSITIVE_INFINITY}}$d(){this._d!==null&&clearTimeout(this._d),this.od=0,this._d=null,this.ud={dt:Number.NEGATIVE_INFINITY,ft:Number.POSITIVE_INFINITY}}Jd(te){if(this.Dd||this.vd!==null||this.Ld(te))return;const ee=this.Od(te);this.qd(ee,this.Ud.tf),this.Vd=!0}if(te){const ee=cs(te.changedTouches,u$1(this.Bd));if(ee===null||(this.Id=us(te),this.yd!==null)||this.Rd)return;this.Td=!0;const ne=this.Wd(_s(ee),u$1(this.vd)),{sf:re,nf:se,Nd:ae}=ne;if(this.md||!(ae<5)){if(!this.md){const le=.5*re,ce=se>=le&&!this.ks.ef(),he=le>se&&!this.ks.rf();ce||he||(this.Rd=!0),this.md=!0,this.Md=!0,this.Gd(),this.$d()}if(!this.Rd){const le=this.Od(te,ee);this.Fd(le,this.Ud.hf),os(te)}}}af(te){if(te.button!==0)return;const ee=this.Wd(_s(te),u$1(this.pd)),{Nd:ne}=ee;if(ne>=5&&(this.wd=!0,this.jd()),this.wd){const re=this.Od(te);this.qd(re,this.Ud.lf)}}Wd(te,ee){const ne=Math.abs(ee.dt-te.dt),re=Math.abs(ee.ft-te.ft);return{sf:ne,nf:re,Nd:ne+re}}_f(te){let ee=cs(te.changedTouches,u$1(this.Bd));if(ee===null&&te.touches.length===0&&(ee=te.changedTouches[0]),ee===null)return;this.Bd=null,this.Id=us(te),this.Gd(),this.vd=null,this.Pd&&(this.Pd(),this.Pd=null);const ne=this.Od(te,ee);if(this.Fd(ne,this.Ud.uf),++this.od,this._d&&this.od>1){const{Nd:re}=this.Wd(_s(ee),this.ud);re<30&&!this.Md&&this.Fd(ne,this.Ud.Hd),this.$d()}else this.Md||(this.Fd(ne,this.Ud.cf),this.Ud.cf&&os(te));this.od===0&&os(te),te.touches.length===0&&this.fd&&(this.fd=!1,os(te))}Ad(te){if(te.button!==0)return;const ee=this.Od(te);if(this.pd=null,this.Dd=!1,this.Cd&&(this.Cd(),this.Cd=null),ns()&&this.Kd.ownerDocument.documentElement.removeEventListener("mouseleave",this.Ed),!this.Ld(te))if(this.qd(ee,this.Ud.df),++this.hd,this.ad&&this.hd>1){const{Nd:ne}=this.Wd(_s(te),this.ld);ne<5&&!this.wd&&this.qd(ee,this.Ud.Yd),this.jd()}else this.wd||this.qd(ee,this.Ud.ff)}Gd(){this.dd!==null&&(clearTimeout(this.dd),this.dd=null)}pf(te){if(this.Bd!==null)return;const ee=te.changedTouches[0];this.Bd=ee.identifier,this.Id=us(te);const ne=this.Kd.ownerDocument.documentElement;this.Md=!1,this.md=!1,this.Rd=!1,this.vd=_s(ee),this.Pd&&(this.Pd(),this.Pd=null);{const se=this.if.bind(this),ae=this._f.bind(this);this.Pd=()=>{ne.removeEventListener("touchmove",se),ne.removeEventListener("touchend",ae)},ne.addEventListener("touchmove",se,{passive:!1}),ne.addEventListener("touchend",ae,{passive:!1}),this.Gd(),this.dd=setTimeout(this.vf.bind(this,te),240)}const re=this.Od(te,ee);this.Fd(re,this.Ud.mf),this._d||(this.od=0,this._d=setTimeout(this.$d.bind(this),500),this.ud=_s(ee))}wf(te){if(te.button!==0)return;const ee=this.Kd.ownerDocument.documentElement;ns()&&ee.addEventListener("mouseleave",this.Ed),this.wd=!1,this.pd=_s(te),this.Cd&&(this.Cd(),this.Cd=null);{const re=this.af.bind(this),se=this.Ad.bind(this);this.Cd=()=>{ee.removeEventListener("mousemove",re),ee.removeEventListener("mouseup",se)},ee.addEventListener("mousemove",re),ee.addEventListener("mouseup",se)}if(this.Dd=!0,this.Ld(te))return;const ne=this.Od(te);this.qd(ne,this.Ud.Mf),this.ad||(this.hd=0,this.ad=setTimeout(this.jd.bind(this),500),this.ld=_s(te))}Xd(){this.Kd.addEventListener("mouseenter",this.Zd.bind(this)),this.Kd.addEventListener("touchcancel",this.Gd.bind(this));{const te=this.Kd.ownerDocument,ee=ne=>{this.Ud.gf&&(ne.composed&&this.Kd.contains(ne.composedPath()[0])||ne.target&&this.Kd.contains(ne.target)||this.Ud.gf())};this.bd=()=>{te.removeEventListener("touchstart",ee)},this.gd=()=>{te.removeEventListener("mousedown",ee)},te.addEventListener("mousedown",ee),te.addEventListener("touchstart",ee,{passive:!0})}es()&&(this.xd=()=>{this.Kd.removeEventListener("dblclick",this.zd)},this.Kd.addEventListener("dblclick",this.zd)),this.Kd.addEventListener("mouseleave",this.bf.bind(this)),this.Kd.addEventListener("touchstart",this.pf.bind(this),{passive:!0}),hs(this.Kd),this.Kd.addEventListener("mousedown",this.wf.bind(this)),this.xf(),this.Kd.addEventListener("touchmove",()=>{},{passive:!1})}xf(){this.Ud.Sf===void 0&&this.Ud.Cf===void 0&&this.Ud.Pf===void 0||(this.Kd.addEventListener("touchstart",te=>this.yf(te.touches),{passive:!0}),this.Kd.addEventListener("touchmove",te=>{if(te.touches.length===2&&this.yd!==null&&this.Ud.Cf!==void 0){const ee=ls(te.touches[0],te.touches[1])/this.kd;this.Ud.Cf(this.yd,ee),os(te)}},{passive:!1}),this.Kd.addEventListener("touchend",te=>{this.yf(te.touches)}))}yf(te){te.length===1&&(this.Td=!1),te.length!==2||this.Td||this.fd?this.kf():this.Tf(te)}Tf(te){const ee=this.Kd.getBoundingClientRect()||{left:0,top:0};this.yd={dt:(te[0].clientX-ee.left+(te[1].clientX-ee.left))/2,ft:(te[0].clientY-ee.top+(te[1].clientY-ee.top))/2},this.kd=ls(te[0],te[1]),this.Ud.Sf!==void 0&&this.Ud.Sf(),this.Gd()}kf(){this.yd!==null&&(this.yd=null,this.Ud.Pf!==void 0&&this.Ud.Pf())}bf(te){var ne,re;if(this.Sd&&this.Sd(),this.Ld(te)||!this.Vd||(re=(ne=this.ks).Rf)!=null&&re.call(ne))return;const ee=this.Od(te);this.qd(ee,this.Ud.Df),this.Vd=!es()}vf(te){const ee=cs(te.touches,u$1(this.Bd));if(ee===null)return;const ne=this.Od(te,ee);this.Fd(ne,this.Ud.If),this.Md=!0,this.fd=!0}Ld(te){return te.sourceCapabilities&&te.sourceCapabilities.firesTouchEvents!==void 0?te.sourceCapabilities.firesTouchEvents:us(te)<this.Id+500}Fd(te,ee){ee&&ee.call(this.Ud,te)}qd(te,ee){ee&&ee.call(this.Ud,te)}Od(te,ee){const ne=ee||te,re=this.Kd.getBoundingClientRect()||{left:0,top:0};return{clientX:ne.clientX,clientY:ne.clientY,pageX:ne.pageX,pageY:ne.pageY,screenX:ne.screenX,screenY:ne.screenY,localX:ne.clientX-re.left,localY:ne.clientY-re.top,ctrlKey:te.ctrlKey,altKey:te.altKey,shiftKey:te.shiftKey,metaKey:te.metaKey,Bf:!te.type.startsWith("mouse")&&te.type!=="contextmenu"&&te.type!=="click",Vf:te.type,Ef:ne.target,r_:te.view,Af:()=>{te.type!=="touchstart"&&os(te)}}}}function ls(ie,te){const ee=ie.clientX-te.clientX,ne=ie.clientY-te.clientY;return Math.sqrt(ee*ee+ne*ne)}function os(ie){ie.cancelable&&ie.preventDefault()}function _s(ie){return{dt:ie.pageX,ft:ie.pageY}}function us(ie){return ie.timeStamp||performance.now()}function cs(ie,te){for(let ee=0;ee<ie.length;++ee)if(ie[ee].identifier===te)return ie[ee];return null}class ds{constructor(te,ee,ne){this.zf=null,this.Lf=null,this.Of=!0,this.Nf=null,this.Wf=te,this.Ff=te.Hf()[ee],this.Uf=te.Hf()[ne],this.$f=document.createElement("tr"),this.$f.style.height="1px",this.qf=document.createElement("td"),this.qf.style.position="relative",this.qf.style.padding="0",this.qf.style.margin="0",this.qf.setAttribute("colspan","3"),this.Yf(),this.$f.appendChild(this.qf),this.Of=this.Wf.W().layout.panes.enableResize,this.Of?this.jf():(this.zf=null,this.Lf=null)}m(){this.Lf!==null&&this.Lf.m()}Kf(){return this.$f}Xf(){return size({width:this.Ff.Xf().width,height:1})}Gf(){return size({width:this.Ff.Gf().width,height:1*window.devicePixelRatio})}Zf(te,ee,ne){const re=this.Gf();te.fillStyle=this.Wf.W().layout.panes.separatorColor,te.fillRect(ee,ne,re.width,re.height)}Rt(){this.Yf(),this.Wf.W().layout.panes.enableResize!==this.Of&&(this.Of=this.Wf.W().layout.panes.enableResize,this.Of?this.jf():(this.zf!==null&&(this.qf.removeChild(this.zf.Jf),this.qf.removeChild(this.zf.Qf),this.zf=null),this.Lf!==null&&(this.Lf.m(),this.Lf=null)))}jf(){const te=document.createElement("div"),ee=te.style;ee.position="fixed",ee.display="none",ee.zIndex="49",ee.top="0",ee.left="0",ee.width="100%",ee.height="100%",ee.cursor="row-resize",this.qf.appendChild(te);const ne=document.createElement("div"),re=ne.style;re.position="absolute",re.zIndex="50",re.top="-4px",re.height="9px",re.width="100%",re.backgroundColor="",re.cursor="row-resize",this.qf.appendChild(ne);const se={Qd:this.tp.bind(this),Df:this.ip.bind(this),Mf:this.sp.bind(this),mf:this.sp.bind(this),lf:this.np.bind(this),hf:this.np.bind(this),df:this.ep.bind(this),uf:this.ep.bind(this)};this.Lf=new as(ne,se,{ef:()=>!1,rf:()=>!0}),this.zf={Qf:ne,Jf:te}}Yf(){this.qf.style.background=this.Wf.W().layout.panes.separatorColor}tp(te){this.zf!==null&&(this.zf.Qf.style.backgroundColor=this.Wf.W().layout.panes.separatorHoverColor)}ip(te){this.zf!==null&&this.Nf===null&&(this.zf.Qf.style.backgroundColor="")}sp(te){if(this.zf===null)return;const ee=this.Ff.rp().Io()+this.Uf.rp().Io(),ne=ee/(this.Ff.Xf().height+this.Uf.Xf().height),re=30*ne;ee<=2*re||(this.Nf={hp:te.pageY,ap:this.Ff.rp().Io(),lp:ee-re,op:ee,_p:ne,up:re},this.zf.Jf.style.display="block")}np(te){const ee=this.Nf;if(ee===null)return;const ne=(te.pageY-ee.hp)*ee._p,re=Gt(ee.ap+ne,ee.up,ee.lp);this.Ff.rp().Bo(re),this.Uf.rp().Bo(ee.op-re),this.Wf.si().Ah()}ep(te){this.Nf!==null&&this.zf!==null&&(this.Nf=null,this.zf.Jf.style.display="none")}}function fs(ie,te){return ie.cp-te.cp}function ps(ie,te,ee){const ne=(ie.cp-te.cp)/(ie.bt-te.bt);return Math.sign(ne)*Math.min(Math.abs(ne),ee)}class vs{constructor(te,ee,ne,re){this.dp=null,this.fp=null,this.pp=null,this.vp=null,this.mp=null,this.wp=0,this.Mp=0,this.gp=te,this.bp=ee,this.xp=ne,this.Cn=re}Sp(te,ee){if(this.dp!==null){if(this.dp.bt===ee)return void(this.dp.cp=te);if(Math.abs(this.dp.cp-te)<this.Cn)return}this.vp=this.pp,this.pp=this.fp,this.fp=this.dp,this.dp={bt:ee,cp:te}}le(te,ee){if(this.dp===null||this.fp===null||ee-this.dp.bt>50)return;let ne=0;const re=ps(this.dp,this.fp,this.bp),se=fs(this.dp,this.fp),ae=[re],le=[se];if(ne+=se,this.pp!==null){const he=ps(this.fp,this.pp,this.bp);if(Math.sign(he)===Math.sign(re)){const fe=fs(this.fp,this.pp);if(ae.push(he),le.push(fe),ne+=fe,this.vp!==null){const Ae=ps(this.pp,this.vp,this.bp);if(Math.sign(Ae)===Math.sign(re)){const pe=fs(this.pp,this.vp);ae.push(Ae),le.push(pe),ne+=pe}}}}let ce=0;for(let he=0;he<ae.length;++he)ce+=le[he]/ne*ae[he];Math.abs(ce)<this.gp||(this.mp={cp:te,bt:ee},this.Mp=ce,this.wp=function(he,fe){const Ae=Math.log(fe);return Math.log(1*Ae/-he)/Ae}(Math.abs(ce),this.xp))}Ns(te){const ee=u$1(this.mp),ne=te-ee.bt;return ee.cp+this.Mp*(Math.pow(this.xp,ne)-1)/Math.log(this.xp)}yu(te){return this.mp===null||this.Cp(te)===this.wp}Cp(te){const ee=te-u$1(this.mp).bt;return Math.min(ee,this.wp)}}function ms(ie,te){const ee=u$1(ie.ownerDocument).createElement("canvas");ie.appendChild(ee);const ne=bindTo(ee,{options:{allowResizeObserver:!0},transform:(re,se)=>({width:Math.max(re.width,se.width),height:Math.max(re.height,se.height)})});return ne.resizeCanvasElement(te),ne}function ws(ie){var te;ie.width=1,ie.height=1,(te=ie.getContext("2d"))==null||te.clearRect(0,0,1,1)}function Ms(ie,te,ee,ne){ie.sh&&ie.sh(te,ee,ne)}function gs(ie,te,ee,ne){ie.ht(te,ee,ne)}function bs(ie,te,ee,ne){const re=ie(ee,ne);for(const se of re){const ae=se.It(ne);ae!==null&&te(ae)}}function xs(ie,te){return ee=>{var ne,re;return function(se){return se.Ut!==void 0}(ee)?(((ne=ee.Ut())==null?void 0:ne.xa())??"")!==te?[]:((re=ee.na)==null?void 0:re.call(ee,ie))??[]:[]}}function Ss(ie,te,ee,ne){if(!ie.length)return;let re=0;const se=ie[0].jt(ne,!0);let ae=te===1?ee/2-(ie[0].Hi()-se/2):ie[0].Hi()-se/2-ee/2;ae=Math.max(0,ae);for(let le=1;le<ie.length;le++){const ce=ie[le],he=ie[le-1],fe=he.jt(ne,!1),Ae=ce.Hi(),pe=he.Hi();if(te===1?Ae>pe-fe:Ae<pe+fe){const Oe=pe-fe*te;ce.Ui(Oe);const Fe=Oe-te*fe/2;if((te===1?Fe<0:Fe>ee)&&ae>0){const Ne=te===1?-1-Fe:Fe-ee,ze=Math.min(Ne,ae);for(let He=re;He<ie.length;He++)ie[He].Ui(ie[He].Hi()+te*ze);ae-=ze}}else re=le,ae=te===1?pe-fe-Ae:Ae-(pe+fe)}}class Cs{constructor(te,ee,ne,re){this.Ki=null,this.Pp=null,this.yp=!1,this.kp=new et(200),this.Tp=null,this.Rp=0,this.Dp=!1,this.Ip=()=>{this.Dp||this.Tt.Bp().si().ar()},this.Vp=()=>{this.Dp||this.Tt.Bp().si().ar()},this.Tt=te,this.ks=ee,this.Sl=ee.layout,this.Xu=ne,this.Ep=re==="left",this.Ap=xs("normal",re),this.zp=xs("top",re),this.Lp=xs("bottom",re),this.qf=document.createElement("div"),this.qf.style.height="100%",this.qf.style.overflow="hidden",this.qf.style.width="25px",this.qf.style.left="0",this.qf.style.position="relative",this.Op=ms(this.qf,size({width:16,height:16})),this.Op.subscribeSuggestedBitmapSizeChanged(this.Ip);const se=this.Op.canvasElement;se.style.position="absolute",se.style.zIndex="1",se.style.left="0",se.style.top="0",this.Np=ms(this.qf,size({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Vp);const ae=this.Np.canvasElement;ae.style.position="absolute",ae.style.zIndex="2",ae.style.left="0",ae.style.top="0";const le={Mf:this.sp.bind(this),mf:this.sp.bind(this),lf:this.np.bind(this),hf:this.np.bind(this),gf:this.Wp.bind(this),df:this.ep.bind(this),uf:this.ep.bind(this),Yd:this.Fp.bind(this),Hd:this.Fp.bind(this),Qd:this.Hp.bind(this),Df:this.ip.bind(this)};this.Lf=new as(this.Np.canvasElement,le,{ef:()=>!this.ks.handleScroll.vertTouchDrag,rf:()=>!0})}m(){this.Lf.m(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Vp),ws(this.Np.canvasElement),this.Np.dispose(),this.Op.unsubscribeSuggestedBitmapSizeChanged(this.Ip),ws(this.Op.canvasElement),this.Op.dispose(),this.Ki!==null&&this.Ki.ro().u(this),this.Ki=null}Kf(){return this.qf}P(){return this.Sl.fontSize}Up(){const te=this.Xu.W();return this.Tp!==te.k&&(this.kp.reset(),this.Tp=te.k),te}$p(){if(this.Ki===null)return 0;let te=0;const ee=this.Up(),ne=u$1(this.Op.canvasElement.getContext("2d",{colorSpace:this.Tt.Bp().W().layout.colorSpace}));ne.save();const re=this.Ki.Aa();ne.font=this.qp(),re.length>0&&(te=Math.max(this.kp.measureText(ne,re[0].Qa),this.kp.measureText(ne,re[re.length-1].Qa)));const se=this.Yp();for(let he=se.length;he--;){const fe=this.kp.measureText(ne,se[he].li());fe>te&&(te=fe)}const ae=this.Ki.Nt();if(ae!==null&&this.Pp!==null&&(le=this.ks.crosshair).mode!==2&&le.horzLine.visible&&le.horzLine.labelVisible){const he=this.Ki.Ds(1,ae),fe=this.Ki.Ds(this.Pp.height-2,ae);te=Math.max(te,this.kp.measureText(ne,this.Ki.Ji(Math.floor(Math.min(he,fe))+.11111111111111,ae)),this.kp.measureText(ne,this.Ki.Ji(Math.ceil(Math.max(he,fe))-.11111111111111,ae)))}var le;ne.restore();const ce=te||34;return rs(Math.ceil(ee.S+ee.C+ee.V+ee.A+5+ce))}jp(te){this.Pp!==null&&equalSizes(this.Pp,te)||(this.Pp=te,this.Dp=!0,this.Op.resizeCanvasElement(te),this.Np.resizeCanvasElement(te),this.Dp=!1,this.qf.style.width=`${te.width}px`,this.qf.style.height=`${te.height}px`)}Kp(){return u$1(this.Pp).width}cs(te){this.Ki!==te&&(this.Ki!==null&&this.Ki.ro().u(this),this.Ki=te,te.ro().i(this.dl.bind(this),this))}Ut(){return this.Ki}Xp(){const te=this.Tt.rp();this.Tt.Bp().si().Xo(te,u$1(this.Ut()))}Gp(te){if(this.Pp===null)return;const ee={colorSpace:this.Tt.Bp().W().layout.colorSpace};if(te!==1){this.Zp(),this.Op.applySuggestedBitmapSize();const re=tryCreateCanvasRenderingTarget2D(this.Op,ee);re!==null&&(re.useBitmapCoordinateSpace(se=>{this.Jp(se),this.Qp(se)}),this.Tt.tv(re,this.Lp),this.iv(re),this.Tt.tv(re,this.Ap),this.sv(re))}this.Np.applySuggestedBitmapSize();const ne=tryCreateCanvasRenderingTarget2D(this.Np,ee);ne!==null&&(ne.useBitmapCoordinateSpace(({context:re,bitmapSize:se})=>{re.clearRect(0,0,se.width,se.height)}),this.nv(ne),this.Tt.tv(ne,this.zp))}Gf(){return this.Op.bitmapSize}Zf(te,ee,ne){const re=this.Gf();re.width>0&&re.height>0&&te.drawImage(this.Op.canvasElement,ee,ne)}Rt(){var te;(te=this.Ki)==null||te.Aa()}sp(te){if(this.Ki===null||this.Ki.Gi()||!this.ks.handleScale.axisPressedMouseMove.price)return;const ee=this.Tt.Bp().si(),ne=this.Tt.rp();this.yp=!0,ee.Ho(ne,this.Ki,te.localY)}np(te){if(this.Ki===null||!this.ks.handleScale.axisPressedMouseMove.price)return;const ee=this.Tt.Bp().si(),ne=this.Tt.rp(),re=this.Ki;ee.Uo(ne,re,te.localY)}Wp(){if(this.Ki===null||!this.ks.handleScale.axisPressedMouseMove.price)return;const te=this.Tt.Bp().si(),ee=this.Tt.rp(),ne=this.Ki;this.yp&&(this.yp=!1,te.$o(ee,ne))}ep(te){if(this.Ki===null||!this.ks.handleScale.axisPressedMouseMove.price)return;const ee=this.Tt.Bp().si(),ne=this.Tt.rp();this.yp=!1,ee.$o(ne,this.Ki)}Fp(te){this.ks.handleScale.axisDoubleClickReset.price&&this.Xp()}Hp(te){this.Ki!==null&&(!this.Tt.Bp().si().W().handleScale.axisPressedMouseMove.price||this.Ki.Le()||this.Ki.Vl()||this.ev(1))}ip(te){this.ev(0)}Yp(){const te=[],ee=this.Ki===null?void 0:this.Ki;return(ne=>{for(let re=0;re<ne.length;++re){const se=ne[re].qs(this.Tt.rp(),ee);for(let ae=0;ae<se.length;ae++)te.push(se[ae])}})(this.Tt.rp().Vt()),te}Jp({context:te,bitmapSize:ee}){const{width:ne,height:re}=ee,se=this.Up().D,ae=this.Up().I;se===ae?L(te,0,0,ne,re,se):W(te,0,0,ne,re,se,ae)}Qp({context:te,bitmapSize:ee,horizontalPixelRatio:ne}){if(this.Pp===null||this.Ki===null||!this.Ki.W().borderVisible)return;te.fillStyle=this.Ki.W().borderColor;const re=Math.max(1,Math.floor(this.Up().S*ne));let se;se=this.Ep?ee.width-re:0,te.fillRect(se,0,re,ee.height)}iv(te){if(this.Pp===null||this.Ki===null)return;const ee=this.Ki.Aa(),ne=this.Ki.W(),re=this.Up(),se=this.Ep?this.Pp.width-re.C:0;ne.borderVisible&&ne.ticksVisible&&te.useBitmapCoordinateSpace(({context:ae,horizontalPixelRatio:le,verticalPixelRatio:ce})=>{ae.fillStyle=ne.borderColor;const he=Math.max(1,Math.floor(ce)),fe=Math.floor(.5*ce),Ae=Math.round(re.C*le);ae.beginPath();for(const pe of ee)ae.rect(Math.floor(se*le),Math.round(pe.Da*ce)-fe,Ae,he);ae.fill()}),te.useMediaCoordinateSpace(({context:ae})=>{ae.font=this.qp(),ae.fillStyle=ne.textColor??this.Sl.textColor,ae.textAlign=this.Ep?"right":"left",ae.textBaseline="middle";const le=this.Ep?Math.round(se-re.V):Math.round(se+re.C+re.V),ce=ee.map(he=>this.kp.yMidCorrection(ae,he.Qa));for(let he=ee.length;he--;){const fe=ee[he];ae.fillText(fe.Qa,le,fe.Da+ce[he])}})}Zp(){if(this.Pp===null||this.Ki===null)return;let te=this.Pp.height/2;const ee=[],ne=this.Ki.Vt().slice(),re=this.Tt.rp(),se=this.Up();this.Ki===re.qn()&&this.Tt.rp().Vt().forEach(ce=>{re.$n(ce)&&ne.push(ce)});const ae=this.Ki.Pa()[0],le=this.Ki;ne.forEach(ce=>{const he=ce.qs(re,le);he.forEach(fe=>{fe.Ui(null),fe.$i()&&ee.push(fe)}),ae===ce&&he.length>0&&(te=he[0].Ai())}),ee.forEach(ce=>ce.Ui(ce.Ai())),this.Ki.W().alignLabels&&this.rv(ee,se,te)}rv(te,ee,ne){if(this.Pp===null)return;const re=te.filter(ae=>ae.Ai()<=ne),se=te.filter(ae=>ae.Ai()>ne);re.sort((ae,le)=>le.Ai()-ae.Ai()),re.length&&se.length&&se.push(re[0]),se.sort((ae,le)=>ae.Ai()-le.Ai());for(const ae of te){const le=Math.floor(ae.jt(ee)/2),ce=ae.Ai();ce>-le&&ce<le&&ae.Ui(le),ce>this.Pp.height-le&&ce<this.Pp.height+le&&ae.Ui(this.Pp.height-le)}Ss(re,1,this.Pp.height,ee),Ss(se,-1,this.Pp.height,ee)}sv(te){if(this.Pp===null)return;const ee=this.Yp(),ne=this.Up(),re=this.Ep?"right":"left";ee.forEach(se=>{se.qi()&&se.It(u$1(this.Ki)).ht(te,ne,this.kp,re)})}nv(te){if(this.Pp===null||this.Ki===null)return;const ee=this.Tt.Bp().si(),ne=[],re=this.Tt.rp(),se=ee.lc().qs(re,this.Ki);se.length&&ne.push(se);const ae=this.Up(),le=this.Ep?"right":"left";ne.forEach(ce=>{ce.forEach(he=>{he.It(u$1(this.Ki)).ht(te,ae,this.kp,le)})})}ev(te){this.qf.style.cursor=te===1?"ns-resize":"default"}dl(){const te=this.$p();this.Rp<te&&this.Tt.Bp().si().Ah(),this.Rp=te}qp(){return S$1(this.Sl.fontSize,this.Sl.fontFamily)}}function Ps(ie,te){var ee;return((ee=ie.ta)==null?void 0:ee.call(ie,te))??[]}function ys(ie,te){var ee;return((ee=ie.sa)==null?void 0:ee.call(ie,te))??[]}function ks(ie,te){var ee;return((ee=ie.$s)==null?void 0:ee.call(ie,te))??[]}function Ts(ie,te){var ee;return((ee=ie.ds)==null?void 0:ee.call(ie,te))??[]}function Rs(ie,te){var ee;return((ee=ie.Zh)==null?void 0:ee.call(ie,te))??[]}class Ds{constructor(te,ee){this.Pp=size({width:0,height:0}),this.hv=null,this.av=null,this.lv=null,this.ov=!1,this._v=new d$1,this.uv=new d$1,this.cv=0,this.dv=!1,this.fv=null,this.pv=!1,this.vv=null,this.mv=null,this.Dp=!1,this.Ip=()=>{this.Dp||this.wv===null||this.ns().ar()},this.Vp=()=>{this.Dp||this.wv===null||this.ns().ar()},this.Mv=te,this.wv=ee,this.wv.Qo().i(this.gv.bind(this),this,!0),this.bv=document.createElement("td"),this.bv.style.padding="0",this.bv.style.position="relative";const ne=document.createElement("div");ne.style.width="100%",ne.style.height="100%",ne.style.position="relative",ne.style.overflow="hidden",this.xv=document.createElement("td"),this.xv.style.padding="0",this.Sv=document.createElement("td"),this.Sv.style.padding="0",this.bv.appendChild(ne),this.Op=ms(ne,size({width:16,height:16})),this.Op.subscribeSuggestedBitmapSizeChanged(this.Ip);const re=this.Op.canvasElement;re.style.position="absolute",re.style.zIndex="1",re.style.left="0",re.style.top="0",this.Np=ms(ne,size({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Vp);const se=this.Np.canvasElement;se.style.position="absolute",se.style.zIndex="2",se.style.left="0",se.style.top="0",this.$f=document.createElement("tr"),this.$f.appendChild(this.xv),this.$f.appendChild(this.bv),this.$f.appendChild(this.Sv),this.Cv(),this.Lf=new as(this.Np.canvasElement,this,{ef:()=>this.fv===null&&!this.Mv.W().handleScroll.vertTouchDrag,rf:()=>this.fv===null&&!this.Mv.W().handleScroll.horzTouchDrag,Rf:this.Mv.W().preventLeave})}m(){this.hv!==null&&this.hv.m(),this.av!==null&&this.av.m(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Vp),ws(this.Np.canvasElement),this.Np.dispose(),this.Op.unsubscribeSuggestedBitmapSizeChanged(this.Ip),ws(this.Op.canvasElement),this.Op.dispose(),this.wv!==null&&(this.wv.Qo().u(this),this.wv.m()),this.Lf.m()}rp(){return u$1(this.wv)}Pv(te){this.wv!==null&&this.wv.Qo().u(this),this.wv=te,this.wv!==null&&this.wv.Qo().i(Ds.prototype.gv.bind(this),this,!0),this.Cv()}Bp(){return this.Mv}Kf(){return this.$f}Cv(){if(this.wv!==null&&(this.yv(),this.ns().Zs().length!==0)){if(this.hv!==null){const te=this.wv.Wo();this.hv.cs(u$1(te))}if(this.av!==null){const te=this.wv.Fo();this.av.cs(u$1(te))}}}kv(){this.hv!==null&&this.hv.Rt(),this.av!==null&&this.av.Rt()}Io(){return this.wv!==null?this.wv.Io():0}Bo(te){this.wv&&this.wv.Bo(te)}Qd(te){if(!this.wv)return;this.Tv();const ee=te.localX,ne=te.localY;this.Rv(ee,ne,te)}Mf(te){this.Tv(),this.Dv(),this.Rv(te.localX,te.localY,te)}tf(te){if(!this.wv)return;this.Tv();const ee=te.localX,ne=te.localY;this.Rv(ee,ne,te)}ff(te){this.wv!==null&&(this.Tv(),this.Iv(te))}Yd(te){this.wv!==null&&this.Bv(this.uv,te)}Hd(te){this.Yd(te)}lf(te){this.Tv(),this.Vv(te),this.Rv(te.localX,te.localY,te)}df(te){this.wv!==null&&(this.Tv(),this.dv=!1,this.Ev(te))}cf(te){this.wv!==null&&this.Iv(te)}If(te){if(this.dv=!0,this.fv===null){const ee={x:te.localX,y:te.localY};this.Av(ee,ee,te)}}Df(te){this.wv!==null&&(this.Tv(),this.wv.si().rc(null),this.zv())}Lv(){return this._v}Ov(){return this.uv}Sf(){this.cv=1,this.ns().un()}Cf(te,ee){if(!this.Mv.W().handleScale.pinch)return;const ne=5*(ee-this.cv);this.cv=ee,this.ns().wc(te.dt,ne)}mf(te){this.dv=!1,this.pv=this.fv!==null,this.Dv();const ee=this.ns().lc();this.fv!==null&&ee.Et()&&(this.vv={x:ee.ri(),y:ee.hi()},this.fv={x:te.localX,y:te.localY})}hf(te){if(this.wv===null)return;const ee=te.localX,ne=te.localY;if(this.fv===null)this.Vv(te);else{this.pv=!1;const re=u$1(this.vv),se=re.x+(ee-this.fv.x),ae=re.y+(ne-this.fv.y);this.Rv(se,ae,te)}}uf(te){this.Bp().W().trackingMode.exitMode===0&&(this.pv=!0),this.Nv(),this.Ev(te)}Kn(te,ee){const ne=this.wv;return ne===null?null:Ci(ne,te,ee)}Wv(te,ee){u$1(ee==="left"?this.hv:this.av).jp(size({width:te,height:this.Pp.height}))}Xf(){return this.Pp}jp(te){equalSizes(this.Pp,te)||(this.Pp=te,this.Dp=!0,this.Op.resizeCanvasElement(te),this.Np.resizeCanvasElement(te),this.Dp=!1,this.bv.style.width=te.width+"px",this.bv.style.height=te.height+"px")}Fv(){const te=u$1(this.wv);te.No(te.Wo()),te.No(te.Fo());for(const ee of te.Pa())if(te.$n(ee)){const ne=ee.Ut();ne!==null&&te.No(ne),ee.Us()}for(const ee of te.va())ee.Us()}Gf(){return this.Op.bitmapSize}Zf(te,ee,ne){const re=this.Gf();re.width>0&&re.height>0&&te.drawImage(this.Op.canvasElement,ee,ne)}Gp(te){if(te===0||this.wv===null)return;te>1&&this.Fv(),this.hv!==null&&this.hv.Gp(te),this.av!==null&&this.av.Gp(te);const ee={colorSpace:this.Mv.W().layout.colorSpace};if(te!==1){this.Op.applySuggestedBitmapSize();const re=tryCreateCanvasRenderingTarget2D(this.Op,ee);re!==null&&(re.useBitmapCoordinateSpace(se=>{this.Jp(se)}),this.wv&&(this.Hv(re,Ps),this.Uv(re),this.Hv(re,ys),this.Hv(re,ks),this.Hv(re,Ts)))}this.Np.applySuggestedBitmapSize();const ne=tryCreateCanvasRenderingTarget2D(this.Np,ee);ne!==null&&(ne.useBitmapCoordinateSpace(({context:re,bitmapSize:se})=>{re.clearRect(0,0,se.width,se.height)}),this.$v(ne),this.Hv(ne,Rs),this.Hv(ne,Ts))}qv(){return this.hv}Yv(){return this.av}tv(te,ee){this.Hv(te,ee)}gv(){this.wv!==null&&this.wv.Qo().u(this),this.wv=null}Iv(te){this.Bv(this._v,te)}Bv(te,ee){const ne=ee.localX,re=ee.localY;te.v()&&te.p(this.ns().Lt().ou(ne),{x:ne,y:re},ee)}Jp({context:te,bitmapSize:ee}){const{width:ne,height:re}=ee,se=this.ns(),ae=se.Y(),le=se.j();ae===le?L(te,0,0,ne,re,le):W(te,0,0,ne,re,ae,le)}Uv(te){const ee=u$1(this.wv),ne=ee.t_().lr().It(ee);ne!==null&&ne.ht(te,!1)}$v(te){this.jv(te,ks,gs,this.ns().lc())}Hv(te,ee){const ne=u$1(this.wv),re=ne.Vt(),se=ne.va();for(const ae of se)this.jv(te,ee,Ms,ae);for(const ae of re)this.jv(te,ee,Ms,ae);for(const ae of se)this.jv(te,ee,gs,ae);for(const ae of re)this.jv(te,ee,gs,ae)}jv(te,ee,ne,re){const se=u$1(this.wv),ae=se.si().ec(),le=ae!==null&&ae.i_===re,ce=ae!==null&&le&&ae.s_!==void 0?ae.s_.hitTestData:void 0;bs(ee,he=>ne(he,te,le,ce),re,se)}yv(){if(this.wv===null)return;const te=this.Mv,ee=this.wv.Wo().W().visible,ne=this.wv.Fo().W().visible;ee||this.hv===null||(this.xv.removeChild(this.hv.Kf()),this.hv.m(),this.hv=null),ne||this.av===null||(this.Sv.removeChild(this.av.Kf()),this.av.m(),this.av=null);const re=te.si().Ic();ee&&this.hv===null&&(this.hv=new Cs(this,te.W(),re,"left"),this.xv.appendChild(this.hv.Kf())),ne&&this.av===null&&(this.av=new Cs(this,te.W(),re,"right"),this.Sv.appendChild(this.av.Kf()))}Kv(te){return te.Bf&&this.dv||this.fv!==null}Xv(te){return Math.max(0,Math.min(te,this.Pp.width-1))}Gv(te){return Math.max(0,Math.min(te,this.Pp.height-1))}Rv(te,ee,ne){this.ns().Pc(this.Xv(te),this.Gv(ee),ne,u$1(this.wv))}zv(){this.ns().Rc()}Nv(){this.pv&&(this.fv=null,this.zv())}Av(te,ee,ne){this.fv=te,this.pv=!1,this.Rv(ee.x,ee.y,ne);const re=this.ns().lc();this.vv={x:re.ri(),y:re.hi()}}ns(){return this.Mv.si()}Ev(te){if(!this.ov)return;const ee=this.ns(),ne=this.rp();if(ee.jo(ne,ne.Rs()),this.lv=null,this.ov=!1,ee.xc(),this.mv!==null){const re=performance.now(),se=ee.Lt();this.mv.le(se.vu(),re),this.mv.yu(re)||ee.fn(this.mv)}}Tv(){this.fv=null}Dv(){this.wv&&(this.ns().un(),!this.wv.Rs().Gi()&&this.ns().Lt().Gi())}Vv(te){if(this.wv===null)return;const ee=this.ns(),ne=ee.Lt();if(ne.Gi())return;const re=this.Mv.W(),se=re.handleScroll,ae=re.kineticScroll;if((!se.pressedMouseMove||te.Bf)&&(!se.horzTouchDrag&&!se.vertTouchDrag||!te.Bf))return;const le=this.wv.Rs(),ce=performance.now();if(this.lv!==null||this.Kv(te)||(this.lv={x:te.clientX,y:te.clientY,sd:ce,Zv:te.localX,Jv:te.localY}),this.lv!==null&&!this.ov&&(this.lv.x!==te.clientX||this.lv.y!==te.clientY)){if(te.Bf&&ae.touch||!te.Bf&&ae.mouse){const he=ne.fu();this.mv=new vs(.2/he,7/he,.997,15/he),this.mv.Sp(ne.vu(),this.lv.sd)}else this.mv=null;le.Gi()||ee.qo(this.wv,le,te.localY),ee.gc(te.localX),this.ov=!0}this.ov&&(le.Gi()||ee.Yo(this.wv,le,te.localY),ee.bc(te.localX),this.mv!==null&&this.mv.Sp(ne.vu(),ce))}}class Is{constructor(te,ee,ne,re,se){this.yt=!0,this.Pp=size({width:0,height:0}),this.Ip=()=>this.Gp(3),this.Ep=te==="left",this.Xu=ne.Ic,this.ks=ee,this.Qv=re,this.tm=se,this.qf=document.createElement("div"),this.qf.style.width="25px",this.qf.style.height="100%",this.qf.style.overflow="hidden",this.Op=ms(this.qf,size({width:16,height:16})),this.Op.subscribeSuggestedBitmapSizeChanged(this.Ip)}m(){this.Op.unsubscribeSuggestedBitmapSizeChanged(this.Ip),ws(this.Op.canvasElement),this.Op.dispose()}Kf(){return this.qf}Xf(){return this.Pp}jp(te){equalSizes(this.Pp,te)||(this.Pp=te,this.Op.resizeCanvasElement(te),this.qf.style.width=`${te.width}px`,this.qf.style.height=`${te.height}px`,this.yt=!0)}Gp(te){if(te<3&&!this.yt||this.Pp.width===0||this.Pp.height===0)return;this.yt=!1,this.Op.applySuggestedBitmapSize();const ee=tryCreateCanvasRenderingTarget2D(this.Op,{colorSpace:this.ks.layout.colorSpace});ee!==null&&ee.useBitmapCoordinateSpace(ne=>{this.Jp(ne),this.Qp(ne)})}Gf(){return this.Op.bitmapSize}Zf(te,ee,ne){const re=this.Gf();re.width>0&&re.height>0&&te.drawImage(this.Op.canvasElement,ee,ne)}Qp({context:te,bitmapSize:ee,horizontalPixelRatio:ne,verticalPixelRatio:re}){if(!this.Qv())return;te.fillStyle=this.ks.timeScale.borderColor;const se=Math.floor(this.Xu.W().S*ne),ae=Math.floor(this.Xu.W().S*re),le=this.Ep?ee.width-se:0;te.fillRect(le,0,se,ae)}Jp({context:te,bitmapSize:ee}){L(te,0,0,ee.width,ee.height,this.tm())}}function Bs(ie){return te=>{var ee;return((ee=te.ea)==null?void 0:ee.call(te,ie))??[]}}const Vs=Bs("normal"),Es=Bs("top"),As=Bs("bottom");class zs{constructor(te,ee){this.im=null,this.sm=null,this.M=null,this.nm=!1,this.Pp=size({width:0,height:0}),this.rm=new d$1,this.kp=new et(5),this.Dp=!1,this.Ip=()=>{this.Dp||this.Mv.si().ar()},this.Vp=()=>{this.Dp||this.Mv.si().ar()},this.Mv=te,this.a_=ee,this.ks=te.W().layout,this.hm=document.createElement("tr"),this.am=document.createElement("td"),this.am.style.padding="0",this.lm=document.createElement("td"),this.lm.style.padding="0",this.qf=document.createElement("td"),this.qf.style.height="25px",this.qf.style.padding="0",this.om=document.createElement("div"),this.om.style.width="100%",this.om.style.height="100%",this.om.style.position="relative",this.om.style.overflow="hidden",this.qf.appendChild(this.om),this.Op=ms(this.om,size({width:16,height:16})),this.Op.subscribeSuggestedBitmapSizeChanged(this.Ip);const ne=this.Op.canvasElement;ne.style.position="absolute",ne.style.zIndex="1",ne.style.left="0",ne.style.top="0",this.Np=ms(this.om,size({width:16,height:16})),this.Np.subscribeSuggestedBitmapSizeChanged(this.Vp);const re=this.Np.canvasElement;re.style.position="absolute",re.style.zIndex="2",re.style.left="0",re.style.top="0",this.hm.appendChild(this.am),this.hm.appendChild(this.qf),this.hm.appendChild(this.lm),this._m(),this.Mv.si().Do().i(this._m.bind(this),this),this.Lf=new as(this.Np.canvasElement,this,{ef:()=>!0,rf:()=>!this.Mv.W().handleScroll.horzTouchDrag})}m(){this.Lf.m(),this.im!==null&&this.im.m(),this.sm!==null&&this.sm.m(),this.Np.unsubscribeSuggestedBitmapSizeChanged(this.Vp),ws(this.Np.canvasElement),this.Np.dispose(),this.Op.unsubscribeSuggestedBitmapSizeChanged(this.Ip),ws(this.Op.canvasElement),this.Op.dispose()}Kf(){return this.hm}um(){return this.im}dm(){return this.sm}Mf(te){if(this.nm)return;this.nm=!0;const ee=this.Mv.si();!ee.Lt().Gi()&&this.Mv.W().handleScale.axisPressedMouseMove.time&&ee.mc(te.localX)}mf(te){this.Mf(te)}gf(){const te=this.Mv.si();!te.Lt().Gi()&&this.nm&&(this.nm=!1,this.Mv.W().handleScale.axisPressedMouseMove.time&&te.Cc())}lf(te){const ee=this.Mv.si();!ee.Lt().Gi()&&this.Mv.W().handleScale.axisPressedMouseMove.time&&ee.Sc(te.localX)}hf(te){this.lf(te)}df(){this.nm=!1;const te=this.Mv.si();te.Lt().Gi()&&!this.Mv.W().handleScale.axisPressedMouseMove.time||te.Cc()}uf(){this.df()}Yd(){this.Mv.W().handleScale.axisDoubleClickReset.time&&this.Mv.si().vn()}Hd(){this.Yd()}Qd(){this.Mv.si().W().handleScale.axisPressedMouseMove.time&&this.ev(1)}Df(){this.ev(0)}Xf(){return this.Pp}fm(){return this.rm}pm(te,ee,ne){equalSizes(this.Pp,te)||(this.Pp=te,this.Dp=!0,this.Op.resizeCanvasElement(te),this.Np.resizeCanvasElement(te),this.Dp=!1,this.qf.style.width=`${te.width}px`,this.qf.style.height=`${te.height}px`,this.rm.p(te)),this.im!==null&&this.im.jp(size({width:ee,height:te.height})),this.sm!==null&&this.sm.jp(size({width:ne,height:te.height}))}vm(){const te=this.wm();return Math.ceil(te.S+te.C+te.P+te.L+te.B+te.Mm)}Rt(){this.Mv.si().Lt().Aa()}Gf(){return this.Op.bitmapSize}Zf(te,ee,ne){const re=this.Gf();re.width>0&&re.height>0&&te.drawImage(this.Op.canvasElement,ee,ne)}Gp(te){if(te===0)return;const ee={colorSpace:this.ks.colorSpace};if(te!==1){this.Op.applySuggestedBitmapSize();const re=tryCreateCanvasRenderingTarget2D(this.Op,ee);re!==null&&(re.useBitmapCoordinateSpace(se=>{this.Jp(se),this.Qp(se),this.gm(re,As)}),this.iv(re),this.gm(re,Vs)),this.im!==null&&this.im.Gp(te),this.sm!==null&&this.sm.Gp(te)}this.Np.applySuggestedBitmapSize();const ne=tryCreateCanvasRenderingTarget2D(this.Np,ee);ne!==null&&(ne.useBitmapCoordinateSpace(({context:re,bitmapSize:se})=>{re.clearRect(0,0,se.width,se.height)}),this.bm([...this.Mv.si().Zs(),this.Mv.si().lc()],ne),this.gm(ne,Es))}gm(te,ee){const ne=this.Mv.si().Zs();for(const re of ne)bs(ee,se=>Ms(se,te,!1,void 0),re,void 0);for(const re of ne)bs(ee,se=>gs(se,te,!1,void 0),re,void 0)}Jp({context:te,bitmapSize:ee}){L(te,0,0,ee.width,ee.height,this.Mv.si().j())}Qp({context:te,bitmapSize:ee,verticalPixelRatio:ne}){if(this.Mv.W().timeScale.borderVisible){te.fillStyle=this.xm();const re=Math.max(1,Math.floor(this.wm().S*ne));te.fillRect(0,0,ee.width,re)}}iv(te){const ee=this.Mv.si().Lt(),ne=ee.Aa();if(!ne||ne.length===0)return;const re=this.a_.maxTickMarkWeight(ne),se=this.wm(),ae=ee.W();ae.borderVisible&&ae.ticksVisible&&te.useBitmapCoordinateSpace(({context:le,horizontalPixelRatio:ce,verticalPixelRatio:he})=>{le.strokeStyle=this.xm(),le.fillStyle=this.xm();const fe=Math.max(1,Math.floor(ce)),Ae=Math.floor(.5*ce);le.beginPath();const pe=Math.round(se.C*he);for(let Oe=ne.length;Oe--;){const Fe=Math.round(ne[Oe].coord*ce);le.rect(Fe-Ae,0,fe,pe)}le.fill()}),te.useMediaCoordinateSpace(({context:le})=>{const ce=se.S+se.C+se.L+se.P/2;le.textAlign="center",le.textBaseline="middle",le.fillStyle=this.U(),le.font=this.qp();for(const he of ne)if(he.weight<re){const fe=he.needAlignCoordinate?this.Sm(le,he.coord,he.label):he.coord;le.fillText(he.label,fe,ce)}this.Mv.W().timeScale.allowBoldLabels&&(le.font=this.Cm());for(const he of ne)if(he.weight>=re){const fe=he.needAlignCoordinate?this.Sm(le,he.coord,he.label):he.coord;le.fillText(he.label,fe,ce)}})}Sm(te,ee,ne){const re=this.kp.measureText(te,ne),se=re/2,ae=Math.floor(ee-se)+.5;return ae<0?ee+=Math.abs(0-ae):ae+re>this.Pp.width&&(ee-=Math.abs(this.Pp.width-(ae+re))),ee}bm(te,ee){const ne=this.wm();for(const re of te)for(const se of re.fs())se.It().ht(ee,ne)}xm(){return this.Mv.W().timeScale.borderColor}U(){return this.ks.textColor}F(){return this.ks.fontSize}qp(){return S$1(this.F(),this.ks.fontFamily)}Cm(){return S$1(this.F(),this.ks.fontFamily,"bold")}wm(){this.M===null&&(this.M={S:1,O:NaN,L:NaN,B:NaN,ts:NaN,C:5,P:NaN,k:"",Qi:new et,Mm:0});const te=this.M,ee=this.qp();if(te.k!==ee){const ne=this.F();te.P=ne,te.k=ee,te.L=3*ne/12,te.B=3*ne/12,te.ts=9*ne/12,te.O=0,te.Mm=4*ne/12,te.Qi.reset()}return this.M}ev(te){this.qf.style.cursor=te===1?"ew-resize":"default"}_m(){const te=this.Mv.si(),ee=te.W();ee.leftPriceScale.visible||this.im===null||(this.am.removeChild(this.im.Kf()),this.im.m(),this.im=null),ee.rightPriceScale.visible||this.sm===null||(this.lm.removeChild(this.sm.Kf()),this.sm.m(),this.sm=null);const ne={Ic:this.Mv.si().Ic()},re=()=>ee.leftPriceScale.borderVisible&&te.Lt().W().borderVisible,se=()=>te.j();ee.leftPriceScale.visible&&this.im===null&&(this.im=new Is("left",ee,ne,re,se),this.am.appendChild(this.im.Kf())),ee.rightPriceScale.visible&&this.sm===null&&(this.sm=new Is("right",ee,ne,re,se),this.lm.appendChild(this.sm.Kf()))}}var Iu;const Ls=!!ss&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(ie=>ie.brand.includes("Chromium"))&&!!ss&&((Iu=navigator==null?void 0:navigator.userAgentData)!=null&&Iu.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class Os{constructor(te,ee,ne){var re;this.Pm=[],this.ym=[],this.km=0,this.el=0,this.wo=0,this.Tm=0,this.Rm=0,this.Dm=null,this.Im=!1,this._v=new d$1,this.uv=new d$1,this.Yu=new d$1,this.Bm=null,this.Vm=null,this.Em=te,this.ks=ee,this.a_=ne,this.hm=document.createElement("div"),this.hm.classList.add("tv-lightweight-charts"),this.hm.style.overflow="hidden",this.hm.style.direction="ltr",this.hm.style.width="100%",this.hm.style.height="100%",(re=this.hm).style.userSelect="none",re.style.webkitUserSelect="none",re.style.msUserSelect="none",re.style.MozUserSelect="none",re.style.webkitTapHighlightColor="transparent",this.Am=document.createElement("table"),this.Am.setAttribute("cellspacing","0"),this.hm.appendChild(this.Am),this.zm=this.Lm.bind(this),Ns(this.ks)&&this.Om(!0),this.ns=new Li(this.Ku.bind(this),this.ks,ne),this.si().oc().i(this.Nm.bind(this),this),this.Wm=new zs(this,this.a_),this.Am.appendChild(this.Wm.Kf());const se=ee.autoSize&&this.Fm();let ae=this.ks.width,le=this.ks.height;if(se||ae===0||le===0){const ce=te.getBoundingClientRect();ae=ae||ce.width,le=le||ce.height}this.Hm(ae,le),this.Um(),te.appendChild(this.hm),this.$m(),this.ns.Lt().Ru().i(this.ns.Ah.bind(this.ns),this),this.ns.Do().i(this.ns.Ah.bind(this.ns),this)}si(){return this.ns}W(){return this.ks}Hf(){return this.Pm}qm(){return this.Wm}m(){this.Om(!1),this.km!==0&&window.cancelAnimationFrame(this.km),this.ns.oc().u(this),this.ns.Lt().Ru().u(this),this.ns.Do().u(this),this.ns.m();for(const te of this.Pm)this.Am.removeChild(te.Kf()),te.Lv().u(this),te.Ov().u(this),te.m();this.Pm=[];for(const te of this.ym)this.Ym(te);this.ym=[],u$1(this.Wm).m(),this.hm.parentElement!==null&&this.hm.parentElement.removeChild(this.hm),this.Yu.m(),this._v.m(),this.uv.m(),this.jm()}Hm(te,ee,ne=!1){if(this.el===ee&&this.wo===te)return;const re=function(le){const ce=Math.floor(le.width),he=Math.floor(le.height);return size({width:ce-ce%2,height:he-he%2})}(size({width:te,height:ee}));this.el=re.height,this.wo=re.width;const se=this.el+"px",ae=this.wo+"px";u$1(this.hm).style.height=se,u$1(this.hm).style.width=ae,this.Am.style.height=se,this.Am.style.width=ae,ne?this.Km(Z.Sn(),performance.now()):this.ns.Ah()}Gp(te){te===void 0&&(te=Z.Sn());for(let ee=0;ee<this.Pm.length;ee++)this.Pm[ee].Gp(te.ln(ee).rn);this.ks.timeScale.visible&&this.Wm.Gp(te.an())}hr(te){var re;const ee=Ns(this.ks);this.ns.hr(te);const ne=Ns(this.ks);ne!==ee&&this.Om(ne),(re=te.layout)!=null&&re.panes&&this.Xm(),this.$m(),this.Gm(te)}Lv(){return this._v}Ov(){return this.uv}oc(){return this.Yu}Zm(){this.Dm!==null&&(this.Km(this.Dm,performance.now()),this.Dm=null);const te=this.Jm(null),ee=document.createElement("canvas");ee.width=te.width,ee.height=te.height;const ne=u$1(ee.getContext("2d"));return this.Jm(ne),ee}Qm(te){return te==="left"&&!this.tw()||te==="right"&&!this.iw()||this.Pm.length===0?0:u$1(te==="left"?this.Pm[0].qv():this.Pm[0].Yv()).Kp()}sw(){return this.ks.autoSize&&this.Bm!==null}Qf(){return this.hm}nw(te){this.Vm=te,this.Vm?this.Qf().style.setProperty("cursor",te):this.Qf().style.removeProperty("cursor")}ew(){return this.Vm}rw(te){return _(this.Pm[te]).Xf()}Xm(){this.ym.forEach(te=>{te.Rt()})}Gm(te){(te.autoSize!==void 0||!this.Bm||te.width===void 0&&te.height===void 0)&&(te.autoSize&&!this.Bm&&this.Fm(),te.autoSize===!1&&this.Bm!==null&&this.jm(),te.autoSize||te.width===void 0&&te.height===void 0||this.Hm(te.width||this.wo,te.height||this.el))}Jm(te){let ee=0,ne=0;const re=this.Pm[0],se=(le,ce)=>{let he=0;for(let fe=0;fe<this.Pm.length;fe++){const Ae=this.Pm[fe],pe=u$1(le==="left"?Ae.qv():Ae.Yv()),Oe=pe.Gf();if(te!==null&&pe.Zf(te,ce,he),he+=Oe.height,fe<this.Pm.length-1){const Fe=this.ym[fe],Ne=Fe.Gf();te!==null&&Fe.Zf(te,ce,he),he+=Ne.height}}};this.tw()&&(se("left",0),ee+=u$1(re.qv()).Gf().width);for(let le=0;le<this.Pm.length;le++){const ce=this.Pm[le],he=ce.Gf();if(te!==null&&ce.Zf(te,ee,ne),ne+=he.height,le<this.Pm.length-1){const fe=this.ym[le],Ae=fe.Gf();te!==null&&fe.Zf(te,ee,ne),ne+=Ae.height}}ee+=re.Gf().width,this.iw()&&(se("right",ee),ee+=u$1(re.Yv()).Gf().width);const ae=(le,ce,he)=>{u$1(le==="left"?this.Wm.um():this.Wm.dm()).Zf(u$1(te),ce,he)};if(this.ks.timeScale.visible){const le=this.Wm.Gf();if(te!==null){let ce=0;this.tw()&&(ae("left",ce,ne),ce=u$1(re.qv()).Gf().width),this.Wm.Zf(te,ce,ne),ce+=le.width,this.iw()&&ae("right",ce,ne)}ne+=le.height}return size({width:ee,height:ne})}hw(){let te=0,ee=0,ne=0;for(const ze of this.Pm)this.tw()&&(ee=Math.max(ee,u$1(ze.qv()).$p(),this.ks.leftPriceScale.minimumWidth)),this.iw()&&(ne=Math.max(ne,u$1(ze.Yv()).$p(),this.ks.rightPriceScale.minimumWidth)),te+=ze.Io();ee=rs(ee),ne=rs(ne);const re=this.wo,se=this.el,ae=Math.max(re-ee-ne,0),le=1*this.ym.length,ce=this.ks.timeScale.visible;let he=ce?Math.max(this.Wm.vm(),this.ks.timeScale.minimumHeight):0;var fe;he=(fe=he)+fe%2;const Ae=le+he,pe=se<Ae?0:se-Ae,Oe=pe/te;let Fe=0;const Ne=window.devicePixelRatio||1;for(let ze=0;ze<this.Pm.length;++ze){const He=this.Pm[ze];He.Pv(this.ns.Ks()[ze]);let We=0,je=0;je=ze===this.Pm.length-1?Math.ceil((pe-Fe)*Ne)/Ne:Math.round(He.Io()*Oe*Ne)/Ne,We=Math.max(je,2),Fe+=We,He.jp(size({width:ae,height:We})),this.tw()&&He.Wv(ee,"left"),this.iw()&&He.Wv(ne,"right"),He.rp()&&this.ns._c(He.rp(),We)}this.Wm.pm(size({width:ce?ae:0,height:he}),ce?ee:0,ce?ne:0),this.ns.Vo(ae),this.Tm!==ee&&(this.Tm=ee),this.Rm!==ne&&(this.Rm=ne)}Om(te){te?this.hm.addEventListener("wheel",this.zm,{passive:!1}):this.hm.removeEventListener("wheel",this.zm)}aw(te){switch(te.deltaMode){case te.DOM_DELTA_PAGE:return 120;case te.DOM_DELTA_LINE:return 32}return Ls?1/window.devicePixelRatio:1}Lm(te){if(!(te.deltaX!==0&&this.ks.handleScroll.mouseWheel||te.deltaY!==0&&this.ks.handleScale.mouseWheel))return;const ee=this.aw(te),ne=ee*te.deltaX/100,re=-ee*te.deltaY/100;if(te.cancelable&&te.preventDefault(),re!==0&&this.ks.handleScale.mouseWheel){const se=Math.sign(re)*Math.min(1,Math.abs(re)),ae=te.clientX-this.hm.getBoundingClientRect().left;this.si().wc(ae,se)}ne!==0&&this.ks.handleScroll.mouseWheel&&this.si().Mc(-80*ne)}Km(te,ee){var re;const ne=te.an();ne===3&&this.lw(),ne!==3&&ne!==2||(this.ow(te),this._w(te,ee),this.Wm.Rt(),this.Pm.forEach(se=>{se.kv()}),((re=this.Dm)==null?void 0:re.an())===3&&(this.Dm.gn(te),this.lw(),this.ow(this.Dm),this._w(this.Dm,ee),te=this.Dm,this.Dm=null)),this.Gp(te)}_w(te,ee){for(const ne of te.Mn())this.bn(ne,ee)}ow(te){const ee=this.ns.Ks();for(let ne=0;ne<ee.length;ne++)te.ln(ne).hn&&ee[ne].Go()}bn(te,ee){const ne=this.ns.Lt();switch(te.cn){case 0:ne.Iu();break;case 1:ne.Bu(te.$t);break;case 2:ne.mn(te.$t);break;case 3:ne.wn(te.$t);break;case 4:ne.Mu();break;case 5:te.$t.yu(ee)||ne.wn(te.$t.Ns(ee))}}Ku(te){this.Dm!==null?this.Dm.gn(te):this.Dm=te,this.Im||(this.Im=!0,this.km=window.requestAnimationFrame(ee=>{if(this.Im=!1,this.km=0,this.Dm!==null){const ne=this.Dm;this.Dm=null,this.Km(ne,ee);for(const re of ne.Mn())if(re.cn===5&&!re.$t.yu(ee)){this.si().fn(re.$t);break}}}))}lw(){this.Um()}Ym(te){this.Am.removeChild(te.Kf()),te.m()}Um(){const te=this.ns.Ks(),ee=te.length,ne=this.Pm.length;for(let re=ee;re<ne;re++){const se=_(this.Pm.pop());this.Am.removeChild(se.Kf()),se.Lv().u(this),se.Ov().u(this),se.m();const ae=this.ym.pop();ae!==void 0&&this.Ym(ae)}for(let re=ne;re<ee;re++){const se=new Ds(this,te[re]);if(se.Lv().i(this.uw.bind(this,se),this),se.Ov().i(this.cw.bind(this,se),this),this.Pm.push(se),re>0){const ae=new ds(this,re-1,re);this.ym.push(ae),this.Am.insertBefore(ae.Kf(),this.Wm.Kf())}this.Am.insertBefore(se.Kf(),this.Wm.Kf())}for(let re=0;re<ee;re++){const se=te[re],ae=this.Pm[re];ae.rp()!==se?ae.Pv(se):ae.Cv()}this.$m(),this.hw()}dw(te,ee,ne,re){var Ae;const se=new Map;te!==null&&this.ns.Zs().forEach(pe=>{const Oe=pe.Qs().Fr(te);Oe!==null&&se.set(pe,Oe)});let ae;if(te!==null){const pe=(Ae=this.ns.Lt().es(te))==null?void 0:Ae.originalTime;pe!==void 0&&(ae=pe)}const le=this.si().ec(),ce=le!==null&&le.i_ instanceof Yt?le.i_:void 0,he=le!==null&&le.s_!==void 0?le.s_.externalId:void 0,fe=this.fw(re);return{pw:ae,Re:te??void 0,mw:ee??void 0,ww:fe!==-1?fe:void 0,Mw:ce,gw:se,bw:he,xw:ne??void 0}}fw(te){let ee=-1;if(te)ee=this.Pm.indexOf(te);else{const ne=this.si().lc().js();ne!==null&&(ee=this.si().Ks().indexOf(ne))}return ee}uw(te,ee,ne,re){this._v.p(()=>this.dw(ee,ne,re,te))}cw(te,ee,ne,re){this.uv.p(()=>this.dw(ee,ne,re,te))}Nm(te,ee,ne){var re;this.nw(((re=this.si().ec())==null?void 0:re.e_)??null),this.Yu.p(()=>this.dw(te,ee,ne))}$m(){const te=this.ks.timeScale.visible?"":"none";this.Wm.Kf().style.display=te}tw(){return this.Pm[0].rp().Wo().W().visible}iw(){return this.Pm[0].rp().Fo().W().visible}Fm(){return"ResizeObserver"in window&&(this.Bm=new ResizeObserver(te=>{const ee=te[te.length-1];ee&&this.Hm(ee.contentRect.width,ee.contentRect.height)}),this.Bm.observe(this.Em,{box:"border-box"}),!0)}jm(){this.Bm!==null&&this.Bm.disconnect(),this.Bm=null}}function Ns(ie){return!!(ie.handleScroll.mouseWheel||ie.handleScale.mouseWheel)}function Ws(ie){return ie.open===void 0&&ie.value===void 0}function Fs(ie){return function(te){return te.open!==void 0}(ie)||function(te){return te.value!==void 0}(ie)}function Hs(ie,te,ee,ne){const re=ee.value,se={Re:te,bt:ie,$t:[re,re,re,re],pw:ne};return ee.color!==void 0&&(se.R=ee.color),se}function Us(ie,te,ee,ne){const re=ee.value,se={Re:te,bt:ie,$t:[re,re,re,re],pw:ne};return ee.lineColor!==void 0&&(se.gt=ee.lineColor),ee.topColor!==void 0&&(se.wr=ee.topColor),ee.bottomColor!==void 0&&(se.Mr=ee.bottomColor),se}function $s(ie,te,ee,ne){const re=ee.value,se={Re:te,bt:ie,$t:[re,re,re,re],pw:ne};return ee.topLineColor!==void 0&&(se.gr=ee.topLineColor),ee.bottomLineColor!==void 0&&(se.br=ee.bottomLineColor),ee.topFillColor1!==void 0&&(se.Sr=ee.topFillColor1),ee.topFillColor2!==void 0&&(se.Cr=ee.topFillColor2),ee.bottomFillColor1!==void 0&&(se.Pr=ee.bottomFillColor1),ee.bottomFillColor2!==void 0&&(se.yr=ee.bottomFillColor2),se}function qs(ie,te,ee,ne){const re={Re:te,bt:ie,$t:[ee.open,ee.high,ee.low,ee.close],pw:ne};return ee.color!==void 0&&(re.R=ee.color),re}function Ys(ie,te,ee,ne){const re={Re:te,bt:ie,$t:[ee.open,ee.high,ee.low,ee.close],pw:ne};return ee.color!==void 0&&(re.R=ee.color),ee.borderColor!==void 0&&(re.qt=ee.borderColor),ee.wickColor!==void 0&&(re.vr=ee.wickColor),re}function js(ie,te,ee,ne){const re={Re:te,bt:ie,$t:[ee.open,ee.high,ee.low,ee.close],pw:ne};return ee.color!==void 0&&(re.R=ee.color),ee.borderColor!==void 0&&(re.qt=ee.borderColor),ee.wickColor!==void 0&&(re.vr=ee.wickColor),re}function Ks(ie,te,ee,ne,re){const se=_(re)(ee),ae=Math.max(...se),le=Math.min(...se),ce=se[se.length-1],he=[ce,ae,le,ce],{time:fe,color:Ae,...pe}=ee;return{Re:te,bt:ie,$t:he,pw:ne,se:pe,R:Ae}}function Xs(ie){return ie.$t!==void 0}function Gs(ie,te){return te.customValues!==void 0&&(ie.Sw=te.customValues),ie}function Zs(ie){return(te,ee,ne,re,se,ae)=>function(le,ce){return ce?ce(le):Ws(le)}(ne,ae)?Gs({bt:te,Re:ee,pw:re},ne):Gs(ie(te,ee,ne,re,se),ne)}function Js(ie){return{Candlestick:Zs(Ys),HollowCandlestick:Zs(js),Bar:Zs(qs),Area:Zs(Us),Baseline:Zs($s),Histogram:Zs(Hs),Line:Zs(Hs),Custom:Zs(Ks)}[ie]}function Qs(ie){return{Re:0,Cw:new Map,$h:ie}}function tn(ie,te){if(ie!==void 0&&ie.length!==0)return{Pw:te.key(ie[0].bt),yw:te.key(ie[ie.length-1].bt)}}function sn(ie){let te;return ie.forEach(ee=>{te===void 0&&(te=ee.pw)}),_(te)}class nn{constructor(te){this.kw=new Map,this.Tw=new Map,this.Rw=new Map,this.Dw=[],this.a_=te}m(){this.kw.clear(),this.Tw.clear(),this.Rw.clear(),this.Dw=[]}Iw(te,ee){let ne=this.kw.size!==0,re=!1;const se=this.Tw.get(te);if(se!==void 0)if(this.Tw.size===1)ne=!1,re=!0,this.kw.clear();else for(const ce of this.Dw)ce.pointData.Cw.delete(te)&&(re=!0);let ae=[];if(ee.length!==0){const ce=ee.map(Oe=>Oe.time),he=this.a_.createConverterToInternalObj(ee),fe=Js(te.Dr()),Ae=te.ma(),pe=te.Ma();ae=ee.map((Oe,Fe)=>{const Ne=he(Oe.time),ze=this.a_.key(Ne);let He=this.kw.get(ze);He===void 0&&(He=Qs(Ne),this.kw.set(ze,He),re=!0);const We=fe(Ne,He.Re,Oe,ce[Fe],Ae,pe);return He.Cw.set(te,We),We})}ne&&this.Bw(),this.Vw(te,ae);let le=-1;if(re){const ce=[];this.kw.forEach(he=>{ce.push({timeWeight:0,time:he.$h,pointData:he,originalTime:sn(he.Cw)})}),ce.sort((he,fe)=>this.a_.key(he.time)-this.a_.key(fe.time)),le=this.Ew(ce)}return this.Aw(te,le,function(ce,he,fe){const Ae=tn(ce,fe),pe=tn(he,fe);if(Ae!==void 0&&pe!==void 0)return{zw:!1,Oh:Ae.yw>=pe.yw&&Ae.Pw>=pe.Pw}}(this.Tw.get(te),se,this.a_))}Ec(te){return this.Iw(te,[])}Lw(te,ee,ne){const re=ee;(function(ze){ze.pw===void 0&&(ze.pw=ze.time)})(re),this.a_.preprocessData(ee);const se=this.a_.createConverterToInternalObj([ee])(ee.time),ae=this.Rw.get(te);if(!ne&&ae!==void 0&&this.a_.key(se)<this.a_.key(ae))throw new Error(`Cannot update oldest data, last time=${ae}, new time=${se}`);let le=this.kw.get(this.a_.key(se));if(ne&&le===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const ce=le===void 0;le===void 0&&(le=Qs(se),this.kw.set(this.a_.key(se),le));const he=Js(te.Dr()),fe=te.ma(),Ae=te.Ma(),pe=he(se,le.Re,ee,re.pw,fe,Ae);le.Cw.set(te,pe),ne?this.Ow(te,pe,le.Re):this.Nw(te,pe);const Oe={Oh:Xs(pe),zw:ne};if(!ce)return this.Aw(te,-1,Oe);const Fe={timeWeight:0,time:le.$h,pointData:le,originalTime:sn(le.Cw)},Ne=Pt(this.Dw,this.a_.key(Fe.time),(ze,He)=>this.a_.key(ze.time)<He);this.Dw.splice(Ne,0,Fe);for(let ze=Ne;ze<this.Dw.length;++ze)en$1(this.Dw[ze].pointData,ze);return this.a_.fillWeightsForPoints(this.Dw,Ne),this.Aw(te,Ne,Oe)}Nw(te,ee){let ne=this.Tw.get(te);ne===void 0&&(ne=[],this.Tw.set(te,ne));const re=ne.length!==0?ne[ne.length-1]:null;re===null||this.a_.key(ee.bt)>this.a_.key(re.bt)?Xs(ee)&&ne.push(ee):Xs(ee)?ne[ne.length-1]=ee:ne.splice(-1,1),this.Rw.set(te,ee.bt)}Ow(te,ee,ne){const re=this.Tw.get(te);if(re===void 0)return;const se=Pt(re,ne,(ae,le)=>ae.Re<le);Xs(ee)?re[se]=ee:re.splice(se,1)}Vw(te,ee){ee.length!==0?(this.Tw.set(te,ee.filter(Xs)),this.Rw.set(te,ee[ee.length-1].bt)):(this.Tw.delete(te),this.Rw.delete(te))}Bw(){for(const te of this.Dw)te.pointData.Cw.size===0&&this.kw.delete(this.a_.key(te.time))}Ew(te){let ee=-1;for(let ne=0;ne<this.Dw.length&&ne<te.length;++ne){const re=this.Dw[ne],se=te[ne];if(this.a_.key(re.time)!==this.a_.key(se.time)){ee=ne;break}se.timeWeight=re.timeWeight,en$1(se.pointData,ne)}if(ee===-1&&this.Dw.length!==te.length&&(ee=Math.min(this.Dw.length,te.length)),ee===-1)return-1;for(let ne=ee;ne<te.length;++ne)en$1(te[ne].pointData,ne);return this.a_.fillWeightsForPoints(te,ee),this.Dw=te,ee}Ww(){if(this.Tw.size===0)return null;let te=0;return this.Tw.forEach(ee=>{ee.length!==0&&(te=Math.max(te,ee[ee.length-1].Re))}),te}Aw(te,ee,ne){const re={Lo:new Map,Lt:{au:this.Ww()}};if(ee!==-1)this.Tw.forEach((se,ae)=>{re.Lo.set(ae,{se,Fw:ae===te?ne:void 0})}),this.Tw.has(te)||re.Lo.set(te,{se:[],Fw:ne}),re.Lt.Vu=this.Dw,re.Lt.Hw=ee;else{const se=this.Tw.get(te);re.Lo.set(te,{se:se||[],Fw:ne})}return re}}function en$1(ie,te){ie.Re=te,ie.Cw.forEach(ee=>{ee.Re=te})}function rn(ie,te){return ie.bt<te}function hn(ie,te){return te<ie.bt}function an(ie,te,ee){const ne=te.qh(),re=te.Pi(),se=Pt(ie,ne,rn),ae=yt(ie,re,hn);if(!ee)return{from:se,to:ae};let le=se,ce=ae;return se>0&&se<ie.length&&ie[se].bt>=ne&&(le=se-1),ae>0&&ae<ie.length&&ie[ae-1].bt<=re&&(ce=ae+1),{from:le,to:ce}}class ln{constructor(te,ee,ne){this.Uw=!0,this.$w=!0,this.qw=!0,this.Yw=[],this.jw=null,this.Jn=te,this.Qn=ee,this.Kw=ne}Rt(te){this.Uw=!0,te==="data"&&(this.$w=!0),te==="options"&&(this.qw=!0)}It(){return this.Jn.Et()?(this.Xw(),this.jw===null?null:this.Gw):null}Zw(){this.Yw=this.Yw.map(te=>({...te,...this.Jn.Ih().Ir(te.bt)}))}Jw(){this.jw=null}Xw(){this.$w&&(this.Qw(),this.$w=!1),this.qw&&(this.Zw(),this.qw=!1),this.Uw&&(this.tM(),this.Uw=!1)}tM(){const te=this.Jn.Ut(),ee=this.Qn.Lt();if(this.Jw(),ee.Gi()||te.Gi())return;const ne=ee.Pe();if(ne===null||this.Jn.Qs().Lr()===0)return;const re=this.Jn.Nt();re!==null&&(this.jw=an(this.Yw,ne,this.Kw),this.iM(te,ee,re.$t),this.sM())}}class on{constructor(te,ee){this.nM=te,this.Ki=ee}ht(te,ee,ne){this.nM.draw(te,this.Ki,ee,ne)}Kn(te,ee){return this.nM.hitTest?this.nM.hitTest(te,ee):null}}class _n extends ln{constructor(te,ee,ne){super(te,ee,!1),this.nh=ne,this.Gw=new on(this.nh.renderer(),re=>{const se=te.Nt();return se===null?null:te.Ut().Ht(re,se.$t)})}wa(te){return this.nh.priceValueBuilder(te)}ga(te){return this.nh.isWhitespace(te)}Qw(){const te=this.Jn.Ih();this.Yw=this.Jn.Qs().Ur().map(ee=>({bt:ee.Re,dt:NaN,...te.Ir(ee.Re),eM:ee.se}))}iM(te,ee){ee.lu(this.Yw,b(this.jw))}sM(){this.nh.update({bars:this.Yw.map(un),barSpacing:this.Qn.Lt().fu(),visibleRange:this.jw},this.Jn.W())}}function un(ie){return{x:ie.dt,time:ie.bt,originalData:ie.eM,barColor:ie.cr}}const cn={color:"#2196f3"},dn=(ie,te,ee)=>{const ne=c(ee);return new _n(ie,te,ne)};function fn(ie){const te={value:ie.$t[3],time:ie.pw};return ie.Sw!==void 0&&(te.customValues=ie.Sw),te}function pn(ie){const te=fn(ie);return ie.R!==void 0&&(te.color=ie.R),te}function vn(ie){const te=fn(ie);return ie.gt!==void 0&&(te.lineColor=ie.gt),ie.wr!==void 0&&(te.topColor=ie.wr),ie.Mr!==void 0&&(te.bottomColor=ie.Mr),te}function mn(ie){const te=fn(ie);return ie.gr!==void 0&&(te.topLineColor=ie.gr),ie.br!==void 0&&(te.bottomLineColor=ie.br),ie.Sr!==void 0&&(te.topFillColor1=ie.Sr),ie.Cr!==void 0&&(te.topFillColor2=ie.Cr),ie.Pr!==void 0&&(te.bottomFillColor1=ie.Pr),ie.yr!==void 0&&(te.bottomFillColor2=ie.yr),te}function wn(ie){const te={open:ie.$t[0],high:ie.$t[1],low:ie.$t[2],close:ie.$t[3],time:ie.pw};return ie.Sw!==void 0&&(te.customValues=ie.Sw),te}function Mn(ie){const te=wn(ie);return ie.R!==void 0&&(te.color=ie.R),te}function gn(ie){const te=wn(ie),{R:ee,qt:ne,vr:re}=ie;return ee!==void 0&&(te.color=ee),ne!==void 0&&(te.borderColor=ne),re!==void 0&&(te.wickColor=re),te}function bn(ie){const te=wn(ie),{R:ee,qt:ne,vr:re}=ie;return ee!==void 0&&(te.color=ee),ne!==void 0&&(te.borderColor=ne),re!==void 0&&(te.wickColor=re),te}function xn(ie){return{Area:vn,Line:pn,Baseline:mn,Histogram:pn,Bar:Mn,Candlestick:gn,HollowCandlestick:bn,Custom:Sn}[ie]}function Sn(ie){const te=ie.pw;return{...ie.se,time:te}}const Cn={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},Pn={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},yn={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:x,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},kn={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},Tn={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Rn(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:yn,crosshair:Cn,grid:Pn,overlayPriceScales:{...kn},leftPriceScale:{...kn,visible:!1},rightPriceScale:{...kn,visible:!0},timeScale:Tn,localization:{locale:ss?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class Dn{constructor(te,ee,ne){this.Wf=te,this.rM=ee,this.hM=ne??0}applyOptions(te){this.Wf.si().hc(this.rM,te,this.hM)}options(){return this.Ki().W()}width(){return G(this.rM)?this.Wf.Qm(this.rM):0}setVisibleRange(te){this.setAutoScale(!1),this.Ki().Ul(new vt(te.from,te.to))}getVisibleRange(){const te=this.Ki().Qe();return te===null?null:{from:te.$e(),to:te.qe()}}setAutoScale(te){this.applyOptions({autoScale:te})}Ki(){return u$1(this.Wf.si().ac(this.rM,this.hM)).Ut}}class In{constructor(te,ee,ne,re){this.Wf=te,this.Tt=ne,this.aM=ee,this.lM=re}getHeight(){return this.Tt.jt()}setHeight(te){const ee=this.Wf.si(),ne=ee.kc(this.Tt);ee.cc(ne,te)}getStretchFactor(){return this.Tt.Io()}setStretchFactor(te){this.Tt.Bo(te),this.Wf.si().Ah()}paneIndex(){return this.Wf.si().kc(this.Tt)}moveTo(te){const ee=this.paneIndex();ee!==te&&(o$1(te>=0&&te<this.Wf.Hf().length,"Invalid pane index"),this.Wf.si().fc(ee,te))}getSeries(){return this.Tt.Lo().map(te=>this.aM(te))??[]}getHTMLElement(){const te=this.Wf.Hf();return te&&te.length!==0&&te[this.paneIndex()]?te[this.paneIndex()].Kf():null}attachPrimitive(te){this.Tt.fa(te),te.attached&&te.attached({chart:this.lM,requestUpdate:()=>this.Tt.si().Ah()})}detachPrimitive(te){this.Tt.pa(te)}priceScale(te){if(this.Tt.Ro(te)===null)throw new Error(`Cannot find price scale with id: ${te}`);return new Dn(this.Wf,te,this.paneIndex())}setPreserveEmptyPane(te){this.Tt.Ao(te)}preserveEmptyPane(){return this.Tt.zo()}addCustomSeries(te,ee={},ne=0){return this.lM.addCustomSeries(te,ee,ne)}addSeries(te,ee={}){return this.lM.addSeries(te,ee,this.paneIndex())}}const Bn={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Vn{constructor(te){this.ir=te}applyOptions(te){this.ir.hr(te)}options(){return this.ir.W()}oM(){return this.ir}}class En{constructor(te,ee,ne,re,se,ae){this._M=new d$1,this.Jn=te,this.uM=ee,this.cM=ne,this.a_=se,this.lM=re,this.dM=ae}m(){this._M.m()}priceFormatter(){return this.Jn.la()}priceToCoordinate(te){const ee=this.Jn.Nt();return ee===null?null:this.Jn.Ut().Ht(te,ee.$t)}coordinateToPrice(te){const ee=this.Jn.Nt();return ee===null?null:this.Jn.Ut().Ds(te,ee.$t)}barsInLogicalRange(te){if(te===null)return null;const ee=new Ri(new yi(te.from,te.to)).C_(),ne=this.Jn.Qs();if(ne.Gi())return null;const re=ne.Fr(ee.qh(),1),se=ne.Fr(ee.Pi(),-1),ae=u$1(ne.Or()),le=u$1(ne.Js());if(re!==null&&se!==null&&re.Re>se.Re)return{barsBefore:te.from-ae,barsAfter:le-te.to};const ce={barsBefore:re===null||re.Re===ae?te.from-ae:re.Re-ae,barsAfter:se===null||se.Re===le?le-te.to:le-se.Re};return re!==null&&se!==null&&(ce.from=re.pw,ce.to=se.pw),ce}setData(te){this.a_,this.Jn.Dr(),this.uM.fM(this.Jn,te),this.pM("full")}update(te,ee=!1){this.Jn.Dr(),this.uM.vM(this.Jn,te,ee),this.pM("update")}dataByIndex(te,ee){const ne=this.Jn.Qs().Fr(te,ee);return ne===null?null:xn(this.seriesType())(ne)}barsProvider(){return{firstIndex:()=>this.Jn.Qs().Or(),lastIndex:()=>this.Jn.Qs().Js()}}data(){const te=xn(this.seriesType());return this.Jn.Qs().Ur().map(ee=>te(ee))}subscribeDataChanged(te){this._M.i(te)}unsubscribeDataChanged(te){this._M._(te)}applyOptions(te){this.Jn.hr(te)}options(){return M$2(this.Jn.W())}priceScale(){return this.cM.priceScale(this.Jn.Ut().xa(),this.getPane().paneIndex())}createPriceLine(te){const ee=f(M$2(Bn),te),ne=this.Jn.Wh(ee);return new Vn(ne)}removePriceLine(te){this.Jn.Fh(te.oM())}priceLines(){return this.Jn.Hh().map(te=>new Vn(te))}seriesType(){return this.Jn.Dr()}attachPrimitive(te){this.Jn.fa(te),te.attached&&te.attached({chart:this.lM,series:this,requestUpdate:()=>this.Jn.si().Ah(),horzScaleBehavior:this.a_})}detachPrimitive(te){this.Jn.pa(te),te.detached&&te.detached(),this.Jn.si().Ah()}primitives(){return this.Jn.va()}getPane(){const te=this.Jn,ee=u$1(this.Jn.si().Un(te));return this.dM(ee)}moveToPane(te){this.Jn.si().Oc(this.Jn,te)}seriesOrder(){const te=this.Jn.si().Un(this.Jn);return te===null?-1:te.Lo().indexOf(this.Jn)}setSeriesOrder(te){const ee=this.Jn.si().Un(this.Jn);ee!==null&&ee.Jo(this.Jn,te)}pM(te){this._M.v()&&this._M.p(te)}}class An{constructor(te,ee,ne){this.mM=new d$1,this.E_=new d$1,this.rm=new d$1,this.ns=te,this.fh=te.Lt(),this.Wm=ee,this.fh.ku().i(this.wM.bind(this)),this.fh.Tu().i(this.MM.bind(this)),this.Wm.fm().i(this.gM.bind(this)),this.a_=ne}m(){this.fh.ku().u(this),this.fh.Tu().u(this),this.Wm.fm().u(this),this.mM.m(),this.E_.m(),this.rm.m()}scrollPosition(){return this.fh.vu()}scrollToPosition(te,ee){ee?this.fh.Pu(te,1e3):this.ns.wn(te)}scrollToRealTime(){this.fh.Cu()}getVisibleRange(){const te=this.fh.tu();return te===null?null:{from:te.from.originalTime,to:te.to.originalTime}}setVisibleRange(te){const ee={from:this.a_.convertHorzItemToInternal(te.from),to:this.a_.convertHorzItemToInternal(te.to)},ne=this.fh.eu(ee);this.ns.zc(ne)}getVisibleLogicalRange(){const te=this.fh.Q_();return te===null?null:{from:te.qh(),to:te.Pi()}}setVisibleLogicalRange(te){o$1(te.from<=te.to,"The from index cannot be after the to index."),this.ns.zc(te)}resetTimeScale(){this.ns.vn()}fitContent(){this.ns.Iu()}logicalToCoordinate(te){const ee=this.ns.Lt();return ee.Gi()?null:ee.Kt(te)}coordinateToLogical(te){return this.fh.Gi()?null:this.fh.ou(te)}timeToIndex(te,ee){const ne=this.a_.convertHorzItemToInternal(te);return this.fh.G_(ne,ee)}timeToIndexEx(te){var se,ae;const ee=this.a_.convertHorzItemToInternal(te),ne=this.fh.Vu();if(ne.length<1)return null;if(this.a_.key(ee)>this.a_.key(ne[ne.length-1].time)){const le=this.fh.Vu()[ne.length-1],ce=(se=this.fh.W().extendedScale)==null?void 0:se.getAdvanceUnit(le.originalTime,te);return ce===void 0?null:ne.length-1+ce}const re=Pt(ne,this.a_.key(ee),(le,ce)=>this.a_.key(le.time)<ce);if(this.a_.key(ee)<this.a_.key(ne[re].time)){const le=this.fh.Vu()[re],ce=(ae=this.fh.W().extendedScale)==null?void 0:ae.getAdvanceUnit(te,le.originalTime);return ce===void 0?null:re-ce}return re}timeToCoordinate(te){const ee=this.timeToIndex(te,!1);return ee===null?null:this.fh.Kt(ee)}timeToCoordinateEx(te){var le,ce;const ee=this.a_.convertHorzItemToInternal(te),ne=this.fh.Or(),re=this.fh.Js();if(ne===null||re===null)return null;const se=this.fh.Vu()[re];if(this.a_.key(ee)>this.a_.key(se.time)){const he=(le=this.fh.W().extendedScale)==null?void 0:le.getAdvanceUnit(se.originalTime,te);return he===void 0?null:this.fh.Kt(re+he)}const ae=Pt(this.fh.Vu(),this.a_.key(te),(he,fe)=>this.a_.key(he.time)<fe);if(this.a_.key(te)<this.a_.key(this.fh.Vu()[ae].time)){const he=this.fh.Vu()[ae],fe=(ce=this.fh.W().extendedScale)==null?void 0:ce.getAdvanceUnit(he.originalTime,te);return fe===void 0?null:this.fh.Kt(ae+fe)}return this.fh.Kt(ae)}coordinateToTime(te){const ee=this.ns.Lt(),ne=ee.ou(te),re=ee.es(ne);return re===null?null:re.originalTime}coordinateToTimeEx(te){var ae,le;const ee=this.ns.Lt(),ne=ee.ou(te),re=ee.Or(),se=ee.Js();if(re===null||se===null)return null;if(ne>se){const ce=ee.es(se);if(ce===null)return null;const he=ce.originalTime;return((ae=ee.W().extendedScale)==null?void 0:ae.getExtendedTime(he,ne-se))??null}if(ne<re){const ce=ee.es(re);if(ce===null)return null;const he=ce.originalTime;return((le=ee.W().extendedScale)==null?void 0:le.getExtendedTime(he,ne-se))??null}{const ce=ee.es(ne);return ce===null?null:ce.originalTime}}width(){return this.Wm.Xf().width}height(){return this.Wm.Xf().height}subscribeVisibleTimeRangeChange(te){this.mM.i(te)}unsubscribeVisibleTimeRangeChange(te){this.mM._(te)}subscribeVisibleLogicalRangeChange(te){this.E_.i(te)}unsubscribeVisibleLogicalRangeChange(te){this.E_._(te)}subscribeSizeChange(te){this.rm.i(te)}unsubscribeSizeChange(te){this.rm._(te)}applyOptions(te){this.fh.hr(te)}options(){return{...M$2(this.fh.W()),barSpacing:this.fh.fu()}}barSpacing(){return this.fh.fu()}wM(){this.mM.v()&&this.mM.p(this.getVisibleRange())}MM(){this.E_.v()&&this.E_.p(this.getVisibleLogicalRange())}gM(te){this.rm.p(te.width,te.height)}}function zn(ie){if(ie===void 0||ie.type==="custom")return;const te=ie;te.minMove!==void 0&&te.precision===void 0&&(te.precision=function(ee){if(ee>=1)return 0;let ne=0;for(;ne<8;ne++){const re=Math.round(ee);if(Math.abs(re-ee)<1e-8)return ne;ee*=10}return ne}(te.minMove))}function Ln(ie){return function(te){if(w(te.handleScale)){const ne=te.handleScale;te.handleScale={axisDoubleClickReset:{time:ne,price:ne},axisPressedMouseMove:{time:ne,price:ne},mouseWheel:ne,pinch:ne}}else if(te.handleScale!==void 0){const{axisPressedMouseMove:ne,axisDoubleClickReset:re}=te.handleScale;w(ne)&&(te.handleScale.axisPressedMouseMove={time:ne,price:ne}),w(re)&&(te.handleScale.axisDoubleClickReset={time:re,price:re})}const ee=te.handleScroll;w(ee)&&(te.handleScroll={horzTouchDrag:ee,vertTouchDrag:ee,mouseWheel:ee,pressedMouseMove:ee})}(ie),ie}class On{constructor(te,ee,ne){this.bM=new Map,this.xM=new Map,this.SM=new d$1,this.CM=new d$1,this.PM=new d$1,this.Hu=new WeakMap,this.yM=new nn(ee);const re=ne===void 0?M$2(Rn()):f(M$2(Rn()),Ln(ne));this.kM=ee,this.Wf=new Os(te,re,ee),this.Wf.Lv().i(ae=>{this.SM.v()&&this.SM.p(this.TM(ae()))},this),this.Wf.Ov().i(ae=>{this.CM.v()&&this.CM.p(this.TM(ae()))},this),this.Wf.oc().i(ae=>{this.PM.v()&&this.PM.p(this.TM(ae()))},this);const se=this.Wf.si();this.RM=new An(se,this.Wf.qm(),this.kM)}remove(){this.Wf.Lv().u(this),this.Wf.Ov().u(this),this.Wf.oc().u(this),this.RM.m(),this.Wf.m(),this.bM.clear(),this.xM.clear(),this.SM.m(),this.CM.m(),this.PM.m(),this.yM.m()}resize(te,ee,ne){this.autoSizeActive()||this.Wf.Hm(te,ee,ne)}addCustomSeries(te,ee={},ne=0){const re=(se=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...cn,...se.defaultOptions()},DM:dn,IM:se}))(c(te));return this.BM(re,ee,ne)}addSeries(te,ee={},ne=0){return this.BM(te,ee,ne)}removeSeries(te){const ee=_(this.bM.get(te)),ne=this.yM.Ec(ee);this.Wf.si().Ec(ee),this.VM(ne),this.bM.delete(te),this.xM.delete(ee)}fM(te,ee){this.VM(this.yM.Iw(te,ee))}vM(te,ee,ne){this.VM(this.yM.Lw(te,ee,ne))}subscribeClick(te){this.SM.i(te)}unsubscribeClick(te){this.SM._(te)}subscribeCrosshairMove(te){this.PM.i(te)}unsubscribeCrosshairMove(te){this.PM._(te)}subscribeDblClick(te){this.CM.i(te)}unsubscribeDblClick(te){this.CM._(te)}priceScale(te,ee=0){return new Dn(this.Wf,te,ee)}timeScale(){return this.RM}applyOptions(te){this.Wf.hr(Ln(te))}options(){return this.Wf.W()}takeScreenshot(){return this.Wf.Zm()}addPane(te=!1){const ee=this.Wf.si().Fc();return ee.Ao(te),this.EM(ee)}removePane(te){this.Wf.si().uc(te)}swapPanes(te,ee){this.Wf.si().dc(te,ee)}autoSizeActive(){return this.Wf.sw()}chartElement(){return this.Wf.Qf()}panes(){return this.Wf.si().Ks().map(te=>this.EM(te))}paneSize(te=0){const ee=this.Wf.rw(te);return{height:ee.height,width:ee.width}}setCrosshairPosition(te,ee,ne){const re=this.bM.get(ne);if(re===void 0)return;const se=this.Wf.si().Un(re);se!==null&&this.Wf.si().Tc(te,ee,se)}getCrosshairPosition(){return this.Wf.si().yc()}clearCrosshairPosition(){this.Wf.si().Rc(!0)}horzBehaviour(){return this.kM}BM(te,ee={},ne=0){o$1(te.DM!==void 0),zn(ee.priceFormat),te.type==="Candlestick"&&function(ce){ce.borderColor!==void 0&&(ce.borderUpColor=ce.borderColor,ce.borderDownColor=ce.borderColor),ce.wickColor!==void 0&&(ce.wickUpColor=ce.wickColor,ce.wickDownColor=ce.wickColor)}(ee);const re=f(M$2(e$1),M$2(te.defaultOptions),ee),se=te.DM,ae=new Yt(this.Wf.si(),te.type,re,se,te.IM);this.Wf.si().Bc(ae,ne);const le=new En(ae,this,this,this,this.kM,ce=>this.EM(ce));return this.bM.set(le,ae),this.xM.set(ae,le),le}VM(te){const ee=this.Wf.si();ee.Dc(te.Lt.au,te.Lt.Vu,te.Lt.Hw),te.Lo.forEach((ne,re)=>re._t(ne.se,ne.Fw)),ee.Lt().q_(),ee.du()}AM(te){return _(this.xM.get(te))}TM(te){const ee=new Map;te.gw.forEach((re,se)=>{const ae=se.Dr(),le=xn(ae)(re);if(ae!=="Custom")o$1(Fs(le));else{const ce=se.Ma();o$1(!ce||ce(le)===!1)}ee.set(this.AM(se),le)});const ne=te.Mw!==void 0&&this.xM.has(te.Mw)?this.AM(te.Mw):void 0;return{time:te.pw,logical:te.Re,point:te.mw,paneIndex:te.ww,hoveredSeries:ne,hoveredObjectId:te.bw,seriesData:ee,sourceEvent:te.xw}}EM(te){let ee=this.Hu.get(te);return ee||(ee=new In(this.Wf,ne=>this.AM(ne),te,this),this.Hu.set(te,ee)),ee}}function Nn(ie){if(m(ie)){const te=document.getElementById(ie);return o$1(te!==null,`Cannot find element in DOM with id=${ie}`),te}return ie}function Wn(ie,te,ee){const ne=Nn(ie),re=new On(ne,te,ee);return te.setOptions(re.options()),re}function Fn(ie,te){return Wn(ie,new is,is.rd(te))}class Un extends ln{constructor(te,ee){super(te,ee,!0)}iM(te,ee,ne){ee.lu(this.Yw,b(this.jw)),te.Yl(this.Yw,ne,b(this.jw))}zM(te,ee){return{bt:te,xt:ee,dt:NaN,ft:NaN}}Qw(){const te=this.Jn.Ih();this.Yw=this.Jn.Qs().Ur().map(ee=>{const ne=ee.$t[3];return this.LM(ee.Re,ne,te)})}}function $n(ie,te,ee,ne,re,se,ae){if(te.length===0||ne.from>=te.length||ne.to<=0)return;const{context:le,horizontalPixelRatio:ce,verticalPixelRatio:he}=ie,fe=te[ne.from];let Ae=se(ie,fe),pe=fe;if(ne.to-ne.from<2){const Oe=re/2;le.beginPath();const Fe={dt:fe.dt-Oe,ft:fe.ft},Ne={dt:fe.dt+Oe,ft:fe.ft};le.moveTo(Fe.dt*ce,Fe.ft*he),le.lineTo(Ne.dt*ce,Ne.ft*he),ae(ie,Ae,Fe,Ne)}else{const Oe=(Ne,ze)=>{ae(ie,Ae,pe,ze),le.beginPath(),Ae=Ne,pe=ze};let Fe=pe;le.beginPath(),le.moveTo(fe.dt*ce,fe.ft*he);for(let Ne=ne.from+1;Ne<ne.to;++Ne){Fe=te[Ne];const ze=se(ie,Fe);switch(ee){case 0:le.lineTo(Fe.dt*ce,Fe.ft*he);break;case 1:le.lineTo(Fe.dt*ce,te[Ne-1].ft*he),ze!==Ae&&(Oe(ze,Fe),le.lineTo(Fe.dt*ce,te[Ne-1].ft*he)),le.lineTo(Fe.dt*ce,Fe.ft*he);break;case 2:{const[He,We]=Kn(te,Ne-1,Ne);le.bezierCurveTo(He.dt*ce,He.ft*he,We.dt*ce,We.ft*he,Fe.dt*ce,Fe.ft*he);break}}ee!==1&&ze!==Ae&&(Oe(ze,Fe),le.moveTo(Fe.dt*ce,Fe.ft*he))}(pe!==Fe||pe===Fe&&ee===1)&&ae(ie,Ae,pe,Fe)}}const qn=6;function Yn(ie,te){return{dt:ie.dt-te.dt,ft:ie.ft-te.ft}}function jn(ie,te){return{dt:ie.dt/te,ft:ie.ft/te}}function Kn(ie,te,ee){const ne=Math.max(0,te-1),re=Math.min(ie.length-1,ee+1);var se,ae;return[(se=ie[te],ae=jn(Yn(ie[ee],ie[ne]),qn),{dt:se.dt+ae.dt,ft:se.ft+ae.ft}),Yn(ie[ee],jn(Yn(ie[re],ie[te]),qn))]}function Xn(ie,te){const ee=ie.context;ee.strokeStyle=te,ee.stroke()}class Gn extends R{constructor(){super(...arguments),this.ot=null}_t(te){this.ot=te}lt(te){if(this.ot===null)return;const{ct:ee,ut:ne,OM:re,NM:se,vt:ae,Jt:le,WM:ce}=this.ot;if(ne===null)return;const he=te.context;he.lineCap="butt",he.lineWidth=ae*te.verticalPixelRatio,a$1(he,le),he.lineJoin="round";const fe=this.FM.bind(this);se!==void 0&&$n(te,ee,se,ne,re,fe,Xn),ce&&function(Ae,pe,Oe,Fe,Ne){if(Fe.to-Fe.from<=0)return;const{horizontalPixelRatio:ze,verticalPixelRatio:He,context:We}=Ae;let je=null;const Ue=Math.max(1,Math.floor(ze))%2/2,Ge=Oe*He+Ue;for(let Ze=Fe.to-1;Ze>=Fe.from;--Ze){const Ye=pe[Ze];if(Ye){const qe=Ne(Ae,Ye);qe!==je&&(We.beginPath(),je!==null&&We.fill(),We.fillStyle=qe,je=qe);const nr=Math.round(Ye.dt*ze)+Ue,ir=Ye.ft*He;We.moveTo(nr,ir),We.arc(nr,ir,Ge,0,2*Math.PI)}}We.fill()}(te,ee,ce,ne,fe)}}class Zn extends Gn{FM(te,ee){return ee.gt}}class Jn extends Un{constructor(){super(...arguments),this.Gw=new Zn}LM(te,ee,ne){return{...this.zM(te,ee),...ne.Ir(te)}}sM(){const te=this.Jn.W(),ee={ct:this.Yw,Jt:te.lineStyle,NM:te.lineVisible?te.lineType:void 0,vt:te.lineWidth,WM:te.pointMarkersVisible?te.pointMarkersRadius||te.lineWidth/2+2:void 0,ut:this.jw,OM:this.Qn.Lt().fu()};this.Gw._t(ee)}}const Qn={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},DM:(ie,te)=>new Jn(ie,te)};function oe$1(ie,te,ee,ne,re){const{context:se,horizontalPixelRatio:ae,verticalPixelRatio:le}=te;se.lineTo(re.dt*ae,ie*le),se.lineTo(ne.dt*ae,ie*le),se.closePath(),se.fillStyle=ee,se.fill()}class _e extends R{constructor(){super(...arguments),this.ot=null}_t(te){this.ot=te}lt(te){if(this.ot===null)return;const{ct:ee,ut:ne,OM:re,vt:se,Jt:ae,NM:le}=this.ot,ce=this.ot.KM??(this.ot.XM?0:te.mediaSize.height);if(ne===null)return;const he=te.context;he.lineCap="butt",he.lineJoin="round",he.lineWidth=se,a$1(he,ae),he.lineWidth=1,$n(te,ee,le,ne,re,this.GM.bind(this),oe$1.bind(null,ce))}}class ue{ZM(te,ee){const ne=this.JM,{QM:re,tg:se,ig:ae,sg:le,KM:ce,ng:he,eg:fe}=ee;if(this.rg===void 0||ne===void 0||ne.QM!==re||ne.tg!==se||ne.ig!==ae||ne.sg!==le||ne.KM!==ce||ne.ng!==he||ne.eg!==fe){const{verticalPixelRatio:Ae}=te,pe=ce||he>0?Ae:1,Oe=he*pe,Fe=fe===te.bitmapSize.height?fe:fe*pe,Ne=(ce??0)*pe,ze=te.context.createLinearGradient(0,Oe,0,Fe);if(ze.addColorStop(0,re),ce!=null){const He=Gt((Ne-Oe)/(Fe-Oe),0,1);ze.addColorStop(He,se),ze.addColorStop(He,ae)}ze.addColorStop(1,le),this.rg=ze,this.JM=ee}return this.rg}}class ve extends _e{constructor(){super(...arguments),this.hg=new ue}GM(te,ee){var ne;return this.hg.ZM(te,{QM:ee.wr,tg:"",ig:"",sg:ee.Mr,ng:((ne=this.ot)==null?void 0:ne.ng)??0,eg:te.bitmapSize.height})}}class me extends Un{constructor(te,ee){super(te,ee),this.Gw=new T,this._g=new ve,this.ug=new Zn,this.Gw.rt([this._g,this.ug])}LM(te,ee,ne){return{...this.zM(te,ee),...ne.Ir(te)}}sM(){const te=this.Jn.W();if(this.jw===null||this.Yw.length===0)return;let ee;if(te.relativeGradient){ee=this.Yw[this.jw.from].ft;for(let ne=this.jw.from;ne<this.jw.to;ne++){const re=this.Yw[ne];re.ft<ee&&(ee=re.ft)}}this._g._t({NM:te.lineType,ct:this.Yw,Jt:te.lineStyle,vt:te.lineWidth,KM:null,ng:ee,XM:te.invertFilledArea,ut:this.jw,OM:this.Qn.Lt().fu()}),this.ug._t({NM:te.lineVisible?te.lineType:void 0,ct:this.Yw,Jt:te.lineStyle,vt:te.lineWidth,ut:this.jw,OM:this.Qn.Lt().fu(),WM:te.pointMarkersVisible?te.pointMarkersRadius||te.lineWidth/2+2:void 0})}}const we={type:"Area",isBuiltIn:!0,defaultOptions:{topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,relativeGradient:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},DM:(ie,te)=>new me(ie,te)};function Me(ie,te){return te=te??window.devicePixelRatio??1,Math.floor(.3*ie*te)}function ge(ie,te){if(te=te??window.devicePixelRatio??1,ie>=2.5&&ie<=4)return Math.floor(3*te);const ee=1-.2*Math.atan(Math.max(4,ie)-4)/(.5*Math.PI),ne=Math.floor(ie*ee*te),re=Math.floor(ie*te),se=Math.min(ne,re);return Math.max(Math.floor(te),se)}class be extends R{constructor(){super(...arguments),this.Xt=null,this.cg=0,this.dg=0}_t(te){this.Xt=te}lt({context:te,horizontalPixelRatio:ee,verticalPixelRatio:ne}){if(this.Xt===null||this.Xt.Qs.length===0||this.Xt.ut===null)return;this.cg=this.fg(ee),this.cg>=2&&Math.max(1,Math.floor(ee))%2!=this.cg%2&&this.cg--,this.dg=this.Xt.pg?Math.min(this.cg,Math.floor(ee)):this.cg;let re=null;const se=this.dg<=this.cg&&this.Xt.fu>=Math.floor(1.5*ee);for(let ae=this.Xt.ut.from;ae<this.Xt.ut.to;++ae){const le=this.Xt.Qs[ae];re!==le.cr&&(te.fillStyle=le.cr,re=le.cr);const ce=Math.floor(.5*this.dg),he=Math.round(le.dt*ee),fe=he-ce,Ae=this.dg,pe=fe+Ae-1,Oe=Math.min(le.Gl,le.Zl),Fe=Math.max(le.Gl,le.Zl),Ne=Math.round(Oe*ne)-ce,ze=Math.round(Fe*ne)+ce,He=Math.max(ze-Ne,this.dg);te.fillRect(fe,Ne,Ae,He);const We=Math.ceil(1.5*this.cg);if(se){if(this.Xt.vg){const Ze=he-We;let Ye=Math.max(Ne,Math.round(le.Xl*ne)-ce),qe=Ye+Ae-1;qe>Ne+He-1&&(qe=Ne+He-1,Ye=qe-Ae+1),te.fillRect(Ze,Ye,fe-Ze,qe-Ye+1)}const je=he+We;let Ue=Math.max(Ne,Math.round(le.Jl*ne)-ce),Ge=Ue+Ae-1;Ge>Ne+He-1&&(Ge=Ne+He-1,Ue=Ge-Ae+1),te.fillRect(pe+1,Ue,je-pe,Ge-Ue+1)}}}fg(te){const ee=Math.floor(te);return Math.max(ee,Math.floor(Me(u$1(this.Xt).fu,te)))}}class xe extends ln{constructor(te,ee){super(te,ee,!1)}iM(te,ee,ne){ee.lu(this.Yw,b(this.jw)),te.Kl(this.Yw,ne,b(this.jw))}mg(te,ee,ne){return{bt:te,jh:ee.$t[0],Kh:ee.$t[1],Xh:ee.$t[2],Gh:ee.$t[3],dt:NaN,Xl:NaN,Gl:NaN,Zl:NaN,Jl:NaN}}Qw(){const te=this.Jn.Ih();this.Yw=this.Jn.Qs().Ur().map(ee=>this.LM(ee.Re,ee,te))}}class Se extends xe{constructor(){super(...arguments),this.Gw=new be}LM(te,ee,ne){return{...this.mg(te,ee,ne),...ne.Ir(te)}}sM(){const te=this.Jn.W();this.Gw._t({Qs:this.Yw,fu:this.Qn.Lt().fu(),vg:te.openVisible,pg:te.thinBars,ut:this.jw})}}const Ce={type:"Bar",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},DM:(ie,te)=>new Se(ie,te)};class Pe extends R{constructor(){super(...arguments),this.Xt=null,this.cg=0}_t(te){this.Xt=te}lt(te){if(this.Xt===null||this.Xt.Qs.length===0||this.Xt.ut===null)return;const{horizontalPixelRatio:ee}=te;this.cg=ge(this.Xt.fu,ee),this.cg>=2&&Math.floor(ee)%2!=this.cg%2&&this.cg--;const ne=this.Xt.Qs;this.Xt.wg&&this.Mg(te,ne,this.Xt.ut),this.Xt.Ci&&this.Qp(te,ne,this.Xt.ut);const re=this.gg(ee);(!this.Xt.Ci||this.cg>2*re)&&this.bg(te,ne,this.Xt.ut)}Mg(te,ee,ne){if(this.Xt===null)return;const{context:re,horizontalPixelRatio:se,verticalPixelRatio:ae}=te;let le="",ce=Math.min(Math.floor(se),Math.floor(this.Xt.fu*se));ce=Math.max(Math.floor(se),Math.min(ce,this.cg));const he=Math.floor(.5*ce);let fe=null;for(let Ae=ne.from;Ae<ne.to;Ae++){const pe=ee[Ae];pe.pr!==le&&(re.fillStyle=pe.pr,le=pe.pr);const Oe=Math.round(Math.min(pe.Xl,pe.Jl)*ae),Fe=Math.round(Math.max(pe.Xl,pe.Jl)*ae),Ne=Math.round(pe.Gl*ae),ze=Math.round(pe.Zl*ae);let He=Math.round(se*pe.dt)-he;const We=He+ce-1;fe!==null&&(He=Math.max(fe+1,He),He=Math.min(He,We));const je=We-He+1;re.fillRect(He,Ne,je,Oe-Ne),re.fillRect(He,Fe+1,je,ze-Fe),fe=We}}gg(te){let ee=Math.floor(1*te);this.cg<=2*ee&&(ee=Math.floor(.5*(this.cg-1)));const ne=Math.max(Math.floor(te),ee);return this.cg<=2*ne?Math.max(Math.floor(te),Math.floor(1*te)):ne}Qp(te,ee,ne){if(this.Xt===null)return;const{context:re,horizontalPixelRatio:se,verticalPixelRatio:ae}=te;let le="";const ce=this.gg(se);let he=null;for(let fe=ne.from;fe<ne.to;fe++){const Ae=ee[fe];Ae.dr!==le&&(re.fillStyle=Ae.dr,le=Ae.dr);let pe=Math.round(Ae.dt*se)-Math.floor(.5*this.cg);const Oe=pe+this.cg-1,Fe=Math.round(Math.min(Ae.Xl,Ae.Jl)*ae),Ne=Math.round(Math.max(Ae.Xl,Ae.Jl)*ae);if(he!==null&&(pe=Math.max(he+1,pe),pe=Math.min(pe,Oe)),this.Xt.fu*se>2*ce)z(re,pe,Fe,Oe-pe+1,Ne-Fe+1,ce);else{const ze=Oe-pe+1;re.fillRect(pe,Fe,ze,Ne-Fe+1)}he=Oe}}bg(te,ee,ne){if(this.Xt===null)return;const{context:re,horizontalPixelRatio:se,verticalPixelRatio:ae}=te;let le="";const ce=this.gg(se);for(let he=ne.from;he<ne.to;he++){const fe=ee[he];let Ae=Math.round(Math.min(fe.Xl,fe.Jl)*ae),pe=Math.round(Math.max(fe.Xl,fe.Jl)*ae),Oe=Math.round(fe.dt*se)-Math.floor(.5*this.cg),Fe=Oe+this.cg-1;if(fe.cr!==le){const Ne=fe.cr;re.fillStyle=Ne,le=Ne}this.Xt.Ci&&(Oe+=ce,Ae+=ce,Fe-=ce,pe-=ce),Ae>pe||re.fillRect(Oe,Ae,Fe-Oe+1,pe-Ae+1)}}}class ye extends xe{constructor(){super(...arguments),this.Gw=new Pe}LM(te,ee,ne){return{...this.mg(te,ee,ne),...ne.Ir(te)}}sM(){const te=this.Jn.W();this.Gw._t({Qs:this.Yw,fu:this.Qn.Lt().fu(),wg:te.wickVisible,Ci:te.borderVisible,ut:this.jw})}}const ke={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},DM:(ie,te)=>new ye(ie,te)};class Te extends R{constructor(){super(...arguments),this.Xt=null,this.cg=0}_t(te){this.Xt=te}lt(te){if(this.Xt===null||this.Xt.Qs.length===0||this.Xt.ut===null)return;const{horizontalPixelRatio:ee}=te;this.cg=ge(this.Xt.fu,ee),this.cg>=2&&Math.floor(ee)%2!=this.cg%2&&this.cg--;const ne=this.Xt.Qs;this.Xt.wg&&this.Mg(te,ne,this.Xt.ut),this.Xt.Ci&&this.Qp(te,ne,this.Xt.ut);const re=this.gg(ee);(!this.Xt.Ci||this.cg>2*re)&&this.bg(te,ne,this.Xt.ut)}Mg(te,ee,ne){if(this.Xt===null)return;const{context:re,horizontalPixelRatio:se,verticalPixelRatio:ae}=te;let le="",ce=Math.min(Math.floor(se),Math.floor(this.Xt.fu*se));ce=Math.max(Math.floor(se),Math.min(ce,this.cg));const he=Math.floor(.5*ce);let fe=null;for(let Ae=ne.from;Ae<ne.to;Ae++){const pe=ee[Ae];pe.pr!==le&&(re.fillStyle=pe.pr,le=pe.pr);const Oe=Math.round(Math.min(pe.Xl,pe.Jl)*ae),Fe=Math.round(Math.max(pe.Xl,pe.Jl)*ae),Ne=Math.round(pe.Gl*ae),ze=Math.round(pe.Zl*ae);let He=Math.round(se*pe.dt)-he;const We=He+ce-1;fe!==null&&(He=Math.max(fe+1,He),He=Math.min(He,We));const je=We-He+1;re.fillRect(He,Ne,je,Oe-Ne),re.fillRect(He,Fe+1,je,ze-Fe),fe=We}}gg(te){let ee=Math.floor(1*te);this.cg<=2*ee&&(ee=Math.floor(.5*(this.cg-1)));const ne=Math.max(Math.floor(te),ee);return this.cg<=2*ne?Math.max(Math.floor(te),Math.floor(1*te)):ne}Qp(te,ee,ne){if(this.Xt===null)return;const{context:re,horizontalPixelRatio:se,verticalPixelRatio:ae}=te;let le="";const ce=this.gg(se);let he=null;for(let fe=ne.from;fe<ne.to;fe++){const Ae=ee[fe];Ae.dr!==le&&(re.fillStyle=Ae.dr,le=Ae.dr);let pe=Math.round(Ae.dt*se)-Math.floor(.5*this.cg);const Oe=pe+this.cg-1,Fe=Math.round(Math.min(Ae.Xl,Ae.Jl)*ae),Ne=Math.round(Math.max(Ae.Xl,Ae.Jl)*ae);if(he!==null&&(pe=Math.max(he+1,pe),pe=Math.min(pe,Oe)),this.Xt.fu*se>2*ce)z(re,pe,Fe,Oe-pe+1,Ne-Fe+1,ce);else{const ze=Oe-pe+1;re.fillRect(pe,Fe,ze,Ne-Fe+1)}he=Oe}}bg(te,ee,ne){if(this.Xt===null)return;const{context:re,horizontalPixelRatio:se,verticalPixelRatio:ae}=te;let le="";const ce=this.gg(se);for(let he=ne.from;he<ne.to;he++){const fe=ee[he];let Ae=Math.round(Math.min(fe.Xl,fe.Jl)*ae),pe=Math.round(Math.max(fe.Xl,fe.Jl)*ae),Oe=Math.round(fe.dt*se)-Math.floor(.5*this.cg),Fe=Oe+this.cg-1;if(fe.cr!==le){const Ne=fe.cr;re.fillStyle=Ne,le=Ne}fe.mr&&(this.Xt.Ci&&(Oe+=ce,Ae+=ce,Fe-=ce,pe-=ce),Ae>pe||re.fillRect(Oe,Ae,Fe-Oe+1,pe-Ae+1))}}}class Re extends xe{constructor(){super(...arguments),this.Gw=new Te}LM(te,ee,ne){return{...this.mg(te,ee,ne),...ne.Ir(te)}}sM(){const te=this.Jn.W();this.Gw._t({Qs:this.Yw,fu:this.Qn.Lt().fu(),wg:te.wickVisible,Ci:te.borderVisible,ut:this.jw})}}const De={type:"HollowCandlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},DM:(ie,te)=>new Re(ie,te)};class Ie extends R{constructor(){super(...arguments),this.Xt=null,this.xg=[]}_t(te){this.Xt=te,this.xg=[]}lt({context:te,horizontalPixelRatio:ee,verticalPixelRatio:ne}){if(this.Xt===null||this.Xt.ct.length===0||this.Xt.ut===null)return;this.xg.length||this.Sg(ee);const re=Math.max(1,Math.floor(ne)),se=Math.round(this.Xt.Cg*ne)-Math.floor(re/2),ae=se+re;for(let le=this.Xt.ut.from;le<this.Xt.ut.to;le++){const ce=this.Xt.ct[le],he=this.xg[le-this.Xt.ut.from],fe=Math.round(ce.ft*ne);let Ae,pe;te.fillStyle=ce.cr,fe<=se?(Ae=fe,pe=ae):(Ae=se,pe=fe-Math.floor(re/2)+re),te.fillRect(he.qh,Ae,he.Pi-he.qh+1,pe-Ae)}}Sg(te){if(this.Xt===null||this.Xt.ct.length===0||this.Xt.ut===null)return void(this.xg=[]);const ee=Math.ceil(this.Xt.fu*te)<=1?0:Math.max(1,Math.floor(te)),ne=Math.round(this.Xt.fu*te)-ee;this.xg=new Array(this.Xt.ut.to-this.Xt.ut.from);for(let se=this.Xt.ut.from;se<this.Xt.ut.to;se++){const ae=this.Xt.ct[se],le=Math.round(ae.dt*te);let ce,he;if(ne%2){const fe=(ne-1)/2;ce=le-fe,he=le+fe}else{const fe=ne/2;ce=le-fe,he=le+fe-1}this.xg[se-this.Xt.ut.from]={qh:ce,Pi:he,Pg:le,ne:ae.dt*te,bt:ae.bt}}for(let se=this.Xt.ut.from+1;se<this.Xt.ut.to;se++){const ae=this.xg[se-this.Xt.ut.from],le=this.xg[se-this.Xt.ut.from-1];ae.bt===le.bt+1&&ae.qh-le.Pi!==ee+1&&(le.Pg>le.ne?le.Pi=ae.qh-ee-1:ae.qh=le.Pi+ee+1)}let re=Math.ceil(this.Xt.fu*te);for(let se=this.Xt.ut.from;se<this.Xt.ut.to;se++){const ae=this.xg[se-this.Xt.ut.from];ae.Pi<ae.qh&&(ae.Pi=ae.qh);const le=ae.Pi-ae.qh+1;re=Math.min(le,re)}if(ee>0&&re<4)for(let se=this.Xt.ut.from;se<this.Xt.ut.to;se++){const ae=this.xg[se-this.Xt.ut.from];ae.Pi-ae.qh+1>re&&(ae.Pg>ae.ne?ae.Pi-=1:ae.qh+=1)}}}class Be extends Un{constructor(){super(...arguments),this.Gw=new Ie}LM(te,ee,ne){return{...this.zM(te,ee),...ne.Ir(te)}}sM(){const te={ct:this.Yw,fu:this.Qn.Lt().fu(),ut:this.jw,Cg:this.Jn.Ut().Ht(this.Jn.W().base,u$1(this.Jn.Nt()).$t)};this.Gw._t(te)}}const Ve={type:"Histogram",isBuiltIn:!0,defaultOptions:{color:"#26a69a",base:0},DM:(ie,te)=>new Be(ie,te)},yr={...e$1,color:"#2196f3"},IContextKeyService=createDecorator$1("contextKeyService");function hasVolume(ie){return ie.visible_plots_set==="ohlcv"}const MILLISECONDS_FACTOR={ticks:1e3,seconds:1e3,minutes:60*1e3,days:1440*60*1e3,weeks:7*1440*60*1e3,months:NaN,range:NaN,invalid:NaN},LETTER_TO_KIND_MAP={T:"ticks",S:"seconds",D:"days",W:"weeks",M:"months",R:"range"},INTRADAY_KINDS=new Set(["ticks","seconds","minutes"]),INTERVAL_REGEX=/^(\d*)([TSHDWMR])$/,MINUTES_REGEX=/^(\d+)$/;function parseMultiplier(ie){return ie.length===0?1:parseInt(ie,10)}function isHour(ie){return ie>=60&&ie%60===0}let Interval$1=class So{constructor(te,ee){Ee(this,"_kind");Ee(this,"_multiplier");this._kind="invalid",this._multiplier=0,te!=="invalid"&&ee>0&&(this._kind=te,this._multiplier=ee)}kind(){return this._kind}guiKind(){return this.isMinuteHours()?"hours":this._kind}multiplier(){return this._multiplier}isValid(){return this._kind!=="invalid"&&this._multiplier>0}isIntraday(){return this.isValid()&&INTRADAY_KINDS.has(this._kind)}isTicks(){return this._kind==="ticks"}is1Tick(){return this.isTicks()&&this._multiplier===1}isSeconds(){return this._kind==="seconds"}isMinutes(){return this._kind==="minutes"}isMinuteHours(){return this.isMinutes()&&isHour(this._multiplier)}isDays(){return this._kind==="days"}isWeeks(){return this._kind==="weeks"}isMonths(){return this._kind==="months"}isRange(){return this._kind==="range"}isDWM(){return this.isValid()&&!this.isRange()&&!this.isIntraday()&&!this.isTicks()}isTimeBased(){return!this.isRange()}letter(){return!this.isValid()||this.isMinutes()?"":this._kind[0].toUpperCase()}value(){return this.isValid()?this.isMinutes()?`${this._multiplier}`:`${this._multiplier}${this.letter()}`:""}isEqualTo(te){if(!(te instanceof So))throw new Error("Argument is not an Interval");return this.isValid()&&te.isValid()&&this._kind===te.kind()&&this._multiplier===te.multiplier()}inMilliseconds(te=Date.now()){if(!this.isValid()||this.isRange())return NaN;if(this.isMonths()){const ee=new Date(te);return ee.setUTCMonth(ee.getUTCMonth()+this._multiplier),ee.valueOf()-te}return(MILLISECONDS_FACTOR[this._kind]??NaN)*this._multiplier}static parse(te){return So.parseExt(te).interval}static kind(te){return So.parse(te).kind()}static isEqual(te,ee){return So.parse(te).isEqualTo(So.parse(ee))}static isValid(te){return So.parse(te).isValid()}static isTicks(te){return So.parse(te).isTicks()}static isRange(te){return So.parse(te).isRange()}static isMinutes(te){return So.parse(te).isMinutes()}static isMinuteHours(te){return So.parse(te).isMinuteHours()}static isIntraday(te){return So.parse(te).isIntraday()}static isDWM(te){return So.parse(te).isDWM()}static isTimeBased(te){return So.parse(te).isTimeBased()}static normalize(te){const ee=So.parse(te);return ee.isValid()?ee.value():null}static parseExt(te){const ee=String(te).toUpperCase().split(",")[0];let ne=INTERVAL_REGEX.exec(ee);if(ne){const re=parseMultiplier(ne[1]),se=ne[2];if(se==="H")return{interval:new So("minutes",re*60),guiResolutionKind:"hours"};{const ae=LETTER_TO_KIND_MAP[se];return{interval:new So(ae,re),guiResolutionKind:ae}}}return ne=MINUTES_REGEX.exec(ee),ne?{interval:new So("minutes",parseInt(ne[1],10)),guiResolutionKind:"minutes"}:{interval:new So("invalid",0),guiResolutionKind:"invalid"}}};const II18nService=createDecorator$1("i18nService"),InputEventType=EventType$1;class BaseEvent{constructor(te,ee){Ee(this,"accepted",!1);this.type=te,this.source=ee}accept(){this.accepted=!0}ignore(){this.accepted=!1}isAccepted(){return this.accepted}asMouseInputEvent(){}isMouseInputEvent(){return!1}asChartInputEvent(){}isChartInputEvent(){return!1}asKeyboardInputEvent(){}isKeyboardInputEvent(){return!1}}class MouseInputEvent extends BaseEvent{constructor(ee,ne,re){super(ee,re);Ee(this,"localX");Ee(this,"localY");Ee(this,"shiftKey");this.localX=ne.localX,this.localY=ne.localY,this.shiftKey=ne.shiftKey}asMouseInputEvent(){return this}isMouseInputEvent(){return!0}}class ChartInputEvent extends MouseInputEvent{constructor(te,ee,ne){var re,se,ae;super(te,{localX:((re=ee.point)==null?void 0:re.x)??NaN,localY:((se=ee.point)==null?void 0:se.y)??NaN,shiftKey:!!((ae=ee.sourceEvent)!=null&&ae.shiftKey)},ne),this.params=ee}get hoveredObjectId(){return this.params.hoveredObjectId}get hoveredSeries(){return this.params.hoveredSeries}get logical(){return this.params.logical}get paneIndex(){return this.params.paneIndex}get point(){return this.params.point}get seriesData(){return this.params.seriesData}get sourceEvent(){return this.params.sourceEvent}get time(){return this.params.time}asChartInputEvent(){return this}isChartInputEvent(){return!0}}class KeyboardInputEvent extends BaseEvent{constructor(ee,ne,re){super(ee,re);Ee(this,"ctrlKey");Ee(this,"shiftKey");Ee(this,"altKey");Ee(this,"metaKey");Ee(this,"keyCode");Ee(this,"code");Ee(this,"init");this.ctrlKey=ne.ctrlKey,this.shiftKey=ne.shiftKey,this.altKey=ne.altKey,this.metaKey=ne.metaKey,this.keyCode=ne.keyCode,this.code=ne.code,this.init=ne}asKeyboardInputEvent(){return this}isKeyboardInputEvent(){return!0}}class ServiceCollection{constructor(...te){Ee(this,"_entries",new Map);for(const[ee,ne]of te)this.set(ee,ne)}set(te,ee){const ne=this._entries.get(te);return this._entries.set(te,ee),ne}has(te){return this._entries.has(te)}get(te){return this._entries.get(te)}}const IStudyService=createDecorator$1("studyService"),studyRegistry=new class extends GenericRegistry{};var ColorScheme=(ie=>(ie.DARK="dark",ie.LIGHT="light",ie))(ColorScheme||{});const IThemeService=createDecorator$1("themeService"),IUndoRedoService=createDecorator$1("undoRedoService");var UndoRedoElementType=(ie=>(ie[ie.Resource=0]="Resource",ie[ie.Workspace=1]="Workspace",ie))(UndoRedoElementType||{});class ChartContributions extends Disposable{constructor(){super();Ee(this,"_instantiationService",null);Ee(this,"_instances",this._register(new DisposableMap));Ee(this,"_pending",new Map);Ee(this,"_finishedInstantiation",[]);this._finishedInstantiation[ChartContributionInstantiation.Eager]=!1,this._finishedInstantiation[ChartContributionInstantiation.AfterFirstRender]=!1,this._finishedInstantiation[ChartContributionInstantiation.Eventually]=!1}initialize(ee,ne){this._instantiationService=ne;for(const re of ee){if(this._pending.has(re.id)){onUnexpectedError(new Error(`Cannot have two contributions with the same id ${re.id}`));continue}this._pending.set(re.id,re)}this._instantiateSome(ChartContributionInstantiation.Eager),this._register(runWhenIdle(()=>{this._instantiateSome(ChartContributionInstantiation.AfterFirstRender)})),this._register(runWhenIdle(()=>{this._instantiateSome(ChartContributionInstantiation.Eventually)},5e3))}get(ee){return this._instantiateById(ee),this._instances.get(ee)||null}_instantiateSome(ee){if(this._finishedInstantiation[ee])return;this._finishedInstantiation[ee]=!0;const ne=this._findPendingContributionsByInstantiation(ee);for(const re of ne)this._instantiateById(re.id)}_findPendingContributionsByInstantiation(ee){const ne=[];for(const[,re]of this._pending)re.instantiation===ee&&ne.push(re);return ne}_instantiateById(ee){const ne=this._pending.get(ee);if(ne){if(this._pending.delete(ee),!this._instantiationService)throw new Error("Cannot instantiate contributions before being initialized!");try{const re=this._instantiationService.createInstance(ne.ctor);this._instances.set(ne.id,re)}catch(re){onUnexpectedError(re)}}}}class ChartGuiService extends Disposable{constructor(){super();Ee(this,"_onCrosshairButtonMenuRequested",this._register(new Emitter));Ee(this,"onCrosshairButtonMenuRequested",this._onCrosshairButtonMenuRequested.event);Ee(this,"_onPaneTooltipRequested",this._register(new Emitter));Ee(this,"onPaneTooltipRequested",this._onPaneTooltipRequested.event);Ee(this,"_onPaneTooltipCancelled",this._register(new Emitter));Ee(this,"onPaneTooltipCancelled",this._onPaneTooltipCancelled.event);Ee(this,"store");this.store=writable({components:[]}),this._register(toDisposable(()=>Reflect.set(this,"store",null)))}showCrosshairButtonMenu(ee){this._onCrosshairButtonMenuRequested.fire(ee)}showPaneTooltip(ee){this._onPaneTooltipRequested.fire(ee)}hidePaneTooltip(){this._onPaneTooltipCancelled.fire()}showComponent(ee){const ne=generateUuid();return this.store.update(re=>(re.components.push({id:ne,Component:ee.Component,props:ee.props}),re)),{dispose:()=>{this.store.update(re=>{const se=re.components.findIndex(ae=>ae.id===ne);return se!==-1&&re.components.splice(se,1),{...re}})},update:re=>{this.store.update(se=>{const ae=se.components.find(le=>le.id===ne);return ae&&Object.assign(ae.props,re),{...se}})}}}}const tzData={"America/New_York":{time:[-2717668562,-1633298400,-1615154400,-1601848800,-1583704800,-1570399200,-1551650400,-1536530400,-1523224800,-1504476e3,-1491775200,-1473026400,-1459720800,-1441576800,-1428271200,-1410127200,-1396821600,-1378677600,-1365372e3,-1347228e3,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1189375200,-1176069600,-1157320800,-114462e4,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-905119200,-891813600,-880236e3,-76941e4,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-447285600,-431560800,-415836e3,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-17762,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Los_Angeles":{time:[-2717668378,-1633298400,-1615154400,-1601848800,-1583704800,-880236e3,-769420800,-765410400,-687995940,-662680800,-620866800,-608162400,-589417200,-576108e3,-557967600,-544658400,-526518e3,-513208800,-495068400,-481759200,-463618800,-450309600,-431564400,-418255200,-400114800,-386805600,-368665200,-355356e3,-337215600,-323906400,-305766e3,-292456800,-273711600,-261007200,-242262e3,-226533600,-210812400,-195084e3,-179362800,-163634400,-147913200,-13158e4,-116463600,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-28378,-28800,-25200,-28800,-25200,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800]},"America/Chicago":{time:[-2717668236,-1633298400,-1615154400,-1601848800,-1583704800,-1563746400,-1551650400,-1538949600,-1520200800,-1504476e3,-1491775200,-1473026400,-1459720800,-1441576800,-1428271200,-1410127200,-1396821600,-1378677600,-1365372e3,-1347228e3,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1189375200,-1176069600,-1157320800,-114462e4,-1125871200,-1112565600,-1094421600,-1081116e3,-1067810400,-1045432800,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-905119200,-891813600,-880236e3,-769413600,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-447285600,-431560800,-415836e3,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-21036,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600]},"America/Phoenix":{time:[-2717670498,-1633298400,-1615154400,-1601848800,-1583704800,-880236e3,-820540740,-812678340,-796867140,-84405600,-68680800,1924966800],offset:[-26898,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200]},"America/Toronto":{time:[-2366755200,-1632088800,-1615154400,-1601771400,-1583712e3,-1567375200,-1554681600,-1534716e3,-1524088800,-1503266400,-149238e4,-1471816800,-1460930400,-1440972e3,-1428876e3,-1409522400,-1397426400,-1378072800,-1365976800,-1346623200,-1333922400,-1315173600,-1301868e3,-1283724e3,-1270418400,-1252274400,-1238968800,-1220824800,-1207519200,-1188770400,-1176069600,-1157320800,-1144015200,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-880232400,-76941e4,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-634168800,-620863200,-602719200,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-384386400,-368661600,-352936800,-337212e3,-321487200,-305762400,-289432800,-273708e3,-257983200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,136346400,152071200,167796e3,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-19052,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-14400,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Vancouver":{time:[-2713910400,-1632088800,-1615154400,-880236e3,-769420800,-765410400,-747266400,-733960800,-715816800,-702511200,-684367200,-671061600,-652917600,-639612e3,-620863200,-608162400,-589413600,-576108e3,-557964e3,-544658400,-526514400,-513208800,-495064800,-481759200,-463615200,-450309600,-431560800,-418255200,-400111200,-386805600,-368661600,-355356e3,-337212e3,-323906400,-305762400,-292456800,-273708e3,-261007200,-242258400,-226533600,-210808800,-195084e3,-179359200,-163634400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,136346400,152071200,167796e3,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-29548,-28800,-25200,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800]},"America/Argentina/Buenos_Aires":{time:[-2372112e3,-1567468800,-1233446400,-1222992e3,-1205971200,-1194048e3,-117288e4,-1162512e3,-1141344e3,-1130976e3,-1109808e3,-109944e4,-1078272e3,-1067817600,-1046649600,-1036281600,-1015113600,-1004745600,-983577600,-973209600,-952041600,-941587200,-931046400,-900892800,-890352e3,-83376e4,-82728e4,-752284800,-733795200,-197337600,-190857600,-184204800,-164505600,-152668800,-132969600,-121132800,-101433600,-86832e3,-71107200,-54777600,-39052800,-23328e3,-7603200,128131200,136598400,596937600,605059200,624412800,636508800,656467200,667958400,687916800,699408e3,719366400,731462400,938908800,952041600,1198972800,1205625600,1224374400,1237075200,1924981200],offset:[-14028,-15408,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-10800,-10800,-7200,-10800,-7200,-10800]},"America/El_Salvador":{time:[-1546300800,546998400,559699200,578448e3,591148800,1924970400],offset:[-21408,-21600,-18e3,-21600,-18e3,-21600]},"America/Sao_Paulo":{time:[-1767225600,-1206968400,-1191369600,-1175385600,-1159833600,-633830400,-622076400,-602294400,-59184e4,-570758400,-560217600,-539136e3,-53136e4,-195436800,-184204800,-155174400,-150076800,-128908800,-121132800,-99964800,-89596800,-68428800,-57974400,499737600,511228800,530582400,540259200,562118400,571190400,592963200,602035200,624412800,634694400,656467200,666748800,687916800,697593600,719971200,728438400,750816e3,761702400,782265600,793152e3,813715200,823996800,84456e4,856051200,876096e3,888710400,908064e3,919555200,938908800,951609600,970963200,982454400,1003017600,1013904e3,1036281600,1045353600,1066521600,1076803200,1099353600,1108857600,1129420800,1140307200,1162684800,1172361600,119232e4,1203206400,1224374400,1234656e3,1255824e3,1266710400,1287273600,129816e4,1318723200,1330214400,1350777600,1361059200,1382227200,1392508800,1413676800,1424563200,1445126400,1456012800,1476576e3,1487462400,1508025600,1518912e3,1541289600,1550361600,1924981200],offset:[-11188,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800,-7200,-10800]},"America/Bogota":{time:[-2707689600,-1739059200,704851200,729043200,1924974e3],offset:[-17776,-17776,-18e3,-14400,-18e3]},"America/Caracas":{time:[-2524521600,-1826755200,-157766400,1197169200,1462069800,1924977600],offset:[-16064,-16060,-16200,-14400,-16200,-14400]},"America/Anchorage":{time:[-3225173303,-2188987200,-880236e3,-769428e3,-765410400,-86918400,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,438998400,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[50424,-35976,-36e3,-32400,-32400,-36e3,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-36e3,-32400,-32400,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400]},"Europe/Moscow":{time:[-2840140800,-1688256e3,-165681e4,-1641340800,-1627956e3,-1618700400,-1596416400,-1593804521,-1589846400,-1542416400,-1539478800,-1525305600,-1522713600,-1491177600,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,695786400,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1414288800,1925002800],offset:[9017,9017,9079,12679,9079,16279,12679,16279,14400,10800,14400,18e3,14400,10800,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800]},"Europe/Athens":{time:[-2344636800,-1686095940,-1182988800,-1178150400,-906854400,-904867200,-85725e4,-844473600,-828230400,-812419200,-552355200,-541641600,166492800,186195600,198036e3,213764400,228880800,244090800,260330400,275457600,291805200,307418400,323395200,338947200,354682800,370411200,386132400,401860800,417582e3,433310400,449031600,465364800,481086e3,496814400,512535600,528264e3,543985200,559713600,575434800,591163200,606884400,622612800,638334e3,654667200,670388400,686116800,701838e3,717566400,733287600,749016e3,764737200,780465600,796186800,811915200,828241200,846388800,859690800,877838400,891140400,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5692,5692,7200,10800,7200,10800,7200,3600,7200,3600,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Belgrade":{time:[-2713910400,-905821200,-85725e4,-844552800,-828219600,-812498400,-79677e4,-777938400,-766616400,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[4920,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Berlin":{time:[-2422051200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-938901600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-776556e3,-765925200,-761173200,-748476e3,-733266e3,-717627600,-714603600,-71037e4,-701902800,-684972e3,-670453200,-654127200,-639003600,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3208,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,10800,7200,3600,7200,3600,7200,10800,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Bratislava":{time:[-3786825600,-2469398400,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-938901600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-765320400,-746575200,-733352400,-728514e3,-72126e4,-716421600,-701902800,-684972e3,-670453200,-654213600,-639003600,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3464,3464,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Bucharest":{time:[-2469398400,-1213142400,-1187049600,-1175468400,-1159747200,-1144018800,-1127692800,-1111964400,-1096243200,-1080514800,-1064793600,-1049065200,-1033344e3,-1017615600,-1001894400,-986166e3,-970444800,-954716400,296611200,307497600,323823600,338950800,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670377600,686106e3,701827200,717555600,733276800,749005200,764726400,780451200,796176e3,811900800,828230400,846374400,859690800,877838400,891140400,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[6264,6264,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Budapest":{time:[-2498256e3,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1600466400,-1587243600,-1569708e3,-1555189200,-906771600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-778467600,-762649200,-749685600,-733269600,-717631200,-701902800,-686181600,-670453200,-654127200,-639003600,-492652800,-481161600,-461196e3,-449701200,-428536800,-418251600,-397087200,-386802e3,323827200,338950800,354672e3,370400400,386121600,40185e4,417571200,433299600,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[4580,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/London":{time:[-3852662400,-1691964e3,-1680469200,-1664143200,-1650142800,-1633903200,-1617483600,-1601848800,-1586034e3,-1570399200,-1552165200,-1538344800,-152253e4,-15075e5,-1490562e3,-1473631200,-1460926800,-1442786400,-1428872400,-1410732e3,-1396213200,-1379282400,-1364763600,-1348437600,-1333314e3,-1315778400,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-118998e4,-1175461200,-1159135200,-1143406800,-1126476e3,-1111957200,-1095631200,-1080507600,-1063576800,-1049058e3,-1032127200,-1017608400,-1001282400,-986158800,-969228e3,-950475600,-942012e3,-904514400,-896043600,-875484e3,-864594e3,-844034400,-832539600,-812584800,-798066e3,-781048800,-772059600,-764802e3,-748476e3,-733352400,-719445600,-717026400,-706741200,-699483600,-687996e3,-668034e3,-654732e3,-636584400,-622072800,-605739600,-590623200,-57429e4,-558568800,-542235600,-527119200,-512600400,-496274400,-481150800,-46422e4,-449701200,-432165600,-417646800,-401320800,-386197200,-369266400,-354747600,-337816800,-323298e3,-306972e3,-291848400,-276732e3,-257979600,-245282400,-22653e4,-213228e3,-195080400,-182383200,-163630800,-150933600,-132181200,-119484e3,-100731600,-88034400,-68677200,-59004e3,-37238400,57726e3,69818400,89175600,101268e3,120625200,132717600,152074800,164167200,183524400,196221600,214974e3,227671200,246423600,259120800,278478e3,290570400,309927600,32202e4,341377200,354675600,372823200,386125200,404272800,417574800,435722400,449024400,467776800,481078800,499226400,512528400,530676e3,543978e3,562125600,575427600,593575200,606877200,625629600,638326800,657079200,670381200,688528800,701830800,719978400,733280400,751428e3,76473e4,782877600,796179600,814327200,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],offset:[-75,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Luxembourg":{time:[-2069712e3,-1692493200,-1680476400,-1662339600,-165015e4,-1632002400,-1618693200,-1612656e3,-1604278800,-1585515600,-1574038800,-1552255200,-1539997200,-1520546400,-1507510800,-1490569200,-1473642e3,-1459116e3,-1444006800,-142767e4,-1411866e3,-1396220400,-1379293200,-1364770800,-1348448400,-1333321200,-1316394e3,-1301266800,-1284339600,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-1191189600,-1175461200,-1160344800,-1143406800,-1127685600,-1111957200,-1096840800,-1080507600,-1063576800,-1049058e3,-1033336800,-1017608400,-1002492e3,-986158800,-969228e3,-950475600,-942012e3,-935182800,-85725e4,-844552800,-828219600,-812498400,-797979600,-781048800,-766616400,-745452e3,-733266e3,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[1476,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Madrid":{time:[-2177453684,-1631926800,-1616886e3,-1601168400,-158535e4,-1442451600,-142767e4,-1379293200,-1364770800,-1348448400,-1333321200,-1316390400,-1301266800,-1284339600,-1269817200,-1026954e3,-1017615600,-1001898e3,-999478800,-986083200,-954111600,-940208400,-873075600,-862614e3,-842835600,-828313200,-811386e3,-796863600,-779936400,-765414e3,-748486800,-733964400,-652323600,-639010800,135126e3,150253200,166575600,181702800,196815600,212547600,22887e4,243997200,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[-884,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Paris":{time:[-2486592e3,-1855958400,-1689814800,-1680393600,-1665363600,-1648339200,-1635123600,-1616889600,-1604278800,-158544e4,-1574038800,-1552262400,-1539997200,-1520553600,-1507510800,-1490572800,-1470618e3,-1459123200,-1444006800,-1427673600,-1411952400,-1396224e3,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1253494800,-1238371200,-1221440400,-1206921600,-1191200400,-1175472e3,-1160355600,-1143417600,-1127696400,-1111968e3,-1096851600,-1080518400,-1063587600,-1049068800,-1033347600,-1017619200,-1002502800,-986169600,-969238800,-950486400,-942012e3,-932432400,-85725e4,-844552800,-828219600,-812498400,-800064e3,-796258800,-781048800,-766616400,196822800,212547600,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[561,561,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Prague":{time:[-3786825600,-2469398400,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-938901600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-765320400,-746575200,-733352400,-728514e3,-72126e4,-716421600,-701902800,-684972e3,-670453200,-654213600,-639003600,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3464,3464,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Rome":{time:[-3252096e3,-2403562204,-1690761600,-168048e4,-1664755200,-1648944e3,-163512e4,-1616889600,-1604275200,-1585526400,-1571011200,-1555286400,-932428800,-85725e4,-844552800,-828219600,-812498400,-798066e3,-781048800,-76671e4,-750895200,-733352400,-719452800,-70191e4,-689205600,-670453200,-114048e3,-103161600,-81993600,-71708400,-50544e3,-40258800,-18489600,-8204400,1296e4,23245200,43804800,54694800,75859200,86749200,107913600,118198800,138758400,149648400,170812800,181098e3,202262400,212547600,233107200,243997200,265161600,276051600,296611200,307501200,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[2996,2996,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Vienna":{time:[-2422051200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1569708e3,-1555794e3,-938901600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-780181200,-748476e3,-733266e3,-717631200,-701902800,-684972e3,-670453200,323827200,338947200,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3921,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Warsaw":{time:[-2840140800,-1717027200,-1693702800,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1600466400,-1587157200,-1501718400,-931730400,-85725e4,-844552800,-828219600,-812498400,-796600800,-778723200,-762652800,-748483200,-733266e3,-715212e3,-701902800,-684972e3,-670453200,-654127200,-639003600,-397090800,-386805600,-371084400,-355356e3,-334191600,-323301600,-307580400,-291852e3,-271292400,-260402400,-239842800,-228952800,-208393200,-197503200,-176338800,-166053600,228877200,244000800,260326800,276055200,291776400,307504800,323830800,338954400,354675600,370404e3,386125200,401853600,417574800,433303200,449024400,465357600,481078800,496807200,512528400,528256800,543978e3,559706400,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[5040,5040,3600,7200,3600,7200,3600,7200,7200,10800,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Istanbul":{time:[-2840140800,-1869868800,-1693699200,-168048e4,-1570406400,-1552176e3,-1538352e3,-1522540800,-1507507200,-1490572800,-1440201600,-1428019200,-1409702400,-1396483200,-931046400,-922665600,-917827200,-892425600,-875836800,-764726400,-744336e3,-733795200,-716428800,-701913600,-684979200,-670464e3,-654134400,-639014400,-62208e4,-60696e4,-590025600,-575510400,-235612800,-194832e3,-177724800,-165715200,107917200,121226400,133927200,152676e3,164685600,184125600,196221600,215575200,228880800,245815200,260330400,267926400,428464800,433908e3,468122400,482806800,496720800,512528400,528256800,543978e3,559706400,575427600,591156e3,606877200,622605600,638326800,65466e4,670381200,686109600,701830800,717559200,733280400,749008800,764125200,780458400,796179600,811908e3,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301281200,1319947200,1332644400,1351396800,1364698800,1382846400,1396234800,1414296e3,1427598e3,1446955200,1459047600,1473206400,1925002800],offset:[6952,7016,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,10800,14400,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,10800]},"Europe/Zurich":{time:[-3675196800,-2385244800,-904431600,-891122400,-872982e3,-859672800,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[2048,1786,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Australia/Sydney":{time:[-2364076800,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,386737200,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,636519600,657079200,667969200,688528800,699418800,719978400,731473200,752032800,762922800,783482400,794372400,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,967341600,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],offset:[36292,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600]},"Australia/Brisbane":{time:[-2366755200,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,625629600,636519600,657079200,667969200,688528800,699418800,1925028e3],offset:[36728,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3]},"Australia/Adelaide":{time:[-2364076800,-2230156800,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,384318e3,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,637729200,657079200,667969200,688528800,701233200,719978400,731473200,752032800,764132400,783482400,796186800,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,972784800,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],offset:[33260,32400,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800,34200,37800]},"Australia/ACT":{time:[-2364076800,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,-828309600,-813186e3,57722400,68007600,89172e3,100062e3,120621600,131511600,152071200,162961200,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,386737200,404877600,415767600,436327200,447217200,467776800,478666800,499226400,511326e3,530071200,542775600,562125600,57483e4,59418e4,606279600,625629600,636519600,657079200,667969200,688528800,699418800,719978400,731473200,752032800,762922800,783482400,794372400,814932e3,828241200,846381600,859690800,877831200,891140400,909280800,92259e4,941335200,954039600,967341600,985489200,1004234400,1017543600,1035684e3,1048993200,1067133600,1080442800,1099188e3,1111892400,1130637600,1143946800,1162087200,1174791600,1193536800,1207450800,1223172e3,1238900400,1254621600,127035e4,1286071200,1301799600,1317520800,1333249200,1349575200,1365303600,1381024800,1396753200,1412474400,1428202800,1443924e3,1459652400,1475373600,1491102e3,1506823200,1522551600,1538877600,1554606e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],offset:[36292,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600,36e3,39600]},"Asia/Almaty":{time:[-1441152e3,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,695786400,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1709251200,192501e4],offset:[18468,18e3,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,21600,18e3,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,25200,21600,18e3]},"Asia/Ashkhabad":{time:[-1441152e3,-1247529600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,695786400,192501e4],offset:[14012,14400,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,21600,18e3,18e3,14400,18e3]},"Asia/Colombo":{time:[-2840140800,-2019686400,-883267200,-862617600,-764028e3,832982400,846289800,1145061e3,1925011800],offset:[19164,19172,19800,21600,23400,19800,23400,21600,19800]},"Asia/Dhaka":{time:[-2524521600,-891561600,-872035200,-862617600,-576115200,1245452400,1262303999,1925013600],offset:[21700,21200,23400,19800,23400,21600,25200,21600]},"Asia/Tokyo":{time:[-2587678861,-683769600,-672274800,-654739200,-640825200,-620265600,-609375600,-588816e3,-577926e3,1925024400],offset:[33539,32400,36e3,32400,36e3,32400,36e3,32400,36e3,32400]},"Asia/Taipei":{time:[-2335219200,-1017792e3,-766191600,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-639100800,-620784e3,-607564800,-589248e3,-576028800,-562896e3,-541728e3,-528681600,-510192e3,-497145600,-478656e3,-465609600,-449798400,-433987200,-418176e3,-402451200,-38664e4,-370915200,-355104e3,-339379200,-323568e3,-302486400,-291945600,-270950400,-260409600,134006400,149817600,165542400,181353600,299635200,307584e3,1925020800],offset:[29160,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Singapore":{time:[-2177452800,-2038176e3,-1167609600,-1073001600,-894153600,-879638400,-766972800,378689400,1925020800],offset:[24925,24925,25200,26400,26400,27e3,32400,27e3,28800]},"Asia/Karachi":{time:[-1988150400,-862617600,-764121600,-576115200,38793600,1018137600,1033862400,1212278400,1225497600,1239753600,1257033600,192501e4],offset:[16092,19800,23400,19800,18e3,18e3,21600,18e3,21600,18e3,21600,18e3]},"Asia/Manila":{time:[-3944678400,-2229292800,-1046649600,-1038700800,-873244800,-794188800,-496195200,-489283200,259372800,275184e3,1925020800],offset:[-57360,29040,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Shanghai":{time:[-2177452800,-1600646400,-1585872e3,-933638400,-922060800,-908841600,-888796800,-881020800,-767836800,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-649987200,515556e3,527047200,545191200,558496800,577245600,589946400,608695200,622000800,640144800,653450400,671594400,6849e5,1925020800],offset:[29143,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Seoul":{time:[-1948752e3,-1830384e3,-767318400,-681177600,-672192e3,-654739200,-640828800,-623376e3,-609379200,-588816e3,-577929600,-498096e3,-462672e3,-451699200,-429753600,-418262400,-399513600,-387417600,-368064e3,-355968e3,-336614400,-324518400,-305164800,-293068800,-264902400,547610400,560919600,57906e4,592369200,1925024400],offset:[30472,30600,32400,32400,36e3,32400,36e3,32400,36e3,32400,36e3,32400,30600,34200,30600,34200,30600,34200,30600,34200,30600,34200,30600,34200,30600,32400,36e3,32400,36e3,32400]},"Asia/Tehran":{time:[-1704153600,-1090454400,227833200,24624e4,259632e3,271126800,283996800,296611200,306547200,322444800,338515200,673228800,685497600,701222400,71712e4,732758400,748656e3,764294400,780192e3,795830400,811728e3,827366400,843264e3,858988800,874886400,890524800,906422400,922060800,937958400,953596800,969494400,985219200,1001116800,1016755200,1032652800,1048291200,1064188800,1079827200,1095724800,1111449600,1127347200,1206057600,1221955200,123768e4,1253577600,1269216e3,1285113600,1300752e3,1316649600,1332288e3,1348185600,1363910400,1379808e3,1395446400,1411344e3,1426982400,144288e4,1458518400,1474416e3,1490140800,1506038400,1521676800,1537574400,1553212800,1569110400,1584748800,1600646400,1616371200,1632268800,1647907200,1663804800,1925004600],offset:[12344,12344,12600,16200,14400,18e3,14400,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600,16200,12600]},"Asia/Dubai":{time:[-1577923200,1925006400],offset:[13272,14400]},"Asia/Kolkata":{time:[-3645216e3,-3155673600,-2019686400,-891561600,-872035200,-862617600,-764121600,1925011800],offset:[21208,21200,19270,19800,23400,19800,23400,19800]},"Asia/Hong_Kong":{time:[-2056663398,-900882e3,-891547200,-884217600,-761176800,-747878400,-728508600,-717021e3,-697059e3,-683757e3,-668028600,-654726600,-636579e3,-623277e3,-605129400,-591827400,-573679800,-559773e3,-541625400,-528323400,-510179400,-498083400,-478729800,-466633800,-446675400,-435184200,-415225800,-403129800,-383776200,-371680200,-352326600,-340230600,-320877e3,-308781e3,-288822600,-277331400,-257373e3,-245881800,-225923400,-213827400,-194473800,-182377800,-163024200,-148509e3,-132784200,-117059400,-101334600,-85609800,-69280200,-53555400,-37830600,-22105800,-6381e3,9343800,25068600,40793400,56518200,72243e3,88572600,104297400,120022200,126070200,151471800,167196600,182921400,198646200,214371e3,295414200,309324600,1925020800],offset:[27402,28800,32400,30600,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Bangkok":{time:[-2840140800,-1570060800,1925017200],offset:[24124,24124,25200]},"Asia/Chongqing":{time:[-2177452800,-1600646400,-1585872e3,-933638400,-922060800,-908841600,-888796800,-881020800,-767836800,-745804800,-733795200,-716860800,-699580800,-683856e3,-670636800,-65232e4,-649987200,515556e3,527047200,545191200,558496800,577245600,589946400,608695200,622000800,640144800,653450400,671594400,6849e5,1925020800],offset:[29143,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Asia/Jerusalem":{time:[-2840140800,-1640995200,-933631200,-923086800,-919029600,-857336400,-844293600,-825800400,-812671200,-794178e3,-779839200,-762642e3,-748303200,-731106e3,-681948e3,-673214400,-667947600,-652312800,-636411600,-622072800,-608936400,-591832800,-572475600,-558568800,-542840400,-527724e3,-514414800,-490831200,-482965200,-459381600,-451515600,-428536800,-418251600,-400111200,-387406800,142387200,150854400,167184e3,178675200,334108800,337741200,452649600,46233e4,482284800,494380800,516758400,526435200,545443200,558489600,576633600,589334400,609897600,620784e3,638323200,651628800,669772800,683683200,701827200,715737600,733708800,747187200,765158400,778032e3,796608e3,810086400,826848e3,842832e3,858902400,874195200,890352e3,90504e4,923018400,936324e3,955677600,970794e3,986778e3,1001293200,1017363600,1033952400,1048813200,1065142800,1081299600,1095814800,1112320800,1128823200,1143770400,1159668e3,117522e4,1189908e3,1206669600,1223172e3,1238119200,1254016800,1269568800,1284256800,1301623200,1317520800,1333072800,1348365600,1364522400,1382839200,1395972e3,1414288800,1427421600,1445738400,1458871200,1477792800,1490320800,1509242400,1521770400,1540692e3,1553824800,1572141600,1585274400,1603591200,1616724e3,1635645600,1648173600,1667095200,1679623200,1698544800,1711677600,1729994400,1743127200,1761444e3,1774576800,1792893600,1806026400,1824948e3,1837476e3,1856397600,1868925600,1887847200,190098e4,1919296800,1932429600],offset:[8454,8440,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,14400,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Asia/Kuala_Lumpur":{time:[-2177452800,-2038176e3,-1167609600,-1073001600,-894153600,-879638400,-766972800,378689400,1925020800],offset:[24406,24925,25200,26400,26400,27e3,32400,27e3,28800]},"Asia/Kuwait":{time:[-631152e3,1925002800],offset:[11516,10800]},"Asia/Muscat":{time:[-1577923200,1925006400],offset:[14064,14400]},"Asia/Nicosia":{time:[-1518912e3,166579200,182304e3,200966400,21384e4,228873600,243993600,260323200,276134400,291772800,307497600,323827200,338947200,354672e3,370396800,386121600,401846400,417571200,433296e3,449020800,465350400,481075200,4968e5,512524800,528249600,543974400,559699200,575424e3,591148800,606873600,622598400,638323200,654652800,670377600,686102400,701827200,717552e3,733276800,749001600,764726400,780451200,796176e3,811900800,828230400,843955200,85968e4,875404800,891129600,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[8008,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Asia/Qatar":{time:[-1577923200,76204800,1925002800],offset:[12368,14400,10800]},"Asia/Riyadh":{time:[-719625600,1925002800],offset:[11212,10800]},"Asia/Yangon":{time:[-2840140800,-1577923200,-873244800,-778377600,1925015400],offset:[23087,23087,23400,32400,23400]},"Pacific/Auckland":{time:[-3192393600,-1330293600,-1320012e3,-1300658400,-1287352800,-1269208800,-1255903200,-1237759200,-1224453600,-1206309600,-1192399200,-117486e4,-1160949600,-1143410400,-1125871200,-1112565600,-1094421600,-1081116e3,-1062972e3,-1049666400,-1031522400,-1018216800,-1000072800,-986767200,-968018400,-955317600,-936568800,-923263200,-757382400,152676e3,162356400,183520800,195015600,215575200,226465200,247024800,257914800,278474400,289364400,309924e3,320814e3,341373600,352263600,372823200,384318e3,404877600,415767600,436327200,447217200,467776800,478666800,499226400,510116400,530676e3,541566e3,562125600,573620400,59418e4,60507e4,623815200,637729200,655264800,669178800,686714400,700628400,718164e3,732682800,749613600,764132400,781063200,795582e3,812512800,827031600,844567200,858481200,876016800,889930800,907466400,921985200,938916e3,953434800,970365600,984884400,100242e4,1016334e3,1033869600,1047783600,1065319200,1079838e3,1096768800,1111287600,1128218400,1142737200,1159668e3,1174186800,1191117600,1207450800,1222567200,1238900400,1254016800,127035e4,1285466400,1301799600,1316916e3,1333249200,1348970400,1365303600,138042e4,1396753200,1411869600,1428202800,1443319200,1459652400,1474768800,1491102e3,1506218400,1522551600,1538272800,1554606e3,1569722400,1586055600,1601172e3,1617505200,1632621600,1648954800,1664071200,1680404400,1695520800,1712458800,1727575200,1743908400,1759024800,1775358e3,1790474400,1806807600,1821924e3,1838257200,1853373600,1869706800,1885428e3,1901761200,1916877600,1933210800],offset:[41944,41400,45e3,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,41400,43200,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800,43200,46800]},"Pacific/Chatham":{time:[-3192393600,-757382400,152678700,162359100,183523500,195018300,215577900,226467900,247027500,257917500,278477100,289367100,309926700,320816700,341376300,352266300,372825900,384320700,404880300,415770300,436329900,447219900,467779500,478669500,499229100,510119100,530678700,541568700,562128300,573623100,594182700,605072700,623817900,637731900,655267500,669181500,686717100,700631100,718166700,732685500,749616300,764135100,781065900,795584700,812515500,827034300,844569900,858483900,876019500,889933500,907469100,921987900,938918700,953437500,970368300,984887100,1002422700,1016336700,1033872300,1047786300,1065321900,1079840700,1096771500,1111290300,1128221100,1142739900,1159670700,1174189500,1191120300,1207453500,1222569900,1238903100,1254019500,1270352700,1285469100,1301802300,1316918700,1333251900,1348973100,1365306300,1380422700,1396755900,1411872300,1428205500,1443321900,1459655100,1474771500,1491104700,1506221100,1522554300,1538275500,1554608700,1569725100,1586058300,1601174700,1617507900,1632624300,1648957500,1664073900,1680407100,1695523500,1712461500,1727577900,1743911100,1759027500,1775360700,1790477100,1806810300,1821926700,1838259900,1853376300,1869709500,1885430700,1901763900,1916880300,1933213500],offset:[44028,44100,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500,45900,49500]},"Pacific/Fakaofo":{time:[-2177452800,1325203200,1925038800],offset:[-41096,-39600,46800]},"Pacific/Honolulu":{time:[-2334139200,-1157320800,-1155470400,-880236e3,-769429800,-765410400,-712188e3,1924956e3],offset:[-37886,-37800,-34200,-37800,-34200,-34200,-37800,-36e3]},"America/Mexico_City":{time:[-1514763396,-1343091600,-1234828800,-1220317200,-1207180800,-1191369600,-975283200,-963187200,-917136e3,-907372800,-821923200,-810086400,-627523200,-613008e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,989114400,1001815200,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1175392800,1193536800,1207447200,1224986400,1238896800,1256436e3,1270346400,1288490400,1301796e3,131994e4,1333245600,1351389600,13653e5,1382839200,1396749600,1414288800,1428199200,1445738400,1459648800,1477792800,1491098400,1509242400,1522548e3,1540692e3,1554602400,1572141600,1586052e3,1603591200,1617501600,1635645600,1648951200,1667095200,1924970400],offset:[-23796,-25200,-21600,-25200,-21600,-25200,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600,-18e3,-21600]},"Africa/Cairo":{time:[-2185401600,-929836800,-923097600,-906163200,-892857600,-875836800,-857779200,-844300800,-825811200,-812678400,-794188800,-779846400,-762652800,-399081600,-38664e4,-368323200,-355104e3,-336783600,-323643600,-305161200,-292021200,-273625200,-260485200,-242089200,-228949200,-210553200,-197413200,-178930800,-165790800,-147394800,-134254800,-115858800,-102632400,-84322800,-71096400,-52700400,-39474e3,-21164400,-7938e3,10371600,23598e3,41907600,55134e3,7353e4,86756400,105066e3,118292400,136602e3,149828400,168138e3,181364400,199760400,212986800,231296400,244522800,262832400,276058800,294368400,307594800,325990800,339217200,357526800,370753200,396406800,402289200,426819600,433825200,452221200,465447600,483757200,496983600,515293200,528519600,546829200,560055600,578451600,591678e3,610419600,623214e3,641523600,65475e4,673059600,686286e3,704682e3,717908400,736218e3,749444400,767754e3,780980400,799027200,812332800,830476800,843782400,861926400,875232e3,893376e3,906681600,925430400,938736e3,95688e4,970185600,988329600,1001635200,1019779200,1033084800,1051228800,1064534400,1083283200,1096588800,1114732800,1128038400,1146182400,1158883200,1177632e3,1189123200,1209081600,1219968e3,1240531200,1250812800,1272585600,1281484800,1284076800,1285891200,1400198400,1403827200,1406851200,1411689600,168264e4,1698364800,1714089600,1730419200,1745539200,1761868800,1776988800,1793318400,1809043200,1824768e3,1840492800,1856217600,1871942400,1887667200,1903392e3,1919721600,1934841600],offset:[7509,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Africa/Casablanca":{time:[-1773014400,-956361600,-950486400,-942019200,-761184e3,-617241600,-605145600,-81432e3,-71107200,141264e3,147225600,199756800,207705600,231292800,244252800,265507200,271036800,448243200,504921600,1212278400,1220227200,1243814400,1250812800,1272758400,1281225600,1301788800,1312070400,1335664800,1342753200,1345428e3,1348974e3,1367114400,1373166e3,13761e5,1382842800,1396144800,1403924400,1406944800,1414292400,1427594400,1434250800,1437271200,1445742e3,1459044e3,1465095600,1468116e3,1477796400,1490493600,1495335600,1498960800,1509246e3,1521943200,1526180400,1529200800,1540695600,1557025200,1560045600,1587265200,1590890400,161811e4,1621130400,164835e4,1651975200,1679194800,1682215200,1710039600,171306e4,1740279600,1743904800,1771124400,1774144800,1801969200,1804989600,1832209200,1835834400,1863054e3,1866074400,1893294e3,1896919200,1924138800,1927159200],offset:[-1820,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Africa/Johannesburg":{time:[-2458166400,-2109283200,-860968800,-845244e3,-829519200,-813794400,1924999200],offset:[6720,5400,7200,10800,7200,10800,7200]},"Africa/Nairobi":{time:[-194616e4,-1309737600,-1261958400,-1041379200,-865296e3,1925002800],offset:[8836,9e3,10800,9e3,9900,10800]},"Africa/Tunis":{time:[-27972e5,-1855958400,-969238800,-950486400,-941936400,-891129600,-877824e3,-85725e4,-844552800,-842911200,-84222e4,-828223200,-812498400,-796262400,-781048800,-766627200,231206400,243910800,262828800,276051600,581126400,591152400,606873600,622602e3,64152e4,654656400,1114905600,1128045600,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1924995600],offset:[2444,561,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Asia/Kathmandu":{time:[-1577923200,504921600,1925012700],offset:[20476,19800,20700]},"US/Mountain":{time:[-2717668796,-1633298400,-1615154400,-1601848800,-1583704800,-1570399200,-1551650400,-1538949600,-1534111200,-880236e3,-769417200,-765410400,-147909600,-13158e4,-11646e4,-100130400,-84405600,-68680800,-52956e3,-37231200,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[-25196,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200,-21600,-25200]},"Europe/Helsinki":{time:[-2890252800,-1535932800,-875664e3,-859762800,354679200,370407600,386128800,401857200,417582e3,433310400,449031600,465364800,481086e3,496814400,512535600,528264e3,543985200,559713600,575434800,591163200,606884400,622612800,638334e3,654667200,670388400,686116800,701838e3,717566400,733287600,749016e3,764737200,780465600,796186800,811915200,828241200,846388800,859690800,877838400,891140400,909288e3,92259e4,941342400,954039600,972792e3,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5989,5989,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Stockholm":{time:[-2871676800,-2208988800,-1692493200,-1680476400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[4332,3614,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Copenhagen":{time:[-2524521600,-2398291200,-1692493200,-1680483600,-935107200,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-769381200,-747007200,-736376400,-715212e3,-706741200,-683157600,-675291600,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3020,3020,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Atlantic/Reykjavik":{time:[-1956614400,-1668214800,-1647212400,-1636678800,-161343e4,-1605142800,-1581894e3,-1539565200,-153135e4,-968029200,-952293600,-942012e3,-920239200,-909961200,-888789600,-877906800,-857944800,-846457200,-826495200,-815007600,-795045600,-783558e3,-762991200,-752108400,-731541600,-717634800,-700092e3,-686185200,-668642400,-654735600,-636588e3,-623286e3,-605743200,-591836400,-573688800,-559782e3,-542239200,-528332400,-510789600,-496882800,-47934e4,-465433200,-447890400,-433983600,-415836e3,-401929200,-384386400,-370479600,-352936800,-33903e4,-321487200,-307580400,-290037600,-276130800,-258588e3,-244681200,-226533600,-212626800,-195084e3,-181177200,-163634400,-149727600,-132184800,-118278e3,-100735200,-86828400,-68680800,-54774e3,1924992e3],offset:[-5280,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0]},"Europe/Tallinn":{time:[-2840140800,-1638316800,-1632002400,-1618693200,-1593820800,-1535932800,-927936e3,-892944e3,-85725e4,-844552800,-828219600,-812498400,-797644800,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909288e3,92259e4,941342400,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5940,5940,3600,7200,3600,5940,7200,10800,7200,3600,7200,3600,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Riga":{time:[-2840140800,-1632002400,-1618693200,-1601676e3,-1597266e3,-1377302400,-928022400,-899510400,-85725e4,-844552800,-828219600,-812498400,-79677e4,-795830400,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,843966e3,859690800,877838400,891140400,909288e3,92259e4,941342400,985489200,1004241600,1017543600,1035691200,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[5794,5794,9394,5794,9394,5794,7200,10800,7200,3600,7200,3600,7200,3600,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"Europe/Vilnius":{time:[-2840140800,-1672531200,-1585094400,-1561248e3,-1553558400,-928195200,-900115200,-85725e4,-844552800,-828219600,-812498400,-802137600,354931200,370742400,386467200,402278400,418003200,433814400,449625600,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891140400,909284400,922586400,941338800,1048993200,1067140800,1080442800,1099195200,1111892400,1130644800,1143342e3,1162094400,1174791600,1193544e3,1206846e3,1224993600,1238295600,1256443200,1269745200,1288497600,1301194800,1319947200,1332644400,1351396800,1364698800,1382846400,1396148400,1414296e3,1427598e3,1445745600,1459047600,14778e5,1490497200,1509249600,1521946800,1540699200,1554001200,1572148800,1585450800,1603598400,1616900400,1635652800,164835e4,1667102400,1679799600,1698552e3,1711854e3,1730001600,1743303600,1761451200,1774753200,1792900800,1806202800,1824955200,1837652400,1856404800,1869102e3,1887854400,1901156400,1919304e3,1932606e3],offset:[6076,5040,5736,3600,7200,3600,10800,7200,3600,7200,3600,7200,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,14400,10800,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,7200,3600,7200,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200,10800,7200]},"America/Lima":{time:[-2524521600,-1938556800,-1009843200,-1002067200,-986774400,-971049600,-955324800,-9396e5,504921600,512697600,536457600,544233600,631152e3,638928e3,757382400,765158400,1924974e3],offset:[-18492,-18516,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3]},"America/Santiago":{time:[-2524521600,-1892678400,-1688428800,-1619222400,-1593820800,-1336003200,-13176e5,-1304380800,-1286064e3,-1272844800,-1254528e3,-1241308800,-1222992e3,-1209772800,-1191369600,-1178150400,-870566400,-865296e3,-740534400,-736646400,-718070400,-713667600,-36633600,-23932800,-3369600,7516800,24451200,37756800,55900800,69206400,87955200,100656e3,118195200,132105600,150854400,163555200,182304e3,195609600,213753600,227059200,245203200,258508800,277257600,289958400,308707200,321408e3,340156800,353462400,371606400,384912e3,403056e3,416361600,434505600,447811200,46656e4,479260800,498009600,510710400,529459200,545184e3,560908800,574214400,592358400,605664e3,624412800,637113600,653443200,668563200,687312e3,700617600,718761600,732067200,750211200,763516800,781660800,794966400,813715200,826416e3,845164800,85968e4,876614400,88992e4,906854400,923184e3,939513600,952819200,971568e3,984268800,1003017600,1015718400,1034467200,1047168e3,1065916800,1079222400,1097366400,1110672e3,1128816e3,1142121600,1160870400,1173571200,119232e4,1206835200,1223769600,1237075200,1255219200,1270339200,1286668800,1304812800,1313884800,1335657600,1346544e3,1367107200,1378598400,1398556800,1410048e3,1463270400,1471132800,149472e4,1502582400,1526169600,1534032e3,1554595200,1567900800,1586044800,1599350400,1617494400,16308e5,1648944e3,1662854400,1680393600,1693699200,1712448e3,1725753600,1743897600,1757203200,1775347200,1788652800,1806796800,1820102400,1838246400,1851552e3,1870300800,1883001600,1901750400,1915056e3,19332e5],offset:[-16965,-16965,-18e3,-16965,-14400,-16965,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-18e3,-14400,-10800,-14400,-18e3,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800,-14400,-10800]},"Asia/Bahrain":{time:[-897868800,-820540800,76204800,1925002800],offset:[12140,12600,14400,10800]},"Asia/Jakarta":{time:[-3231273600,-1451693568,-117288e4,-876614400,-766022400,-683856e3,-620784e3,-189388800,1925017200],offset:[25632,25632,26400,27e3,32400,27e3,28800,27e3,25200]},"Africa/Lagos":{time:[-2035584e3,-1940889600,-1767225600,-1588464e3,1924995600],offset:[815,0,815,1800,3600]},"Pacific/Norfolk":{time:[-2177452800,-599616e3,152071200,162961200,1443924e3,1570327200,1586055600,1601776800,1617505200,1633226400,1648954800,1664676e3,1680404400,1696125600,1712458800,172818e4,1743908400,1759629600,1775358e3,1791079200,1806807600,1822528800,1838257200,1853978400,1869706800,1886032800,1901761200,1917482400,1933210800],offset:[40312,40320,41400,45e3,41400,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200,39600,43200]},"America/Juneau":{time:[-3225169588,-2188987200,-880236e3,-769420800,-765410400,-21506400,-5781600,9943200,25668e3,41392800,57722400,73447200,89172e3,104896800,120621600,126669600,152071200,162352800,183520800,199245600,215575200,230695200,247024800,262749600,278474400,294199200,309924e3,325648800,341373600,357098400,372823200,388548e3,404877600,419997600,436327200,438998400,452052e3,467776800,483501600,499226400,514951200,530676e3,544586400,562125600,576036e3,59418e4,607485600,625629600,638935200,657079200,670989600,688528800,702439200,719978400,733888800,752032800,765338400,783482400,796788e3,814932e3,828842400,846381600,860292e3,877831200,891741600,909280800,923191200,941335200,954640800,972784800,986090400,1004234400,1018144800,1035684e3,1049594400,1067133600,1081044e3,1099188e3,1112493600,1130637600,1143943200,1162087200,1173578400,1194141600,1205028e3,1225591200,1236477600,1257040800,1268532e3,1289095200,1299981600,1320544800,1331431200,1351994400,1362880800,1383444e3,1394330400,1414893600,142578e4,1446343200,1457834400,1478397600,1489284e3,1509847200,1520733600,1541296800,1552183200,1572746400,1583632800,1604196e3,1615687200,1636250400,1647136800,16677e5,1678586400,1699149600,1710036e3,1730599200,1741485600,1762048800,1772935200,1793498400,1804989600,1825552800,1836439200,1857002400,1867888800,1888452e3,1899338400,1919901600,1930788e3],offset:[54139,-32261,-28800,-25200,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-25200,-28800,-28800,-28800,-25200,-28800,-25200,-28800,-25200,-32400,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400,-28800,-32400]},"Asia/Ho_Chi_Minh":{time:[-2004048e3,-1851552e3,-852080400,-782614800,-767836800,-718070400,-457743600,-315622800,171849600,1925017200],offset:[25590,25590,25200,28800,32400,25200,28800,25200,28800,25200]},"Australia/Perth":{time:[-2337897600,-1672524e3,-1665349200,-883605600,-876085200,-860364e3,-844635600,152071200,162961200,436327200,447217200,690343200,699418800,1165111200,1174791600,1193536800,1206846e3,1224986400,1238295600,1925020800],offset:[27804,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800,32400,28800]},"Europe/Malta":{time:[-2403475200,-1690761600,-168048e4,-1664755200,-1648944e3,-163512e4,-1616889600,-1604275200,-1585526400,-1571011200,-1555286400,-932428800,-85725e4,-844552800,-828219600,-812584800,-798066e3,-781048800,-76671e4,-750895200,-733352400,-719452800,-70191e4,-689205600,-670453200,-114048e3,-103161600,-81993600,-71708400,-50544e3,-40258800,-18489600,-8204400,1296e4,23245200,43804800,54694800,75859200,86749200,102384e3,118112400,135734400,148525200,167191200,180496800,198640800,211946400,230090400,243396e3,26154e4,274845600,292989600,306295200,323316e3,338349600,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[3484,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Amsterdam":{time:[-4260211200,-1693699200,-168048e4,-1663452e3,-1650142800,-1633212e3,-1617483600,-1601157600,-1586034e3,-1569708e3,-1554584400,-1538258400,-1523134800,-15075e5,-1490562e3,-1470175200,-1459112400,-1443996e3,-1427662800,-1406671200,-1396213200,-1376949600,-1364763600,-1345413600,-1333314e3,-1313791200,-1301259600,-1282255200,-126981e4,-1250719200,-1238360400,-1219183200,-1206910800,-1186956e3,-1175461200,-1156024800,-1143406800,-1124488800,-1111957200,-1092952800,-1080507600,-1061330400,-1049058e3,-1029189600,-1025740800,-1017608400,-998258400,-986158800,-966722400,-954104400,-935020800,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-766616400,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[1172,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,1172,4772,4800,1200,4800,1200,4800,1200,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Brussels":{time:[-2840140800,-2450994150,-1740355200,-1693699200,-1680476400,-1663452e3,-1650142800,-1632002400,-1618693200,-1613822400,-1604278800,-1585526400,-1574038800,-1552262400,-1539997200,-1520553600,-1507510800,-1490572800,-1473642e3,-1459123200,-1444006800,-1427673600,-1411952400,-1396224e3,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-1191189600,-1175461200,-1160344800,-1143406800,-1127685600,-1111957200,-1096840800,-1080507600,-1063576800,-1049058e3,-1033336800,-1017608400,-1002492e3,-986158800,-969228e3,-950475600,-942012e3,-934664400,-85725e4,-844552800,-828219600,-812498400,-798066e3,-781048800,-766616400,-745452e3,-733266e3,228880800,244004400,260330400,276058800,29178e4,307508400,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[1050,1050,0,3600,7200,3600,7200,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Europe/Lisbon":{time:[-1830386205,-1689555600,-1677798e3,-1667437200,-1647734400,-1635814800,-1616198400,-1604365200,-1584662400,-1572742800,-155304e4,-1541206800,-1521504e3,-1442451600,-1426809600,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1221440400,-1206921600,-1191200400,-1175472e3,-1127696400,-1111968e3,-1096851600,-1080518400,-1063587600,-1049068800,-1033347600,-1017619200,-1002502800,-986169600,-969238800,-950486400,-942022800,-922665600,-906944400,-891129600,-877309200,-873680400,-864e6,-857952e3,-845859600,-842835600,-831340800,-825897600,-81441e4,-810781200,-799891200,-794448e3,-782960400,-779331600,-768441600,-762998400,-749091600,-733363200,-717631200,-701902800,-686181600,-670453200,-654732e3,-639003600,-623282400,-607554e3,-591832800,-575499600,-559778400,-54405e4,-528328800,-512600400,-496879200,-481150800,-465429600,-449701200,-43398e4,-417646800,-401925600,-386197200,-370476e3,-354747600,-339026400,-323298e3,-307576800,-291848400,-276127200,-260398800,-244677600,-228344400,-212623200,-196894800,-181173600,-165445200,-149724e3,-133995600,-118274400,212547600,228268800,243997200,260323200,276051600,291772800,307504800,323222400,338954400,354675600,370404e3,386125200,401853600,417578400,433303200,449024400,465357600,481078800,496807200,512528400,528256800,543978e3,559706400,575427600,591156e3,606877200,622605600,638326800,65466e4,670381200,686109600,701830800,717559200,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],offset:[-2205,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,7200,3600,0,3600,7200,3600,0,3600,7200,3600,0,3600,7200,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,3600,7200,3600,7200,3600,7200,3600,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Dublin":{time:[-2821651200,-1691964e3,-1680469200,-1664143200,-1650142800,-1633903200,-1617483600,-1601848800,-1586034e3,-1570399200,-1552165200,-1538344800,-152253e4,-15075e5,-1490562e3,-1473631200,-1460926800,-1442786400,-1428872400,-1410732e3,-1396213200,-1379282400,-1364763600,-1348437600,-1333314e3,-1315778400,-1301259600,-1284328800,-126981e4,-1253484e3,-1238360400,-1221429600,-1206910800,-118998e4,-1175461200,-1159135200,-1143406800,-1126476e3,-1111957200,-1095631200,-1080507600,-1063576800,-1049058e3,-1032127200,-1017608400,-1001282400,-986158800,-969228e3,-950475600,-942012e3,-733352400,-719445600,-699483600,-684972e3,-668034e3,-654732e3,-636584400,-622072800,-605739600,-590623200,-57429e4,-558568800,-542235600,-527119200,-512600400,-496274400,-481150800,-46422e4,-449701200,-432165600,-417646800,-401320800,-386197200,-369266400,-354747600,-337816800,-323298e3,-306972e3,-291848400,-276732e3,-257979600,-245282400,-22653e4,-213228e3,-195080400,-182383200,-163630800,-150933600,-132181200,-119484e3,-100731600,-88034400,-68677200,-59004e3,57726e3,69818400,89175600,101268e3,120625200,132717600,152074800,164167200,183524400,196221600,214974e3,227671200,246423600,259120800,278478e3,290570400,309927600,32202e4,341377200,354675600,372823200,386125200,404272800,417574800,435722400,449024400,467776800,481078800,499226400,512528400,530676e3,543978e3,562125600,575427600,593575200,606877200,625629600,638326800,657079200,670381200,688528800,701830800,719978400,733280400,751428e3,76473e4,782877600,796179600,814327200,828234e3,846381600,859683600,877831200,891133200,909280800,922582800,941335200,954032400,972784800,985482e3,1004234400,1017536400,1035684e3,1048986e3,1067133600,1080435600,1099188e3,1111885200,1130637600,1143334800,1162087200,1174784400,1193536800,1206838800,1224986400,1238288400,1256436e3,1269738e3,1288490400,1301187600,131994e4,1332637200,1351389600,1364691600,1382839200,1396141200,1414288800,1427590800,1445738400,1459040400,1477792800,149049e4,1509242400,1521939600,1540692e3,1553994e3,1572141600,1585443600,1603591200,1616893200,1635645600,1648342800,1667095200,1679792400,1698544800,1711846800,1729994400,1743296400,1761444e3,1774746e3,1792893600,1806195600,1824948e3,1837645200,1856397600,1869094800,1887847200,1901149200,1919296800,1932598800],offset:[-1521,-1521,2079,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0,3600,0]},"Europe/Oslo":{time:[-2366755200,-1691881200,-1680566400,-927507600,-85725e4,-844552800,-828219600,-812498400,-79677e4,-781048800,-765320400,-340840800,-324507600,-308786400,-293058e3,-277336800,-261608400,-245887200,-230158800,-214437600,-198709200,-182988e3,-166654800,-147909600,-135205200,323834400,338958e3,354679200,370407600,386128800,401857200,417578400,433306800,449028e3,465361200,481082400,496810800,512532e3,528260400,543981600,55971e4,575431200,591159600,606880800,622609200,638330400,654663600,670384800,686113200,701834400,717562800,733284e3,749012400,764733600,780462e3,796183200,811911600,828237600,846385200,859687200,877834800,891136800,909284400,922586400,941338800,954036e3,972788400,985485600,1004238e3,101754e4,1035687600,1048989600,1067137200,1080439200,1099191600,1111888800,1130641200,1143338400,1162090800,1174788e3,1193540400,1206842400,122499e4,1238292e3,1256439600,1269741600,1288494e3,1301191200,1319943600,1332640800,1351393200,1364695200,1382842800,1396144800,1414292400,1427594400,1445742e3,1459044e3,1477796400,1490493600,1509246e3,1521943200,1540695600,1553997600,1572145200,1585447200,1603594800,1616896800,1635649200,1648346400,1667098800,1679796e3,1698548400,1711850400,1729998e3,17433e5,1761447600,1774749600,1792897200,1806199200,1824951600,1837648800,1856401200,1869098400,1887850800,1901152800,1919300400,1932602400],offset:[2580,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600,7200,3600]},"Atlantic/Azores":{time:[-2713910400,-1830383672,-1689555600,-1677798e3,-1667437200,-1647734400,-1635814800,-1616198400,-1604365200,-1584662400,-1572742800,-155304e4,-1541206800,-1521504e3,-1442451600,-1426809600,-1379293200,-1364774400,-1348448400,-1333324800,-1316394e3,-1301270400,-1284339600,-1269820800,-1221440400,-1206921600,-1191200400,-1175472e3,-1127696400,-1111968e3,-1096851600,-1080518400,-1063587600,-1049068800,-1033347600,-1017619200,-1002502800,-986169600,-969238800,-950486400,-942022800,-922665600,-906944400,-891129600,-877309200,-873680400,-864e6,-857952e3,-845859600,-842835600,-831340800,-825897600,-81441e4,-810781200,-799891200,-794448e3,-782960400,-779331600,-768441600,-762998400,-749091600,-733363200,-717631200,-701902800,-686181600,-670453200,-654732e3,-639003600,-623282400,-607554e3,-591832800,-575499600,-559778400,-54405e4,-528328800,-512600400,-496879200,-481150800,-465429600,-449701200,-43398e4,-417646800,-401925600,-386197200,-370476e3,-354747600,-339026400,-323298e3,-307576800,-291848400,-276127200,-260398800,-244677600,-228344400,-212623200,-196894800,-181173600,-165445200,-149724e3,-133995600,-118274400,228268800,243997200,260323200,276051600,291772800,307504800,323222400,338954400,354675600,370404e3,386125200,401853600,417578400,433303200,449024400,465357600,481078800,496807200,512528400,528256800,543978e3,559706400,575427600,591156e3,606877200,622605600,638326800,65466e4,670381200,686109600,701830800,717559200,733280400,749005200,764726400,780454800,796176e3,811904400,828230400,846378e3,85968e4,877827600,891129600,909277200,922579200,941331600,954028800,972781200,985478400,1004230800,1017532800,1035680400,1048982400,106713e4,1080432e3,1099184400,1111881600,1130634e3,1143331200,1162083600,1174780800,1193533200,1206835200,1224982800,1238284800,1256432400,1269734400,1288486800,1301184e3,1319936400,1332633600,1351386e3,1364688e3,1382835600,1396137600,1414285200,1427587200,1445734800,1459036800,1477789200,1490486400,1509238800,1521936e3,1540688400,1553990400,1572138e3,158544e4,1603587600,1616889600,1635642e3,1648339200,1667091600,1679788800,1698541200,1711843200,1729990800,1743292800,1761440400,1774742400,179289e4,1806192e3,1824944400,1837641600,1856394e3,1869091200,1887843600,1901145600,1919293200,1932595200],offset:[-6160,-6872,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,0,-3600,-7200,-3600,0,-3600,-7200,-3600,0,-3600,-7200,-3600,0,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,-7200,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,0,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600,0,-3600]}},SUNDAY=1,MONDAY=2,TUESDAY=3,WEDNESDAY=4,THURSDAY=5,FRIDAY=6,SATURDAY=7,minutesPerDay=1440,millisecondsPerDay=864e5;class Timezone{constructor(te){Ee(this,"_invalid",!1);Ee(this,"_name");Ee(this,"tz");this._name=te;let ee=Reflect.get(tzData,te);!ee&&oe&&(ee=oe.instance().getTimezoneData(te)),ee||(ee={time:[],offset:[]},this._invalid=!0),ee.time.length!==ee.offset.length&&(ee={time:[],offset:[]},this._invalid=!0);const ne=ee;if(!ne.time_utc){const re=ee.time,se=ee.offset,ae=re.length,le=new Array(ae);for(let ce=0;ce<ae;ce++)re[ce]*=1e3,se[ce]*=1e3,le[ce]=re[ce]-se[ce];ne.time_utc=le}this.tz=ne}offset_utc(te){return Timezone.offset(this.tz.time_utc,this.tz.offset,te)}offset_loc(te){return Timezone.offset(this.tz.time,this.tz.offset,te)}name(){return this._name}is_valid(){return!this._invalid}correction_loc(te){const ee=this.tz.time,ne=this.tz.offset,re=binarySearch(ee,te);if(re<1)return 0;const se=ne[re]-ne[re-1];return se>0&&te-ee[re-1]<=se?se:0}static offset(te,ee,ne){const re=binarySearch(te,ne);return re===-1?0:ee[re]}}function get_year(ie){return ie.getUTCFullYear()}function get_month(ie){return ie.getUTCMonth()}function get_hours(ie){return ie.getUTCHours()}function get_minutes(ie){return ie.getUTCMinutes()}function get_day_of_month(ie){return ie.getUTCDate()}function get_day_of_week(ie){return ie.getUTCDay()+1}function get_minutes_from_midnight(ie){return get_hours(ie)*60+get_minutes(ie)}function get_minutes_with_hours(ie){return get_minutes_from_midnight(ie)}function set_hms(ie,te,ee,ne,re,se){ie.setUTCHours(te),ie.setUTCMinutes(ee),ie.setUTCSeconds(ne),ie.setUTCMilliseconds(re)}function add_date(ie,te){ie.setTime(ie.getTime()+te*millisecondsPerDay)}function cloneDate(ie){return new Date(ie.getTime())}function is_leap_year(ie){return ie%4===0&&(ie%100!==0||ie%400===0)}function get_cal(ie,te,ee,ne,re=0,se=0,ae=0){const le=new Date(Date.UTC(te,ee,ne,re,se,ae)),ce=ie.offset_utc(+le);return new Date(le.valueOf()-ce)}function get_cal_from_unix_timestamp_ms(ie,te){return new Date(te+ie.offset_utc(te))}function get_cal_utc(ie,te,ee,ne=0,re=0,se=0){return new Date(Date.UTC(ie,te,ee,ne,re,se))}function get_timezone(ie){return new Timezone(ie)}let oe;function binarySearch(ie,te){const ee=ie.length;if(ee===0)return-1;if(isNaN(te))throw Error("Key is NaN");let ne=0,re=ee-1,se=trunc((ne+re)/2);for(;;){if(ie[se]>te){if(re=se-1,re<ne)return se}else if(ne=se+1,re<ne)return se<ee-1?se+1:-1;se=trunc((ne+re)/2)}}function trunc(ie){return ie|0}function addLeadingZero(ie){return addLeadingZeros(ie,2)}function addLeadingZeros(ie,te=2){const ee=ie.toString(),ne=Math.max(0,te-ee.length);return"0".repeat(ne)+ee}class BusinessDay{constructor(te,ee,ne){Ee(this,"year");Ee(this,"month");Ee(this,"day");this.year=te,this.month=ee,this.day=ne}toString(){return`${addLeadingZeros(this.year,4)}-${addLeadingZero(this.month)}-${addLeadingZero(this.day)}`}toyyyymmdd(){return`${addLeadingZeros(this.year,4)}${addLeadingZero(this.month)}${addLeadingZero(this.day)}`}compareTo(te){return this.year>te.year||this.year===te.year&&this.month>te.month||this.year===te.year&&this.month===te.month&&this.day>te.day?1:this.year===te.year&&this.month===te.month&&this.day===te.day?0:-1}before(te){return this.compareTo(te)===-1}toCalendar(te){return get_cal(te??get_timezone("Etc/UTC"),this.year,this.month-1,this.day)}firstDayOfYear(){return new BusinessDay(this.year,1,1)}static fromCalendar(te){return new BusinessDay(get_year(te),get_month(te)+1,get_day_of_month(te))}}const DaysOfWeek=[SUNDAY,MONDAY,TUESDAY,WEDNESDAY,THURSDAY,FRIDAY,SATURDAY],WorkingDays=[MONDAY,TUESDAY,WEDNESDAY,THURSDAY,FRIDAY],monthLengths=[0,31,28,31,30,31,30,31,31,30,31,30,31];function devFormatTime(ie){for(;ie>1440;)ie-=1440;const ee=ie%60;return Math.floor((ie-ee)/60)+":"+ee}let _devWeekDayLabels=null;function devGetWeekDayLabels(){return _devWeekDayLabels||(_devWeekDayLabels=DaysOfWeek.reduce((ie,te)=>{const ee=te<7?te+1:1,ne=new Date(2018,0,te).toLocaleString(window.navigator.language,{weekday:"short"});return ie[ee]=ne,ie},{}),_devWeekDayLabels)}class SessionEntry{constructor(te,ee,ne){Ee(this,"_dayOfWeek");Ee(this,"_start");Ee(this,"_length");should(Number.isFinite(te)&&Number.isFinite(ee)&&Number.isFinite(ne),"Invalid arguments"),this._dayOfWeek=te,this._start=ee,this._length=ne}start(){return this._start+minutesPerDay*this.sessionStartDaysOffset()}startOffset(){return this._start}sessionStartDaysOffset(){return this._start>=0?0:this._start%minutesPerDay===0?-Math.ceil(this._start/minutesPerDay):-Math.floor(this._start/minutesPerDay)}isOvernight(){return this._start<0}dayOfWeek(){return this._dayOfWeek}sessionStartDayOfWeek(){let te=this._dayOfWeek-this.sessionStartDaysOffset();return te<SUNDAY&&(te+=7),te}length(){return this._length}compareTo(te){const ee=this._weight(),ne=ee+this._length,re=te._weight(),se=re+te._length;return ee<=re&&re<ne||re<=ee&&ee<se?0:ee>re?1:-1}contains(te){const ee=get_minutes_with_hours(te),ne=get_day_of_week(te);return this._contains(ee,ne)}_weight(){return this._dayOfWeek*minutesPerDay+this._start}_contains(te,ee){let ne=ee-this._dayOfWeek;ne>0&&(ne-=7);const re=ne*minutesPerDay+te;return re>=this._start&&re<this._start+this._length}toString(){const te=this.sessionStartDayOfWeek(),ee=this.sessionStartDaysOffset(),ne=this.sessionStartDaysOffset()+this.length();let re=te+(ee===ne?0:ee);for(;re>7;)re-=7;const se=te!==this.dayOfWeek()||re!==this.dayOfWeek(),ae=se?devGetWeekDayLabels()[te]:"",le=se?devGetWeekDayLabels()[re]:"";return`${devFormatTime(this.start())}/${ae}-${devFormatTime(this.start()+this.length())}/${le}`}}function compareSessions(ie,te){return ie.compareTo(te)}class SessionEntries{constructor(te,ee,ne,re){Ee(this,"_entriesList");Ee(this,"_entriesByDay");Ee(this,"_firstDayOfWeek");Ee(this,"_weekEndsCount");Ee(this,"_maxTradingDayLength",null);this._entriesList=te,this._entriesByDay=ee,this._firstDayOfWeek=ne,this._weekEndsCount=re}firstDayOfWeek(){return this._firstDayOfWeek}entriesByDay(){return this._entriesByDay}list(){return this._entriesList}isWeekEnd(te){return!this._entriesByDay.has(te)}weekEndsCount(){return this._weekEndsCount}longestSessionLength(){return this._entriesList.length===0?0:Math.max(...this._entriesList.map(te=>te.length()))}maxTradingDayLength(){if(this._maxTradingDayLength===null){const te=new Map;for(const ne of this._entriesList){const re=ne.dayOfWeek(),se=te.get(re)??0;te.set(re,se+ne.length())}let ee=0;for(const ne of te.values())ee=Math.max(ee,ne);this._maxTradingDayLength=ee}return this._maxTradingDayLength}}class SessionHistoryEntry{constructor(te,ee,ne){Ee(this,"_startDay");Ee(this,"_specEndDay");Ee(this,"_entries");this._startDay=te,this._specEndDay=ee,this._entries=ne}getEntries(){return this._entries}getStartDay(){return this._startDay}getSpecEndDay(){return this._specEndDay}isOpenEnded(){return this._specEndDay==null}}class SessionParser{constructor(){Ee(this,"historyEntries",[]);Ee(this,"timezone","");Ee(this,"hasHistoryCorrections",!1);Ee(this,"adjustSessionsIndexes",null);Ee(this,"_firstDayOfWeek",null)}parseSessions(te,ee){this._parseHistoryEntries(te,ee,!1)}parseSessionsAndValidateDateTime(te,ee){this._parseHistoryEntries(te,ee,!0)}static parseHolidaysAndCorrections(te,ee,ne,re){return this._parseHolidaysAndCorrectionsImpl(te,ee,ne,re)}static parseHolidaysAndCorrectionsAndValidateDateTime(te,ee,ne){return this._parseHolidaysAndCorrectionsImpl(te,ee,ne,!0)}_clearAll(){this.timezone="",this.historyEntries=[],this.adjustSessionsIndexes=[]}_parseHistoryEntries(te,ee,ne){this._clearAll();const re=ee.split("/");let se=null;this.hasHistoryCorrections=re.length>1;for(let ae=0;ae<re.length;ae++){const le=re[ae].split("#");let ce;if(ae!==re.length-1){if(le.length!==2)throw new Error(`bad session history entry definition: ${re[ae]}`);ce=SessionParser._parseDay(le[1],"session history entry end",ne).toCalendar()}else{if(le.length!==1)throw new Error(`bad session history entry definition: ${re[ae]}`);ce=null}if(se!==null&&ce!==null&&ce.getTime()<se.getTime())throw new Error(`history sessions are not listed in ascending order (${se} -> ${ce})`);const he=this._parseSessionsImpl(te,le[0],ne),fe=this._adjustStartToPreviousSession(he.firstDayOfWeek()),Ae=new SessionHistoryEntry(fe,ce,he);this.historyEntries.push(Ae),se=ce}}_parseSessionsImpl(te,ee,ne){this.timezone=te,ee=this._parseFirstDayOfWeek(ee);const re=new Map,se=[];if(ee.toLowerCase()==="24x7")for(const ce of DaysOfWeek){const he=SessionParser._createSessionEntry(ce,0,0,0,0);se.push(he),re.set(ce,[he])}else{let ce=!1;const he=new Map;for(const fe of ee.split("|")){const Ae=fe.split(":").filter(Boolean);if(Ae.length!==1&&Ae.length!==2)throw new Error(`bad session section: ${fe}`);const pe=Ae.length===1;if(pe){if(ce)throw new Error(`duplicated default section: ${fe}`);ce=!0}const Oe=pe?WorkingDays:SessionParser._parseWorkingDays(Ae[1]);for(const Fe of Oe)pe&&he.has(Fe)||he.set(Fe,Ae[0])}for(const fe of DaysOfWeek){const Ae=he.get(fe);if(Ae!==void 0)for(const pe of Ae.split(",").filter(Boolean)){const Oe=SessionParser._parseSessionEntry(fe,pe,ne),Fe=re.get(fe)??[];Fe.push(Oe),se.push(Oe),re.set(fe,Fe)}}}se.sort(compareSessions);const ae=new Set;for(const ce of se)ae.add(ce.dayOfWeek());const le=7-ae.size;return new SessionEntries(se,re,ensure(this._firstDayOfWeek),le)}_parseFirstDayOfWeek(te){const ee=te.split(";");if(this._firstDayOfWeek=MONDAY,ee.length>2)throw new Error(`bad sessions spec: ${te}`);if(ee.length===1)return te;let ne=1,re=ee[0].includes("-")?NaN:parseInt(ee[0]);if(isNaN(re)&&(ne=0,re=parseInt(ee[1])),re<SUNDAY||re>SATURDAY)throw new Error(`bad sessions spec: ${te}`);return this._firstDayOfWeek=re,ee[ne]}_adjustStartToPreviousSession(te){if(this.historyEntries.length===0)return null;const ee=ensure(this.historyEntries[this.historyEntries.length-1].getSpecEndDay()),ne=te-get_day_of_week(ee);if(ne===0)return ee;const re=cloneDate(ee);return add_date(re,ne),re.getTime()<=ee.getTime()&&add_date(re,7),re}static _parseSessionEntry(te,ee,ne){const re=ee.split("-");if(re.length!==2)throw new Error(`bad session entry: ${ee}`);let se=0,ae=re[0];if(ae.includes("F")){const Ae=ae.split("F");ae=Ae[0],se=Ae[1]!==""?parseInt(Ae[1]):1}let le=0,ce=re[1];if(ce.includes("F")){const Ae=ce.split("F");ce=Ae[0],le=Ae[1]!==""?parseInt(Ae[1]):1}const he=this._minutesFromHHMM(ae,ee,ne),fe=this._minutesFromHHMM(ce,ee,ne);return this._createSessionEntry(te,he,fe,se,le)}static _minutesFromHHMM(te,ee,ne){if(te.length===4&&/^[0-9]+$/.test(te)){const re=parseInt(te),se=Math.trunc(re/100),ae=re%100;if(!ne||se<24&&ae<60)return se*60+ae}throw new Error(`incorrect entry syntax: ${ee}`)}static _parseDay(te,ee,ne){if(te.length===8&&/^[0-9]+$/.test(te)){const re=parseInt(te.substring(0,4)),se=parseInt(te.substring(4,6)),ae=parseInt(te.substring(6,8));if(!ne||this._isValidDayOfMonth(ae,se,re))return new BusinessDay(re,se,ae)}throw new Error(`bad ${ee} date: ${te}`)}static _isValidDayOfMonth(te,ee,ne){return ee<1||ee>12||te<1||te>monthLengths[ee]?!!(ee===2&&te===29&&is_leap_year(ne)):!0}static _parseWorkingDays(te){const ee=[];for(let ne=0;ne<te.length;ne++){const re=te.charCodeAt(ne)-48;if(re<1||re>7)throw new Error(`Invalid days specification: ${te}`);ee.includes(re)||ee.push(re)}return ee}static _createSessionEntry(te,ee,ne,re,se){should(re>=0&&re<7),should(se>=0&&se<7),ne===0&&(ne=minutesPerDay),re===se&&ne<=ee&&re++,should(re>=se),re>0&&(ee-=re*minutesPerDay),se>0&&(ne-=se*minutesPerDay);const ae=ne-ee;return should(te>=SUNDAY&&te<=SATURDAY),should(ee<minutesPerDay),should(ae>0),new SessionEntry(te,ee,ae)}static _parseHolidaysAndCorrectionsImpl(te,ee,ne,re){const se=new Map;if(ee!==""){const ae=[];for(const le of ee.split(",")){const ce=this._parseDay(le,"holiday",re);se.set(ce,ae)}}if(ne==="")return se;for(const ae of ne.split(";")){const le=ae.split(":");if(le.length!==2)throw new Error(`bad correction section: ${ae}`);const ce=le[0],he=le[1],fe=[];if(ce!=="dayoff")for(const Ae of ce.split(",")){const pe=this._parseSessionEntry(1,Ae,re);fe.push(pe)}for(const Ae of he.split(",")){const pe=this._parseDay(Ae,"correction",re),Oe=get_day_of_week(pe.toCalendar()),Fe=fe.map(Ne=>new SessionEntry(Oe,Ne.startOffset(),Ne.length()));se.set(pe,Fe)}}return se}}class Cache{constructor(te){Ee(this,"_value");this._value=te}get(){return this._value}set(te){this._value=te}}const defaultTimezone=get_timezone("Etc/UTC");class SessionsSpec{constructor(te="Etc/UTC",ee="0000-0000",ne="",re="",se=!1){Ee(this,"_entries");Ee(this,"_hasHistoryCorrections");Ee(this,"_presentHistoryEntry");Ee(this,"_timezone");Ee(this,"_timezoneObj");Ee(this,"_holidayAndCorrectionMap");Ee(this,"_entriesHash");Ee(this,"_borderWeeksIndicesHash");Ee(this,"_yearToWeeksIndicesHash");Ee(this,"_weekIndicesOfLastHistoryWeek");Ee(this,"_presentStartWeekIndex");Ee(this,"_yearToCalculatedAddedWeekIndicesHash");Ee(this,"_isThereCorrections");const ae=new SessionParser;se?ae.parseSessionsAndValidateDateTime(te,ee):ae.parseSessions(te,ee),this._entries=ae.historyEntries,this._hasHistoryCorrections=ae.hasHistoryCorrections,this._presentHistoryEntry=ae.historyEntries[ae.historyEntries.length-1],this._timezone=ae.timezone,this._timezoneObj=get_timezone(ae.timezone),this._holidayAndCorrectionMap=se?SessionParser.parseHolidaysAndCorrectionsAndValidateDateTime(te,ne,re):SessionParser.parseHolidaysAndCorrections(te,ne,re,se),this._entriesHash=new Map;const le=this._prepareSessionsBorderParams();this._borderWeeksIndicesHash=le.borderWeeksIndicesHash,this._yearToWeeksIndicesHash=le.yearToWeeksIndicesHash,this._weekIndicesOfLastHistoryWeek=le.weekIndicesOfLastHistoryWeek,this._presentStartWeekIndex=le.startPresentSessionWeekIndex,this._yearToCalculatedAddedWeekIndicesHash=new Map,this._isThereCorrections=!(ne===""&&re===""&&this._weekIndicesOfLastHistoryWeek===null);for(const[ce]of this._holidayAndCorrectionMap)NOTIMPLEMENTED(ce)}_prepareSessionsBorderParams(){const te=new Map,ee=new Map;let ne=null;this._entries.length>1&&(ne=Array.from({length:this._entries.length-1},()=>0));let re=0;for(let se=0;se<this._entries.length-1;se++){const ae=this._entries[se+1],le=ensure(ae.getStartDay()),ce=SessionsSpec._getWeekIndexImpl(le);te.set(ce,se+1),this._addToYearHash(ee,le,ce),this._entriesHash.set(ce,new Cache(null)),ne&&(ne[se]=ce),re=ce}return{borderWeeksIndicesHash:te,yearToWeeksIndicesHash:ee,startPresentSessionWeekIndex:re,weekIndicesOfLastHistoryWeek:ne}}_addToYearHash(te,ee,ne){const re=get_year(ee);let se=te.get(re);se===void 0&&(se=[],te.set(re,se)),se.push(ne)}getWeekIndex(te){return this._isThereCorrections?SessionsSpec._getWeekIndexImpl(te):0}getEntriesForWeek(te){var Oe;if(!this._isThereCorrections)return this._presentHistoryEntry.getEntries();should(te>=0);const ee=this._entriesHash.get(te);if(ee!==void 0){const Fe=ee.get();if(Fe!==null)return Fe}let ne;const re=this._borderWeeksIndicesHash.get(te);re===void 0?ne=this._getHistoryAndIndexForWeek(te).getEntries():ne=this._prepareBorderWeekHistory(re);const se=new Map(ne.entriesByDay()),ae=[...ne.list()],le=this._weekIndexToLocalDateTime(te),ce=this._weekIndexToLocalDateTime(te+1),he=BusinessDay.fromCalendar(le),fe=BusinessDay.fromCalendar(ce);for(const[Fe,Ne]of this._selectHolidays(he,fe)){const ze=get_day_of_week(Fe.toCalendar()),He=Ne;ae.filter(je=>je.dayOfWeek()!==ze).push(...He),He.length===0?se.delete(ze):se.set(ze,He)}ae.sort(compareSessions);const Ae=DaysOfWeek.length-se.size,pe=new SessionEntries(ae,se,ne.firstDayOfWeek(),Ae);return(Oe=this._entriesHash.get(te))==null||Oe.set(pe),pe}_selectHolidays(te,ee){const ne=new Set;for(const[re,se]of this._holidayAndCorrectionMap)re.compareTo(te)>=0&&re.compareTo(ee)<0&&ne.add([re,se]);return ne}_prepareBorderWeekHistory(te){const ee=this._entries[te-1],ne=this._entries[te],re=new Map,se=[],ae=get_day_of_week(ensure(ne.getStartDay()));for(let ce=0;ce<DaysOfWeek.length;ce++){const he=DaysOfWeek[ce];if(he<ae){const fe=ee.getEntries().entriesByDay().get(he);fe!==void 0&&(se.push(...fe),re.set(he,fe))}else{const fe=ne.getEntries().entriesByDay().get(he);fe!==void 0&&(se.push(...fe),re.set(he,fe))}}const le=ne.getEntries().firstDayOfWeek();return new SessionEntries(se,re,le,0)}_weekIndexToLocalDateTime(te){const ne=Math.floor(86400*te*7+86400-62167219200),re=get_cal_from_unix_timestamp_ms(defaultTimezone,ne*1e3);return set_hms(re,0,0,0,0),re}_getHistoryAndIndexForWeek(te){if(this._presentStartWeekIndex<=te)return this._presentHistoryEntry;const ee=this._getIndexOfHistoryEntry(te);return this._entries[ee]}_getIndexOfHistoryEntry(te){let ee=0,ne=this._entries.length-1,re=Math.floor((ee+ne)/2);for(should(this._weekIndicesOfLastHistoryWeek!==null);;){if(this._weekIndicesOfLastHistoryWeek[re]>=te){if(ne=re-1,ne<ee)return re}else if(ee=re+1,ne<ee)return re+1;re=Math.floor((ee+ne)/2)}}static _getWeekIndexImpl(te){const ee=get_year(te),ne=get_month(te),re=get_cal_utc(ee,ne,1),se=get_day_of_month(te)-get_day_of_week(te);add_date(re,se);const ae=re.getTime()/1e3;should((ae+62167219200)%86400===0);const le=(ae+62167219200)/86400;return Math.floor(le/7)}}var __getOwnPropDesc$m=Object.getOwnPropertyDescriptor,__decorateClass$m=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$m(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$j=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let ChartMainSeriesWrapper=class extends AbstractChartDataSource{constructor(te,ee,ne,re){super(te,ne,re);Ee(this,"_series");Ee(this,"_priceFormatter");Ee(this,"_sessionsSpec",null);Ee(this,"_onDataLoaded",this._register(new Emitter));Ee(this,"onDataLoaded",this._onDataLoaded.event);this._chartStore=ee,this.setChartType(this._chartStore.getChartProperty("mainSeriesProperties.style"),void 0,!0),this._registerListeners(),this.load()}_registerListeners(){super._registerListeners();const te=ee=>{this._onDataChanged.fire(ee),this.updateLegend()};this._series.subscribeDataChanged(te),this._register(toDisposable(()=>{this._series.unsubscribeDataChanged(te)}))}getSessionsSpec(){return this._sessionsSpec}getSeries(){return this._series}getLastPrice(){const te=last$1(this.data());return ensure(te).customValues.close}data(){return this._series.data()}symbol(){return this._chartStore.get("symbol")}setSymbol(te){return this._chartStore.set("symbol",te),this.status=DataStatus.changingSymbol,this._series.setData([]),this.load()}chartType(){return this._chartStore.getChartProperty("mainSeriesProperties.style")}resolution(){return this._chartStore.get("resolution")}setResolution(te){return this._chartStore.set("resolution",te),this.load()}loadData(){return Promise.resolve(!0)}setChartType(te,ee,ne=!1){const re=this._chartStore.get("chartProperties");if(re["mainSeriesProperties.style"]!==te)this._chartStore.setChartProperty("mainSeriesProperties.style",te);else if(!ne)return;const se=this._series,ae=se==null?void 0:se.data().slice();let le=[];switch(se&&(le=se.primitives(),this._chart.removeSeries(se)),te){case ChartStyleType.Bar:{this._series=this._chart.addSeries(Ce,{priceScaleId:"right",upColor:re["mainSeriesProperties.barStyle.upColor"],downColor:re["mainSeriesProperties.barStyle.downColor"],openVisible:!re["mainSeriesProperties.barStyle.dontDrawOpen"],thinBars:re["mainSeriesProperties.barStyle.thinBars"]});break}case ChartStyleType.Candle:{this._series=this._chart.addSeries(ke,{priceScaleId:"right",upColor:re["mainSeriesProperties.candleStyle.upColor"],downColor:re["mainSeriesProperties.candleStyle.downColor"],borderVisible:re["mainSeriesProperties.candleStyle.drawBorder"],borderColor:re["mainSeriesProperties.candleStyle.borderColor"],borderUpColor:re["mainSeriesProperties.candleStyle.borderUpColor"],borderDownColor:re["mainSeriesProperties.candleStyle.borderDownColor"],wickVisible:re["mainSeriesProperties.candleStyle.drawWick"],wickColor:re["mainSeriesProperties.candleStyle.wickColor"],wickUpColor:re["mainSeriesProperties.candleStyle.wickUpColor"],wickDownColor:re["mainSeriesProperties.candleStyle.wickDownColor"]});break}case ChartStyleType.HollowCandle:{this._series=this._chart.addSeries(De,{priceScaleId:"right",upColor:re["mainSeriesProperties.hollowCandleStyle.upColor"],downColor:re["mainSeriesProperties.hollowCandleStyle.downColor"],borderVisible:re["mainSeriesProperties.hollowCandleStyle.drawBorder"],borderColor:re["mainSeriesProperties.hollowCandleStyle.borderColor"],borderUpColor:re["mainSeriesProperties.hollowCandleStyle.borderUpColor"],borderDownColor:re["mainSeriesProperties.hollowCandleStyle.borderDownColor"],wickVisible:re["mainSeriesProperties.hollowCandleStyle.drawWick"],wickColor:re["mainSeriesProperties.hollowCandleStyle.wickColor"],wickUpColor:re["mainSeriesProperties.hollowCandleStyle.wickUpColor"],wickDownColor:re["mainSeriesProperties.hollowCandleStyle.wickDownColor"]});break}case ChartStyleType.Line:{this._series=this._chart.addSeries(Qn,{priceScaleId:"right",color:re["mainSeriesProperties.lineStyle.color"],lineStyle:re["mainSeriesProperties.lineStyle.linestyle"],lineWidth:re["mainSeriesProperties.lineStyle.linewidth"],lineType:r$1.Simple});break}case ChartStyleType.Area:{this._series=this._chart.addSeries(we,{priceScaleId:"right",topColor:re["mainSeriesProperties.areaStyle.color2"],bottomColor:re["mainSeriesProperties.areaStyle.color1"],lineColor:re["mainSeriesProperties.areaStyle.linecolor"],lineStyle:re["mainSeriesProperties.areaStyle.linestyle"],lineType:r$1.Simple,lineWidth:re["mainSeriesProperties.areaStyle.linewidth"]});break}default:NOTIMPLEMENTED()}le.forEach(ce=>this._series.attachPrimitive(ce)),ae&&this._series.setData(this._mapBars(ae)),ee==null||ee()}async load(){this._chartStore.set("dataStatus",ChartDataStatus.startLoading),this._status=DataStatus.idle;const te=await super.load(ee=>{this._chartStore.set("dataStatus",ChartDataStatus.symbolInfoResolved),this._chartStore.set("symbolInfo",ee),this._priceFormatter=new tt(ee.pricescale??100,ee.minmov??1),this._sessionsSpec=new SessionsSpec(ee.timezone,ee.session)},()=>{this._chartStore.set("dataStatus",ChartDataStatus.error)});return te&&this._onDataLoaded.fire(),te}setBars(te){this._chartStore.set("dataStatus",ChartDataStatus.dataLoaded);const ee=this._chartStore.get("chartProperties");this._series.setData(barsToOhlcData(te,ee["mainSeriesProperties.candleStyle.upColor"],ee["mainSeriesProperties.candleStyle.downColor"]))}setBar(te){const ee=this._mapBar(te);this._series.update(ee)}updateLegend(te){let ee;if(te&&te.time?ee=te.seriesData.get(this._series):ee=last$1(this._series.data()),!ee)return;const ne=isOhlcSeries(this.chartType()),re=this.priceFormatter(),ae=this._series.data().findIndex(ce=>ce.time==ee.time),le=this._series.dataByIndex(ae-1);if(ne){const ce=ee,he=le,fe=he?he.close:ce.open,Ae=ce.close-fe,pe=Ae/fe*100,Oe=Ae>=0?"+":"";this._chartStore.set("mainLegend",{open:re.format(ce.open),high:re.format(ce.high),low:re.format(ce.low),close:re.format(ce.close),value:"",change:`${Oe}${re.format(Ae)}(${Oe}${re.format(pe)}%)`,color:ce.color??""})}else{const ce=ee,he=le,fe=he?he.value:ce.value,Ae=ce.value-fe,pe=Ae/fe*100,Oe=Ae>=0?"+":"";let Fe="";switch(this.chartType()){case ChartStyleType.Line:Fe=this._chartStore.getChartProperty("mainSeriesProperties.lineStyle.color");break;case ChartStyleType.Area:Fe=this._chartStore.getChartProperty("mainSeriesProperties.areaStyle.linecolor");break;default:NOTREACHED()}this._chartStore.set("mainLegend",{open:"",high:"",low:"",close:"",value:re.format(ce.value),change:`${Oe}${re.format(Ae)}(${Oe}${re.format(pe)}%)`,color:Fe??""})}}_mapBars(te){const ee=this._chartStore.get("chartProperties");switch(this.chartType()){case ChartStyleType.Bar:return barsToOhlcData(te,ee["mainSeriesProperties.barStyle.upColor"],ee["mainSeriesProperties.barStyle.downColor"]);case ChartStyleType.Candle:return barsToOhlcData(te,ee["mainSeriesProperties.candleStyle.upColor"],ee["mainSeriesProperties.candleStyle.downColor"]);case ChartStyleType.HollowCandle:return barsToOhlcData(te,ee["mainSeriesProperties.hollowCandleStyle.upColor"],ee["mainSeriesProperties.hollowCandleStyle.downColor"]);case ChartStyleType.Line:return barsToSingleValueData(te,ee["mainSeriesProperties.lineStyle.priceSource"]);case ChartStyleType.Area:return barsToSingleValueData(te,ee["mainSeriesProperties.areaStyle.priceSource"]);default:NOTIMPLEMENTED()}}_mapBar(te){const ee=Object.create(null);let ne=te.open,re=Math.max(te.open,te.high,te.low,te.close),se=Math.max(te.open,te.high,te.low,te.close);const ae=te.close,le=te.volume;ee.time=te.time,ee.customValues={open:ne,high:re,low:se,close:ae,volume:le};const ce=this._chartStore.get("chartProperties"),he=this.chartType();let fe="",Ae="",pe="";switch(he){case ChartStyleType.Bar:{fe=ce["mainSeriesProperties.barStyle.upColor"],Ae=ce["mainSeriesProperties.barStyle.downColor"];break}case ChartStyleType.Candle:{fe=ce["mainSeriesProperties.candleStyle.upColor"],Ae=ce["mainSeriesProperties.candleStyle.downColor"],pe=ce["mainSeriesProperties.candleStyle.wickColor"];break}case ChartStyleType.HollowCandle:{fe=ce["mainSeriesProperties.hollowCandleStyle.upColor"],Ae=ce["mainSeriesProperties.hollowCandleStyle.downColor"],pe=ce["mainSeriesProperties.hollowCandleStyle.wickColor"];break}case ChartStyleType.Area:{ee.value=te[ce["mainSeriesProperties.areaStyle.priceSource"]];break}case ChartStyleType.Line:{ee.value=te[ce["mainSeriesProperties.lineStyle.priceSource"]];break}}if(isOhlcSeries(this.chartType())){const Oe=this._chart.timeScale().timeToIndex(te.time,!1);let Fe,Ne,ze=pe;Oe&&(Fe=this._series.dataByIndex(Oe),Ne=this._series.dataByIndex(Oe-1)),Fe&&(should(Fe.time===te.time),should(isFiniteNumber(Fe.time)),ne=Fe.open,re=Math.max(Fe.high,te.high),se=Math.min(Fe.low,te.low),Object.assign(ee.customValues,{open:ne,high:re,low:se})),Ne&&(ze=te.close>=Ne.close?fe:Ae),Object.assign(ee,{open:ne,high:re,low:se,close:te.close,volume:te.volume,color:ze,wickColor:ze,borderColor:ze})}else ee.value=te.close;return ee}priceFormatter(){return ensure(this._priceFormatter)}};ChartMainSeriesWrapper=__decorateClass$m([__decorateParam$j(3,IDatafeedService)],ChartMainSeriesWrapper);const SecondsOfResolution={T:1,S:1,m:60,H:3600,D:24*60*60,W:7*24*60*60,get M(){return NOTIMPLEMENTED()},get Y(){return NOTIMPLEMENTED()}};function getSecondsOfResolutionUnit(ie){return ensure(SecondsOfResolution[ie])}const unitGroupI18nKey={T:"resolutionGroup.ticks",S:"resolutionGroup.seconds",m:"resolutionGroup.minutes",H:"resolutionGroup.minutes",D:"resolutionGroup.days",W:"resolutionGroup.days",M:"resolutionGroup.days",Y:"resolutionGroup.days"},unitI18nKey={T:"resolution.tick",S:"resolution.second",m:"resolution.minute",H:"resolution.hour",D:"resolution.day",W:"resolution.weak",M:"resolution.month",Y:"resolution.year"};function formatUnit(ie){return["D","W","M","Y"].includes(ie)?ie:ie.toLowerCase()}const IChartResolutionRegistry=createDecorator$1("chartResolutionRegistry ");class ChartResolutionRegistry extends Disposable{constructor(){super();Ee(this,"_serviceBrand");Ee(this,"store",writable({groups:[],items:Object.create(null)}));this._register(toDisposable(()=>Reflect.set(this,"store",null)))}value(ee){return get$1(this.store).items[ee]}registerResolution(ee){const{value:ne,unit:re,groupi18nkey:se,groupUnit:ae,equivalent:le}=parseResolution(ee),ce={resolutionString:ee,label:unitI18nKey[re],labelShort:`${ne}${formatUnit(re)}`,equivalent:le,value:ne,unit:re};this.store.update(he=>{he.items[ee]=ce;let fe=he.groups.find(Ae=>Ae.unit===ae);return fe||(fe={i18nKey:se,unit:ae,items:[]},he.groups.push(fe)),fe.items.push(ce),fe.items.sort((Ae,pe)=>Ae.equivalent-pe.equivalent),he})}}function parseResolution(ie){const te=/^(\d+)([TSDWM]?)$/,ee=ie.match(te);ee||NOTREACHED("Invalid resolution format",ie);let ne=parseInt(ee[1],10),re=ee[2]||"m",se=ne,ae=re;switch(re){case"m":{ne%60===0&&(re="H",ne=ne/60);break}case"W":{se=ne*7,ae="D";break}case"M":{se=ne*30,ae="D",ne%12===0&&(re="M",ne=ne/12);break}}return{value:ne,unit:re,equivalent:se,groupi18nkey:unitGroupI18nKey[re],groupUnit:ae}}function createChartStoreHandler(ie){return{getStore:ie.getStore,get:ie.get,set(te,ee){ie.update(ne=>{ne[te]=ee})},getChartProperty(te){return ie.get("chartProperties")[te]},setChartProperty(te,ee){ie.update(ne=>{const re=ne.chartProperties;re[te]=ee})},addStudy(te){ie.update(ee=>{ee.studyList.push(te)})},removeStudy(te){ie.update(ee=>{const ne=ee.studyList,re=ne.findIndex(se=>se.id===te);ne.splice(re,1),delete ee.studyLegend[te]})},addDrawingInfo(te){ie.update(ee=>{ee.drawingInfos.push(te)})},removeDrawingInfo(te){ie.update(ee=>{const ne=ee.drawingInfos,re=ne.findIndex(se=>se.id===te);ne.splice(re,1)})},removeAllDrawingInfos(){ie.update(te=>{te.drawingInfos.length=0})},updateStudyLegend(te,ee){ie.update(ne=>{let re=ne.studyLegend[te];re||(re=Object.create(null),ne.studyLegend[te]=re),ee(re)})},zoomToViewport(te){ie.update(ee=>{ee.viewports.push(te)})},zoomFromViewport(){ie.update(te=>{te.viewports.pop()})}}}function getLightenRGBA(ie,te=.28){should(ie.startsWith("#"));const ee=alphaToHex(te);return ie.length===7?ie+ee:ie.substring(0,7)+ee}function alphaToHex(ie){const te=Math.min(1,Math.max(0,ie));return Math.round(te*255).toString(16).padStart(2,"0").toUpperCase()}var LineStudyPlotStyle=(ie=>(ie[ie.Line=0]="Line",ie[ie.Histogram=1]="Histogram",ie[ie.Cross=3]="Cross",ie[ie.Columns=5]="Columns",ie))(LineStudyPlotStyle||{});const studyDefaultProperties={"compare.plot.display":15,"compare.plot.linestyle":0,"compare.plot.linewidth":2,"compare.plot.plottype":"line","compare.plot.trackprice":!1,"compare.plot.transparency":0,"compare.plot.color":"#9C27B0","compare.source":"close","compare.symbol":""};class ColumnRenderer{constructor(te){Ee(this,"_data",null);Ee(this,"_options",null);this.studyKey=te}update(te,ee){this._data=te,this._options=ee}draw(te,ee){te.useBitmapCoordinateSpace(ne=>this._drawImpl(ne,ee))}_drawImpl(te,ee){if(this._data===null||this._data.bars.length===0||this._data.visibleRange===null||this._options===null)return;const ne=te.context;ne.fillStyle=this._options.styles[this.studyKey].color;const re=ee(0)*te.verticalPixelRatio;for(let se=this._data.visibleRange.from;se<this._data.visibleRange.to;se++){const ae=this._data.bars[se],le=Math.round(ae.x*te.horizontalPixelRatio),ce=ee(ae.originalData.study[this.studyKey])*te.verticalPixelRatio;ne.fillRect(le-.5*te.verticalPixelRatio,Math.min(re,ce),te.verticalPixelRatio,Math.abs(ce-re))}}}let CompositeRenderer$1=class{constructor(){Ee(this,"_renderers",[])}addRenderer(te){this._renderers.push(te)}update(te,ee){this._renderers.forEach(ne=>ne.update(te,ee))}draw(te,ee,ne,re){this._renderers.forEach(se=>{se.draw(te,ee,ne,re)})}};class CrossRenderer{constructor(te){Ee(this,"_data",null);Ee(this,"_options",null);this.studyKey=te}update(te,ee){this._data=te,this._options=ee}draw(te,ee){te.useBitmapCoordinateSpace(ne=>this._drawImpl(ne,ee))}_drawImpl(te,ee){var se;if(this._data===null||this._data.bars.length===0||this._data.visibleRange===null||this._options===null)return;const ne=te.context;ne.strokeStyle=this._options.styles[this.studyKey].color;const re=((se=this._options.styles[this.studyKey])==null?void 0:se.linewidth)??1;for(let ae=this._data.visibleRange.from;ae<this._data.visibleRange.to;ae++){const le=this._data.bars[ae],ce=Math.round(le.x*te.horizontalPixelRatio),he=ee(le.originalData.study[this.studyKey])*te.verticalPixelRatio;ne.beginPath(),ne.lineWidth=re*te.horizontalPixelRatio,ne.moveTo(ce-1.5*te.horizontalPixelRatio,he),ne.lineTo(ce+1.5*te.horizontalPixelRatio,he),ne.stroke(),ne.beginPath(),ne.lineWidth=re*te.verticalPixelRatio,ne.moveTo(ce,he-1.5*te.verticalPixelRatio),ne.lineTo(ce,he+1.5*te.verticalPixelRatio),ne.stroke()}}}let LineRenderer$1=class{constructor(te){Ee(this,"_data",null);Ee(this,"_options",null);this.studyKeys=te}update(te,ee){this._data=te,this._options=ee}draw(te,ee){te.useBitmapCoordinateSpace(ne=>this._drawImpl(ne,ee))}_drawImpl(te,ee){if(this._data===null||this._data.bars.length===0||this._data.visibleRange===null||this._options===null)return;const ne=te.context;for(const re of this.studyKeys){ne.beginPath();for(let se=this._data.visibleRange.from;se<this._data.visibleRange.to;se++){const ae=this._data.bars[se],le=Math.round(ae.x*te.horizontalPixelRatio),ce=ee(ae.originalData.study[re])*te.verticalPixelRatio;se===this._data.visibleRange.from?ne.moveTo(le,ce):ne.lineTo(le,ce)}ne.strokeStyle=this._options.styles[re].color,ne.lineWidth=this._options.styles[re].linewidth*te.verticalPixelRatio,ne.stroke()}}};class StudySeries{constructor(te){Ee(this,"_renderer");this.styleValues=te,this._renderer=new CompositeRenderer$1;const ee=[];toPairs(this.styleValues.styles).forEach(([ne,re])=>{if(re)switch(re.plottype){case LineStudyPlotStyle.Line:ee.push(ne);break;case LineStudyPlotStyle.Cross:this._renderer.addRenderer(new CrossRenderer(ne));break;case LineStudyPlotStyle.Columns:this._renderer.addRenderer(new ColumnRenderer(ne));break;default:NOTIMPLEMENTED()}}),ee.length&&this._renderer.addRenderer(new LineRenderer$1(ee))}priceValueBuilder(te){return keys$1(this.styleValues.styles).map(ee=>te.study[ee])}isWhitespace(te){return te.study===void 0}renderer(){return this._renderer}update(te,ee){this._renderer.update(te,ee)}defaultOptions(){return{...yr,...this.styleValues}}}class ChartStudy extends Disposable{constructor(ee,ne,re,se){super();Ee(this,"_series");Ee(this,"_id");Ee(this,"_priceLines",new Map);Ee(this,"_handleDataChange",ee=>{const ne=this._studyInfo.cal(this._dataSource.data(),this.getInputs());if(ee==="update"){const re=last$1(ne);if(!re)return;this._series.update(re)}else this._series.setData(ne);this.updateLegend(),this._handleRangeChange()});this._studyInfo=ee,this._chartStore=ne,this._chart=re,this._dataSource=se,this._id=ee.abbr+generateUuid(),this._series=this._createSeries(),this._registerListeners()}get studyInfo(){return this._studyInfo}_createSeries(){const ee=new StudySeries(this._studyInfo.styleValues);return this._chart.addCustomSeries(ee,{lastValueVisible:!1,priceLineVisible:!1},this._studyInfo.overlap?0:this._chart.panes().length+1)}_registerListeners(){const ee=this._handleRangeChange.bind(this);this._chart.timeScale().subscribeVisibleLogicalRangeChange(ee),this._register(toDisposable(()=>{this._chart.removeSeries(this._series),this._chart.timeScale().unsubscribeVisibleLogicalRangeChange(ee)})),this._register(this._dataSource.onDataChanged(this._handleDataChange.bind(this)))}_handleRangeChange(){const ee=this._chart.timeScale().getVisibleRange();if(ee&&!isUndefinedOrNull(ee.to)){const ne=ee.to,re=this._series.dataByIndex(Math.round(ne),kt.NearestLeft);this._updatePriceLines(re)}}async load(){await this._dataSource.when(DataStatus.historyResolved);const ee=this._studyInfo.cal(this._dataSource.data(),this.getInputs());this._series.setData(ee);const ne=last$1(ee);this._updatePriceLines(ne)}id(){return this._id}getStyleValues(){return this._studyInfo.styleValues}getInputs(){return this._studyInfo.inputs}paneHTMLElement(){return ensure(this._series.getPane().getHTMLElement())}paneIndex(){return this._series.getPane().paneIndex()}async paneReady(){return wait(16)}_updatePriceLines(ee){ee&&toPairs(this._studyInfo.styleValues.styles).forEach(([ne,re])=>{if(!re)return;let se=this._priceLines.get(ne);if(!se)se=this._series.createPriceLine({price:ee.study[ne],color:re.color,lineVisible:!1,axisLabelVisible:!0,title:this.isChartCompare()?this.symbolInfo().name:""}),this._priceLines.set(ne,se);else{const ae=ee.study[ne];if(se.options().price===ae)return;se.applyOptions({price:ae})}})}updateLegend(ee){let ne;const re=this._series;if(ee&&ee.time?ne=ee.seriesData.get(re):ne=last$1(re.data()),!ne)return;const se=re.priceFormatter(),ae=this.getStyleValues();this._chartStore.updateStudyLegend(this.id(),le=>{keys$1(ae.styles).forEach(ce=>{le[ce]=se.format(ne.study[ce])})})}isChartCompare(){return!1}toggleVisible(ee){this._series.applyOptions({visible:ee})}}function calculateCompare(ie){return ie.map(te=>({...te,study:{close:te.customValues.close}}))}class ChartCompare extends ChartStudy{constructor(te,ee,ne,re){super({id:generateUuid(),name:te.description,overlap:!0,optionInfos:[],cal:calculateCompare,abbr:te.name,styleValues:{styles:{close:{color:"#FF0000",linewidth:1,plottype:LineStudyPlotStyle.Line}}}},ee,ne,re),this._symbolInfo=te}async load(){NOTREACHED()}symbolInfo(){return this._symbolInfo}isChartCompare(){return!0}}function calculateVolume(ie){return ie.map(te=>{const ee=ensure(te.customValues.volume),ne=te.color;return{...te,color:getLightenRGBA(ne,.5),study:{close:ee},value:ee}})}class ChartVolume extends ChartStudy{constructor(te,ee,ne){super({id:generateUuid(),name:"Volume",overlap:!0,optionInfos:[],cal:calculateVolume,abbr:"Volume",styleValues:{styles:{}}},te,ee,ne)}_createSeries(){const te=this._chart.addSeries(Ve,{priceFormat:{type:"volume"},priceScaleId:"",priceLineVisible:!1});return te.priceScale().applyOptions({scaleMargins:{top:.75,bottom:0}}),te}updateLegend(te){let ee;const ne=this._series;if(te&&te.time?ee=te.seriesData.get(ne):ee=last$1(ne.data()),!ee)return;const re=ne.priceFormatter();this._chartStore.updateStudyLegend(this.id(),se=>{se[""]=re.format(ee.value)})}}const chartConfigLight={layout:{background:{type:Ai.Solid,color:"#ffffff"},textColor:"#1A1A1A",panes:{separatorColor:"#EBEBEB"}},rightPriceScale:{background:{type:Ai.Solid,color:"#ffffff"},textColor:"#1A1A1A"},timeScale:{},grid:{vertLines:{color:"rgba(48, 48, 48, 0.06)"},horzLines:{color:"rgba(48, 48, 48, 0.06)"}},crosshair:{vertLine:{color:"#9C9C9C",labelBackgroundColor:"#191919"},horzLine:{color:"#9C9C9C",labelBackgroundColor:"#191919"}}},chartConfigDark={layout:{background:{type:Ai.VerticalGradient,topColor:"#1C1C1C",bottomColor:"#1A1A1A"},textColor:"#B8B8B8",panes:{separatorColor:"#303030"}},rightPriceScale:{background:{type:Ai.VerticalGradient,topColor:"#1C1C1C",bottomColor:"#1A1A1A"},textColor:"#B8B8B8"},timeScale:{},grid:{vertLines:{color:"rgba(242, 242, 242, 0.06)"},horzLines:{color:"rgba(242, 242, 242, 0.06)"}},crosshair:{vertLine:{color:"#9C9C9C",labelBackgroundColor:"#353535"},horzLine:{color:"#9C9C9C",labelBackgroundColor:"#353535"}}},defaultBarSpacing=6,defaultRightOffset=10;class ChartCommand{constructor(te){Ee(this,"resource");Ee(this,"type",UndoRedoElementType.Resource);this.chartService=te,this.resource=te.id}}class ViewportCommand extends ChartCommand{constructor(ee,ne){super(ee);Ee(this,"_leftOffset",null);Ee(this,"_rightOffset",null);Ee(this,"_barSpacing",null);Ee(this,"_priceAutoScale",null);this.viewport=ne}undo(){const ee=this.chartService.getTimeScale(),ne=ensure(ee.getVisibleRange());ee.applyOptions({barSpacing:ensure(this._barSpacing)}),ee.setVisibleRange({from:ne.from+ensure(this._leftOffset),to:ne.to+ensure(this._rightOffset)});const re=this.chartService.getPriceScale(),se=this._priceAutoScale;se?re.setAutoScale(!!se):re.setVisibleRange({from:this.viewport.fromPrice,to:this.viewport.toPrice})}redo(){const ee=this.chartService.getTimeScale(),ne=ensure(ee.getVisibleRange());this._leftOffset=ne.from-this.viewport.fromTime,this._rightOffset=ne.to-this.viewport.toTime,this._barSpacing=ee.barSpacing(),ee.setVisibleRange({from:this.viewport.fromTime,to:this.viewport.toTime});const re=this.chartService.getPriceScale();this._priceAutoScale=re.options().autoScale,re.setAutoScale(!1),re.setVisibleRange({from:this.viewport.fromPrice,to:this.viewport.toPrice})}}var ZoomDirection=(ie=>(ie[ie.in=0]="in",ie[ie.out=1]="out",ie))(ZoomDirection||{});class ZoomCommand extends ChartCommand{constructor(te,ee,ne,re){super(te),this._cmd=ee,this._zoomStack=ne,this._dir=re}undo(){if(this._dir===0){if(this._cmd!==this._zoomStack.head()){console.warn("zoom stack inconsistency");return}this._cmd.undo(),this._zoomStack.pop()}else this._cmd.redo(),this._zoomStack.push(this._cmd)}redo(){if(this._dir===0)this._cmd.redo(),this._zoomStack.push(this._cmd);else{if(this._cmd!==this._zoomStack.head()){console.warn("zoom stack inconsistency");return}this._cmd.undo(),this._zoomStack.pop()}}}class ZoomStack{constructor(te,ee){Ee(this,"_commands",[]);this._onPush=te,this._onPop=ee}push(te){this._commands.push(te),this._onPush(te.viewport)}pop(){this._commands.pop(),this._onPop()}head(){return this._commands[this._commands.length-1]}}function createMouseEvent(ie,te,ee){return new MouseInputEvent(ie,te,ee)}function createChartInputEvent(ie,te,ee){return new ChartInputEvent(ie,te,ee)}const BrowserFeatures={pointerEvents:window.PointerEvent&&("ontouchstart"in window||navigator.maxTouchPoints>0)};var Aa;let Node$2=(Aa=class{constructor(te){Ee(this,"element");Ee(this,"next");Ee(this,"prev");this.element=te,this.next=Aa.Undefined,this.prev=Aa.Undefined}},Ee(Aa,"Undefined",new Aa(void 0)),Aa);class LinkedList{constructor(){Ee(this,"_first",Node$2.Undefined);Ee(this,"_last",Node$2.Undefined);Ee(this,"_size",0)}get size(){return this._size}isEmpty(){return this._first===Node$2.Undefined}clear(){let te=this._first;for(;te!==Node$2.Undefined;){const ee=te.next;te.prev=Node$2.Undefined,te.next=Node$2.Undefined,te=ee}this._first=Node$2.Undefined,this._last=Node$2.Undefined,this._size=0}unshift(te){return this._insert(te,!1)}push(te){return this._insert(te,!0)}_insert(te,ee){const ne=new Node$2(te);if(this._first===Node$2.Undefined)this._first=ne,this._last=ne;else if(ee){const se=this._last;this._last=ne,ne.prev=se,se.next=ne}else{const se=this._first;this._first=ne,ne.next=se,se.prev=ne}this._size+=1;let re=!1;return()=>{re||(re=!0,this._remove(ne))}}shift(){if(this._first!==Node$2.Undefined){const te=this._first.element;return this._remove(this._first),te}}pop(){if(this._last!==Node$2.Undefined){const te=this._last.element;return this._remove(this._last),te}}_remove(te){if(te.prev!==Node$2.Undefined&&te.next!==Node$2.Undefined){const ee=te.prev;ee.next=te.next,te.next.prev=ee}else te.prev===Node$2.Undefined&&te.next===Node$2.Undefined?(this._first=Node$2.Undefined,this._last=Node$2.Undefined):te.next===Node$2.Undefined?(this._last=this._last.prev,this._last.next=Node$2.Undefined):te.prev===Node$2.Undefined&&(this._first=this._first.next,this._first.prev=Node$2.Undefined);this._size-=1}*[Symbol.iterator](){let te=this._first;for(;te!==Node$2.Undefined;)yield te.element,te=te.next}}var __defProp$4=Object.defineProperty,__getOwnPropDesc$l=Object.getOwnPropertyDescriptor,__decorateClass$l=(ie,te,ee,ne)=>{for(var re=__getOwnPropDesc$l(te,ee),se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(te,ee,re)||re);return re&&__defProp$4(te,ee,re),re},EventType;(ie=>{ie.Tap="-chartles-gesturetap",ie.Change="-chartles-gesturechange",ie.Start="-chartles-gesturestart",ie.End="-chartles-gesturesend",ie.Contextmenu="-chartles-gesturecontextmenu"})(EventType||(EventType={}));var vo;const _Gesture=(vo=class extends Disposable{constructor(){super();Ee(this,"dispatched",!1);Ee(this,"targets",new LinkedList);Ee(this,"ignoreTargets",new LinkedList);Ee(this,"handle");Ee(this,"activeTouches");Ee(this,"_lastSetTapCountTime");this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(addDisposableListener(document,"touchstart",ee=>this.onTouchStart(ee),{passive:!1})),this._register(addDisposableListener(document,"touchend",ee=>this.onTouchEnd(ee))),this._register(addDisposableListener(document,"touchmove",ee=>this.onTouchMove(ee),{passive:!1}))}static addTarget(ee){if(!vo.isTouchDevice())return Disposable.None;vo.INSTANCE||(vo.INSTANCE=new vo);const ne=vo.INSTANCE.targets.push(ee);return toDisposable(ne)}static ignoreTarget(ee){if(!vo.isTouchDevice())return Disposable.None;vo.INSTANCE||(vo.INSTANCE=new vo);const ne=vo.INSTANCE.ignoreTargets.push(ee);return toDisposable(ne)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(ee){const ne=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let re=0,se=ee.targetTouches.length;re<se;re++){const ae=ee.targetTouches.item(re);this.activeTouches[ae.identifier]={id:ae.identifier,initialTarget:ae.target,initialTimeStamp:ne,initialPageX:ae.pageX,initialPageY:ae.pageY,rollingTimestamps:[ne],rollingPageX:[ae.pageX],rollingPageY:[ae.pageY]};const le=this.newGestureEvent(EventType.Start,ae.target);le.pageX=ae.pageX,le.pageY=ae.pageY,this.dispatchEvent(le)}this.dispatched&&(ee.preventDefault(),ee.stopPropagation(),this.dispatched=!1)}onTouchEnd(ee){const ne=Date.now(),re=Object.keys(this.activeTouches).length;for(let se=0,ae=ee.changedTouches.length;se<ae;se++){const le=ee.changedTouches.item(se);if(!Object.prototype.hasOwnProperty.call(this.activeTouches,String(le.identifier))){console.warn("move of an UNKNOWN touch",le);continue}const ce=this.activeTouches[le.identifier],he=Date.now()-ce.initialTimeStamp;if(he<vo.HOLD_DELAY&&Math.abs(ce.initialPageX-ce.rollingPageX.at(-1))<30&&Math.abs(ce.initialPageY-ce.rollingPageY.at(-1))<30){const fe=this.newGestureEvent(EventType.Tap,ce.initialTarget);fe.pageX=ce.rollingPageX.at(-1),fe.pageY=ce.rollingPageY.at(-1),this.dispatchEvent(fe)}else if(he>=vo.HOLD_DELAY&&Math.abs(ce.initialPageX-ce.rollingPageX.at(-1))<30&&Math.abs(ce.initialPageY-ce.rollingPageY.at(-1))<30){const fe=this.newGestureEvent(EventType.Contextmenu,ce.initialTarget);fe.pageX=ce.rollingPageX.at(-1),fe.pageY=ce.rollingPageY.at(-1),this.dispatchEvent(fe)}else if(re===1){const fe=ce.rollingPageX.at(-1),Ae=ce.rollingPageY.at(-1),pe=ce.rollingTimestamps.at(-1)-ce.rollingTimestamps[0],Oe=fe-ce.rollingPageX[0],Fe=Ae-ce.rollingPageY[0],Ne=[...this.targets].filter(ze=>ce.initialTarget instanceof Node&&ze.contains(ce.initialTarget));this.inertia(Ne,ne,Math.abs(Oe)/pe,Oe>0?1:-1,fe,Math.abs(Fe)/pe,Fe>0?1:-1,Ae)}this.dispatchEvent(this.newGestureEvent(EventType.End,ce.initialTarget)),delete this.activeTouches[le.identifier]}this.dispatched&&(ee.preventDefault(),ee.stopPropagation(),this.dispatched=!1)}newGestureEvent(ee,ne){const re=document.createEvent("CustomEvent");return re.initEvent(ee,!1,!0),re.initialTarget=ne,re.tapCount=0,re}dispatchEvent(ee){if(ee.type===EventType.Tap){const ne=new Date().getTime();let re=0;ne-this._lastSetTapCountTime>vo.CLEAR_TAP_COUNT_TIME?re=1:re=2,this._lastSetTapCountTime=ne,ee.tapCount=re}else(ee.type===EventType.Change||ee.type===EventType.Contextmenu)&&(this._lastSetTapCountTime=0);if(ee.initialTarget instanceof Node){for(const re of this.ignoreTargets)if(re.contains(ee.initialTarget))return;const ne=[];for(const re of this.targets)if(re.contains(ee.initialTarget)){let se=0,ae=ee.initialTarget;for(;ae&&ae!==re;)se++,ae=ae.parentElement;ne.push([se,re])}ne.sort((re,se)=>re[0]-se[0]);for(const[re,se]of ne)se.dispatchEvent(ee),this.dispatched=!0}}inertia(ee,ne,re,se,ae,le,ce,he){this.handle=scheduleAtNextAnimationFrame(()=>{const fe=Date.now(),Ae=fe-ne;let pe=0,Oe=0,Fe=!0;re+=vo.SCROLL_FRICTION*Ae,le+=vo.SCROLL_FRICTION*Ae,re>0&&(Fe=!1,pe=se*re*Ae),le>0&&(Fe=!1,Oe=ce*le*Ae);const Ne=this.newGestureEvent(EventType.Change);Ne.translationX=pe,Ne.translationY=Oe,ee.forEach(ze=>ze.dispatchEvent(Ne)),Fe||this.inertia(ee,fe,re,se,ae+pe,le,ce,he+Oe)})}onTouchMove(ee){const ne=Date.now();for(let re=0,se=ee.changedTouches.length;re<se;re++){const ae=ee.changedTouches.item(re);if(!Object.prototype.hasOwnProperty.call(this.activeTouches,String(ae.identifier))){console.warn("end of an UNKNOWN touch",ae);continue}const le=this.activeTouches[ae.identifier],ce=this.newGestureEvent(EventType.Change,le.initialTarget);ce.translationX=ae.pageX-le.rollingPageX.at(-1),ce.translationY=ae.pageY-le.rollingPageY.at(-1),ce.pageX=ae.pageX,ce.pageY=ae.pageY,this.dispatchEvent(ce),le.rollingPageX.length>3&&(le.rollingPageX.shift(),le.rollingPageY.shift(),le.rollingTimestamps.shift()),le.rollingPageX.push(ae.pageX),le.rollingPageY.push(ae.pageY),le.rollingTimestamps.push(ne)}this.dispatched&&(ee.preventDefault(),ee.stopPropagation(),this.dispatched=!1)}},Ee(vo,"SCROLL_FRICTION",-.005),Ee(vo,"INSTANCE"),Ee(vo,"HOLD_DELAY",700),Ee(vo,"CLEAR_TAP_COUNT_TIME",400),vo);__decorateClass$l([memoize$1],_Gesture,"isTouchDevice");let Gesture=_Gesture;class GlobalPointerMoveMonitor{constructor(){Ee(this,"_hooks",new DisposableStore);Ee(this,"_pointerMoveCallback",null);Ee(this,"_onStopCallback",null)}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(te,ee){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const ne=this._onStopCallback;this._onStopCallback=null,te&&ne&&ne(ee)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(te,ee,ne,re,se){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=re,this._onStopCallback=se;let ae=te;try{te.setPointerCapture(ee),this._hooks.add(toDisposable(()=>{try{te.releasePointerCapture(ee)}catch{}}))}catch{ae=getWindow(te)}this._hooks.add(addDisposableListener(ae,EventType$1.POINTER_MOVE,le=>{if(le.buttons!==ne){this.stopMonitoring(!0);return}le.preventDefault(),this._pointerMoveCallback(le)})),this._hooks.add(addDisposableListener(ae,EventType$1.POINTER_UP,()=>this.stopMonitoring(!0)))}}class ChartMouseEvent extends StandardMouseEvent{constructor(ee,ne){super(ee);Ee(this,"localX");Ee(this,"localY");const re=getDomNodePagePosition(ne),se=re.width/ne.offsetWidth,ae=re.height/ne.offsetHeight;this.localX=(ee.clientX-re.left)/se,this.localY=(ee.clientY-re.top)/ae}}class ChartMouseEventFactory{constructor(te){Ee(this,"_chartViewDomNode");this._chartViewDomNode=te}_create(te){return new ChartMouseEvent(te,this._chartViewDomNode)}onContextMenu(te,ee){return addDisposableListener(te,EventType$1.CONTEXT_MENU,ne=>{ee(this._create(ne))})}onMouseUp(te,ee){return addDisposableListener(te,EventType$1.MOUSE_UP,ne=>{ee(this._create(ne))})}onMouseDown(te,ee){return addDisposableListener(te,EventType$1.MOUSE_DOWN,ne=>{ee(this._create(ne))})}onPointerDown(te,ee){return addDisposableListener(te,EventType$1.POINTER_DOWN,ne=>{ee(this._create(ne),ne.pointerId)})}onMouseLeave(te,ee){return addDisposableListener(te,EventType$1.MOUSE_LEAVE,ne=>{ee(this._create(ne))})}onMouseMove(te,ee){return addDisposableListener(te,EventType$1.MOUSE_MOVE,ne=>ee(this._create(ne)))}}class ChartPointerEventFactory{constructor(te){Ee(this,"_chartViewDomNode");this._chartViewDomNode=te}_create(te){return new ChartMouseEvent(te,this._chartViewDomNode)}onPointerUp(te,ee){return addDisposableListener(te,"pointerup",ne=>{ee(this._create(ne))})}onPointerDown(te,ee){return addDisposableListener(te,EventType$1.POINTER_DOWN,ne=>{ee(this._create(ne),ne.pointerId)})}onPointerLeave(te,ee){return addDisposableListener(te,EventType$1.POINTER_LEAVE,ne=>{ee(this._create(ne))})}onPointerMove(te,ee){return addDisposableListener(te,"pointermove",ne=>ee(this._create(ne)))}}class GlobalChartPointerMoveMonitor extends Disposable{constructor(ee){super();Ee(this,"_chartViewDomNode");Ee(this,"_globalPointerMoveMonitor");Ee(this,"_keydownListener");this._chartViewDomNode=ee,this._globalPointerMoveMonitor=this._register(new GlobalPointerMoveMonitor),this._keydownListener=null}startMonitoring(ee,ne,re,se,ae){this._keydownListener=addStandardDisposableListener(ee.ownerDocument,"keydown",le=>{le.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,le.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(ee,ne,re,le=>{se(new ChartMouseEvent(le,this._chartViewDomNode))},le=>{this._keydownListener.dispose(),ae(le)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}var PartFingerprint=(ie=>(ie[ie.None=0]="None",ie[ie.Chart=1]="Chart",ie[ie.Legend=2]="Legend",ie[ie.AxisSetting=3]="AxisSetting",ie[ie.Textarea=4]="Textarea",ie))(PartFingerprint||{});class PartFingerprints{static write(te,ee){te.setAttribute("data-mprt",String(ee))}static read(te){const ee=te.getAttribute("data-mprt");return ee===null?0:parseInt(ee,10)}static collect(te,ee){const ne=[];let re=0;for(;te&&te!==te.ownerDocument.body&&te!==ee;){if(te.nodeType===te.ELEMENT_NODE){const ae=this.read(te);ae&&(ne[re++]=ae)}te=te.parentElement}const se=new Uint8Array(re);for(let ae=0;ae<re;ae++)se[ae]=ne[re-ae-1];return se}}class MouseTargetFactory{constructor(te){Ee(this,"_viewHelper");this._viewHelper=te}mouseTargetIsWidget(te){const ee=te.target,ne=PartFingerprints.collect(ee,this._viewHelper.viewDomNode);return!!(isChildOfLegend(ne)||isChildOfAxisSetting(ne))}}function isChildOfLegend(ie){return ie.length&&ie[0]===PartFingerprint.Legend}function isChildOfAxisSetting(ie){return ie.length&&ie[0]===PartFingerprint.AxisSetting}class MouseHandler extends Disposable{constructor(ee,ne){super();Ee(this,"viewController");Ee(this,"viewHelper");Ee(this,"mouseTargetFactory");Ee(this,"_mouseDownOperation");Ee(this,"lastMouseLeaveTime");Ee(this,"_mouseLeaveMonitor",null);this.viewController=ee,this.viewHelper=ne,this.mouseTargetFactory=new MouseTargetFactory(ne),this._mouseDownOperation=this._register(new MouseDownOperation(this.viewController,this.viewHelper)),this.lastMouseLeaveTime=-1;const re=new ChartMouseEventFactory(ne.viewDomNode);this._register(re.onContextMenu(this.viewHelper.viewDomNode,ae=>this._onContextMenu(ae))),this._register(re.onMouseMove(this.viewHelper.viewDomNode,()=>{this._mouseLeaveMonitor||(this._mouseLeaveMonitor=addDisposableListener(this.viewHelper.viewDomNode.ownerDocument,"mousemove",ae=>{this.viewHelper.viewDomNode.contains(ae.target)||this._onMouseLeave(new ChartMouseEvent(ae,this.viewHelper.viewDomNode))}))})),this._register(re.onMouseUp(this.viewHelper.viewDomNode,ae=>this._onMouseUp(ae))),this._register(re.onMouseLeave(this.viewHelper.viewDomNode,ae=>this._onMouseLeave(ae)));let se=0;this._register(re.onPointerDown(this.viewHelper.viewDomNode,(ae,le)=>{se=le})),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType$1.POINTER_UP,()=>{this._mouseDownOperation.onPointerUp()})),this._register(re.onMouseDown(this.viewHelper.viewDomNode,ae=>this._onMouseDown(ae,se))),this._register(addStandardDisposableListener(this.viewHelper.viewDomNode,EventType$1.KEY_DOWN,this._onKeyDown.bind(this))),this._register(addStandardDisposableListener(this.viewHelper.viewDomNode,EventType$1.KEY_UP,this._onKeyUp.bind(this)))}isMouseDownOperating(){return this._mouseDownOperation.isActive()}_onContextMenu(ee){this.viewController.emitContextMenu(createMouseEvent(EventType$1.CONTEXT_MENU,ee,this.viewHelper.chartService))}_onMouseLeave(ee){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave(createMouseEvent(EventType$1.MOUSE_LEAVE,ee,this.viewHelper.chartService))}_onMouseUp(ee){this.viewController.emitMouseUp(createMouseEvent(EventType$1.MOUSE_UP,ee,this.viewHelper.chartService))}_onMouseDown(ee,ne){this.mouseTargetFactory.mouseTargetIsWidget(ee)||(this.viewController.emitMouseDown(createMouseEvent(EventType$1.MOUSE_DOWN,ee,this.viewHelper.chartService)),this._mouseDownOperation.start(ee,ne))}_createKeyboardEvent(ee,ne){return new KeyboardInputEvent(ee,ne,this.viewHelper.chartService)}_onKeyDown(ee){this.viewController.emitKeyDown(this._createKeyboardEvent(EventType$1.KEY_DOWN,ee))}_onKeyUp(ee){this.viewController.emitKeyUp(this._createKeyboardEvent(EventType$1.KEY_UP,ee))}}class MouseDownOperation extends Disposable{constructor(ee,ne){super();Ee(this,"_viewController");Ee(this,"_viewHelper");Ee(this,"_mouseMoveMonitor");Ee(this,"_mouseState");Ee(this,"_isActive");Ee(this,"_lastMouseEvent");this._viewController=ee,this._viewHelper=ne,this._mouseMoveMonitor=this._register(new GlobalChartPointerMoveMonitor(ne.viewDomNode)),this._mouseState=new MouseDownState,this._isActive=!1,this._lastMouseEvent=null}isActive(){return this._isActive}_onMouseDownThenMove(ee){this._lastMouseEvent=ee,this._mouseState.setModifiers(ee),this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag(createMouseEvent(EventType$1.DRAG,ee,this._viewHelper.chartService)):NOTREACHED()}start(ee,ne){this._lastMouseEvent=ee,this._mouseState.setStartButtons(ee),this._mouseState.setModifiers(ee),this._mouseState.trySetCount(ee.detail,{x:ee.posx,y:ee.posy}),ee.detail=this._mouseState.count,!this._mouseState.altKey&&ee.detail<2&&!this._isActive&&(this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._viewController.emitMouseDragStart(createMouseEvent(EventType$1.DRAG_START,ee,this._viewHelper.chartService)),this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewDomNode,ne,ee.buttons,re=>this._onMouseDownThenMove(re),re=>{isKeyboardEvent(re)?this._viewController.emitMouseDropCanceled(createMouseEvent(EventType$1.DRAG_END,ensure(this._lastMouseEvent),this._viewHelper.chartService)):this._viewController.emitMouseDrop(createMouseEvent(EventType$1.DROP,ensure(this._lastMouseEvent),this._viewHelper.chartService)),this._stop()}))}_stop(){this._isActive=!1}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}}const Rl=class Rl{constructor(){Ee(this,"_altKey");Ee(this,"_ctrlKey");Ee(this,"_metaKey");Ee(this,"_shiftKey");Ee(this,"_leftButton");Ee(this,"_middleButton");Ee(this,"_lastMouseDownPosition");Ee(this,"_lastMouseDownPositionEqualCount");Ee(this,"_lastMouseDownCount");Ee(this,"_lastSetMouseDownCountTime");Ee(this,"isDragAndDrop");this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get count(){return this._lastMouseDownCount}setModifiers(te){this._altKey=te.altKey,this._ctrlKey=te.ctrlKey,this._metaKey=te.metaKey,this._shiftKey=te.shiftKey}setStartButtons(te){this._leftButton=te.leftButton,this._middleButton=te.middleButton}trySetCount(te,ee){const ne=new Date().getTime();ne-this._lastSetMouseDownCountTime>Rl.CLEAR_MOUSE_DOWN_COUNT_TIME&&(te=1),this._lastSetMouseDownCountTime=ne,te>this._lastMouseDownCount+1&&(te=this._lastMouseDownCount+1),this._lastMouseDownPosition&&isEqual(this._lastMouseDownPosition.x,ee)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=ee,this._lastMouseDownCount=Math.min(te,this._lastMouseDownPositionEqualCount)}};Ee(Rl,"CLEAR_MOUSE_DOWN_COUNT_TIME",400);let MouseDownState=Rl;class PointerEventHandler extends MouseHandler{constructor(ee,ne){super(ee,ne);Ee(this,"_lastPointerType");this._register(Gesture.addTarget(this.viewHelper.viewDomNode)),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType.Tap,se=>this.onTap(se))),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType.Change,se=>this.onChange(se))),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType.Contextmenu,se=>this._onContextMenu(new ChartMouseEvent(se,ne.viewDomNode)))),this._lastPointerType="mouse",this._register(addDisposableListener(this.viewHelper.viewDomNode,"pointerdown",se=>{const ae=se.pointerType;if(ae==="mouse"){this._lastPointerType="mouse";return}else ae==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const re=new ChartPointerEventFactory(ne.viewDomNode);this._register(re.onPointerUp(this.viewHelper.viewDomNode,se=>this._onMouseUp(se))),this._register(re.onPointerLeave(this.viewHelper.viewDomNode,se=>this._onMouseLeave(se))),this._register(re.onPointerDown(this.viewHelper.viewDomNode,(se,ae)=>this._onMouseDown(se,ae)))}onTap(ee){!ee.initialTarget||!this.viewHelper.viewDomNode.contains(ee.initialTarget)||(ee.preventDefault(),this._dispatchGesture(ee,!1))}onChange(ee){this._lastPointerType==="pen"&&this._dispatchGesture(ee,!0)}_dispatchGesture(ee,ne){console.warn("gesture evnt",ee,ne)}_onMouseDown(ee,ne){ee.browserEvent.pointerType!=="touch"&&super._onMouseDown(ee,ne)}}class TouchHandler extends MouseHandler{constructor(te,ee){super(te,ee),this._register(Gesture.addTarget(this.viewHelper.viewDomNode)),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType.Tap,ne=>this.onTap(ne))),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType.Change,ne=>this.onChange(ne))),this._register(addDisposableListener(this.viewHelper.viewDomNode,EventType.Contextmenu,ne=>this._onContextMenu(new ChartMouseEvent(ne,this.viewHelper.viewDomNode))))}onTap(te){te.preventDefault(),console.warn("tag",te)}onChange(te){console.warn("change",te)}}class PointerHandler extends Disposable{constructor(ee,ne){super();Ee(this,"_mouseHandler");(isIOS||isAndroid&&isMobile)&&BrowserFeatures.pointerEvents?this._register(new PointerEventHandler(ee,ne)):window.TouchEvent?this._register(this._mouseHandler=new TouchHandler(ee,ne)):this._register(this._mouseHandler=new MouseHandler(ee,ne))}isMouseDownOperating(){var ee;return!!((ee=this._mouseHandler)!=null&&ee.isMouseDownOperating())}}class ViewController{constructor(te){Ee(this,"userInputEvents");this.userInputEvents=te}emitKeyDown(te){this.userInputEvents.emitKeyDown(te)}emitKeyUp(te){this.userInputEvents.emitKeyUp(te)}emitContextMenu(te){this.userInputEvents.emitContextMenu(te)}emitMouseLeave(te){this.userInputEvents.emitMouseLeave(te)}emitMouseUp(te){this.userInputEvents.emitMouseUp(te)}emitMouseDown(te){this.userInputEvents.emitMouseDown(te)}emitMouseDrag(te){this.userInputEvents.emitMouseDrag(te)}emitMouseDragStart(te){this.userInputEvents.emitMouseDragStart(te)}emitMouseDrop(te){this.userInputEvents.emitMouseDrop(te)}emitMouseDropCanceled(te){this.userInputEvents.emitMouseDropCanceled(te)}}class ViewUserInputEvents{constructor(){Ee(this,"onKeyDown",null);Ee(this,"onKeyUp",null);Ee(this,"onContextMenu",null);Ee(this,"onMouseLeave",null);Ee(this,"onMouseDown",null);Ee(this,"onMouseUp",null);Ee(this,"onMouseDrag",null);Ee(this,"onMouseDragStart",null);Ee(this,"onMouseDrop",null);Ee(this,"onMouseDropCanceled",null)}emitKeyDown(te){var ee;(ee=this.onKeyDown)==null||ee.call(this,te)}emitKeyUp(te){var ee;(ee=this.onKeyUp)==null||ee.call(this,te)}emitContextMenu(te){var ee;(ee=this.onContextMenu)==null||ee.call(this,te)}emitMouseLeave(te){var ee;(ee=this.onMouseLeave)==null||ee.call(this,te)}emitMouseDown(te){var ee;(ee=this.onMouseDown)==null||ee.call(this,te)}emitMouseUp(te){var ee;(ee=this.onMouseUp)==null||ee.call(this,te)}emitMouseDrag(te){var ee;(ee=this.onMouseDrag)==null||ee.call(this,te)}emitMouseDragStart(te){var ee;(ee=this.onMouseDragStart)==null||ee.call(this,te)}emitMouseDrop(te){var ee;(ee=this.onMouseDrop)==null||ee.call(this,te)}emitMouseDropCanceled(te){var ee;(ee=this.onMouseDropCanceled)==null||ee.call(this,te)}}var __defProp$3=Object.defineProperty,__getOwnPropDesc$k=Object.getOwnPropertyDescriptor,__decorateClass$k=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$k(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=(ne?ae(te,ee,re):ae(re))||re);return ne&&re&&__defProp$3(te,ee,re),re},__decorateParam$i=(ie,te)=>(ee,ne)=>te(ee,ne,ie);class InteractionEmitter extends Emitter{constructor(te){super({deliveryQueue:te})}fire(te){super.fire(te)}}let ChartWidget=class extends Disposable{constructor(te,ee,ne,re,se,ae,le,ce,he,fe,Ae,pe,Oe,Fe){super();Ee(this,"_serviceBrand");Ee(this,"id",generateUuid());Ee(this,"_chartStore");Ee(this,"_size");Ee(this,"chart");Ee(this,"_pointerHandler");Ee(this,"_paneCursorScope");Ee(this,"_paneDragCursorScope");Ee(this,"mainSeriesWrapper");Ee(this,"_dataSources",new Map);Ee(this,"_mouseInsideChart",!1);Ee(this,"_study",new Map);Ee(this,"_zoomStack",new ZoomStack(te=>{this._chartStore.zoomToViewport(te)},()=>this._chartStore.zoomFromViewport()));Ee(this,"_instantiationService");Ee(this,"_deliveryQueue",createEventDeliveryQueue());Ee(this,"_contributions",this._register(new ChartContributions));Ee(this,"eventFilter");Ee(this,"_onMouseUp",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseUp",this._onMouseUp.event);Ee(this,"_onMouseDown",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseDown",this._onMouseDown.event);Ee(this,"_onMouseDragStart",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseDragStart",this._onMouseDragStart.event);Ee(this,"_onMouseDrag",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseDrag",this._onMouseDrag.event);Ee(this,"_onMouseDrop",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseDrop",this._onMouseDrop.event);Ee(this,"_onMouseDropCanceled",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseDropCanceled",this._onMouseDropCanceled.event);Ee(this,"_onContextMenu",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onContextMenu",this._onContextMenu.event);Ee(this,"_onMouseMove",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseMove",this._onMouseMove.event);Ee(this,"_onMouseLeave",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onMouseLeave",this._onMouseLeave.event);Ee(this,"_onKeyUp",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onKeyUp",this._onKeyUp.event);Ee(this,"_onKeyDown",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onKeyDown",this._onKeyDown.event);Ee(this,"_onClick",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onClick",this._onClick.event);Ee(this,"_onCrosshairMove",this._register(new InteractionEmitter(this._deliveryQueue)));Ee(this,"onCrosshairMove",this._onCrosshairMove.event);Ee(this,"_onDataLoaded",this._register(new Emitter));Ee(this,"onDataLoaded",this._onDataLoaded.event);Ee(this,"_onSymbolChanged",this._register(new Emitter));Ee(this,"onSymbolChanged",this._onSymbolChanged.event);Ee(this,"_onChartFocus",this._register(new Emitter));Ee(this,"onChartFocus",this._onChartFocus.event);Ee(this,"_onChartBlur",this._register(new Emitter));Ee(this,"onChartBlur",this._onChartBlur.event);Ee(this,"_onDrawingsVisibility",this._register(new Emitter));Ee(this,"onDrawingsVisibility",this._onDrawingsVisibility.event);Ee(this,"_onPositionsAndOrdersVisibility",this._register(new Emitter));Ee(this,"onPositionsAndOrdersVisibility",this._onPositionsAndOrdersVisibility.event);Ee(this,"_cachedVolumeId",null);this.index=te,this._container=ee,this._cursorHandler=re,this.configurationService=se,this.chartManagementService=ae,this.i18nService=he,this.undoRedoService=fe,this.themeService=Ae,this.studyService=Fe,this._instantiationService=le.createChild(new ServiceCollection([IContextKeyService,this._register(ce.createScoped(this._container))],[IChartService,this],[IChartGuiService,this._register(new ChartGuiService)])),this._chartStore=createChartStoreHandler(ne);const Ne=ee.getBoundingClientRect();this._size={width:Ne.width,height:Ne.height},this.chart=Fn(this._container,{width:this._size.width,height:this._size.height,autoSize:!1,layout:{attributionLogo:!1,panes:{enableResize:!0}},crosshair:{mode:K.Normal},timeScale:{timeVisible:!0,secondsVisible:!1,borderVisible:!1,rightOffset:defaultRightOffset,extendedScale:{getExtendedTime:(We,je)=>{const Ue=ensure(Oe.value(this.resolution())),Ge=getSecondsOfResolutionUnit(Ue.unit);return We+Ge*je*Ue.value},getAdvanceUnit:(We,je)=>{const Ue=je-We,Ge=ensure(Oe.value(this.resolution()));return Ue/(Ge.value*getSecondsOfResolutionUnit(Ge.unit))}}},rightPriceScale:{visible:!0,borderVisible:!1,scaleMargins:{top:.1,bottom:.08}},localization:{locale:he.locale,priceFormatter:We=>this.mainSeriesWrapper.priceFormatter().format(We),timeFormatter:We=>this.formatDateTime(We)},preventLeave:()=>this._pointerHandler.isMouseDownOperating()}),this._spyChartOptionsSetter(),this.changeTheme(),this._register(this.mainSeriesWrapper=this._instantiationService.createInstance(ChartMainSeriesWrapper,this._createDataSourceContext(),this._chartStore,this.chart)),this._dataSources.set(this.symbol(),this.mainSeriesWrapper),this._registerListeners();const ze=new ViewUserInputEvents;ze.onKeyDown=We=>{this._passToEventFilter(We)||this._onKeyDown.fire(We)},ze.onKeyUp=We=>{this._passToEventFilter(We)||this._onKeyUp.fire(We)},ze.onContextMenu=We=>{this._passToEventFilter(We)||this._onContextMenu.fire(We)},ze.onMouseLeave=We=>{this._passToEventFilter(We)||this._onMouseLeave.fire(We)},ze.onMouseDown=We=>{this._passToEventFilter(We)||this._onMouseDown.fire(We)},ze.onMouseUp=We=>{this._passToEventFilter(We)||this._onMouseUp.fire(We)},ze.onMouseDragStart=We=>{this._paneDragCursorScope=new CursorScope(this._cursorHandler.getPaneCursor()),!this._passToEventFilter(We)&&this._onMouseDragStart.fire(We)},ze.onMouseDrag=We=>{this._passToEventFilter(We)||this._onMouseDrag.fire(We)},ze.onMouseDrop=We=>{this._passToEventFilter(We)||this._onMouseDrop.fire(We),this._paneDragCursorScope=void 0},ze.onMouseDropCanceled=We=>{this._passToEventFilter(We)||this._onMouseDropCanceled.fire(),this._paneDragCursorScope=void 0};const He=new ViewController(ze);this._register(this._pointerHandler=new PointerHandler(He,{viewDomNode:this._container,chartService:this})),this._contributions.initialize(pe.getContributions(),this._instantiationService)}changeTheme(){this.chart.applyOptions(this.themeService.isDark()?cloneDeep(chartConfigDark):cloneDeep(chartConfigLight))}installEventFilter(te){this.eventFilter=te}getContainerDomElement(){return this._container}getTimeScale(){return this.chart.timeScale()}getPriceScale(){return this.mainSeriesWrapper.getSeries().priceScale()}getStore(){return this._chartStore.getStore()}getPane(te){return this.chart.panes().find(ee=>ee.paneIndex()===te)??null}getPaneSeries(te,ee=0){const ne=this.getPane(te);return ne?ne.getSeries()[ee]??null:null}getStoreHandler(){return this._chartStore}symbolInfo(){return this._chartStore.get("symbolInfo")}interval(){return Interval$1.parse(this._chartStore.get("resolution"))}focus(){this._container.focus(),this._onChartFocus.fire()}blur(){this._container.blur(),this._onChartBlur.fire()}formatDateTime(te){if(typeof te=="string")return te;const ee=Oi(te)?new Date(te.year,te.month,te.day):new Date(te*1e3);return formatInTimeZone(ee,this._timezoneId(),this._dateTimeFormat())}formatDate(te){if(typeof te=="string")return te;const ee=te instanceof Date?te:Oi(te)?new Date(te.year,te.month,te.day):new Date(te*1e3);return formatInTimeZone(ee,this._timezoneId(),this._dateFormat())}_timezoneId(){const te=this._chartStore.getChartProperty("timezone");return te==="exchange"?this._chartStore.get("symbolInfo").timezone:te}_dateTimeFormat(){return this.i18nService.dateTimeFormat(!1)}_dateFormat(){return this.i18nService.dateFormat()}_passToEventFilter(te){return this.eventFilter?(this.eventFilter.eventFilter(te),te.isAccepted()):!1}_registerListeners(){const te=ne=>{const re=createChartInputEvent(InputEventType.MOUSE_MOVE,ne,this);this._withCursorScope(()=>{this._passToEventFilter(re)||this._onCrosshairMove.fire(re)}),this._updateLegend(ne)},ee=ne=>{const re=createChartInputEvent(InputEventType.CLICK,ne,this);this._withCursorScope(()=>{this._passToEventFilter(re)||this._onClick.fire(re)})};this.chart.subscribeCrosshairMove(te),this.chart.subscribeClick(ee),this._register(toDisposable(()=>{this.chart.unsubscribeCrosshairMove(te),this.chart.unsubscribeClick(ee),this.chart.remove()})),this._register(this.onMouseDown(()=>{this.chartManagementService.activeChart()!==this&&this.chartManagementService.setActiveChart(this)})),this._register(this.themeService.onDidColorThemeChange(()=>{this.changeTheme()})),this._register(this.mainSeriesWrapper.onDataLoaded(()=>{this._onDataLoaded.fire(),this._createVolumeIfNeeded()}))}_withCursorScope(te){this._paneCursorScope=new CursorScope(this._cursorHandler.getPaneCursor(),this._paneDragCursorScope),te(),this._paneCursorScope.touched()||this._cursorHandler.setPaneCursor(this._paneCursorScope.initValue)}_updateLegend(te){this._mouseInsideChart&&!te||(te&&(this._mouseInsideChart=!!te.time),this.mainSeriesWrapper.updateLegend(te),this._study.values().forEach(ee=>ee.updateLegend(te)))}_createDataSourceContext(){return{countBack:()=>Math.ceil(this._size.width/defaultBarSpacing)+100}}_getDataSource(te){if(te===this.symbol())return this.mainSeriesWrapper;let ee=this._dataSources.get(te);return ee||(ee=this._instantiationService.createInstance(StudyDataSource,te,this.resolution(),this._createDataSourceContext(),this.chart),this._dataSources.set(te,ee)),ee}_removeDataSource(te){if(te===this.symbol())return;const ee=this._dataSources.get(te);ee&&ee.dispose(),this._dataSources.delete(te)}_spyChartOptionsSetter(){const te=this.chart.applyOptions;this.chart.applyOptions=ee=>{te.call(this.chart,ee),this._chartStore.set("chartOptions",this.chart.options())}}autoResize(){const te=this._container.getBoundingClientRect();isSizeEqual(te,this._size)||(this._size.width=te.width,this._size.height=te.height,this.chart.resize(te.width,te.height,!0))}addCompareSymbol(te){const ee=this.chart.priceScale("right");ee.options().mode!==pi.Percentage&&ee.applyOptions({mode:pi.Percentage});const ne=this._getDataSource(te);ne.loadData(async re=>{const se=this._instantiationService.createInstance(ChartCompare,re,this._chartStore,this.chart,ne);this._study.set(se.id(),se),await se.paneReady(),this._chartStore.addStudy({id:se.id(),title:re.name,overlap:!0,compare:!0,styleValues:se.getStyleValues()})})}chartType(){return this.mainSeriesWrapper.chartType()}showPaneCursor(te){var ee,ne;(ee=this._paneDragCursorScope)==null||ee.touch(te),(ne=this._paneCursorScope)==null||ne.touch(te),this._cursorHandler.setPaneCursor(te)}setChartType(te,ee){return this.mainSeriesWrapper.setChartType(te,ee)}resolution(){return this.mainSeriesWrapper.resolution()}setResolution(te){return this.mainSeriesWrapper.setResolution(te)}symbol(){return this.mainSeriesWrapper.symbol()}setSymbol(te){return this._onSymbolChanged.fire(),this.mainSeriesWrapper.setSymbol(te)}async createStudy(te,ee,ne,re,se){let ae,le;if(te==="volume"){const ce=this._instantiationService.createInstance(ChartVolume,this._chartStore,this.chart,this.mainSeriesWrapper);ae=ce,le=ce.studyInfo}else{if(le=studyRegistry.value(te),!le)return console.warn(`Study ${te} not found`),null;await this.studyService.init(),le=merge(cloneDeep(le),{styleValues:{styles:se}},{inputs:re}),ae=this._instantiationService.createInstance(ChartStudy,le,this._chartStore,this.chart,this.mainSeriesWrapper)}return should(le),this._study.set(ae.id(),ae),await ae.paneReady(),this._chartStore.addStudy({id:ae.id(),title:le.abbr,overlap:le.overlap,compare:!1,inputs:re,styleValues:le.styleValues}),ae.load(),ae.id()}async _createVolumeIfNeeded(){if(!this.configurationService.featureEnabled("create_volume_indicator_by_default")||this._cachedVolumeId||!hasVolume(this.symbolInfo()))return;const ee=this.mainSeriesWrapper.data()[0];isUndefined(ee.customValues.volume)||(this._cachedVolumeId=await this.createStudy("volume"))}toggleIndicatorsVisible(te){this._study.values().forEach(ee=>ee.toggleVisible(te))}toggleDrawingsVisibility(te){this._onDrawingsVisibility.fire(te)}togglePositionsAndOrdersVisibility(te){this._onPositionsAndOrdersVisibility.fire(te)}getStudyById(te){return this._study.get(te)}removeEntity(te){const ee=this._study.get(te);if(ee&&(ee.dispose(),this._study.delete(te),this._chartStore.removeStudy(te),ee.isChartCompare())){const ne=ee.symbolInfo(),re=Array.from(this._study.values().filter(ae=>ae.isChartCompare()));if(!re.filter(ae=>ae.symbolInfo().name===ne.name).length){const ae=ne.ticker||ne.name;this._removeDataSource(ae)}re.length||this.chart.priceScale("right").applyOptions({mode:pi.Normal})}}removeAllStudy(){this._study.keys().forEach(te=>{this.removeEntity(te)})}resetData(){NOTIMPLEMENTED()}zoomToViewport(te,ee,ne,re){const se={fromTime:Math.min(te,ee),toTime:Math.max(te,ee),fromPrice:Math.min(ne,re),toPrice:Math.max(ne,re)},ae=new ViewportCommand(this,se),le=new ZoomCommand(this,ae,this._zoomStack,ZoomDirection.in);le.redo(),this.undoRedoService.pushElement(le)}zoomFromViewport(){const te=this._zoomStack.head(),ee=new ZoomCommand(this,te,this._zoomStack,ZoomDirection.out);ee.redo(),this.undoRedoService.pushElement(ee)}invokeWithinContext(te){return this._instantiationService.invokeFunction(te)}getContribution(te){return this._contributions.get(te)}};__decorateClass$k([memoize$1],ChartWidget.prototype,"_timezoneId",1);__decorateClass$k([memoize$1],ChartWidget.prototype,"_dateTimeFormat",1);__decorateClass$k([memoize$1],ChartWidget.prototype,"_dateFormat",1);ChartWidget=__decorateClass$k([__decorateParam$i(4,IConfigurationService),__decorateParam$i(5,IChartManagementService),__decorateParam$i(6,IInstantiationService),__decorateParam$i(7,IContextKeyService),__decorateParam$i(8,II18nService),__decorateParam$i(9,IUndoRedoService),__decorateParam$i(10,IThemeService),__decorateParam$i(11,IChartContributionRegistry),__decorateParam$i(12,IChartResolutionRegistry),__decorateParam$i(13,IStudyService)],ChartWidget);class CursorScope{constructor(te,ee=void 0){Ee(this,"_value");Ee(this,"_touched",!1);this.initValue=te,this.parent=ee,this._value=te}value(){var te;return this._touched?this._value:(te=this.parent)==null?void 0:te.value()}touch(te){this._value=te,this._touched=!0}touched(){return this._touched?!0:this.parent?this.parent.touched():!1}}var __defProp$2=Object.defineProperty,__getOwnPropDesc$j=Object.getOwnPropertyDescriptor,__decorateClass$j=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$j(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=(ne?ae(te,ee,re):ae(re))||re);return ne&&re&&__defProp$2(te,ee,re),re},__decorateParam$h=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let ChartManagementService=class extends Disposable{constructor(te,ee){super();Ee(this,"_serviceBrand");Ee(this,"whenRestoredPromise",new DeferredPromise);Ee(this,"whenRestored",this.whenRestoredPromise.p);Ee(this,"_charts",new Map);Ee(this,"store");Ee(this,"_domElement");Ee(this,"_defaultPaneCursor",PaneCursor.unset);Ee(this,"_onChartAdd",this._register(new Emitter));Ee(this,"_onChartRemove",this._register(new Emitter));this.configurationService=te,this.instantiationService=ee;const ne=te.getValue("layout");this.store=writable({hideBits:0,tempMagnetMode:void 0,magnetMode:MagnetMode.Normal,cursor:PaneCursor.unset,activeIndex:NaN,layout:ne,instances:Object.create(null)}),this._register(toDisposable(()=>Reflect.set(this,"store",null)))}get onChartAdd(){return this._onChartAdd.event}get onChartRemove(){return this._onChartRemove.event}_getValue(te){return get$1(this.store)[te]}_setValue(te,ee){this.store.update(ne=>(ne[te]=ee,ne))}getDomElement(){return this._domElement}getCharts(){return Array.from(this._charts.values())}async setLayout(te){this._setValue("layout",te),await tick(),this.afterLayoutChange()}layout(){return get$1(this.store).layout}_layoutDetails(){return chartLayoutRegistry.value(this.layout())}async afterLayoutChange(){this._charts.values().forEach(ne=>ne.autoResize());const te=ensure(this._layoutDetails()),ee=this._getValue("activeIndex");(!isFinite(ee)||te.slotCount>=ee)&&this.setActiveChart(te.slotCount-1)}restore(te){this._domElement=te,this.afterLayoutChange();const ee=new ResizeObserver(()=>this.autoResize());ee.observe(te),this._register(toDisposable(()=>ee.disconnect())),this.whenRestoredPromise.complete()}autoResizeNow(){this._charts.values().forEach(te=>te.autoResize())}autoResize(){this.autoResizeNow()}manage(te,ee){const ne=this._createChart(te);this._onChartAdd.fire(ne),should(ne.getContainerDomElement()===te),should(ne.index===ee)}unmanage(te,ee){const ne=ensure(this._charts.get(ee));should(ne.getContainerDomElement()===te),ne.dispose(),this._onChartRemove.fire(ne),this._charts.delete(ee)}_createChart(te){const ee=this.chartsCount()?Math.max(...this._charts.keys()):-1;should(ee===this.chartsCount()-1);const ne=ee+1,re=this.configurationService.getValue("interval"),se={dataStatus:ChartDataStatus.idle,symbol:this.configurationService.getValue("symbol"),resolution:re,chartOptions:Object.create(null),chartProperties:this.configurationService.getValue("chartProperties"),studyProperties:this.configurationService.getValue("studyProperties"),symbolInfo:Object.create(null),mainLegend:Object.create(null),studyList:[],studyLegend:Object.create(null),drawingInfos:[],viewports:[]};this.store.update(le=>(le.instances[ne]=se,le));const ae=this.instantiationService.createInstance(ChartWidget,ne,te,{getStore:()=>derived(this.store,le=>le.instances[ne]),get:le=>get$1(this.store).instances[ne][le],update:le=>{this.store.update(ce=>{const he=ce.instances[ne];return le(he),ce})}},{setPaneCursor:this.setPaneCursor.bind(this),getPaneCursor:()=>this._defaultPaneCursor});return this._charts.set(ne,ae),ae}activeChart(){const te=this._getValue("activeIndex");return ensure(this._charts.get(te))}activeChartIndex(){return this._getValue("activeIndex")}chart(te){return isUndefinedOrNull(te)?this.activeChart():ensure(this._charts.get(te))}chartsCount(){return this._charts.size}setActiveChart(te){const ee=this._getValue("activeIndex"),ne=isFinite(ee)&&ee<this.chartsCount()?this.activeChart():null;if(isFiniteNumber(te)){const re=ensure(this._charts.get(te));if(re===ne)return;this._setValue("activeIndex",te),ne==null||ne.blur(),re.focus()}else{if(te===ne)return;const re=ensure(this._charts.values().find(se=>se===te));this._setValue("activeIndex",te.index),ne==null||ne.blur(),re.focus()}}setSymbol(te,ee,ne){this.activeChart().setSymbol(te),this.activeChart().setResolution(ee),ne==null||ne()}setPaneCursor(te,ee){ee&&(this._defaultPaneCursor===PaneCursor.demonstration&&te===PaneCursor.eraser?this._defaultPaneCursor=PaneCursor.demonstration|PaneCursor.eraser:this._defaultPaneCursor=te),te!==this._getValue("cursor")&&this._setValue("cursor",te)}getDefaultPaneCursor(){return this._defaultPaneCursor}setHideBits(te){const ee=get$1(this.store);if(ee.hideBits===te)return;const ne=HideDrawingsBit&ee.hideBits,re=HideDrawingsBit&te,se=HideIndicatorsBit&ee.hideBits,ae=HideIndicatorsBit&te,le=HidePositionsAndOrdersBit&ee.hideBits,ce=HidePositionsAndOrdersBit&te;this._setValue("hideBits",te),this.getCharts().forEach(he=>{se!==ae&&he.toggleIndicatorsVisible(!re),ne!==re&&he.toggleDrawingsVisibility(!re),le!==ce&&he.togglePositionsAndOrdersVisibility(!ce)})}};__decorateClass$j([debounce(8)],ChartManagementService.prototype,"autoResize",1);ChartManagementService=__decorateClass$j([__decorateParam$h(0,IConfigurationService),__decorateParam$h(1,IInstantiationService)],ChartManagementService);const IClipboardService=createDecorator$1("clipboardService"),HtmlMIME="text/html",TextMIME="text/plain";class ClipboardService extends Disposable{constructor(ee){super();Ee(this,"_onPaste",new Emitter);Ee(this,"onPaste",this._onPaste.event);Ee(this,"_inMemoryData",null);this._register(addDisposableListener(document,"copy",()=>this.clearInMemoryData())),this._register(addDisposableListener(document,"paste",ne=>{const re=ne.target||document.activeElement,se=PartFingerprints.collect(re,ee);if(!se.length||se[0]===PartFingerprint.Textarea||!ne.clipboardData||!ne.clipboardData.items)return;const ae=Object.create(null),le=[];ne.clipboardData.getData("text");for(const ce of ne.clipboardData.items)ce.type===HtmlMIME&&(ae.html=ne.clipboardData.getData(HtmlMIME)),ce.type===TextMIME&&(ae.text=ne.clipboardData.getData(TextMIME)),ce.type.startsWith("image")&&le.push(ce.getAsFile());le.length&&(ae.files=le),!isEmpty(ae)&&(this._onPaste.fire(ae),this._inMemoryData=null)}))}async writeClipboard(ee,ne){const re=ee.files&&ee.files.length>0;if(!re&&ne&&ne.eventPhase>0)return writeViaLegacyCopy(ne,ee),Promise.resolve();if(!re){let se=!1;const ae=le=>{le.stopImmediatePropagation(),writeViaLegacyCopy(le,ee),se=!0};try{document.addEventListener("copy",ae,!0),document.execCommand("copy")}finally{document.removeEventListener("copy",ae,!0)}if(se)return Promise.resolve()}try{await writeViaClipboardApi(ee)}catch{}this._inMemoryData=isEmpty(ee)?null:ee}clearInMemoryData(){this._inMemoryData=null}}function writeViaLegacyCopy(ie,te){ie.preventDefault();const ee=ensure(ie.clipboardData);te.text&&ee.setData("text/plain",te.text),te.html&&ee.setData("text/html",te.html)}async function writeViaClipboardApi(ie){const te=navigator.clipboard;if(!te||!te.write||!window.ClipboardItem)throw new DOMException("ClipboardApi is not supported","NotSupportedError");const ee=Object.create(null);for(const ne of ie.files||[])ee[ne.type]=ne;return ie.text&&(ee[TextMIME]=new Blob([ie.text],{type:TextMIME})),ie.html&&(ee[HtmlMIME]=new Blob([ie.html],{type:HtmlMIME})),te.write([new ClipboardItem(ee)])}const ICommandService=createDecorator$1("commandService"),ICommandRegistry=createDecorator$1("commandRegistry");class CommandRegistry{constructor(){Ee(this,"_serviceBrand");Ee(this,"_commands",new Map)}registerCommand(te){const{id:ee}=te;let ne=this._commands.get(ee);ne||(ne=new LinkedList,this._commands.set(ee,ne));const re=ne.unshift(te);return toDisposable(()=>{re();const ae=this._commands.get(ee);ae!=null&&ae.isEmpty()&&this._commands.delete(ee)})}getCommand(te){const ee=this._commands.get(te);if(!(!ee||ee.isEmpty()))return Iterable.first(ee)}dispose(){this._commands.clear()}}var __getOwnPropDesc$i=Object.getOwnPropertyDescriptor,__decorateClass$i=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$i(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$g=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let CommandService=class{constructor(ie,te){Ee(this,"_instantiationService");this.commandRegistry=te,this._instantiationService=ie}executeCommand(ie,...te){const ee=this.commandRegistry.getCommand(ie);if(!ee)return Promise.reject(new Error(`command '${ie}' not found`));try{const ne=this._instantiationService.invokeFunction.apply(this._instantiationService,[ee.handler,...te]);return Promise.resolve(ne)}catch(ne){return Promise.reject(ne)}}};CommandService=__decorateClass$i([__decorateParam$g(0,IInstantiationService),__decorateParam$g(1,ICommandRegistry)],CommandService);function keys(ie){return Object.keys(ie)}const chartDefaultProperties={timezone:"exchange","mainSeriesProperties.style":ChartStyleType.Candle,"mainSeriesProperties.statusViewStyle.showExchange":!1,"mainSeriesProperties.statusViewStyle.showInterval":!0,"mainSeriesProperties.statusViewStyle.symbolTextSource":"description","mainSeriesProperties.candleStyle.upColor":"#089981","mainSeriesProperties.candleStyle.downColor":"#F23645","mainSeriesProperties.candleStyle.drawWick":!0,"mainSeriesProperties.candleStyle.drawBorder":!1,"mainSeriesProperties.candleStyle.borderColor":"#378658","mainSeriesProperties.candleStyle.borderUpColor":"#089981","mainSeriesProperties.candleStyle.borderDownColor":"#F23645","mainSeriesProperties.candleStyle.wickColor":"#737375","mainSeriesProperties.candleStyle.wickUpColor":"#089981","mainSeriesProperties.candleStyle.wickDownColor":"#F23645","mainSeriesProperties.candleStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.candleStyle.drawBody":!0,"mainSeriesProperties.hollowCandleStyle.upColor":"#089981","mainSeriesProperties.hollowCandleStyle.downColor":"#F23645","mainSeriesProperties.hollowCandleStyle.drawWick":!0,"mainSeriesProperties.hollowCandleStyle.drawBorder":!0,"mainSeriesProperties.hollowCandleStyle.borderColor":"#378658","mainSeriesProperties.hollowCandleStyle.borderUpColor":"#089981","mainSeriesProperties.hollowCandleStyle.borderDownColor":"#F23645","mainSeriesProperties.hollowCandleStyle.wickColor":"#737375","mainSeriesProperties.hollowCandleStyle.wickUpColor":"#089981","mainSeriesProperties.hollowCandleStyle.wickDownColor":"#F23645","mainSeriesProperties.hollowCandleStyle.drawBody":!0,"mainSeriesProperties.barStyle.upColor":"#089981","mainSeriesProperties.barStyle.downColor":"#F23645","mainSeriesProperties.barStyle.barColorsOnPrevClose":!1,"mainSeriesProperties.barStyle.dontDrawOpen":!1,"mainSeriesProperties.barStyle.thinBars":!0,"mainSeriesProperties.lineStyle.color":"#2962FF","mainSeriesProperties.lineStyle.linestyle":0,"mainSeriesProperties.lineStyle.linewidth":2,"mainSeriesProperties.lineStyle.priceSource":"close","mainSeriesProperties.areaStyle.color1":"rgba(41, 98, 255, 0)","mainSeriesProperties.areaStyle.color2":"rgba(41, 98, 255, 0.28)","mainSeriesProperties.areaStyle.linecolor":"#2962FF","mainSeriesProperties.areaStyle.linestyle":0,"mainSeriesProperties.areaStyle.linewidth":2,"mainSeriesProperties.areaStyle.priceSource":"close","mainSeriesProperties.areaStyle.transparency":100},ChartFeaturePreset={create_volume_indicator_by_default:!0,header_resolutions:!0,header_chart_type:!0,header_indicators:!0,header_layouttoggle:!0,header_settings:!1,header_fullscreen_button:!0,header_screenshot:!0,left_toolbar:!0};class ConfigurationService extends Disposable{constructor(ee){var re;super();Ee(this,"store");const ne=ee.timezone??"exchange";this.store=writable({layout:"s",symbol:ee.symbol,interval:ee.interval,theme:ee.theme??"light",timezone:ne,studiesAccessType:(re=ee.studiesAccess)==null?void 0:re.type,studiesAccess:parseAccessList(ee.studiesAccess),chartProperties:Object.assign({},chartDefaultProperties,{timezone:ne}),studyProperties:Object.assign({},studyDefaultProperties,ee.studiesOverrides),chartFeatures:parseChartFeatures(ee.enabledFeatures,ee.disabledFeatures)}),this._register(toDisposable(()=>Reflect.set(this,"store",null)))}getValue(ee){return get$1(this.store)[ee]}setValue(ee,ne){this.store.update(re=>(re[ee]=ne,re))}featureEnabled(ee){return this.getValue("chartFeatures")[ee]}}function parseAccessList(ie){const te=Object.create(null);if(!ie)return te;const ee=ie.type;return ie.tools.reduce((ne,re)=>(ne[re.name]=re.grayed?"gray":ee,ne),te)}function parseChartFeatures(ie,te){const ee={...ChartFeaturePreset};return keys(ChartFeaturePreset).forEach(ne=>{ee[ne]=ChartFeaturePreset[ne],ie!=null&&ie.includes(ne)&&(ee[ne]=!0),te!=null&&te.includes(ne)&&(ee[ne]=!1)}),ee}const KEYBINDING_CONTEXT_ATTR="data-keybinding-context";class Context{constructor(te,ee){Ee(this,"_parent");Ee(this,"_value");Ee(this,"_id");this._id=te,this._parent=ee,this._value=Object.create(null),this._value._contextId=te}get value(){return{...this._value}}}class AbstractContextKeyService extends Disposable{constructor(ee){super();Ee(this,"_isDisposed");Ee(this,"_myContextId");this._isDisposed=!1,this._myContextId=ee}get contextId(){return this._myContextId}createScoped(ee){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new ScopedContextKeyService(this,ee)}getContext(ee){return this._isDisposed?NullContext.INSTANCE:this.getContextValuesContainer(findContextAttr(ee))}dispose(){super.dispose(),this._isDisposed=!0}}class ContextKeyService extends AbstractContextKeyService{constructor(){super(0);Ee(this,"_lastContextId");Ee(this,"_contexts",new Map);this._lastContextId=0;const ee=new ConfigAwareContextValuesContainer(this._myContextId);this._contexts.set(this._myContextId,ee)}getContextValuesContainer(ee){return this._isDisposed?NullContext.INSTANCE:this._contexts.get(ee)||NullContext.INSTANCE}createChildContext(ee=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const ne=++this._lastContextId;return this._contexts.set(ne,new Context(ne,this.getContextValuesContainer(ee))),ne}disposeContext(ee){this._isDisposed||this._contexts.delete(ee)}}class ScopedContextKeyService extends AbstractContextKeyService{constructor(ee,ne){super(ee.createChildContext());Ee(this,"_parent");Ee(this,"_domNode");if(this._parent=ee,this._domNode=ne,this._domNode.hasAttribute(KEYBINDING_CONTEXT_ATTR)){let re="";this._domNode.classList&&(re=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${re?": "+re:""}`)}this._domNode.setAttribute(KEYBINDING_CONTEXT_ATTR,String(this._myContextId))}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(KEYBINDING_CONTEXT_ATTR),super.dispose())}getContextValuesContainer(ee){return this._isDisposed?NullContext.INSTANCE:this._parent.getContextValuesContainer(ee)}createChildContext(ee=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(ee)}disposeContext(ee){this._isDisposed||this._parent.disposeContext(ee)}}const Il=class Il extends Context{constructor(){super(-1,null)}};Ee(Il,"INSTANCE",new Il);let NullContext=Il;class ConfigAwareContextValuesContainer extends Context{constructor(te){super(te,null)}}function findContextAttr(ie){for(;ie;){if(ie.hasAttribute(KEYBINDING_CONTEXT_ATTR)){const te=ie.getAttribute(KEYBINDING_CONTEXT_ATTR);return te?parseInt(te,10):NaN}ie=ie.parentElement}return 0}class DatafeedService extends Disposable{constructor(ee){super();Ee(this,"_serviceBrand");Ee(this,"_onReady",this._register(new Emitter));Ee(this,"onReady",this._onReady.event);Ee(this,"onTicks",new Map);Ee(this,"onResetCaches",new Map);this.datafeed=ee;let ne=re=>{this._disposed||this._onReady.fire(re)};ee.onReady(re=>ne(re)),this._register(toDisposable(()=>{ne=()=>{}}))}getBars(ee,ne,re,se,ae,le){if(le.isCancellationRequested)return;const ce=le.onCancellationRequested(()=>{se=()=>{},ae=()=>{},ce.dispose()});this.datafeed.getBars(ee,ne,re,(...he)=>{se(...he),ce.dispose()},(...he)=>{ae(...he),ce.dispose()})}resolveSymbol(ee,ne,re,se,ae){if(se.isCancellationRequested)return;const le=se.onCancellationRequested(()=>{ne=()=>{},re=()=>{},le.dispose()});this.datafeed.resolveSymbol(ee,(...ce)=>{ne(...ce),le.dispose()},(...ce)=>{re(...ce),le.dispose()},ae)}subscribeBars(ee,ne,re,se,ae){this.onTicks.set(se,re),this.onResetCaches.set(se,ae);const le=this.onTicks,ce=this.onResetCaches;this.datafeed.subscribeBars(ee,ne,he=>{var fe;(fe=le.get(se))==null||fe(he)},se,()=>{var he;(he=ce.get(se))==null||he()})}unsubscribeBars(ee){this.datafeed.unsubscribeBars(ee),this.onTicks.delete(ee),this.onResetCaches.delete(ee)}dispose(){super.dispose(),this.onTicks.clear(),this.onResetCaches.clear()}}const IGuiService=createDecorator$1("guiService"),ROOT_CLASSNAME="chartles";class GuiService extends Disposable{constructor(){super();Ee(this,"_serviceBrand");Ee(this,"_headerReady",new DeferredPromise);Ee(this,"_buttonReady",this._register(new Emitter));Ee(this,"buttonReady",this._buttonReady.event);Ee(this,"store");this.store=writable({leftButtons:[],rightButtons:[],components:[]})}headerReady(){return this._headerReady.p}dispose(){super.dispose(),this._headerReady.isSettled||this._headerReady.complete(),this.store=null,this._headerReady=null,this.buttonReady=null}setHeaderReady(){this._disposed||this._headerReady.complete()}async createButton(ee){const ne=Object.create(null);ne.id=generateUuid();const re=(ee==null?void 0:ee.align)??"left";ee!=null&&ee.useTradingViewStyle&&(ne.text=ee.text,ne.title=ee.title,ne.onClick=ee.onClick);const se=new DeferredPromise,ae=this.buttonReady(le=>{le.id===ne.id&&(ae.dispose(),se.complete(ee!=null&&ee.useTradingViewStyle?void 0:le.el))});switch(re){case"left":this.store.update(le=>(le.leftButtons.push(ne),le));break;case"right":this.store.update(le=>(le.rightButtons.push(ne),le));break;default:NOTREACHED()}return se.p}setButtonReady(ee,ne){this._buttonReady.fire({id:ee,el:ne})}showComponent(ee){const ne=generateUuid();return this.store.update(re=>(re.components.push({id:ne,Component:ee.Component,props:ee.props}),re)),{dispose:()=>{this.store.update(re=>{const se=re.components.findIndex(ae=>ae.id===ne);return se!==-1&&re.components.splice(se,1),{...re}})},update:re=>{this.store.update(se=>{const ae=se.components.find(le=>le.id===ne);return ae&&Object.assign(ae.props,re),{...se}})}}}}const en={"tool.cursor.cross":"Cross","tool.cursor.dot":"Dot","tool.cursor.arrow":"Arrow","tool.cursor.demo":"Demonstration","tool.cursor.magic":"Magic","tool.cursor.eraser":"Eraser","toolGroup.line":"LINES","tool.line.trendLine":"Trend Line","tool.line.ray":"Ray","tool.line.infoLine":"Info Line","tool.line.extendedLine":"Extended Line","tool.line.trendAngle":"Trend Angle","tool.line.horizontalLine":"Horizontal Line","tool.line.horizontalRay":"Horizontal Ray","tool.line.verticalLine":"Vertical Line","tool.line.crossLine":"Cross Line","toolGroup.channel":"CHANNELS","tool.channel.parallelChannel":"Parallel Channel","tool.channel.regressionTrend":"Regression Trend","tool.channel.flatTopBottom":"Flat Top/Bottom","tool.channel.disjointChannel":"Disjoint Channel","toolGroup.pitchfork":"PITCHFORKS","tool.pitchfork.pitchfork":"Pitchfork","tool.pitchfork.schiffPitchfork":"Schiff Pitchfork","tool.pitchfork.modifiedSchiffPitchfork":"Modified Schiff Pitchfork","tool.pitchfork.insidePitchfork":"Inside Pitchfork","toolGroup.fib":"FIBONACCI","tool.fib.fibRetracement":"Fib Retracement","tool.fib.trendBasedFibExtension":"Trend-Based Fib Extension","tool.fib.fibChannel":"Fib Channel","tool.fib.fibTimeZone":"Fib Time Zone","tool.fib.fibSpeedResistanceFan":"Fib Speed Resistance Fan","tool.fib.trendBasedFibTime":"Trend-Based Fib Time","tool.fib.fibCircles":"Fib Circles","tool.fib.fibSpiral":"Fib Spiral","tool.fib.fibSpeedResistanceArcs":"Fib Speed Resistance Arcs","tool.fib.fibWedge":"Fib Wedge","tool.fib.pitchfan":"Pitchfan","toolGroup.gann":"GANN","tool.gann.gannBox":"Gann Box","tool.gann.gannSquareFixed":"Gann Square Fixed","tool.gann.gannSquare":"Gann Square","tool.gann.gannFan":"Gann Fan","toolGroup.pattern":"PATTERNs","tool.pattern.xabcd":"XABCD Pattern","tool.pattern.cypher":"Cypher Pattern","tool.pattern.headAndShoulders":"Head and Shoulders","tool.pattern.abcd":"ABCD Pattern","tool.pattern.triangle":"Triangle Pattern","tool.pattern.threeDrives":"Three Drives Pattern","toolGroup.wave":"ELLIOTT WAVE","tool.wave.12345":"Elliott Impulse Wave (12345)","tool.wave.abc":"Elliott Correction Wave (ABC)","tool.wave.abcde":"Elliott Triangle Wave (ABCDE)","tool.wave.wxy":"Elliott Double Combo Wave (WXY)","tool.wave.wxyxz":"Elliott Triple Combo Wave (WXYXZ)","toolGroup.cycle":"CYCLICS","tool.cycle.cyclicLines":"Cyclic Lines","tool.cycle.timeCycles":"Time Cycles","tool.cycle.sineLine":"Sine Line","toolGroup.proj":"PROJECTION","tool.projection.longPosition":"Long Position","tool.projection.shortPosition":"Short Position","tool.projection.forecast":"Forecast","tool.projection.barsPattern":"Bars Pattern","tool.projection.ghostFeed":"Ghost Feed","tool.projection.projection":"Projection","toolGroup.volumn":"VOLUMN-BASED","tool.volumnBased.anchoredVwap":"Anchored VWAP","tool.volumnBased.fixedRangeVolumnProfile":"Fixed Range Volumn Profile","tool.volumnBased.anchoredVolumnProfile":"Anchored Volumn Profile","toolGroup.measurer":"MEASURER","tool.measurer.priceRange":"Price Range","tool.measurer.dateRange":"Date Range","tool.measurer.dataAndPriceRange":"Date and Price Range","toolGroup.brush":"BRUSHES","tool.brush.brush":"Brush","tool.brush.highlighter":"Highlighter","toolGroup.arrow":"ARROWS","tool.arrow.arrowMarker":"Arrow Marker","tool.arrow.arrow":"Arrow","tool.arrow.arrowMarkUp":"Arrow Mark Up","tool.arrow.arrowMarkDown":"Arrow Mark Down","tool.arrow.arrowMarkLeft":"Arrow Mark Left","tool.arrow.arrowMarkRight":"Arrow Mark Right","toolGroup.shape":"SHAPES","tool.shape.rect":"Rectangle","tool.shape.rotatedRect":"Rotated Rectangle","tool.shape.path":"Path","tool.shape.circle":"Circle","tool.shape.ellipse":"Ellipse","tool.shape.polyline":"Polyline","tool.shape.triangle":"Triangle","tool.shape.arc":"Arc","tool.shape.curve":"Curve","tool.shape.doubleCurve":"Double Curve","toolGroup.text":"TEXT & NOTES","tool.text.text":"Text","tool.text.anchoredText":"Anchored Text","tool.text.note":"Note","tool.text.priceNote":"Price Note","tool.text.pin":"Pin","tool.text.pinFixed":"Anchored Pin","tool.text.table":"Table","tool.text.callout":"Callout","tool.text.comment":"Comment","tool.text.priceLabel":"Price Label","tool.text.signpost":"Signpost","tool.text.flagMark":"Flag Mark","toolGroup.content":"CONTENT","tool.content.image":"Image","tool.emoji":"Emoji","tool.sticker":"Sticker","tool.icon":"Icons","tool.emoji.group.smiles&people":"smiles & people","tool.emoji.group.animals&nature":"animals & nature","tool.emoji.group.food&drink":"food & drink","tool.emoji.group.activity":"activity","tool.emoji.group.travel&places":"travel & places","tool.emoji.group.objects":"objects","tool.emoji.group.symbols":"symbols","tool.emoji.group.flags":"flags","tool.icon.group.gestures&smileys":"GESTURES & SMILEYS","tool.icon.group.symbols&flags":"SYMBOLS & FLAGS","tool.icon.group.nature":"NATURE","tool.icon.group.currency":"CURRENCY","tool.icon.group.objects":"OBJECTS","tool.icon.group.arrows":"ARROWS","tool.measure":"Measure","tool.measure.after":" + click on the chart","tool.zoomIn":"Zoom In","tool.zoomOut":"Zoom Out","tool.magnet":"Magnet Mode snaps drawings placed near price bars to the closest OHLC value","tool.keepDraw":"Keep drawing","tool.lockDraw":"Lock All drawings","tool.hide.hideAll":"Hide all drawings, indicators, positions & orders","tool.hide.showAll":"Show all drawings, indicators, positions & orders","tool.hide.hideDrawing":"Hide all drawings","tool.hide.showDrawing":"Show all drawings","tool.hide.hideIndicator":"Hide all indicators","tool.hide.showIndicator":"Show all indicators","tool.hide.hidePosition":"Hide all positions & orders","tool.hide.showPosition":"Show all positions & orders","tool.removeObjects":"Remove objects","tool.more.cursor":"Cursor","tool.more.trendLine":"Trend line tools","tool.more.gannAndFib":"Gann and Fibonacci tools","tool.more.pattern":"Patterns","tool.more.forecastAndMeasure":"Forecasting and measurement tools","tool.more.shapes":"Geometric shapes","tool.more.annotation":"Annotation tools","tool.more.icons":"Icons","tool.more.magnet":"Magnets","tool.more.hide":"Hide Options","tool.more.remove":"Remove options","tool.magnet.weak":"Weak Magnet","tool.magnet.strong":"Strong Magnet","tool.remove.drawing":"Remove {draw} drawings","tool.remove.indicator":"Remove {ind} indicators","tool.remove.drawingAndIndicator":"Remove {draw} indicators & {ind} indicators","resolutionGroup.ticks":"TICKS","resolutionGroup.seconds":"SECONDS","resolutionGroup.minutes":"MINUTES","resolutionGroup.hours":"HOURS","resolutionGroup.days":"DAYS","resolution.tick":"1 tick","resolution.tick_plural":"{count} ticks","resolution.second":"1 second","resolution.second_plural":"{count} seconds","resolution.minute":"1 minute","resolution.minute_plural":"{count} minutes","resolution.hour":"1 hour","resolution.hour_plural":"{count} hours","resolution.day":"1 day","resolution.day_plural":"{count} days","resolution.weak":"1 weak","resolution.weak_plural":"{count} weaks","resolution.month":"1 month","resolution.month_plural":"{count} months","resolution.year":"1 year","resolution.year_plural":"{count} years","resolution.timeSpan.day":"d","resolution.timeSpan.hour":"h","resolution.timeSpan.minute":"m","resolution.timeSpan.second":"s","chartStyle.bar":"Bars","chartStyle.candle":"Candles","chartStyle.hollowCandle":"Hollow Candles","chartStyle.line":"Line","chartStyle.area":"Area","topToolbar.symbolSearch":"Symbol Search","topToolbar.compare":"Compare or Add Symbol","topToolbar.indicator":"Indicators","topToolbar.indicator.tip":"Indicators","topToolbar.layout":"Layout setup","topToolbar.setting":"Chart settings","topToolbar.fullscreen":"Fullscreen mode","topToolbar.snapshot":"Take a snapshot","topToolbar.snapshot.menu.title":"CHART SNAPSHOT","topToolbar.snapshot.downloadImage":"Download image","topToolbar.snapshot.copyImage":"Copy image","topToolbar.snapshot.copyImage.success":"Chart image copied to clipboard","legend.changeSymbol":"Change Symbol","legend.changeInterval":"Change interval","legend.more":"More","legend.remove":"Remove","legend.main.open":"O","legend.main.high":"H","legend.main.low":"L","legend.main.close":"C","legend.main.showLess":"Hide indicator legend","legend.main.showMore":"Show indicator legend","indicator.dialog.title":"Indicators","indicator.dialog.script":"SCRIPT NAME","setting.title":"Chart settings","crosshairMenu.buyLimit":"Buy 1 {symbol} @ {ask} limit","crosshairMenu.sellStop":"Sell 1 {symbol} @ {bid} stop","crosshairMenu.newOrder":"Create new order…","crosshairMenu.settings":"Trading settings...","crosshairMenu.draw":"Draw Horizontal Line at {price}","common.search":"Search","common.cancel":"Cancel","common.ok":"Ok","trade.buy":"Buy","trade.sell":"Buy","tradePrimitive.order.buyLimit":"Buy Limit","tradePrimitive.order.buyMarket":"Buy Market","tradePrimitive.order.sellLimit":"Sell Limit","tradePrimitive.order.sellMarket":"Sell Limit","tradePrimitive.order.sellStop":"Sell Stop","tradePrimitive.order.takeProfit":"Take Profit","tradePrimitive.order.stopLoss":"Stop Loss","tradePrimitive.order.tip.cancel":"Cancel Order","tradePrimitive.order.tip.modify":"Modify order...","tradePrimitive.order.tip.tp":"Drag to add Take profit","tradePrimitive.order.tip.sl":"Drag to add Stop loss","tradePrimitive.position.tip.rv":"Reverse position","tradePrimitive.position.tip.protect":"Protect position...","tradePrimitive.position.tip.close":"Close position...","tradePrimitive.execution.tip":"{side} {qty} @ {price}","tool.line.common.bars":"{count} bars","tool.line.common.distance":"distance: {distance}","tool.headAndShoulders.left":"Left Shoulder","tool.headAndShoulders.head":"Head","tool.headAndShoulders.right":"Right Shoulder","tool.position.target":"Target: {profitChange}({profitChangePercent}) {profitChangePip}, Amount: {amount}","tool.position.open":"Open","tool.position.close":"Close","tool.position.pnl":"{status} P&L: {pnl}","tool.position.qty":"Qty: {qty}","tool.position.ratio":"Risk/Reward Ratio: {riskRewardRatio}","tool.position.stop":"Stop: {stopChange}({stopChangePercent}) {stopChangePip}, Amount: {amount}","tool.forecast.success":"SUCCESS","tool.forecast.failure":"FAILURE","tool.forecast.in":"in {timeSpan}","tool.text.common.addText":"Add text","tool.image.dialog.title":"Image","tool.image.dialog.choose":"Choose Image","tool.image.dialog.imageTypes":"JPG, PNG or WEBP","tool.image.dialog.sizeLimit":"Max size 2MB","contextMenu.clone":"Clone","contextMenu.clone.kb.drag":"Drag","contextMenu.copy":"Copy","priceAxis.mode.regular":"Regular","priceAxis.mode.log":"Logarithmic","priceAxis.mode.percent":"Percent","drawingBar.show":"Show Drawings Toolbar","drawingBar.hide":"Hide Drawings Toolbar"},localeDateFormats={zh:"yyyy-MM-dd",en:"dd MMM ''yy",fr:"dd/MM/yyyy",de:"dd.MM.yyyy",id_ID:"dd/MM/yyyy",ja:"yyyy/MM/dd",ko:"yyyy. M. d.",pl:"dd.MM.yyyy",pt:"dd/MM/yyyy",es:"dd/MM/yyyy",th:"d/M/yyyy",vi:"dd/MM/yyyy",ms_MY:"dd/MM/yyyy",zh_TW:"yyyy-MM-dd"},InvalidTranslation=[null,void 0,""];function translate(ie,te,ee,ne){try{let re=ie[te][ee];if(InvalidTranslation.includes(re))return"";if(ne&&"count"in ne&&Number(ne.count)>1){const se=ie[te][ee+"_plural"];se&&(re=se)}return ne&&Reflect.ownKeys(ne).forEach(se=>{re=re.replace(new RegExp(`{${se}}`,"g"),`${ne[se]}`)}),re}catch{return console.warn(`can not found [${te}] translation file`),ee}}const dicts={en};class I18nService{constructor(te){Ee(this,"_serviceBrand");this.locale=te}dateFormat(){return ensure(localeDateFormats[this.locale])}dateTimeFormat(te){return`${this.dateFormat()} HH:mm${te?":ss":""}`}t(te,ee){return te?translate(dicts,"en",te,ee):""}formatNumber(te){return te.toFixed(0)}}const IInputService=createDecorator$1("IInputManager"),IKeybindingService=createDecorator$1("keybindingService"),IToolService=createDecorator$1("IToolService"),IToolRegistry=createDecorator$1("toolRegistry");var ToolInvocationPhase=(ie=>(ie[ie.idle=0]="idle",ie[ie.activated=1]="activated",ie))(ToolInvocationPhase||{}),__getOwnPropDesc$h=Object.getOwnPropertyDescriptor,__decorateClass$h=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$h(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$f=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let InputService=class extends Disposable{constructor(ie,te,ee){super(),this.toolService=ie,this.keybindingService=te,this.chartManagementService=ee,this._register(ee.onChartAdd(ne=>{ne.installEventFilter(this)}))}eventFilter(ie){switch(ie.type){case InputEventType.KEY_DOWN:{const te=ensure(ie.asKeyboardInputEvent()).init;this.keybindingService.dispatchEvent(te,this.chartManagementService.activeChart().getContainerDomElement())&&(te.preventDefault(),te.stopPropagation(),ie.accept());break}}return ie.isAccepted()||this.toolService.processEvent(ie),ie.isAccepted()}};InputService=__decorateClass$h([__decorateParam$f(0,IToolService),__decorateParam$f(1,IKeybindingService),__decorateParam$f(2,IChartManagementService)],InputService);class SyncDescriptor{constructor(te,ee=[],ne=!1){Ee(this,"ctor");Ee(this,"staticArguments");Ee(this,"supportsDelayedInstantiation");this.ctor=te,this.staticArguments=ee,this.supportsDelayedInstantiation=ne}}let Node$1=class{constructor(te,ee){Ee(this,"incoming",new Map);Ee(this,"outgoing",new Map);this.key=te,this.data=ee}};class Graph{constructor(te){Ee(this,"_nodes",new Map);this._hashFn=te}roots(){const te=[];for(const ee of this._nodes.values())ee.outgoing.size===0&&te.push(ee);return te}insertEdge(te,ee){const ne=this.lookupOrInsertNode(te),re=this.lookupOrInsertNode(ee);ne.outgoing.set(re.key,re),re.incoming.set(ne.key,ne)}removeNode(te){const ee=this._hashFn(te);this._nodes.delete(ee);for(const ne of this._nodes.values())ne.outgoing.delete(ee),ne.incoming.delete(ee)}lookupOrInsertNode(te){const ee=this._hashFn(te);let ne=this._nodes.get(ee);return ne||(ne=new Node$1(ee,te),this._nodes.set(ee,ne)),ne}lookup(te){return this._nodes.get(this._hashFn(te))}isEmpty(){return this._nodes.size===0}toString(){const te=[];for(const[ee,ne]of this._nodes)te.push(`${ee}
	(-> incoming)[${[...ne.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...ne.outgoing.keys()].join(",")}]
`);return te.join(`
`)}findCycleSlow(){for(const[te,ee]of this._nodes){const ne=new Set([te]),re=this._findCycle(ee,ne);if(re)return re}}_findCycle(te,ee){for(const[ne,re]of te.outgoing){if(ee.has(ne))return[...ee,ne].join(" -> ");ee.add(ne);const se=this._findCycle(re,ee);if(se)return se;ee.delete(ne)}}}const _enableAllTracing=!1;class CyclicDependencyError extends Error{constructor(te){super("cyclic dependency between services"),this.message=te.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${te.toString()}`}}class InstantiationService{constructor(te=new ServiceCollection,ee=!1,ne,re=_enableAllTracing){Ee(this,"_globalGraph");Ee(this,"_globalGraphImplicitDependency");Ee(this,"_isDisposed",!1);Ee(this,"_servicesToMaybeDispose",new Set);Ee(this,"_children",new Set);Ee(this,"_activeInstantiations",new Set);this._services=te,this._strict=ee,this._parent=ne,this._enableTracing=re,this._services.set(IInstantiationService,this),this._globalGraph=re?(ne==null?void 0:ne._globalGraph)??new Graph(se=>se):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,dispose(this._children),this._children.clear();for(const te of this._servicesToMaybeDispose)isDisposable(te)&&te.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(te,ee){this._throwIfDisposed();const ne=this,re=new class extends InstantiationService{dispose(){ne._children.delete(re),super.dispose()}}(te,this._strict,this,this._enableTracing);return this._children.add(re),ee==null||ee.add(re),re}invokeFunction(te,...ee){this._throwIfDisposed();const ne=Trace.traceInvocation(this._enableTracing,te);let re=!1;try{return te({get:ae=>{if(re)throw illegalState("service accessor is only valid during the invocation of its target method");const le=this._getOrCreateServiceInstance(ae,ne);if(!le)throw new Error(`[invokeFunction] unknown service '${ae}'`);return le}},...ee)}finally{re=!0,ne.stop()}}createInstance(te,...ee){this._throwIfDisposed();let ne,re;return te instanceof SyncDescriptor?(ne=Trace.traceCreation(this._enableTracing,te.ctor),re=this._createInstance(te.ctor,te.staticArguments.concat(ee),ne)):(ne=Trace.traceCreation(this._enableTracing,te),re=this._createInstance(te,ee,ne)),ne.stop(),re}_createInstance(te,ee=[],ne){const re=_util.getServiceDependencies(te).sort((le,ce)=>le.index-ce.index),se=[];for(const le of re){const ce=this._getOrCreateServiceInstance(le.id,ne);ce||this._throwIfStrict(`[createInstance] ${te.name} depends on UNKNOWN service ${le.id}.`,!1),se.push(ce)}const ae=re.length>0?re[0].index:ee.length;if(ee.length!==ae){console.trace(`[createInstance] First service dependency of ${te.name} at position ${ae+1} conflicts with ${ee.length} static arguments`);const le=ae-ee.length;le>0?ee=ee.concat(new Array(le)):ee=ee.slice(0,ae)}return Reflect.construct(te,ee.concat(se))}_setCreatedServiceInstance(te,ee){if(this._services.get(te)instanceof SyncDescriptor)this._services.set(te,ee);else if(this._parent)this._parent._setCreatedServiceInstance(te,ee);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(te){const ee=this._services.get(te);return!ee&&this._parent?this._parent._getServiceInstanceOrDescriptor(te):ee}_getOrCreateServiceInstance(te,ee){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(te));const ne=this._getServiceInstanceOrDescriptor(te);return ne instanceof SyncDescriptor?this._safeCreateAndCacheServiceInstance(te,ne,ee.branch(te,!0)):(ee.branch(te,!1),ne)}_safeCreateAndCacheServiceInstance(te,ee,ne){if(this._activeInstantiations.has(te))throw new Error(`illegal state - RECURSIVELY instantiating service '${te}'`);this._activeInstantiations.add(te);try{return this._createAndCacheServiceInstance(te,ee,ne)}finally{this._activeInstantiations.delete(te)}}_createAndCacheServiceInstance(te,ee,ne){var ce;const re=new Graph(he=>he.id.toString());let se=0;const ae=[{id:te,desc:ee,_trace:ne}],le=new Set;for(;ae.length;){const he=ae.pop();if(!le.has(String(he.id))){if(le.add(String(he.id)),re.lookupOrInsertNode(he),se++>1e3)throw new CyclicDependencyError(re);for(const fe of _util.getServiceDependencies(he.desc.ctor)){const Ae=this._getServiceInstanceOrDescriptor(fe.id);if(Ae||this._throwIfStrict(`[createInstance] ${te} depends on ${fe.id} which is NOT registered.`,!0),(ce=this._globalGraph)==null||ce.insertEdge(String(he.id),String(fe.id)),Ae instanceof SyncDescriptor){const pe={id:fe.id,desc:Ae,_trace:he._trace.branch(fe.id,!0)};re.insertEdge(he,pe),ae.push(pe)}}}}for(;;){const he=re.roots();if(he.length===0){if(!re.isEmpty())throw new CyclicDependencyError(re);break}for(const{data:fe}of he){if(this._getServiceInstanceOrDescriptor(fe.id)instanceof SyncDescriptor){const pe=this._createServiceInstanceWithOwner(fe.id,fe.desc.ctor,fe.desc.staticArguments,fe.desc.supportsDelayedInstantiation,fe._trace);this._setCreatedServiceInstance(fe.id,pe)}re.removeNode(fe)}}return this._getServiceInstanceOrDescriptor(te)}_createServiceInstanceWithOwner(te,ee,ne=[],re,se){if(this._services.get(te)instanceof SyncDescriptor)return this._createServiceInstance(te,ee,ne,re,se,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(te,ee,ne,re,se);throw new Error(`illegalState - creating UNKNOWN service instance ${ee.name}`)}_createServiceInstance(te,ee,ne=[],re,se,ae){if(re){const le=new InstantiationService(void 0,this._strict,this,this._enableTracing);le._globalGraphImplicitDependency=String(te);const ce=new Map,he=new GlobalIdleValue(()=>{const fe=le._createInstance(ee,ne,se);for(const[Ae,pe]of ce){const Oe=fe[Ae];if(typeof Oe=="function")for(const Fe of pe)Fe.disposable=Oe.apply(fe,Fe.listener)}return ce.clear(),ae.add(fe),fe});return new Proxy(Object.create(null),{get(fe,Ae){if(!he.isInitialized&&typeof Ae=="string"&&(Ae.startsWith("onDid")||Ae.startsWith("onWill"))){let Fe=ce.get(Ae);return Fe||(Fe=new LinkedList,ce.set(Ae,Fe)),(ze,He,We)=>{if(he.isInitialized)return he.value[Ae](ze,He,We);{const je={listener:[ze,He,We],disposable:void 0},Ue=Fe.push(je);return toDisposable(()=>{var Ze;Ue(),(Ze=je.disposable)==null||Ze.dispose()})}}}if(Ae in fe)return fe[Ae];const pe=he.value;let Oe=pe[Ae];return typeof Oe!="function"||(Oe=Oe.bind(pe),fe[Ae]=Oe),Oe},set(fe,Ae,pe){return he.value[Ae]=pe,!0},getPrototypeOf(fe){return ee.prototype}})}else{const le=this._createInstance(ee,ne,se);return ae.add(le),le}}_throwIfStrict(te,ee){if(ee&&console.warn(te),this._strict)throw new Error(te)}}const Wo=class Wo{constructor(te,ee){Ee(this,"_start",Date.now());Ee(this,"_dep",[]);this.type=te,this.name=ee}static traceInvocation(te,ee){return te?new Wo(2,ee.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):Wo._None}static traceCreation(te,ee){return te?new Wo(1,ee.name):Wo._None}branch(te,ee){const ne=new Wo(3,te.toString());return this._dep.push([te,ee,ne]),ne}stop(){const te=Date.now()-this._start;Wo._totals+=te;let ee=!1;function ne(se,ae){const le=[],ce=new Array(se+1).join("	");for(const[he,fe,Ae]of ae._dep)if(fe&&Ae){ee=!0,le.push(`${ce}CREATES -> ${he}`);const pe=ne(se+1,Ae);pe&&le.push(pe)}else le.push(`${ce}uses -> ${he}`);return le.join(`
`)}const re=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${ne(1,this)}`,`DONE, took ${te.toFixed(2)}ms (grand total ${Wo._totals.toFixed(2)}ms)`];(te>2||ee)&&Wo.all.add(re.join(`
`))}};Ee(Wo,"all",new Set),Ee(Wo,"_None",new class extends Wo{constructor(){super(0,null)}stop(){}branch(){return this}}),Ee(Wo,"_totals",0);let Trace=Wo;const ILogService=createDecorator$1("logService"),DEFAULT_LOG_LEVEL=3;class AbstractLogger extends Disposable{constructor(){super(...arguments);Ee(this,"level",DEFAULT_LOG_LEVEL);Ee(this,"_onDidChangeLogLevel",this._register(new Emitter));Ee(this,"onDidChangeLogLevel",this._onDidChangeLogLevel.event)}setLevel(ee){this.level!==ee&&(this.level=ee,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(ee){return this.level!==0&&this.level<=ee}canLog(ee){return this._store.isDisposed?!1:this.checkLogLevel(ee)}}class ConsoleLogger extends AbstractLogger{constructor(te=DEFAULT_LOG_LEVEL,ee=!0){super(),this.useColors=ee,this.setLevel(te)}trace(te,...ee){this.canLog(1)&&(this.useColors?console.log("%cTRACE","color: #888",te,...ee):console.log(te,...ee))}debug(te,...ee){this.canLog(2)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",te,...ee):console.log(te,...ee))}info(te,...ee){this.canLog(3)&&(this.useColors?console.log("%c INFO","color: #33f",te,...ee):console.log(te,...ee))}warn(te,...ee){this.canLog(4)&&(this.useColors?console.warn("%c WARN","color: #993",te,...ee):console.log(te,...ee))}error(te,...ee){this.canLog(5)&&(this.useColors?console.error("%c  ERR","color: #f33",te,...ee):console.error(te,...ee))}flush(){}}var ResultKind=(ie=>(ie[ie.NoMatchingKb=0]="NoMatchingKb",ie[ie.MoreChordsNeeded=1]="MoreChordsNeeded",ie[ie.KbFound=2]="KbFound",ie))(ResultKind||{});const NoMatchingKb={kind:0},MoreChordsNeeded={kind:1};function KbFound(ie,te,ee){return{kind:2,commandId:ie,commandArgs:te,isBubble:ee}}class KeybindingResolver{constructor(te,ee,ne,re){Ee(this,"_log");Ee(this,"_defaultKeybindings");Ee(this,"_keybindings");Ee(this,"_defaultBoundCommands");Ee(this,"_map");Ee(this,"_lookupMap");this._instantiationService=re,this._log=ne,this._defaultKeybindings=te,this._defaultBoundCommands=new Map;for(const se of te){const ae=se.command;ae&&ae.charAt(0)!=="-"&&this._defaultBoundCommands.set(ae,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=KeybindingResolver.handleRemovals([].concat(te).concat(ee));for(let se=0,ae=this._keybindings.length;se<ae;se++){const le=this._keybindings[se];le.chords.length!==0&&this._addKeyPress(le.chords[0],le)}}static _isTargetedForRemoval(te,ee){if(ee){for(let ne=0;ne<ee.length;ne++)if(ee[ne]!==te.chords[ne])return!1}return!0}static handleRemovals(te){const ee=new Map;for(let re=0,se=te.length;re<se;re++){const ae=te[re];if(ae.command&&ae.command.charAt(0)==="-"){const le=ae.command.substring(1);ee.has(le)?ee.get(le).push(ae):ee.set(le,[ae])}}if(ee.size===0)return te;const ne=[];for(let re=0,se=te.length;re<se;re++){const ae=te[re];if(!ae.command||ae.command.length===0){ne.push(ae);continue}if(ae.command.charAt(0)==="-")continue;const le=ee.get(ae.command);if(!le||!ae.isDefault){ne.push(ae);continue}let ce=!1;for(const he of le)if(this._isTargetedForRemoval(ae,he.chords)){ce=!0;break}if(!ce){ne.push(ae);continue}}return ne}_addKeyPress(te,ee){const ne=this._map.get(te);if(typeof ne>"u"){this._map.set(te,[ee]),this._addToLookupMap(ee);return}for(let re=ne.length-1;re>=0;re--){const se=ne[re];if(se.command===ee.command)continue;let ae=!0;for(let le=1;le<se.chords.length&&le<ee.chords.length;le++)if(se.chords[le]!==ee.chords[le]){ae=!1;break}ae&&this._removeFromLookupMap(se)}ne.push(ee),this._addToLookupMap(ee)}_addToLookupMap(te){if(!te.command)return;let ee=this._lookupMap.get(te.command);typeof ee>"u"?(ee=[te],this._lookupMap.set(te.command,ee)):ee.push(te)}_removeFromLookupMap(te){if(!te.command)return;const ee=this._lookupMap.get(te.command);if(!(typeof ee>"u")){for(let ne=0,re=ee.length;ne<re;ne++)if(ee[ne]===te){ee.splice(ne,1);return}}}getDefaultBoundCommands(){return this._defaultBoundCommands}getDefaultKeybindings(){return this._defaultKeybindings}getKeybindings(){return this._keybindings}lookupKeybindings(te){const ee=this._lookupMap.get(te);if(typeof ee>"u"||ee.length===0)return[];const ne=[];let re=0;for(let se=ee.length-1;se>=0;se--)ne[re++]=ee[se];return ne}resolve(te,ee,ne){const re=[...ee,ne];this._log(`| Resolving ${re}`);const se=this._map.get(re[0]);if(se===void 0)return this._log("\\ No keybinding entries."),NoMatchingKb;let ae=null;if(re.length<2)ae=se;else{ae=[];for(let ce=0,he=se.length;ce<he;ce++){const fe=se[ce];if(re.length>fe.chords.length)continue;let Ae=!0;for(let pe=1;pe<re.length;pe++)if(fe.chords[pe]!==re[pe]){Ae=!1;break}Ae&&ae.push(fe)}}const le=this._findCommand(te,ae);return le?re.length<le.chords.length?(this._log(`\\ From ${ae.length} keybinding entries, awaiting ${le.chords.length-re.length} more chord(s), when: ${printWhenExplanation(le.when)}, source: ${printSourceExplanation(le)}.`),MoreChordsNeeded):(this._log(`\\ From ${ae.length} keybinding entries, matched ${le.command}, when: ${printWhenExplanation(le.when)}, source: ${printSourceExplanation(le)}.`),KbFound(le.command,le.commandArgs,le.bubble)):(this._log(`\\ From ${ae.length} keybinding entries, no when clauses matched the context.`),NoMatchingKb)}_findCommand(te,ee){for(let ne=ee.length-1;ne>=0;ne--){const re=ee[ne];if(this._contextMatchesRules(te,re.when))return re}return null}_contextMatchesRules(te,ee){return ee?this._instantiationService.invokeFunction(ne=>ee(te,ne)):!0}}function printWhenExplanation(ie){return ie?`${ie.toString()}`:"no when condition"}function printSourceExplanation(ie){return ie.extensionId?ie.isBuiltinExtension?`built-in extension ${ie.extensionId}`:`user extension ${ie.extensionId}`:ie.isDefault?"built-in":"user"}var __getOwnPropDesc$g=Object.getOwnPropertyDescriptor,__decorateClass$g=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$g(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$e=(ie,te)=>(ee,ne)=>te(ee,ne,ie);const IKeybindingsRegistry=createDecorator$1("keybindingsRegistry");var KeybindingWeight=(ie=>(ie[ie.ChartCore=0]="ChartCore",ie[ie.ChartContrib=100]="ChartContrib",ie[ie.WorkbenchContrib=200]="WorkbenchContrib",ie[ie.BuiltinExtension=300]="BuiltinExtension",ie[ie.ExternalExtension=400]="ExternalExtension",ie))(KeybindingWeight||{});class KeybindingItem{constructor(te,ee,ne,re=0,se=0,ae=void 0){this.keybinding=te,this.command=ee,this.commandArgs=ne,this.weight1=re,this.weight2=se,this.when=ae}}let KeybindingsRegistry=class{constructor(ie){Ee(this,"_serviceBrand");Ee(this,"_coreKeybindings");Ee(this,"_cachedMergedKeybindings");this.commandRegistry=ie,this._coreKeybindings=new LinkedList,this._cachedMergedKeybindings=null}static bindToCurrentPlatform(ie){if(OS===OperatingSystem.Windows){if(ie&&ie.win)return ie.win}else if(OS===OperatingSystem.Macintosh){if(ie&&ie.mac)return ie.mac}else if(ie&&ie.linux)return ie.linux;return ie}registerKeybindingRule(ie){const te=KeybindingsRegistry.bindToCurrentPlatform(ie),ee=new DisposableStore;if(te&&te.primary){const ne=decodeKeybinding(te.primary,OS);ne&&ee.add(this._registerDefaultKeybinding(ne,ie.id,ie.args,ie.weight,0,ie.when))}if(te&&Array.isArray(te.secondary))for(let ne=0,re=te.secondary.length;ne<re;ne++){const se=te.secondary[ne],ae=decodeKeybinding(se,OS);ae&&ee.add(this._registerDefaultKeybinding(ae,ie.id,ie.args,ie.weight,-ne-1,ie.when))}return ee}registerCommandAndKeybindingRule(ie){return combinedDisposable(this.registerKeybindingRule(ie),this.commandRegistry.registerCommand(ie))}_registerDefaultKeybinding(ie,te,ee,ne=0,re=0,se=void 0){const ae=this._coreKeybindings.push(new KeybindingItem(ie,te,ee,ne,re,se));return this._cachedMergedKeybindings=null,toDisposable(()=>{ae(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings),this._cachedMergedKeybindings.sort(sorter)),this._cachedMergedKeybindings.slice(0)}dispose(){this._coreKeybindings.clear()}};KeybindingsRegistry=__decorateClass$g([__decorateParam$e(0,ICommandRegistry)],KeybindingsRegistry);function sorter(ie,te){if(ie.weight1!==te.weight1)return ie.weight1-te.weight1;if(ie.command&&te.command){if(ie.command<te.command)return-1;if(ie.command>te.command)return 1}return ie.weight2-te.weight2}class ModifierLabelProvider{constructor(te,ee,ne=ee){Ee(this,"modifierLabels");this.modifierLabels=[null],this.modifierLabels[OperatingSystem.Macintosh]=te,this.modifierLabels[OperatingSystem.Windows]=ee,this.modifierLabels[OperatingSystem.Linux]=ne}toLabel(te,ee,ne){if(ee.length===0)return null;const re=[];for(let se=0,ae=ee.length;se<ae;se++){const le=ee[se],ce=ne(le);if(ce===null)return null;re[se]=_simpleAsString(le,ce,this.modifierLabels[te])}return re.join(" ")}}function _simpleAsString(ie,te,ee){if(te===null)return"";const ne=[];return ie.ctrlKey&&ne.push(ee.ctrlKey),ie.shiftKey&&ne.push(ee.shiftKey),ie.altKey&&ne.push(ee.altKey),ie.metaKey&&ne.push(ee.metaKey),te!==""&&ne.push(te),ne.join(ee.separator)}const UILabelProvider=new ModifierLabelProvider({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Windows",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),cache=new Map;function getKeybindingLabel(ie,te=OS){if(cache.has(ie))return cache.get(ie)??"";const ee=decodeKeybinding(ie,te);let ne="";return ee&&(ne=UILabelProvider.toLabel(te,ee.chords,re=>keyCodeToChar[re.keyCode])??""),cache.set(ie,ne),ne}var CharCode=(ie=>(ie[ie.Null=0]="Null",ie[ie.Backspace=8]="Backspace",ie[ie.Tab=9]="Tab",ie[ie.LineFeed=10]="LineFeed",ie[ie.CarriageReturn=13]="CarriageReturn",ie[ie.Space=32]="Space",ie[ie.ExclamationMark=33]="ExclamationMark",ie[ie.DoubleQuote=34]="DoubleQuote",ie[ie.Hash=35]="Hash",ie[ie.DollarSign=36]="DollarSign",ie[ie.PercentSign=37]="PercentSign",ie[ie.Ampersand=38]="Ampersand",ie[ie.SingleQuote=39]="SingleQuote",ie[ie.OpenParen=40]="OpenParen",ie[ie.CloseParen=41]="CloseParen",ie[ie.Asterisk=42]="Asterisk",ie[ie.Plus=43]="Plus",ie[ie.Comma=44]="Comma",ie[ie.Dash=45]="Dash",ie[ie.Period=46]="Period",ie[ie.Slash=47]="Slash",ie[ie.Digit0=48]="Digit0",ie[ie.Digit1=49]="Digit1",ie[ie.Digit2=50]="Digit2",ie[ie.Digit3=51]="Digit3",ie[ie.Digit4=52]="Digit4",ie[ie.Digit5=53]="Digit5",ie[ie.Digit6=54]="Digit6",ie[ie.Digit7=55]="Digit7",ie[ie.Digit8=56]="Digit8",ie[ie.Digit9=57]="Digit9",ie[ie.Colon=58]="Colon",ie[ie.Semicolon=59]="Semicolon",ie[ie.LessThan=60]="LessThan",ie[ie.Equals=61]="Equals",ie[ie.GreaterThan=62]="GreaterThan",ie[ie.QuestionMark=63]="QuestionMark",ie[ie.AtSign=64]="AtSign",ie[ie.A=65]="A",ie[ie.B=66]="B",ie[ie.C=67]="C",ie[ie.D=68]="D",ie[ie.E=69]="E",ie[ie.F=70]="F",ie[ie.G=71]="G",ie[ie.H=72]="H",ie[ie.I=73]="I",ie[ie.J=74]="J",ie[ie.K=75]="K",ie[ie.L=76]="L",ie[ie.M=77]="M",ie[ie.N=78]="N",ie[ie.O=79]="O",ie[ie.P=80]="P",ie[ie.Q=81]="Q",ie[ie.R=82]="R",ie[ie.S=83]="S",ie[ie.T=84]="T",ie[ie.U=85]="U",ie[ie.V=86]="V",ie[ie.W=87]="W",ie[ie.X=88]="X",ie[ie.Y=89]="Y",ie[ie.Z=90]="Z",ie[ie.OpenSquareBracket=91]="OpenSquareBracket",ie[ie.Backslash=92]="Backslash",ie[ie.CloseSquareBracket=93]="CloseSquareBracket",ie[ie.Caret=94]="Caret",ie[ie.Underline=95]="Underline",ie[ie.BackTick=96]="BackTick",ie[ie.a=97]="a",ie[ie.b=98]="b",ie[ie.c=99]="c",ie[ie.d=100]="d",ie[ie.e=101]="e",ie[ie.f=102]="f",ie[ie.g=103]="g",ie[ie.h=104]="h",ie[ie.i=105]="i",ie[ie.j=106]="j",ie[ie.k=107]="k",ie[ie.l=108]="l",ie[ie.m=109]="m",ie[ie.n=110]="n",ie[ie.o=111]="o",ie[ie.p=112]="p",ie[ie.q=113]="q",ie[ie.r=114]="r",ie[ie.s=115]="s",ie[ie.t=116]="t",ie[ie.u=117]="u",ie[ie.v=118]="v",ie[ie.w=119]="w",ie[ie.x=120]="x",ie[ie.y=121]="y",ie[ie.z=122]="z",ie[ie.OpenCurlyBrace=123]="OpenCurlyBrace",ie[ie.Pipe=124]="Pipe",ie[ie.CloseCurlyBrace=125]="CloseCurlyBrace",ie[ie.Tilde=126]="Tilde",ie[ie.NoBreakSpace=160]="NoBreakSpace",ie))(CharCode||{});class ResolvedKeybindingItem{constructor(te,ee,ne,re,se,ae,le){Ee(this,"_resolvedKeybindingItemBrand");Ee(this,"resolvedKeybinding");Ee(this,"chords");Ee(this,"bubble");Ee(this,"command");Ee(this,"commandArgs");Ee(this,"when");Ee(this,"isDefault");Ee(this,"extensionId");Ee(this,"isBuiltinExtension");this.resolvedKeybinding=te,this.chords=te?toEmptyArrayIfContainsNull(te.getDispatchChords()):[],te&&this.chords.length===0&&NOTREACHED(),this.bubble=ee?ee.charCodeAt(0)===CharCode.Caret:!1,this.command=this.bubble?ee.substr(1):ee,this.commandArgs=ne,this.when=re,this.isDefault=se,this.extensionId=ae,this.isBuiltinExtension=le}}function toEmptyArrayIfContainsNull(ie){const te=[];for(let ee=0,ne=ie.length;ee<ne;ee++){const re=ie[ee];if(!re)return[];te.push(re)}return te}class ResolvedKeybinding{constructor(te,ee){Ee(this,"_os");Ee(this,"_chords");if(ee.length===0)throw illegalArgument("chords");this._os=te,this._chords=ee}getLabel(){return UILabelProvider.toLabel(this._os,this._chords,te=>this._getLabel(te))}getDispatchChords(){return this._chords.map(te=>this._getChordDispatch(te))}_getLabel(te){return te.isDuplicateModifierCase()?"":this._keyCodeToUILabel(te.keyCode)}_keyCodeToUILabel(te){return keyCodeToChar[te]}_getChordDispatch(te){return getDispatchStr(te)}static resolveKeybinding(te,ee){const ne=toEmptyArrayIfContainsNull(te.chords);return ne.length>0?[new ResolvedKeybinding(ee,ne)]:[]}}function getDispatchStr(ie){if(ie.isModifierKey())return null;let te="";return ie.ctrlKey&&(te+="ctrl+"),ie.shiftKey&&(te+="shift+"),ie.altKey&&(te+="alt+"),ie.metaKey&&(te+="meta+"),te+=KeyCodeUtils.toString(ie.keyCode),te}var __getOwnPropDesc$f=Object.getOwnPropertyDescriptor,__decorateClass$f=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$f(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$d=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let KeybindingService=class extends Disposable{constructor(te,ee,ne,re,se){super();Ee(this,"_serviceBrand");Ee(this,"_logging",!1);Ee(this,"_cachedResolver");Ee(this,"_dynamicKeybindings");Ee(this,"_currentlyDispatchingCommandId");this._commandService=te,this._logService=ee,this._contextKeyService=ne,this._instantiationService=re,this.keybindingsRegistry=se,this._cachedResolver=null,this._dynamicKeybindings=[],this._currentlyDispatchingCommandId=null}dispatchEvent(te,ee){return this._dispatch(te,ee)}_dispatch(te,ee){return this._doDispatch(this.resolveKeyboardEvent(te),ee)}_doDispatch(te,ee){let ne=!1;const[re]=te.getDispatchChords();if(re===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),ne;const se=this._contextKeyService.getContext(ee),ae=te.getLabel(),le=this._getResolver().resolve(se,[],re);switch(le.kind){case ResultKind.NoMatchingKb:return this._logService.trace("KeybindingService#dispatch",ae,"[ No matching keybinding ]"),ne;case ResultKind.MoreChordsNeeded:return NOTREACHED();case ResultKind.KbFound:{if(this._logService.trace("KeybindingService#dispatch",ae,`[ Will dispatch command ${le.commandId} ]`),!(le.commandId===null||le.commandId==="")){le.isBubble||(ne=!0),this._log(`+ Invoking command ${le.commandId}.`),this._currentlyDispatchingCommandId=le.commandId;try{typeof le.commandArgs>"u"?this._commandService.executeCommand(le.commandId).then(void 0,ce=>this._logService.warn(ce)):this._commandService.executeCommand(le.commandId,le.commandArgs).then(void 0,ce=>this._logService.warn(ce))}finally{this._currentlyDispatchingCommandId=null}}return ne}}}_getResolver(){if(!this._cachedResolver){const te=this._toNormalizedKeybindingItems(this.keybindingsRegistry.getDefaultKeybindings(),!0),ee=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new KeybindingResolver(te,ee,ne=>this._log(ne),this._instantiationService)}return this._cachedResolver}_toNormalizedKeybindingItems(te,ee){const ne=[];let re=0;for(const se of te){const ae=se.when||void 0,le=se.keybinding;if(!le)ne[re++]=new ResolvedKeybindingItem(void 0,se.command,se.commandArgs,ae,ee,null,!1);else{const ce=ResolvedKeybinding.resolveKeybinding(le,OS);for(const he of ce)ne[re++]=new ResolvedKeybindingItem(he,se.command,se.commandArgs,ae,ee,null,!1)}}return ne}_log(te){this._logging&&this._logService.info(`[KeybindingService]: ${te}`)}resolveKeyboardEvent(te){const ee=new KeyCodeChord(te.ctrlKey,te.shiftKey,te.altKey,te.metaKey,te.keyCode);return new ResolvedKeybinding(OS,[ee])}};KeybindingService=__decorateClass$f([__decorateParam$d(0,ICommandService),__decorateParam$d(1,ILogService),__decorateParam$d(2,IContextKeyService),__decorateParam$d(3,IInstantiationService),__decorateParam$d(4,IKeybindingsRegistry)],KeybindingService);const ILifecycleService=createDecorator$1("lifecycleService");var LifecyclePhase=(ie=>(ie[ie.Starting=1]="Starting",ie[ie.Ready=2]="Ready",ie[ie.Restored=3]="Restored",ie[ie.Eventually=4]="Eventually",ie))(LifecyclePhase||{});class LifecycleService extends Disposable{constructor(){super(...arguments);Ee(this,"_phase",LifecyclePhase.Starting);Ee(this,"_willShutdown",!1);Ee(this,"phaseWhen",new Map)}get phase(){return this._phase}get willShutdown(){return this._willShutdown}set phase(ee){if(ee<this.phase)throw new Error("Lifecycle cannot go backwards");if(this._phase===ee)return;this._phase=ee;const ne=this.phaseWhen.get(this._phase);ne&&(ne.open(),this.phaseWhen.delete(this._phase))}async when(ee){if(ee<=this._phase)return;let ne=this.phaseWhen.get(ee);ne||(ne=new Barrier,this.phaseWhen.set(ee,ne)),await ne.wait()}}class LogService extends Disposable{constructor(ee){super();Ee(this,"logger");this.logger=ee,this._register(ee.onDidChangeLogLevel(ne=>this.setLevel(ne)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(ee){this.logger.setLevel(ee)}getLevel(){return this.logger.getLevel()}trace(ee,...ne){this.logger.trace(ee,...ne)}debug(ee,...ne){this.logger.debug(ee,...ne)}info(ee,...ne){this.logger.info(ee,...ne)}warn(ee,...ne){this.logger.warn(ee,...ne)}error(ee,...ne){this.logger.error(ee,...ne)}flush(){this.logger.flush()}}const INotificationService=createDecorator$1("notificationService");class NoOpNotification{constructor(){Ee(this,"onDidClose",Event$1.None)}close(){}}var Severity=(ie=>(ie[ie.Verbose=0]="Verbose",ie[ie.Info=1]="Info",ie[ie.Warning=2]="Warning",ie[ie.Error=3]="Error",ie))(Severity||{});(ie=>{const te="error",ee="warning",ne="info",re="verbose";function se(ae){switch(ae){case 3:return te;case 2:return ee;case 1:return ne;default:return re}}ie.toString=se})(Severity||(Severity={}));var NotificationChangeType=(ie=>(ie[ie.ADD=0]="ADD",ie[ie.REMOVE=1]="REMOVE",ie))(NotificationChangeType||{});class NotificationHandle extends Disposable{constructor(ee,ne){super();Ee(this,"_onDidClose",this._register(new Emitter));Ee(this,"onDidClose",this._onDidClose.event);this.item=ee,this.onClose=ne,this.registerListeners()}registerListeners(){Event$1.once(this.item.onDidClose)(()=>{this._onDidClose.fire(),this.dispose()})}close(){this.onClose(this.item),this.dispose()}}const Ll=class Ll extends Disposable{constructor(){super(...arguments);Ee(this,"_onDidChangeNotification",this._register(new Emitter));Ee(this,"onDidChangeNotification",this._onDidChangeNotification.event);Ee(this,"_notifications",[])}get notifications(){return this._notifications}addNotification(ee){const ne=this.createViewItem(ee);if(!ne)return Ll.NO_OP_NOTIFICATION;const re=this.findNotification(ne);return re==null||re.close(),this._notifications.splice(0,0,ne),this._onDidChangeNotification.fire({item:ne,index:0,kind:0}),new NotificationHandle(ne,se=>this.onClose(se))}onClose(ee){const ne=this.findNotification(ee);ne&&ne!==ee?ne.close():ee.close()}findNotification(ee){return this._notifications.find(ne=>ne.equals(ee))}createViewItem(ee){const ne=NotificationViewItem.create(ee);if(ne)return Event$1.once(ne.onDidClose)(()=>{const re=this._notifications.indexOf(ne);re>=0&&(this._notifications.splice(re,1),this._onDidChangeNotification.fire({item:ne,index:re,kind:1}))}),ne}};Ee(Ll,"NO_OP_NOTIFICATION",new NoOpNotification);let NotificationsModel=Ll;const Ya=class Ya extends Disposable{constructor(ee,ne,re){super();Ee(this,"_visible",!1);Ee(this,"_onDidClose",this._register(new Emitter));Ee(this,"onDidClose",this._onDidClose.event);this.id=ee,this._severity=ne,this._message=re}static create(ee){if(!ee||!ee.message||isCancellationError(ee.message))return;let ne;typeof ee.severity=="number"?ne=ee.severity:ne=Severity.Info;const re=Ya.parseNotificationMessage(ee.message);if(re)return new Ya(ee.id,ne,re)}static parseNotificationMessage(ee){let ne;if(ee instanceof Error?ne=toErrorMessage(ee,!1):typeof ee=="string"&&(ne=ee),!ne)return;const re=ne;return ne.length>Ya.MAX_MESSAGE_LENGTH&&(ne=`${ne.substr(0,Ya.MAX_MESSAGE_LENGTH)}...`),ne=ne.replace(/(\r\n|\n|\r)/gm," ").trim(),{raw:re,text:ne,original:ee}}get severity(){return this._severity}get message(){return this._message}get visible(){return this._visible}close(){this._onDidClose.fire(),this.dispose()}equals(ee){return typeof this.id=="string"||typeof ee.id=="string"?this.id===ee.id:this._message.raw===ee.message.raw}};Ee(Ya,"MAX_MESSAGE_LENGTH",1e3);let NotificationViewItem=Ya;class NotificationService extends Disposable{constructor(){super();Ee(this,"model",this._register(new NotificationsModel));Ee(this,"_onDidAddNotification",this._register(new Emitter));Ee(this,"onDidAddNotification",this._onDidAddNotification.event);Ee(this,"_onDidRemoveNotification",this._register(new Emitter));Ee(this,"onDidRemoveNotification",this._onDidRemoveNotification.event);this.registerListeners()}registerListeners(){this._register(this.model.onDidChangeNotification(ee=>{switch(ee.kind){case NotificationChangeType.ADD:case NotificationChangeType.REMOVE:{const ne={message:ee.item.message.original,severity:ee.item.severity};ee.kind===NotificationChangeType.ADD&&this._onDidAddNotification.fire(ne),ee.kind===NotificationChangeType.REMOVE&&this._onDidRemoveNotification.fire(ne);break}}}))}verbose(ee){if(Array.isArray(ee)){for(const ne of ee)this.info(ne);return}this.model.addNotification({severity:Severity.Verbose,message:ee})}info(ee){if(Array.isArray(ee)){for(const ne of ee)this.info(ne);return}this.model.addNotification({severity:Severity.Info,message:ee})}warn(ee){if(Array.isArray(ee)){for(const ne of ee)this.warn(ne);return}this.model.addNotification({severity:Severity.Warning,message:ee})}error(ee){if(Array.isArray(ee)){for(const ne of ee)this.error(ne);return}this.model.addNotification({severity:Severity.Error,message:ee})}notify(ee){return this.model.addNotification(ee)}}const scriptRel="modulepreload",assetsURL=function(ie,te){return new URL(ie,te).href},seen={},__vitePreload=function(te,ee,ne){let re=Promise.resolve();if(ee&&ee.length>0){let ae=function(fe){return Promise.all(fe.map(Ae=>Promise.resolve(Ae).then(pe=>({status:"fulfilled",value:pe}),pe=>({status:"rejected",reason:pe}))))};const le=document.getElementsByTagName("link"),ce=document.querySelector("meta[property=csp-nonce]"),he=(ce==null?void 0:ce.nonce)||(ce==null?void 0:ce.getAttribute("nonce"));re=ae(ee.map(fe=>{if(fe=assetsURL(fe,ne),fe in seen)return;seen[fe]=!0;const Ae=fe.endsWith(".css"),pe=Ae?'[rel="stylesheet"]':"";if(!!ne)for(let Ne=le.length-1;Ne>=0;Ne--){const ze=le[Ne];if(ze.href===fe&&(!Ae||ze.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${fe}"]${pe}`))return;const Fe=document.createElement("link");if(Fe.rel=Ae?"stylesheet":scriptRel,Ae||(Fe.as="script"),Fe.crossOrigin="",Fe.href=fe,he&&Fe.setAttribute("nonce",he),document.head.appendChild(Fe),Ae)return new Promise((Ne,ze)=>{Fe.addEventListener("load",Ne),Fe.addEventListener("error",()=>ze(new Error(`Unable to preload CSS for ${fe}`)))})}))}function se(ae){const le=new Event("vite:preloadError",{cancelable:!0});if(le.payload=ae,window.dispatchEvent(le),!le.defaultPrevented)throw ae}return re.then(ae=>{for(const le of ae||[])le.status==="rejected"&&se(le.reason);return te().catch(se)})};var __INIT__=(()=>{var _scriptName=import.meta.url;return async function(moduleArg={}){var moduleRtn,Module=moduleArg,readyPromiseResolve,readyPromiseReject,readyPromise=new Promise((ie,te)=>{readyPromiseResolve=ie,readyPromiseReject=te}),ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof WorkerGlobalScope<"u",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";if(ENVIRONMENT_IS_NODE){const{createRequire:ie}=await __vitePreload(async()=>{const{createRequire:te}=await Promise.resolve().then(()=>__viteBrowserExternal);return{createRequire:te}},void 0,import.meta.url);var require=ie(import.meta.url)}var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=(ie,te)=>{throw te},scriptDirectory="";function locateFile(ie){return Module.locateFile?Module.locateFile(ie,scriptDirectory):scriptDirectory+ie}var readAsync,readBinary;if(ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");import.meta.url.startsWith("data:")||(scriptDirectory=nodePath.dirname(require("url").fileURLToPath(import.meta.url))+"/"),readBinary=ie=>{ie=isFileURI(ie)?new URL(ie):ie;var te=fs.readFileSync(ie);return te},readAsync=async(ie,te=!0)=>{ie=isFileURI(ie)?new URL(ie):ie;var ee=fs.readFileSync(ie,te?void 0:"utf8");return ee},!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),quit_=(ie,te)=>{throw process.exitCode=ie,te}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:typeof document<"u"&&document.currentScript&&(scriptDirectory=document.currentScript.src),_scriptName&&(scriptDirectory=_scriptName),scriptDirectory.startsWith("blob:")?scriptDirectory="":scriptDirectory=scriptDirectory.slice(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),ENVIRONMENT_IS_WORKER&&(readBinary=ie=>{var te=new XMLHttpRequest;return te.open("GET",ie,!1),te.responseType="arraybuffer",te.send(null),new Uint8Array(te.response)}),readAsync=async ie=>{if(isFileURI(ie))return new Promise((ee,ne)=>{var re=new XMLHttpRequest;re.open("GET",ie,!0),re.responseType="arraybuffer",re.onload=()=>{if(re.status==200||re.status==0&&re.response){ee(re.response);return}ne(re.status)},re.onerror=ne,re.send(null)});var te=await fetch(ie,{credentials:"same-origin"});if(te.ok)return te.arrayBuffer();throw new Error(te.status+" : "+te.url)});Module.print||console.log.bind(console);var err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary=Module.wasmBinary,wasmMemory,ABORT=!1,EXITSTATUS,HEAP8,HEAPU8,HEAP16,HEAP32,HEAPU32,HEAPF32,HEAP64,HEAPF64,runtimeInitialized=!1,isFileURI=ie=>ie.startsWith("file://");function updateMemoryViews(){var ie=wasmMemory.buffer;Module.HEAP8=HEAP8=new Int8Array(ie),Module.HEAP16=HEAP16=new Int16Array(ie),Module.HEAPU8=HEAPU8=new Uint8Array(ie),Module.HEAPU16=new Uint16Array(ie),Module.HEAP32=HEAP32=new Int32Array(ie),Module.HEAPU32=HEAPU32=new Uint32Array(ie),Module.HEAPF32=HEAPF32=new Float32Array(ie),Module.HEAPF64=HEAPF64=new Float64Array(ie),Module.HEAP64=HEAP64=new BigInt64Array(ie),Module.HEAPU64=new BigUint64Array(ie)}if(Module.wasmMemory)wasmMemory=Module.wasmMemory;else{var INITIAL_MEMORY=Module.INITIAL_MEMORY||16777216;wasmMemory=new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:INITIAL_MEMORY/65536})}updateMemoryViews();var __RELOC_FUNCS__=[];function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(onPreRuns)}function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),wasmExports.__wasm_call_ctors(),callRuntimeCallbacks(onPostCtors)}function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(onPostRuns)}var runDependencies=0,dependenciesFulfilled=null;function addRunDependency(ie){var te;runDependencies++,(te=Module.monitorRunDependencies)==null||te.call(Module,runDependencies)}function removeRunDependency(ie){var ee;if(runDependencies--,(ee=Module.monitorRunDependencies)==null||ee.call(Module,runDependencies),runDependencies==0&&dependenciesFulfilled){var te=dependenciesFulfilled;dependenciesFulfilled=null,te()}}function abort(ie){var ee;(ee=Module.onAbort)==null||ee.call(Module,ie),ie="Aborted("+ie+")",err(ie),ABORT=!0,ie+=". Build with -sASSERTIONS for more info.";var te=new WebAssembly.RuntimeError(ie);throw readyPromiseReject(te),te}var wasmBinaryFile;function findWasmBinary(){return Module.locateFile?locateFile("talib.wasm"):new URL(""+new URL("talib-CX0CyGM9.wasm",import.meta.url).href,import.meta.url).href}function getBinarySync(ie){if(ie==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(ie);throw"both async and sync fetching of the wasm failed"}async function getWasmBinary(ie){if(!wasmBinary)try{var te=await readAsync(ie);return new Uint8Array(te)}catch{}return getBinarySync(ie)}async function instantiateArrayBuffer(ie,te){try{var ee=await getWasmBinary(ie),ne=await WebAssembly.instantiate(ee,te);return ne}catch(re){err(`failed to asynchronously prepare wasm: ${re}`),abort(re)}}async function instantiateAsync(ie,te,ee){if(!ie&&typeof WebAssembly.instantiateStreaming=="function"&&!isFileURI(te)&&!ENVIRONMENT_IS_NODE)try{var ne=fetch(te,{credentials:"same-origin"}),re=await WebAssembly.instantiateStreaming(ne,ee);return re}catch(se){err(`wasm streaming compile failed: ${se}`),err("falling back to ArrayBuffer instantiation")}return instantiateArrayBuffer(te,ee)}function getWasmImports(){return{env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)}}async function createWasm(){function ie(se,ae){wasmExports=se.exports,wasmExports=relocateExports(wasmExports,1024);var le=getDylinkMetadata(ae);return le.neededDynlibs&&(dynamicLibraries=le.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports),LDSO.init(),loadDylibs(),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency(),wasmExports}addRunDependency();function te(se){return ie(se.instance,se.module)}var ee=getWasmImports();if(Module.instantiateWasm)return new Promise((se,ae)=>{Module.instantiateWasm(ee,(le,ce)=>{ie(le,ce),se(le.exports)})});wasmBinaryFile??(wasmBinaryFile=findWasmBinary());try{var ne=await instantiateAsync(wasmBinary,wasmBinaryFile,ee),re=te(ne);return re}catch(se){return readyPromiseReject(se),Promise.reject(se)}}class ExitStatus{constructor(te){Ee(this,"name","ExitStatus");this.message=`Program terminated with exit(${te})`,this.status=te}}var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(ie,te){var ee=GOT[te];return ee||(ee=GOT[te]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(te)||(ee.required=!0),ee}},callRuntimeCallbacks=ie=>{for(;ie.length>0;)ie.shift()(Module)},onPostRuns=[],addOnPostRun=ie=>onPostRuns.unshift(ie),onPreRuns=[],addOnPreRun=ie=>onPreRuns.unshift(ie),UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder:void 0,UTF8ArrayToString=(ie,te=0,ee=NaN)=>{for(var ne=te+ee,re=te;ie[re]&&!(re>=ne);)++re;if(re-te>16&&ie.buffer&&UTF8Decoder)return UTF8Decoder.decode(ie.subarray(te,re));for(var se="";te<re;){var ae=ie[te++];if(!(ae&128)){se+=String.fromCharCode(ae);continue}var le=ie[te++]&63;if((ae&224)==192){se+=String.fromCharCode((ae&31)<<6|le);continue}var ce=ie[te++]&63;if((ae&240)==224?ae=(ae&15)<<12|le<<6|ce:ae=(ae&7)<<18|le<<12|ce<<6|ie[te++]&63,ae<65536)se+=String.fromCharCode(ae);else{var he=ae-65536;se+=String.fromCharCode(55296|he>>10,56320|he&1023)}}return se},getDylinkMetadata=ie=>{var te=0,ee=0;function ne(){return ie[te++]}function re(){for(var or=0,Jt=1;;){var rr=ie[te++];if(or+=(rr&127)*Jt,Jt*=128,!(rr&128))break}return or}function se(){var or=re();return te+=or,UTF8ArrayToString(ie,te-or,or)}function ae(or,Jt){if(or)throw new Error(Jt)}var le="dylink.0";if(ie instanceof WebAssembly.Module){var ce=WebAssembly.Module.customSections(ie,le);ce.length===0&&(le="dylink",ce=WebAssembly.Module.customSections(ie,le)),ae(ce.length===0,"need dylink section"),ie=new Uint8Array(ce[0]),ee=ie.length}else{var he=new Uint32Array(new Uint8Array(ie.subarray(0,24)).buffer),fe=he[0]==1836278016;ae(!fe,"need to see wasm magic number"),ae(ie[8]!==0,"need the dylink section to be first"),te=9;var Ae=re();ee=te+Ae,le=se()}var pe={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(le=="dylink"){pe.memorySize=re(),pe.memoryAlign=re(),pe.tableSize=re(),pe.tableAlign=re();for(var Oe=re(),Fe=0;Fe<Oe;++Fe){var Ne=se();pe.neededDynlibs.push(Ne)}}else{ae(le!=="dylink.0");for(var ze=1,He=2,We=3,je=4,Ue=256,Ge=3,Ze=1;te<ee;){var Ye=ne(),qe=re();if(Ye===ze)pe.memorySize=re(),pe.memoryAlign=re(),pe.tableSize=re(),pe.tableAlign=re();else if(Ye===He)for(var Oe=re(),Fe=0;Fe<Oe;++Fe)Ne=se(),pe.neededDynlibs.push(Ne);else if(Ye===We)for(var nr=re();nr--;){var ir=se(),tr=re();tr&Ue&&pe.tlsExports.add(ir)}else if(Ye===je)for(var nr=re();nr--;){se();var ir=se(),tr=re();(tr&Ge)==Ze&&pe.weakImports.add(ir)}else te+=qe}}return pe};function getValue(ie,te="i8"){switch(te.endsWith("*")&&(te="*"),te){case"i1":return HEAP8[ie];case"i8":return HEAP8[ie];case"i16":return HEAP16[ie>>1];case"i32":return HEAP32[ie>>2];case"i64":return HEAP64[ie>>3];case"float":return HEAPF32[ie>>2];case"double":return HEAPF64[ie>>3];case"*":return HEAPU32[ie>>2];default:abort(`invalid type for getValue: ${te}`)}}var newDSO=(ie,te,ee)=>{var ne={refcount:1/0,name:ie,exports:ee,global:!0};return LDSO.loadedLibsByName[ie]=ne,te!=null&&(LDSO.loadedLibsByHandle[te]=ne),ne},LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=70416,alignMemory=(ie,te)=>Math.ceil(ie/te)*te,getMemory=ie=>{if(runtimeInitialized)return _calloc(ie,1);var te=___heap_base,ee=te+alignMemory(ie,16);return ___heap_base=ee,GOT.__heap_base.value=ee,te},isInternalSym=ie=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(ie)||ie.startsWith("__em_js__"),uleb128Encode=(ie,te)=>{ie<128?te.push(ie):te.push(ie%128|128,ie>>7)},sigToWasmTypes=ie=>{for(var te={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},ee={parameters:[],results:ie[0]=="v"?[]:[te[ie[0]]]},ne=1;ne<ie.length;++ne)ee.parameters.push(te[ie[ne]]);return ee},generateFuncType=(ie,te)=>{var ee=ie.slice(0,1),ne=ie.slice(1),re={i:127,p:127,j:126,f:125,d:124,e:111};te.push(96),uleb128Encode(ne.length,te);for(var se=0;se<ne.length;++se)te.push(re[ne[se]]);ee=="v"?te.push(0):te.push(1,re[ee])},convertJsFunctionToWasm=(ie,te)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(te),ie);var ee=[1];generateFuncType(te,ee);var ne=[0,97,115,109,1,0,0,0,1];uleb128Encode(ee.length,ne),ne.push(...ee),ne.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var re=new WebAssembly.Module(new Uint8Array(ne)),se=new WebAssembly.Instance(re,{e:{f:ie}}),ae=se.exports.f;return ae},wasmTable=new WebAssembly.Table({initial:1,element:"anyfunc"}),getWasmTableEntry=ie=>wasmTable.get(ie),updateTableMap=(ie,te)=>{if(functionsInTableMap)for(var ee=ie;ee<ie+te;ee++){var ne=getWasmTableEntry(ee);ne&&functionsInTableMap.set(ne,ee)}},functionsInTableMap,getFunctionAddress=ie=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(ie)||0),freeTableIndexes=[],getEmptyTableSlot=()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(ie){throw ie instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":ie}return wasmTable.length-1},setWasmTableEntry=(ie,te)=>wasmTable.set(ie,te),addFunction=(ie,te)=>{var ee=getFunctionAddress(ie);if(ee)return ee;var ne=getEmptyTableSlot();try{setWasmTableEntry(ne,ie)}catch(se){if(!(se instanceof TypeError))throw se;var re=convertJsFunctionToWasm(ie,te);setWasmTableEntry(ne,re)}return functionsInTableMap.set(ie,ne),ne},updateGOT=(ie,te)=>{for(var ee in ie)if(!isInternalSym(ee)){var ne=ie[ee];GOT[ee]||(GOT[ee]=new WebAssembly.Global({value:"i32",mutable:!0})),GOT[ee].value==0&&(typeof ne=="function"?GOT[ee].value=addFunction(ne):typeof ne=="number"?GOT[ee].value=ne:err(`unhandled export type for '${ee}': ${typeof ne}`))}},relocateExports=(ie,te,ee)=>{var ne={};for(var re in ie){var se=ie[re];typeof se=="object"&&(se=se.value),typeof se=="number"&&(se+=te),ne[re]=se}return updateGOT(ne),ne},isSymbolDefined=ie=>{var te=wasmImports[ie];return!(!te||te.stub)},dynCall=(ie,te,ee=[])=>{var ne=getWasmTableEntry(te)(...ee);return ne},stackSave=()=>_emscripten_stack_get_current(),stackRestore=ie=>__emscripten_stack_restore(ie),createInvokeFunction=ie=>(te,...ee)=>{var ne=stackSave();try{return dynCall(ie,te,ee)}catch(re){if(stackRestore(ne),re!==re+0)throw re;if(_setThrew(1,0),ie[0]=="j")return 0n}},resolveGlobalSymbol=(ie,te=!1)=>{var ee;return isSymbolDefined(ie)?ee=wasmImports[ie]:ie.startsWith("invoke_")&&(ee=wasmImports[ie]=createInvokeFunction(ie.split("_")[1])),{sym:ee,name:ie}},onPostCtors=[],addOnPostCtor=ie=>onPostCtors.unshift(ie),UTF8ToString=(ie,te)=>ie?UTF8ArrayToString(HEAPU8,ie,te):"",loadWebAssemblyModule=(binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);currentModuleWeakSymbols=metadata.weakImports;function loadModule(){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0,tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length;tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var moduleExports;function resolveSymbol(ie){var te=resolveGlobalSymbol(ie).sym;return!te&&localScope&&(te=localScope[ie]),te||(te=moduleExports[ie]),te}var proxyHandler={get(ie,te){switch(te){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(te in wasmImports&&!wasmImports[te].stub){var ee=wasmImports[te];return ee}if(!(te in ie)){var ne;ie[te]=(...re)=>(ne||(ne=resolveSymbol(te)),ne(...re))}return ie[te]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols();function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;eval(func)}if("__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void"){cSig=cSig.split(",");for(var i in cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():addOnPostCtor(init)),moduleExports}if(flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(ie=>postInstantiation(ie.module,ie.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return flags.loadAsync?metadata.neededDynlibs.reduce((ie,te)=>ie.then(()=>loadDynamicLibrary(te,flags,localScope)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(ie=>loadDynamicLibrary(ie,flags,localScope)),loadModule())},mergeLibSymbols=(ie,te)=>{for(var[ee,ne]of Object.entries(ie)){const re=ae=>{isSymbolDefined(ae)||(wasmImports[ae]=ne)};re(ee);const se="__main_argc_argv";ee=="main"&&re(se),ee==se&&re("main")}},asyncLoad=async ie=>{var te=await readAsync(ie);return new Uint8Array(te)},preloadPlugins=Module.preloadPlugins||[],registerWasmPlugin=()=>{var ie={promiseChainEnd:Promise.resolve(),canHandle:te=>!Module.noWasmDecoding&&te.endsWith(".so"),handle:(te,ee,ne,re)=>{ie.promiseChainEnd=ie.promiseChainEnd.then(()=>loadWebAssemblyModule(te,{loadAsync:!0,nodelete:!0},ee,{})).then(se=>{preloadedWasm[ee]=se,ne(te)},se=>{err(`failed to instantiate wasm: ${ee}: ${se}`),re()})}};preloadPlugins.push(ie)},preloadedWasm={};function loadDynamicLibrary(ie,te={global:!0,nodelete:!0},ee,ne){var re=LDSO.loadedLibsByName[ie];if(re)return te.global?re.global||(re.global=!0,mergeLibSymbols(re.exports)):ee&&Object.assign(ee,re.exports),te.nodelete&&re.refcount!==1/0&&(re.refcount=1/0),re.refcount++,te.loadAsync?Promise.resolve(!0):!0;re=newDSO(ie,ne,"loading"),re.refcount=te.nodelete?1/0:1,re.global=te.global;function se(){var ce=locateFile(ie);if(te.loadAsync)return asyncLoad(ce);if(!readBinary)throw new Error(`${ce}: file not found, and synchronous loading of external files is not available`);return readBinary(ce)}function ae(){var ce=preloadedWasm[ie];return ce?te.loadAsync?Promise.resolve(ce):ce:te.loadAsync?se().then(he=>loadWebAssemblyModule(he,te,ie,ee)):loadWebAssemblyModule(se(),te,ie,ee)}function le(ce){re.global?mergeLibSymbols(ce):ee&&Object.assign(ee,ce),re.exports=ce}return te.loadAsync?ae().then(ce=>(le(ce),!0)):(le(ae()),!0)}var reportUndefinedSymbols=()=>{for(var[ie,te]of Object.entries(GOT))if(te.value==0){var ee=resolveGlobalSymbol(ie,!0).sym;if(!ee&&!te.required)continue;if(typeof ee=="function")te.value=addFunction(ee,ee.sig);else if(typeof ee=="number")te.value=ee;else throw new Error(`bad export type for '${ie}': ${typeof ee}`)}},loadDylibs=()=>{if(!dynamicLibraries.length){reportUndefinedSymbols();return}addRunDependency(),dynamicLibraries.reduce((ie,te)=>ie.then(()=>loadDynamicLibrary(te,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency()})};Module.noExitRuntime;function setValue(ie,te,ee="i8"){switch(ee.endsWith("*")&&(ee="*"),ee){case"i1":HEAP8[ie]=te;break;case"i8":HEAP8[ie]=te;break;case"i16":HEAP16[ie>>1]=te;break;case"i32":HEAP32[ie>>2]=te;break;case"i64":HEAP64[ie>>3]=BigInt(te);break;case"float":HEAPF32[ie>>2]=te;break;case"double":HEAPF64[ie>>3]=te;break;case"*":HEAPU32[ie>>2]=te;break;default:abort(`invalid type for setValue: ${ee}`)}}var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},70416);new WebAssembly.Global({value:"i32",mutable:!1},1);var abortOnCannotGrowMemory=ie=>{abort("OOM")},_emscripten_resize_heap=ie=>{HEAPU8.length,abortOnCannotGrowMemory()};_emscripten_resize_heap.sig="ip";var _proc_exit=ie=>{EXITSTATUS=ie,quit_(ie,new ExitStatus(ie))};_proc_exit.sig="vi";var exitJS=(ie,te)=>{EXITSTATUS=ie,_proc_exit(ie)},handleException=ie=>{if(ie instanceof ExitStatus||ie=="unwind")return EXITSTATUS;quit_(1,ie)},lengthBytesUTF8=ie=>{for(var te=0,ee=0;ee<ie.length;++ee){var ne=ie.charCodeAt(ee);ne<=127?te++:ne<=2047?te+=2:ne>=55296&&ne<=57343?(te+=4,++ee):te+=3}return te},stringToUTF8Array=(ie,te,ee,ne)=>{if(!(ne>0))return 0;for(var re=ee,se=ee+ne-1,ae=0;ae<ie.length;++ae){var le=ie.charCodeAt(ae);if(le>=55296&&le<=57343){var ce=ie.charCodeAt(++ae);le=65536+((le&1023)<<10)|ce&1023}if(le<=127){if(ee>=se)break;te[ee++]=le}else if(le<=2047){if(ee+1>=se)break;te[ee++]=192|le>>6,te[ee++]=128|le&63}else if(le<=65535){if(ee+2>=se)break;te[ee++]=224|le>>12,te[ee++]=128|le>>6&63,te[ee++]=128|le&63}else{if(ee+3>=se)break;te[ee++]=240|le>>18,te[ee++]=128|le>>12&63,te[ee++]=128|le>>6&63,te[ee++]=128|le&63}}return te[ee]=0,ee-re},stringToUTF8=(ie,te,ee)=>stringToUTF8Array(ie,HEAPU8,te,ee),stackAlloc=ie=>__emscripten_stack_alloc(ie),stringToUTF8OnStack=ie=>{var te=lengthBytesUTF8(ie)+1,ee=stackAlloc(te);return stringToUTF8(ie,ee,te),ee},getCFunc=ie=>{var te=Module["_"+ie];return te},writeArrayToMemory=(ie,te)=>{HEAP8.set(ie,te)},ccall=(ie,te,ee,ne,re)=>{var se={string:Fe=>{var Ne=0;return Fe!=null&&Fe!==0&&(Ne=stringToUTF8OnStack(Fe)),Ne},array:Fe=>{var Ne=stackAlloc(Fe.length);return writeArrayToMemory(Fe,Ne),Ne}};function ae(Fe){return te==="string"?UTF8ToString(Fe):te==="boolean"?!!Fe:Fe}var le=getCFunc(ie),ce=[],he=0;if(ne)for(var fe=0;fe<ne.length;fe++){var Ae=se[ee[fe]];Ae?(he===0&&(he=stackSave()),ce[fe]=Ae(ne[fe])):ce[fe]=ne[fe]}var pe=le(...ce);function Oe(Fe){return he!==0&&stackRestore(he),ae(Fe)}return pe=Oe(pe),pe};registerWasmPlugin();var wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,emscripten_resize_heap:_emscripten_resize_heap,memory:wasmMemory},wasmExports=await createWasm();wasmExports.__wasm_call_ctors,Module._TA_ACCBANDS=wasmExports.TA_ACCBANDS,Module._malloc=wasmExports.malloc,Module._free=wasmExports.free,Module._TA_SMA=wasmExports.TA_SMA,Module._TA_AD=wasmExports.TA_AD,Module._TA_ADOSC=wasmExports.TA_ADOSC,Module._TA_ADX=wasmExports.TA_ADX,Module._TA_ADXR=wasmExports.TA_ADXR,Module._TA_APO=wasmExports.TA_APO,Module._TA_MA=wasmExports.TA_MA,Module._TA_AROON=wasmExports.TA_AROON,Module._TA_AROONOSC=wasmExports.TA_AROONOSC,Module._TA_ATR=wasmExports.TA_ATR,Module._TA_TRANGE=wasmExports.TA_TRANGE,Module._TA_AVGDEV=wasmExports.TA_AVGDEV,Module._TA_AVGPRICE=wasmExports.TA_AVGPRICE,Module._TA_BBANDS=wasmExports.TA_BBANDS,Module._TA_STDDEV=wasmExports.TA_STDDEV,Module._TA_BOP=wasmExports.TA_BOP,Module._TA_CCI=wasmExports.TA_CCI,Module._TA_CMO=wasmExports.TA_CMO,Module._TA_DEMA=wasmExports.TA_DEMA,Module._TA_DX=wasmExports.TA_DX,Module._TA_EMA=wasmExports.TA_EMA,Module._TA_HT_DCPERIOD=wasmExports.TA_HT_DCPERIOD,Module._TA_HT_DCPHASE=wasmExports.TA_HT_DCPHASE,Module._TA_HT_PHASOR=wasmExports.TA_HT_PHASOR,Module._TA_HT_SINE=wasmExports.TA_HT_SINE,Module._TA_HT_TRENDLINE=wasmExports.TA_HT_TRENDLINE,Module._TA_HT_TRENDMODE=wasmExports.TA_HT_TRENDMODE,Module._TA_IMI=wasmExports.TA_IMI,Module._TA_KAMA=wasmExports.TA_KAMA,Module._TA_WMA=wasmExports.TA_WMA,Module._TA_TEMA=wasmExports.TA_TEMA,Module._TA_TRIMA=wasmExports.TA_TRIMA,Module._TA_MAMA=wasmExports.TA_MAMA,Module._TA_T3=wasmExports.TA_T3,Module._TA_MACD=wasmExports.TA_MACD,Module._TA_MACDEXT=wasmExports.TA_MACDEXT,Module._TA_MACDFIX=wasmExports.TA_MACDFIX,Module._TA_MAVP=wasmExports.TA_MAVP,Module._TA_MEDPRICE=wasmExports.TA_MEDPRICE,Module._TA_MFI=wasmExports.TA_MFI,Module._TA_MIDPOINT=wasmExports.TA_MIDPOINT,Module._TA_MIDPRICE=wasmExports.TA_MIDPRICE,Module._TA_MINUS_DI=wasmExports.TA_MINUS_DI,Module._TA_MINUS_DM=wasmExports.TA_MINUS_DM,Module._TA_MOM=wasmExports.TA_MOM,Module._TA_OBV=wasmExports.TA_OBV,Module._TA_PLUS_DI=wasmExports.TA_PLUS_DI,Module._TA_PLUS_DM=wasmExports.TA_PLUS_DM,Module._TA_PPO=wasmExports.TA_PPO,Module._TA_ROC=wasmExports.TA_ROC,Module._TA_ROCP=wasmExports.TA_ROCP,Module._TA_ROCR=wasmExports.TA_ROCR,Module._TA_ROCR100=wasmExports.TA_ROCR100,Module._TA_RSI=wasmExports.TA_RSI,Module._TA_SAR=wasmExports.TA_SAR,Module._TA_SAREXT=wasmExports.TA_SAREXT,Module._TA_STOCH=wasmExports.TA_STOCH,Module._TA_STOCHF=wasmExports.TA_STOCHF,Module._TA_STOCHRSI=wasmExports.TA_STOCHRSI,Module._TA_TRIX=wasmExports.TA_TRIX,Module._TA_TSF=wasmExports.TA_TSF,Module._TA_TYPPRICE=wasmExports.TA_TYPPRICE,Module._TA_ULTOSC=wasmExports.TA_ULTOSC,Module._TA_VAR=wasmExports.TA_VAR,Module._TA_WCLPRICE=wasmExports.TA_WCLPRICE,Module._TA_WILLR=wasmExports.TA_WILLR;var _calloc=wasmExports.calloc,_setThrew=wasmExports.setThrew,__emscripten_stack_restore=wasmExports._emscripten_stack_restore,__emscripten_stack_alloc=wasmExports._emscripten_stack_alloc,_emscripten_stack_get_current=wasmExports.emscripten_stack_get_current;wasmExports.__wasm_apply_data_relocs,Module.ccall=ccall,Module.setValue=setValue,Module.getValue=getValue;function callMain(ie=[]){var te=resolveGlobalSymbol("main").sym;if(te){ie.unshift(thisProgram);var ee=ie.length,ne=stackAlloc((ee+1)*4),re=ne;ie.forEach(ae=>{HEAPU32[re>>2]=stringToUTF8OnStack(ae),re+=4}),HEAPU32[re>>2]=0;try{var se=te(ee,ne);return exitJS(se,!0),se}catch(ae){return handleException(ae)}}}function run(ie=arguments_){if(runDependencies>0){dependenciesFulfilled=run;return}if(preRun(),runDependencies>0){dependenciesFulfilled=run;return}function te(){var ne;if(Module.calledRun=!0,!ABORT){initRuntime(),readyPromiseResolve(Module),(ne=Module.onRuntimeInitialized)==null||ne.call(Module);var ee=Module.noInitialRun;ee||callMain(ie),postRun()}}Module.setStatus?(Module.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>Module.setStatus(""),1),te()},1)):te()}if(Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();return run(),moduleRtn=readyPromise,moduleRtn}})();const API={ACCBANDS:{name:"ACCBANDS",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:20,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"upperBand",type:"Double[]",plotHint:"limit_upper"},{name:"middleBand",type:"Double[]",plotHint:"line"},{name:"lowerBand",type:"Double[]",plotHint:"limit_lower"}]},AD:{name:"AD",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"},{name:"volume",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ADOSC:{name:"ADOSC",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"},{name:"volume",type:"Double[]"}],options:[{name:"fastPeriod",displayName:"Fast Period",defaultValue:3,hint:"Number of period for the fast MA",type:"Integer",range:{min:2,max:1e5}},{name:"slowPeriod",displayName:"Slow Period",defaultValue:10,hint:"Number of period for the slow MA",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ADX:{name:"ADX",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ADXR:{name:"ADXR",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},APO:{name:"APO",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"fastPeriod",displayName:"Fast Period",defaultValue:12,hint:"Number of period for the fast MA",type:"Integer",range:{min:2,max:1e5}},{name:"slowPeriod",displayName:"Slow Period",defaultValue:26,hint:"Number of period for the slow MA",type:"Integer",range:{min:2,max:1e5}},{name:"MAType",displayName:"MA Type",defaultValue:0,hint:"Type of Moving Average",type:"MAType"}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},AROON:{name:"AROON",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"aroonDown",type:"Double[]",plotHint:"line_dash"},{name:"aroonUp",type:"Double[]",plotHint:"line"}]},AROONOSC:{name:"AROONOSC",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ATR:{name:"ATR",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},AVGDEV:{name:"AVGDEV",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},AVGPRICE:{name:"AVGPRICE",inputs:[{name:"open",type:"Double[]"},{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},BBANDS:{name:"BBANDS",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:5,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}},{name:"nbDevUp",displayName:"Deviations up",defaultValue:2,hint:"Deviation multiplier for upper band",type:"Double",range:{min:-3e37,max:3e37}},{name:"nbDevDn",displayName:"Deviations down",defaultValue:2,hint:"Deviation multiplier for lower band",type:"Double",range:{min:-3e37,max:3e37}},{name:"MAType",displayName:"MA Type",defaultValue:0,hint:"Type of Moving Average",type:"MAType"}],outputs:[{name:"upperBand",type:"Double[]",plotHint:"limit_upper"},{name:"middleBand",type:"Double[]",plotHint:"line"},{name:"lowerBand",type:"Double[]",plotHint:"limit_lower"}]},BOP:{name:"BOP",inputs:[{name:"open",type:"Double[]"},{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},CCI:{name:"CCI",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},CMO:{name:"CMO",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},DEMA:{name:"DEMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},DX:{name:"DX",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},EMA:{name:"EMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},HT_DCPERIOD:{name:"HT_DCPERIOD",inputs:[{name:"inReal",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},HT_DCPHASE:{name:"HT_DCPHASE",inputs:[{name:"inReal",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},HT_PHASOR:{name:"HT_PHASOR",inputs:[{name:"inReal",type:"Double[]"}],options:[],outputs:[{name:"inPhase",type:"Double[]",plotHint:"line"},{name:"quadrature",type:"Double[]",plotHint:"line_dash"}]},HT_SINE:{name:"HT_SINE",inputs:[{name:"inReal",type:"Double[]"}],options:[],outputs:[{name:"sine",type:"Double[]",plotHint:"line"},{name:"leadSine",type:"Double[]",plotHint:"line_dash"}]},HT_TRENDLINE:{name:"HT_TRENDLINE",inputs:[{name:"inReal",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},HT_TRENDMODE:{name:"HT_TRENDMODE",inputs:[{name:"inReal",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Integer[]",plotHint:"line"}]},IMI:{name:"IMI",inputs:[{name:"open",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},KAMA:{name:"KAMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MA:{name:"MA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}},{name:"MAType",displayName:"MA Type",defaultValue:0,hint:"Type of Moving Average",type:"MAType"}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MACD:{name:"MACD",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"fastPeriod",displayName:"Fast Period",defaultValue:12,hint:"Number of period for the fast MA",type:"Integer",range:{min:2,max:1e5}},{name:"slowPeriod",displayName:"Slow Period",defaultValue:26,hint:"Number of period for the slow MA",type:"Integer",range:{min:2,max:1e5}},{name:"signalPeriod",displayName:"Signal Period",defaultValue:9,hint:"Smoothing for the signal line (nb of period)",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"MACD",type:"Double[]",plotHint:"line"},{name:"MACDSignal",type:"Double[]",plotHint:"line_dash"},{name:"MACDHist",type:"Double[]",plotHint:"histogram"}]},MACDEXT:{name:"MACDEXT",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"fastPeriod",displayName:"Fast Period",defaultValue:12,hint:"Number of period for the fast MA",type:"Integer",range:{min:2,max:1e5}},{name:"fastMAType",displayName:"Fast MA",defaultValue:0,hint:"Type of Moving Average for fast MA",type:"MAType"},{name:"slowPeriod",displayName:"Slow Period",defaultValue:26,hint:"Number of period for the slow MA",type:"Integer",range:{min:2,max:1e5}},{name:"slowMAType",displayName:"Slow MA",defaultValue:0,hint:"Type of Moving Average for slow MA",type:"MAType"},{name:"signalPeriod",displayName:"Signal Period",defaultValue:9,hint:"Smoothing for the signal line (nb of period)",type:"Integer",range:{min:1,max:1e5}},{name:"signalMAType",displayName:"Signal MA",defaultValue:0,hint:"Type of Moving Average for signal line",type:"MAType"}],outputs:[{name:"MACD",type:"Double[]",plotHint:"line"},{name:"MACDSignal",type:"Double[]",plotHint:"line_dash"},{name:"MACDHist",type:"Double[]",plotHint:"histogram"}]},MACDFIX:{name:"MACDFIX",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"signalPeriod",displayName:"Signal Period",defaultValue:9,hint:"Smoothing for the signal line (nb of period)",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"MACD",type:"Double[]",plotHint:"line"},{name:"MACDSignal",type:"Double[]",plotHint:"line_dash"},{name:"MACDHist",type:"Double[]",plotHint:"histogram"}]},MAMA:{name:"MAMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"fastLimit",displayName:"Fast Limit",defaultValue:.5,hint:"Upper limit use in the adaptive algorithm",type:"Double",range:{min:.01,max:.99}},{name:"slowLimit",displayName:"Slow Limit",defaultValue:.05,hint:"Lower limit use in the adaptive algorithm",type:"Double",range:{min:.01,max:.99}}],outputs:[{name:"MAMA",type:"Double[]",plotHint:"line"},{name:"FAMA",type:"Double[]",plotHint:"line_dash"}]},MAVP:{name:"MAVP",inputs:[{name:"inReal",type:"Double[]"},{name:"inPeriods",type:"Double[]"}],options:[{name:"minPeriod",displayName:"Minimum Period",defaultValue:2,hint:"Value less than minimum will be changed to Minimum period",type:"Integer",range:{min:2,max:1e5}},{name:"maxPeriod",displayName:"Maximum Period",defaultValue:30,hint:"Value higher than maximum will be changed to Maximum period",type:"Integer",range:{min:2,max:1e5}},{name:"MAType",displayName:"MA Type",defaultValue:0,hint:"Type of Moving Average",type:"MAType"}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MEDPRICE:{name:"MEDPRICE",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MFI:{name:"MFI",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"},{name:"volume",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MIDPOINT:{name:"MIDPOINT",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MIDPRICE:{name:"MIDPRICE",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MINUS_DI:{name:"MINUS_DI",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MINUS_DM:{name:"MINUS_DM",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},MOM:{name:"MOM",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:10,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},OBV:{name:"OBV",inputs:[{name:"inReal",type:"Double[]"},{name:"volume",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},PLUS_DI:{name:"PLUS_DI",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},PLUS_DM:{name:"PLUS_DM",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},PPO:{name:"PPO",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"fastPeriod",displayName:"Fast Period",defaultValue:12,hint:"Number of period for the fast MA",type:"Integer",range:{min:2,max:1e5}},{name:"slowPeriod",displayName:"Slow Period",defaultValue:26,hint:"Number of period for the slow MA",type:"Integer",range:{min:2,max:1e5}},{name:"MAType",displayName:"MA Type",defaultValue:0,hint:"Type of Moving Average",type:"MAType"}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ROC:{name:"ROC",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:10,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ROCP:{name:"ROCP",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:10,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ROCR:{name:"ROCR",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:10,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ROCR100:{name:"ROCR100",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:10,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},RSI:{name:"RSI",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},SAR:{name:"SAR",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"acceleration",displayName:"Acceleration Factor",defaultValue:.02,hint:"Acceleration Factor used up to the Maximum value",type:"Double",range:{min:0,max:3e37}},{name:"maximum",displayName:"AF Maximum",defaultValue:.2,hint:"Acceleration Factor Maximum value",type:"Double",range:{min:0,max:3e37}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},SAREXT:{name:"SAREXT",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"}],options:[{name:"startValue",displayName:"Start Value",defaultValue:0,hint:"Start value and direction. 0 for Auto, >0 for Long, <0 for Short",type:"Double",range:{min:-3e37,max:3e37}},{name:"offsetOnReverse",displayName:"Offset on Reverse",defaultValue:0,hint:"Percent offset added/removed to initial stop on short/long reversal",type:"Double",range:{min:0,max:3e37}},{name:"accelerationInitLong",displayName:"AF Init Long",defaultValue:.02,hint:"Acceleration Factor initial value for the Long direction",type:"Double",range:{min:0,max:3e37}},{name:"accelerationLong",displayName:"AF Long",defaultValue:.02,hint:"Acceleration Factor for the Long direction",type:"Double",range:{min:0,max:3e37}},{name:"accelerationMaxLong",displayName:"AF Max Long",defaultValue:.2,hint:"Acceleration Factor maximum value for the Long direction",type:"Double",range:{min:0,max:3e37}},{name:"accelerationInitShort",displayName:"AF Init Short",defaultValue:.02,hint:"Acceleration Factor initial value for the Short direction",type:"Double",range:{min:0,max:3e37}},{name:"accelerationShort",displayName:"AF Short",defaultValue:.02,hint:"Acceleration Factor for the Short direction",type:"Double",range:{min:0,max:3e37}},{name:"accelerationMaxShort",displayName:"AF Max Short",defaultValue:.2,hint:"Acceleration Factor maximum value for the Short direction",type:"Double",range:{min:0,max:3e37}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},SMA:{name:"SMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},STDDEV:{name:"STDDEV",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:5,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}},{name:"nbDev",displayName:"Deviations",defaultValue:1,hint:"Nb of deviations",type:"Double",range:{min:-3e37,max:3e37}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},STOCH:{name:"STOCH",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"fastK_Period",displayName:"Fast-K Period",defaultValue:5,hint:"Time period for building the Fast-K line",type:"Integer",range:{min:1,max:1e5}},{name:"slowK_Period",displayName:"Slow-K Period",defaultValue:3,hint:"Smoothing for making the Slow-K line. Usually set to 3",type:"Integer",range:{min:1,max:1e5}},{name:"slowK_MAType",displayName:"Slow-K MA",defaultValue:0,hint:"Type of Moving Average for Slow-K",type:"MAType"},{name:"slowD_Period",displayName:"Slow-D Period",defaultValue:3,hint:"Smoothing for making the Slow-D line",type:"Integer",range:{min:1,max:1e5}},{name:"slowD_MAType",displayName:"Slow-D MA",defaultValue:0,hint:"Type of Moving Average for Slow-D",type:"MAType"}],outputs:[{name:"slowK",type:"Double[]",plotHint:"line_dash"},{name:"slowD",type:"Double[]",plotHint:"line_dash"}]},STOCHF:{name:"STOCHF",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"fastK_Period",displayName:"Fast-K Period",defaultValue:5,hint:"Time period for building the Fast-K line",type:"Integer",range:{min:1,max:1e5}},{name:"fastD_Period",displayName:"Fast-D Period",defaultValue:3,hint:"Smoothing for making the Fast-D line. Usually set to 3",type:"Integer",range:{min:1,max:1e5}},{name:"fastD_MAType",displayName:"Fast-D MA",defaultValue:0,hint:"Type of Moving Average for Fast-D",type:"MAType"}],outputs:[{name:"fastK",type:"Double[]",plotHint:"line"},{name:"fastD",type:"Double[]",plotHint:"line"}]},STOCHRSI:{name:"STOCHRSI",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}},{name:"fastK_Period",displayName:"Fast-K Period",defaultValue:5,hint:"Time period for building the Fast-K line",type:"Integer",range:{min:1,max:1e5}},{name:"fastD_Period",displayName:"Fast-D Period",defaultValue:3,hint:"Smoothing for making the Fast-D line. Usually set to 3",type:"Integer",range:{min:1,max:1e5}},{name:"fastD_MAType",displayName:"Fast-D MA",defaultValue:0,hint:"Type of Moving Average for Fast-D",type:"MAType"}],outputs:[{name:"fastK",type:"Double[]",plotHint:"line"},{name:"fastD",type:"Double[]",plotHint:"line"}]},T3:{name:"T3",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:5,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}},{name:"VFactor",displayName:"Volume Factor",defaultValue:.7,hint:"Volume Factor",type:"Double",range:{min:0,max:1}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},TEMA:{name:"TEMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},TRANGE:{name:"TRANGE",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},TRIMA:{name:"TRIMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},TRIX:{name:"TRIX",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},TSF:{name:"TSF",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},TYPPRICE:{name:"TYPPRICE",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},ULTOSC:{name:"ULTOSC",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod1",displayName:"First Period",defaultValue:7,hint:"Number of bars for 1st period.",type:"Integer",range:{min:1,max:1e5}},{name:"timePeriod2",displayName:"Second Period",defaultValue:14,hint:"Number of bars fro 2nd period",type:"Integer",range:{min:1,max:1e5}},{name:"timePeriod3",displayName:"Third Period",defaultValue:28,hint:"Number of bars for 3rd period",type:"Integer",range:{min:1,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},VAR:{name:"VAR",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:5,hint:"Number of period",type:"Integer",range:{min:1,max:1e5}},{name:"nbDev",displayName:"Deviations",defaultValue:1,hint:"Nb of deviations",type:"Double",range:{min:-3e37,max:3e37}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},WCLPRICE:{name:"WCLPRICE",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},WILLR:{name:"WILLR",inputs:[{name:"high",type:"Double[]"},{name:"low",type:"Double[]"},{name:"close",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:14,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]},WMA:{name:"WMA",inputs:[{name:"inReal",type:"Double[]"}],options:[{name:"timePeriod",displayName:"Time Period",defaultValue:30,hint:"Number of period",type:"Integer",range:{min:2,max:1e5}}],outputs:[{name:"output",type:"Double[]",plotHint:"line"}]}};let Module;function double_array(ie){const ee=Module._malloc(ie*8),ne=ee/8;return Module.HEAPF64.set(new Float64Array(ie),ne),{data:Module.HEAPF64.subarray(ne,ne+ie),pointer:ee}}function c_pointer(ie,te){const ee=Module._malloc(4),ne={get data(){return Module.getValue(ee,ie)},set data(re){Module.setValue(ee,re,ie)},pointer:ee};return ne.data=te,ne}const TA_RET_CODE={0:"TA_SUCCESS",1:"TA_LIB_NOT_INITIALIZE",2:"TA_BAD_PARAM",3:"TA_ALLOC_ERR",4:"TA_GROUP_NOT_FOUND",5:"TA_FUNC_NOT_FOUND",6:"TA_INVALID_HANDLE",7:"TA_INVALID_PARAM_HOLDER",8:"TA_INVALID_PARAM_HOLDER_TYPE",9:"TA_INVALID_PARAM_FUNCTION",10:"TA_INPUT_NOT_ALL_INITIALIZE",11:"TA_OUTPUT_NOT_ALL_INITIALIZE",12:"TA_OUT_OF_RANGE_START_INDEX",13:"TA_OUT_OF_RANGE_END_INDEX",14:"TA_INVALID_LIST_TYPE",15:"TA_BAD_OBJECT",16:"TA_NOT_SUPPORTED",5e3:"TA_INTERNAL_ERROR",65535:"TA_UNKNOWN_ERR"},TA_INTEGER_DEFAULT=-2147483648;function callFunc(ie,te){const ee=`TA_${ie.name}`;if(!Module)throw Error(`${ie.name}() called before initialization.`);const ne=2+ie.inputs.length+ie.options.length+2+ie.outputs.length,re=new Array(ne).fill("number");for(const{name:We}of ie.inputs)if(!Array.isArray(te[We]))throw te[We]===void 0?Error(`Bad Param: "${We}" is required`):Error(`Bad Param: "${We}" should be array of number`);for(const{name:We,range:je}of ie.options)if(te[We]===void 0)te[We]=TA_INTEGER_DEFAULT;else if(je&&(te[We]<je.min||te[We]>je.max))throw Error(`Bad Param: "${We}" out of range (min: ${je.min}, max: ${je.max})`);let{startIdx:se,endIdx:ae}=te;se===void 0&&(se=0);const le=ie.inputs.map(({name:We})=>te[We].length);let ce=Math.min(...le);ae===void 0&&(ae=ce-1);const he=[se,ae],fe=[];ie.inputs.forEach(({name:We})=>{const je=double_array(ae+1-se),Ue=te[We];for(const Ge in Ue)je.data[Ge]=Ue[Ge];fe.push(je.pointer),he.push(je.pointer)}),ie.options.forEach(({name:We})=>he.push(te[We]));const Ae=c_pointer("i32",0),pe=c_pointer("i32",0);fe.push(Ae.pointer),fe.push(pe.pointer),he.push(Ae.pointer),he.push(pe.pointer);const Oe=ie.outputs.map(({name:We})=>{const je=double_array(ae+1-se);return fe.push(je.pointer),he.push(je.pointer),{name:We,array:je}}),Fe=Module.ccall(ee,"number",re,he),Ne=Ae.data,ze=pe.data,He=Oe.reduce((We,je)=>{const Ue=Array.from(je.array.data.slice(0,ze));return We[je.name]=Ue,We},{outBegIdx:Ne,outNBElement:ze});if(fe.forEach(We=>Module._free(We)),Fe===0)return He;throw Error("[C_ERROR] "+TA_RET_CODE[Fe])}var MAType;(function(ie){ie[ie.SMA=0]="SMA",ie[ie.EMA=1]="EMA",ie[ie.WMA=2]="WMA",ie[ie.DEMA=3]="DEMA",ie[ie.TEMA=4]="TEMA",ie[ie.TRIMA=5]="TRIMA",ie[ie.KAMA=6]="KAMA",ie[ie.MAMA=7]="MAMA",ie[ie.T3=8]="T3"})(MAType||(MAType={}));function init(ie){return Module?Promise.resolve(Module):ie&&typeof ie!="string"?Promise.reject(new Error('Invalid argument, "init(wasmBinaryFilePath)" expects a string that specifies the location of wasm binary file')):__INIT__({locateFile:ie?()=>ie:void 0}).then(ee=>Module=ee).catch(ee=>{let ne="TA-Lib WASM runtime init fail.";throw ee&&ee.message?ne+=`
Error: 
`+ee.message:ne+="Unknown reason. Perhaps you specify the wrong file path to wasm binary?",new Error(ne)})}let __ACCBANDS_API__=API.ACCBANDS;function ACCBANDS(ie){return callFunc(__ACCBANDS_API__,ie)}const accBands=ACCBANDS;let __AD_API__=API.AD;function AD(ie){return callFunc(__AD_API__,ie)}const ad=AD;let __ADOSC_API__=API.ADOSC;function ADOSC(ie){return callFunc(__ADOSC_API__,ie)}const adOsc=ADOSC;let __ADX_API__=API.ADX;function ADX(ie){return callFunc(__ADX_API__,ie)}const adx=ADX;let __ADXR_API__=API.ADXR;function ADXR(ie){return callFunc(__ADXR_API__,ie)}const adxr=ADXR;let __APO_API__=API.APO;function APO(ie){return callFunc(__APO_API__,ie)}const apo=APO;let __AROON_API__=API.AROON;function AROON(ie){return callFunc(__AROON_API__,ie)}const aroon=AROON;let __AROONOSC_API__=API.AROONOSC;function AROONOSC(ie){return callFunc(__AROONOSC_API__,ie)}const aroonOsc=AROONOSC;let __ATR_API__=API.ATR;function ATR(ie){return callFunc(__ATR_API__,ie)}const atr=ATR;let __AVGDEV_API__=API.AVGDEV;function AVGDEV(ie){return callFunc(__AVGDEV_API__,ie)}const avgDev=AVGDEV;let __AVGPRICE_API__=API.AVGPRICE;function AVGPRICE(ie){return callFunc(__AVGPRICE_API__,ie)}const avgPrice=AVGPRICE;let __BBANDS_API__=API.BBANDS;function BBANDS(ie){return callFunc(__BBANDS_API__,ie)}const bbands=BBANDS;let __BOP_API__=API.BOP;function BOP(ie){return callFunc(__BOP_API__,ie)}const bop=BOP;let __CCI_API__=API.CCI;function CCI(ie){return callFunc(__CCI_API__,ie)}const cci=CCI;let __CMO_API__=API.CMO;function CMO(ie){return callFunc(__CMO_API__,ie)}const cmo=CMO;let __DEMA_API__=API.DEMA;function DEMA(ie){return callFunc(__DEMA_API__,ie)}const dema=DEMA;let __DX_API__=API.DX;function DX(ie){return callFunc(__DX_API__,ie)}const dx=DX;let __EMA_API__=API.EMA;function EMA(ie){return callFunc(__EMA_API__,ie)}const ema=EMA;let __HT_DCPERIOD_API__=API.HT_DCPERIOD;function HT_DCPERIOD(ie){return callFunc(__HT_DCPERIOD_API__,ie)}const htDcPeriod=HT_DCPERIOD;let __HT_DCPHASE_API__=API.HT_DCPHASE;function HT_DCPHASE(ie){return callFunc(__HT_DCPHASE_API__,ie)}const htDcPhase=HT_DCPHASE;let __HT_PHASOR_API__=API.HT_PHASOR;function HT_PHASOR(ie){return callFunc(__HT_PHASOR_API__,ie)}const htPhasor=HT_PHASOR;let __HT_SINE_API__=API.HT_SINE;function HT_SINE(ie){return callFunc(__HT_SINE_API__,ie)}const htSine=HT_SINE;let __HT_TRENDLINE_API__=API.HT_TRENDLINE;function HT_TRENDLINE(ie){return callFunc(__HT_TRENDLINE_API__,ie)}const htTrendline=HT_TRENDLINE;let __HT_TRENDMODE_API__=API.HT_TRENDMODE;function HT_TRENDMODE(ie){return callFunc(__HT_TRENDMODE_API__,ie)}const htTrendMode=HT_TRENDMODE;let __IMI_API__=API.IMI;function IMI(ie){return callFunc(__IMI_API__,ie)}const imi=IMI;let __KAMA_API__=API.KAMA;function KAMA(ie){return callFunc(__KAMA_API__,ie)}const kama=KAMA;let __MA_API__=API.MA;function MA(ie){return callFunc(__MA_API__,ie)}const movingAverage=MA;let __MACD_API__=API.MACD;function MACD(ie){return callFunc(__MACD_API__,ie)}const macd=MACD;let __MACDEXT_API__=API.MACDEXT;function MACDEXT(ie){return callFunc(__MACDEXT_API__,ie)}const macdExt=MACDEXT;let __MACDFIX_API__=API.MACDFIX;function MACDFIX(ie){return callFunc(__MACDFIX_API__,ie)}const macdFix=MACDFIX;let __MAMA_API__=API.MAMA;function MAMA(ie){return callFunc(__MAMA_API__,ie)}const mama=MAMA;let __MAVP_API__=API.MAVP;function MAVP(ie){return callFunc(__MAVP_API__,ie)}const movingAverageVariablePeriod=MAVP;let __MEDPRICE_API__=API.MEDPRICE;function MEDPRICE(ie){return callFunc(__MEDPRICE_API__,ie)}const medPrice=MEDPRICE;let __MFI_API__=API.MFI;function MFI(ie){return callFunc(__MFI_API__,ie)}const mfi=MFI;let __MIDPOINT_API__=API.MIDPOINT;function MIDPOINT(ie){return callFunc(__MIDPOINT_API__,ie)}const midPoint$1=MIDPOINT;let __MIDPRICE_API__=API.MIDPRICE;function MIDPRICE(ie){return callFunc(__MIDPRICE_API__,ie)}const midPrice=MIDPRICE;let __MINUS_DI_API__=API.MINUS_DI;function MINUS_DI(ie){return callFunc(__MINUS_DI_API__,ie)}const minusDI=MINUS_DI;let __MINUS_DM_API__=API.MINUS_DM;function MINUS_DM(ie){return callFunc(__MINUS_DM_API__,ie)}const minusDM=MINUS_DM;let __MOM_API__=API.MOM;function MOM(ie){return callFunc(__MOM_API__,ie)}const mom=MOM;let __OBV_API__=API.OBV;function OBV(ie){return callFunc(__OBV_API__,ie)}const obv=OBV;let __PLUS_DI_API__=API.PLUS_DI;function PLUS_DI(ie){return callFunc(__PLUS_DI_API__,ie)}const plusDI=PLUS_DI;let __PLUS_DM_API__=API.PLUS_DM;function PLUS_DM(ie){return callFunc(__PLUS_DM_API__,ie)}const plusDM=PLUS_DM;let __PPO_API__=API.PPO;function PPO(ie){return callFunc(__PPO_API__,ie)}const ppo=PPO;let __ROC_API__=API.ROC;function ROC(ie){return callFunc(__ROC_API__,ie)}const roc=ROC;let __ROCP_API__=API.ROCP;function ROCP(ie){return callFunc(__ROCP_API__,ie)}const rocP=ROCP;let __ROCR_API__=API.ROCR;function ROCR(ie){return callFunc(__ROCR_API__,ie)}const rocR=ROCR;let __ROCR100_API__=API.ROCR100;function ROCR100(ie){return callFunc(__ROCR100_API__,ie)}const rocR100=ROCR100;let __RSI_API__=API.RSI;function RSI(ie){return callFunc(__RSI_API__,ie)}const rsi=RSI;let __SAR_API__=API.SAR;function SAR(ie){return callFunc(__SAR_API__,ie)}const sar=SAR;let __SAREXT_API__=API.SAREXT;function SAREXT(ie){return callFunc(__SAREXT_API__,ie)}const sarExt=SAREXT;let __SMA_API__=API.SMA;function SMA(ie){return callFunc(__SMA_API__,ie)}const sma=SMA;let __STDDEV_API__=API.STDDEV;function STDDEV(ie){return callFunc(__STDDEV_API__,ie)}const stdDev=STDDEV;let __STOCH_API__=API.STOCH;function STOCH(ie){return callFunc(__STOCH_API__,ie)}const stoch=STOCH;let __STOCHF_API__=API.STOCHF;function STOCHF(ie){return callFunc(__STOCHF_API__,ie)}const stochF=STOCHF;let __STOCHRSI_API__=API.STOCHRSI;function STOCHRSI(ie){return callFunc(__STOCHRSI_API__,ie)}const stochRsi=STOCHRSI;let __T3_API__=API.T3;function T3(ie){return callFunc(__T3_API__,ie)}const t3=T3;let __TEMA_API__=API.TEMA;function TEMA(ie){return callFunc(__TEMA_API__,ie)}const tema=TEMA;let __TRANGE_API__=API.TRANGE;function TRANGE(ie){return callFunc(__TRANGE_API__,ie)}const trueRange=TRANGE;let __TRIMA_API__=API.TRIMA;function TRIMA(ie){return callFunc(__TRIMA_API__,ie)}const trima=TRIMA;let __TRIX_API__=API.TRIX;function TRIX(ie){return callFunc(__TRIX_API__,ie)}const trix=TRIX;let __TSF_API__=API.TSF;function TSF(ie){return callFunc(__TSF_API__,ie)}const tsf=TSF;let __TYPPRICE_API__=API.TYPPRICE;function TYPPRICE(ie){return callFunc(__TYPPRICE_API__,ie)}const typPrice=TYPPRICE;let __ULTOSC_API__=API.ULTOSC;function ULTOSC(ie){return callFunc(__ULTOSC_API__,ie)}const ultOsc=ULTOSC;let __VAR_API__=API.VAR;function VAR(ie){return callFunc(__VAR_API__,ie)}const variance$1=VAR;let __WCLPRICE_API__=API.WCLPRICE;function WCLPRICE(ie){return callFunc(__WCLPRICE_API__,ie)}const wclPrice=WCLPRICE;let __WILLR_API__=API.WILLR;function WILLR(ie){return callFunc(__WILLR_API__,ie)}const willR=WILLR;let __WMA_API__=API.WMA;function WMA(ie){return callFunc(__WMA_API__,ie)}const wma=WMA,TA=Object.freeze(Object.defineProperty({__proto__:null,ACCBANDS,AD,ADOSC,ADX,ADXR,APO,AROON,AROONOSC,ATR,AVGDEV,AVGPRICE,BBANDS,BOP,CCI,CMO,DEMA,DX,EMA,HT_DCPERIOD,HT_DCPHASE,HT_PHASOR,HT_SINE,HT_TRENDLINE,HT_TRENDMODE,IMI,KAMA,MA,MACD,MACDEXT,MACDFIX,MAMA,get MAType(){return MAType},MAVP,MEDPRICE,MFI,MIDPOINT,MIDPRICE,MINUS_DI,MINUS_DM,MOM,OBV,PLUS_DI,PLUS_DM,PPO,ROC,ROCP,ROCR,ROCR100,RSI,SAR,SAREXT,SMA,STDDEV,STOCH,STOCHF,STOCHRSI,T3,TEMA,TRANGE,TRIMA,TRIX,TSF,TYPPRICE,ULTOSC,VAR,WCLPRICE,WILLR,WMA,accBands,ad,adOsc,adx,adxr,apo,aroon,aroonOsc,atr,avgDev,avgPrice,bbands,bop,cci,cmo,dema,dx,ema,htDcPeriod,htDcPhase,htPhasor,htSine,htTrendMode,htTrendline,imi,init,kama,macd,macdExt,macdFix,mama,medPrice,mfi,midPoint:midPoint$1,midPrice,minusDI,minusDM,mom,movingAverage,movingAverageVariablePeriod,obv,plusDI,plusDM,ppo,roc,rocP,rocR,rocR100,rsi,sar,sarExt,sma,stdDev,stoch,stochF,stochRsi,t3,tema,trima,trix,trueRange,tsf,typPrice,ultOsc,variance:variance$1,wclPrice,willR,wma},Symbol.toStringTag,{value:"Module"})),wasmUrl=""+new URL("talib-CX0CyGM9.wasm",import.meta.url).href;class StudyService{constructor(){Ee(this,"_serviceBrand");Ee(this,"_inited",!1)}async init(){if(!this._inited)return await init(wasmUrl),Promise.resolve(void 0)}}function toPX(ie){return isFiniteNumber(ie)?`${ie}px`:""}const ChartFontFamily="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function getFont(ie){if(isFiniteNumber(ie))return`${toPX(ie)} ${ChartFontFamily}`;let te="";return ie.fontWeight!==void 0&&(te=`${te} `),`${te}${toPX(ie.fontSize)} ${ChartFontFamily}`}function createStyleSheet(ie=document.head,te,ee){const ne=document.createElement("style");return ne.type="text/css",ne.media="screen",te==null||te(ne),ie.appendChild(ne),ne}const NAMED_COLORS={red:"#ff0000",green:"#008000",blue:"#0000ff",white:"#ffffff",black:"#000000",yellow:"#ffff00",cyan:"#00ffff"};function clampInt(ie,te,ee){return isNaN(te)||te<ie?ie:te>ee?ee:Math.round(te)}function clampFloat(ie,te,ee){return isNaN(te)||te<ie?ie:te>ee?ee:Math.round(te*1e4)/1e4}function clamp255(ie){return clampInt(0,ie,255)}function normalizeAlphaComponent(ie){return clampFloat(0,ie,1)}const rgbParser={re:/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,parse:ie=>[clamp255(parseInt(ie[1],10)),clamp255(parseInt(ie[2],10)),clamp255(parseInt(ie[3],10))]},rgbaParser={re:/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/,parse:ie=>[clamp255(parseInt(ie[1],10)),clamp255(parseInt(ie[2],10)),clamp255(parseInt(ie[3],10)),normalizeAlphaComponent(parseFloat(ie[4]))]},hexParser={re:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,parse:ie=>[parseInt(ie[1],16),parseInt(ie[2],16),parseInt(ie[3],16)]},shortHexParser={re:/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,parse:ie=>[parseInt(ie[1]+ie[1],16),parseInt(ie[2]+ie[2],16),parseInt(ie[3]+ie[3],16)]};function tryParsers(ie,te){for(const ee of ie){const ne=ee.re.exec(te);if(ne)return ee.parse(ne)}return null}function tryParseRgba(ie){var te,ee;if(ie=ie.toLowerCase().trim(),ie in NAMED_COLORS){const ne=NAMED_COLORS[ie],re=tryParsers([hexParser],ne);return re?[...re,1]:null}return((te=tryParsers([rgbParser],ie))==null?void 0:te.concat(1))||((ee=tryParsers([hexParser,shortHexParser],ie))==null?void 0:ee.concat(1))||tryParsers([rgbaParser],ie)||null}function parseRgba(ie){const te=tryParseRgba(ie);if(!te)throw new Error("Invalid color format: "+ie);return te}function parseRgb(ie){const te=parseRgba(ie);return[te[0],te[1],te[2]]}function rgba(...ie){if(Array.isArray(ie[0])){const[te,ee,ne]=ie[0],re=normalizeAlphaComponent(ie[1]);return[te,ee,ne,re]}else{const[te,ee,ne,re=1]=ie;return[clamp255(te),clamp255(ee),clamp255(ne),normalizeAlphaComponent(re)]}}function rgbaToString(ie){const[te,ee,ne,re]=ie;return`rgba(${te}, ${ee}, ${ne}, ${re})`}function generateColor(ie,te,ee){const ne=typeof te=="number"?te:0;if(!isHexColor(ie)){const ce=parseRgb(ie),he=normalizeAlphaComponent(transparencyToAlpha(ne));return ee?rgbaToString(rgba(ce,he)):ie}const[re,se,ae]=parseRgb(ie),le=normalizeAlphaComponent(transparencyToAlpha(ne));return rgbaToString([re,se,ae,le])}function transparencyToAlpha(ie){if(ie<0||ie>100)throw new Error("invalid transparency");return 1-ie/100}function gradientColorAtPercent(ie,te,ee){const[ne,re,se,ae]=parseRgba(ie),[le,ce,he,fe]=parseRgba(te),Ae=rgba(Math.round(ne+ee*(le-ne)),Math.round(re+ee*(ce-re)),Math.round(se+ee*(he-se)),ae+ee*(fe-ae));return rgbaToString(Ae)}function roundFloat(ie,te){const ee=Math.pow(10,te);return Math.round(ie*ee)/ee}class RGBA{constructor(te,ee,ne,re=1){Ee(this,"_rgbaBrand");Ee(this,"r");Ee(this,"g");Ee(this,"b");Ee(this,"a");this.r=Math.min(255,Math.max(0,te))|0,this.g=Math.min(255,Math.max(0,ee))|0,this.b=Math.min(255,Math.max(0,ne))|0,this.a=roundFloat(Math.max(Math.min(1,re),0),3)}static equals(te,ee){return te.r===ee.r&&te.g===ee.g&&te.b===ee.b&&te.a===ee.a}}class HSLA{constructor(te,ee,ne,re){Ee(this,"_hslaBrand");Ee(this,"h");Ee(this,"s");Ee(this,"l");Ee(this,"a");this.h=Math.max(Math.min(360,te),0)|0,this.s=roundFloat(Math.max(Math.min(1,ee),0),3),this.l=roundFloat(Math.max(Math.min(1,ne),0),3),this.a=roundFloat(Math.max(Math.min(1,re),0),3)}static equals(te,ee){return te.h===ee.h&&te.s===ee.s&&te.l===ee.l&&te.a===ee.a}static fromRGBA(te){const ee=te.r/255,ne=te.g/255,re=te.b/255,se=te.a,ae=Math.max(ee,ne,re),le=Math.min(ee,ne,re);let ce=0,he=0;const fe=(le+ae)/2,Ae=ae-le;if(Ae>0){switch(he=Math.min(fe<=.5?Ae/(2*fe):Ae/(2-2*fe),1),ae){case ee:ce=(ne-re)/Ae+(ne<re?6:0);break;case ne:ce=(re-ee)/Ae+2;break;case re:ce=(ee-ne)/Ae+4;break}ce*=60,ce=Math.round(ce)}return new HSLA(ce,he,fe,se)}static _hue2rgb(te,ee,ne){return ne<0&&(ne+=1),ne>1&&(ne-=1),ne<1/6?te+(ee-te)*6*ne:ne<1/2?ee:ne<2/3?te+(ee-te)*(2/3-ne)*6:te}static toRGBA(te){const ee=te.h/360,{s:ne,l:re,a:se}=te;let ae,le,ce;if(ne===0)ae=le=ce=re;else{const he=re<.5?re*(1+ne):re+ne-re*ne,fe=2*re-he;ae=HSLA._hue2rgb(fe,he,ee+1/3),le=HSLA._hue2rgb(fe,he,ee),ce=HSLA._hue2rgb(fe,he,ee-1/3)}return new RGBA(Math.round(ae*255),Math.round(le*255),Math.round(ce*255),se)}}class HSVA{constructor(te,ee,ne,re){Ee(this,"_hsvaBrand");Ee(this,"h");Ee(this,"s");Ee(this,"v");Ee(this,"a");this.h=Math.max(Math.min(360,te),0)|0,this.s=roundFloat(Math.max(Math.min(1,ee),0),3),this.v=roundFloat(Math.max(Math.min(1,ne),0),3),this.a=roundFloat(Math.max(Math.min(1,re),0),3)}static equals(te,ee){return te.h===ee.h&&te.s===ee.s&&te.v===ee.v&&te.a===ee.a}static fromRGBA(te){const ee=te.r/255,ne=te.g/255,re=te.b/255,se=Math.max(ee,ne,re),ae=Math.min(ee,ne,re),le=se-ae,ce=se===0?0:le/se;let he;return le===0?he=0:se===ee?he=((ne-re)/le%6+6)%6:se===ne?he=(re-ee)/le+2:he=(ee-ne)/le+4,new HSVA(Math.round(he*60),ce,se,te.a)}static toRGBA(te){const{h:ee,s:ne,v:re,a:se}=te,ae=re*ne,le=ae*(1-Math.abs(ee/60%2-1)),ce=re-ae;let[he,fe,Ae]=[0,0,0];return ee<60?(he=ae,fe=le):ee<120?(he=le,fe=ae):ee<180?(fe=ae,Ae=le):ee<240?(fe=le,Ae=ae):ee<300?(he=le,Ae=ae):ee<=360&&(he=ae,Ae=le),he=Math.round((he+ce)*255),fe=Math.round((fe+ce)*255),Ae=Math.round((Ae+ce)*255),new RGBA(he,fe,Ae,se)}}const Ta=class Ta{constructor(te){Ee(this,"rgba");Ee(this,"_hsla");Ee(this,"_hsva");Ee(this,"_toString");if(te)if(te instanceof RGBA)this.rgba=te;else if(te instanceof HSLA)this._hsla=te,this.rgba=HSLA.toRGBA(te);else if(te instanceof HSVA)this._hsva=te,this.rgba=HSVA.toRGBA(te);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}static fromHex(te){return Ta.Format.CSS.parseHex(te)||Ta.white}static equals(te,ee){return!te&&!ee?!0:!te||!ee?!1:te.equals(ee)}get hsla(){return this._hsla?this._hsla:HSLA.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:HSVA.fromRGBA(this.rgba)}equals(te){return!!te&&RGBA.equals(this.rgba,te.rgba)&&HSLA.equals(this.hsla,te.hsla)&&HSVA.equals(this.hsva,te.hsva)}isOpaque(){return this.rgba.a===1}toString(){return this._toString||(this._toString=Ta.Format.CSS.format(this)),this._toString}};Ee(Ta,"white",new Ta(new RGBA(255,255,255,1))),Ee(Ta,"transparent",new Ta(new RGBA(0,0,0,0)));let Color=Ta;function _toTwoDigitHex(ie){const te=ie.toString(16);return te.length!==2?"0"+te:te}function _parseHexDigit(ie){switch(ie){case CharCode.Digit0:return 0;case CharCode.Digit1:return 1;case CharCode.Digit2:return 2;case CharCode.Digit3:return 3;case CharCode.Digit4:return 4;case CharCode.Digit5:return 5;case CharCode.Digit6:return 6;case CharCode.Digit7:return 7;case CharCode.Digit8:return 8;case CharCode.Digit9:return 9;case CharCode.a:return 10;case CharCode.A:return 10;case CharCode.b:return 11;case CharCode.B:return 11;case CharCode.c:return 12;case CharCode.C:return 12;case CharCode.d:return 13;case CharCode.D:return 13;case CharCode.e:return 14;case CharCode.E:return 14;case CharCode.f:return 15;case CharCode.F:return 15}return 0}(ie=>{(te=>{(ee=>{function ne(pe){return pe.rgba.a===1?`rgb(${pe.rgba.r}, ${pe.rgba.g}, ${pe.rgba.b})`:ie.Format.CSS.formatRGBA(pe)}ee.formatRGB=ne;function re(pe){return`rgba(${pe.rgba.r}, ${pe.rgba.g}, ${pe.rgba.b}, ${+pe.rgba.a.toFixed(2)})`}ee.formatRGBA=re;function se(pe){return pe.hsla.a===1?`hsl(${pe.hsla.h}, ${(pe.hsla.s*100).toFixed(2)}%, ${(pe.hsla.l*100).toFixed(2)}%)`:ie.Format.CSS.formatHSLA(pe)}ee.formatHSL=se;function ae(pe){return`hsla(${pe.hsla.h}, ${(pe.hsla.s*100).toFixed(2)}%, ${(pe.hsla.l*100).toFixed(2)}%, ${pe.hsla.a.toFixed(2)})`}ee.formatHSLA=ae;function le(pe){return`#${_toTwoDigitHex(pe.rgba.r)}${_toTwoDigitHex(pe.rgba.g)}${_toTwoDigitHex(pe.rgba.b)}`}ee.formatHex=le;function ce(pe,Oe=!1){return Oe&&pe.rgba.a===1?ie.Format.CSS.formatHex(pe):`#${_toTwoDigitHex(pe.rgba.r)}${_toTwoDigitHex(pe.rgba.g)}${_toTwoDigitHex(pe.rgba.b)}${_toTwoDigitHex(Math.round(pe.rgba.a*255))}`}ee.formatHexA=ce;function he(pe){return pe.isOpaque()?ie.Format.CSS.formatHex(pe):ie.Format.CSS.formatRGBA(pe)}ee.format=he;function fe(pe){var Oe,Fe,Ne,ze,He,We,je;if(pe==="transparent")return ie.transparent;if(pe.startsWith("#"))return Ae(pe);if(pe.startsWith("rgba(")){const Ue=pe.match(/rgba\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+), *(?<a>(?:\+|-)?\d+(\.\d+)?)\)/);if(!Ue)throw new Error("Invalid color format "+pe);const Ge=parseInt(((Oe=Ue.groups)==null?void 0:Oe.r)??"0"),Ze=parseInt(((Fe=Ue.groups)==null?void 0:Fe.g)??"0"),Ye=parseInt(((Ne=Ue.groups)==null?void 0:Ne.b)??"0"),qe=parseFloat(((ze=Ue.groups)==null?void 0:ze.a)??"0");return new ie(new RGBA(Ge,Ze,Ye,qe))}if(pe.startsWith("rgb(")){const Ue=pe.match(/rgb\((?<r>(?:\+|-)?\d+), *(?<g>(?:\+|-)?\d+), *(?<b>(?:\+|-)?\d+)\)/);if(!Ue)throw new Error("Invalid color format "+pe);const Ge=parseInt(((He=Ue.groups)==null?void 0:He.r)??"0"),Ze=parseInt(((We=Ue.groups)==null?void 0:We.g)??"0"),Ye=parseInt(((je=Ue.groups)==null?void 0:je.b)??"0");return new ie(new RGBA(Ge,Ze,Ye))}return NOTIMPLEMENTED("named key is not supported")}ee.parse=fe;function Ae(pe){const Oe=pe.length;if(Oe===0||pe.charCodeAt(0)!==CharCode.Hash)return null;if(Oe===7){const Fe=16*_parseHexDigit(pe.charCodeAt(1))+_parseHexDigit(pe.charCodeAt(2)),Ne=16*_parseHexDigit(pe.charCodeAt(3))+_parseHexDigit(pe.charCodeAt(4)),ze=16*_parseHexDigit(pe.charCodeAt(5))+_parseHexDigit(pe.charCodeAt(6));return new ie(new RGBA(Fe,Ne,ze,1))}if(Oe===9){const Fe=16*_parseHexDigit(pe.charCodeAt(1))+_parseHexDigit(pe.charCodeAt(2)),Ne=16*_parseHexDigit(pe.charCodeAt(3))+_parseHexDigit(pe.charCodeAt(4)),ze=16*_parseHexDigit(pe.charCodeAt(5))+_parseHexDigit(pe.charCodeAt(6)),He=16*_parseHexDigit(pe.charCodeAt(7))+_parseHexDigit(pe.charCodeAt(8));return new ie(new RGBA(Fe,Ne,ze,He/255))}if(Oe===4){const Fe=_parseHexDigit(pe.charCodeAt(1)),Ne=_parseHexDigit(pe.charCodeAt(2)),ze=_parseHexDigit(pe.charCodeAt(3));return new ie(new RGBA(16*Fe+Fe,16*Ne+Ne,16*ze+ze))}if(Oe===5){const Fe=_parseHexDigit(pe.charCodeAt(1)),Ne=_parseHexDigit(pe.charCodeAt(2)),ze=_parseHexDigit(pe.charCodeAt(3)),He=_parseHexDigit(pe.charCodeAt(4));return new ie(new RGBA(16*Fe+Fe,16*Ne+Ne,16*ze+ze,(16*He+He)/255))}return null}ee.parseHex=Ae})(te.CSS||(te.CSS={}))})(ie.Format||(ie.Format={}))})(Color||(Color={}));function resetTransparency(ie){if(ie==="transparent")return ie;if(isHexColor(ie))return ie.slice(0,7);const te=parseRgb(ie),ee=normalizeAlphaComponent(1),ne=rgba(te,ee);return rgbaToString(ne)}function isHexColor(ie){return ie.indexOf("#")===0}class ColorRegistry{constructor(){Ee(this,"colorsById",Object.create(null))}registerColor(te,ee){const ne={id:te,defaults:ee};return should(!this.colorsById[te]),this.colorsById[te]=ne,te}getColors(){return Object.keys(this.colorsById).map(te=>this.colorsById[te])}resolveDefaultColor(te,ee){const ne=this.colorsById[te];if(ne!=null&&ne.defaults){const re=isColorDefaults(ne.defaults)?ne.defaults[ee.type]:ne.defaults;return resolveColorValue(re,ee)}}}const colorRegistry=new ColorRegistry;function registerColor(ie,te){return colorRegistry.registerColor(ie,te)}function isColorDefaults(ie){return ie!==null&&typeof ie=="object"&&"light"in ie&&"dark"in ie}function resolveColorValue(ie,te){if(ie!==null)return typeof ie=="string"?ie[0]==="#"?Color.fromHex(ie):te.getColor(ie):ie instanceof Color?ie:NOTREACHED()}function asCssVariableName(ie){return`--cl-${ie.replace(/\./g,"-")}`}const lighColors={"global.background":"#EBEBEB",foreground:"#0F0F0FFF",background:"#fff",selectedForeground:"#2962ff","negative.foreground":"#fff","negative.background":"#2962ff","negative.hoverBackground":"#1E53E5FF","gutter.background":"#EBEBEBFF","button.foreground":"#0F0F0FFF","button.background":"#fff","button.hoverBackground":"#f2f2f2","button.primary.foreground":"#fff","button.primary.background":"#1A1A1AFF","button.secondary.foreground":"#1A1A1AFF","button.secondary.background":"#fff","button.secondary.border":"#1A1A1AFF","button.secondary.hoverForeground":"#fff","button.secondary.hoverBackground":"#1A1A1AFF","tooltip.foreground":"#fff","tooltip.background":"#2E2E2E","scroll.foreground":"#fff","scroll.background":"#1e222d99","dialog.shadow":"#00000033","dialog.background":"#fff","scrollbarThumb.background":"#9c9c9c","listTitle.foreground":"#808080FF","listItem.foreground":"#0F0F0FFF","listItem.background":"#fff","listItem.hoverBackground":"#f2f2f2","listItem.selectedForeground":"#fff","listItem.selectedBackground":"#2E2E2EFF","listItem.disabledForeground":"#C8C8C8FF","listKeybinding.foreground":"#808080FF","input.foreground":"#131722FF","inputPlaceholder.foreground":"#a3a6af","legendLoader.foreground":"#707070FF","legend.background":"#FFFFFF7F","legend.hoverBackground":"#FFFFFF","legend.hoverBorder":"#dbdbdb","handle.foreground":"#b8b8b8","toast.verbose.foreground":"#1A1A1AFF","toast.verbose.background":"#ffffff","toast.verbose.border":"#089981FF","toast.info.foreground":"#fff","toast.info.background":"#2962ff"},darkColors$1={"global.background":"#303030",foreground:"#DBDBDBFF",background:"#1A1A1AFF",selectedForeground:"#2962ff","negative.foreground":"#DBDBDBFF","negative.background":"#2962FFFF","negative.hoverBackground":"#1E53E5FF","gutter.background":"#4A4A4AFF","button.foreground":"#DBDBDBFF","button.background":"#1A1A1AFF","button.hoverBackground":"#303030FF","button.primary.foreground":"#1A1A1AFF","button.primary.background":"#FFFFFFFF","button.secondary.foreground":"#FFFFFFFF","button.secondary.background":"#00000000","button.secondary.border":"#FFF","button.secondary.hoverForeground":"#1A1A1AFF","button.secondary.hoverBackground":"#F2F2F2FF","tooltip.foreground":"#F0F0F0","tooltip.background":"#3D3D3D","scroll.foreground":"#fff","scroll.background":"#3d3d3d","dialog.shadow":"#00000066","dialog.background":"#262626","scrollbarThumb.background":"#9c9c9c","listTitle.foreground":"#808080FF","listItem.foreground":"#DBDBDBFF","listItem.background":"#262626","listItem.hoverBackground":"#303030FF","listItem.selectedForeground":"#000000FF","listItem.selectedBackground":"#F2F2F2FF","listItem.disabledForeground":"#C8C8C8FF","listKeybinding.foreground":"#8C8C8CFF","input.foreground":"#A8A8A8FF","inputPlaceholder.foreground":"#8c8c8c","legendLoader.foreground":"#8c8c8c","legend.background":"#1A1A1A","legend.hoverBackground":"#303030","legend.hoverBorder":"#3D3D3D","handle.foreground":"#575757","toast.verbose.foreground":"#DBDBDB","toast.verbose.background":"#262626","toast.verbose.border":"#089981","toast.info.foreground":"#fff","toast.info.background":"#2962FFFF"},clLight={base:"light",inherit:!1,colors:lighColors},clDark={base:"dark",inherit:!1,colors:darkColors$1};keys(clLight.colors).forEach(ie=>{registerColor(ie,{light:clLight.colors[ie],dark:clDark.colors[ie]})});class ThemeService extends Disposable{constructor(ee="light"){super();Ee(this,"_serviceBrand");Ee(this,"_knownThemes");Ee(this,"_onDidColorThemeChange",this._register(new Emitter));Ee(this,"onDidColorThemeChange",this._onDidColorThemeChange.event);Ee(this,"_themeCSS","");Ee(this,"_theme");Ee(this,"_styleElement");this._knownThemes=new Map,this._knownThemes.set("light",newBuiltInTheme("light")),this._knownThemes.set("dark",newBuiltInTheme("dark")),this._styleElement=createStyleSheet(void 0,ne=>{ne.className="chartles-colors",ne.textContent=this._themeCSS}),this._register(toDisposable(()=>{this._styleElement.remove()})),this.setTheme(ee)}setTheme(ee){const ne=this._knownThemes.get(ee)??ensure(this._knownThemes.get("light"));this._updateActualTheme(ne)}defineTheme(ee,ne){if(!/^[a-z0-9-]+$/i.test(ee))throw new Error("Illegal theme name!");if(!isBuiltinTheme(ne.base)&&!isBuiltinTheme(ee))throw new Error("Illegal theme base!");this._knownThemes.set(ee,new ColorTheme(ee,ne)),isBuiltinTheme(ee)&&this._knownThemes.forEach(re=>{re.base===ee&&re.notifyBaseUpdated()}),this._theme.themeName===ee&&this.setTheme(ee)}getColorTheme(){return this._theme}isDark(){return this.getColorTheme().type===ColorScheme.DARK}_updateActualTheme(ee){!ee||this._theme===ee||(this._theme=ee,this._updateTheme())}_updateTheme(){const ee=[],ne={},re={addRule:ae=>{ne[ae]||(ee.push(ae),ne[ae]=!0)}},se=[];for(const ae of colorRegistry.getColors()){const le=this._theme.getColor(ae.id,!0);le&&se.push(`${asCssVariableName(ae.id)}: ${le.toString()};`)}re.addRule(`:root { ${se.join(`
`)} }`),this._themeCSS=ee.join(`
`),this._updateCSS(),this._onDidColorThemeChange.fire(this._theme)}_updateCSS(){this._styleElement.textContent=this._themeCSS}}class ColorTheme{constructor(te,ee){Ee(this,"id");Ee(this,"themeName");Ee(this,"themeData");Ee(this,"colors");Ee(this,"defaultColors");this.themeData=ee;const ne=ee.base;te.length>0?(isBuiltinTheme(te)?this.id=te:this.id=ne+" "+te,this.themeName=te):(this.id=ne,this.themeName=ne),this.colors=null,this.defaultColors=Object.create(null)}get base(){return this.themeData.base}get type(){return this.base==="light"?ColorScheme.LIGHT:ColorScheme.DARK}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null)}getColors(){if(!this.colors){const te=new Map;for(const ee in this.themeData.colors)te.set(ee,Color.fromHex(this.themeData.colors[ee]));if(this.themeData.inherit){const ee=getBuiltinRules(this.themeData.base);for(const ne in ee.colors)te.has(ne)||te.set(ne,Color.fromHex(ee.colors[ne]))}this.colors=te}return this.colors}getColor(te,ee){const ne=this.getColors().get(te);if(ne)return ne;if(ee!==!1)return this.getDefault(te)}getDefault(te){let ee=this.defaultColors[te];return ee||(ee=colorRegistry.resolveDefaultColor(te,this),this.defaultColors[te]=ee,ee)}}function isBuiltinTheme(ie){return ie==="light"||ie==="dark"}function getBuiltinRules(ie){return ie==="light"?clLight:clDark}function newBuiltInTheme(ie){const te=getBuiltinRules(ie);return new ColorTheme(ie,te)}var __getOwnPropDesc$e=Object.getOwnPropertyDescriptor,__decorateClass$e=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$e(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$c=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let ToolRegistry=class extends GenericRegistry{constructor(ie,te){super(),this.keybindingsRegistry=ie,this.commandRegistry=te}registerTool(ie){this.add(ie);const te=(ee,...ne)=>{var se,ae;const re=ee.get(IToolService);re.switchTool(ie.id),ne.length&&((ae=(se=re.activeTool)==null?void 0:se.receivePresetProps)==null||ae.call(se,...ne))};return ie.keybinding?this.keybindingsRegistry.registerCommandAndKeybindingRule({id:ie.id,primary:ie.keybinding,weight:KeybindingWeight.ChartContrib,handler:te}):this.commandRegistry.registerCommand({id:ie.id,handler:te})}};ToolRegistry=__decorateClass$e([__decorateParam$c(0,IKeybindingsRegistry),__decorateParam$c(1,ICommandRegistry)],ToolRegistry);var __getOwnPropDesc$d=Object.getOwnPropertyDescriptor,__decorateClass$d=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$d(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$b=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let ToolService=class extends Disposable{constructor(te,ee,ne){super();Ee(this,"_activeTool");Ee(this,"_past",[]);Ee(this,"_onDidChangeTool",this._register(new Emitter));Ee(this,"onDidChangeTool",this._onDidChangeTool.event);Ee(this,"store");Ee(this,"_toolScope");this._instantiationService=te,this._chartManagementService=ee,this._toolRegistry=ne,this.store=writable({activeType:void 0,keepDrawingMode:!1,magnetMode:MagnetMode.Normal,tempMagnetMode:void 0})}dispose(){var te;super.dispose(),Reflect.set(this,"store",null),(te=this._activeTool)==null||te.deactivate(),this._activeTool=void 0}_getValue(te){return get$1(this.store)[te]}_setValue(te,ee){this.store.update(ne=>(ne[te]=ee,ne))}get activeTool(){return this._activeTool}switchTool(te){var re,se,ae,le,ce,he,fe;if(this._activeTool&&te===this._activeTool.id)return!1;(re=this._activeTool)==null||re.deactivate();const ee=this._activeTool;if(this._activeTool=void 0,(se=this._toolScope)==null||se.dispose(),te){const Ae=ensure(this._toolRegistry.value(te));this._activeTool=this._instantiationService.invokeFunction(pe=>Ae.createTool(pe)),this.store.update(pe=>(pe.activeType=te,pe))}else this._activeTool=void 0,this.store.update(Ae=>(Ae.activeType=void 0,Ae));ee&&(ee.canGoBackward||(this._past.length=0),ee.fallbackable&&this._past.push(ee.type)),(ae=this._activeTool)==null||ae.activate();const ne=this._activeTool;return this._activeTool&&this.acquireToolScope({useMagnet:!!((ce=(le=this._activeTool)==null?void 0:le.useMagnetedPosition)!=null&&ce.call(le)),isDrawing:!!((fe=(he=this._activeTool)==null?void 0:he.isDrawingTool)!=null&&fe.call(he))}),this._onDidChangeTool.fire({prev:ee,next:ne}),!0}switchBack(){if(this._activeTool&&!this._activeTool.canGoBackward)return;const te=this._past.pop();te?(this.switchTool(te),this._past.pop()):this.switchTool(void 0)}keepDrawingOrSwitchBack(){if(!this._getValue("keepDrawingMode"))return this.switchBack();if(!this._activeTool)return;const te=ensure(this._toolRegistry.value(this._activeTool.type));this._activeTool.deactivate(),this._activeTool=this._instantiationService.invokeFunction(ee=>te.createTool(ee)),this._activeTool.activate()}processEvent(te){var ee;if(this._toolScope&&this._toolScope.useMagnet)switch(te.type){case InputEventType.KEY_DOWN:{const ne=ensure(te.asKeyboardInputEvent()),re=isMacintosh&&ne.metaKey||!isMacintosh&&ne.ctrlKey,se=this._getComputedMagnetMode();se===MagnetMode.Normal&&re&&this._setTempMagnetMode(MagnetMode.WeakMagnet),se!==MagnetMode.Normal&&re&&this._setTempMagnetMode(MagnetMode.Normal);break}case InputEventType.KEY_UP:{this._setTempMagnetMode(void 0);break}}return(ee=this._activeTool)==null||ee.processEvent(te),te.isAccepted()}acquireToolScope(te){return this._toolScope={...te,dispose:()=>{this._setTempMagnetMode(void 0),this._toolScope=void 0}},this._setTempMagnetMode(void 0),this._toolScope}isDrawing(){var te;return!!((te=this._toolScope)!=null&&te.isDrawing)}_getComputedMagnetMode(){var ee;if(!((ee=this._toolScope)!=null&&ee.useMagnet))return MagnetMode.Normal;const te=get$1(this.store);return te.tempMagnetMode??te.magnetMode}_applyMagnetMode(){const te=this._getComputedMagnetMode();let ee;switch(te){case MagnetMode.StrongMagnet:ee=K.MagnetOHLC;break;case MagnetMode.WeakMagnet:ee=K.MagnetOHLCWeak;break;case MagnetMode.Normal:ee=K.Normal;break;default:NOTIMPLEMENTED()}for(const ne of this._chartManagementService.getCharts())ne.chart.applyOptions({crosshair:{mode:ee}})}setMagnetMode(te){this._setValue("magnetMode",te),this._applyMagnetMode()}setKeepDrawingMode(te){this._setValue("keepDrawingMode",te)}_setTempMagnetMode(te){this.store.update(ee=>(ee.tempMagnetMode=te,ee)),this._applyMagnetMode()}};ToolService=__decorateClass$d([__decorateParam$b(0,IInstantiationService),__decorateParam$b(1,IChartManagementService),__decorateParam$b(2,IToolRegistry)],ToolService);const ITradeService=createDecorator$1("tradeService");class TradeService extends Disposable{constructor(ee,ne){super();Ee(this,"_serviceBrand");Ee(this,"_onOrderUpdated",this._register(new Emitter));Ee(this,"onOrderUpdated",this._onOrderUpdated.event);Ee(this,"_onPositionUpdated",this._register(new Emitter));Ee(this,"onPositionUpdated",this._onPositionUpdated.event);Ee(this,"_onExecutionUpdated",this._register(new Emitter));Ee(this,"onExecutionUpdated",this._onExecutionUpdated.event);Ee(this,"_broker");this.brokerConfig=ne,ee&&(this._broker=ee(this._createHost()))}get broker(){return ensure(this._broker)}_createHost(){return{orderUpdate:ee=>{this._onOrderUpdated.fire(ee)},positionUpdate:(ee,ne=!1)=>{this._onPositionUpdated.fire({position:ee,isHistoryUpdate:ne})},executionUpdate:ee=>{this._onExecutionUpdated.fire(ee)}}}async orders(){return this.broker.orders()}async positions(){return this.broker.positions()}async executions(ee){return this.broker.executions(ee)}async placeOrder(ee,ne){return this.broker.placeOrder(ee,ne)}async modifyOrder(ee,ne){return this.broker.modifyOrder(ee,ne)}async cancelOrder(ee){await this.broker.cancelOrder(ee)}async closePosition(ee,ne){await this.broker.closePosition(ee,ne)}async showOrderDialog(ee,ne){var se,ae;if(should((ae=(se=this.brokerConfig)==null?void 0:se.customUI)==null?void 0:ae.showOrderDialog),await this.brokerConfig.customUI.showOrderDialog(ee,ne))if(ee.modifyId){const le=ensure((await this.orders()).find(ce=>ce.id===ee.modifyId));await this.broker.modifyOrder({...le,...ee})}else await this.broker.placeOrder(ee);return!0}async showCancelOrderDialog(ee){var se,ae;should((ae=(se=this.brokerConfig)==null?void 0:se.customUI)==null?void 0:ae.showCancelOrderDialog);const ne=ensure((await this.orders()).find(le=>le.id===ee));return await this.brokerConfig.customUI.showCancelOrderDialog(ne)&&await this.broker.cancelOrder(ee),!0}showClosePositionDialog(ee){var ne,re;return should((re=(ne=this.brokerConfig)==null?void 0:ne.customUI)==null?void 0:re.showClosePositionDialog),this.brokerConfig.customUI.showClosePositionDialog(ee)}showCancelBracketsDialog(ee){return this.showCancelOrderDialog(ee)}showPositionBracketsDialog(ee,ne,re){var se,ae,le;return should((ae=(se=this.brokerConfig)==null?void 0:se.customUI)==null?void 0:ae.showPositionDialog),(le=this.brokerConfig.customUI)==null?void 0:le.showPositionDialog(ee,ne,re)}showReversePositionDialog(ee){var ne,re,se;return should((re=(ne=this.brokerConfig)==null?void 0:ne.customUI)==null?void 0:re.showPositionDialog),(se=this.brokerConfig.customUI)==null?void 0:se.showPositionDialog(ee,Object.create(null))}}var __getOwnPropDesc$c=Object.getOwnPropertyDescriptor,__decorateClass$c=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$c(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$a=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let stackElementCounter=0;class ResourceStackElement{constructor(te,ee){Ee(this,"id",++stackElementCounter);Ee(this,"type",UndoRedoElementType.Resource);Ee(this,"actual");Ee(this,"resource");this.actual=te,this.resource=ee}}class ResourceEditStack{constructor(te){Ee(this,"resource");Ee(this,"_past");Ee(this,"_future");Ee(this,"locked");Ee(this,"versionId");this.resource=te,this._past=[],this._future=[],this.locked=!1,this.versionId=1}pushElement(te){this._future=[],this._past.push(te),this.versionId++}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}moveForward(te){this._future.pop(),this._past.push(te),this.versionId++}moveBackward(te){this._past.pop(),this._future.push(te),this.versionId++}}class EditStackSnapshot{constructor(te){Ee(this,"editStacks");Ee(this,"_versionIds");this.editStacks=te,this._versionIds=[];for(let ee=0,ne=this.editStacks.length;ee<ne;ee++)this._versionIds[ee]=this.editStacks[ee].versionId}isValid(){for(let te=0,ee=this.editStacks.length;te<ee;te++)if(this._versionIds[te]!==this.editStacks[te].versionId)return!1;return!0}}let UndoRedoService=class{constructor(ie){Ee(this,"_editStacks",new Map);this._notificationService=ie}pushElement(ie){ie.type===UndoRedoElementType.Resource?this._pushElement(new ResourceStackElement(ie,ie.resource)):NOTIMPLEMENTED()}_pushElement(ie){const te=ie.resource;let ee;this._editStacks.has(te)?ee=ensure(this._editStacks.get(te)):(ee=new ResourceEditStack(te),this._editStacks.set(te,ee)),ee.pushElement(ie)}removeElements(ie){this._editStacks.has(ie)&&this._editStacks.delete(ie)}canUndo(ie){var te;return((te=this._editStacks.get(ie))==null?void 0:te.hasPastElements())??!1}undo(ie){return this._undo(ie)}_undo(ie){if(!this._editStacks.has(ie))return;const te=ensure(this._editStacks.get(ie)),ee=te.getClosestPastElement();if(ee)try{return this._resourceUndo(te,ee)}catch(ne){console.error(ne)}finally{}}_resourceUndo(ie,te){return ie.locked&&NOTREACHED(),ie.moveBackward(te),this._safeInvokeWithLocks(te,()=>{te.actual.undo()},new EditStackSnapshot([ie]))}canRedo(ie){var te;return((te=this._editStacks.get(ie))==null?void 0:te.hasFutureElements())??!1}redo(ie){return this._redo(ie)}_redo(ie){if(!this._editStacks.has(ie))return;const te=ensure(this._editStacks.get(ie)),ee=te.getClosestFutureElement();if(ee)try{return this._resourceRedo(te,ee)}catch(ne){console.error(ne)}finally{}}_resourceRedo(ie,te){return ie.moveForward(te),this._safeInvokeWithLocks(te,()=>te.actual.redo(),new EditStackSnapshot([ie]))}_safeInvokeWithLocks(ie,te,ee){const ne=this._acquireLocks(ee);let re;try{re=te()}catch(se){return ne(),this._onError(se,ie)}if(re)return re.then(()=>{ne()},se=>(ne(),this._onError(se,ie)));ne()}_acquireLocks(ie){for(const te of ie.editStacks)if(te.locked)throw new Error("Cannot acquire edit stack lock");for(const te of ie.editStacks)te.locked=!0;return()=>{for(const te of ie.editStacks)te.locked=!1}}_onError(ie,te){onUnexpectedError(ie),this.removeElements(te.resource),this._notificationService.error(ie)}};UndoRedoService=__decorateClass$c([__decorateParam$a(0,INotificationService)],UndoRedoService);function getOrSet(ie,te,ee){let ne=ie.get(te);return ne===void 0&&(ne=ee,ie.set(te,ne)),ne}const IWorkbenchContributionsRegistry=createDecorator$1("workbenchContributionsRegistry");class WorkbenchContributionsRegistry extends Disposable{constructor(){super(...arguments);Ee(this,"_serviceBrand");Ee(this,"instantiationService");Ee(this,"lifecycleService");Ee(this,"logService");Ee(this,"contributionsByPhase",new Map);Ee(this,"contributionsById",new Map);Ee(this,"instancesById",new Map);Ee(this,"instanceDisposables",this._register(new DisposableStore));Ee(this,"pendingRestoredContributions",new DeferredPromise)}register(ee,ne,re){const se={id:ee,ctor:ne};this.instantiationService&&this.logService&&this.lifecycleService&&this.lifecycleService.phase>=re?this.safeCreateContribution(this.instantiationService,this.logService,se):(getOrSet(this.contributionsByPhase,re,[]).push(se),this.contributionsById.has(ee)?console.error(`IWorkbenchContributionsRegistry#registerWorkbenchContribution(): Can't register multiple contributions with same id '${ee}'`):this.contributionsById.set(ee,se))}start(ee){const ne=this.instantiationService=ee.get(IInstantiationService),re=this.lifecycleService=ee.get(ILifecycleService),se=this.logService=ee.get(ILogService);for(const ae of[LifecyclePhase.Starting,LifecyclePhase.Ready,LifecyclePhase.Restored,LifecyclePhase.Eventually])this.instantiateByPhase(ne,re,se,ae)}dispose(){super.dispose(),this.contributionsByPhase.clear(),this.contributionsById.clear(),this.instancesById.forEach(ee=>{isDisposable(ee)&&dispose(ee)}),this.pendingRestoredContributions=null}getWorkbenchContribution(ee){if(this.instancesById.has(ee))return this.instancesById.get(ee);const ne=this.instantiationService,re=this.lifecycleService,se=this.logService;if(!ne||!re||!se)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${ee}'): cannot be called before registry started`);const ae=this.contributionsById.get(ee);if(!ae)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${ee}'): contribution with that identifier is unknown.`);re.phase<LifecyclePhase.Restored&&se.warn(`IWorkbenchContributionsRegistry#getContribution('${ee}'): contribution instantiated before LifecyclePhase.Restored!`),this.safeCreateContribution(ne,se,ae);const le=this.instancesById.get(ee);if(!le)throw new Error(`IWorkbenchContributionsRegistry#getContribution('${ee}'): failed to create contribution.`);return le}instantiateByPhase(ee,ne,re,se){ne.phase>=se?this.doInstantiateByPhase(ee,re,se):ne.when(se).then(()=>this.doInstantiateByPhase(ee,re,se))}async doInstantiateByPhase(ee,ne,re){const se=this.contributionsByPhase.get(re);if(se)switch(this.contributionsByPhase.delete(re),re){case LifecyclePhase.Starting:case LifecyclePhase.Ready:{for(const ae of se)this.safeCreateContribution(ee,ne,ae);break}case LifecyclePhase.Restored:case LifecyclePhase.Eventually:{re===LifecyclePhase.Eventually&&await this.pendingRestoredContributions.p,this.doInstantiateWhenIdle(se,ee,ne,re);break}}}doInstantiateWhenIdle(ee,ne,re,se){let ae=0;const le=se===LifecyclePhase.Eventually?3e3:500,ce=he=>{for(;ae<ee.length;){const fe=ee[ae++];if(this.safeCreateContribution(ne,re,fe),he.timeRemaining()<1){runWhenIdle(ce,le);break}}ae===ee.length&&se===LifecyclePhase.Restored&&this.pendingRestoredContributions.complete()};runWhenIdle(ce,le)}safeCreateContribution(ee,ne,re){if(!this.instancesById.has(re.id))try{const se=ee.createInstance(re.ctor);this.instancesById.set(re.id,se),this.contributionsById.delete(re.id),isDisposable(se)&&this.instanceDisposables.add(se)}catch(se){ne.error(`Unable to create workbench contribution '${re.id??re.ctor.name}'.`,se)}finally{}}}var __getOwnPropDesc$b=Object.getOwnPropertyDescriptor,__decorateClass$b=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$b(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$9=(ie,te)=>(ee,ne)=>te(ee,ne,ie);const kbLog=KeyCode.KeyL|KeyMod.Alt,kbPercent=KeyCode.KeyP|KeyMod.Alt;let PriceScaleKeybindingContrib=class extends Disposable{constructor(ie,te){super(),this._register(te.registerCommandAndKeybindingRule({id:"priceScale.log",primary:kbLog,weight:KeybindingWeight.ChartCore,handler:()=>{var ne;const ee=(ne=ie.activeChart())==null?void 0:ne.chart;ee&&ee.applyOptions({rightPriceScale:{mode:ee.options().rightPriceScale.mode===pi.Logarithmic?pi.Normal:pi.Logarithmic}})}})),this._register(te.registerCommandAndKeybindingRule({id:"priceScale.percent",primary:kbPercent,weight:KeybindingWeight.ChartCore,handler:()=>{const ee=ie.activeChart().chart;ee&&ee.applyOptions({rightPriceScale:{mode:ee.options().rightPriceScale.mode===pi.Percentage?pi.Normal:pi.Percentage}})}}))}};PriceScaleKeybindingContrib=__decorateClass$b([__decorateParam$9(0,IChartManagementService),__decorateParam$9(1,IKeybindingsRegistry)],PriceScaleKeybindingContrib);var __getOwnPropDesc$a=Object.getOwnPropertyDescriptor,__decorateClass$a=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$a(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$8=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let UndoRedoKeybindingContrib=class extends Disposable{constructor(ie,te,ee){super(),this._register(ee.registerCommandAndKeybindingRule({id:"core.undo",primary:KeyCode.KeyZ|KeyMod.CtrlCmd,weight:KeybindingWeight.ChartCore,handler:()=>{const ne=te.activeChart();ie.canUndo(ne.id)&&ie.undo(ne.id)}})),this._register(ee.registerCommandAndKeybindingRule({id:"core.redo",primary:KeyCode.KeyZ|KeyMod.CtrlCmd|KeyMod.Shift,weight:KeybindingWeight.ChartCore,handler:()=>{const ne=te.activeChart();ie.canRedo(ne.id)&&ie.redo(ne.id)}}))}};UndoRedoKeybindingContrib=__decorateClass$a([__decorateParam$8(0,IUndoRedoService),__decorateParam$8(1,IChartManagementService),__decorateParam$8(2,IKeybindingsRegistry)],UndoRedoKeybindingContrib);function isNumberEqual(ie,te,ee=.001){return Math.abs(ie-te)<ee}function clamp$1(ie,te,ee){return Math.min(Math.max(ie,te),ee)}function ceiledEven(ie){const te=Math.ceil(ie);return te%2!==0?te-1:te}function sign(ie){return ie<0?-1:ie>0?1:0}function isEven(ie){return ie%2==0}function arePointsEqual(ie,te){return isNumberEqual(ie.x,te.x)&&isNumberEqual(ie.y,te.y)}function euclideanDistance(ie,te,ee,ne){const re=ee-ie,se=ne-te;return Math.sqrt(re*re+se*se)}function euclideanDistanceBetweenPoints(ie,te){return euclideanDistance(ie.x,ie.y,te.x,te.y)}function midPoint(ie,te){return new Point({x:ie.x+(te.x-ie.x)/2,y:ie.y+(te.y-ie.y)/2})}class Point{constructor(te,ee){Ee(this,"x");Ee(this,"y");isNumber$1(te)?(this.x=te,this.y=ensure(ee)):(this.x=te.x,this.y=te.y)}add(te){return new Point(this.x+te.x,this.y+te.y)}addScaled(te,ee){return new Point(this.x+ee*te.x,this.y+ee*te.y)}subtract(te){return new Point(this.x-te.x,this.y-te.y)}dotProduct(te){return this.x*te.x+this.y*te.y}crossProduct(te){return this.x*te.y-this.y*te.x}signedAngle(te){return Math.atan2(this.crossProduct(te),this.dotProduct(te))}angle(te){return Math.acos(this.dotProduct(te)/(this.length()*te.length()))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}scaled(te){return new Point(this.x*te,this.y*te)}normalized(){const te=this.length();return te===0?this:this.scaled(1/te)}transposed(){return new Point(-this.y,this.x)}clone(){return new Point(this.x,this.y)}}const AnchorResizeE=1,AnchorResizeS=2,AnchorResizeW=4,AnchorResizeN=8,AnchorResizeHorz=AnchorResizeE|AnchorResizeW,AnchorResizeVert=AnchorResizeS|AnchorResizeN,AnchorResizeAll=AnchorResizeHorz|AnchorResizeVert;function canResize(ie,te){return(ie&te)!==0}function canResizeE(ie){return canResize(ie,AnchorResizeE)}function canResizeS(ie){return canResize(ie,AnchorResizeS)}function canResizeW(ie){return canResize(ie,AnchorResizeW)}function canResizeN(ie){return canResize(ie,AnchorResizeN)}function canResizeHorz(ie){return canResizeE(ie)||canResizeW(ie)}function canResizeVert(ie){return canResizeN(ie)||canResizeS(ie)}function canResizeAll(ie){return canResizeVert(ie)&&canResizeHorz(ie)}var HitTarget=(ie=>(ie[ie.None=0]="None",ie[ie.Regular=1]="Regular",ie[ie.MovePoint=2]="MovePoint",ie[ie.ChangePoint=3]="ChangePoint",ie[ie.Custom=4]="Custom",ie))(HitTarget||{}),AreaName=(ie=>(ie[ie.Text=0]="Text",ie[ie.Line=1]="Line",ie[ie.AnchorPoint=2]="AnchorPoint",ie))(AreaName||{});function isAnchorDetails(ie){return ie?"areaName"in ie&&ie.areaName===AreaName.AnchorPoint:!1}function isTextDetails(ie){return ie?"areaName"in ie&&ie.areaName===AreaName.Text:!1}class HitTestResult{constructor(te,ee){this.target=te,this.details=ee}mergeData(te){this.details?Object.assign(this.details,te):this.details=te}}const DragEffectMinDistance=5,MouseTolerance={common:3,line:3,minDistanceBetweenPoints:5,series:2,curve:3,anchor:2,esd:0};function interactionTolerance(){return MouseTolerance}var DrawingAbortBehavior=(ie=>(ie[ie.None=0]="None",ie[ie.Remove=1]="Remove",ie))(DrawingAbortBehavior||{});const AddPointAcceptMask=1,AddPointFinishMask=2,AddPointRejectMask=8;var AddPointResponse=(ie=>(ie[ie.Accept=AddPointAcceptMask]="Accept",ie[ie.AcceptAndFinish=AddPointAcceptMask|AddPointFinishMask]="AcceptAndFinish",ie[ie.Reject=AddPointRejectMask]="Reject",ie))(AddPointResponse||{});function isPointAccepted(ie){return(ie&AddPointAcceptMask)!==0}const DrawingContribId="drawing",RemoveDrawingCommand="drawing.remove",CopyDrawingCommand="drawing.copy",CloneDrawingCommand="drawing.clone";function getXCoordinate(ie,te,ee){if(ee!=null&&ee.clamp){const re=ie.chart.timeScale().width();te=clamp$1(te,0,re)}if(ee!=null&&ee.useExtended)return ie.chart.timeScale().coordinateToTimeEx(te);let ne=ie.chart.timeScale().coordinateToTime(te);if(!ne){const re=ie.mainSeriesWrapper.getSeries().data(),se=re[re.length-1],ae=ensure(ie.chart.timeScale().timeToCoordinate(se.time));should(te>=ae),ne=se.time}return ne}function isValidPosition(ie){return isFinite(ie.x)&&isFinite(ie.y)&&isFiniteNumber(ie.paneIndex)&&isFinite(ie.paneIndex)}const ImageToolType="tool.content.image",DrawingFragmentBrand="data-chartles-drawing",FileNameKey="_imgFileName_";function toFragmentString(ie){const te=cloneDeep(ie.properties());ie.type===ImageToolType&&Reflect.set(te,FileNameKey,ie.properties().image.name);const ee=JSON.stringify({type:ie.type,props:te}),ne=escape(ee);return`<span ${DrawingFragmentBrand}="${ne}"> </span>`}function parseFragmentString(ie){if(!ie||ie.slice(0,1024).indexOf(DrawingFragmentBrand)===-1)return;const te=new DOMParser().parseFromString(ie,"text/html").querySelector(`[${DrawingFragmentBrand}]`);if(te)try{return JSON.parse(te.getAttribute(DrawingFragmentBrand)??"")}catch{}}const PUBLIC_VERSION="5";var Lu;typeof window<"u"&&((Lu=window.__svelte??(window.__svelte={})).v??(Lu.v=new Set)).add(PUBLIC_VERSION);var e={dragStart:!0},t={delay:0,distance:3},n=(ie,te,ee)=>Math.min(Math.max(ie,te),ee),r=ie=>typeof ie=="string",o=([ie,te],ee,ne)=>{const re=(se,ae)=>ae===0?0:Math.ceil(se/ae)*ae;return[re(ee,ie),re(ne,te)]},a=(ie,te)=>ie.some(ee=>te.some(ne=>ee.contains(ne)));function i(ie,te){if(ie===void 0)return;if(l(ie))return ie.getBoundingClientRect();if(typeof ie=="object"){const{top:ne=0,left:re=0,right:se=0,bottom:ae=0}=ie;return{top:ne,right:window.innerWidth-se,bottom:window.innerHeight-ae,left:re}}if(ie==="parent")return te.parentNode.getBoundingClientRect();const ee=document.querySelector(ie);if(ee===null)throw new Error("The selector provided for bound doesn't exists in the document.");return ee.getBoundingClientRect()}var s=(ie,te,ee)=>ie.style.setProperty(te,ee),l=ie=>ie instanceof HTMLElement,d=function(ie,te={}){let ee,ne,{bounds:re,axis:se="both",gpuAcceleration:ae=!0,legacyTranslate:le=!1,transform:ce,applyUserSelectHack:he=!0,disabled:fe=!1,ignoreMultitouch:Ae=!1,recomputeBounds:pe=e,grid:Oe,threshold:Fe=t,position:Ne,cancel:ze,handle:He,defaultClass:We="neodrag",defaultClassDragging:je="neodrag-dragging",defaultClassDragged:Ue="neodrag-dragged",defaultPosition:Ge={x:0,y:0},onDragStart:Ze,onDrag:Ye,onDragEnd:qe}=te,nr=!1,ir=!1,tr=0,or=!1,Jt=!1,rr=0,lr=0,ur=0,Sr=0,xr=0,Pr=0,{x:mr,y:Er}=Ne?{x:(Ne==null?void 0:Ne.x)??0,y:(Ne==null?void 0:Ne.y)??0}:Ge;po(mr,Er);let dr,Cr,Or,Ar,Ir,wr="",Dr=!!Ne;pe={...e,...pe},Fe={...t,...Fe??{}};let Ur=new Set;function zr(Br){nr&&!ir&&Jt&&or&&Ir&&(ir=!0,function(Vr){so("neodrag:start",Ze,Vr)}(Br),Jr.add(je),he&&(wr=Fr.userSelect,Fr.userSelect="none"))}const Fr=document.body.style,Jr=ie.classList;function po(Br=rr,Vr=lr){if(!ce){if(le){let Zr=`${+Br}px, ${+Vr}px`;return s(ie,"transform",ae?`translate3d(${Zr}, 0)`:`translate(${Zr})`)}return s(ie,"translate",`${+Br}px ${+Vr}px`)}const Yr=ce({offsetX:Br,offsetY:Vr,rootNode:ie});r(Yr)&&s(ie,"transform",Yr)}function so(Br,Vr,Yr){const Zr=function(uo){return{offsetX:rr,offsetY:lr,rootNode:ie,currentNode:Ir,event:uo}}(Yr);ie.dispatchEvent(new CustomEvent(Br,{detail:Zr})),Vr==null||Vr(Zr)}const ho=addEventListener,Lo=new AbortController,bo={signal:Lo.signal,capture:!1};function Uo(){let Br=ie.offsetWidth/Cr.width;return isNaN(Br)&&(Br=1),Br}return s(ie,"touch-action","none"),ho("pointerdown",Br=>{if(fe||Br.button===2)return;if(Ur.add(Br.pointerId),Ae&&Ur.size>1)return Br.preventDefault();if(pe.dragStart&&(dr=i(re,ie)),r(He)&&r(ze)&&He===ze)throw new Error("`handle` selector can't be same as `cancel` selector");if(Jr.add(We),Or=function(ro,Rr){if(!ro)return[Rr];if(l(ro))return[ro];if(Array.isArray(ro))return ro;const fr=Rr.querySelectorAll(ro);if(fr===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return Array.from(fr.values())}(He,ie),Ar=function(ro,Rr){if(!ro)return[];if(l(ro))return[ro];if(Array.isArray(ro))return ro;const fr=Rr.querySelectorAll(ro);if(fr===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return Array.from(fr.values())}(ze,ie),ee=/(both|x)/.test(se),ne=/(both|y)/.test(se),a(Ar,Or))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");const Vr=Br.composedPath()[0];if(!Or.some(ro=>{var Rr;return ro.contains(Vr)||((Rr=ro.shadowRoot)==null?void 0:Rr.contains(Vr))})||a(Ar,[Vr]))return;Ir=Or.length===1?ie:Or.find(ro=>ro.contains(Vr)),nr=!0,tr=Date.now(),Fe.delay||(or=!0),Cr=ie.getBoundingClientRect();const{clientX:Yr,clientY:Zr}=Br,uo=Uo();ee&&(ur=Yr-mr/uo),ne&&(Sr=Zr-Er/uo),dr&&(xr=Yr-Cr.left,Pr=Zr-Cr.top)},bo),ho("pointermove",Br=>{if(!nr||Ae&&Ur.size>1)return;if(!ir){if(or||Date.now()-tr>=Fe.delay&&(or=!0,zr(Br)),!Jt){const uo=Br.clientX-ur,ro=Br.clientY-Sr;Math.sqrt(uo**2+ro**2)>=Fe.distance&&(Jt=!0,zr(Br))}if(!ir)return}pe.drag&&(dr=i(re,ie)),Br.preventDefault(),Cr=ie.getBoundingClientRect();let Vr=Br.clientX,Yr=Br.clientY;const Zr=Uo();if(dr){const uo={left:dr.left+xr,top:dr.top+Pr,right:dr.right+xr-Cr.width,bottom:dr.bottom+Pr-Cr.height};Vr=n(Vr,uo.left,uo.right),Yr=n(Yr,uo.top,uo.bottom)}if(Array.isArray(Oe)){let[uo,ro]=Oe;if(isNaN(+uo)||uo<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+ro)||ro<0)throw new Error("2nd argument of `grid` must be a valid positive number");let Rr=Vr-ur,fr=Yr-Sr;[Rr,fr]=o([uo/Zr,ro/Zr],Rr,fr),Vr=ur+Rr,Yr=Sr+fr}ee&&(rr=Math.round((Vr-ur)*Zr)),ne&&(lr=Math.round((Yr-Sr)*Zr)),mr=rr,Er=lr,so("neodrag",Ye,Br),po()},bo),ho("pointerup",Br=>{Ur.delete(Br.pointerId),nr&&(ir&&(ho("click",Vr=>Vr.stopPropagation(),{once:!0,signal:Lo.signal,capture:!0}),pe.dragEnd&&(dr=i(re,ie)),Jr.remove(je),Jr.add(Ue),he&&(Fr.userSelect=wr),so("neodrag:end",qe,Br),ee&&(ur=rr),ne&&(Sr=lr)),nr=!1,ir=!1,or=!1,Jt=!1)},bo),{destroy:()=>Lo.abort(),update:Br=>{var Yr,Zr;se=Br.axis||"both",fe=Br.disabled??!1,Ae=Br.ignoreMultitouch??!1,He=Br.handle,re=Br.bounds,pe=Br.recomputeBounds??e,ze=Br.cancel,he=Br.applyUserSelectHack??!0,Oe=Br.grid,ae=Br.gpuAcceleration??!0,le=Br.legacyTranslate??!1,ce=Br.transform,Fe={...t,...Br.threshold??{}};const Vr=Jr.contains(Ue);Jr.remove(We,Ue),We=Br.defaultClass??"neodrag",je=Br.defaultClassDragging??"neodrag-dragging",Ue=Br.defaultClassDragged??"neodrag-dragged",Jr.add(We),Vr&&Jr.add(Ue),Dr&&(mr=rr=((Yr=Br.position)==null?void 0:Yr.x)??rr,Er=lr=((Zr=Br.position)==null?void 0:Zr.y)??lr,po())}}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var FOCUS_SENTINEL_CLASS="mdc-dom-focus-sentinel",FocusTrap=function(){function ie(te,ee){ee===void 0&&(ee={}),this.root=te,this.options=ee,this.elFocusedBeforeTrapFocus=null}return ie.prototype.trapFocus=function(){var te=this.getFocusableElements(this.root);if(te.length===0)throw new Error("FocusTrap: Element must have at least one focusable child.");this.elFocusedBeforeTrapFocus=document.activeElement instanceof HTMLElement?document.activeElement:null,this.wrapTabFocus(this.root),this.options.skipInitialFocus||this.focusInitialElement(te,this.options.initialFocusEl)},ie.prototype.releaseFocus=function(){[].slice.call(this.root.querySelectorAll("."+FOCUS_SENTINEL_CLASS)).forEach(function(te){te.parentElement.removeChild(te)}),!this.options.skipRestoreFocus&&this.elFocusedBeforeTrapFocus&&this.elFocusedBeforeTrapFocus.focus()},ie.prototype.wrapTabFocus=function(te){var ee=this,ne=this.createSentinel(),re=this.createSentinel();ne.addEventListener("focus",function(){var se=ee.getFocusableElements(te);se.length>0&&se[se.length-1].focus()}),re.addEventListener("focus",function(){var se=ee.getFocusableElements(te);se.length>0&&se[0].focus()}),te.insertBefore(ne,te.children[0]),te.appendChild(re)},ie.prototype.focusInitialElement=function(te,ee){var ne=0;ee&&(ne=Math.max(te.indexOf(ee),0)),te[ne].focus()},ie.prototype.getFocusableElements=function(te){var ee=[].slice.call(te.querySelectorAll("[autofocus], [tabindex], a, input, textarea, select, button"));return ee.filter(function(ne){var re=ne.getAttribute("aria-disabled")==="true"||ne.getAttribute("disabled")!=null||ne.getAttribute("hidden")!=null||ne.getAttribute("aria-hidden")==="true",se=ne.tabIndex>=0&&ne.getBoundingClientRect().width>0&&!ne.classList.contains(FOCUS_SENTINEL_CLASS)&&!re,ae=!1;if(se){var le=getComputedStyle(ne);ae=le.display==="none"||le.visibility==="hidden"}return se&&!ae})},ie.prototype.createSentinel=function(){var te=document.createElement("div");return te.setAttribute("tabindex","0"),te.setAttribute("aria-hidden","true"),te.classList.add(FOCUS_SENTINEL_CLASS),te},ie}();const domFocusTrap=Object.freeze(Object.defineProperty({__proto__:null,FocusTrap},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var KEY={UNKNOWN:"Unknown",BACKSPACE:"Backspace",ENTER:"Enter",SPACEBAR:"Spacebar",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",END:"End",HOME:"Home",ARROW_LEFT:"ArrowLeft",ARROW_UP:"ArrowUp",ARROW_RIGHT:"ArrowRight",ARROW_DOWN:"ArrowDown",DELETE:"Delete",ESCAPE:"Escape",TAB:"Tab"},normalizedKeys=new Set;normalizedKeys.add(KEY.BACKSPACE);normalizedKeys.add(KEY.ENTER);normalizedKeys.add(KEY.SPACEBAR);normalizedKeys.add(KEY.PAGE_UP);normalizedKeys.add(KEY.PAGE_DOWN);normalizedKeys.add(KEY.END);normalizedKeys.add(KEY.HOME);normalizedKeys.add(KEY.ARROW_LEFT);normalizedKeys.add(KEY.ARROW_UP);normalizedKeys.add(KEY.ARROW_RIGHT);normalizedKeys.add(KEY.ARROW_DOWN);normalizedKeys.add(KEY.DELETE);normalizedKeys.add(KEY.ESCAPE);normalizedKeys.add(KEY.TAB);var KEY_CODE={BACKSPACE:8,ENTER:13,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ESCAPE:27,TAB:9},mappedKeyCodes=new Map;mappedKeyCodes.set(KEY_CODE.BACKSPACE,KEY.BACKSPACE);mappedKeyCodes.set(KEY_CODE.ENTER,KEY.ENTER);mappedKeyCodes.set(KEY_CODE.SPACEBAR,KEY.SPACEBAR);mappedKeyCodes.set(KEY_CODE.PAGE_UP,KEY.PAGE_UP);mappedKeyCodes.set(KEY_CODE.PAGE_DOWN,KEY.PAGE_DOWN);mappedKeyCodes.set(KEY_CODE.END,KEY.END);mappedKeyCodes.set(KEY_CODE.HOME,KEY.HOME);mappedKeyCodes.set(KEY_CODE.ARROW_LEFT,KEY.ARROW_LEFT);mappedKeyCodes.set(KEY_CODE.ARROW_UP,KEY.ARROW_UP);mappedKeyCodes.set(KEY_CODE.ARROW_RIGHT,KEY.ARROW_RIGHT);mappedKeyCodes.set(KEY_CODE.ARROW_DOWN,KEY.ARROW_DOWN);mappedKeyCodes.set(KEY_CODE.DELETE,KEY.DELETE);mappedKeyCodes.set(KEY_CODE.ESCAPE,KEY.ESCAPE);mappedKeyCodes.set(KEY_CODE.TAB,KEY.TAB);var navigationKeys=new Set;navigationKeys.add(KEY.PAGE_UP);navigationKeys.add(KEY.PAGE_DOWN);navigationKeys.add(KEY.END);navigationKeys.add(KEY.HOME);navigationKeys.add(KEY.ARROW_LEFT);navigationKeys.add(KEY.ARROW_UP);navigationKeys.add(KEY.ARROW_RIGHT);navigationKeys.add(KEY.ARROW_DOWN);function normalizeKey(ie){var te=ie.key;if(normalizedKeys.has(te))return te;var ee=mappedKeyCodes.get(ie.keyCode);return ee||KEY.UNKNOWN}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function closest(ie,te){if(ie.closest)return ie.closest(te);for(var ee=ie;ee;){if(matches(ee,te))return ee;ee=ee.parentElement}return null}function matches(ie,te){var ee=ie.matches||ie.webkitMatchesSelector||ie.msMatchesSelector;return ee.call(ie,te)}function estimateScrollWidth(ie){var te=ie;if(te.offsetParent!==null)return te.scrollWidth;var ee=te.cloneNode(!0);ee.style.setProperty("position","absolute"),ee.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(ee);var ne=ee.scrollWidth;return document.documentElement.removeChild(ee),ne}const ponyfill=Object.freeze(Object.defineProperty({__proto__:null,closest,estimateScrollWidth,matches},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var MDCFoundation=function(){function ie(te){te===void 0&&(te={}),this.adapter=te}return Object.defineProperty(ie,"cssClasses",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(ie,"strings",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(ie,"numbers",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(ie,"defaultAdapter",{get:function(){return{}},enumerable:!1,configurable:!0}),ie.prototype.init=function(){},ie.prototype.destroy=function(){},ie}();/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var _a,_b,cssClasses$4={LIST_ITEM_ACTIVATED_CLASS:"mdc-list-item--activated",LIST_ITEM_CLASS:"mdc-list-item",LIST_ITEM_DISABLED_CLASS:"mdc-list-item--disabled",LIST_ITEM_SELECTED_CLASS:"mdc-list-item--selected",LIST_ITEM_TEXT_CLASS:"mdc-list-item__text",LIST_ITEM_PRIMARY_TEXT_CLASS:"mdc-list-item__primary-text",ROOT:"mdc-list"};_a={},_a[""+cssClasses$4.LIST_ITEM_ACTIVATED_CLASS]="mdc-list-item--activated",_a[""+cssClasses$4.LIST_ITEM_CLASS]="mdc-list-item",_a[""+cssClasses$4.LIST_ITEM_DISABLED_CLASS]="mdc-list-item--disabled",_a[""+cssClasses$4.LIST_ITEM_SELECTED_CLASS]="mdc-list-item--selected",_a[""+cssClasses$4.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-list-item__primary-text",_a[""+cssClasses$4.ROOT]="mdc-list";var deprecatedClassNameMap=(_b={},_b[""+cssClasses$4.LIST_ITEM_ACTIVATED_CLASS]="mdc-deprecated-list-item--activated",_b[""+cssClasses$4.LIST_ITEM_CLASS]="mdc-deprecated-list-item",_b[""+cssClasses$4.LIST_ITEM_DISABLED_CLASS]="mdc-deprecated-list-item--disabled",_b[""+cssClasses$4.LIST_ITEM_SELECTED_CLASS]="mdc-deprecated-list-item--selected",_b[""+cssClasses$4.LIST_ITEM_TEXT_CLASS]="mdc-deprecated-list-item__text",_b[""+cssClasses$4.LIST_ITEM_PRIMARY_TEXT_CLASS]="mdc-deprecated-list-item__primary-text",_b[""+cssClasses$4.ROOT]="mdc-deprecated-list",_b),strings$5={ACTION_EVENT:"MDCList:action",SELECTION_CHANGE_EVENT:"MDCList:selectionChange",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",ARIA_INTERACTIVE_ROLES_SELECTOR:'[role="listbox"], [role="menu"]',ARIA_MULTI_SELECTABLE_SELECTOR:'[aria-multiselectable="true"]',CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:`
    .`+cssClasses$4.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+cssClasses$4.LIST_ITEM_CLASS+` a,
    .`+deprecatedClassNameMap[cssClasses$4.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+deprecatedClassNameMap[cssClasses$4.LIST_ITEM_CLASS]+` a
  `,DEPRECATED_SELECTOR:".mdc-deprecated-list",FOCUSABLE_CHILD_ELEMENTS:`
    .`+cssClasses$4.LIST_ITEM_CLASS+` button:not(:disabled),
    .`+cssClasses$4.LIST_ITEM_CLASS+` a,
    .`+cssClasses$4.LIST_ITEM_CLASS+` input[type="radio"]:not(:disabled),
    .`+cssClasses$4.LIST_ITEM_CLASS+` input[type="checkbox"]:not(:disabled),
    .`+deprecatedClassNameMap[cssClasses$4.LIST_ITEM_CLASS]+` button:not(:disabled),
    .`+deprecatedClassNameMap[cssClasses$4.LIST_ITEM_CLASS]+` a,
    .`+deprecatedClassNameMap[cssClasses$4.LIST_ITEM_CLASS]+` input[type="radio"]:not(:disabled),
    .`+deprecatedClassNameMap[cssClasses$4.LIST_ITEM_CLASS]+` input[type="checkbox"]:not(:disabled)
  `,RADIO_SELECTOR:'input[type="radio"]',SELECTED_ITEM_SELECTOR:'[aria-selected="true"], [aria-current="true"]'},numbers$5={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ELEMENTS_KEY_ALLOWED_IN=["input","button","textarea","select"],preventDefaultEvent=function(ie){var te=ie.target;if(te){var ee=(""+te.tagName).toLowerCase();ELEMENTS_KEY_ALLOWED_IN.indexOf(ee)===-1&&ie.preventDefault()}};/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function initState(){var ie={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""};return ie}function initSortedIndex(ie,te){for(var ee=new Map,ne=0;ne<ie;ne++){var re=te(ne).trim();if(re){var se=re[0].toLowerCase();ee.has(se)||ee.set(se,[]),ee.get(se).push({text:re.toLowerCase(),index:ne})}}return ee.forEach(function(ae){ae.sort(function(le,ce){return le.index-ce.index})}),ee}function matchItem(ie,te){var ee=ie.nextChar,ne=ie.focusItemAtIndex,re=ie.sortedIndexByFirstChar,se=ie.focusedItemIndex,ae=ie.skipFocus,le=ie.isItemAtIndexDisabled;clearTimeout(te.bufferClearTimeout),te.bufferClearTimeout=setTimeout(function(){clearBuffer(te)},numbers$5.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),te.typeaheadBuffer=te.typeaheadBuffer+ee;var ce;return te.typeaheadBuffer.length===1?ce=matchFirstChar(re,se,le,te):ce=matchAllChars(re,le,te),ce!==-1&&!ae&&ne(ce),ce}function matchFirstChar(ie,te,ee,ne){var re=ne.typeaheadBuffer[0],se=ie.get(re);if(!se)return-1;if(re===ne.currentFirstChar&&se[ne.sortedIndexCursor].index===te){ne.sortedIndexCursor=(ne.sortedIndexCursor+1)%se.length;var ae=se[ne.sortedIndexCursor].index;if(!ee(ae))return ae}ne.currentFirstChar=re;var le=-1,ce;for(ce=0;ce<se.length;ce++)if(!ee(se[ce].index)){le=ce;break}for(;ce<se.length;ce++)if(se[ce].index>te&&!ee(se[ce].index)){le=ce;break}return le!==-1?(ne.sortedIndexCursor=le,se[ne.sortedIndexCursor].index):-1}function matchAllChars(ie,te,ee){var ne=ee.typeaheadBuffer[0],re=ie.get(ne);if(!re)return-1;var se=re[ee.sortedIndexCursor];if(se.text.lastIndexOf(ee.typeaheadBuffer,0)===0&&!te(se.index))return se.index;for(var ae=(ee.sortedIndexCursor+1)%re.length,le=-1;ae!==ee.sortedIndexCursor;){var ce=re[ae],he=ce.text.lastIndexOf(ee.typeaheadBuffer,0)===0,fe=!te(ce.index);if(he&&fe){le=ae;break}ae=(ae+1)%re.length}return le!==-1?(ee.sortedIndexCursor=le,re[ee.sortedIndexCursor].index):-1}function isTypingInProgress(ie){return ie.typeaheadBuffer.length>0}function clearBuffer(ie){ie.typeaheadBuffer=""}function handleKeydown(ie,te){var ee=ie.event,ne=ie.isTargetListItem,re=ie.focusedItemIndex,se=ie.focusItemAtIndex,ae=ie.sortedIndexByFirstChar,le=ie.isItemAtIndexDisabled,ce=normalizeKey(ee)==="ArrowLeft",he=normalizeKey(ee)==="ArrowUp",fe=normalizeKey(ee)==="ArrowRight",Ae=normalizeKey(ee)==="ArrowDown",pe=normalizeKey(ee)==="Home",Oe=normalizeKey(ee)==="End",Fe=normalizeKey(ee)==="Enter",Ne=normalizeKey(ee)==="Spacebar";if(ee.altKey||ee.ctrlKey||ee.metaKey||ce||he||fe||Ae||pe||Oe||Fe)return-1;var ze=!Ne&&ee.key.length===1;if(ze){preventDefaultEvent(ee);var He={focusItemAtIndex:se,focusedItemIndex:re,nextChar:ee.key.toLowerCase(),sortedIndexByFirstChar:ae,skipFocus:!1,isItemAtIndexDisabled:le};return matchItem(He,te)}if(!Ne)return-1;ne&&preventDefaultEvent(ee);var We=ne&&isTypingInProgress(te);if(We){var He={focusItemAtIndex:se,focusedItemIndex:re,nextChar:" ",sortedIndexByFirstChar:ae,skipFocus:!1,isItemAtIndexDisabled:le};return matchItem(He,te)}return-1}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function isNumberArray(ie){return ie instanceof Array}var handledModifierKeys=["Alt","Control","Meta","Shift"];function createModifierChecker(ie){var te=new Set(ie?handledModifierKeys.filter(function(ee){return ie.getModifierState(ee)}):[]);return function(ee){return ee.every(function(ne){return te.has(ne)})&&ee.length===te.size}}var MDCListFoundation=function(ie){__extends(te,ie);function te(ee){var ne=ie.call(this,__assign(__assign({},te.defaultAdapter),ee))||this;return ne.wrapFocus=!1,ne.isVertical=!0,ne.isSingleSelectionList=!1,ne.areDisabledItemsFocusable=!0,ne.selectedIndex=numbers$5.UNSET_INDEX,ne.focusedItemIndex=numbers$5.UNSET_INDEX,ne.useActivatedClass=!1,ne.useSelectedAttr=!1,ne.ariaCurrentAttrValue=null,ne.isCheckboxList=!1,ne.isRadioList=!1,ne.lastSelectedIndex=null,ne.hasTypeahead=!1,ne.typeaheadState=initState(),ne.sortedIndexByFirstChar=new Map,ne}return Object.defineProperty(te,"strings",{get:function(){return strings$5},enumerable:!1,configurable:!0}),Object.defineProperty(te,"cssClasses",{get:function(){return cssClasses$4},enumerable:!1,configurable:!0}),Object.defineProperty(te,"numbers",{get:function(){return numbers$5},enumerable:!1,configurable:!0}),Object.defineProperty(te,"defaultAdapter",{get:function(){return{addClassForElementIndex:function(){},focusItemAtIndex:function(){},getAttributeForElementIndex:function(){return null},getFocusedElementIndex:function(){return 0},getListItemCount:function(){return 0},hasCheckboxAtIndex:function(){return!1},hasRadioAtIndex:function(){return!1},isCheckboxCheckedAtIndex:function(){return!1},isFocusInsideList:function(){return!1},isRootFocused:function(){return!1},listItemAtIndexHasClass:function(){return!1},notifyAction:function(){},notifySelectionChange:function(){},removeClassForElementIndex:function(){},setAttributeForElementIndex:function(){},setCheckedCheckboxOrRadioAtIndex:function(){},setTabIndexForListItemChildren:function(){},getPrimaryTextAtIndex:function(){return""}}},enumerable:!1,configurable:!0}),te.prototype.layout=function(){this.adapter.getListItemCount()!==0&&(this.adapter.hasCheckboxAtIndex(0)?this.isCheckboxList=!0:this.adapter.hasRadioAtIndex(0)?this.isRadioList=!0:this.maybeInitializeSingleSelection(),this.hasTypeahead&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex()))},te.prototype.getFocusedItemIndex=function(){return this.focusedItemIndex},te.prototype.setWrapFocus=function(ee){this.wrapFocus=ee},te.prototype.setVerticalOrientation=function(ee){this.isVertical=ee},te.prototype.setSingleSelection=function(ee){this.isSingleSelectionList=ee,ee&&(this.maybeInitializeSingleSelection(),this.selectedIndex=this.getSelectedIndexFromDOM())},te.prototype.setDisabledItemsFocusable=function(ee){this.areDisabledItemsFocusable=ee},te.prototype.maybeInitializeSingleSelection=function(){var ee=this.getSelectedIndexFromDOM();if(ee!==numbers$5.UNSET_INDEX){var ne=this.adapter.listItemAtIndexHasClass(ee,cssClasses$4.LIST_ITEM_ACTIVATED_CLASS);ne&&this.setUseActivatedClass(!0),this.isSingleSelectionList=!0,this.selectedIndex=ee}},te.prototype.getSelectedIndexFromDOM=function(){for(var ee=numbers$5.UNSET_INDEX,ne=this.adapter.getListItemCount(),re=0;re<ne;re++){var se=this.adapter.listItemAtIndexHasClass(re,cssClasses$4.LIST_ITEM_SELECTED_CLASS),ae=this.adapter.listItemAtIndexHasClass(re,cssClasses$4.LIST_ITEM_ACTIVATED_CLASS);if(se||ae){ee=re;break}}return ee},te.prototype.setHasTypeahead=function(ee){this.hasTypeahead=ee,ee&&(this.sortedIndexByFirstChar=this.typeaheadInitSortedIndex())},te.prototype.isTypeaheadInProgress=function(){return this.hasTypeahead&&isTypingInProgress(this.typeaheadState)},te.prototype.setUseActivatedClass=function(ee){this.useActivatedClass=ee},te.prototype.setUseSelectedAttribute=function(ee){this.useSelectedAttr=ee},te.prototype.getSelectedIndex=function(){return this.selectedIndex},te.prototype.setSelectedIndex=function(ee,ne){ne===void 0&&(ne={}),this.isIndexValid(ee)&&(this.isCheckboxList?this.setCheckboxAtIndex(ee,ne):this.isRadioList?this.setRadioAtIndex(ee,ne):this.setSingleSelectionAtIndex(ee,ne))},te.prototype.handleFocusIn=function(ee){ee>=0&&(this.focusedItemIndex=ee,this.adapter.setAttributeForElementIndex(ee,"tabindex","0"),this.adapter.setTabIndexForListItemChildren(ee,"0"))},te.prototype.handleFocusOut=function(ee){var ne=this;ee>=0&&(this.adapter.setAttributeForElementIndex(ee,"tabindex","-1"),this.adapter.setTabIndexForListItemChildren(ee,"-1")),setTimeout(function(){ne.adapter.isFocusInsideList()||ne.setTabindexToFirstSelectedOrFocusedItem()},0)},te.prototype.isIndexDisabled=function(ee){return this.adapter.listItemAtIndexHasClass(ee,cssClasses$4.LIST_ITEM_DISABLED_CLASS)},te.prototype.handleKeydown=function(ee,ne,re){var se=this,ae,le=normalizeKey(ee)==="ArrowLeft",ce=normalizeKey(ee)==="ArrowUp",he=normalizeKey(ee)==="ArrowRight",fe=normalizeKey(ee)==="ArrowDown",Ae=normalizeKey(ee)==="Home",pe=normalizeKey(ee)==="End",Oe=normalizeKey(ee)==="Enter",Fe=normalizeKey(ee)==="Spacebar",Ne=this.isVertical&&fe||!this.isVertical&&he,ze=this.isVertical&&ce||!this.isVertical&&le,He=ee.key==="A"||ee.key==="a",We=createModifierChecker(ee);if(this.adapter.isRootFocused()){if((ze||pe)&&We([]))ee.preventDefault(),this.focusLastElement();else if((Ne||Ae)&&We([]))ee.preventDefault(),this.focusFirstElement();else if(ze&&We(["Shift"])&&this.isCheckboxList){ee.preventDefault();var je=this.focusLastElement();je!==-1&&this.setSelectedIndexOnAction(je,!1)}else if(Ne&&We(["Shift"])&&this.isCheckboxList){ee.preventDefault();var je=this.focusFirstElement();je!==-1&&this.setSelectedIndexOnAction(je,!1)}if(this.hasTypeahead){var Ue={event:ee,focusItemAtIndex:function(Ye){se.focusItemAtIndex(Ye)},focusedItemIndex:-1,isTargetListItem:ne,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(Ye){return se.isIndexDisabled(Ye)}};handleKeydown(Ue,this.typeaheadState)}return}var Ge=this.adapter.getFocusedElementIndex();if(!(Ge===-1&&(Ge=re,Ge<0))){if(Ne&&We([]))preventDefaultEvent(ee),this.focusNextElement(Ge);else if(ze&&We([]))preventDefaultEvent(ee),this.focusPrevElement(Ge);else if(Ne&&We(["Shift"])&&this.isCheckboxList){preventDefaultEvent(ee);var je=this.focusNextElement(Ge);je!==-1&&this.setSelectedIndexOnAction(je,!1)}else if(ze&&We(["Shift"])&&this.isCheckboxList){preventDefaultEvent(ee);var je=this.focusPrevElement(Ge);je!==-1&&this.setSelectedIndexOnAction(je,!1)}else if(Ae&&We([]))preventDefaultEvent(ee),this.focusFirstElement();else if(pe&&We([]))preventDefaultEvent(ee),this.focusLastElement();else if(Ae&&We(["Control","Shift"])&&this.isCheckboxList){if(preventDefaultEvent(ee),this.isIndexDisabled(Ge))return;this.focusFirstElement(),this.toggleCheckboxRange(0,Ge,Ge)}else if(pe&&We(["Control","Shift"])&&this.isCheckboxList){if(preventDefaultEvent(ee),this.isIndexDisabled(Ge))return;this.focusLastElement(),this.toggleCheckboxRange(Ge,this.adapter.getListItemCount()-1,Ge)}else if(He&&We(["Control"])&&this.isCheckboxList)ee.preventDefault(),this.checkboxListToggleAll(this.selectedIndex===numbers$5.UNSET_INDEX?[]:this.selectedIndex,!0);else if((Oe||Fe)&&We([])){if(ne){var Ze=ee.target;if(Ze&&Ze.tagName==="A"&&Oe||(preventDefaultEvent(ee),this.isIndexDisabled(Ge)))return;this.isTypeaheadInProgress()||(this.isSelectableList()&&this.setSelectedIndexOnAction(Ge,!1),this.adapter.notifyAction(Ge))}}else if((Oe||Fe)&&We(["Shift"])&&this.isCheckboxList){var Ze=ee.target;if(Ze&&Ze.tagName==="A"&&Oe||(preventDefaultEvent(ee),this.isIndexDisabled(Ge)))return;this.isTypeaheadInProgress()||(this.toggleCheckboxRange((ae=this.lastSelectedIndex)!==null&&ae!==void 0?ae:Ge,Ge,Ge),this.adapter.notifyAction(Ge))}if(this.hasTypeahead){var Ue={event:ee,focusItemAtIndex:function(qe){se.focusItemAtIndex(qe)},focusedItemIndex:this.focusedItemIndex,isTargetListItem:ne,sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:function(qe){return se.isIndexDisabled(qe)}};handleKeydown(Ue,this.typeaheadState)}}},te.prototype.handleClick=function(ee,ne,re){var se,ae=createModifierChecker(re);ee!==numbers$5.UNSET_INDEX&&(this.isIndexDisabled(ee)||(ae([])?(this.isSelectableList()&&this.setSelectedIndexOnAction(ee,ne),this.adapter.notifyAction(ee)):this.isCheckboxList&&ae(["Shift"])&&(this.toggleCheckboxRange((se=this.lastSelectedIndex)!==null&&se!==void 0?se:ee,ee,ee),this.adapter.notifyAction(ee))))},te.prototype.focusNextElement=function(ee){var ne=this.adapter.getListItemCount(),re=ee,se=null;do{if(re++,re>=ne)if(this.wrapFocus)re=0;else return ee;if(re===se)return-1;se=se??re}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(re));return this.focusItemAtIndex(re),re},te.prototype.focusPrevElement=function(ee){var ne=this.adapter.getListItemCount(),re=ee,se=null;do{if(re--,re<0)if(this.wrapFocus)re=ne-1;else return ee;if(re===se)return-1;se=se??re}while(!this.areDisabledItemsFocusable&&this.isIndexDisabled(re));return this.focusItemAtIndex(re),re},te.prototype.focusFirstElement=function(){return this.focusNextElement(-1)},te.prototype.focusLastElement=function(){return this.focusPrevElement(this.adapter.getListItemCount())},te.prototype.focusInitialElement=function(){var ee=this.getFirstSelectedOrFocusedItemIndex();return this.focusItemAtIndex(ee),ee},te.prototype.setEnabled=function(ee,ne){this.isIndexValid(ee,!1)&&(ne?(this.adapter.removeClassForElementIndex(ee,cssClasses$4.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(ee,strings$5.ARIA_DISABLED,"false")):(this.adapter.addClassForElementIndex(ee,cssClasses$4.LIST_ITEM_DISABLED_CLASS),this.adapter.setAttributeForElementIndex(ee,strings$5.ARIA_DISABLED,"true")))},te.prototype.setSingleSelectionAtIndex=function(ee,ne){if(ne===void 0&&(ne={}),!(this.selectedIndex===ee&&!ne.forceUpdate)){var re=cssClasses$4.LIST_ITEM_SELECTED_CLASS;this.useActivatedClass&&(re=cssClasses$4.LIST_ITEM_ACTIVATED_CLASS),this.selectedIndex!==numbers$5.UNSET_INDEX&&this.adapter.removeClassForElementIndex(this.selectedIndex,re),this.setAriaForSingleSelectionAtIndex(ee),this.setTabindexAtIndex(ee),ee!==numbers$5.UNSET_INDEX&&this.adapter.addClassForElementIndex(ee,re),this.selectedIndex=ee,ne.isUserInteraction&&!ne.forceUpdate&&this.adapter.notifySelectionChange([ee])}},te.prototype.setAriaForSingleSelectionAtIndex=function(ee){this.selectedIndex===numbers$5.UNSET_INDEX&&(this.ariaCurrentAttrValue=this.adapter.getAttributeForElementIndex(ee,strings$5.ARIA_CURRENT));var ne=this.ariaCurrentAttrValue!==null,re=ne?strings$5.ARIA_CURRENT:strings$5.ARIA_SELECTED;if(this.selectedIndex!==numbers$5.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,re,"false"),ee!==numbers$5.UNSET_INDEX){var se=ne?this.ariaCurrentAttrValue:"true";this.adapter.setAttributeForElementIndex(ee,re,se)}},te.prototype.getSelectionAttribute=function(){return this.useSelectedAttr?strings$5.ARIA_SELECTED:strings$5.ARIA_CHECKED},te.prototype.setRadioAtIndex=function(ee,ne){ne===void 0&&(ne={});var re=this.getSelectionAttribute();this.adapter.setCheckedCheckboxOrRadioAtIndex(ee,!0),!(this.selectedIndex===ee&&!ne.forceUpdate)&&(this.selectedIndex!==numbers$5.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex,re,"false"),this.adapter.setAttributeForElementIndex(ee,re,"true"),this.selectedIndex=ee,ne.isUserInteraction&&!ne.forceUpdate&&this.adapter.notifySelectionChange([ee]))},te.prototype.setCheckboxAtIndex=function(ee,ne){ne===void 0&&(ne={});for(var re=this.selectedIndex,se=ne.isUserInteraction?new Set(re===numbers$5.UNSET_INDEX?[]:re):null,ae=this.getSelectionAttribute(),le=[],ce=0;ce<this.adapter.getListItemCount();ce++){var he=se==null?void 0:se.has(ce),fe=ee.indexOf(ce)>=0;fe!==he&&le.push(ce),this.adapter.setCheckedCheckboxOrRadioAtIndex(ce,fe),this.adapter.setAttributeForElementIndex(ce,ae,fe?"true":"false")}this.selectedIndex=ee,ne.isUserInteraction&&le.length&&this.adapter.notifySelectionChange(le)},te.prototype.toggleCheckboxRange=function(ee,ne,re){this.lastSelectedIndex=re;for(var se=new Set(this.selectedIndex===numbers$5.UNSET_INDEX?[]:this.selectedIndex),ae=!(se!=null&&se.has(re)),le=__read([ee,ne].sort(),2),ce=le[0],he=le[1],fe=this.getSelectionAttribute(),Ae=[],pe=ce;pe<=he;pe++)if(!this.isIndexDisabled(pe)){var Oe=se.has(pe);ae!==Oe&&(Ae.push(pe),this.adapter.setCheckedCheckboxOrRadioAtIndex(pe,ae),this.adapter.setAttributeForElementIndex(pe,fe,""+ae),ae?se.add(pe):se.delete(pe))}Ae.length&&(this.selectedIndex=__spreadArray([],__read(se)),this.adapter.notifySelectionChange(Ae))},te.prototype.setTabindexAtIndex=function(ee){this.focusedItemIndex===numbers$5.UNSET_INDEX&&ee!==0?this.adapter.setAttributeForElementIndex(0,"tabindex","-1"):this.focusedItemIndex>=0&&this.focusedItemIndex!==ee&&this.adapter.setAttributeForElementIndex(this.focusedItemIndex,"tabindex","-1"),!(this.selectedIndex instanceof Array)&&this.selectedIndex!==ee&&this.adapter.setAttributeForElementIndex(this.selectedIndex,"tabindex","-1"),ee!==numbers$5.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(ee,"tabindex","0")},te.prototype.isSelectableList=function(){return this.isSingleSelectionList||this.isCheckboxList||this.isRadioList},te.prototype.setTabindexToFirstSelectedOrFocusedItem=function(){var ee=this.getFirstSelectedOrFocusedItemIndex();this.setTabindexAtIndex(ee)},te.prototype.getFirstSelectedOrFocusedItemIndex=function(){return this.isSelectableList()?typeof this.selectedIndex=="number"&&this.selectedIndex!==numbers$5.UNSET_INDEX?this.selectedIndex:isNumberArray(this.selectedIndex)&&this.selectedIndex.length>0?this.selectedIndex.reduce(function(ee,ne){return Math.min(ee,ne)}):0:Math.max(this.focusedItemIndex,0)},te.prototype.isIndexValid=function(ee,ne){var re=this;if(ne===void 0&&(ne=!0),ee instanceof Array){if(!this.isCheckboxList&&ne)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");return ee.length===0?!0:ee.some(function(se){return re.isIndexInRange(se)})}else if(typeof ee=="number"){if(this.isCheckboxList&&ne)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+ee);return this.isIndexInRange(ee)||this.isSingleSelectionList&&ee===numbers$5.UNSET_INDEX}else return!1},te.prototype.isIndexInRange=function(ee){var ne=this.adapter.getListItemCount();return ee>=0&&ee<ne},te.prototype.setSelectedIndexOnAction=function(ee,ne){this.lastSelectedIndex=ee,this.isCheckboxList?(this.toggleCheckboxAtIndex(ee,ne),this.adapter.notifySelectionChange([ee])):this.setSelectedIndex(ee,{isUserInteraction:!0})},te.prototype.toggleCheckboxAtIndex=function(ee,ne){var re=this.getSelectionAttribute(),se=this.adapter.isCheckboxCheckedAtIndex(ee),ae;ne?ae=se:(ae=!se,this.adapter.setCheckedCheckboxOrRadioAtIndex(ee,ae)),this.adapter.setAttributeForElementIndex(ee,re,ae?"true":"false");var le=this.selectedIndex===numbers$5.UNSET_INDEX?[]:this.selectedIndex.slice();ae?le.push(ee):le=le.filter(function(ce){return ce!==ee}),this.selectedIndex=le},te.prototype.focusItemAtIndex=function(ee){this.adapter.focusItemAtIndex(ee),this.focusedItemIndex=ee},te.prototype.checkboxListToggleAll=function(ee,ne){var re=this.adapter.getListItemCount();if(ee.length===re)this.setCheckboxAtIndex([],{isUserInteraction:ne});else{for(var se=[],ae=0;ae<re;ae++)(!this.isIndexDisabled(ae)||ee.indexOf(ae)>-1)&&se.push(ae);this.setCheckboxAtIndex(se,{isUserInteraction:ne})}},te.prototype.typeaheadMatchItem=function(ee,ne,re){var se=this;re===void 0&&(re=!1);var ae={focusItemAtIndex:function(le){se.focusItemAtIndex(le)},focusedItemIndex:ne||this.focusedItemIndex,nextChar:ee,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:re,isItemAtIndexDisabled:function(le){return se.isIndexDisabled(le)}};return matchItem(ae,this.typeaheadState)},te.prototype.typeaheadInitSortedIndex=function(){return initSortedIndex(this.adapter.getListItemCount(),this.adapter.getPrimaryTextAtIndex)},te.prototype.clearTypeaheadBuffer=function(){clearBuffer(this.typeaheadState)},te}(MDCFoundation);function classMap(ie){return Object.entries(ie).filter(([te,ee])=>te!==""&&ee).map(([te])=>te).join(" ")}function dispatch(ie,te,ee,ne={bubbles:!0}){if(typeof Event>"u")throw new Error("Event not defined.");if(!ie)throw new Error("Tried to dispatch event without element.");const re=new CustomEvent(te,Object.assign(Object.assign({},ne),{detail:ee}));return ie==null||ie.dispatchEvent(re),re}function exclude(ie,te){let ee=Object.getOwnPropertyNames(ie);const ne={};for(let re=0;re<ee.length;re++){const se=ee[re],ae=se.indexOf("$");ae!==-1&&te.indexOf(se.substring(0,ae+1))!==-1||te.indexOf(se)===-1&&(ne[se]=ie[se])}return ne}function prefixFilter(ie,te){let ee=Object.getOwnPropertyNames(ie);const ne={};for(let re=0;re<ee.length;re++){const se=ee[re];se.substring(0,te.length)===te&&(ne[se.substring(te.length)]=ie[se])}return ne}class SvelteEventManager{constructor(){this.elementMap=new Map}on(te,ee,ne,re){this.elementMap.has(te)||this.elementMap.set(te,{});const se=this.elementMap.get(te);if(se==null)throw new Error("Event map couldn't be created.");ee in se||(se[ee]=new Map),se[ee].set(ne,on$1(te,ee,ne,re))}off(te,ee,ne){const re=this.elementMap.get(te);if(re==null||!(ee in re))return;const se=re[ee],ae=se.get(ne);ae!=null&&(ae(),se.delete(ne),se.size===0&&(delete re[ee],Object.keys(re).length===0&&this.elementMap.delete(te)))}clear(){this.elementMap.forEach((te,ee)=>{for(let[ne,re]of Object.entries(te))re.forEach((se,ae)=>{se()})}),this.elementMap.clear()}}function useActions(ie,te){let ee=[];if(te)for(let ne=0;ne<te.length;ne++){const re=te[ne],se=Array.isArray(re)?re[0]:re;Array.isArray(re)&&re.length>1?ee.push(se(ie,re[1])):ee.push(se(ie))}return{update(ne){if((ne&&ne.length||0)!=ee.length)throw new Error("You must not change the length of an actions array.");if(ne)for(let re=0;re<ne.length;re++){const se=ee[re];if(se&&se.update){const ae=ne[re];Array.isArray(ae)&&ae.length>1?se.update(ae[1]):se.update()}}},destroy(){for(let ne=0;ne<ee.length;ne++){const re=ee[ne];re&&re.destroy&&re.destroy()}}}}var root_1$w=from_svg("<svg><!></svg>");function SmuiElement(ie,te){push(te,!0);let ee=prop(te,"use",19,()=>[]),ne=prop(te,"tag",3,"div"),re=rest_props(te,["$$slots","$$events","$$legacy","use","tag","children"]);const se=user_derived(()=>["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(ne())>-1);let ae;function le(){return ae}var ce=comment(),he=first_child(ce);{var fe=pe=>{var Oe=root_1$w();attribute_effect(Oe,()=>({...re}));var Fe=child(Oe);snippet(Fe,()=>te.children??noop$1),bind_this(Oe,Ne=>ae=Ne,()=>ae),action(Oe,(Ne,ze)=>useActions==null?void 0:useActions(Ne,ze),ee),append(pe,Oe)},Ae=pe=>{var Oe=comment(),Fe=first_child(Oe);{var Ne=He=>{var We=comment(),je=first_child(We);element(je,ne,!1,(Ue,Ge)=>{bind_this(Ue,Ze=>ae=Ze,()=>ae),action(Ue,(Ze,Ye)=>useActions==null?void 0:useActions(Ze,Ye),ee),attribute_effect(Ue,()=>({...re}))}),append(He,We)},ze=He=>{var We=comment(),je=first_child(We);element(je,ne,!1,(Ue,Ge)=>{bind_this(Ue,qe=>ae=qe,()=>ae),action(Ue,(qe,nr)=>useActions==null?void 0:useActions(qe,nr),ee),attribute_effect(Ue,()=>({...re}));var Ze=comment(),Ye=first_child(Ze);snippet(Ye,()=>te.children??noop$1),append(Ge,Ze)}),append(He,We)};if_block(Fe,He=>{get$2(se)?He(Ne):He(ze,!1)},!0)}append(pe,Oe)};if_block(he,pe=>{ne()==="svg"?pe(fe):pe(Ae,!1)})}return append(ie,ce),pop({getElement:le})}function List(ie,te){push(te,!0);const{closest:ee,matches:ne}=ponyfill;let re=getContext("SMUI:list:nav"),se=prop(te,"use",19,()=>[]),ae=prop(te,"class",3,""),le=prop(te,"nonInteractive",3,!1),ce=prop(te,"dense",3,!1),he=prop(te,"textualList",3,!1),fe=prop(te,"avatarList",3,!1),Ae=prop(te,"iconList",3,!1),pe=prop(te,"imageList",3,!1),Oe=prop(te,"thumbnailList",3,!1),Fe=prop(te,"videoList",3,!1),Ne=prop(te,"twoLine",3,!1),ze=prop(te,"threeLine",3,!1),He=prop(te,"vertical",3,!0),We=prop(te,"wrapFocus",19,()=>getContext("SMUI:list:wrapFocus")??!1),je=prop(te,"singleSelection",3,!1),Ue=prop(te,"disabledItemsFocusable",3,!1),Ge=prop(te,"selectedIndex",31,()=>-1),Ze=prop(te,"radioList",3,!1),Ye=prop(te,"checkList",3,!1),qe=prop(te,"hasTypeahead",3,!1),nr=prop(te,"component",3,SmuiElement),ir=prop(te,"tag",3,re?"nav":"ul"),tr=rest_props(te,["$$slots","$$events","$$legacy","use","class","nonInteractive","dense","textualList","avatarList","iconList","imageList","thumbnailList","videoList","twoLine","threeLine","vertical","wrapFocus","singleSelection","disabledItemsFocusable","selectedIndex","radioList","checkList","hasTypeahead","component","tag","children"]),or,Jt=state(void 0),rr=[],lr=getContext("SMUI:list:role");const ur=new WeakMap;let Sr=getContext("SMUI:dialog:selection"),xr=getContext("SMUI:addLayoutListener"),Pr;setContext("SMUI:list:nonInteractive",le()),setContext("SMUI:separator:context","list"),lr||(je()?(lr="listbox",setContext("SMUI:list:item:role","option")):Ze()?(lr="radiogroup",setContext("SMUI:list:item:role","radio")):Ye()?(lr="group",setContext("SMUI:list:item:role","checkbox")):(lr="list",setContext("SMUI:list:item:role",void 0))),user_effect(()=>{get$2(Jt)&&get$2(Jt).setVerticalOrientation(He())}),user_effect(()=>{get$2(Jt)&&get$2(Jt).setWrapFocus(We())}),user_effect(()=>{get$2(Jt)&&get$2(Jt).setHasTypeahead(qe())}),user_effect(()=>{get$2(Jt)&&get$2(Jt).setSingleSelection(je())}),user_effect(()=>{get$2(Jt)&&get$2(Jt).setDisabledItemsFocusable(Ue())}),user_effect(()=>{get$2(Jt)&&je()&&Br()!==Ge()&&get$2(Jt).setSelectedIndex(Ge())}),xr&&(Pr=xr(Lo)),setContext("SMUI:list:item:mount",Rr=>{rr.push(Rr),ur.set(Rr.element,Rr),je()&&Rr.selected&&Ge(ho(Rr.element))}),setContext("SMUI:list:item:unmount",Rr=>{const fr=(Rr&&rr.findIndex(er=>er===Rr))??-1;fr!==-1&&(rr.splice(fr,1),ur.delete(Rr.element))});const mr=getContext("SMUI:list:mount"),Er=getContext("SMUI:list:unmount");onMount(()=>{set(Jt,new MDCListFoundation({addClassForElementIndex:Ur,focusItemAtIndex:Yr,getAttributeForElementIndex:(fr,er)=>{var Tr;return((Tr=wr()[fr])==null?void 0:Tr.getAttr(er))??null},getFocusedElementIndex:()=>document.activeElement?wr().map(fr=>fr.element).indexOf(document.activeElement):-1,getListItemCount:()=>rr.length,getPrimaryTextAtIndex:so,hasCheckboxAtIndex:fr=>{var er;return((er=wr()[fr])==null?void 0:er.hasCheckbox)??!1},hasRadioAtIndex:fr=>{var er;return((er=wr()[fr])==null?void 0:er.hasRadio)??!1},isCheckboxCheckedAtIndex:fr=>{const er=wr()[fr];return((er==null?void 0:er.hasCheckbox)&&er.checked)??!1},isFocusInsideList:()=>or!=null&&Zr()!==document.activeElement&&Zr().contains(document.activeElement),isRootFocused:()=>or!=null&&document.activeElement===Zr(),listItemAtIndexHasClass:Dr,notifyAction:fr=>{Ge(fr),or!=null&&dispatch(Zr(),"SMUIListAction",{index:fr})},notifySelectionChange:fr=>{or!=null&&dispatch(Zr(),"SMUIListSelectionChange",{changedIndices:fr})},removeClassForElementIndex:zr,setAttributeForElementIndex:Fr,setCheckedCheckboxOrRadioAtIndex:(fr,er)=>{wr()[fr].checked=er},setTabIndexForListItemChildren:(fr,er)=>{const Tr=wr()[fr];Array.prototype.forEach.call(Tr.element.querySelectorAll("button:not(:disabled), a"),Fo=>{Fo.setAttribute("tabindex",er)})}}),!0);const Rr={get element(){return Zr()},get items(){return rr},get typeaheadInProgress(){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).isTypeaheadInProgress()},typeaheadMatchItem(fr,er){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).typeaheadMatchItem(fr,er,!0)},getOrderedList:wr,focusItemAtIndex:Yr,addClassForElementIndex:Ur,removeClassForElementIndex:zr,setAttributeForElementIndex:Fr,removeAttributeForElementIndex:Jr,getAttributeFromElementIndex:po,getPrimaryTextAtIndex:so};return mr==null||mr(Rr),get$2(Jt).init(),get$2(Jt).layout(),()=>{var fr;Er==null||Er(Rr),(fr=get$2(Jt))==null||fr.destroy()}}),onDestroy(()=>{Pr&&Pr()});function dr(Rr){get$2(Jt)&&Rr.target&&get$2(Jt).handleKeydown(Rr,Rr.target.classList.contains("mdc-deprecated-list-item"),ho(Rr.target))}function Cr(Rr){get$2(Jt)&&Rr.target&&get$2(Jt).handleFocusIn(ho(Rr.target))}function Or(Rr){get$2(Jt)&&Rr.target&&get$2(Jt).handleFocusOut(ho(Rr.target))}function Ar(Rr){get$2(Jt)&&Rr.target&&get$2(Jt).handleClick(ho(Rr.target),!ne(Rr.target,'input[type="checkbox"], input[type="radio"]'),Rr)}function Ir(Rr){if(Ze()||Ye()){const fr=ho(Rr.target);if(fr!==-1){const er=wr()[fr];er&&(Ze()&&!er.checked||Ye())&&(ne(Rr.detail.target,'input[type="checkbox"], input[type="radio"]')||(er.checked=!er.checked),er.activateRipple(),window.requestAnimationFrame(()=>{er.deactivateRipple()}))}}}function wr(){return or==null?[]:[...Zr().querySelectorAll(".mdc-deprecated-list-item")].map(Rr=>ur.get(Rr)).filter(Rr=>Rr&&Rr._smui_list_item_accessor)}function Dr(Rr,fr){const er=wr()[Rr];return(er&&er.hasClass(fr))??!1}function Ur(Rr,fr){const er=wr()[Rr];er==null||er.addClass(fr)}function zr(Rr,fr){const er=wr()[Rr];er==null||er.removeClass(fr)}function Fr(Rr,fr,er){const Tr=wr()[Rr];Tr==null||Tr.addAttr(fr,er)}function Jr(Rr,fr){const er=wr()[Rr];er==null||er.removeAttr(fr)}function po(Rr,fr){const er=wr()[Rr];return er?er.getAttr(fr):null}function so(Rr){const fr=wr()[Rr];return(fr&&fr.getPrimaryText())??""}function ho(Rr){const fr=ee(Rr,".mdc-deprecated-list-item, .mdc-deprecated-list");return fr&&ne(fr,".mdc-deprecated-list-item")?wr().map(er=>er==null?void 0:er.element).indexOf(fr):-1}function Lo(){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).layout()}function bo(Rr,fr){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).setEnabled(Rr,fr)}function Uo(){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).isTypeaheadInProgress()}function Br(){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).getSelectedIndex()}function Vr(){if(!get$2(Jt))throw new Error("Instance is undefined.");return get$2(Jt).getFocusedItemIndex()}function Yr(Rr){const fr=wr()[Rr];fr&&"focus"in fr.element&&fr.element.focus()}function Zr(){return or.getElement()}var uo=comment(),ro=first_child(uo);{let Rr=user_derived(()=>classMap({[ae()]:!0,"mdc-deprecated-list":!0,"mdc-deprecated-list--non-interactive":le(),"mdc-deprecated-list--dense":ce(),"mdc-deprecated-list--textual-list":he(),"mdc-deprecated-list--avatar-list":fe()||Sr,"mdc-deprecated-list--icon-list":Ae(),"mdc-deprecated-list--image-list":pe(),"mdc-deprecated-list--thumbnail-list":Oe(),"mdc-deprecated-list--video-list":Fe(),"mdc-deprecated-list--two-line":Ne(),"smui-list--three-line":ze()&&!Ne()}));component(ro,nr,(fr,er)=>{bind_this(er(fr,spread_props({get tag(){return ir()},get use(){return se()},get class(){return get$2(Rr)},get role(){return lr}},()=>tr,{onkeydown:Tr=>{var to;dr(Tr),(to=te.onkeydown)==null||to.call(te,Tr)},onfocusin:Tr=>{var to;Cr(Tr),(to=te.onfocusin)==null||to.call(te,Tr)},onfocusout:Tr=>{var to;Or(Tr),(to=te.onfocusout)==null||to.call(te,Tr)},onclick:Tr=>{var to;Ar(Tr),(to=te.onclick)==null||to.call(te,Tr)},onSMUIAction:Tr=>{var to;Ir(Tr),(to=te.onSMUIAction)==null||to.call(te,Tr)},children:(Tr,to)=>{var Fo=comment(),Sa=first_child(Fo);snippet(Sa,()=>te.children??noop$1),append(Tr,Fo)},$$slots:{default:!0}})),Tr=>or=Tr,()=>or)})}return append(ie,uo),pop({layout:Lo,setEnabled:bo,getTypeaheadInProgress:Uo,getSelectedIndex:Br,getFocusedItemIndex:Vr,focusItemAtIndex:Yr,getElement:Zr})}let counter$2=0;function Item(ie,te){push(te,!0);let ee=()=>{};function ne(Ar){return Ar===ee}let re=getContext("SMUI:list:item:nav"),se=prop(te,"class",3,""),ae=prop(te,"style",3,""),le=prop(te,"nonInteractive",19,()=>getContext("SMUI:list:nonInteractive")??!1),ce=prop(te,"wrapper",3,!1),he=prop(te,"activated",15,!1),fe=prop(te,"role",19,()=>ce()?"presentation":getContext("SMUI:list:item:role")),Ae=prop(te,"selected",15,!1),pe=prop(te,"disabled",3,!1),Oe=prop(te,"skipRestoreFocus",3,!1),Fe=prop(te,"tabindex",15,ee),Ne=prop(te,"inputId",19,()=>"SMUI-form-field-list-"+counter$2++),ze=prop(te,"component",3,SmuiElement),He=prop(te,"tag",19,()=>re?te.href?"a":"span":"li"),We=rest_props(te,["$$slots","$$events","$$legacy","class","style","nonInteractive","wrapper","activated","role","selected","disabled","skipRestoreFocus","tabindex","inputId","href","component","tag","children"]);setContext("SMUI:list:nonInteractive",void 0),setContext("SMUI:list:item:role",void 0);let je,Ue=proxy({}),Ge=proxy({}),Ze=proxy({}),Ye=state(void 0),qe=state(void 0);const nr=user_derived(()=>ne(Fe())?!le()&&!pe()&&(Ae()||get$2(Ye)&&get$2(Ye).checked)?0:-1:Fe());setContext("SMUI:generic:input:props",{id:Ne()}),setContext("SMUI:separator:context",void 0),setContext("SMUI:generic:input:mount",Ar=>{("_smui_checkbox_accessor"in Ar||"_smui_radio_accessor"in Ar)&&set(Ye,Ar,!0)}),setContext("SMUI:generic:input:unmount",()=>{set(Ye,void 0)});const ir=getContext("SMUI:list:item:mount"),tr=getContext("SMUI:list:item:unmount");onMount(()=>{if(!Ae()&&!le()){let Ir=!0,wr=je.getElement();for(;wr.previousElementSibling;)if(wr=wr.previousElementSibling,wr.nodeType===1&&wr.classList.contains("mdc-deprecated-list-item")&&!wr.classList.contains("mdc-deprecated-list-item--disabled")){Ir=!1;break}Ir&&set(qe,window.requestAnimationFrame(()=>xr(wr)),!0)}const Ar={_smui_list_item_accessor:!0,get element(){return dr()},get selected(){return Ae()},set selected(Ir){Ae(Ir)},hasClass:or,addClass:Jt,removeClass:rr,getAttr:lr,addAttr:ur,removeAttr:Sr,getPrimaryText:Er,get checked(){return(get$2(Ye)&&get$2(Ye).checked)??!1},set checked(Ir){get$2(Ye)&&(get$2(Ye).checked=!!Ir)},get hasCheckbox(){return!!(get$2(Ye)&&"_smui_checkbox_accessor"in get$2(Ye))},get hasRadio(){return!!(get$2(Ye)&&"_smui_radio_accessor"in get$2(Ye))},activateRipple(){},deactivateRipple(){},getValue(){return te.value},action:mr,get tabindex(){return get$2(nr)},set tabindex(Ir){Fe(Ir)},get disabled(){return pe()},get activated(){return he()},set activated(Ir){he(Ir)}};return ir==null||ir(Ar),()=>{tr==null||tr(Ar)}}),onDestroy(()=>{get$2(qe)&&window.cancelAnimationFrame(get$2(qe))});function or(Ar){return Ar in Ue?Ue[Ar]:dr().classList.contains(Ar)}function Jt(Ar){Ue[Ar]||(Ue[Ar]=!0)}function rr(Ar){(!(Ar in Ue)||Ue[Ar])&&(Ue[Ar]=!1)}function lr(Ar){return Ar in Ze?Ze[Ar]??null:dr().getAttribute(Ar)}function ur(Ar,Ir){Ze[Ar]!==Ir&&(Ze[Ar]=Ir)}function Sr(Ar){(!(Ar in Ze)||Ze[Ar]!=null)&&(Ze[Ar]=void 0)}function xr(Ar){let Ir=!0;for(;Ar.nextElementSibling;)if(Ar=Ar.nextElementSibling,Ar.nodeType===1&&Ar.classList.contains("mdc-deprecated-list-item")){const wr=Ar.attributes.getNamedItem("tabindex");if(wr&&wr.value==="0"){Ir=!1;break}}Ir&&Fe(0)}function Pr(Ar){const Ir=Ar.key==="Enter",wr=Ar.key==="Space";(Ir||wr)&&mr(Ar)}function mr(Ar){pe()||dispatch(dr(),"SMUIAction",Ar)}function Er(){const Ar=dr(),Ir=Ar.querySelector(".mdc-deprecated-list-item__primary-text");if(Ir)return Ir.textContent??"";const wr=Ar.querySelector(".mdc-deprecated-list-item__text");return wr?wr.textContent??"":Ar.textContent??""}function dr(){return je.getElement()}var Cr=comment(),Or=first_child(Cr);{let Ar=user_derived(()=>classMap({[se()]:!0,"mdc-deprecated-list-item":!ce(),"mdc-deprecated-list-item__wrapper":ce(),"mdc-deprecated-list-item--activated":he(),"mdc-deprecated-list-item--selected":Ae(),"mdc-deprecated-list-item--disabled":pe(),"mdc-menu-item--selected":!re&&fe()==="menuitem"&&Ae(),"smui-menu-item--non-interactive":le(),...Ue})),Ir=user_derived(()=>Object.entries(Ge).map(([Dr,Ur])=>`${Dr}: ${Ur};`).concat([ae()]).join(" ")),wr=user_derived(()=>Oe()||void 0);component(Or,ze,(Dr,Ur)=>{bind_this(Ur(Dr,spread_props({get tag(){return He()},get class(){return get$2(Ar)},get style(){return get$2(Ir)}},()=>re&&he()?{"aria-current":"page"}:{},()=>!re||ce()?{role:fe()}:{},()=>!re&&fe()==="option"?{"aria-selected":Ae()?"true":"false"}:{},()=>!re&&(fe()==="radio"||fe()==="checkbox")?{"aria-checked":get$2(Ye)&&get$2(Ye).checked?"true":"false"}:{},()=>re?{}:{"aria-disabled":pe()?"true":"false"},{get"data-menu-item-skip-restore-focus"(){return get$2(wr)},get tabindex(){return get$2(nr)},get href(){return te.href}},()=>Ze,()=>We,{onclick:zr=>{var Fr;mr(zr),(Fr=te.onclick)==null||Fr.call(te,zr)},onkeydown:zr=>{var Fr;Pr(zr),(Fr=te.onkeydown)==null||Fr.call(te,zr)},children:(zr,Fr)=>{var Jr=comment(),po=first_child(Jr);snippet(po,()=>te.children??noop$1),append(zr,Jr)},$$slots:{default:!0}})),zr=>je=zr,()=>je)})}return append(ie,Cr),pop({action:mr,getPrimaryText:Er,getElement:dr})}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */const cssClasses$3={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},strings$4={CLOSED_EVENT:"MDCMenuSurface:closed",CLOSING_EVENT:"MDCMenuSurface:closing",OPENED_EVENT:"MDCMenuSurface:opened",OPENING_EVENT:"MDCMenuSurface:opening",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},numbers$4={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67,TOUCH_EVENT_WAIT_MS:30};var CornerBit=(ie=>(ie[ie.BOTTOM=1]="BOTTOM",ie[ie.CENTER=2]="CENTER",ie[ie.RIGHT=4]="RIGHT",ie[ie.FLIP_RTL=8]="FLIP_RTL",ie))(CornerBit||{}),Corner=(ie=>(ie[ie.TOP_LEFT=0]="TOP_LEFT",ie[ie.TOP_RIGHT=4]="TOP_RIGHT",ie[ie.BOTTOM_LEFT=1]="BOTTOM_LEFT",ie[ie.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",ie[ie.TOP_START=8]="TOP_START",ie[ie.TOP_END=12]="TOP_END",ie[ie.BOTTOM_START=9]="BOTTOM_START",ie[ie.BOTTOM_END=13]="BOTTOM_END",ie))(Corner||{});/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var cssPropertyNameMap={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}};function isWindow(ie){return!!ie.document&&typeof ie.document.createElement=="function"}function getCorrectPropertyName(ie,te){if(isWindow(ie)&&te in cssPropertyNameMap){var ee=ie.document.createElement("div"),ne=cssPropertyNameMap[te],re=ne.standard,se=ne.prefixed,ae=re in ee.style;return ae?re:se}return te}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */class MDCMenuSurfaceFoundation extends MDCFoundation{constructor(te){super({...MDCMenuSurfaceFoundation.defaultAdapter,...te}),this.isSurfaceOpen=!1,this.isQuickOpen=!1,this.isHoistedElement=!1,this.isFixedPosition=!1,this.isHorizontallyCenteredOnViewport=!1,this.maxHeight=0,this.openBottomBias=0,this.openAnimationEndTimerId=0,this.closeAnimationEndTimerId=0,this.animationRequestId=0,this.anchorCorner=Corner.TOP_START,this.originCorner=Corner.TOP_START,this.anchorMargin={top:0,right:0,bottom:0,left:0},this.position={x:0,y:0}}static get cssClasses(){return cssClasses$3}static get strings(){return strings$4}static get numbers(){return numbers$4}static get Corner(){return Corner}static get defaultAdapter(){return{addClass:()=>{},removeClass:()=>{},hasClass:()=>!1,hasAnchor:()=>!1,isElementInContainer:()=>!1,isFocused:()=>!1,isRtl:()=>!1,getInnerDimensions:()=>({height:0,width:0}),getAnchorDimensions:()=>null,getViewportDimensions:()=>({height:0,width:0}),getBodyDimensions:()=>({height:0,width:0}),getWindowScroll:()=>({x:0,y:0}),setPosition:()=>{},setMaxHeight:()=>{},setTransformOrigin:()=>{},saveFocus:()=>{},restoreFocus:()=>{},notifyClose:()=>{},notifyClosing:()=>{},notifyOpen:()=>{},notifyOpening:()=>{},registerWindowEventHandler:()=>{},deregisterWindowEventHandler:()=>{}}}init(){const{ROOT:te,OPEN:ee}=MDCMenuSurfaceFoundation.cssClasses;if(!this.adapter.hasClass(te))throw new Error(`${te} class required in root element.`);this.adapter.hasClass(ee)&&(this.isSurfaceOpen=!0),this.resizeListener=this.handleResize.bind(this),this.adapter.registerWindowEventHandler("resize",this.resizeListener)}destroy(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId),this.adapter.deregisterWindowEventHandler("resize",this.resizeListener)}setAnchorCorner(te){this.anchorCorner=te}flipCornerHorizontally(){this.originCorner=this.originCorner^CornerBit.RIGHT}setAnchorMargin(te){this.anchorMargin.top=te.top||0,this.anchorMargin.right=te.right||0,this.anchorMargin.bottom=te.bottom||0,this.anchorMargin.left=te.left||0}setIsHoisted(te){this.isHoistedElement=te}setFixedPosition(te){this.isFixedPosition=te}isFixed(){return this.isFixedPosition}setAbsolutePosition(te,ee){this.position.x=this.isFinite(te)?te:0,this.position.y=this.isFinite(ee)?ee:0}setIsHorizontallyCenteredOnViewport(te){this.isHorizontallyCenteredOnViewport=te}setQuickOpen(te){this.isQuickOpen=te}setMaxHeight(te){this.maxHeight=te}setOpenBottomBias(te){this.openBottomBias=te}isOpen(){return this.isSurfaceOpen}open(){this.isSurfaceOpen||(this.adapter.notifyOpening(),this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame(()=>{this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.OPEN),this.openAnimationEndTimerId=setTimeout(()=>{this.openAnimationEndTimerId=0,this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_OPEN),this.adapter.notifyOpen()},numbers$4.TRANSITION_OPEN_DURATION)}),this.isSurfaceOpen=!0),this.adapter.registerWindowEventHandler("resize",this.resizeListener))}close(te=!1){if(this.isSurfaceOpen){if(this.adapter.notifyClosing(),this.adapter.deregisterWindowEventHandler("resize",this.resizeListener),this.isQuickOpen){this.isSurfaceOpen=!1,te||this.maybeRestoreFocus(),this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.OPEN),this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose();return}this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_CLOSED),requestAnimationFrame(()=>{this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.OPEN),this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.IS_OPEN_BELOW),this.closeAnimationEndTimerId=setTimeout(()=>{this.closeAnimationEndTimerId=0,this.adapter.removeClass(MDCMenuSurfaceFoundation.cssClasses.ANIMATING_CLOSED),this.adapter.notifyClose()},numbers$4.TRANSITION_CLOSE_DURATION)}),this.isSurfaceOpen=!1,te||this.maybeRestoreFocus()}}handleBodyClick(te){const ee=te.target;this.adapter.isElementInContainer(ee)||this.close()}handleKeydown(te){const{keyCode:ee,key:ne}=te;(ne==="Escape"||ee===27)&&this.close()}handleResize(){this.dimensions=this.adapter.getInnerDimensions(),this.autoposition()}autoposition(){this.measurements=this.getAutoLayoutmeasurements();const te=this.getoriginCorner(),ee=this.getMenuSurfaceMaxHeight(te),ne=this.hasBit(te,CornerBit.BOTTOM)?"bottom":"top";let re=this.hasBit(te,CornerBit.RIGHT)?"right":"left";const se=this.getHorizontalOriginOffset(te),ae=this.getVerticalOriginOffset(te),{anchorSize:le,surfaceSize:ce}=this.measurements,he={[re]:se,[ne]:ae};le.width/ce.width>numbers$4.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(re="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(he),this.adapter.setTransformOrigin(`${re} ${ne}`),this.adapter.setPosition(he),this.adapter.setMaxHeight(ee?ee+"px":""),this.hasBit(te,CornerBit.BOTTOM)||this.adapter.addClass(MDCMenuSurfaceFoundation.cssClasses.IS_OPEN_BELOW)}getAutoLayoutmeasurements(){let te=this.adapter.getAnchorDimensions();const ee=this.adapter.getBodyDimensions(),ne=this.adapter.getViewportDimensions(),re=this.adapter.getWindowScroll();return te||(te={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:te,bodySize:ee,surfaceSize:this.dimensions,viewportDistance:{top:te.top,right:ne.width-te.right,bottom:ne.height-te.bottom,left:te.left},viewportSize:ne,windowScroll:re}}getoriginCorner(){let te=this.originCorner;const{viewportDistance:ee,anchorSize:ne,surfaceSize:re}=this.measurements,{MARGIN_TO_EDGE:se}=MDCMenuSurfaceFoundation.numbers,ae=this.hasBit(this.anchorCorner,CornerBit.BOTTOM);let le,ce;ae?(le=ee.top-se+this.anchorMargin.bottom,ce=ee.bottom-se-this.anchorMargin.bottom):(le=ee.top-se+this.anchorMargin.top,ce=ee.bottom-se+ne.height-this.anchorMargin.top),!(ce-re.height>0)&&le>ce+this.openBottomBias&&(te=this.setBit(te,CornerBit.BOTTOM));const fe=this.adapter.isRtl(),Ae=this.hasBit(this.anchorCorner,CornerBit.FLIP_RTL),pe=this.hasBit(this.anchorCorner,CornerBit.RIGHT)||this.hasBit(te,CornerBit.RIGHT);let Oe=!1;fe&&Ae?Oe=!pe:Oe=pe;let Fe,Ne;Oe?(Fe=ee.left+ne.width+this.anchorMargin.left,Ne=ee.right-this.anchorMargin.left):(Fe=ee.left+this.anchorMargin.left,Ne=ee.right+ne.width-this.anchorMargin.left);const ze=Fe-re.width>0,He=Ne-re.width>0,We=this.hasBit(te,CornerBit.FLIP_RTL)&&this.hasBit(te,CornerBit.RIGHT);return He&&We&&fe||!ze&&We?te=this.unsetBit(te,CornerBit.RIGHT):(ze&&Oe&&fe||ze&&!Oe&&pe||!He&&Fe>=Ne)&&(te=this.setBit(te,CornerBit.RIGHT)),te}getMenuSurfaceMaxHeight(te){if(this.maxHeight>0)return this.maxHeight;const{viewportDistance:ee}=this.measurements;let ne=0;const re=this.hasBit(te,CornerBit.BOTTOM),se=this.hasBit(this.anchorCorner,CornerBit.BOTTOM),{MARGIN_TO_EDGE:ae}=MDCMenuSurfaceFoundation.numbers;return re?(ne=ee.top+this.anchorMargin.top-ae,se||(ne+=this.measurements.anchorSize.height)):(ne=ee.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-ae,se&&(ne-=this.measurements.anchorSize.height)),ne}getHorizontalOriginOffset(te){const{anchorSize:ee}=this.measurements,ne=this.hasBit(te,CornerBit.RIGHT),re=this.hasBit(this.anchorCorner,CornerBit.RIGHT);if(ne){const se=re?ee.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?se-(this.measurements.viewportSize.width-this.measurements.bodySize.width):se}return re?ee.width-this.anchorMargin.right:this.anchorMargin.left}getVerticalOriginOffset(te){const{anchorSize:ee}=this.measurements,ne=this.hasBit(te,CornerBit.BOTTOM),re=this.hasBit(this.anchorCorner,CornerBit.BOTTOM);let se=0;return ne?se=re?ee.height-this.anchorMargin.top:-this.anchorMargin.bottom:se=re?ee.height+this.anchorMargin.bottom:this.anchorMargin.top,se}adjustPositionForHoistedElement(te){const{windowScroll:ee,viewportDistance:ne,surfaceSize:re,viewportSize:se}=this.measurements,ae=Object.keys(te);for(const le of ae){let ce=te[le]||0;if(this.isHorizontallyCenteredOnViewport&&(le==="left"||le==="right")){te[le]=(se.width-re.width)/2;continue}ce+=ne[le],this.isFixedPosition||(le==="top"?ce+=ee.y:le==="bottom"?ce-=ee.y:le==="left"?ce+=ee.x:ce-=ee.x),te[le]=ce}}maybeRestoreFocus(){const te=this.adapter.isFocused(),ee=this.adapter.getOwnerDocument?this.adapter.getOwnerDocument():document,ne=ee.activeElement&&this.adapter.isElementInContainer(ee.activeElement);(te||ne)&&setTimeout(()=>{this.adapter.restoreFocus()},numbers$4.TOUCH_EVENT_WAIT_MS)}hasBit(te,ee){return!!(te&ee)}setBit(te,ee){return te|ee}unsetBit(te,ee){return te^ee}isFinite(te){return typeof te=="number"&&isFinite(te)}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */const cssClasses$2={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},strings$3={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list,.mdc-deprecated-list",SELECTED_EVENT:"MDCMenu:selected",SKIP_RESTORE_FOCUS:"data-menu-item-skip-restore-focus"},numbers$3={FOCUS_ROOT_INDEX:-1};var DefaultFocusState=(ie=>(ie[ie.NONE=0]="NONE",ie[ie.LIST_ROOT=1]="LIST_ROOT",ie[ie.FIRST_ITEM=2]="FIRST_ITEM",ie[ie.LAST_ITEM=3]="LAST_ITEM",ie))(DefaultFocusState||{});/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */class MDCMenuFoundation extends MDCFoundation{constructor(te){super({...MDCMenuFoundation.defaultAdapter,...te}),this.defaultFocusState=DefaultFocusState.LIST_ROOT,this.selectedIndex=-1}static get cssClasses(){return cssClasses$2}static get strings(){return strings$3}static get numbers(){return numbers$3}static get defaultAdapter(){return{addClassToElementAtIndex:()=>{},removeClassFromElementAtIndex:()=>{},addAttributeToElementAtIndex:()=>{},removeAttributeFromElementAtIndex:()=>{},getAttributeFromElementAtIndex:()=>null,elementContainsClass:()=>!1,closeSurface:()=>{},getElementIndex:()=>-1,notifySelected:()=>{},getMenuItemCount:()=>0,focusItemAtIndex:()=>{},focusListRoot:()=>{},getSelectedSiblingOfItemAtIndex:()=>-1,isSelectableItemAtIndex:()=>!1}}destroy(){this.adapter.closeSurface()}handleKeydown(te){const{key:ee,keyCode:ne}=te;(ee==="Tab"||ne===9)&&this.adapter.closeSurface(!0)}handleItemAction(te){const ee=this.adapter.getElementIndex(te);if(ee<0)return;this.adapter.notifySelected({index:ee});const ne=this.adapter.getAttributeFromElementAtIndex(ee,strings$3.SKIP_RESTORE_FOCUS)==="true";this.adapter.closeSurface(ne),this.adapter.isSelectableItemAtIndex(ee)&&this.setSelectedIndex(ee)}handleMenuSurfaceOpened(){switch(this.defaultFocusState){case DefaultFocusState.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case DefaultFocusState.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case DefaultFocusState.NONE:break;default:this.adapter.focusListRoot();break}}setDefaultFocusState(te){this.defaultFocusState=te}getSelectedIndex(){return this.selectedIndex}setSelectedIndex(te){if(this.validatedIndex(te),!this.adapter.isSelectableItemAtIndex(te))throw new Error("MDCMenuFoundation: No selection group at specified index.");const ee=this.adapter.getSelectedSiblingOfItemAtIndex(te);ee>=0&&(this.adapter.removeAttributeFromElementAtIndex(ee,strings$3.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(ee,cssClasses$2.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(te,cssClasses$2.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(te,strings$3.ARIA_CHECKED_ATTR,"true"),this.selectedIndex=te}setEnabled(te,ee){this.validatedIndex(te),ee?(this.adapter.removeClassFromElementAtIndex(te,cssClasses$4.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(te,strings$3.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(te,cssClasses$4.LIST_ITEM_DISABLED_CLASS),this.adapter.addAttributeToElementAtIndex(te,strings$3.ARIA_DISABLED_ATTR,"true"))}validatedIndex(te){const ee=this.adapter.getMenuItemCount();if(!(te>=0&&te<ee))throw new Error("MDCMenuFoundation: No list item at specified index.")}}var root$x=from_html("<div><!></div>");function MenuSurface(ie,te){push(te,!0);let ee=prop(te,"use",19,()=>[]),ne=prop(te,"class",3,""),re=prop(te,"style",3,""),se=prop(te,"static",3,!1),ae=prop(te,"anchor",3,!0),le=prop(te,"fixed",3,!1),ce=prop(te,"open",31,()=>proxy(se())),he=prop(te,"managed",3,!1),fe=prop(te,"fullWidth",3,!1),Ae=prop(te,"quickOpen",3,!1),pe=prop(te,"anchorElement",15),Oe=prop(te,"anchorMargin",19,()=>({top:0,right:0,bottom:0,left:0})),Fe=prop(te,"maxHeight",3,0),Ne=prop(te,"horizontallyCenteredOnViewport",3,!1),ze=prop(te,"openBottomBias",3,0),He=prop(te,"neverRestoreFocus",3,!1),We=rest_props(te,["$$slots","$$events","$$legacy","use","class","style","static","anchor","fixed","open","managed","fullWidth","quickOpen","anchorElement","anchorCorner","anchorMargin","maxHeight","horizontallyCenteredOnViewport","openBottomBias","neverRestoreFocus","children"]),je,Ue=state(void 0),Ge=proxy({}),Ze=proxy({}),Ye=state(void 0);setContext("SMUI:list:role","menu"),setContext("SMUI:list:item:role","menuitem"),user_effect(()=>{var wr,Dr;je&&ae()&&!((wr=je.parentElement)!=null&&wr.classList.contains("mdc-menu-surface--anchor"))&&((Dr=je.parentElement)==null||Dr.classList.add("mdc-menu-surface--anchor"),pe(je.parentElement??void 0))}),user_effect(()=>{get$2(Ue)&&get$2(Ue).isOpen()!==ce()&&(ce()?get$2(Ue).open():get$2(Ue).close())}),user_effect(()=>{get$2(Ue)&&get$2(Ue).setQuickOpen(Ae())}),user_effect(()=>{get$2(Ue)&&get$2(Ue).setFixedPosition(le())}),user_effect(()=>{get$2(Ue)&&get$2(Ue).setMaxHeight(Fe())}),user_effect(()=>{get$2(Ue)&&get$2(Ue).setIsHorizontallyCenteredOnViewport(Ne())});const qe=Corner;user_effect(()=>{get$2(Ue)&&te.anchorCorner!=null&&(typeof te.anchorCorner=="string"?get$2(Ue).setAnchorCorner(qe[te.anchorCorner]):get$2(Ue).setAnchorCorner(te.anchorCorner))}),user_effect(()=>{get$2(Ue)&&get$2(Ue).setAnchorMargin(Oe())}),user_effect(()=>{get$2(Ue)&&get$2(Ue).setOpenBottomBias(ze())});const nr=getContext("SMUI:menu-surface:mount"),ir=getContext("SMUI:menu-surface:unmount");onMount(()=>{set(Ue,new MDCMenuSurfaceFoundation({addClass:or,removeClass:Jt,hasClass:tr,hasAnchor:()=>!!pe(),notifyClose:()=>{he()||ce(se()),ce()||dispatch(dr(),"SMUIMenuSurfaceClosed")},notifyClosing:()=>{he()||ce(se()),ce()||dispatch(dr(),"SMUIMenuSurfaceClosing")},notifyOpen:()=>{he()||ce(!0),ce()&&dispatch(dr(),"SMUIMenuSurfaceOpened")},notifyOpening:()=>{ce()||dispatch(dr(),"SMUIMenuSurfaceOpening")},isElementInContainer:Dr=>dr().contains(Dr),isRtl:()=>getComputedStyle(dr()).getPropertyValue("direction")==="rtl",setTransformOrigin:Dr=>{Ze["transform-origin"]=Dr},isFocused:()=>document.activeElement===dr(),saveFocus:()=>{set(Ye,document.activeElement??void 0,!0)},restoreFocus:()=>{!He()&&(!je||dr().contains(document.activeElement))&&get$2(Ye)&&document.contains(get$2(Ye))&&"focus"in get$2(Ye)&&get$2(Ye).focus()},getInnerDimensions:()=>{const Dr=dr(),zr=getComputedStyle(Dr).display==="none";zr&&Dr.classList.add("smui-menu-surface--measure");let Fr=dr().offsetWidth,Jr=dr().offsetHeight;return zr&&Dr.classList.remove("smui-menu-surface--measure"),{width:Fr,height:Jr}},getAnchorDimensions:()=>pe()?pe().getBoundingClientRect():null,getViewportDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:Dr=>{Ze.left="left"in Dr?`${Dr.left}px`:"",Ze.right="right"in Dr?`${Dr.right}px`:"",Ze.top="top"in Dr?`${Dr.top}px`:"",Ze.bottom="bottom"in Dr?`${Dr.bottom}px`:""},setMaxHeight:Dr=>{Ze["max-height"]=Dr}}),!0);const wr={get open(){return ce()},set open(Dr){ce(Dr)},closeProgrammatic:rr};return nr&&nr(wr),get$2(Ue).init(),()=>{var Ur,zr;ir&&ir(wr);const Dr=get$2(Ue).isHoistedElement;(Ur=get$2(Ue))==null||Ur.destroy(),Dr&&((zr=dr().parentNode)==null||zr.removeChild(dr())),je=null,set(Ue,null)}}),onMount(()=>(document.body.addEventListener("pointerup",lr,{capture:!0}),()=>{document.body.removeEventListener("pointerup",lr,{capture:!0})})),onDestroy(()=>{var wr;ae()&&dr()&&((wr=dr().parentElement)==null||wr.classList.remove("mdc-menu-surface--anchor"))});function tr(wr){return wr in Ge?Ge[wr]:dr().classList.contains(wr)}function or(wr){Ge[wr]||(Ge[wr]=!0)}function Jt(wr){(!(wr in Ge)||Ge[wr])&&(Ge[wr]=!1)}function rr(wr){var Dr;(Dr=get$2(Ue))==null||Dr.close(wr),ce(!1)}function lr(wr){get$2(Ue)&&ce()&&!he()&&get$2(Ue).handleBodyClick(wr)}function ur(){return ce()}function Sr(wr){ce(wr)}function xr(wr,Dr){if(get$2(Ue)==null)throw new Error("Instance is not defined.");return get$2(Ue).setAbsolutePosition(wr,Dr)}function Pr(wr){if(get$2(Ue)==null)throw new Error("Instance is not defined.");return get$2(Ue).setIsHoisted(wr)}function mr(){if(get$2(Ue)==null)throw new Error("Instance is not defined.");return get$2(Ue).isFixed()}function Er(){if(get$2(Ue)==null)throw new Error("Instance is not defined.");return get$2(Ue).flipCornerHorizontally()}function dr(){return je}function Cr(){return get$2(Ue)}var Or=root$x(),Ar=wr=>{var Dr;get$2(Ue)&&!he()&&get$2(Ue).handleKeydown(wr),(Dr=te.onkeydown)==null||Dr.call(te,wr)};attribute_effect(Or,(wr,Dr)=>({class:wr,style:Dr,role:"dialog",...We,onkeydown:Ar}),[()=>classMap({[ne()]:!0,"mdc-menu-surface":!0,"mdc-menu-surface--fixed":le(),"mdc-menu-surface--open":se(),"smui-menu-surface--static":se(),"mdc-menu-surface--fullwidth":fe(),...Ge}),()=>Object.entries(Ze).map(([wr,Dr])=>`${wr}: ${Dr};`).concat([re()]).join(" ")]);var Ir=child(Or);return snippet(Ir,()=>te.children??noop$1),bind_this(Or,wr=>je=wr,()=>je),action(Or,(wr,Dr)=>useActions==null?void 0:useActions(wr,Dr),ee),append(ie,Or),pop({isOpen:ur,setOpen:Sr,setAbsolutePosition:xr,setIsHoisted:Pr,isFixed:mr,flipCornerHorizontally:Er,getElement:dr,getMDCMenuSurfaceFoundation:Cr})}function Menu(ie,te){push(te,!0);const{closest:ee}=ponyfill;let ne=prop(te,"use",19,()=>[]),re=prop(te,"class",3,""),se=prop(te,"open",15,!1),ae=prop(te,"anchorElement",15),le=prop(te,"managed",3,!1),ce=rest_props(te,["$$slots","$$events","$$legacy","use","class","open","anchorElement","managed","children"]),he,fe=state(void 0),Ae=state(void 0),pe=state(void 0);setContext("SMUI:menu-surface:mount",Ze=>{get$2(Ae)||set(Ae,Ze,!0)});const Oe=getContext("SMUI:list:mount");setContext("SMUI:list:mount",Ze=>{get$2(pe)||set(pe,Ze,!0),Oe==null||Oe(Ze)});const Fe=getContext("SMUI:menu:mount"),Ne=getContext("SMUI:menu:unmount");onMount(()=>(set(fe,new MDCMenuFoundation({addClassToElementAtIndex:(Ze,Ye)=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");get$2(pe).addClassForElementIndex(Ze,Ye)},removeClassFromElementAtIndex:(Ze,Ye)=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");get$2(pe).removeClassForElementIndex(Ze,Ye)},addAttributeToElementAtIndex:(Ze,Ye,qe)=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");get$2(pe).setAttributeForElementIndex(Ze,Ye,qe)},removeAttributeFromElementAtIndex:(Ze,Ye)=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");get$2(pe).removeAttributeForElementIndex(Ze,Ye)},getAttributeFromElementAtIndex:(Ze,Ye)=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");return get$2(pe).getAttributeFromElementIndex(Ze,Ye)},elementContainsClass:(Ze,Ye)=>Ze.classList.contains(Ye),closeSurface:Ze=>{var Ye;if(!le()){if((Ye=get$2(Ae))==null||Ye.closeProgrammatic(Ze),!Ge())return;dispatch(Ge(),"SMUIMenuClosedProgrammatically")}},getElementIndex:Ze=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");return get$2(pe).getOrderedList().map(Ye=>Ye.element).indexOf(Ze)},notifySelected:Ze=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");dispatch(Ge(),"SMUIMenuSelected",{index:Ze.index,item:get$2(pe).getOrderedList()[Ze.index].element})},getMenuItemCount:()=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");return get$2(pe).items.length},focusItemAtIndex:Ze=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");get$2(pe).focusItemAtIndex(Ze)},focusListRoot:()=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");"focus"in get$2(pe).element&&get$2(pe).element.focus()},isSelectableItemAtIndex:Ze=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");return!!ee(get$2(pe).getOrderedList()[Ze].element,`.${cssClasses$2.MENU_SELECTION_GROUP}`)},getSelectedSiblingOfItemAtIndex:Ze=>{if(get$2(pe)==null)throw new Error("List accessor is undefined.");const Ye=get$2(pe).getOrderedList(),qe=ee(Ye[Ze].element,`.${cssClasses$2.MENU_SELECTION_GROUP}`),nr=qe==null?void 0:qe.querySelector(`.${cssClasses$2.MENU_SELECTED_LIST_ITEM}`);return nr?Ye.map(ir=>ir.element).indexOf(nr):-1}}),!0),Fe==null||Fe(get$2(fe)),get$2(fe).init(),()=>{var Ze;Ne&&get$2(fe)&&Ne(get$2(fe)),(Ze=get$2(fe))==null||Ze.destroy(),he=null,set(fe,null)}));function ze(){return se()}function He(Ze){se(Ze)}function We(Ze){if(get$2(fe)==null)throw new Error("Instance is undefined.");get$2(fe).setDefaultFocusState(Ze)}function je(){if(get$2(fe)==null)throw new Error("Instance is undefined.");return get$2(fe).getSelectedIndex()}function Ue(){return he}function Ge(){return he.getElement()}{let Ze=user_derived(()=>classMap({[re()]:!0,"mdc-menu":!0}));bind_this(MenuSurface(ie,spread_props({get use(){return ne()},get class(){return get$2(Ze)},get managed(){return le()}},()=>ce,{onkeydown:Ye=>{var qe;(qe=te.onkeydown)==null||qe.call(te,Ye)},onSMUIMenuSurfaceOpened:Ye=>{var qe;get$2(fe)&&get$2(fe).handleMenuSurfaceOpened(),(qe=te.onSMUIMenuSurfaceOpened)==null||qe.call(te,Ye)},onSMUIListAction:Ye=>{var qe;get$2(fe)&&get$2(pe)&&get$2(fe).handleItemAction(get$2(pe).getOrderedList()[Ye.detail.index].element),(qe=te.onSMUIListAction)==null||qe.call(te,Ye)},get open(){return se()},set open(Ye){se(Ye)},get anchorElement(){return ae()},set anchorElement(Ye){ae(Ye)},children:(Ye,qe)=>{var nr=comment(),ir=first_child(nr);snippet(ir,()=>te.children??noop$1),append(Ye,nr)},$$slots:{default:!0}})),Ye=>he=Ye,()=>he)}return pop({isOpen:ze,setOpen:He,setDefaultFocusState:We,getSelectedIndex:je,getMenuSurface:Ue,getElement:Ge})}function useTranslation(){return getContext(II18nService)}function useService(ie){const te=getContext(IChartService),ee=ne=>ne.get(ie);return te?te.invokeWithinContext(ee):getContext(IInstantiationService).invokeFunction(ee)}var root_4$d=from_html('<div class="icon svelte-1t9fofa"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"></path><path d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"></path></g></svg></div> <div class="label svelte-1t9fofa"> </div> <div class="kb svelte-1t9fofa"> </div>',1),root_5$c=from_html('<div class="icon svelte-1t9fofa"></div> <div class="label svelte-1t9fofa"> </div> <div class="kb svelte-1t9fofa"> </div>',1),root_3$k=from_html("<!> <!>",1),root_2$j=from_html('<div class="moreMenu svelte-1t9fofa"><!></div>'),root_1$v=from_html('<div class="toolbar svelte-1t9fofa"><div class="handle svelte-1t9fofa"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 12" width="8" height="12" fill="currentColor"><rect width="2" height="2" rx="1"></rect><rect width="2" height="2" rx="1" y="5"></rect><rect width="2" height="2" rx="1" y="10"></rect><rect width="2" height="2" rx="1" x="6"></rect><rect width="2" height="2" rx="1" x="6" y="5"></rect><rect width="2" height="2" rx="1" x="6" y="10"></rect></svg></div>     <button class="button svelte-1t9fofa"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"></path></svg></button> <div><button class="button svelte-1t9fofa"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path fill="currentColor" d="M7.5 13a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM5 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM12 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0zm9.5-1.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM19 14.5a2.5 2.5 0 1 1 5 0 2.5 2.5 0 0 1-5 0z"></path></svg></button> <!></div></div>');function Toolbar(ie,te){push(te,!0);const ee=useService(IChartManagementService),{t:ne}=useTranslation(),se=ensure(ee.getDomElement()).getBoundingClientRect(),ae={x:se.x+se.width/2,y:se.y+15};let le=proxy(ae);const ce={bounds:"body",applyUserSelectHack:!0,handle:".handle",position:le,onDrag:({offsetX:Fe,offsetY:Ne})=>{Object.assign(le,{x:Fe,y:Ne})}};let he;const fe=KeyCode.KeyC|KeyMod.CtrlCmd;var Ae=comment(),pe=first_child(Ae);{var Oe=Fe=>{var Ne=root_1$v(),ze=sibling(child(Ne),2);ze.__click=function(...Ue){var Ge;(Ge=te.onRemove)==null||Ge.apply(this,Ue)};var He=sibling(ze,2),We=child(He);We.__click=()=>he.setOpen(!0);var je=sibling(We,2);bind_this(Menu(je,{anchorCorner:"BOTTOM_LEFT",quickOpen:!0,class:"cl-dropdown",children:(Ue,Ge)=>{var Ze=root_2$j(),Ye=child(Ze);List(Ye,{children:(qe,nr)=>{var ir=root_3$k(),tr=first_child(ir);Item(tr,{tag:"div",class:"row",get onclick(){return te.onClone},children:(Jt,rr)=>{var lr=root_4$d(),ur=sibling(first_child(lr),2),Sr=child(ur),xr=sibling(ur,2),Pr=child(xr);template_effect((mr,Er,dr)=>{set_text(Sr,mr),set_text(Pr,`${Er??""}${dr??""}`)},[()=>ne("contextMenu.clone"),()=>getKeybindingLabel(KeyMod.CtrlCmd),()=>ne("contextMenu.clone.kb.drag")]),append(Jt,lr)},$$slots:{default:!0}});var or=sibling(tr,2);Item(or,{tag:"div",class:"row",get onclick(){return te.onCopy},children:(Jt,rr)=>{var lr=root_5$c(),ur=sibling(first_child(lr),2),Sr=child(ur),xr=sibling(ur,2),Pr=child(xr);template_effect((mr,Er)=>{set_text(Sr,mr),set_text(Pr,Er)},[()=>ne("contextMenu.copy"),()=>getKeybindingLabel(fe)]),append(Jt,lr)},$$slots:{default:!0}}),append(qe,ir)},$$slots:{default:!0}}),append(Ue,Ze)},$$slots:{default:!0}}),Ue=>he=Ue,()=>he),action(Ne,(Ue,Ge)=>d==null?void 0:d(Ue,Ge),()=>ce),append(Fe,Ne)};if_block(pe,Fe=>{te.visible&&Fe(Oe)})}append(ie,Ae),pop()}delegate(["click"]);const textTable=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M4 5a1 1 0 0 0-1 1v17a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H4Zm0 1h5v5H4V6Zm0 12v5h5v-5H4Zm6 0v5h14v-5H10Zm14-1v-5H10v5h14ZM9 17H4v-5h5v5Zm1-6V6h14v5H10Z"></path></svg>
`,volumnBasedAnchoredVolumnProfile=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M24 3h-1v4h-6v3h-5v3H8.95a2.5 2.5 0 1 0 0 1H15v3h5v3h3v4h1V3Zm-6 7h5V8h-5v2Zm-1 1h-4v2h10v-2h-6Zm4 5h-5v-2h7v2h-2Zm0 3v-2h2v2h-2ZM6.5 15a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"></path></svg>
`,volumnBasedAnchoredVwap=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" d="M17 17h1v6h-1v-6zM17 2h1v5h-1V2z"></path><path fill="currentColor" d="M16 17h3V8h-3v9zM15 7h5v11h-5V7zM10 5h1v5h-1V5zM10 22h1v3h-1v-3z"></path><path fill="currentColor" d="M9 21h3V10H9v11zM8 9h5v13H8V9z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M25.27 9.42L14.1 16.53l-6.98-1.5L5.3 16.4l-.6-.8 2.18-1.64 7.02 1.5 10.83-6.88.54.84z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M4 18a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"></path></svg>
`,volumnBasedFixedRangeVolumnProfile=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M5 21.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zM3.5 24a2.5 2.5 0 0 0 .5-4.95V3H3v16.05A2.5 2.5 0 0 0 3.5 24zM25 5.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0zM23.5 3a2.5 2.5 0 0 1 .5 4.95V24h-1V7.95A2.5 2.5 0 0 1 23.5 3z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9 7H4v2h5V7zM3 6v4h7V6H3z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M12 10H4v2h8v-2zM3 9v4h10V9H3z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M7 13H4v2h3v-2zm-4-1v4h5v-4H3z"></path></svg>
`,icon$1u=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M7.354 21.354l14-14-.707-.707-14 14z"></path><path d="M21 7l-8 3 5 5z"></path><path fill-rule="nonzero" d="M22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,ArrowToolType="tool.arrow.arrow";var LineStyleType=(ie=>(ie[ie.solid=0]="solid",ie[ie.dotted=1]="dotted",ie[ie.dashed=2]="dashed",ie[ie.largeDashed=3]="largeDashed",ie[ie.sparseDotted=4]="sparseDotted",ie[ie.smallDashed=5]="smallDashed",ie))(LineStyleType||{});function getLineDash(ie,te){return[[ie,2*ie],[5*ie,6*ie],[6*ie,6*ie],[ie,4*ie],[2*ie,ie]][te-1]}function setLineStyle(ie,te){let ee=[];te!==0&&(ee=getLineDash(ie.lineWidth,te)),ie.setLineDash(ee)}var LineEnd=(ie=>(ie[ie.Normal=0]="Normal",ie[ie.Arrow=1]="Arrow",ie))(LineEnd||{}),HorizontalAlign=(ie=>(ie.Left="left",ie.Center="center",ie.Right="right",ie))(HorizontalAlign||{}),VerticalAlign=(ie=>(ie.Top="top",ie.Middle="middle",ie.Bottom="bottom",ie))(VerticalAlign||{});function alignByAngle(ie){let te,ee;return ie>=-135&&ie<=-45?(te="center",ee="bottom"):ie>-45&&ie<45?(te="left",ee="middle"):ie>=45&&ie<=135?(te="center",ee="top"):(te="right",ee="middle"),{horzAlign:te,vertAlign:ee}}class BaseTool{constructor(){Ee(this,"isActivated",!1);Ee(this,"fallbackable",!1);Ee(this,"id",generateUuid());Ee(this,"_phase",ToolInvocationPhase.idle)}get phase(){return this._phase}activate(){should(this.phase===ToolInvocationPhase.idle),this.isActivated=!0,this._phase=ToolInvocationPhase.activated,this.activated()}deactivate(){this.isActivated=!1,this._phase=ToolInvocationPhase.idle,this.deactivated()}activated(){}deactivated(){}}var __defProp$1=Object.defineProperty,__getOwnPropDesc$9=Object.getOwnPropertyDescriptor,__decorateClass$9=(ie,te,ee,ne)=>{for(var re=__getOwnPropDesc$9(te,ee),se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(te,ee,re)||re);return re&&__defProp$1(te,ee,re),re};class DrawingSession{constructor(te,ee,ne,re=!1){Ee(this,"primitive");Ee(this,"_clickCount",0);this.chartService=te,this.paneIndex=ee,this.contrib=ne,this.inPreview=re}get clickCount(){return this._clickCount}get currentStep(){return this._clickCount}getTargetSeries(){return ensure(this.chartService.getPaneSeries(this.paneIndex))}startPreview(te){this.primitive=te,this.primitive.attach(this.getTargetSeries()),this.contrib.model.markCreatingStarted(te),this.contrib.attachPrimitive(te,!1)}endPreview(){should(this.inPreview),this.inPreview=!1,this.contrib.model.focus(this.primitive)}startDrawing(te){this.primitive=te,this.primitive.attach(this.getTargetSeries()),this.contrib.model.markCreatingStarted(te),this.contrib.attachPrimitive(te,!0)}onPoint(){this.contrib.model.markCreatingPoint(this._clickCount),this._clickCount++}finishDrawing(){this.contrib.model.markCreatingFinishedOrAborted(this.primitive),this.primitive.finish()}abortDrawing(){this.contrib.model.markCreatingFinishedOrAborted(this.primitive),this.primitive.abort(),this.contrib.detachPrimitive(this.primitive)}detach(){this.contrib.detachPrimitive(this.primitive)}dispose(){var ee;const te=this.primitive;te&&(!this.inPreview&&((ee=te.isCreationFinished)==null?void 0:ee.call(te))===!1||this.contrib.model.currentCreating===te&&(this.contrib.detachPrimitive(te),this.contrib.model.markCreatingFinishedOrAborted(this.primitive)))}}__decorateClass$9([memoize$1],DrawingSession.prototype,"getTargetSeries");class DrawingTool extends BaseTool{constructor(){super(...arguments);Ee(this,"canGoBackward",!0);Ee(this,"disableExtendTime",!1);Ee(this,"previewBeforePlace",!1);Ee(this,"_drawingSession");Ee(this,"_presetProps")}get chartService(){var ee;return ensure((ee=this._drawingSession)==null?void 0:ee.chartService)}get presetProps(){return this._presetProps}get primitive(){var ee;return ensure((ee=this._drawingSession)==null?void 0:ee.primitive)}_startCreationOnChart(ee,ne,re,se=!0){var le;if(ee===((le=this._drawingSession)==null?void 0:le.chartService)){if(se)return this._drawingSession;this._drawingSession.finishDrawing()}const ae=ensure(ee.getContribution(DrawingContribId));return this._drawingSession=new DrawingSession(ee,ne,ae,re),this._drawingSession}processEvent(ee){var ne;switch(ee.type){case InputEventType.CLICK:{const re=ensure(ee.asChartInputEvent());if(!re.point)return;const se=re.source.chart.getCrosshairPosition();if(!isValidPosition(se))return;if(this.onlyDrawingOnMainSeries()&&se.paneIndex!==0){ee.source.invokeWithinContext(he=>{he.get(IToolService).keepDrawingOrSwitchBack()});return}if(this._drawingSession&&(this._drawingSession.chartService!==re.source||this._drawingSession.paneIndex!==se.paneIndex)){this._drawingSession.abortDrawing(),getToolService(this._drawingSession).keepDrawingOrSwitchBack();return}const ae=ensure(re.paneIndex);this._drawingSession||this._startCreationOnChart(re.source,ae,!1);const le=getXCoordinate(this.chartService,se.x,{useExtended:!this.disableExtendTime}),ce=ensure((ne=this._drawingSession)==null?void 0:ne.getTargetSeries().coordinateToPrice(se.y));should(isFiniteNumber(le)),ee.accept(),this._addPoint({time:le,price:ce});break}case InputEventType.MOUSE_MOVE:{this._onMouseMove(ensure(ee.asChartInputEvent()));break}}}_stepCount(){return this.steps}_addPoint(ee){let ne;if(should(this._drawingSession),this._drawingSession.clickCount===0)this.previewBeforePlace?(should(this._drawingSession.primitive),this._drawingSession.endPreview()):this._drawingSession.startDrawing(this.doCreatePrimitive(this._drawingSession)),ne=this.primitive.addPoint(ee,this._drawingSession.currentStep);else if(ne=this.primitive.addPoint(ee,this._drawingSession.currentStep),ne===AddPointResponse.Reject)return;this._drawingSession.onPoint(),(this._drawingSession.clickCount===this._stepCount()||ne===AddPointResponse.AcceptAndFinish)&&(this.finishDrawing(),this.chartService.invokeWithinContext(se=>{se.get(IToolService).keepDrawingOrSwitchBack()}))}_onMouseMove(ee){var le,ce,he,fe;if(this.previewBeforePlace){const Ae=ee.source.chart.getCrosshairPosition();if(this._drawingSession&&(this._drawingSession.chartService!==ee.source||this._drawingSession.paneIndex!==Ae.paneIndex)&&(this._drawingSession.abortDrawing(),this._drawingSession=void 0),!isValidPosition(Ae))return;if(!this._drawingSession&&!isUndefinedOrNull(Ae.paneIndex)){const pe=this._startCreationOnChart(ee.source,Ae.paneIndex,!0);this._drawingSession=pe;const Oe=this.doCreatePrimitive(this._drawingSession);pe.startPreview(Oe)}}const ne=(le=this._drawingSession)==null?void 0:le.primitive;if(!ne||!(ne!=null&&ne.updateMove)||!ee.point||ee.source!==((ce=this._drawingSession)==null?void 0:ce.chartService))return;const re=ee.source.chart.getCrosshairPosition();if(!isValidPosition(re)||re.paneIndex!==((he=this._drawingSession)==null?void 0:he.paneIndex))return;const se=getXCoordinate(this.chartService,re.x,{useExtended:!this.disableExtendTime}),ae=ensure((fe=this._drawingSession)==null?void 0:fe.getTargetSeries().coordinateToPrice(re.y));ne.updateMove({time:se,price:ae},ensure(this._drawingSession).currentStep)}get resetArgs(){const ee=ensure(this._drawingSession),ne=getThemeService(ee).getColorTheme(),re=getI18nService(ee);return[this.type,{chartService:this.chartService,colorTheme:ne,priceLabelFormatter:getPriceLabelFormatter(ee),dateTimeFormatter:getDateTimeFormatter(ee),dateFormatter:getDateFormatter(ee),hitTestCollector:getHitTestCollector(ee),percentageFormatter(se){return(se*100).toFixed(2)+"%"},amountFormatter(se){return se.toFixed(0)},timeSpanFormatter:(se,ae)=>{let le=ae.valueOf()-se.valueOf();const ce=Math.sign(le);le=Math.abs(le);const he=Math.floor(le/86400);le=le%86400;const fe=Math.floor(le/3600);le=le%3600;const Ae=Math.floor(le/60);le=le%60;const pe=le,Oe=[];he>0&&Oe.push(he+re.t("resolution.timeSpan.day")),fe>0&&Oe.push(fe+re.t("resolution.timeSpan.hour")),Ae>0&&Oe.push(Ae+re.t("resolution.timeSpan.minute")),(pe>0||Oe.length===0)&&Oe.push(pe+re.t("resolution.timeSpan.second"));const Fe=Oe.join(" ");return ce===1?Fe:`-${Fe}`}},getChart(ee),ee.getTargetSeries(),getToolModel(ee)]}receivePresetProps(ee,ne,re){var se;if(ee&&this._startCreationOnChart(ee,ne,!1),this._presetProps=re,!ee&&((se=re.points)!=null&&se.length)&&NOTREACHED(),re.points)for(const ae of re.points)this._addPoint(ae)}doCreatePrimitive(ee){const ne=this.createPrimitive(ee);return this._presetProps&&ne.updateProps(omit(this._presetProps,["points"])),ne}finishDrawing(){ensure(this._drawingSession).finishDrawing()}abortDrawing(){ensure(this._drawingSession).abortDrawing()}deactivated(){var ee;(ee=this._drawingSession)==null||ee.dispose()}useMagnetedPosition(){return!0}isDrawingTool(){return!0}canKeepDrawing(){return!0}onlyDrawingOnMainSeries(){return!1}}function getThemeService(ie){return ie.chartService.invokeWithinContext(te=>te.get(IThemeService))}function getI18nService(ie){return ie.chartService.invokeWithinContext(te=>te.get(II18nService))}function getToolService(ie){return ie.chartService.invokeWithinContext(te=>te.get(IToolService))}function getChart(ie){return ie.chartService.chart}function getHitTestCollector(ie){return(te,ee)=>{ie.contrib.collectHitTestPrimitive(te,ee)}}function getDateTimeFormatter(ie){return te=>ie.chartService.formatDateTime(te)}function getDateFormatter(ie){return te=>ie.chartService.formatDate(te)}function getPriceLabelFormatter(ie){return te=>ie.getTargetSeries().priceFormatter().format(te)}function getToolModel(ie){return ie.contrib.model}var StatsPosition=(ie=>(ie[ie.Left=0]="Left",ie[ie.Center=1]="Center",ie[ie.Right=2]="Right",ie[ie.Auto=3]="Auto",ie))(StatsPosition||{});const letterSpacingMap=new Map([["10b_2",.15],["10bi_2",.15],["12_3",.8],["12b_2",.5],["12bi_2",.45],["14b_2",.65],["14bi_2",.65],["16_2.5",.8],["16b_2",.8],["16bi_2",.75],["16b_2.5",.8],["16bi_2.5",.75],["16bi_3",.65],["20_2",1],["20b_2",.8],["20bi_2",.75],["20bi_3",.55],["20_2.5",.25],["20_3",.8],["24_2.5",.95],["24_3",.95],["28_2",1.4],["28_2.5",1.38],["28_3",1.38],["32_2",1.6],["32_2.5",1.6],["32_3",1.6]]),onKeydown=(ie,te,ee,ne)=>{const re=new StandardKeyboardEvent(ie);(re.keyCode===KeyCode.Esc||re.keyCode===KeyCode.Enter&&!ee.multiLine)&&ne()};var root$w=from_html('<textarea class="textArea svelte-s85b3a" autocapitalize="off" autocomplete="off" spellcheck="false"></textarea>');function TextEditor(ie,te){push(te,!0);const ee=2;let ne=rest_props(te,["$$slots","$$events","$$legacy","text","textColor"]);const re=user_derived(()=>{const{font:Oe,fontSize:Fe,textLeft:Ne,textTop:ze,textBottom:He,textRight:We,textAlign:je,centerRotation:Ue,lineSpacing:Ge}=te.textInfo,Ze=Math.ceil(We-Ne)+1,Ye=Math.ceil(He-ze);let qe,nr,ir=0;!Ue||Ue.angle===0?(qe=Math.round(ze)+.5,nr=Math.round(Ne)+.5):(nr=Ue.x-Ze/2,qe=Ue.y-Ye/2,ir=Ue.angle);const tr=devicePixelRatio<=2||devicePixelRatio>=3?devicePixelRatio:devicePixelRatio<2.5?2:2.5,or=Oe.includes("bold")?"b":"",Jt=Oe.includes("italic")?"i":"",rr=`${Fe}${or}${Jt}_${tr}`,lr=letterSpacingMap.get(rr);return{width:toPX(Ze+2*ee),height:toPX(Ye+2*ee),top:toPX(qe-ee+te.offsetTop),left:toPX(nr-ee+te.offsetLeft),font:Oe,textColor:te.textColor,fontSize:toPX(Fe),lineHeight:toPX(Fe+Ge),textAlign:je,letterSpacing:te.multiLine&&lr!==void 0?toPX(lr):"normal",rotate:ir?`${ir}rad`:void 0}}),se=()=>{te.onInput(he.value)};let ae=!1;const le=()=>{ae||(ae=!0,te.onExit(),fe&&fe instanceof HTMLElement&&fe.focus())},ce=()=>{document.activeElement!==he&&le()};let he,fe=null;onMount(()=>{fe=document.activeElement,he.focus(),he.value=te.text,PartFingerprints.write(he,PartFingerprint.Textarea)});var Ae=root$w();Ae.__input=se,Ae.__keydown=[onKeydown,ne,te,le];let pe;bind_this(Ae,Oe=>he=Oe,()=>he),template_effect(Oe=>{set_attribute(Ae,"placeholder",te.placeholder),pe=set_style(Ae,"",pe,Oe)},[()=>({width:get$2(re).width,height:get$2(re).height,top:get$2(re).top,left:get$2(re).left,font:get$2(re).font,"font-size":get$2(re).fontSize,"line-height":get$2(re).lineHeight,"text-align":get$2(re).textAlign,"letter-spacing":get$2(re).letterSpacing,rotate:get$2(re).rotate,color:get$2(re).textColor})]),event("blur",Ae,ce),append(ie,Ae),pop()}delegate(["input","keydown"]);class BaseTextTool extends DrawingTool{getTextResetArgs(te){const ee=super.resetArgs,ne=te;return[...ee,{showTextEditor:re=>{var ce;const ae=ensure((ce=ne.chartService.getPane(ne.paneIndex))==null?void 0:ce.getHTMLElement()).getBoundingClientRect(),le=ne.chartService.getContainerDomElement().getBoundingClientRect();return ne.chartService.invokeWithinContext(he=>he.get(IChartGuiService).showComponent({Component:TextEditor,props:{...re,offsetTop:ae.top-le.top,offsetLeft:ae.left-le.left}}))},accept:()=>{ne.contrib.model.markCreatingFinishedOrAborted(this.primitive),ne.contrib.model.blur(this.primitive)},abort:()=>{ne.chartService.invokeWithinContext(re=>re.get(ICommandService).executeCommand(RemoveDrawingCommand))}}]}finishDrawing(){}}const TrendLineToolType="tool.line.trendLine";class PriceLabelPriceAxisView{constructor(te){this._data=te}update(te){Object.assign(this._data,te)}backColor(){return this._data.background}coordinate(){return this._data.coordinate}text(){return this._data.text}textColor(){return this._data.foreground}tickVisible(){return!0}visible(){return!!this._data.visible}borderColor(){return this._data.border??this._data.background}}class TimeLabelTimeAxisView{constructor(te){this._data=te}update(te){Object.assign(this._data,te)}backColor(){return this._data.background}coordinate(){return this._data.coordinate}text(){return this._data.text}textColor(){return this._data.foreground}tickVisible(){return!1}visible(){return!!this._data.visible}borderColor(){return this._data.border??this._data.background}}function distanceToSegment(ie,te,ee){const ne=new Point(ie),re=new Point(te),se=new Point(ee),ae=re.subtract(ne),le=se.subtract(ne),ce=ae.x*ae.x+ae.y*ae.y,he=ae.x*le.x+ae.y*le.y,fe=ce>0?he/ce:0,Ae=Math.max(0,Math.min(1,fe)),pe=new Point(ne.x+ae.x*Ae,ne.y+ae.y*Ae);return{coeff:fe,distance:pe.subtract(se).length()}}function distanceToLine(ie,te,ee){const ne=te.subtract(ie),se=ee.subtract(ie).dotProduct(ne)/ne.dotProduct(ne),le=ie.addScaled(ne,se).subtract(ee).length();return{coeff:se,distance:le}}function intersectLineSegments(ie,te,ee,ne){const re=te.subtract(ie),se=ne.subtract(ee),ae=re.x*se.y-re.y*se.x;if(Math.abs(ae)<1e-6)return null;const le=ie.subtract(ee),ce=(le.y*se.x-le.x*se.y)/ae,he=re.scaled(ce).add(ie),fe=distanceToSegment(ee,ne,he);return Math.abs(fe.distance)<1e-6?ce:null}function pointInHalfplane(ie,te){const ee=te.edge;return ee.A*ie.x+ee.B*ie.y+ee.C>0===te.isPositive}function pointInBox$1(ie,te){return ie.x>=te.min.x&&ie.x<=te.max.x&&ie.y>=te.min.y&&ie.y<=te.max.y}function pointInPolygon(ie,te){let ee=!1;const ne=ie.x,re=ie.y;let se=te.length-1;for(let ae=0;ae<te.length;ae++){const le=te[ae],ce=te[se];(le.y<re&&ce.y>=re||ce.y<re&&le.y>=re)&&le.x+(re-le.y)/(ce.y-le.y)*(ce.x-le.x)<ne&&(ee=!ee),se=ae}return ee}function pointInCircle(ie,te,ee){const ne=ie.x-te.x,re=ie.y-te.y;return ne*ne+re*re<=ee*ee}function box(ie,te){return{min:new Point(Math.min(ie.x,te.x),Math.min(ie.y,te.y)),max:new Point(Math.max(ie.x,te.x),Math.max(ie.y,te.y))}}function lineThroughPoints(ie,te){if(arePointsEqual(ie,te))throw new Error("Points should be distinct");return createLine(ie.y-te.y,te.x-ie.x,ie.x*te.y-te.x*ie.y)}function createLine(ie,te,ee){if(ie===0&&te===0)throw new Error("A and B cannot both be zero: not a valid line.");return{A:ie,B:te,C:ee}}function intersectAtX(ie,te,ee){const ne=-(ie.C+ie.A*te)/ie.B;return ne>=ee.min.y&&ne<=ee.max.y?{x:te,y:ne}:null}function intersectAtY(ie,te,ee){const ne=-(ie.C+ie.B*te)/ie.A;return ne>=ee.min.x&&ne<=ee.max.x?{x:ne,y:te}:null}function intersectLineAndBox(ie,te){const{min:ee,max:ne}=te,re=[];if(ie.A===0){const ae=-ie.C/ie.B;return ae>=ee.y&&ae<=ne.y?[{x:ee.x,y:ae},{x:ne.x,y:ae}]:null}if(ie.B===0){const ae=-ie.C/ie.A;return ae>=ee.x&&ae<=ne.x?[{x:ae,y:ee.y},{x:ae,y:ne.y}]:null}const se=[intersectAtX(ie,ee.x,te),intersectAtY(ie,ee.y,te),intersectAtX(ie,ne.x,te),intersectAtY(ie,ne.y,te)];for(const ae of se)ae&&!re.some(le=>arePointsEqual(le,ae))&&re.push(ae);switch(re.length){case 0:return null;case 1:return re[0];case 2:return re;default:throw new Error("Unexpected: Line intersects box at more than 2 points.")}}function pointInBox(ie,te){return ie.x>=te.min.x&&ie.x<=te.max.x&&ie.y>=te.min.y&&ie.y<=te.max.y}function intersectRayWithSegment(ie,te,ee,ne){const re=te.subtract(ie),se=ne.subtract(ee),ae=re.x*se.y-re.y*se.x,le=ee.subtract(ie),ce=le.x*re.y-le.y*re.x;if(ae===0)return null;const he=(le.x*se.y-le.y*se.x)/ae,fe=ce/ae;return fe>=0&&fe<=1&&he>=0?he:null}function intersectRayAndBox(ie,te,ee){const ne=ee.min,re=new Point(ee.max.x,ee.min.y),se=ee.max,ae=new Point(ee.min.x,ee.max.y),le=te.subtract(ie),ce=[],he=intersectRayWithSegment(ie,te,ne,re),fe=intersectRayWithSegment(ie,te,re,se),Ae=intersectRayWithSegment(ie,te,se,ae),pe=intersectRayWithSegment(ie,te,ae,ne);if(he!==null&&he>=0&&ce.push(he),fe!==null&&fe>=0&&ce.push(fe),Ae!==null&&Ae>=0&&ce.push(Ae),pe!==null&&pe>=0&&ce.push(pe),ce.length===0)return null;ce.sort((Fe,Ne)=>Fe-Ne);const Oe=pointInBox(ie,ee)?ce[0]:ce[ce.length-1];return ie.addScaled(le,Oe)}function lineSegment(ie,te){if(arePointsEqual(ie,te))throw new Error("Points of a segment should be distinct");return[ie,te]}function getRegionCode(ie,te,ee){let ne=0;return ie<ee.min.x?ne|=1:ie>ee.max.x&&(ne|=2),te<ee.min.y?ne|=4:te>ee.max.y&&(ne|=8),ne}function intersectLineSegmentAndBox(ie,te){let[ee,ne]=[ie[0].x,ie[0].y],[re,se]=[ie[1].x,ie[1].y],ae=getRegionCode(ee,ne,te),le=getRegionCode(re,se,te),ce=!1,he=0;for(;;){if(++he>1e3)throw new Error("Cohen-Sutherland: infinite loop detected");if(ae|le){if(ae&le)break;{const fe=ae||le;let Ae=0,pe=0;fe&8?(Ae=ee+(re-ee)*(te.max.y-ne)/(se-ne),pe=te.max.y):fe&4?(Ae=ee+(re-ee)*(te.min.y-ne)/(se-ne),pe=te.min.y):fe&2?(pe=ne+(se-ne)*(te.max.x-ee)/(re-ee),Ae=te.max.x):fe&1&&(pe=ne+(se-ne)*(te.min.x-ee)/(re-ee),Ae=te.min.x),fe===ae?(ee=Ae,ne=pe,ae=getRegionCode(ee,ne,te)):(re=Ae,se=pe,le=getRegionCode(re,se,te))}}else{ce=!0;break}}if(ce){const fe=new Point(ee,ne),Ae=new Point(re,se);return arePointsEqual(fe,Ae)?fe:lineSegment(fe,Ae)}return null}function halfplaneThroughPoint(ie,te){const ee=ie.A*te.x+ie.B*te.y+ie.C>0;return halfplane(ie,ee)}function halfplane(ie,te){return{edge:ie,isPositive:te}}function intersectPolygonAndHalfplane(ie,te){const ee=[];for(let ne=0;ne<ie.length;++ne){const re=ie[ne],se=ie[(ne+1)%ie.length],ae=lineThroughPoints(re,se),le=pointInHalfplane(re,te),ce=pointInHalfplane(se,te);if(le){if(ee.push(re),!ce){const he=intersectLines(ae,te.edge);he!==null&&ee.push(he)}}else if(ce){const he=intersectLines(ae,te.edge);he!==null&&ee.push(he)}}return ee.length>=3?ee:null}function intersectLines(ie,te){const ee=ie.A,ne=ie.B,re=ie.C,se=te.A,ae=te.B,le=te.C,ce=ee*ae-se*ne;if(Math.abs(ce)<1e-6)return null;const he=(ne*le-ae*re)/ce,fe=(se*re-ee*le)/ce;return new Point(he,fe)}const dpr1PixelRatioInfo={horizontalPixelRatio:1,verticalPixelRatio:1};function addPixelPerfectLineToPath(ie,te,ee,ne,re,se){const{horizontalPixelRatio:ae,verticalPixelRatio:le}=se;let ce;if(ee===re){const he=Math.round(ee*le);ce=[te*ae,he,ne*ae,he],addHorizontalLineToPath(ie,ce[1],ce[0],ce[2])}else if(te===ne){const he=Math.round(te*ae);ce=[he,ee*le,he,re*le],addVerticalLineToPath(ie,ce[0],ce[1],ce[3])}else ce=[te*ae,ee*le,ne*ae,re*le],addLineToPath(ie,ce[0],ce[1],ce[2],ce[3]);return ce}function addVerticalLineToPath(ie,te,ee,ne){const re=ie.lineWidth%2===1?.5:0,se=te+re;ie.moveTo(se,ee),ie.lineTo(se,ne)}function addHorizontalLineToPath(ie,te,ee,ne){const re=ie.lineWidth%2===1?.5:0,se=te+re;ie.moveTo(ee,se),ie.lineTo(ne,se)}function addLineToPath(ie,te,ee,ne,re){ie.moveTo(te,ee),ie.lineTo(ne,re)}function drawHorizontalLine(ie,te,ee,ne){ie.beginPath(),addHorizontalLineToPath(ie,te,ee,ne),ie.stroke()}function scaleDashPattern(ie,te){return te=Math.max(1,te),ie.map(ee=>ee*te)}function computeDashPattern(ie,te){return[[ie,2*ie],[5*ie,6*ie],[6*ie,6*ie],[ie,4*ie],[2*ie,ie]][te-1]}function fillRectWithBorder(ie,te,ee,ne,re,se,ae,le,ce){const he=ie.context,fe=se%2/2,Ae=te+fe,pe=ee+fe;let Oe,Fe;if(le){const{color:Ne,borderWidth:ze,borderMode:He,lineStyle:We,dashPattern:je}=le;switch(He){case"outer":{const Ge=-(se/2)-ze/2,Ze=-ze/2;Fe={left:Ae+Ge,right:pe-Ge,top:ne+Ze,bottom:re-Ze};break}case"center":{const Ue=ze%2/2;Fe={left:te+Ue,right:ee+Ue,top:ne+Ue,bottom:re+Ue};break}case"inner":{const Ge=-(se/2)+ze/2,Ze=ze/2;Fe={left:Ae+Ge,right:pe-Ge,top:ne+Ze,bottom:re-Ze};break}}if(he.strokeStyle=Ne,he.lineWidth=ze,je)he.setLineDash(scaleDashPattern(je,ze));else if(We!==void 0){setLineStyle(he,We);const Ue=We===LineStyleType.solid?1:-1;Oe={left:Fe.left+Ue*le.borderWidth/2,top:Fe.top+Ue*le.borderWidth/2,right:Fe.right-Ue*le.borderWidth/2,bottom:Fe.bottom-Ue*le.borderWidth/2}}}if(ae){if(he.fillStyle=ae.color,!Oe){const Ne=se/2;Oe={left:Ae-Ne,right:pe+Ne,top:ne,bottom:re}}he.fillRect(Oe.left,Oe.top,Oe.right-Oe.left,Oe.bottom-Oe.top)}if(ce){const{lineWidth:Ne,lineColor:ze,lineStyle:He,excludeBoundaries:We}=ce;he.save(),he.lineCap="butt",he.lineWidth=Ne,he.strokeStyle=ze,setLineStyle(he,He);const je=Math.floor((ne+re)/2),Ue=()=>{drawHorizontalLine(he,je,te,ee)};We?drawWithExclusionAreaByScope(ie,We,Ue):Ue(),he.restore()}Fe&&he.strokeRect(Fe.left,Fe.top,Fe.right-Fe.left,Fe.bottom-Fe.top)}function addExclusionAreaByScope(ie,te){const{context:ee,horizontalPixelRatio:ne,verticalPixelRatio:re,bitmapSize:se}=ie;ee.beginPath(),ee.rect(0,0,se.width,se.height);for(let ae=0;ae<te.length;ae++){const le=te[ae],ce=le.x*ne,he=le.y*re;ae===0?ee.moveTo(ce,he):ee.lineTo(ce,he)}ee.closePath(),ee.clip("evenodd")}function drawWithExclusionAreaByScope(ie,te,ee){ie.context.save(),addExclusionAreaByScope(ie,te),ee(),ie.context.restore()}function drawRoundRect(ie,te,ee,ne,re,se,ae=!1){let le,ce,he,fe;if(Array.isArray(se))if(se.length===2){const Ae=Math.max(0,se[0]),pe=Math.max(0,se[1]);le=ce=Ae,he=fe=pe}else if(se.length===4)le=Math.max(0,se[0]),ce=Math.max(0,se[1]),he=Math.max(0,se[2]),fe=Math.max(0,se[3]);else throw new Error("Invalid corner radius array. Must be either [tl/tr] or [tl, tr, br, bl].");else le=ce=he=fe=Math.max(0,se);if(ae||ie.beginPath(),ie.roundRect){ie.roundRect(te,ee,ne,re,[le,ce,he,fe]);return}ie.moveTo(te+le,ee),ie.lineTo(te+ne-ce,ee),ce!==0&&ie.arcTo(te+ne,ee,te+ne,ee+ce,ce),ie.lineTo(te+ne,ee+re-he),he!==0&&ie.arcTo(te+ne,ee+re,te+ne-he,ee+re,he),ie.lineTo(te+fe,ee+re),fe!==0&&ie.arcTo(te,ee+re,te,ee+re-fe,fe),ie.lineTo(te,ee+le),le!==0&&ie.arcTo(te,ee,te+le,ee,le)}function createCircle(ie,te,ee,ne){ie.beginPath(),ie.arc(te,ee,ne,0,2*Math.PI,!1),ie.closePath()}function drawLine(ie,te,ee,ne,re){isFinite(te)&&isFinite(ee)&&isFinite(ne)&&isFinite(re)&&(ie.beginPath(),addLineToPath(ie,te,ee,ne,re),ie.stroke())}function drawRoundRectWithBorder(ie,te,ee,ne,re,se,ae=0,le=[0,0,0,0],ce="",he=[],fe=null){if(ie.save(),ie.setLineDash(he),fe&&(ie.shadowColor=fe.shadowColor,ie.shadowBlur=fe.shadowBlur,ie.shadowOffsetX=fe.shadowOffsetX??0,ie.shadowOffsetY=fe.shadowOffsetY??0),!ae||!ce||ce===se){drawRoundRect(ie,te,ee,ne,re,le),ie.fillStyle=se,ie.fill(),ie.restore();return}const Ae=ae/2,pe=changeBorderRadius(le,-Ae);drawRoundRect(ie,te+Ae,ee+Ae,ne-ae,re-ae,pe),se!=="transparent"&&(ie.fillStyle=se,ie.fill()),ce!=="transparent"&&(ie.lineWidth=ae,ie.strokeStyle=ce,ie.closePath(),ie.stroke()),ie.restore()}function changeBorderRadius(ie,te){return ie.map(ee=>ee===0?ee:ee+te)}function clipPolygonByEdge(ie,te,ee,ne){const[re,se]=ne,ae=arePointsEqual(ee,re)?arePointsEqual(ee,se)?null:se:re;if(ie!==null&&ae!==null){const le=lineThroughPoints(te,ee),ce=halfplaneThroughPoint(le,ae);return intersectPolygonAndHalfplane(ie,ce)}return null}function drawVerticalLine(ie,te,ee,ne){ie.beginPath(),addVerticalLineToPath(ie,te,ee,ne),ie.stroke()}function drawPixelPerfectLine(ie,te,ee,ne,re,se=dpr1PixelRatioInfo){ie.beginPath(),addPixelPerfectLineToPath(ie,te,ee,ne,re,se),ie.stroke()}class PaneRenderer{constructor(te=null,ee,ne,re){Ee(this,"_hitTest",null);Ee(this,"_backgroundHitTest",null);this._data=te,this._hitTestCollector=ee,ne&&(this._hitTest=ne),re&&(this._backgroundHitTest=re)}setData(te){this._data=te}data(){return ensure(this._data)}setHitTest(te){this._hitTest=te}setBackgroundHitTest(te){this._backgroundHitTest=te}}class BitmapCoordinatesPaneRenderer extends PaneRenderer{draw(te){te.useBitmapCoordinateSpace(ee=>{this.drawImpl(ee)})}}class MediaCoordinatesPaneRenderer extends PaneRenderer{draw(te){return te.useMediaCoordinateSpace(ee=>this.drawImpl(ee))}}var AnchorStyle=(ie=>(ie[ie.circle=1]="circle",ie[ie.square=2]="square",ie))(AnchorStyle||{});class AnchorPoint extends Point{constructor(ee,ne=Object.create(null)){super(ee);Ee(this,"pointIndex",0);Ee(this,"cursorType");Ee(this,"style",1);Ee(this,"hitTarget",HitTarget.ChangePoint);Ee(this,"resizeDirections",AnchorResizeAll);Object.assign(this,ne)}get point(){return this}}class LineAnchorRenderer extends BitmapCoordinatesPaneRenderer{drawImpl(te){if(!this._data||!this._data.visible)return;const ee=[],ne=[],re=[],se=[];for(let ae=0;ae<this._data.points.length;++ae){const le=this._data.points[ae],ce=this._data.backgroundColors[ae];le.style===2||le.resizeDirections===AnchorResizeVert||le.resizeDirections===AnchorResizeHorz?(ee.push(le),ne.push(ce)):(re.push(le),se.push(ce))}ee.length>0&&this._drawPoints(te,ee,ne,drawSquare,drawSquareOutline),re.length>0&&this._drawPoints(te,re,se,drawCircle,drawCircleOutline)}hitTest(te){if(!this._data)return null;const{radius:ee,points:ne}=this._data,re=interactionTolerance().anchor;for(let se=0;se<ne.length;++se){const ae=ne[se];if(new Point(ae).subtract(te).length()<=ee+re)return new HitTestResult(ae.hitTarget,{areaName:AreaName.AnchorPoint,componentIndex:ae.pointIndex,cursorType:ae.cursorType??PaneCursor.unset,resizeDirections:ae.resizeDirections})}return null}_drawPoints(te,ee,ne,re,se){const{context:ae,horizontalPixelRatio:le,verticalPixelRatio:ce}=te,he=ensure(this._data),fe=he.radius;let Ae=Math.max(1,Math.floor((he.strokeWidth||2)*le));he.selected&&(Ae+=Math.max(1,Math.floor(le/2)));const pe=Math.max(1,Math.floor(le));let Oe=Math.round(fe*le*2);Oe%2!==pe%2&&(Oe+=1);const Fe=pe%2/2,Ne=interactionTolerance().anchor;ae.strokeStyle=he.color,setLineStyle(ae,LineStyleType.solid);for(let ze=0;ze<ee.length;++ze){const He=ee[ze];if(ae.fillStyle=ne[ze],!(isInteger(He.pointIndex)&&he.linePointBeingEdited===He.pointIndex)){const We=Math.round(He.x*le)+Fe,je=Math.round(He.y*ce)+Fe;re(ae,{x:We,y:je},Oe/2,Ae);let Ue=Number.MAX_SAFE_INTEGER;if(he.currentPoint&&(Ue=euclideanDistanceBetweenPoints(He,he.currentPoint)),Ue<=fe+Ne){const Ge=Math.max(1,Math.floor(he.selectedStrokeWidth*le));let Ze=Math.round(fe*le*2);Ze%2!==pe%2&&(Ze+=1),se(ae,{x:We,y:je},Ze/2,Ge)}}}}}function doDrawSquare(ie,te,ee,ne){const re=ee+ne/2;drawRoundRect(ie,te.x-re,te.y-re,2*re,2*re,(ee+ne)/2),ie.closePath(),ie.lineWidth=ne}function drawSquare(ie,te,ee,ne){doDrawSquare(ie,te,ee-ne,ne),ie.fill(),ie.stroke()}function drawSquareOutline(ie,te,ee,ne){ie.globalAlpha=.2,doDrawSquare(ie,te,ee,ne),ie.stroke(),ie.globalAlpha=1}function drawCircle(ie,te,ee,ne){ie.beginPath(),ie.arc(te.x,te.y,ee-ne/2,0,2*Math.PI,!0),ie.closePath(),ie.lineWidth=ne,ie.fill(),ie.stroke()}function drawCircleOutline(ie,te,ee,ne){ie.globalAlpha=.2,ie.beginPath(),ie.arc(te.x,te.y,ee+ne/2,0,2*Math.PI,!0),ie.closePath(),ie.lineWidth=ne,ie.stroke(),ie.globalAlpha=1}function positionsBox(ie,te,ee){const ne=Math.round(ee*ie),re=Math.round(ee*te);return{position:Math.min(ne,re),length:Math.abs(re-ne)+1}}function positionsLine(ie,te,ee=1,ne){const re=Math.round(te*ie),se=Math.round(ee*te),ae=centreOffset(se);return{position:re-ae,length:se}}function centreOffset(ie){return Math.floor(ie*.5)}class AxisPaneRenderer{constructor(te,ee){this._data=te,this._vertical=ee,this._vertical=ee}draw(te){te.useBitmapCoordinateSpace(ee=>{if(!this._data)return;const{p0:ne,p1:re,background:se,maxDimension:ae,visible:le}=this._data;if(!le||ne===null||re===null)return;const ce=ee.context,he=positionsBox(ne,re,this._vertical?ee.verticalPixelRatio:ee.horizontalPixelRatio);ce.fillStyle=se,this._vertical?ce.fillRect(0,he.position,ae*ee.horizontalPixelRatio,he.length):ce.fillRect(he.position,0,he.length,ae*ee.verticalPixelRatio)})}}class AxisPaneView{constructor(te,ee){this._data=te,this._vertical=ee}update(te){this._data=te}renderer(){return new AxisPaneRenderer(this._data,this._vertical)}zOrder(){return"bottom"}}class PriceRangeAxisPaneView extends AxisPaneView{constructor(te=null){super(te,!0)}}class TimeRangeAxisPaneView extends AxisPaneView{constructor(te=null){super(te,!1)}}class SeriesPrimitive{constructor(te=void 0,ee=void 0){Ee(this,"_chart");Ee(this,"_series");Ee(this,"_prevSeries");Ee(this,"_isAttached",!1);Ee(this,"_requestUpdate");Ee(this,"_fireDataUpdated",te=>{this.dataUpdated&&this.dataUpdated(te)});te&&(this._chart=te),ee&&(this._series=ee)}requestUpdate(){this.isAttached&&this._requestUpdate&&this._requestUpdate()}attached({chart:te,series:ee,requestUpdate:ne}){this._isAttached=!0,this._chart=te,this._series=ee,this._series.subscribeDataChanged(this._fireDataUpdated),this._requestUpdate=ne,this.requestUpdate()}attach(te){te.attachPrimitive(this)}reAttach(){ensure(this._prevSeries).attachPrimitive(this),this._prevSeries=void 0}detach(){var te;(te=this._series)==null||te.detachPrimitive(this)}detached(){var te;this._isAttached=!1,(te=this._series)==null||te.unsubscribeDataChanged(this._fireDataUpdated),this._prevSeries=this.series,this._chart=void 0,this._series=void 0,this._requestUpdate=void 0}get isAttached(){return this._isAttached}get chart(){return ensure(this._chart)}get series(){return ensure(this._series)}}const axisLabelBackground="#2A62FF",axisLabelForeground="#FFFFFF",axisRangeColor="#2962FF33";class ToolPrimitive extends SeriesPrimitive{constructor(ee,ne,re,se,ae,le){super(se,ae);Ee(this,"disableUserSelection",!1);Ee(this,"_paneView",[]);Ee(this,"_priceAxisPaneViews",[]);Ee(this,"_timeAxisPaneViews",[]);Ee(this,"_timeAxisViews",[]);Ee(this,"_priceAxisViews",[]);Ee(this,"disableExtendTime",!1);Ee(this,"_currentDragTarget",0);this._props=ee,this.type=ne,this._ctx=re,this.model=le}get id(){return this._props.id}get controlPoints(){return this._props.points}get isDrawing(){return this.model.currentCreating===this}isActive(){return this.model.currentActive===this}isCreationFinished(){return this.model.currentCreating!==this}properties(){return this._props}priceScale(){return this.series}timeScale(){return this.chart.timeScale()}getScope(){return{mediaSize:{width:this.chart.timeScale().width(),height:this.series.getPane().getHeight()}}}symbolInfo(){return this._ctx.chartService.symbolInfo()}timeSpanFormatter(){return this._ctx.timeSpanFormatter}get hitTestCollector(){return ee=>{this._ctx.hitTestCollector(this.id,ee)}}updateProps(ee){Object.assign(this._props,ee),this.updateAllViews(),this.requestUpdate()}updateActive(){this.updateAllViews(),this.requestUpdate()}updateHover(){this.updateAllViews(),this.requestUpdate()}onDragStart(ee){this._currentDragTarget=ee.target,this._currentDragTarget===HitTarget.MovePoint&&this.startMoving(),this._currentDragTarget===HitTarget.ChangePoint&&(should(isAnchorDetails(ee.details)),this.startChanging(ee.details.componentIndex))}onDragEnd(){this._currentDragTarget===HitTarget.MovePoint&&this.endMoving(),this._currentDragTarget===HitTarget.ChangePoint&&this.endChanging(),this._currentDragTarget=0}updateMove(ee,ne){this.addPoint(ee,ne),this.updateAllViews(),this.requestUpdate()}updateStroke(ee){}startChanging(ee){}endChanging(){}startMoving(){}move(){}endMoving(){}updateDrag(ee,ne,re,se,ae,le,ce,he,fe){this._currentDragTarget=ee;const Ae=se-re,pe=le-ae;switch(ee){case HitTarget.MovePoint:this._props.points.forEach((Oe,Fe)=>{ne[Fe]&&(Oe.time=ne[Fe].time+Ae,Oe.price=ne[Fe].price+pe)}),this.move();break;case HitTarget.ChangePoint:{should(isAnchorDetails(he));const Oe=he.componentIndex;this.setPoint(Oe,{time:se,price:le},{shiftkey:fe.shiftkey,startTime:re,endTime:se,get deltaTime(){return se-re},startPrice:ae,endPrice:le,get deltaPrice(){return le-ae},startPoint:ne[Oe],screenPoint:ce,startPoints:ne});break}}this.updateAllViews(),this.requestUpdate()}setPoint(ee,ne,re){this.controlPoints[ee]=ne}addPoint(ee,ne){return this.controlPoints[ne]=ee,AddPointResponse.Accept}finish(){this.isAttached&&(this.updateAllViews(),this.requestUpdate())}abort(){return this.model.currentCreating===this&&this.model.markCreatingFinishedOrAborted(this),DrawingAbortBehavior.Remove}pointToScreenPoint(ee){return new Point(ee.time?ensure(this.chart.timeScale().timeToCoordinateEx(ee.time)):NaN,ensure(this.series.priceToCoordinate(ee.price)))}screenPointToPoint(ee){return{time:ensure(this.chart.timeScale().coordinateToTimeEx(ee.x)),price:ensure(this.series.coordinateToPrice(ee.y))}}getIndex(ee){return this.chart.timeScale().timeToIndexEx(ee.time)}paneViews(){return this._paneView}timeAxisPaneViews(){return this._timeAxisPaneViews}priceAxisPaneViews(){return this._priceAxisPaneViews}timeAxisViews(){return this._timeAxisViews}priceAxisViews(){return this._priceAxisViews}asTextToolPrimitive(){}_calculateTimeAxisViewData(ee,ne,re){return{foreground:axisLabelForeground,background:axisLabelBackground,coordinate:ne,text:this._ctx.dateTimeFormatter(ee),visible:!isUndefinedOrNull(ee)&&this.isActive(),...re}}_calculatePriceAxisViewData(ee,ne,re){return{foreground:axisLabelForeground,background:axisLabelBackground,coordinate:ne,text:this._ctx.priceLabelFormatter(ee),visible:this.isActive(),...re}}_calculatePriceAxisPaneViewData(ee,ne){const re=this.series.priceScale().width();return{p0:ee,p1:ne,visible:this.isActive(),background:axisRangeColor,maxDimension:re}}_calculateTimeAxisPaneViewsData(ee,ne){const re=this.chart.timeScale().height();return{p0:ee,p1:ne,visible:this.isActive(),background:axisRangeColor,maxDimension:re}}}class BaseTextPrimitive extends ToolPrimitive{constructor(te,ee,ne,re,se,ae,le){super(te,ee,ne,re,se,ae),this.editingHelper=le}asTextToolPrimitive(){return this}}const isRtl=()=>window.document.dir==="rtl",LRM="‎",LRE="‪",RLE="‫",PDF="‬",bidiControlCharRegex=new RegExp(LRM+"|"+LRE+"|"+RLE+"|"+PDF,"g");function stripLTRMarks(ie){return ie===""||ie==null||!isRtl()?ie:ie.replace(bidiControlCharRegex,"")}function forceLTRStr(ie){return ie!==""&&ie!==null&&isRtl()?LRE+ie+PDF:ie}function startWithLTR(ie){return ie===""||ie==null||!isRtl()?ie:`${LRM}${ie}`}function getCanvasDevicePixelRatio(ie){var te,ee;return Math.max(1,((ee=(te=ie.ownerDocument)==null?void 0:te.defaultView)==null?void 0:ee.devicePixelRatio)||1)}function drawScaled(ie,te,ee,ne){ie.save(),ie.scale(te,ee),ne(),ie.restore()}function disableSelection(ie){ie.style.userSelect="none",ie.style.webkitUserSelect="none",ie.style.msUserSelect="none",ie.style.MozUserSelect="none",ie.style.webkitTapHighlightColor="transparent"}function createCanvas$1(ie){const te=ie.createElement("canvas");return disableSelection(te),te}function createDisconnectedCanvas(ie,te,ee){const ne=createCanvas$1(ie);return ee===void 0&&(ee=getCanvasDevicePixelRatio(ne)),ne.width=te.width*ee,ne.height=te.height*ee,ne}function getPrescaledContext2D(ie){const te=ensure(ie.getContext("2d")),ee=getCanvasDevicePixelRatio(ie);return te.setTransform(ee,0,0,ee,0,0),te}let canvasContext=null;function measureText(ie,te,ee){if(!canvasContext){const ne=document.createElement("canvas");ne.width=0,ne.height=0,isMacintosh&&(ne.style.display="none",document.body.append(ne)),canvasContext=ensure(ne.getContext("2d")),canvasContext.textBaseline="alphabetic",canvasContext.textAlign="center"}return canvasContext.font=te,ee?ee.getMetrics(canvasContext,ie):getMinTextMetrics(canvasContext.measureText(ie))}function getMinTextMetrics(ie){return{width:ie.width,actualBoundingBoxAscent:ie.actualBoundingBoxAscent,actualBoundingBoxDescent:ie.actualBoundingBoxDescent,fontBoundingBoxAscent:ie.fontBoundingBoxAscent,fontBoundingBoxDescent:ie.fontBoundingBoxDescent}}function calcTextHorizontalShift(ie,te){const ee=ie.textAlign;return ee==="center"?0:isRtl()?ee==="start"||ee==="right"?te:0:ee==="start"||ee==="left"?0:te}class BaseTextRenderer extends BitmapCoordinatesPaneRenderer{constructor(ee){super();Ee(this,"_internalData",null);Ee(this,"_boxSize",null);Ee(this,"_linesInfo",null);Ee(this,"_fontInfo",null);Ee(this,"_centerTextRotationPoint",null);Ee(this,"_polygonPoints",null);Ee(this,"_rotationPoint",null);Ee(this,"_box",null);Ee(this,"_textWidthCache",new et);this._hitTestResult=ee}setHitTestResult(ee){this._hitTestResult=ee}drawImpl(ee){var nr;if(!this._data||!this._data.points||this._data.points.length===0)return;const{mediaSize:ne,horizontalPixelRatio:re,verticalPixelRatio:se,context:ae}=ee;if(this.isOutOfScreen(ne.width,ne.height))return;const le=this._getInternalData(),ce=ensure(this.rotation()),he=new Point(ce.x*re,ce.y*se);ae.save(),ce.angle!==0&&(ae.translate(he.x,he.y),ae.rotate(ce.angle),ae.translate(-he.x,-he.y));const fe=this._getFontInfo().fontSize;ae.textBaseline=le.textBaseLine,ae.textAlign=le.textAlign,ae.font=this.fontStyle();const{scaledLeft:Ae,scaledRight:pe,scaledTop:Oe,scaledBottom:Fe}=scaleBoxToPixelRatio(le,ee),{backgroundColor:Ne,borderColor:ze,highlightBorder:He,wordWrapWidth:We,borderWidth:je,backgroundRoundRect:Ue,boxShadow:Ge,highlightBorderColor:Ze,color:Ye,skipTextDrawing:qe}=this._data;if(Ne||ze||He&&We){const ir=je||Math.max(fe/12,1),tr=Math.round(ir*re),or=tr/2;let Jt=!1;if(Ge){ae.save();const{shadowColor:xr,shadowBlur:Pr,shadowOffsetX:mr=0,shadowOffsetY:Er=0}=Ge;ae.shadowColor=xr,ae.shadowBlur=Pr,ae.shadowOffsetX=mr,ae.shadowOffsetY=Er,Jt=!0}const rr=Ae,lr=Oe,ur=pe-Ae,Sr=Fe-Oe;if(Ue)Ne&&(drawRoundRect(ae,rr,lr,ur,Sr,Ue*re),ae.fillStyle=Ne,ae.fill(),Jt&&(ae.restore(),Jt=!1)),ze&&(drawRoundRect(ae,rr-or,lr-or,ur+tr,Sr+tr,Ue*re+tr),ae.strokeStyle=ze,ae.lineWidth=tr,ae.stroke(),Jt&&ae.restore());else if(Ne&&(ae.fillStyle=Ne,ae.fillRect(rr,lr,ur,Sr),Jt&&(ae.restore(),Jt=!1)),ze||He){let xr;ze?(ae.strokeStyle=ze,xr=tr):(ae.strokeStyle=Ze||Ye,setLineStyle(ae,LineStyleType.dashed),xr=Math.max(1,Math.floor(re))),ae.lineWidth=xr,ae.beginPath(),ae.moveTo(Ae-xr/2,Oe-xr/2),ae.lineTo(Ae-xr/2,Fe+xr/2),ae.lineTo(pe+xr/2,Fe+xr/2),ae.lineTo(pe+xr/2,Oe-xr/2),ae.lineTo(Ae-xr/2,Oe-xr/2),ae.stroke(),Jt&&ae.restore()}}if(!qe){ae.fillStyle=this._data.color;const ir=(Ae+Math.round(le.textHorizStart*re))/re,tr=.05*fe;let or=(Oe+Math.round((le.textVertStart+tr)*se))/se;const Jt=getLineSpacing(this._data),rr=this.getLinesInfo();for(const lr of rr.lines)drawScaled(ae,re,se,()=>{ae.fillText(lr.text,ir,or)}),or+=fe+Jt}(nr=this._data.decorator)==null||nr.draw(ae,ee,this._data,le),ae.restore()}hitTest(ee){return!this._data||this._data.points===void 0||this._data.points.length===0?null:pointInPolygon(ee,this.getPolygonPoints())?this._hitTestResult??new HitTestResult(HitTarget.MovePoint,{cursorType:PaneCursor.text,areaName:AreaName.Text}):null}setData(ee){return ee&&(should(!ee.decorator||ee.wordWrapWidth===void 0,"Decorator is not supported with wordWrapWidth"),isEqual(this._data,ee)||(this._internalData=null,this._boxSize=null,this._polygonPoints=null,this._centerTextRotationPoint=null,this._rotationPoint=null,this._linesInfo=null,this._fontInfo=null,this._box=null)),super.setData(ee)}setPoint(ee,ne,re){const se=ensure(this._data);this.setData({...se,points:[ee],offsetX:ne??se.offsetX,offsetY:re??se.offsetY})}point(){var ee,ne;return((ne=(ee=this._data)==null?void 0:ee.points)==null?void 0:ne[0])??null}rect(){if(!this._data)return{x:0,y:0,width:0,height:0};const{boxLeft:ee,boxTop:ne,boxWidth:re,boxHeight:se}=this._getBox();return{x:ee,y:ne,width:re,height:se}}measure(){if(!this._data)return{width:0,height:0};const ee=this._getBoxSize();return{width:ee.boxWidth,height:ee.boxHeight}}fontStyle(){return this._data?this._getFontInfo().fontStyle:""}lineHeight(){return this._data?getFontSize(this._data):0}lineSpacing(){return this._data?getLineSpacing(this._data):0}rotation(){if(this._rotationPoint===null&&this._data!==null){const ee=this._data.angle??0,ne=this._getRotationPoint();this._rotationPoint={x:ne.x,y:ne.y,angle:ee}}return this._rotationPoint}isOutOfScreen(ee,ne){if(!this._data||!this._data.points||this._data.points.length===0)return!0;const re=this._getInternalData();if(re.boxLeft+re.boxWidth<0||re.boxLeft>ee){const ae=box(new Point(0,0),new Point(ee,ne));return this.getPolygonPoints().every(ce=>!pointInBox$1(ce,ae))}return!1}getPolygonPoints(){if(this._polygonPoints!==null)return this._polygonPoints;if(this._data===null)return[];const ee=this._data.angle||0,{boxLeft:ne,boxTop:re,boxWidth:se,boxHeight:ae}=this._getInternalData(),le=this._getRotationPoint(),ce=new Point(ne,re),he=new Point(ne+se,re),fe=new Point(ne+se,re+ae),Ae=new Point(ne,re+ae),pe=[rotatePoint(ce,le,ee),rotatePoint(he,le,ee),rotatePoint(fe,le,ee),rotatePoint(Ae,le,ee)];return this._polygonPoints=pe,pe}_getFontInfo(){if(this._fontInfo===null){const ee=ensure(this._data),ne=getFontSize(ee),re=(ee.bold?"bold ":"")+(ee.italic?"italic ":"")+ne+"px "+ee.fontFamily;this._fontInfo={fontStyle:re,fontSize:ne}}return this._fontInfo}getLinesInfo(){if(this._linesInfo===null){const ee=ensure(this._data),ne=wordWrap(ee.text,this.fontStyle(),this._textWidthCache,!1,ee.wordWrapWidth);let re=ne.filter(se=>!se.hidden);if(ee.maxHeight!==void 0){const se=(()=>{const ae=ensure(ee.maxHeight),le=getFontSize(ee),ce=getLineSpacing(ee);return Math.floor((ae+ce)/(le+ce))})();re.length>se&&(re=re.slice(0,se))}this._linesInfo={linesMaxWidth:this._getLinesMaxWidth(re),linesIncludingHidden:ne,lines:re}}return this._linesInfo}_getBoxSize(){if(this._boxSize===null){const ee=this.getLinesInfo(),ne=ensure(this._data),re=getBoxWidth(ne,ee.linesMaxWidth),se=getBoxHeight(ne,ee.lines.length);this._boxSize={textBoxWidth:re,textBoxHeight:se,boxWidth:ne.boxWidth??re,boxHeight:ne.boxHeight??se}}return this._boxSize}_getBox(){if(this._box)return this._box;const ee=ensure(this._data),[ne]=ensure(ee.points),{boxWidth:re,boxHeight:se,textBoxWidth:ae,textBoxHeight:le}=this._getBoxSize();let{x:ce,y:he}=ne;switch(ee.vertAlign){case VerticalAlign.Bottom:he-=se+ee.offsetY;break;case VerticalAlign.Middle:he-=se/2;break;case VerticalAlign.Top:he+=ee.offsetY;break}switch(ee.horzAlign){case HorizontalAlign.Left:ce+=ee.offsetX;break;case HorizontalAlign.Center:ce-=re/2;break;case HorizontalAlign.Right:ce-=re+ee.offsetX;break}return this._box={boxLeft:ce,boxTop:he,boxWidth:re,boxHeight:se,textBoxWidth:ae,textBoxHeight:le},this._box}_getLinesMaxWidth(ee){const ne=this.fontStyle();if(this._data&&this._data.wordWrapWidth&&!this._data.forceCalculateMaxLineWidth)return this._data.wordWrapWidth*getFontScale(this._data);let re=0;for(const se of ee){const ae=measureText(se.text,ne,this._textWidthCache).width;re=Math.max(re,ae)}return re}_getInternalData(){var nr;if(this._internalData!==null)return this._internalData;const ee=ensure(this._data),ne=this._getBoxSize(),re=ne.boxWidth,se=ne.boxHeight,ae=ensure(ee.points)[0];let le=ae.y;switch(ee.vertAlign){case"bottom":le-=se+ee.offsetY;break;case"middle":le-=se/2;break;case"top":le+=ee.offsetY;break}let ce=ae.x;const he=getLeftPadding(ee),fe=getRightPadding(ee),Ae=getVerticalPadding(ee),pe=(nr=ee.decorator)==null?void 0:nr.geometry(ee),Oe=(pe==null?void 0:pe.width)??0,Fe=ee.text.length===0?0:(pe==null?void 0:pe.decoratorAndTextMargin)??0,Ne=pe==null?void 0:pe.ignoreRtl,ze=Oe+Fe,He=le+Ae+getFontSize(ee)/2;switch(ee.horzAlign){case"left":ce+=ee.offsetX;break;case"center":ce-=re/2;break;case"right":ce-=re+ee.offsetX;break}const We=isRtl(),je=We&&!Ne;(We||je)&&NOTIMPLEMENTED();const Ue=je?ce+re-fe-Oe:ce+he;let Ge="start",Ze=0;switch(ensure(ee.horzAlign)){case"left":Ge="start",Ze=je?ee.forceTextAlign?Ue:ce+re-fe:Ue+ze,We&&ee.forceTextAlign?Ge="left":je&&(Ze=Ue-Fe,Ge="right");break;case"center":{Ge="center";const ir=re-he-fe-ze;Ze=je?Ue-Fe-ir/2:Ue+ze+ir/2;break}case"right":Ge="end",Ze=je?Ue-Fe:ce+re-fe,We&&ee.forceTextAlign&&(Ge="right");break}const qe={boxLeft:ce,boxTop:le,boxWidth:re,boxHeight:se,textLeft:ce+he+(je?0:ze),textRight:ce+re-fe-(je?ze:0),textTop:le+Ae,textBottom:le+se-Ae,textHorizStart:Ze-ce,textVertStart:He-le,textAlign:Ge,textBaseLine:"middle",decoratorLeft:Ue,decoratorWidth:Oe};return this._internalData=qe}centerTextRotation(){if(this._centerTextRotationPoint===null&&this._data){const ee=this._data.angle??0,ne=this._getRotationPoint(),{textLeft:re,textTop:se,textRight:ae,textBottom:le}=this._getInternalData(),ce=rotatePoint(new Point((re+ae)/2,(se+le)/2),ne,ee);this._centerTextRotationPoint={x:ce.x,y:ce.y,angle:ee}}return this._centerTextRotationPoint??void 0}_getRotationPoint(){const{boxLeft:ee,boxTop:ne,boxWidth:re,boxHeight:se}=this._getInternalData(),{horzAlign:ae,vertAlign:le}=ensure(this._data);let ce,he;switch(ae){case"center":ce=ee+re/2;break;case"left":ce=ee;break;case"right":ce=ee+re;break}switch(le){case"middle":he=ne+se/2;break;case"top":he=ne;break;case"bottom":he=ne+se;break}return new Point(ce,he)}}function getFontSize(ie){return Math.ceil(getBaseFontSize(ie)*getFontScale(ie))}function getBaseFontSize(ie){return ie.fontSize}function getFontScale(ie){const te=Math.min(1,Math.max(.2,ie.scale||1));if(te===1)return te;const ee=getBaseFontSize(ie);return Math.ceil(te*ee)/ee}function getLineSpacing(ie){let te=ie.lineSpacing;return te===void 0&&ie.lineHeight!==void 0&&(te=(ie.lineHeight-1)*getBaseFontSize(ie)),(te??0)*getFontScale(ie)}function getVerticalPadding(ie){return ie.boxPaddingVert!==void 0?ie.boxPaddingVert*getFontScale(ie):ie.boxPadding!==void 0?ie.boxPadding*getFontScale(ie):getFontSize(ie)/3}function getHorizontalPadding(ie){return ie.boxPaddingHorz!==void 0?ie.boxPaddingHorz*getFontScale(ie):ie.boxPadding!==void 0?ie.boxPadding*getFontScale(ie):getFontSize(ie)/3}function getLeftPadding(ie){return ie.boxPaddingLeft!==void 0?ie.boxPaddingLeft*getFontScale(ie):getHorizontalPadding(ie)}function getRightPadding(ie){return ie.boxPaddingRight!==void 0?ie.boxPaddingRight*getFontScale(ie):getHorizontalPadding(ie)}function getBoxWidth(ie,te){var re;const ee=(re=ie.decorator)==null?void 0:re.geometry(ie),ne=Math.round(te+getLeftPadding(ie)+getRightPadding(ie)+((ee==null?void 0:ee.width)??0)+(ie.text.length===0?0:(ee==null?void 0:ee.decoratorAndTextMargin)??0));return ne%2===0?ne:ne+1}function getBoxHeight(ie,te){return getFontSize(ie)*te+getLineSpacing(ie)*(te-1)+2*getVerticalPadding(ie)}function splitTextIntoWords(ie){const te=[];for(;ie.length>0;){const ee=ie.match(/\s+/);if(!ee||ee.index===void 0||ee.index===-1){te.push({word:ie,spaces:""});break}const ne=ie.slice(0,ee.index),re=ee[0];te.push({word:ne,spaces:re}),ie=ie.slice(ee.index+re.length)}return te}function breakLongWordToFit(ie,te,ee,ne){const re=[],se=[];for(let ae=0;ae<ie.length;++ae)se.push(ae);for(;ie.length>0;){const ae=Math.max(1,upperbound(se,ne,(le,ce)=>measureText(ie.slice(0,ce+1),te,ee).width>le,0,ie.length));re.push(ie.slice(0,ae)),ie=ie.slice(ae)}return re}function wordWrap(ie,te,ee,ne=!0,re){const se=isString(re)?parseInt(re):re,ae=(ie+"").split(/\r\n|\r|\n|$/).map(ce=>({text:ce,hidden:!1,wrappedLinePart:!1,wrappedLineEnd:!1}));if(!isFiniteNumber(se)||!isFinite(se)||se<=0||measureText("x",te,ee).width>se)return ae;const le=[];for(let ce=0;ce<ae.length;ce++){const he=ae[ce];if(measureText(he.text,te,ee).width<=se){le.push(he);continue}const fe=splitTextIntoWords(he.text),Ae=!0;let pe="",Oe=0;for(;Oe<fe.length;){const Fe=fe[Oe];let Ne=pe+Fe.word,ze=measureText(Ne,te,ee).width;if(ze>se){if(pe!=="")le.push({text:pe,hidden:!1,wrappedLinePart:Ae,wrappedLineEnd:!1}),pe="";else if(Ne.length===1)le.push({text:Ne,hidden:!1,wrappedLinePart:Ae,wrappedLineEnd:!0}),Fe.word="";else{const We=breakLongWordToFit(Ne,te,ee,se);for(let je=0;je<We.length-1;je++)le.push({text:We[je],hidden:!1,wrappedLinePart:Ae,wrappedLineEnd:!1});Fe.word=We[We.length-1]}continue}if(Ne=pe+Fe.word+Fe.spaces,ze=measureText(Ne,te,ee).width,ze<se){pe=Ne,Oe++;continue}const He=breakLongWordToFit(Ne,te,ee,se);for(let We=0;We<He.length;We++){const Ue={text:He[We],hidden:We>0,wrappedLinePart:Ae,wrappedLineEnd:Oe===fe.length-1&&We===He.length-1};(!Ue.hidden||ne)&&le.push(Ue)}pe="",Oe++}pe!==""&&le.push({text:pe,wrappedLinePart:Ae,hidden:!1,wrappedLineEnd:!0})}return le}function rotatePoint(ie,te,ee){if(ee===0)return ie.clone();const ne=ie.x-te.x,re=ie.y-te.y,se=ne*Math.cos(ee)-re*Math.sin(ee)+te.x,ae=ne*Math.sin(ee)+re*Math.cos(ee)+te.y;return new Point(se,ae)}function scaleBoxToPixelRatio(ie,te){const{horizontalPixelRatio:ee,verticalPixelRatio:ne}=te,re=Math.round(ie.boxLeft*ee),se=Math.round(ie.boxTop*ne),ae=Math.round(ie.boxWidth*ee),le=Math.round(ie.boxHeight*ne);return{scaledLeft:re,scaledRight:re+ae,scaledTop:se,scaledBottom:se+le}}function getTextBoundaries(ie,te,ee){if(ie.isOutOfScreen(te,ee))return null;const ne=ie.getPolygonPoints();return ne.length===0?null:ne}function calculateLabelPosition(ie,te,ee,ne,re){const se=.5*(te.x+ee.x);let ae=ee.y;return te.y>ee.y?(ae-=ie.height/2+ne.y,ae=Math.max(ie.height/2,ae)):(ae+=ie.height/2+ne.y,ae=Math.min(re-ie.height/2,ae)),new Point(se,ae)}function getTextAlignInBox(ie){const{horzAlign:te,extendLeft:ee=!1,extendRight:ne=!1,width:re,leftPoint:se,rightPoint:ae}=ie,le=(se.x<=re||ee)&&(ae.x>=0||ne);let ce,he,fe=te;switch(te){case HorizontalAlign.Left:he=se.y,ee?ce=le?0:ae.x:(ce=se.x,fe=HorizontalAlign.Right);break;case HorizontalAlign.Right:he=ae.y,ne?ce=le?re:se.x:(ce=ae.x,fe=HorizontalAlign.Left);break;default:ce=((ee&&le?0:se.x)+(ne&&le?re:ae.x))/2,he=(se.y+ae.y)/2;break}return[new Point(ce,he),fe]}function needTextExclusionPath(ie){const te=ie.getLinesInfo().lines;return!(te.length%2==0||te[Math.floor(te.length/2)].text.trim()==="")}const Ol=class Ol{geometry(te){const ee=getFontSize(te);return{decoratorAndTextMargin:ee/3,width:Math.round(.8*ee),ignoreRtl:!1}}draw(te,ee,ne,re){const{horizontalPixelRatio:se,verticalPixelRatio:ae}=ee,le=Math.max(1,Math.round(se*re.decoratorWidth/8)),ce=le%2/2,he=Math.round((re.textTop+re.textBottom)/2*ae)+ce,fe=Math.round((re.decoratorLeft+re.decoratorWidth/2)*se)+ce,Ae=Math.round(re.decoratorWidth*se);te.strokeStyle=ne.color,te.lineWidth=le;let pe=Ae/2;fe%2/2!==pe%2/2&&(pe+=.5),te.beginPath(),te.moveTo(fe-pe,he),te.lineTo(fe+pe,he),te.moveTo(fe,he-pe),te.lineTo(fe,he+pe),te.stroke()}static instance(){return this._instance||(this._instance=new Ol),this._instance}};Ee(Ol,"_instance",null);let PlusTextRendererDecorator=Ol;PlusTextRendererDecorator.instance();class LineRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_scope")}drawImpl(ee){const ne=ee.context;if(!this._data)return;const re=this._data;if("points"in re&&re.points.length<2)return;this._scope=ee;const{horizontalPixelRatio:se}=ee;if(re.excludeBoundaries!==void 0){ne.save();for(const Ae of re.excludeBoundaries)addExclusionAreaByScope(ee,Ae)}const ae=re.lineStyle,le=re.lineCap??(ae===LineStyleType.solid?"round":"butt");ne.lineCap=le,ne.lineJoin="round",ne.strokeStyle=re.lineColor,ne.lineWidth=Math.max(1,Math.floor(re.lineWidth*se)),setLineStyle(ne,ae);const ce=re.points[0],he=re.points[1];ne.beginPath(),re.overlayLineEndings?NOTIMPLEMENTED():this._drawEnds(ne,[ce,he],re.lineWidth,ee),this._drawEnds(ne,[ce,he],re.lineWidth,ee);const fe=this._extendAndClipLineSegment(ce,he,ee);fe!==null&&re.lineWidth>0&&addPixelPerfectLineToPath(ne,fe[0].x,fe[0].y,fe[1].x,fe[1].y,ee),re.overlayLineEndings&&NOTIMPLEMENTED(),ne.stroke(),re.excludeBoundaries!==void 0&&ne.restore()}hitTest(ee){const ne=this._scope,re=this._data;if(!re||!ne||re.points.length<2)return null;const ae=(re.hitTestTolerance??interactionTolerance().line)+re.lineWidth/2,le=re.points[0],ce=re.points[1],he=this._extendAndClipLineSegment(le,ce,ne);return he!==null&&distanceToSegment(he[0],he[1],ee).distance<=ae?new HitTestResult(HitTarget.MovePoint):null}_extendAndClipLineSegment(ee,ne,re){const se=ensure(this._data),{width:ae,height:le}=re.mediaSize,{extendLeft:ce,extendRight:he}=se;return extendAndClipLineSegment(new Point(ee),new Point(ne),ae,le,!!ce,!!he)}_drawEnds(ee,ne,re,se){const[ae,le]=ne,ce=ensure(this._data);switch(ce.leftEnd){case LineEnd.Arrow:drawArrow(le,ae,ee,re,se);break}switch(ce.rightEnd){case LineEnd.Arrow:drawArrow(ae,le,ee,re,se);break}}}function drawArrow(ie,te,ee,ne,re,se=!1){if(euclideanDistanceBetweenPoints(ie,te)<1)return;const ae=getArrowPoints(new Point(ie),new Point(te),ne,se,!0).slice(0,2);let le=null;const{horizontalPixelRatio:ce,verticalPixelRatio:he}=re;for(let fe=0;fe<ae.length;++fe){const Ae=ae[fe][0],pe=ae[fe][1];(le===null||euclideanDistanceBetweenPoints(le,Ae)>1)&&ee.moveTo(Ae.x*ce,Ae.y*he),ee.lineTo(pe.x*ce,pe.y*he),le=pe}}function getArrowPoints(ie,te,ee,ne,re){const se=.5*ee,ae=Math.sqrt(2),le=te.subtract(ie),ce=le.normalized();let he=5*ee;ne&&(he=Math.min(he,.35*le.length()));const fe=se*1;if(he*ae*.2<=fe)return[];const Ae=ce.scaled(he),pe=te.subtract(Ae),Oe=ce.transposed(),Fe=Oe.scaled(he),Ne=pe.add(Fe),ze=pe.subtract(Fe),He=Ne.subtract(te).normalized().scaled(fe),We=ze.subtract(te).normalized().scaled(fe),je=re?te:te.add(He),Ue=re?te:te.add(We),Ge=se*(ae-1),Ze=Oe.scaled(Ge),Ye=Math.min(he-se/ae,se*ae),qe=ce.scaled(Ye),nr=te.subtract(Ze),ir=te.add(Ze),tr=te.subtract(qe),or=tr.subtract(Ze),Jt=tr.add(Ze);return[[Ne,je],[Ue,ze],[nr,or],[ir,Jt]]}function extendAndClipLineSegment(ie,te,ee,ne,re,se){if(arePointsEqual(ie,te))return null;const ae=new Point(0,0),le=new Point(ee,ne),ce=box(ae,le);if(re)if(se){const he=intersectLineAndBox(lineThroughPoints(ie,te),ce);return Array.isArray(he)?he:null}else{const he=intersectRayAndBox(te,ie,ce);return he&&!arePointsEqual(te,he)?lineSegment(te,he):null}if(se){const he=intersectRayAndBox(ie,te,ce);return he&&!arePointsEqual(ie,he)?lineSegment(ie,he):null}else{const he=intersectLineSegmentAndBox(lineSegment(ie,te),ce);return Array.isArray(he)?he:null}}const DEFAULT_COLOR="#2A62FF";class SelectionRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){if(!this._data||!this._data.visible)return null;for(let ee=0;ee<this._data.points.length;ee++){const ne=this._data.points[ee];if(new Point(ne).subtract(te).length()<=5.5)return new HitTestResult(this._data.hitTarget,{areaName:AreaName.AnchorPoint,componentIndex:ne.pointIndex,cursorType:ne.cursorType??PaneCursor.unset,resizeDirections:0})}return null}doesIntersectWithBox(te){return!!this._data&&this._data.points.some(ee=>pointInBox$1(ee,te))}drawImpl(te){if(!this._data||!this._data.visible)return;const{context:ee,horizontalPixelRatio:ne}=te;ee.strokeStyle=this._data.color??DEFAULT_COLOR,ee.lineCap="butt";const re=Math.max(1,Math.floor(ne));ee.lineWidth=re;const se=this._data.vertOffset??0;for(let ae=0;ae<this._data.points.length;++ae){const le=this._data.points[ae];Number.isFinite(le.x)&&Number.isFinite(le.y)&&(ee.fillStyle=this._data.bgColors[ae],this._drawMarker(te,{x:le.x,y:le.y},se,re))}}_drawMarker(te,ee,ne,re){const{context:se,horizontalPixelRatio:ae,verticalPixelRatio:le}=te;let ce=Math.round(3.5*ae*2);ce%2!==re%2&&(ce+=1);let he=Math.round(ce+2*(.5*re+.75*ae));he%2!==re%2&&(he+=1);const fe=Math.round(ee.x*ae),Ae=Math.round((ee.y+ne)*le),pe=re%2/2;se.beginPath(),se.arc(fe+pe,Ae+pe,he/2,0,2*Math.PI,!0),se.closePath(),se.fill(),se.beginPath(),se.arc(fe+pe,Ae+pe,ce/2,0,2*Math.PI,!0),se.closePath(),se.stroke()}}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lodash$1={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var lodash=lodash$1.exports,hasRequiredLodash;function requireLodash(){return hasRequiredLodash||(hasRequiredLodash=1,function(ie,te){(function(){var ee,ne="4.17.21",re=200,se="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",ae="Expected a function",le="Invalid `variable` option passed into `_.template`",ce="__lodash_hash_undefined__",he=500,fe="__lodash_placeholder__",Ae=1,pe=2,Oe=4,Fe=1,Ne=2,ze=1,He=2,We=4,je=8,Ue=16,Ge=32,Ze=64,Ye=128,qe=256,nr=512,ir=30,tr="...",or=800,Jt=16,rr=1,lr=2,ur=3,Sr=1/0,xr=9007199254740991,Pr=17976931348623157e292,mr=NaN,Er=4294967295,dr=Er-1,Cr=Er>>>1,Or=[["ary",Ye],["bind",ze],["bindKey",He],["curry",je],["curryRight",Ue],["flip",nr],["partial",Ge],["partialRight",Ze],["rearg",qe]],Ar="[object Arguments]",Ir="[object Array]",wr="[object AsyncFunction]",Dr="[object Boolean]",Ur="[object Date]",zr="[object DOMException]",Fr="[object Error]",Jr="[object Function]",po="[object GeneratorFunction]",so="[object Map]",ho="[object Number]",Lo="[object Null]",bo="[object Object]",Uo="[object Promise]",Br="[object Proxy]",Vr="[object RegExp]",Yr="[object Set]",Zr="[object String]",uo="[object Symbol]",ro="[object Undefined]",Rr="[object WeakMap]",fr="[object WeakSet]",er="[object ArrayBuffer]",Tr="[object DataView]",to="[object Float32Array]",Fo="[object Float64Array]",Sa="[object Int8Array]",Ja="[object Int16Array]",kl="[object Int32Array]",Vl="[object Uint8Array]",Fl="[object Uint8ClampedArray]",Bl="[object Uint16Array]",Nl="[object Uint32Array]",Fu=/\b__p \+= '';/g,Bu=/\b(__p \+=) '' \+/g,Nu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,eh=/&(?:amp|lt|gt|quot|#39);/g,th=/[&<>"']/g,$u=RegExp(eh.source),zu=RegExp(th.source),Hu=/<%-([\s\S]+?)%>/g,Wu=/<%([\s\S]+?)%>/g,ih=/<%=([\s\S]+?)%>/g,Uu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ju=/^\w*$/,Ku=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$l=/[\\^$.*+?()[\]{}|]/g,Zu=RegExp($l.source),zl=/^\s+/,Gu=/\s/,Yu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Xu=/\{\n\/\* \[wrapped with (.+)\] \*/,qu=/,? & /,Qu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ju=/[()=,{}\[\]\/\s]/,e1=/\\(\\)?/g,t1=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,nh=/\w*$/,n1=/^[-+]0x[0-9a-f]+$/i,r1=/^0b[01]+$/i,s1=/^\[object .+?Constructor\]$/,o1=/^0o[0-7]+$/i,a1=/^(?:0|[1-9]\d*)$/,l1=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,N0=/($^)/,c1=/['\n\r\u2028\u2029\\]/g,$0="\\ud800-\\udfff",h1="\\u0300-\\u036f",d1="\\ufe20-\\ufe2f",u1="\\u20d0-\\u20ff",rh=h1+d1+u1,sh="\\u2700-\\u27bf",oh="a-z\\xdf-\\xf6\\xf8-\\xff",f1="\\xac\\xb1\\xd7\\xf7",p1="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",g1="\\u2000-\\u206f",m1=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ah="A-Z\\xc0-\\xd6\\xd8-\\xde",lh="\\ufe0e\\ufe0f",ch=f1+p1+g1+m1,Hl="['’]",_1="["+$0+"]",hh="["+ch+"]",z0="["+rh+"]",dh="\\d+",v1="["+sh+"]",uh="["+oh+"]",fh="[^"+$0+ch+dh+sh+oh+ah+"]",Wl="\\ud83c[\\udffb-\\udfff]",w1="(?:"+z0+"|"+Wl+")",ph="[^"+$0+"]",Ul="(?:\\ud83c[\\udde6-\\uddff]){2}",jl="[\\ud800-\\udbff][\\udc00-\\udfff]",e0="["+ah+"]",gh="\\u200d",mh="(?:"+uh+"|"+fh+")",y1="(?:"+e0+"|"+fh+")",_h="(?:"+Hl+"(?:d|ll|m|re|s|t|ve))?",vh="(?:"+Hl+"(?:D|LL|M|RE|S|T|VE))?",wh=w1+"?",yh="["+lh+"]?",b1="(?:"+gh+"(?:"+[ph,Ul,jl].join("|")+")"+yh+wh+")*",x1="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",T1="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",bh=yh+wh+b1,P1="(?:"+[v1,Ul,jl].join("|")+")"+bh,A1="(?:"+[ph+z0+"?",z0,Ul,jl,_1].join("|")+")",S1=RegExp(Hl,"g"),C1=RegExp(z0,"g"),Kl=RegExp(Wl+"(?="+Wl+")|"+A1+bh,"g"),M1=RegExp([e0+"?"+uh+"+"+_h+"(?="+[hh,e0,"$"].join("|")+")",y1+"+"+vh+"(?="+[hh,e0+mh,"$"].join("|")+")",e0+"?"+mh+"+"+_h,e0+"+"+vh,T1,x1,dh,P1].join("|"),"g"),E1=RegExp("["+gh+$0+rh+lh+"]"),D1=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,R1=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],I1=-1,mo={};mo[to]=mo[Fo]=mo[Sa]=mo[Ja]=mo[kl]=mo[Vl]=mo[Fl]=mo[Bl]=mo[Nl]=!0,mo[Ar]=mo[Ir]=mo[er]=mo[Dr]=mo[Tr]=mo[Ur]=mo[Fr]=mo[Jr]=mo[so]=mo[ho]=mo[bo]=mo[Vr]=mo[Yr]=mo[Zr]=mo[Rr]=!1;var go={};go[Ar]=go[Ir]=go[er]=go[Tr]=go[Dr]=go[Ur]=go[to]=go[Fo]=go[Sa]=go[Ja]=go[kl]=go[so]=go[ho]=go[bo]=go[Vr]=go[Yr]=go[Zr]=go[uo]=go[Vl]=go[Fl]=go[Bl]=go[Nl]=!0,go[Fr]=go[Jr]=go[Rr]=!1;var L1={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},O1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},k1={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V1={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},F1=parseFloat,B1=parseInt,xh=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,N1=typeof self=="object"&&self&&self.Object===Object&&self,Eo=xh||N1||Function("return this")(),Zl=te&&!te.nodeType&&te,$a=Zl&&!0&&ie&&!ie.nodeType&&ie,Th=$a&&$a.exports===Zl,Gl=Th&&xh.process,qo=function(){try{var ar=$a&&$a.require&&$a.require("util").types;return ar||Gl&&Gl.binding&&Gl.binding("util")}catch{}}(),Ph=qo&&qo.isArrayBuffer,Ah=qo&&qo.isDate,Sh=qo&&qo.isMap,Ch=qo&&qo.isRegExp,Mh=qo&&qo.isSet,Eh=qo&&qo.isTypedArray;function jo(ar,gr,pr){switch(pr.length){case 0:return ar.call(gr);case 1:return ar.call(gr,pr[0]);case 2:return ar.call(gr,pr[0],pr[1]);case 3:return ar.call(gr,pr[0],pr[1],pr[2])}return ar.apply(gr,pr)}function $1(ar,gr,pr,kr){for(var jr=-1,oo=ar==null?0:ar.length;++jr<oo;){var Po=ar[jr];gr(kr,Po,pr(Po),ar)}return kr}function Qo(ar,gr){for(var pr=-1,kr=ar==null?0:ar.length;++pr<kr&&gr(ar[pr],pr,ar)!==!1;);return ar}function z1(ar,gr){for(var pr=ar==null?0:ar.length;pr--&&gr(ar[pr],pr,ar)!==!1;);return ar}function Dh(ar,gr){for(var pr=-1,kr=ar==null?0:ar.length;++pr<kr;)if(!gr(ar[pr],pr,ar))return!1;return!0}function Ca(ar,gr){for(var pr=-1,kr=ar==null?0:ar.length,jr=0,oo=[];++pr<kr;){var Po=ar[pr];gr(Po,pr,ar)&&(oo[jr++]=Po)}return oo}function H0(ar,gr){var pr=ar==null?0:ar.length;return!!pr&&t0(ar,gr,0)>-1}function Yl(ar,gr,pr){for(var kr=-1,jr=ar==null?0:ar.length;++kr<jr;)if(pr(gr,ar[kr]))return!0;return!1}function _o(ar,gr){for(var pr=-1,kr=ar==null?0:ar.length,jr=Array(kr);++pr<kr;)jr[pr]=gr(ar[pr],pr,ar);return jr}function Ma(ar,gr){for(var pr=-1,kr=gr.length,jr=ar.length;++pr<kr;)ar[jr+pr]=gr[pr];return ar}function Xl(ar,gr,pr,kr){var jr=-1,oo=ar==null?0:ar.length;for(kr&&oo&&(pr=ar[++jr]);++jr<oo;)pr=gr(pr,ar[jr],jr,ar);return pr}function H1(ar,gr,pr,kr){var jr=ar==null?0:ar.length;for(kr&&jr&&(pr=ar[--jr]);jr--;)pr=gr(pr,ar[jr],jr,ar);return pr}function ql(ar,gr){for(var pr=-1,kr=ar==null?0:ar.length;++pr<kr;)if(gr(ar[pr],pr,ar))return!0;return!1}var W1=Ql("length");function U1(ar){return ar.split("")}function j1(ar){return ar.match(Qu)||[]}function Rh(ar,gr,pr){var kr;return pr(ar,function(jr,oo,Po){if(gr(jr,oo,Po))return kr=oo,!1}),kr}function W0(ar,gr,pr,kr){for(var jr=ar.length,oo=pr+(kr?1:-1);kr?oo--:++oo<jr;)if(gr(ar[oo],oo,ar))return oo;return-1}function t0(ar,gr,pr){return gr===gr?n2(ar,gr,pr):W0(ar,Ih,pr)}function K1(ar,gr,pr,kr){for(var jr=pr-1,oo=ar.length;++jr<oo;)if(kr(ar[jr],gr))return jr;return-1}function Ih(ar){return ar!==ar}function Lh(ar,gr){var pr=ar==null?0:ar.length;return pr?ec(ar,gr)/pr:mr}function Ql(ar){return function(gr){return gr==null?ee:gr[ar]}}function Jl(ar){return function(gr){return ar==null?ee:ar[gr]}}function Oh(ar,gr,pr,kr,jr){return jr(ar,function(oo,Po,fo){pr=kr?(kr=!1,oo):gr(pr,oo,Po,fo)}),pr}function Z1(ar,gr){var pr=ar.length;for(ar.sort(gr);pr--;)ar[pr]=ar[pr].value;return ar}function ec(ar,gr){for(var pr,kr=-1,jr=ar.length;++kr<jr;){var oo=gr(ar[kr]);oo!==ee&&(pr=pr===ee?oo:pr+oo)}return pr}function tc(ar,gr){for(var pr=-1,kr=Array(ar);++pr<ar;)kr[pr]=gr(pr);return kr}function G1(ar,gr){return _o(gr,function(pr){return[pr,ar[pr]]})}function kh(ar){return ar&&ar.slice(0,Nh(ar)+1).replace(zl,"")}function Ko(ar){return function(gr){return ar(gr)}}function ic(ar,gr){return _o(gr,function(pr){return ar[pr]})}function w0(ar,gr){return ar.has(gr)}function Vh(ar,gr){for(var pr=-1,kr=ar.length;++pr<kr&&t0(gr,ar[pr],0)>-1;);return pr}function Fh(ar,gr){for(var pr=ar.length;pr--&&t0(gr,ar[pr],0)>-1;);return pr}function Y1(ar,gr){for(var pr=ar.length,kr=0;pr--;)ar[pr]===gr&&++kr;return kr}var X1=Jl(L1),q1=Jl(O1);function Q1(ar){return"\\"+V1[ar]}function J1(ar,gr){return ar==null?ee:ar[gr]}function i0(ar){return E1.test(ar)}function e2(ar){return D1.test(ar)}function t2(ar){for(var gr,pr=[];!(gr=ar.next()).done;)pr.push(gr.value);return pr}function nc(ar){var gr=-1,pr=Array(ar.size);return ar.forEach(function(kr,jr){pr[++gr]=[jr,kr]}),pr}function Bh(ar,gr){return function(pr){return ar(gr(pr))}}function Ea(ar,gr){for(var pr=-1,kr=ar.length,jr=0,oo=[];++pr<kr;){var Po=ar[pr];(Po===gr||Po===fe)&&(ar[pr]=fe,oo[jr++]=pr)}return oo}function U0(ar){var gr=-1,pr=Array(ar.size);return ar.forEach(function(kr){pr[++gr]=kr}),pr}function i2(ar){var gr=-1,pr=Array(ar.size);return ar.forEach(function(kr){pr[++gr]=[kr,kr]}),pr}function n2(ar,gr,pr){for(var kr=pr-1,jr=ar.length;++kr<jr;)if(ar[kr]===gr)return kr;return-1}function r2(ar,gr,pr){for(var kr=pr+1;kr--;)if(ar[kr]===gr)return kr;return kr}function n0(ar){return i0(ar)?o2(ar):W1(ar)}function sa(ar){return i0(ar)?a2(ar):U1(ar)}function Nh(ar){for(var gr=ar.length;gr--&&Gu.test(ar.charAt(gr)););return gr}var s2=Jl(k1);function o2(ar){for(var gr=Kl.lastIndex=0;Kl.test(ar);)++gr;return gr}function a2(ar){return ar.match(Kl)||[]}function l2(ar){return ar.match(M1)||[]}var c2=function ar(gr){gr=gr==null?Eo:r0.defaults(Eo.Object(),gr,r0.pick(Eo,R1));var pr=gr.Array,kr=gr.Date,jr=gr.Error,oo=gr.Function,Po=gr.Math,fo=gr.Object,rc=gr.RegExp,h2=gr.String,Jo=gr.TypeError,j0=pr.prototype,d2=oo.prototype,s0=fo.prototype,K0=gr["__core-js_shared__"],Z0=d2.toString,co=s0.hasOwnProperty,u2=0,$h=function(){var de=/[^.]+$/.exec(K0&&K0.keys&&K0.keys.IE_PROTO||"");return de?"Symbol(src)_1."+de:""}(),G0=s0.toString,f2=Z0.call(fo),p2=Eo._,g2=rc("^"+Z0.call(co).replace($l,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Y0=Th?gr.Buffer:ee,Da=gr.Symbol,X0=gr.Uint8Array,zh=Y0?Y0.allocUnsafe:ee,q0=Bh(fo.getPrototypeOf,fo),Hh=fo.create,Wh=s0.propertyIsEnumerable,Q0=j0.splice,Uh=Da?Da.isConcatSpreadable:ee,y0=Da?Da.iterator:ee,za=Da?Da.toStringTag:ee,J0=function(){try{var de=Ka(fo,"defineProperty");return de({},"",{}),de}catch{}}(),m2=gr.clearTimeout!==Eo.clearTimeout&&gr.clearTimeout,_2=kr&&kr.now!==Eo.Date.now&&kr.now,v2=gr.setTimeout!==Eo.setTimeout&&gr.setTimeout,el=Po.ceil,tl=Po.floor,sc=fo.getOwnPropertySymbols,w2=Y0?Y0.isBuffer:ee,jh=gr.isFinite,y2=j0.join,b2=Bh(fo.keys,fo),Ao=Po.max,Ro=Po.min,x2=kr.now,T2=gr.parseInt,Kh=Po.random,P2=j0.reverse,oc=Ka(gr,"DataView"),b0=Ka(gr,"Map"),ac=Ka(gr,"Promise"),o0=Ka(gr,"Set"),x0=Ka(gr,"WeakMap"),T0=Ka(fo,"create"),il=x0&&new x0,a0={},A2=Za(oc),S2=Za(b0),C2=Za(ac),M2=Za(o0),E2=Za(x0),nl=Da?Da.prototype:ee,P0=nl?nl.valueOf:ee,Zh=nl?nl.toString:ee;function Qe(de){if(yo(de)&&!Kr(de)&&!(de instanceof io)){if(de instanceof ea)return de;if(co.call(de,"__wrapped__"))return Xd(de)}return new ea(de)}var l0=function(){function de(){}return function(Le){if(!wo(Le))return{};if(Hh)return Hh(Le);de.prototype=Le;var $e=new de;return de.prototype=ee,$e}}();function rl(){}function ea(de,Le){this.__wrapped__=de,this.__actions__=[],this.__chain__=!!Le,this.__index__=0,this.__values__=ee}Qe.templateSettings={escape:Hu,evaluate:Wu,interpolate:ih,variable:"",imports:{_:Qe}},Qe.prototype=rl.prototype,Qe.prototype.constructor=Qe,ea.prototype=l0(rl.prototype),ea.prototype.constructor=ea;function io(de){this.__wrapped__=de,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Er,this.__views__=[]}function D2(){var de=new io(this.__wrapped__);return de.__actions__=Bo(this.__actions__),de.__dir__=this.__dir__,de.__filtered__=this.__filtered__,de.__iteratees__=Bo(this.__iteratees__),de.__takeCount__=this.__takeCount__,de.__views__=Bo(this.__views__),de}function R2(){if(this.__filtered__){var de=new io(this);de.__dir__=-1,de.__filtered__=!0}else de=this.clone(),de.__dir__*=-1;return de}function I2(){var de=this.__wrapped__.value(),Le=this.__dir__,$e=Kr(de),Ke=Le<0,Xe=$e?de.length:0,Je=jf(0,Xe,this.__views__),Hn=Je.start,sr=Je.end,hr=sr-Hn,_r=Ke?sr:Hn-1,br=this.__iteratees__,Mr=br.length,Lr=0,Nr=Ro(hr,this.__takeCount__);if(!$e||!Ke&&Xe==hr&&Nr==hr)return wd(de,this.__actions__);var Hr=[];e:for(;hr--&&Lr<Nr;){_r+=Le;for(var Xr=-1,Wr=de[_r];++Xr<Mr;){var eo=br[Xr],no=eo.iteratee,Yo=eo.type,Vo=no(Wr);if(Yo==lr)Wr=Vo;else if(!Vo){if(Yo==rr)continue e;break e}}Hr[Lr++]=Wr}return Hr}io.prototype=l0(rl.prototype),io.prototype.constructor=io;function Ha(de){var Le=-1,$e=de==null?0:de.length;for(this.clear();++Le<$e;){var Ke=de[Le];this.set(Ke[0],Ke[1])}}function L2(){this.__data__=T0?T0(null):{},this.size=0}function O2(de){var Le=this.has(de)&&delete this.__data__[de];return this.size-=Le?1:0,Le}function k2(de){var Le=this.__data__;if(T0){var $e=Le[de];return $e===ce?ee:$e}return co.call(Le,de)?Le[de]:ee}function V2(de){var Le=this.__data__;return T0?Le[de]!==ee:co.call(Le,de)}function F2(de,Le){var $e=this.__data__;return this.size+=this.has(de)?0:1,$e[de]=T0&&Le===ee?ce:Le,this}Ha.prototype.clear=L2,Ha.prototype.delete=O2,Ha.prototype.get=k2,Ha.prototype.has=V2,Ha.prototype.set=F2;function fa(de){var Le=-1,$e=de==null?0:de.length;for(this.clear();++Le<$e;){var Ke=de[Le];this.set(Ke[0],Ke[1])}}function B2(){this.__data__=[],this.size=0}function N2(de){var Le=this.__data__,$e=sl(Le,de);if($e<0)return!1;var Ke=Le.length-1;return $e==Ke?Le.pop():Q0.call(Le,$e,1),--this.size,!0}function $2(de){var Le=this.__data__,$e=sl(Le,de);return $e<0?ee:Le[$e][1]}function z2(de){return sl(this.__data__,de)>-1}function H2(de,Le){var $e=this.__data__,Ke=sl($e,de);return Ke<0?(++this.size,$e.push([de,Le])):$e[Ke][1]=Le,this}fa.prototype.clear=B2,fa.prototype.delete=N2,fa.prototype.get=$2,fa.prototype.has=z2,fa.prototype.set=H2;function pa(de){var Le=-1,$e=de==null?0:de.length;for(this.clear();++Le<$e;){var Ke=de[Le];this.set(Ke[0],Ke[1])}}function W2(){this.size=0,this.__data__={hash:new Ha,map:new(b0||fa),string:new Ha}}function U2(de){var Le=_l(this,de).delete(de);return this.size-=Le?1:0,Le}function j2(de){return _l(this,de).get(de)}function K2(de){return _l(this,de).has(de)}function Z2(de,Le){var $e=_l(this,de),Ke=$e.size;return $e.set(de,Le),this.size+=$e.size==Ke?0:1,this}pa.prototype.clear=W2,pa.prototype.delete=U2,pa.prototype.get=j2,pa.prototype.has=K2,pa.prototype.set=Z2;function Wa(de){var Le=-1,$e=de==null?0:de.length;for(this.__data__=new pa;++Le<$e;)this.add(de[Le])}function G2(de){return this.__data__.set(de,ce),this}function Y2(de){return this.__data__.has(de)}Wa.prototype.add=Wa.prototype.push=G2,Wa.prototype.has=Y2;function oa(de){var Le=this.__data__=new fa(de);this.size=Le.size}function X2(){this.__data__=new fa,this.size=0}function q2(de){var Le=this.__data__,$e=Le.delete(de);return this.size=Le.size,$e}function Q2(de){return this.__data__.get(de)}function J2(de){return this.__data__.has(de)}function ef(de,Le){var $e=this.__data__;if($e instanceof fa){var Ke=$e.__data__;if(!b0||Ke.length<re-1)return Ke.push([de,Le]),this.size=++$e.size,this;$e=this.__data__=new pa(Ke)}return $e.set(de,Le),this.size=$e.size,this}oa.prototype.clear=X2,oa.prototype.delete=q2,oa.prototype.get=Q2,oa.prototype.has=J2,oa.prototype.set=ef;function Gh(de,Le){var $e=Kr(de),Ke=!$e&&Ga(de),Xe=!$e&&!Ke&&ka(de),Je=!$e&&!Ke&&!Xe&&u0(de),Hn=$e||Ke||Xe||Je,sr=Hn?tc(de.length,h2):[],hr=sr.length;for(var _r in de)(Le||co.call(de,_r))&&!(Hn&&(_r=="length"||Xe&&(_r=="offset"||_r=="parent")||Je&&(_r=="buffer"||_r=="byteLength"||_r=="byteOffset")||wa(_r,hr)))&&sr.push(_r);return sr}function Yh(de){var Le=de.length;return Le?de[vc(0,Le-1)]:ee}function tf(de,Le){return vl(Bo(de),Ua(Le,0,de.length))}function nf(de){return vl(Bo(de))}function lc(de,Le,$e){($e!==ee&&!aa(de[Le],$e)||$e===ee&&!(Le in de))&&ga(de,Le,$e)}function A0(de,Le,$e){var Ke=de[Le];(!(co.call(de,Le)&&aa(Ke,$e))||$e===ee&&!(Le in de))&&ga(de,Le,$e)}function sl(de,Le){for(var $e=de.length;$e--;)if(aa(de[$e][0],Le))return $e;return-1}function rf(de,Le,$e,Ke){return Ra(de,function(Xe,Je,Hn){Le(Ke,Xe,$e(Xe),Hn)}),Ke}function Xh(de,Le){return de&&da(Le,Co(Le),de)}function sf(de,Le){return de&&da(Le,$o(Le),de)}function ga(de,Le,$e){Le=="__proto__"&&J0?J0(de,Le,{configurable:!0,enumerable:!0,value:$e,writable:!0}):de[Le]=$e}function cc(de,Le){for(var $e=-1,Ke=Le.length,Xe=pr(Ke),Je=de==null;++$e<Ke;)Xe[$e]=Je?ee:Wc(de,Le[$e]);return Xe}function Ua(de,Le,$e){return de===de&&($e!==ee&&(de=de<=$e?de:$e),Le!==ee&&(de=de>=Le?de:Le)),de}function ta(de,Le,$e,Ke,Xe,Je){var Hn,sr=Le&Ae,hr=Le&pe,_r=Le&Oe;if($e&&(Hn=Xe?$e(de,Ke,Xe,Je):$e(de)),Hn!==ee)return Hn;if(!wo(de))return de;var br=Kr(de);if(br){if(Hn=Zf(de),!sr)return Bo(de,Hn)}else{var Mr=Io(de),Lr=Mr==Jr||Mr==po;if(ka(de))return xd(de,sr);if(Mr==bo||Mr==Ar||Lr&&!Xe){if(Hn=hr||Lr?{}:zd(de),!sr)return hr?Vf(de,sf(Hn,de)):kf(de,Xh(Hn,de))}else{if(!go[Mr])return Xe?de:{};Hn=Gf(de,Mr,sr)}}Je||(Je=new oa);var Nr=Je.get(de);if(Nr)return Nr;Je.set(de,Hn),mu(de)?de.forEach(function(Wr){Hn.add(ta(Wr,Le,$e,Wr,de,Je))}):pu(de)&&de.forEach(function(Wr,eo){Hn.set(eo,ta(Wr,Le,$e,eo,de,Je))});var Hr=_r?hr?Ec:Mc:hr?$o:Co,Xr=br?ee:Hr(de);return Qo(Xr||de,function(Wr,eo){Xr&&(eo=Wr,Wr=de[eo]),A0(Hn,eo,ta(Wr,Le,$e,eo,de,Je))}),Hn}function of(de){var Le=Co(de);return function($e){return qh($e,de,Le)}}function qh(de,Le,$e){var Ke=$e.length;if(de==null)return!Ke;for(de=fo(de);Ke--;){var Xe=$e[Ke],Je=Le[Xe],Hn=de[Xe];if(Hn===ee&&!(Xe in de)||!Je(Hn))return!1}return!0}function Qh(de,Le,$e){if(typeof de!="function")throw new Jo(ae);return I0(function(){de.apply(ee,$e)},Le)}function S0(de,Le,$e,Ke){var Xe=-1,Je=H0,Hn=!0,sr=de.length,hr=[],_r=Le.length;if(!sr)return hr;$e&&(Le=_o(Le,Ko($e))),Ke?(Je=Yl,Hn=!1):Le.length>=re&&(Je=w0,Hn=!1,Le=new Wa(Le));e:for(;++Xe<sr;){var br=de[Xe],Mr=$e==null?br:$e(br);if(br=Ke||br!==0?br:0,Hn&&Mr===Mr){for(var Lr=_r;Lr--;)if(Le[Lr]===Mr)continue e;hr.push(br)}else Je(Le,Mr,Ke)||hr.push(br)}return hr}var Ra=Cd(ha),Jh=Cd(dc,!0);function af(de,Le){var $e=!0;return Ra(de,function(Ke,Xe,Je){return $e=!!Le(Ke,Xe,Je),$e}),$e}function ol(de,Le,$e){for(var Ke=-1,Xe=de.length;++Ke<Xe;){var Je=de[Ke],Hn=Le(Je);if(Hn!=null&&(sr===ee?Hn===Hn&&!Go(Hn):$e(Hn,sr)))var sr=Hn,hr=Je}return hr}function lf(de,Le,$e,Ke){var Xe=de.length;for($e=Gr($e),$e<0&&($e=-$e>Xe?0:Xe+$e),Ke=Ke===ee||Ke>Xe?Xe:Gr(Ke),Ke<0&&(Ke+=Xe),Ke=$e>Ke?0:vu(Ke);$e<Ke;)de[$e++]=Le;return de}function ed(de,Le){var $e=[];return Ra(de,function(Ke,Xe,Je){Le(Ke,Xe,Je)&&$e.push(Ke)}),$e}function Do(de,Le,$e,Ke,Xe){var Je=-1,Hn=de.length;for($e||($e=Xf),Xe||(Xe=[]);++Je<Hn;){var sr=de[Je];Le>0&&$e(sr)?Le>1?Do(sr,Le-1,$e,Ke,Xe):Ma(Xe,sr):Ke||(Xe[Xe.length]=sr)}return Xe}var hc=Md(),td=Md(!0);function ha(de,Le){return de&&hc(de,Le,Co)}function dc(de,Le){return de&&td(de,Le,Co)}function al(de,Le){return Ca(Le,function($e){return ya(de[$e])})}function ja(de,Le){Le=La(Le,de);for(var $e=0,Ke=Le.length;de!=null&&$e<Ke;)de=de[ua(Le[$e++])];return $e&&$e==Ke?de:ee}function nd(de,Le,$e){var Ke=Le(de);return Kr(de)?Ke:Ma(Ke,$e(de))}function Oo(de){return de==null?de===ee?ro:Lo:za&&za in fo(de)?Uf(de):np(de)}function uc(de,Le){return de>Le}function cf(de,Le){return de!=null&&co.call(de,Le)}function hf(de,Le){return de!=null&&Le in fo(de)}function df(de,Le,$e){return de>=Ro(Le,$e)&&de<Ao(Le,$e)}function fc(de,Le,$e){for(var Ke=$e?Yl:H0,Xe=de[0].length,Je=de.length,Hn=Je,sr=pr(Je),hr=1/0,_r=[];Hn--;){var br=de[Hn];Hn&&Le&&(br=_o(br,Ko(Le))),hr=Ro(br.length,hr),sr[Hn]=!$e&&(Le||Xe>=120&&br.length>=120)?new Wa(Hn&&br):ee}br=de[0];var Mr=-1,Lr=sr[0];e:for(;++Mr<Xe&&_r.length<hr;){var Nr=br[Mr],Hr=Le?Le(Nr):Nr;if(Nr=$e||Nr!==0?Nr:0,!(Lr?w0(Lr,Hr):Ke(_r,Hr,$e))){for(Hn=Je;--Hn;){var Xr=sr[Hn];if(!(Xr?w0(Xr,Hr):Ke(de[Hn],Hr,$e)))continue e}Lr&&Lr.push(Hr),_r.push(Nr)}}return _r}function uf(de,Le,$e,Ke){return ha(de,function(Xe,Je,Hn){Le(Ke,$e(Xe),Je,Hn)}),Ke}function C0(de,Le,$e){Le=La(Le,de),de=jd(de,Le);var Ke=de==null?de:de[ua(na(Le))];return Ke==null?ee:jo(Ke,de,$e)}function rd(de){return yo(de)&&Oo(de)==Ar}function ff(de){return yo(de)&&Oo(de)==er}function pf(de){return yo(de)&&Oo(de)==Ur}function M0(de,Le,$e,Ke,Xe){return de===Le?!0:de==null||Le==null||!yo(de)&&!yo(Le)?de!==de&&Le!==Le:gf(de,Le,$e,Ke,M0,Xe)}function gf(de,Le,$e,Ke,Xe,Je){var Hn=Kr(de),sr=Kr(Le),hr=Hn?Ir:Io(de),_r=sr?Ir:Io(Le);hr=hr==Ar?bo:hr,_r=_r==Ar?bo:_r;var br=hr==bo,Mr=_r==bo,Lr=hr==_r;if(Lr&&ka(de)){if(!ka(Le))return!1;Hn=!0,br=!1}if(Lr&&!br)return Je||(Je=new oa),Hn||u0(de)?Bd(de,Le,$e,Ke,Xe,Je):Hf(de,Le,hr,$e,Ke,Xe,Je);if(!($e&Fe)){var Nr=br&&co.call(de,"__wrapped__"),Hr=Mr&&co.call(Le,"__wrapped__");if(Nr||Hr){var Xr=Nr?de.value():de,Wr=Hr?Le.value():Le;return Je||(Je=new oa),Xe(Xr,Wr,$e,Ke,Je)}}return Lr?(Je||(Je=new oa),Wf(de,Le,$e,Ke,Xe,Je)):!1}function mf(de){return yo(de)&&Io(de)==so}function pc(de,Le,$e,Ke){var Xe=$e.length,Je=Xe,Hn=!Ke;if(de==null)return!Je;for(de=fo(de);Xe--;){var sr=$e[Xe];if(Hn&&sr[2]?sr[1]!==de[sr[0]]:!(sr[0]in de))return!1}for(;++Xe<Je;){sr=$e[Xe];var hr=sr[0],_r=de[hr],br=sr[1];if(Hn&&sr[2]){if(_r===ee&&!(hr in de))return!1}else{var Mr=new oa;if(Ke)var Lr=Ke(_r,br,hr,de,Le,Mr);if(!(Lr===ee?M0(br,_r,Fe|Ne,Ke,Mr):Lr))return!1}}return!0}function sd(de){if(!wo(de)||Qf(de))return!1;var Le=ya(de)?g2:s1;return Le.test(Za(de))}function _f(de){return yo(de)&&Oo(de)==Vr}function vf(de){return yo(de)&&Io(de)==Yr}function wf(de){return yo(de)&&Pl(de.length)&&!!mo[Oo(de)]}function od(de){return typeof de=="function"?de:de==null?zo:typeof de=="object"?Kr(de)?hd(de[0],de[1]):cd(de):Eu(de)}function gc(de){if(!R0(de))return b2(de);var Le=[];for(var $e in fo(de))co.call(de,$e)&&$e!="constructor"&&Le.push($e);return Le}function yf(de){if(!wo(de))return ip(de);var Le=R0(de),$e=[];for(var Ke in de)Ke=="constructor"&&(Le||!co.call(de,Ke))||$e.push(Ke);return $e}function mc(de,Le){return de<Le}function ld(de,Le){var $e=-1,Ke=No(de)?pr(de.length):[];return Ra(de,function(Xe,Je,Hn){Ke[++$e]=Le(Xe,Je,Hn)}),Ke}function cd(de){var Le=Rc(de);return Le.length==1&&Le[0][2]?Wd(Le[0][0],Le[0][1]):function($e){return $e===de||pc($e,de,Le)}}function hd(de,Le){return Lc(de)&&Hd(Le)?Wd(ua(de),Le):function($e){var Ke=Wc($e,de);return Ke===ee&&Ke===Le?Uc($e,de):M0(Le,Ke,Fe|Ne)}}function ll(de,Le,$e,Ke,Xe){de!==Le&&hc(Le,function(Je,Hn){if(Xe||(Xe=new oa),wo(Je))bf(de,Le,Hn,$e,ll,Ke,Xe);else{var sr=Ke?Ke(kc(de,Hn),Je,Hn+"",de,Le,Xe):ee;sr===ee&&(sr=Je),lc(de,Hn,sr)}},$o)}function bf(de,Le,$e,Ke,Xe,Je,Hn){var sr=kc(de,$e),hr=kc(Le,$e),_r=Hn.get(hr);if(_r){lc(de,$e,_r);return}var br=Je?Je(sr,hr,$e+"",de,Le,Hn):ee,Mr=br===ee;if(Mr){var Lr=Kr(hr),Nr=!Lr&&ka(hr),Hr=!Lr&&!Nr&&u0(hr);br=hr,Lr||Nr||Hr?Kr(sr)?br=sr:xo(sr)?br=Bo(sr):Nr?(Mr=!1,br=xd(hr,!0)):Hr?(Mr=!1,br=Td(hr,!0)):br=[]:L0(hr)||Ga(hr)?(br=sr,Ga(sr)?br=wu(sr):(!wo(sr)||ya(sr))&&(br=zd(hr))):Mr=!1}Mr&&(Hn.set(hr,br),Xe(br,hr,Ke,Je,Hn),Hn.delete(hr)),lc(de,$e,br)}function dd(de,Le){var $e=de.length;if($e)return Le+=Le<0?$e:0,wa(Le,$e)?de[Le]:ee}function ud(de,Le,$e){Le.length?Le=_o(Le,function(Je){return Kr(Je)?function(Hn){return ja(Hn,Je.length===1?Je[0]:Je)}:Je}):Le=[zo];var Ke=-1;Le=_o(Le,Ko($r()));var Xe=ld(de,function(Je,Hn,sr){var hr=_o(Le,function(_r){return _r(Je)});return{criteria:hr,index:++Ke,value:Je}});return Z1(Xe,function(Je,Hn){return Of(Je,Hn,$e)})}function xf(de,Le){return fd(de,Le,function($e,Ke){return Uc(de,Ke)})}function fd(de,Le,$e){for(var Ke=-1,Xe=Le.length,Je={};++Ke<Xe;){var Hn=Le[Ke],sr=ja(de,Hn);$e(sr,Hn)&&E0(Je,La(Hn,de),sr)}return Je}function Tf(de){return function(Le){return ja(Le,de)}}function _c(de,Le,$e,Ke){var Xe=Ke?K1:t0,Je=-1,Hn=Le.length,sr=de;for(de===Le&&(Le=Bo(Le)),$e&&(sr=_o(de,Ko($e)));++Je<Hn;)for(var hr=0,_r=Le[Je],br=$e?$e(_r):_r;(hr=Xe(sr,br,hr,Ke))>-1;)sr!==de&&Q0.call(sr,hr,1),Q0.call(de,hr,1);return de}function pd(de,Le){for(var $e=de?Le.length:0,Ke=$e-1;$e--;){var Xe=Le[$e];if($e==Ke||Xe!==Je){var Je=Xe;wa(Xe)?Q0.call(de,Xe,1):bc(de,Xe)}}return de}function vc(de,Le){return de+tl(Kh()*(Le-de+1))}function Pf(de,Le,$e,Ke){for(var Xe=-1,Je=Ao(el((Le-de)/($e||1)),0),Hn=pr(Je);Je--;)Hn[Ke?Je:++Xe]=de,de+=$e;return Hn}function wc(de,Le){var $e="";if(!de||Le<1||Le>xr)return $e;do Le%2&&($e+=de),Le=tl(Le/2),Le&&(de+=de);while(Le);return $e}function qr(de,Le){return Vc(Ud(de,Le,zo),de+"")}function Af(de){return Yh(f0(de))}function Sf(de,Le){var $e=f0(de);return vl($e,Ua(Le,0,$e.length))}function E0(de,Le,$e,Ke){if(!wo(de))return de;Le=La(Le,de);for(var Xe=-1,Je=Le.length,Hn=Je-1,sr=de;sr!=null&&++Xe<Je;){var hr=ua(Le[Xe]),_r=$e;if(hr==="__proto__"||hr==="constructor"||hr==="prototype")return de;if(Xe!=Hn){var br=sr[hr];_r=Ke?Ke(br,hr,sr):ee,_r===ee&&(_r=wo(br)?br:wa(Le[Xe+1])?[]:{})}A0(sr,hr,_r),sr=sr[hr]}return de}var gd=il?function(de,Le){return il.set(de,Le),de}:zo,Cf=J0?function(de,Le){return J0(de,"toString",{configurable:!0,enumerable:!1,value:Kc(Le),writable:!0})}:zo;function Mf(de){return vl(f0(de))}function ia(de,Le,$e){var Ke=-1,Xe=de.length;Le<0&&(Le=-Le>Xe?0:Xe+Le),$e=$e>Xe?Xe:$e,$e<0&&($e+=Xe),Xe=Le>$e?0:$e-Le>>>0,Le>>>=0;for(var Je=pr(Xe);++Ke<Xe;)Je[Ke]=de[Ke+Le];return Je}function Ef(de,Le){var $e;return Ra(de,function(Ke,Xe,Je){return $e=Le(Ke,Xe,Je),!$e}),!!$e}function cl(de,Le,$e){var Ke=0,Xe=de==null?Ke:de.length;if(typeof Le=="number"&&Le===Le&&Xe<=Cr){for(;Ke<Xe;){var Je=Ke+Xe>>>1,Hn=de[Je];Hn!==null&&!Go(Hn)&&($e?Hn<=Le:Hn<Le)?Ke=Je+1:Xe=Je}return Xe}return yc(de,Le,zo,$e)}function yc(de,Le,$e,Ke){var Xe=0,Je=de==null?0:de.length;if(Je===0)return 0;Le=$e(Le);for(var Hn=Le!==Le,sr=Le===null,hr=Go(Le),_r=Le===ee;Xe<Je;){var br=tl((Xe+Je)/2),Mr=$e(de[br]),Lr=Mr!==ee,Nr=Mr===null,Hr=Mr===Mr,Xr=Go(Mr);if(Hn)var Wr=Ke||Hr;else _r?Wr=Hr&&(Ke||Lr):sr?Wr=Hr&&Lr&&(Ke||!Nr):hr?Wr=Hr&&Lr&&!Nr&&(Ke||!Xr):Nr||Xr?Wr=!1:Wr=Ke?Mr<=Le:Mr<Le;Wr?Xe=br+1:Je=br}return Ro(Je,dr)}function md(de,Le){for(var $e=-1,Ke=de.length,Xe=0,Je=[];++$e<Ke;){var Hn=de[$e],sr=Le?Le(Hn):Hn;if(!$e||!aa(sr,hr)){var hr=sr;Je[Xe++]=Hn===0?0:Hn}}return Je}function _d(de){return typeof de=="number"?de:Go(de)?mr:+de}function Zo(de){if(typeof de=="string")return de;if(Kr(de))return _o(de,Zo)+"";if(Go(de))return Zh?Zh.call(de):"";var Le=de+"";return Le=="0"&&1/de==-1/0?"-0":Le}function Ia(de,Le,$e){var Ke=-1,Xe=H0,Je=de.length,Hn=!0,sr=[],hr=sr;if($e)Hn=!1,Xe=Yl;else if(Je>=re){var _r=Le?null:$f(de);if(_r)return U0(_r);Hn=!1,Xe=w0,hr=new Wa}else hr=Le?[]:sr;e:for(;++Ke<Je;){var br=de[Ke],Mr=Le?Le(br):br;if(br=$e||br!==0?br:0,Hn&&Mr===Mr){for(var Lr=hr.length;Lr--;)if(hr[Lr]===Mr)continue e;Le&&hr.push(Mr),sr.push(br)}else Xe(hr,Mr,$e)||(hr!==sr&&hr.push(Mr),sr.push(br))}return sr}function bc(de,Le){return Le=La(Le,de),de=jd(de,Le),de==null||delete de[ua(na(Le))]}function vd(de,Le,$e,Ke){return E0(de,Le,$e(ja(de,Le)),Ke)}function hl(de,Le,$e,Ke){for(var Xe=de.length,Je=Ke?Xe:-1;(Ke?Je--:++Je<Xe)&&Le(de[Je],Je,de););return $e?ia(de,Ke?0:Je,Ke?Je+1:Xe):ia(de,Ke?Je+1:0,Ke?Xe:Je)}function wd(de,Le){var $e=de;return $e instanceof io&&($e=$e.value()),Xl(Le,function(Ke,Xe){return Xe.func.apply(Xe.thisArg,Ma([Ke],Xe.args))},$e)}function xc(de,Le,$e){var Ke=de.length;if(Ke<2)return Ke?Ia(de[0]):[];for(var Xe=-1,Je=pr(Ke);++Xe<Ke;)for(var Hn=de[Xe],sr=-1;++sr<Ke;)sr!=Xe&&(Je[Xe]=S0(Je[Xe]||Hn,de[sr],Le,$e));return Ia(Do(Je,1),Le,$e)}function yd(de,Le,$e){for(var Ke=-1,Xe=de.length,Je=Le.length,Hn={};++Ke<Xe;){var sr=Ke<Je?Le[Ke]:ee;$e(Hn,de[Ke],sr)}return Hn}function Tc(de){return xo(de)?de:[]}function Pc(de){return typeof de=="function"?de:zo}function La(de,Le){return Kr(de)?de:Lc(de,Le)?[de]:Yd(lo(de))}var Df=qr;function Oa(de,Le,$e){var Ke=de.length;return $e=$e===ee?Ke:$e,!Le&&$e>=Ke?de:ia(de,Le,$e)}var bd=m2||function(de){return Eo.clearTimeout(de)};function xd(de,Le){if(Le)return de.slice();var $e=de.length,Ke=zh?zh($e):new de.constructor($e);return de.copy(Ke),Ke}function Ac(de){var Le=new de.constructor(de.byteLength);return new X0(Le).set(new X0(de)),Le}function Rf(de,Le){var $e=Le?Ac(de.buffer):de.buffer;return new de.constructor($e,de.byteOffset,de.byteLength)}function If(de){var Le=new de.constructor(de.source,nh.exec(de));return Le.lastIndex=de.lastIndex,Le}function Lf(de){return P0?fo(P0.call(de)):{}}function Td(de,Le){var $e=Le?Ac(de.buffer):de.buffer;return new de.constructor($e,de.byteOffset,de.length)}function Pd(de,Le){if(de!==Le){var $e=de!==ee,Ke=de===null,Xe=de===de,Je=Go(de),Hn=Le!==ee,sr=Le===null,hr=Le===Le,_r=Go(Le);if(!sr&&!_r&&!Je&&de>Le||Je&&Hn&&hr&&!sr&&!_r||Ke&&Hn&&hr||!$e&&hr||!Xe)return 1;if(!Ke&&!Je&&!_r&&de<Le||_r&&$e&&Xe&&!Ke&&!Je||sr&&$e&&Xe||!Hn&&Xe||!hr)return-1}return 0}function Of(de,Le,$e){for(var Ke=-1,Xe=de.criteria,Je=Le.criteria,Hn=Xe.length,sr=$e.length;++Ke<Hn;){var hr=Pd(Xe[Ke],Je[Ke]);if(hr){if(Ke>=sr)return hr;var _r=$e[Ke];return hr*(_r=="desc"?-1:1)}}return de.index-Le.index}function Ad(de,Le,$e,Ke){for(var Xe=-1,Je=de.length,Hn=$e.length,sr=-1,hr=Le.length,_r=Ao(Je-Hn,0),br=pr(hr+_r),Mr=!Ke;++sr<hr;)br[sr]=Le[sr];for(;++Xe<Hn;)(Mr||Xe<Je)&&(br[$e[Xe]]=de[Xe]);for(;_r--;)br[sr++]=de[Xe++];return br}function Sd(de,Le,$e,Ke){for(var Xe=-1,Je=de.length,Hn=-1,sr=$e.length,hr=-1,_r=Le.length,br=Ao(Je-sr,0),Mr=pr(br+_r),Lr=!Ke;++Xe<br;)Mr[Xe]=de[Xe];for(var Nr=Xe;++hr<_r;)Mr[Nr+hr]=Le[hr];for(;++Hn<sr;)(Lr||Xe<Je)&&(Mr[Nr+$e[Hn]]=de[Xe++]);return Mr}function Bo(de,Le){var $e=-1,Ke=de.length;for(Le||(Le=pr(Ke));++$e<Ke;)Le[$e]=de[$e];return Le}function da(de,Le,$e,Ke){var Xe=!$e;$e||($e={});for(var Je=-1,Hn=Le.length;++Je<Hn;){var sr=Le[Je],hr=Ke?Ke($e[sr],de[sr],sr,$e,de):ee;hr===ee&&(hr=de[sr]),Xe?ga($e,sr,hr):A0($e,sr,hr)}return $e}function kf(de,Le){return da(de,Ic(de),Le)}function Vf(de,Le){return da(de,Nd(de),Le)}function dl(de,Le){return function($e,Ke){var Xe=Kr($e)?$1:rf,Je=Le?Le():{};return Xe($e,de,$r(Ke,2),Je)}}function c0(de){return qr(function(Le,$e){var Ke=-1,Xe=$e.length,Je=Xe>1?$e[Xe-1]:ee,Hn=Xe>2?$e[2]:ee;for(Je=de.length>3&&typeof Je=="function"?(Xe--,Je):ee,Hn&&ko($e[0],$e[1],Hn)&&(Je=Xe<3?ee:Je,Xe=1),Le=fo(Le);++Ke<Xe;){var sr=$e[Ke];sr&&de(Le,sr,Ke,Je)}return Le})}function Cd(de,Le){return function($e,Ke){if($e==null)return $e;if(!No($e))return de($e,Ke);for(var Xe=$e.length,Je=Le?Xe:-1,Hn=fo($e);(Le?Je--:++Je<Xe)&&Ke(Hn[Je],Je,Hn)!==!1;);return $e}}function Md(de){return function(Le,$e,Ke){for(var Xe=-1,Je=fo(Le),Hn=Ke(Le),sr=Hn.length;sr--;){var hr=Hn[de?sr:++Xe];if($e(Je[hr],hr,Je)===!1)break}return Le}}function Ff(de,Le,$e){var Ke=Le&ze,Xe=D0(de);function Je(){var Hn=this&&this!==Eo&&this instanceof Je?Xe:de;return Hn.apply(Ke?$e:this,arguments)}return Je}function Ed(de){return function(Le){Le=lo(Le);var $e=i0(Le)?sa(Le):ee,Ke=$e?$e[0]:Le.charAt(0),Xe=$e?Oa($e,1).join(""):Le.slice(1);return Ke[de]()+Xe}}function h0(de){return function(Le){return Xl(Cu(Su(Le).replace(S1,"")),de,"")}}function D0(de){return function(){var Le=arguments;switch(Le.length){case 0:return new de;case 1:return new de(Le[0]);case 2:return new de(Le[0],Le[1]);case 3:return new de(Le[0],Le[1],Le[2]);case 4:return new de(Le[0],Le[1],Le[2],Le[3]);case 5:return new de(Le[0],Le[1],Le[2],Le[3],Le[4]);case 6:return new de(Le[0],Le[1],Le[2],Le[3],Le[4],Le[5]);case 7:return new de(Le[0],Le[1],Le[2],Le[3],Le[4],Le[5],Le[6])}var $e=l0(de.prototype),Ke=de.apply($e,Le);return wo(Ke)?Ke:$e}}function Bf(de,Le,$e){var Ke=D0(de);function Xe(){for(var Je=arguments.length,Hn=pr(Je),sr=Je,hr=d0(Xe);sr--;)Hn[sr]=arguments[sr];var _r=Je<3&&Hn[0]!==hr&&Hn[Je-1]!==hr?[]:Ea(Hn,hr);if(Je-=_r.length,Je<$e)return Od(de,Le,ul,Xe.placeholder,ee,Hn,_r,ee,ee,$e-Je);var br=this&&this!==Eo&&this instanceof Xe?Ke:de;return jo(br,this,Hn)}return Xe}function Dd(de){return function(Le,$e,Ke){var Xe=fo(Le);if(!No(Le)){var Je=$r($e,3);Le=Co(Le),$e=function(sr){return Je(Xe[sr],sr,Xe)}}var Hn=de(Le,$e,Ke);return Hn>-1?Xe[Je?Le[Hn]:Hn]:ee}}function Rd(de){return va(function(Le){var $e=Le.length,Ke=$e,Xe=ea.prototype.thru;for(de&&Le.reverse();Ke--;){var Je=Le[Ke];if(typeof Je!="function")throw new Jo(ae);if(Xe&&!Hn&&ml(Je)=="wrapper")var Hn=new ea([],!0)}for(Ke=Hn?Ke:$e;++Ke<$e;){Je=Le[Ke];var sr=ml(Je),hr=sr=="wrapper"?Dc(Je):ee;hr&&Oc(hr[0])&&hr[1]==(Ye|je|Ge|qe)&&!hr[4].length&&hr[9]==1?Hn=Hn[ml(hr[0])].apply(Hn,hr[3]):Hn=Je.length==1&&Oc(Je)?Hn[sr]():Hn.thru(Je)}return function(){var _r=arguments,br=_r[0];if(Hn&&_r.length==1&&Kr(br))return Hn.plant(br).value();for(var Mr=0,Lr=$e?Le[Mr].apply(this,_r):br;++Mr<$e;)Lr=Le[Mr].call(this,Lr);return Lr}})}function ul(de,Le,$e,Ke,Xe,Je,Hn,sr,hr,_r){var br=Le&Ye,Mr=Le&ze,Lr=Le&He,Nr=Le&(je|Ue),Hr=Le&nr,Xr=Lr?ee:D0(de);function Wr(){for(var eo=arguments.length,no=pr(eo),Yo=eo;Yo--;)no[Yo]=arguments[Yo];if(Nr)var Vo=d0(Wr),Xo=Y1(no,Vo);if(Ke&&(no=Ad(no,Ke,Xe,Nr)),Je&&(no=Sd(no,Je,Hn,Nr)),eo-=Xo,Nr&&eo<_r){var To=Ea(no,Vo);return Od(de,Le,ul,Wr.placeholder,$e,no,To,sr,hr,_r-eo)}var la=Mr?$e:this,xa=Lr?la[de]:de;return eo=no.length,sr?no=rp(no,sr):Hr&&eo>1&&no.reverse(),br&&hr<eo&&(no.length=hr),this&&this!==Eo&&this instanceof Wr&&(xa=Xr||D0(xa)),xa.apply(la,no)}return Wr}function Id(de,Le){return function($e,Ke){return uf($e,de,Le(Ke),{})}}function fl(de,Le){return function($e,Ke){var Xe;if($e===ee&&Ke===ee)return Le;if($e!==ee&&(Xe=$e),Ke!==ee){if(Xe===ee)return Ke;typeof $e=="string"||typeof Ke=="string"?($e=Zo($e),Ke=Zo(Ke)):($e=_d($e),Ke=_d(Ke)),Xe=de($e,Ke)}return Xe}}function Sc(de){return va(function(Le){return Le=_o(Le,Ko($r())),qr(function($e){var Ke=this;return de(Le,function(Xe){return jo(Xe,Ke,$e)})})})}function pl(de,Le){Le=Le===ee?" ":Zo(Le);var $e=Le.length;if($e<2)return $e?wc(Le,de):Le;var Ke=wc(Le,el(de/n0(Le)));return i0(Le)?Oa(sa(Ke),0,de).join(""):Ke.slice(0,de)}function Nf(de,Le,$e,Ke){var Xe=Le&ze,Je=D0(de);function Hn(){for(var sr=-1,hr=arguments.length,_r=-1,br=Ke.length,Mr=pr(br+hr),Lr=this&&this!==Eo&&this instanceof Hn?Je:de;++_r<br;)Mr[_r]=Ke[_r];for(;hr--;)Mr[_r++]=arguments[++sr];return jo(Lr,Xe?$e:this,Mr)}return Hn}function Ld(de){return function(Le,$e,Ke){return Ke&&typeof Ke!="number"&&ko(Le,$e,Ke)&&($e=Ke=ee),Le=ba(Le),$e===ee?($e=Le,Le=0):$e=ba($e),Ke=Ke===ee?Le<$e?1:-1:ba(Ke),Pf(Le,$e,Ke,de)}}function gl(de){return function(Le,$e){return typeof Le=="string"&&typeof $e=="string"||(Le=ra(Le),$e=ra($e)),de(Le,$e)}}function Od(de,Le,$e,Ke,Xe,Je,Hn,sr,hr,_r){var br=Le&je,Mr=br?Hn:ee,Lr=br?ee:Hn,Nr=br?Je:ee,Hr=br?ee:Je;Le|=br?Ge:Ze,Le&=~(br?Ze:Ge),Le&We||(Le&=-4);var Xr=[de,Le,Xe,Nr,Mr,Hr,Lr,sr,hr,_r],Wr=$e.apply(ee,Xr);return Oc(de)&&Kd(Wr,Xr),Wr.placeholder=Ke,Zd(Wr,de,Le)}function Cc(de){var Le=Po[de];return function($e,Ke){if($e=ra($e),Ke=Ke==null?0:Ro(Gr(Ke),292),Ke&&jh($e)){var Xe=(lo($e)+"e").split("e"),Je=Le(Xe[0]+"e"+(+Xe[1]+Ke));return Xe=(lo(Je)+"e").split("e"),+(Xe[0]+"e"+(+Xe[1]-Ke))}return Le($e)}}var $f=o0&&1/U0(new o0([,-0]))[1]==Sr?function(de){return new o0(de)}:Yc;function kd(de){return function(Le){var $e=Io(Le);return $e==so?nc(Le):$e==Yr?i2(Le):G1(Le,de(Le))}}function ma(de,Le,$e,Ke,Xe,Je,Hn,sr){var hr=Le&He;if(!hr&&typeof de!="function")throw new Jo(ae);var _r=Ke?Ke.length:0;if(_r||(Le&=-97,Ke=Xe=ee),Hn=Hn===ee?Hn:Ao(Gr(Hn),0),sr=sr===ee?sr:Gr(sr),_r-=Xe?Xe.length:0,Le&Ze){var br=Ke,Mr=Xe;Ke=Xe=ee}var Lr=hr?ee:Dc(de),Nr=[de,Le,$e,Ke,Xe,br,Mr,Je,Hn,sr];if(Lr&&tp(Nr,Lr),de=Nr[0],Le=Nr[1],$e=Nr[2],Ke=Nr[3],Xe=Nr[4],sr=Nr[9]=Nr[9]===ee?hr?0:de.length:Ao(Nr[9]-_r,0),!sr&&Le&(je|Ue)&&(Le&=-25),!Le||Le==ze)var Hr=Ff(de,Le,$e);else Le==je||Le==Ue?Hr=Bf(de,Le,sr):(Le==Ge||Le==(ze|Ge))&&!Xe.length?Hr=Nf(de,Le,$e,Ke):Hr=ul.apply(ee,Nr);var Xr=Lr?gd:Kd;return Zd(Xr(Hr,Nr),de,Le)}function Vd(de,Le,$e,Ke){return de===ee||aa(de,s0[$e])&&!co.call(Ke,$e)?Le:de}function Fd(de,Le,$e,Ke,Xe,Je){return wo(de)&&wo(Le)&&(Je.set(Le,de),ll(de,Le,ee,Fd,Je),Je.delete(Le)),de}function zf(de){return L0(de)?ee:de}function Bd(de,Le,$e,Ke,Xe,Je){var Hn=$e&Fe,sr=de.length,hr=Le.length;if(sr!=hr&&!(Hn&&hr>sr))return!1;var _r=Je.get(de),br=Je.get(Le);if(_r&&br)return _r==Le&&br==de;var Mr=-1,Lr=!0,Nr=$e&Ne?new Wa:ee;for(Je.set(de,Le),Je.set(Le,de);++Mr<sr;){var Hr=de[Mr],Xr=Le[Mr];if(Ke)var Wr=Hn?Ke(Xr,Hr,Mr,Le,de,Je):Ke(Hr,Xr,Mr,de,Le,Je);if(Wr!==ee){if(Wr)continue;Lr=!1;break}if(Nr){if(!ql(Le,function(eo,no){if(!w0(Nr,no)&&(Hr===eo||Xe(Hr,eo,$e,Ke,Je)))return Nr.push(no)})){Lr=!1;break}}else if(!(Hr===Xr||Xe(Hr,Xr,$e,Ke,Je))){Lr=!1;break}}return Je.delete(de),Je.delete(Le),Lr}function Hf(de,Le,$e,Ke,Xe,Je,Hn){switch($e){case Tr:if(de.byteLength!=Le.byteLength||de.byteOffset!=Le.byteOffset)return!1;de=de.buffer,Le=Le.buffer;case er:return!(de.byteLength!=Le.byteLength||!Je(new X0(de),new X0(Le)));case Dr:case Ur:case ho:return aa(+de,+Le);case Fr:return de.name==Le.name&&de.message==Le.message;case Vr:case Zr:return de==Le+"";case so:var sr=nc;case Yr:var hr=Ke&Fe;if(sr||(sr=U0),de.size!=Le.size&&!hr)return!1;var _r=Hn.get(de);if(_r)return _r==Le;Ke|=Ne,Hn.set(de,Le);var br=Bd(sr(de),sr(Le),Ke,Xe,Je,Hn);return Hn.delete(de),br;case uo:if(P0)return P0.call(de)==P0.call(Le)}return!1}function Wf(de,Le,$e,Ke,Xe,Je){var Hn=$e&Fe,sr=Mc(de),hr=sr.length,_r=Mc(Le),br=_r.length;if(hr!=br&&!Hn)return!1;for(var Mr=hr;Mr--;){var Lr=sr[Mr];if(!(Hn?Lr in Le:co.call(Le,Lr)))return!1}var Nr=Je.get(de),Hr=Je.get(Le);if(Nr&&Hr)return Nr==Le&&Hr==de;var Xr=!0;Je.set(de,Le),Je.set(Le,de);for(var Wr=Hn;++Mr<hr;){Lr=sr[Mr];var eo=de[Lr],no=Le[Lr];if(Ke)var Yo=Hn?Ke(no,eo,Lr,Le,de,Je):Ke(eo,no,Lr,de,Le,Je);if(!(Yo===ee?eo===no||Xe(eo,no,$e,Ke,Je):Yo)){Xr=!1;break}Wr||(Wr=Lr=="constructor")}if(Xr&&!Wr){var Vo=de.constructor,Xo=Le.constructor;Vo!=Xo&&"constructor"in de&&"constructor"in Le&&!(typeof Vo=="function"&&Vo instanceof Vo&&typeof Xo=="function"&&Xo instanceof Xo)&&(Xr=!1)}return Je.delete(de),Je.delete(Le),Xr}function va(de){return Vc(Ud(de,ee,Jd),de+"")}function Mc(de){return nd(de,Co,Ic)}function Ec(de){return nd(de,$o,Nd)}var Dc=il?function(de){return il.get(de)}:Yc;function ml(de){for(var Le=de.name+"",$e=a0[Le],Ke=co.call(a0,Le)?$e.length:0;Ke--;){var Xe=$e[Ke],Je=Xe.func;if(Je==null||Je==de)return Xe.name}return Le}function d0(de){var Le=co.call(Qe,"placeholder")?Qe:de;return Le.placeholder}function $r(){var de=Qe.iteratee||Zc;return de=de===Zc?od:de,arguments.length?de(arguments[0],arguments[1]):de}function _l(de,Le){var $e=de.__data__;return qf(Le)?$e[typeof Le=="string"?"string":"hash"]:$e.map}function Rc(de){for(var Le=Co(de),$e=Le.length;$e--;){var Ke=Le[$e],Xe=de[Ke];Le[$e]=[Ke,Xe,Hd(Xe)]}return Le}function Ka(de,Le){var $e=J1(de,Le);return sd($e)?$e:ee}function Uf(de){var Le=co.call(de,za),$e=de[za];try{de[za]=ee;var Ke=!0}catch{}var Xe=G0.call(de);return Ke&&(Le?de[za]=$e:delete de[za]),Xe}var Ic=sc?function(de){return de==null?[]:(de=fo(de),Ca(sc(de),function(Le){return Wh.call(de,Le)}))}:Xc,Nd=sc?function(de){for(var Le=[];de;)Ma(Le,Ic(de)),de=q0(de);return Le}:Xc,Io=Oo;(oc&&Io(new oc(new ArrayBuffer(1)))!=Tr||b0&&Io(new b0)!=so||ac&&Io(ac.resolve())!=Uo||o0&&Io(new o0)!=Yr||x0&&Io(new x0)!=Rr)&&(Io=function(de){var Le=Oo(de),$e=Le==bo?de.constructor:ee,Ke=$e?Za($e):"";if(Ke)switch(Ke){case A2:return Tr;case S2:return so;case C2:return Uo;case M2:return Yr;case E2:return Rr}return Le});function jf(de,Le,$e){for(var Ke=-1,Xe=$e.length;++Ke<Xe;){var Je=$e[Ke],Hn=Je.size;switch(Je.type){case"drop":de+=Hn;break;case"dropRight":Le-=Hn;break;case"take":Le=Ro(Le,de+Hn);break;case"takeRight":de=Ao(de,Le-Hn);break}}return{start:de,end:Le}}function Kf(de){var Le=de.match(Xu);return Le?Le[1].split(qu):[]}function $d(de,Le,$e){Le=La(Le,de);for(var Ke=-1,Xe=Le.length,Je=!1;++Ke<Xe;){var Hn=ua(Le[Ke]);if(!(Je=de!=null&&$e(de,Hn)))break;de=de[Hn]}return Je||++Ke!=Xe?Je:(Xe=de==null?0:de.length,!!Xe&&Pl(Xe)&&wa(Hn,Xe)&&(Kr(de)||Ga(de)))}function Zf(de){var Le=de.length,$e=new de.constructor(Le);return Le&&typeof de[0]=="string"&&co.call(de,"index")&&($e.index=de.index,$e.input=de.input),$e}function zd(de){return typeof de.constructor=="function"&&!R0(de)?l0(q0(de)):{}}function Gf(de,Le,$e){var Ke=de.constructor;switch(Le){case er:return Ac(de);case Dr:case Ur:return new Ke(+de);case Tr:return Rf(de,$e);case to:case Fo:case Sa:case Ja:case kl:case Vl:case Fl:case Bl:case Nl:return Td(de,$e);case so:return new Ke;case ho:case Zr:return new Ke(de);case Vr:return If(de);case Yr:return new Ke;case uo:return Lf(de)}}function Yf(de,Le){var $e=Le.length;if(!$e)return de;var Ke=$e-1;return Le[Ke]=($e>1?"& ":"")+Le[Ke],Le=Le.join($e>2?", ":" "),de.replace(Yu,`{
/* [wrapped with `+Le+`] */
`)}function Xf(de){return Kr(de)||Ga(de)||!!(Uh&&de&&de[Uh])}function wa(de,Le){var $e=typeof de;return Le=Le??xr,!!Le&&($e=="number"||$e!="symbol"&&a1.test(de))&&de>-1&&de%1==0&&de<Le}function ko(de,Le,$e){if(!wo($e))return!1;var Ke=typeof Le;return(Ke=="number"?No($e)&&wa(Le,$e.length):Ke=="string"&&Le in $e)?aa($e[Le],de):!1}function Lc(de,Le){if(Kr(de))return!1;var $e=typeof de;return $e=="number"||$e=="symbol"||$e=="boolean"||de==null||Go(de)?!0:ju.test(de)||!Uu.test(de)||Le!=null&&de in fo(Le)}function qf(de){var Le=typeof de;return Le=="string"||Le=="number"||Le=="symbol"||Le=="boolean"?de!=="__proto__":de===null}function Oc(de){var Le=ml(de),$e=Qe[Le];if(typeof $e!="function"||!(Le in io.prototype))return!1;if(de===$e)return!0;var Ke=Dc($e);return!!Ke&&de===Ke[0]}function Qf(de){return!!$h&&$h in de}var Jf=K0?ya:qc;function R0(de){var Le=de&&de.constructor,$e=typeof Le=="function"&&Le.prototype||s0;return de===$e}function Hd(de){return de===de&&!wo(de)}function Wd(de,Le){return function($e){return $e==null?!1:$e[de]===Le&&(Le!==ee||de in fo($e))}}function ep(de){var Le=xl(de,function(Ke){return $e.size===he&&$e.clear(),Ke}),$e=Le.cache;return Le}function tp(de,Le){var $e=de[1],Ke=Le[1],Xe=$e|Ke,Je=Xe<(ze|He|Ye),Hn=Ke==Ye&&$e==je||Ke==Ye&&$e==qe&&de[7].length<=Le[8]||Ke==(Ye|qe)&&Le[7].length<=Le[8]&&$e==je;if(!(Je||Hn))return de;Ke&ze&&(de[2]=Le[2],Xe|=$e&ze?0:We);var sr=Le[3];if(sr){var hr=de[3];de[3]=hr?Ad(hr,sr,Le[4]):sr,de[4]=hr?Ea(de[3],fe):Le[4]}return sr=Le[5],sr&&(hr=de[5],de[5]=hr?Sd(hr,sr,Le[6]):sr,de[6]=hr?Ea(de[5],fe):Le[6]),sr=Le[7],sr&&(de[7]=sr),Ke&Ye&&(de[8]=de[8]==null?Le[8]:Ro(de[8],Le[8])),de[9]==null&&(de[9]=Le[9]),de[0]=Le[0],de[1]=Xe,de}function ip(de){var Le=[];if(de!=null)for(var $e in fo(de))Le.push($e);return Le}function np(de){return G0.call(de)}function Ud(de,Le,$e){return Le=Ao(Le===ee?de.length-1:Le,0),function(){for(var Ke=arguments,Xe=-1,Je=Ao(Ke.length-Le,0),Hn=pr(Je);++Xe<Je;)Hn[Xe]=Ke[Le+Xe];Xe=-1;for(var sr=pr(Le+1);++Xe<Le;)sr[Xe]=Ke[Xe];return sr[Le]=$e(Hn),jo(de,this,sr)}}function jd(de,Le){return Le.length<2?de:ja(de,ia(Le,0,-1))}function rp(de,Le){for(var $e=de.length,Ke=Ro(Le.length,$e),Xe=Bo(de);Ke--;){var Je=Le[Ke];de[Ke]=wa(Je,$e)?Xe[Je]:ee}return de}function kc(de,Le){if(!(Le==="constructor"&&typeof de[Le]=="function")&&Le!="__proto__")return de[Le]}var Kd=Gd(gd),I0=v2||function(de,Le){return Eo.setTimeout(de,Le)},Vc=Gd(Cf);function Zd(de,Le,$e){var Ke=Le+"";return Vc(de,Yf(Ke,sp(Kf(Ke),$e)))}function Gd(de){var Le=0,$e=0;return function(){var Ke=x2(),Xe=Jt-(Ke-$e);if($e=Ke,Xe>0){if(++Le>=or)return arguments[0]}else Le=0;return de.apply(ee,arguments)}}function vl(de,Le){var $e=-1,Ke=de.length,Xe=Ke-1;for(Le=Le===ee?Ke:Le;++$e<Le;){var Je=vc($e,Xe),Hn=de[Je];de[Je]=de[$e],de[$e]=Hn}return de.length=Le,de}var Yd=ep(function(de){var Le=[];return de.charCodeAt(0)===46&&Le.push(""),de.replace(Ku,function($e,Ke,Xe,Je){Le.push(Xe?Je.replace(e1,"$1"):Ke||$e)}),Le});function ua(de){if(typeof de=="string"||Go(de))return de;var Le=de+"";return Le=="0"&&1/de==-1/0?"-0":Le}function Za(de){if(de!=null){try{return Z0.call(de)}catch{}try{return de+""}catch{}}return""}function sp(de,Le){return Qo(Or,function($e){var Ke="_."+$e[0];Le&$e[1]&&!H0(de,Ke)&&de.push(Ke)}),de.sort()}function Xd(de){if(de instanceof io)return de.clone();var Le=new ea(de.__wrapped__,de.__chain__);return Le.__actions__=Bo(de.__actions__),Le.__index__=de.__index__,Le.__values__=de.__values__,Le}function op(de,Le,$e){($e?ko(de,Le,$e):Le===ee)?Le=1:Le=Ao(Gr(Le),0);var Ke=de==null?0:de.length;if(!Ke||Le<1)return[];for(var Xe=0,Je=0,Hn=pr(el(Ke/Le));Xe<Ke;)Hn[Je++]=ia(de,Xe,Xe+=Le);return Hn}function ap(de){for(var Le=-1,$e=de==null?0:de.length,Ke=0,Xe=[];++Le<$e;){var Je=de[Le];Je&&(Xe[Ke++]=Je)}return Xe}function lp(){var de=arguments.length;if(!de)return[];for(var Le=pr(de-1),$e=arguments[0],Ke=de;Ke--;)Le[Ke-1]=arguments[Ke];return Ma(Kr($e)?Bo($e):[$e],Do(Le,1))}var cp=qr(function(de,Le){return xo(de)?S0(de,Do(Le,1,xo,!0)):[]}),hp=qr(function(de,Le){var $e=na(Le);return xo($e)&&($e=ee),xo(de)?S0(de,Do(Le,1,xo,!0),$r($e,2)):[]}),dp=qr(function(de,Le){var $e=na(Le);return xo($e)&&($e=ee),xo(de)?S0(de,Do(Le,1,xo,!0),ee,$e):[]});function up(de,Le,$e){var Ke=de==null?0:de.length;return Ke?(Le=$e||Le===ee?1:Gr(Le),ia(de,Le<0?0:Le,Ke)):[]}function fp(de,Le,$e){var Ke=de==null?0:de.length;return Ke?(Le=$e||Le===ee?1:Gr(Le),Le=Ke-Le,ia(de,0,Le<0?0:Le)):[]}function pp(de,Le){return de&&de.length?hl(de,$r(Le,3),!0,!0):[]}function gp(de,Le){return de&&de.length?hl(de,$r(Le,3),!0):[]}function mp(de,Le,$e,Ke){var Xe=de==null?0:de.length;return Xe?($e&&typeof $e!="number"&&ko(de,Le,$e)&&($e=0,Ke=Xe),lf(de,Le,$e,Ke)):[]}function qd(de,Le,$e){var Ke=de==null?0:de.length;if(!Ke)return-1;var Xe=$e==null?0:Gr($e);return Xe<0&&(Xe=Ao(Ke+Xe,0)),W0(de,$r(Le,3),Xe)}function Qd(de,Le,$e){var Ke=de==null?0:de.length;if(!Ke)return-1;var Xe=Ke-1;return $e!==ee&&(Xe=Gr($e),Xe=$e<0?Ao(Ke+Xe,0):Ro(Xe,Ke-1)),W0(de,$r(Le,3),Xe,!0)}function Jd(de){var Le=de==null?0:de.length;return Le?Do(de,1):[]}function _p(de){var Le=de==null?0:de.length;return Le?Do(de,Sr):[]}function vp(de,Le){var $e=de==null?0:de.length;return $e?(Le=Le===ee?1:Gr(Le),Do(de,Le)):[]}function wp(de){for(var Le=-1,$e=de==null?0:de.length,Ke={};++Le<$e;){var Xe=de[Le];Ke[Xe[0]]=Xe[1]}return Ke}function eu(de){return de&&de.length?de[0]:ee}function yp(de,Le,$e){var Ke=de==null?0:de.length;if(!Ke)return-1;var Xe=$e==null?0:Gr($e);return Xe<0&&(Xe=Ao(Ke+Xe,0)),t0(de,Le,Xe)}function bp(de){var Le=de==null?0:de.length;return Le?ia(de,0,-1):[]}var xp=qr(function(de){var Le=_o(de,Tc);return Le.length&&Le[0]===de[0]?fc(Le):[]}),Tp=qr(function(de){var Le=na(de),$e=_o(de,Tc);return Le===na($e)?Le=ee:$e.pop(),$e.length&&$e[0]===de[0]?fc($e,$r(Le,2)):[]}),Pp=qr(function(de){var Le=na(de),$e=_o(de,Tc);return Le=typeof Le=="function"?Le:ee,Le&&$e.pop(),$e.length&&$e[0]===de[0]?fc($e,ee,Le):[]});function Ap(de,Le){return de==null?"":y2.call(de,Le)}function na(de){var Le=de==null?0:de.length;return Le?de[Le-1]:ee}function Sp(de,Le,$e){var Ke=de==null?0:de.length;if(!Ke)return-1;var Xe=Ke;return $e!==ee&&(Xe=Gr($e),Xe=Xe<0?Ao(Ke+Xe,0):Ro(Xe,Ke-1)),Le===Le?r2(de,Le,Xe):W0(de,Ih,Xe,!0)}function Cp(de,Le){return de&&de.length?dd(de,Gr(Le)):ee}var Mp=qr(tu);function tu(de,Le){return de&&de.length&&Le&&Le.length?_c(de,Le):de}function Ep(de,Le,$e){return de&&de.length&&Le&&Le.length?_c(de,Le,$r($e,2)):de}function Dp(de,Le,$e){return de&&de.length&&Le&&Le.length?_c(de,Le,ee,$e):de}var Rp=va(function(de,Le){var $e=de==null?0:de.length,Ke=cc(de,Le);return pd(de,_o(Le,function(Xe){return wa(Xe,$e)?+Xe:Xe}).sort(Pd)),Ke});function Ip(de,Le){var $e=[];if(!(de&&de.length))return $e;var Ke=-1,Xe=[],Je=de.length;for(Le=$r(Le,3);++Ke<Je;){var Hn=de[Ke];Le(Hn,Ke,de)&&($e.push(Hn),Xe.push(Ke))}return pd(de,Xe),$e}function Fc(de){return de==null?de:P2.call(de)}function Lp(de,Le,$e){var Ke=de==null?0:de.length;return Ke?($e&&typeof $e!="number"&&ko(de,Le,$e)?(Le=0,$e=Ke):(Le=Le==null?0:Gr(Le),$e=$e===ee?Ke:Gr($e)),ia(de,Le,$e)):[]}function Op(de,Le){return cl(de,Le)}function kp(de,Le,$e){return yc(de,Le,$r($e,2))}function Vp(de,Le){var $e=de==null?0:de.length;if($e){var Ke=cl(de,Le);if(Ke<$e&&aa(de[Ke],Le))return Ke}return-1}function Fp(de,Le){return cl(de,Le,!0)}function Bp(de,Le,$e){return yc(de,Le,$r($e,2),!0)}function Np(de,Le){var $e=de==null?0:de.length;if($e){var Ke=cl(de,Le,!0)-1;if(aa(de[Ke],Le))return Ke}return-1}function $p(de){return de&&de.length?md(de):[]}function zp(de,Le){return de&&de.length?md(de,$r(Le,2)):[]}function Hp(de){var Le=de==null?0:de.length;return Le?ia(de,1,Le):[]}function Wp(de,Le,$e){return de&&de.length?(Le=$e||Le===ee?1:Gr(Le),ia(de,0,Le<0?0:Le)):[]}function Up(de,Le,$e){var Ke=de==null?0:de.length;return Ke?(Le=$e||Le===ee?1:Gr(Le),Le=Ke-Le,ia(de,Le<0?0:Le,Ke)):[]}function jp(de,Le){return de&&de.length?hl(de,$r(Le,3),!1,!0):[]}function Kp(de,Le){return de&&de.length?hl(de,$r(Le,3)):[]}var Zp=qr(function(de){return Ia(Do(de,1,xo,!0))}),Gp=qr(function(de){var Le=na(de);return xo(Le)&&(Le=ee),Ia(Do(de,1,xo,!0),$r(Le,2))}),Yp=qr(function(de){var Le=na(de);return Le=typeof Le=="function"?Le:ee,Ia(Do(de,1,xo,!0),ee,Le)});function Xp(de){return de&&de.length?Ia(de):[]}function qp(de,Le){return de&&de.length?Ia(de,$r(Le,2)):[]}function Qp(de,Le){return Le=typeof Le=="function"?Le:ee,de&&de.length?Ia(de,ee,Le):[]}function Bc(de){if(!(de&&de.length))return[];var Le=0;return de=Ca(de,function($e){if(xo($e))return Le=Ao($e.length,Le),!0}),tc(Le,function($e){return _o(de,Ql($e))})}function iu(de,Le){if(!(de&&de.length))return[];var $e=Bc(de);return Le==null?$e:_o($e,function(Ke){return jo(Le,ee,Ke)})}var Jp=qr(function(de,Le){return xo(de)?S0(de,Le):[]}),eg=qr(function(de){return xc(Ca(de,xo))}),tg=qr(function(de){var Le=na(de);return xo(Le)&&(Le=ee),xc(Ca(de,xo),$r(Le,2))}),ig=qr(function(de){var Le=na(de);return Le=typeof Le=="function"?Le:ee,xc(Ca(de,xo),ee,Le)}),ng=qr(Bc);function rg(de,Le){return yd(de||[],Le||[],A0)}function sg(de,Le){return yd(de||[],Le||[],E0)}var og=qr(function(de){var Le=de.length,$e=Le>1?de[Le-1]:ee;return $e=typeof $e=="function"?(de.pop(),$e):ee,iu(de,$e)});function nu(de){var Le=Qe(de);return Le.__chain__=!0,Le}function ag(de,Le){return Le(de),de}function wl(de,Le){return Le(de)}var lg=va(function(de){var Le=de.length,$e=Le?de[0]:0,Ke=this.__wrapped__,Xe=function(Je){return cc(Je,de)};return Le>1||this.__actions__.length||!(Ke instanceof io)||!wa($e)?this.thru(Xe):(Ke=Ke.slice($e,+$e+(Le?1:0)),Ke.__actions__.push({func:wl,args:[Xe],thisArg:ee}),new ea(Ke,this.__chain__).thru(function(Je){return Le&&!Je.length&&Je.push(ee),Je}))});function cg(){return nu(this)}function hg(){return new ea(this.value(),this.__chain__)}function dg(){this.__values__===ee&&(this.__values__=_u(this.value()));var de=this.__index__>=this.__values__.length,Le=de?ee:this.__values__[this.__index__++];return{done:de,value:Le}}function ug(){return this}function fg(de){for(var Le,$e=this;$e instanceof rl;){var Ke=Xd($e);Ke.__index__=0,Ke.__values__=ee,Le?Xe.__wrapped__=Ke:Le=Ke;var Xe=Ke;$e=$e.__wrapped__}return Xe.__wrapped__=de,Le}function pg(){var de=this.__wrapped__;if(de instanceof io){var Le=de;return this.__actions__.length&&(Le=new io(this)),Le=Le.reverse(),Le.__actions__.push({func:wl,args:[Fc],thisArg:ee}),new ea(Le,this.__chain__)}return this.thru(Fc)}function gg(){return wd(this.__wrapped__,this.__actions__)}var mg=dl(function(de,Le,$e){co.call(de,$e)?++de[$e]:ga(de,$e,1)});function _g(de,Le,$e){var Ke=Kr(de)?Dh:af;return $e&&ko(de,Le,$e)&&(Le=ee),Ke(de,$r(Le,3))}function vg(de,Le){var $e=Kr(de)?Ca:ed;return $e(de,$r(Le,3))}var wg=Dd(qd),yg=Dd(Qd);function bg(de,Le){return Do(yl(de,Le),1)}function xg(de,Le){return Do(yl(de,Le),Sr)}function Tg(de,Le,$e){return $e=$e===ee?1:Gr($e),Do(yl(de,Le),$e)}function ru(de,Le){var $e=Kr(de)?Qo:Ra;return $e(de,$r(Le,3))}function su(de,Le){var $e=Kr(de)?z1:Jh;return $e(de,$r(Le,3))}var Pg=dl(function(de,Le,$e){co.call(de,$e)?de[$e].push(Le):ga(de,$e,[Le])});function Ag(de,Le,$e,Ke){de=No(de)?de:f0(de),$e=$e&&!Ke?Gr($e):0;var Xe=de.length;return $e<0&&($e=Ao(Xe+$e,0)),Al(de)?$e<=Xe&&de.indexOf(Le,$e)>-1:!!Xe&&t0(de,Le,$e)>-1}var Sg=qr(function(de,Le,$e){var Ke=-1,Xe=typeof Le=="function",Je=No(de)?pr(de.length):[];return Ra(de,function(Hn){Je[++Ke]=Xe?jo(Le,Hn,$e):C0(Hn,Le,$e)}),Je}),Cg=dl(function(de,Le,$e){ga(de,$e,Le)});function yl(de,Le){var $e=Kr(de)?_o:ld;return $e(de,$r(Le,3))}function Mg(de,Le,$e,Ke){return de==null?[]:(Kr(Le)||(Le=Le==null?[]:[Le]),$e=Ke?ee:$e,Kr($e)||($e=$e==null?[]:[$e]),ud(de,Le,$e))}var Eg=dl(function(de,Le,$e){de[$e?0:1].push(Le)},function(){return[[],[]]});function Dg(de,Le,$e){var Ke=Kr(de)?Xl:Oh,Xe=arguments.length<3;return Ke(de,$r(Le,4),$e,Xe,Ra)}function Rg(de,Le,$e){var Ke=Kr(de)?H1:Oh,Xe=arguments.length<3;return Ke(de,$r(Le,4),$e,Xe,Jh)}function Ig(de,Le){var $e=Kr(de)?Ca:ed;return $e(de,Tl($r(Le,3)))}function Lg(de){var Le=Kr(de)?Yh:Af;return Le(de)}function Og(de,Le,$e){($e?ko(de,Le,$e):Le===ee)?Le=1:Le=Gr(Le);var Ke=Kr(de)?tf:Sf;return Ke(de,Le)}function kg(de){var Le=Kr(de)?nf:Mf;return Le(de)}function Vg(de){if(de==null)return 0;if(No(de))return Al(de)?n0(de):de.length;var Le=Io(de);return Le==so||Le==Yr?de.size:gc(de).length}function Fg(de,Le,$e){var Ke=Kr(de)?ql:Ef;return $e&&ko(de,Le,$e)&&(Le=ee),Ke(de,$r(Le,3))}var Bg=qr(function(de,Le){if(de==null)return[];var $e=Le.length;return $e>1&&ko(de,Le[0],Le[1])?Le=[]:$e>2&&ko(Le[0],Le[1],Le[2])&&(Le=[Le[0]]),ud(de,Do(Le,1),[])}),bl=_2||function(){return Eo.Date.now()};function Ng(de,Le){if(typeof Le!="function")throw new Jo(ae);return de=Gr(de),function(){if(--de<1)return Le.apply(this,arguments)}}function ou(de,Le,$e){return Le=$e?ee:Le,Le=de&&Le==null?de.length:Le,ma(de,Ye,ee,ee,ee,ee,Le)}function au(de,Le){var $e;if(typeof Le!="function")throw new Jo(ae);return de=Gr(de),function(){return--de>0&&($e=Le.apply(this,arguments)),de<=1&&(Le=ee),$e}}var Nc=qr(function(de,Le,$e){var Ke=ze;if($e.length){var Xe=Ea($e,d0(Nc));Ke|=Ge}return ma(de,Ke,Le,$e,Xe)}),lu=qr(function(de,Le,$e){var Ke=ze|He;if($e.length){var Xe=Ea($e,d0(lu));Ke|=Ge}return ma(Le,Ke,de,$e,Xe)});function cu(de,Le,$e){Le=$e?ee:Le;var Ke=ma(de,je,ee,ee,ee,ee,ee,Le);return Ke.placeholder=cu.placeholder,Ke}function hu(de,Le,$e){Le=$e?ee:Le;var Ke=ma(de,Ue,ee,ee,ee,ee,ee,Le);return Ke.placeholder=hu.placeholder,Ke}function du(de,Le,$e){var Ke,Xe,Je,Hn,sr,hr,_r=0,br=!1,Mr=!1,Lr=!0;if(typeof de!="function")throw new Jo(ae);Le=ra(Le)||0,wo($e)&&(br=!!$e.leading,Mr="maxWait"in $e,Je=Mr?Ao(ra($e.maxWait)||0,Le):Je,Lr="trailing"in $e?!!$e.trailing:Lr);function Nr(To){var la=Ke,xa=Xe;return Ke=Xe=ee,_r=To,Hn=de.apply(xa,la),Hn}function Hr(To){return _r=To,sr=I0(eo,Le),br?Nr(To):Hn}function Xr(To){var la=To-hr,xa=To-_r,Du=Le-la;return Mr?Ro(Du,Je-xa):Du}function Wr(To){var la=To-hr,xa=To-_r;return hr===ee||la>=Le||la<0||Mr&&xa>=Je}function eo(){var To=bl();if(Wr(To))return no(To);sr=I0(eo,Xr(To))}function no(To){return sr=ee,Lr&&Ke?Nr(To):(Ke=Xe=ee,Hn)}function Yo(){sr!==ee&&bd(sr),_r=0,Ke=hr=Xe=sr=ee}function Vo(){return sr===ee?Hn:no(bl())}function Xo(){var To=bl(),la=Wr(To);if(Ke=arguments,Xe=this,hr=To,la){if(sr===ee)return Hr(hr);if(Mr)return bd(sr),sr=I0(eo,Le),Nr(hr)}return sr===ee&&(sr=I0(eo,Le)),Hn}return Xo.cancel=Yo,Xo.flush=Vo,Xo}var $g=qr(function(de,Le){return Qh(de,1,Le)}),zg=qr(function(de,Le,$e){return Qh(de,ra(Le)||0,$e)});function Hg(de){return ma(de,nr)}function xl(de,Le){if(typeof de!="function"||Le!=null&&typeof Le!="function")throw new Jo(ae);var $e=function(){var Ke=arguments,Xe=Le?Le.apply(this,Ke):Ke[0],Je=$e.cache;if(Je.has(Xe))return Je.get(Xe);var Hn=de.apply(this,Ke);return $e.cache=Je.set(Xe,Hn)||Je,Hn};return $e.cache=new(xl.Cache||pa),$e}xl.Cache=pa;function Tl(de){if(typeof de!="function")throw new Jo(ae);return function(){var Le=arguments;switch(Le.length){case 0:return!de.call(this);case 1:return!de.call(this,Le[0]);case 2:return!de.call(this,Le[0],Le[1]);case 3:return!de.call(this,Le[0],Le[1],Le[2])}return!de.apply(this,Le)}}function Wg(de){return au(2,de)}var Ug=Df(function(de,Le){Le=Le.length==1&&Kr(Le[0])?_o(Le[0],Ko($r())):_o(Do(Le,1),Ko($r()));var $e=Le.length;return qr(function(Ke){for(var Xe=-1,Je=Ro(Ke.length,$e);++Xe<Je;)Ke[Xe]=Le[Xe].call(this,Ke[Xe]);return jo(de,this,Ke)})}),$c=qr(function(de,Le){var $e=Ea(Le,d0($c));return ma(de,Ge,ee,Le,$e)}),uu=qr(function(de,Le){var $e=Ea(Le,d0(uu));return ma(de,Ze,ee,Le,$e)}),jg=va(function(de,Le){return ma(de,qe,ee,ee,ee,Le)});function Kg(de,Le){if(typeof de!="function")throw new Jo(ae);return Le=Le===ee?Le:Gr(Le),qr(de,Le)}function Zg(de,Le){if(typeof de!="function")throw new Jo(ae);return Le=Le==null?0:Ao(Gr(Le),0),qr(function($e){var Ke=$e[Le],Xe=Oa($e,0,Le);return Ke&&Ma(Xe,Ke),jo(de,this,Xe)})}function Gg(de,Le,$e){var Ke=!0,Xe=!0;if(typeof de!="function")throw new Jo(ae);return wo($e)&&(Ke="leading"in $e?!!$e.leading:Ke,Xe="trailing"in $e?!!$e.trailing:Xe),du(de,Le,{leading:Ke,maxWait:Le,trailing:Xe})}function Yg(de){return ou(de,1)}function Xg(de,Le){return $c(Pc(Le),de)}function qg(){if(!arguments.length)return[];var de=arguments[0];return Kr(de)?de:[de]}function Qg(de){return ta(de,Oe)}function Jg(de,Le){return Le=typeof Le=="function"?Le:ee,ta(de,Oe,Le)}function em(de){return ta(de,Ae|Oe)}function tm(de,Le){return Le=typeof Le=="function"?Le:ee,ta(de,Ae|Oe,Le)}function im(de,Le){return Le==null||qh(de,Le,Co(Le))}function aa(de,Le){return de===Le||de!==de&&Le!==Le}var nm=gl(uc),rm=gl(function(de,Le){return de>=Le}),Ga=rd(function(){return arguments}())?rd:function(de){return yo(de)&&co.call(de,"callee")&&!Wh.call(de,"callee")},Kr=pr.isArray,sm=Ph?Ko(Ph):ff;function No(de){return de!=null&&Pl(de.length)&&!ya(de)}function xo(de){return yo(de)&&No(de)}function om(de){return de===!0||de===!1||yo(de)&&Oo(de)==Dr}var ka=w2||qc,am=Ah?Ko(Ah):pf;function lm(de){return yo(de)&&de.nodeType===1&&!L0(de)}function cm(de){if(de==null)return!0;if(No(de)&&(Kr(de)||typeof de=="string"||typeof de.splice=="function"||ka(de)||u0(de)||Ga(de)))return!de.length;var Le=Io(de);if(Le==so||Le==Yr)return!de.size;if(R0(de))return!gc(de).length;for(var $e in de)if(co.call(de,$e))return!1;return!0}function hm(de,Le){return M0(de,Le)}function dm(de,Le,$e){$e=typeof $e=="function"?$e:ee;var Ke=$e?$e(de,Le):ee;return Ke===ee?M0(de,Le,ee,$e):!!Ke}function zc(de){if(!yo(de))return!1;var Le=Oo(de);return Le==Fr||Le==zr||typeof de.message=="string"&&typeof de.name=="string"&&!L0(de)}function um(de){return typeof de=="number"&&jh(de)}function ya(de){if(!wo(de))return!1;var Le=Oo(de);return Le==Jr||Le==po||Le==wr||Le==Br}function fu(de){return typeof de=="number"&&de==Gr(de)}function Pl(de){return typeof de=="number"&&de>-1&&de%1==0&&de<=xr}function wo(de){var Le=typeof de;return de!=null&&(Le=="object"||Le=="function")}function yo(de){return de!=null&&typeof de=="object"}var pu=Sh?Ko(Sh):mf;function fm(de,Le){return de===Le||pc(de,Le,Rc(Le))}function pm(de,Le,$e){return $e=typeof $e=="function"?$e:ee,pc(de,Le,Rc(Le),$e)}function gm(de){return gu(de)&&de!=+de}function mm(de){if(Jf(de))throw new jr(se);return sd(de)}function _m(de){return de===null}function vm(de){return de==null}function gu(de){return typeof de=="number"||yo(de)&&Oo(de)==ho}function L0(de){if(!yo(de)||Oo(de)!=bo)return!1;var Le=q0(de);if(Le===null)return!0;var $e=co.call(Le,"constructor")&&Le.constructor;return typeof $e=="function"&&$e instanceof $e&&Z0.call($e)==f2}var Hc=Ch?Ko(Ch):_f;function wm(de){return fu(de)&&de>=-9007199254740991&&de<=xr}var mu=Mh?Ko(Mh):vf;function Al(de){return typeof de=="string"||!Kr(de)&&yo(de)&&Oo(de)==Zr}function Go(de){return typeof de=="symbol"||yo(de)&&Oo(de)==uo}var u0=Eh?Ko(Eh):wf;function ym(de){return de===ee}function bm(de){return yo(de)&&Io(de)==Rr}function xm(de){return yo(de)&&Oo(de)==fr}var Tm=gl(mc),Pm=gl(function(de,Le){return de<=Le});function _u(de){if(!de)return[];if(No(de))return Al(de)?sa(de):Bo(de);if(y0&&de[y0])return t2(de[y0]());var Le=Io(de),$e=Le==so?nc:Le==Yr?U0:f0;return $e(de)}function ba(de){if(!de)return de===0?de:0;if(de=ra(de),de===Sr||de===-1/0){var Le=de<0?-1:1;return Le*Pr}return de===de?de:0}function Gr(de){var Le=ba(de),$e=Le%1;return Le===Le?$e?Le-$e:Le:0}function vu(de){return de?Ua(Gr(de),0,Er):0}function ra(de){if(typeof de=="number")return de;if(Go(de))return mr;if(wo(de)){var Le=typeof de.valueOf=="function"?de.valueOf():de;de=wo(Le)?Le+"":Le}if(typeof de!="string")return de===0?de:+de;de=kh(de);var $e=r1.test(de);return $e||o1.test(de)?B1(de.slice(2),$e?2:8):n1.test(de)?mr:+de}function wu(de){return da(de,$o(de))}function Am(de){return de?Ua(Gr(de),-9007199254740991,xr):de===0?de:0}function lo(de){return de==null?"":Zo(de)}var Sm=c0(function(de,Le){if(R0(Le)||No(Le)){da(Le,Co(Le),de);return}for(var $e in Le)co.call(Le,$e)&&A0(de,$e,Le[$e])}),yu=c0(function(de,Le){da(Le,$o(Le),de)}),Sl=c0(function(de,Le,$e,Ke){da(Le,$o(Le),de,Ke)}),Cm=c0(function(de,Le,$e,Ke){da(Le,Co(Le),de,Ke)}),Mm=va(cc);function Em(de,Le){var $e=l0(de);return Le==null?$e:Xh($e,Le)}var Dm=qr(function(de,Le){de=fo(de);var $e=-1,Ke=Le.length,Xe=Ke>2?Le[2]:ee;for(Xe&&ko(Le[0],Le[1],Xe)&&(Ke=1);++$e<Ke;)for(var Je=Le[$e],Hn=$o(Je),sr=-1,hr=Hn.length;++sr<hr;){var _r=Hn[sr],br=de[_r];(br===ee||aa(br,s0[_r])&&!co.call(de,_r))&&(de[_r]=Je[_r])}return de}),Rm=qr(function(de){return de.push(ee,Fd),jo(bu,ee,de)});function Im(de,Le){return Rh(de,$r(Le,3),ha)}function Lm(de,Le){return Rh(de,$r(Le,3),dc)}function Om(de,Le){return de==null?de:hc(de,$r(Le,3),$o)}function km(de,Le){return de==null?de:td(de,$r(Le,3),$o)}function Vm(de,Le){return de&&ha(de,$r(Le,3))}function Fm(de,Le){return de&&dc(de,$r(Le,3))}function Bm(de){return de==null?[]:al(de,Co(de))}function Nm(de){return de==null?[]:al(de,$o(de))}function Wc(de,Le,$e){var Ke=de==null?ee:ja(de,Le);return Ke===ee?$e:Ke}function $m(de,Le){return de!=null&&$d(de,Le,cf)}function Uc(de,Le){return de!=null&&$d(de,Le,hf)}var zm=Id(function(de,Le,$e){Le!=null&&typeof Le.toString!="function"&&(Le=G0.call(Le)),de[Le]=$e},Kc(zo)),Hm=Id(function(de,Le,$e){Le!=null&&typeof Le.toString!="function"&&(Le=G0.call(Le)),co.call(de,Le)?de[Le].push($e):de[Le]=[$e]},$r),Wm=qr(C0);function Co(de){return No(de)?Gh(de):gc(de)}function $o(de){return No(de)?Gh(de,!0):yf(de)}function Um(de,Le){var $e={};return Le=$r(Le,3),ha(de,function(Ke,Xe,Je){ga($e,Le(Ke,Xe,Je),Ke)}),$e}function jm(de,Le){var $e={};return Le=$r(Le,3),ha(de,function(Ke,Xe,Je){ga($e,Xe,Le(Ke,Xe,Je))}),$e}var Km=c0(function(de,Le,$e){ll(de,Le,$e)}),bu=c0(function(de,Le,$e,Ke){ll(de,Le,$e,Ke)}),Zm=va(function(de,Le){var $e={};if(de==null)return $e;var Ke=!1;Le=_o(Le,function(Je){return Je=La(Je,de),Ke||(Ke=Je.length>1),Je}),da(de,Ec(de),$e),Ke&&($e=ta($e,Ae|pe|Oe,zf));for(var Xe=Le.length;Xe--;)bc($e,Le[Xe]);return $e});function Gm(de,Le){return xu(de,Tl($r(Le)))}var Ym=va(function(de,Le){return de==null?{}:xf(de,Le)});function xu(de,Le){if(de==null)return{};var $e=_o(Ec(de),function(Ke){return[Ke]});return Le=$r(Le),fd(de,$e,function(Ke,Xe){return Le(Ke,Xe[0])})}function Xm(de,Le,$e){Le=La(Le,de);var Ke=-1,Xe=Le.length;for(Xe||(Xe=1,de=ee);++Ke<Xe;){var Je=de==null?ee:de[ua(Le[Ke])];Je===ee&&(Ke=Xe,Je=$e),de=ya(Je)?Je.call(de):Je}return de}function qm(de,Le,$e){return de==null?de:E0(de,Le,$e)}function Qm(de,Le,$e,Ke){return Ke=typeof Ke=="function"?Ke:ee,de==null?de:E0(de,Le,$e,Ke)}var Tu=kd(Co),Pu=kd($o);function Jm(de,Le,$e){var Ke=Kr(de),Xe=Ke||ka(de)||u0(de);if(Le=$r(Le,4),$e==null){var Je=de&&de.constructor;Xe?$e=Ke?new Je:[]:wo(de)?$e=ya(Je)?l0(q0(de)):{}:$e={}}return(Xe?Qo:ha)(de,function(Hn,sr,hr){return Le($e,Hn,sr,hr)}),$e}function e5(de,Le){return de==null?!0:bc(de,Le)}function t5(de,Le,$e){return de==null?de:vd(de,Le,Pc($e))}function i5(de,Le,$e,Ke){return Ke=typeof Ke=="function"?Ke:ee,de==null?de:vd(de,Le,Pc($e),Ke)}function f0(de){return de==null?[]:ic(de,Co(de))}function n5(de){return de==null?[]:ic(de,$o(de))}function r5(de,Le,$e){return $e===ee&&($e=Le,Le=ee),$e!==ee&&($e=ra($e),$e=$e===$e?$e:0),Le!==ee&&(Le=ra(Le),Le=Le===Le?Le:0),Ua(ra(de),Le,$e)}function s5(de,Le,$e){return Le=ba(Le),$e===ee?($e=Le,Le=0):$e=ba($e),de=ra(de),df(de,Le,$e)}function o5(de,Le,$e){if($e&&typeof $e!="boolean"&&ko(de,Le,$e)&&(Le=$e=ee),$e===ee&&(typeof Le=="boolean"?($e=Le,Le=ee):typeof de=="boolean"&&($e=de,de=ee)),de===ee&&Le===ee?(de=0,Le=1):(de=ba(de),Le===ee?(Le=de,de=0):Le=ba(Le)),de>Le){var Ke=de;de=Le,Le=Ke}if($e||de%1||Le%1){var Xe=Kh();return Ro(de+Xe*(Le-de+F1("1e-"+((Xe+"").length-1))),Le)}return vc(de,Le)}var a5=h0(function(de,Le,$e){return Le=Le.toLowerCase(),de+($e?Au(Le):Le)});function Au(de){return jc(lo(de).toLowerCase())}function Su(de){return de=lo(de),de&&de.replace(l1,X1).replace(C1,"")}function l5(de,Le,$e){de=lo(de),Le=Zo(Le);var Ke=de.length;$e=$e===ee?Ke:Ua(Gr($e),0,Ke);var Xe=$e;return $e-=Le.length,$e>=0&&de.slice($e,Xe)==Le}function c5(de){return de=lo(de),de&&zu.test(de)?de.replace(th,q1):de}function h5(de){return de=lo(de),de&&Zu.test(de)?de.replace($l,"\\$&"):de}var d5=h0(function(de,Le,$e){return de+($e?"-":"")+Le.toLowerCase()}),u5=h0(function(de,Le,$e){return de+($e?" ":"")+Le.toLowerCase()}),f5=Ed("toLowerCase");function p5(de,Le,$e){de=lo(de),Le=Gr(Le);var Ke=Le?n0(de):0;if(!Le||Ke>=Le)return de;var Xe=(Le-Ke)/2;return pl(tl(Xe),$e)+de+pl(el(Xe),$e)}function g5(de,Le,$e){de=lo(de),Le=Gr(Le);var Ke=Le?n0(de):0;return Le&&Ke<Le?de+pl(Le-Ke,$e):de}function m5(de,Le,$e){de=lo(de),Le=Gr(Le);var Ke=Le?n0(de):0;return Le&&Ke<Le?pl(Le-Ke,$e)+de:de}function _5(de,Le,$e){return $e||Le==null?Le=0:Le&&(Le=+Le),T2(lo(de).replace(zl,""),Le||0)}function v5(de,Le,$e){return($e?ko(de,Le,$e):Le===ee)?Le=1:Le=Gr(Le),wc(lo(de),Le)}function w5(){var de=arguments,Le=lo(de[0]);return de.length<3?Le:Le.replace(de[1],de[2])}var y5=h0(function(de,Le,$e){return de+($e?"_":"")+Le.toLowerCase()});function b5(de,Le,$e){return $e&&typeof $e!="number"&&ko(de,Le,$e)&&(Le=$e=ee),$e=$e===ee?Er:$e>>>0,$e?(de=lo(de),de&&(typeof Le=="string"||Le!=null&&!Hc(Le))&&(Le=Zo(Le),!Le&&i0(de))?Oa(sa(de),0,$e):de.split(Le,$e)):[]}var x5=h0(function(de,Le,$e){return de+($e?" ":"")+jc(Le)});function T5(de,Le,$e){return de=lo(de),$e=$e==null?0:Ua(Gr($e),0,de.length),Le=Zo(Le),de.slice($e,$e+Le.length)==Le}function P5(de,Le,$e){var Ke=Qe.templateSettings;$e&&ko(de,Le,$e)&&(Le=ee),de=lo(de),Le=Sl({},Le,Ke,Vd);var Xe=Sl({},Le.imports,Ke.imports,Vd),Je=Co(Xe),Hn=ic(Xe,Je),sr,hr,_r=0,br=Le.interpolate||N0,Mr="__p += '",Lr=rc((Le.escape||N0).source+"|"+br.source+"|"+(br===ih?t1:N0).source+"|"+(Le.evaluate||N0).source+"|$","g"),Nr="//# sourceURL="+(co.call(Le,"sourceURL")?(Le.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++I1+"]")+`
`;de.replace(Lr,function(Wr,eo,no,Yo,Vo,Xo){return no||(no=Yo),Mr+=de.slice(_r,Xo).replace(c1,Q1),eo&&(sr=!0,Mr+=`' +
__e(`+eo+`) +
'`),Vo&&(hr=!0,Mr+=`';
`+Vo+`;
__p += '`),no&&(Mr+=`' +
((__t = (`+no+`)) == null ? '' : __t) +
'`),_r=Xo+Wr.length,Wr}),Mr+=`';
`;var Hr=co.call(Le,"variable")&&Le.variable;if(!Hr)Mr=`with (obj) {
`+Mr+`
}
`;else if(Ju.test(Hr))throw new jr(le);Mr=(hr?Mr.replace(Fu,""):Mr).replace(Bu,"$1").replace(Nu,"$1;"),Mr="function("+(Hr||"obj")+`) {
`+(Hr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(sr?", __e = _.escape":"")+(hr?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Mr+`return __p
}`;var Xr=Mu(function(){return oo(Je,Nr+"return "+Mr).apply(ee,Hn)});if(Xr.source=Mr,zc(Xr))throw Xr;return Xr}function A5(de){return lo(de).toLowerCase()}function S5(de){return lo(de).toUpperCase()}function C5(de,Le,$e){if(de=lo(de),de&&($e||Le===ee))return kh(de);if(!de||!(Le=Zo(Le)))return de;var Ke=sa(de),Xe=sa(Le),Je=Vh(Ke,Xe),Hn=Fh(Ke,Xe)+1;return Oa(Ke,Je,Hn).join("")}function M5(de,Le,$e){if(de=lo(de),de&&($e||Le===ee))return de.slice(0,Nh(de)+1);if(!de||!(Le=Zo(Le)))return de;var Ke=sa(de),Xe=Fh(Ke,sa(Le))+1;return Oa(Ke,0,Xe).join("")}function E5(de,Le,$e){if(de=lo(de),de&&($e||Le===ee))return de.replace(zl,"");if(!de||!(Le=Zo(Le)))return de;var Ke=sa(de),Xe=Vh(Ke,sa(Le));return Oa(Ke,Xe).join("")}function D5(de,Le){var $e=ir,Ke=tr;if(wo(Le)){var Xe="separator"in Le?Le.separator:Xe;$e="length"in Le?Gr(Le.length):$e,Ke="omission"in Le?Zo(Le.omission):Ke}de=lo(de);var Je=de.length;if(i0(de)){var Hn=sa(de);Je=Hn.length}if($e>=Je)return de;var sr=$e-n0(Ke);if(sr<1)return Ke;var hr=Hn?Oa(Hn,0,sr).join(""):de.slice(0,sr);if(Xe===ee)return hr+Ke;if(Hn&&(sr+=hr.length-sr),Hc(Xe)){if(de.slice(sr).search(Xe)){var _r,br=hr;for(Xe.global||(Xe=rc(Xe.source,lo(nh.exec(Xe))+"g")),Xe.lastIndex=0;_r=Xe.exec(br);)var Mr=_r.index;hr=hr.slice(0,Mr===ee?sr:Mr)}}else if(de.indexOf(Zo(Xe),sr)!=sr){var Lr=hr.lastIndexOf(Xe);Lr>-1&&(hr=hr.slice(0,Lr))}return hr+Ke}function R5(de){return de=lo(de),de&&$u.test(de)?de.replace(eh,s2):de}var I5=h0(function(de,Le,$e){return de+($e?" ":"")+Le.toUpperCase()}),jc=Ed("toUpperCase");function Cu(de,Le,$e){return de=lo(de),Le=$e?ee:Le,Le===ee?e2(de)?l2(de):j1(de):de.match(Le)||[]}var Mu=qr(function(de,Le){try{return jo(de,ee,Le)}catch($e){return zc($e)?$e:new jr($e)}}),L5=va(function(de,Le){return Qo(Le,function($e){$e=ua($e),ga(de,$e,Nc(de[$e],de))}),de});function O5(de){var Le=de==null?0:de.length,$e=$r();return de=Le?_o(de,function(Ke){if(typeof Ke[1]!="function")throw new Jo(ae);return[$e(Ke[0]),Ke[1]]}):[],qr(function(Ke){for(var Xe=-1;++Xe<Le;){var Je=de[Xe];if(jo(Je[0],this,Ke))return jo(Je[1],this,Ke)}})}function k5(de){return of(ta(de,Ae))}function Kc(de){return function(){return de}}function V5(de,Le){return de==null||de!==de?Le:de}var F5=Rd(),B5=Rd(!0);function zo(de){return de}function Zc(de){return od(typeof de=="function"?de:ta(de,Ae))}function N5(de){return cd(ta(de,Ae))}function $5(de,Le){return hd(de,ta(Le,Ae))}var z5=qr(function(de,Le){return function($e){return C0($e,de,Le)}}),H5=qr(function(de,Le){return function($e){return C0(de,$e,Le)}});function Gc(de,Le,$e){var Ke=Co(Le),Xe=al(Le,Ke);$e==null&&!(wo(Le)&&(Xe.length||!Ke.length))&&($e=Le,Le=de,de=this,Xe=al(Le,Co(Le)));var Je=!(wo($e)&&"chain"in $e)||!!$e.chain,Hn=ya(de);return Qo(Xe,function(sr){var hr=Le[sr];de[sr]=hr,Hn&&(de.prototype[sr]=function(){var _r=this.__chain__;if(Je||_r){var br=de(this.__wrapped__),Mr=br.__actions__=Bo(this.__actions__);return Mr.push({func:hr,args:arguments,thisArg:de}),br.__chain__=_r,br}return hr.apply(de,Ma([this.value()],arguments))})}),de}function W5(){return Eo._===this&&(Eo._=p2),this}function Yc(){}function U5(de){return de=Gr(de),qr(function(Le){return dd(Le,de)})}var j5=Sc(_o),K5=Sc(Dh),Z5=Sc(ql);function Eu(de){return Lc(de)?Ql(ua(de)):Tf(de)}function G5(de){return function(Le){return de==null?ee:ja(de,Le)}}var Y5=Ld(),X5=Ld(!0);function Xc(){return[]}function qc(){return!1}function q5(){return{}}function Q5(){return""}function J5(){return!0}function e3(de,Le){if(de=Gr(de),de<1||de>xr)return[];var $e=Er,Ke=Ro(de,Er);Le=$r(Le),de-=Er;for(var Xe=tc(Ke,Le);++$e<de;)Le($e);return Xe}function i3(de){return Kr(de)?_o(de,ua):Go(de)?[de]:Bo(Yd(lo(de)))}function n3(de){var Le=++u2;return lo(de)+Le}var r3=fl(function(de,Le){return de+Le},0),s3=Cc("ceil"),o3=fl(function(de,Le){return de/Le},1),a3=Cc("floor");function l3(de){return de&&de.length?ol(de,zo,uc):ee}function c3(de,Le){return de&&de.length?ol(de,$r(Le,2),uc):ee}function h3(de){return Lh(de,zo)}function d3(de,Le){return Lh(de,$r(Le,2))}function u3(de){return de&&de.length?ol(de,zo,mc):ee}function f3(de,Le){return de&&de.length?ol(de,$r(Le,2),mc):ee}var p3=fl(function(de,Le){return de*Le},1),g3=Cc("round"),m3=fl(function(de,Le){return de-Le},0);function _3(de){return de&&de.length?ec(de,zo):0}function v3(de,Le){return de&&de.length?ec(de,$r(Le,2)):0}return Qe.after=Ng,Qe.ary=ou,Qe.assign=Sm,Qe.assignIn=yu,Qe.assignInWith=Sl,Qe.assignWith=Cm,Qe.at=Mm,Qe.before=au,Qe.bind=Nc,Qe.bindAll=L5,Qe.bindKey=lu,Qe.castArray=qg,Qe.chain=nu,Qe.chunk=op,Qe.compact=ap,Qe.concat=lp,Qe.cond=O5,Qe.conforms=k5,Qe.constant=Kc,Qe.countBy=mg,Qe.create=Em,Qe.curry=cu,Qe.curryRight=hu,Qe.debounce=du,Qe.defaults=Dm,Qe.defaultsDeep=Rm,Qe.defer=$g,Qe.delay=zg,Qe.difference=cp,Qe.differenceBy=hp,Qe.differenceWith=dp,Qe.drop=up,Qe.dropRight=fp,Qe.dropRightWhile=pp,Qe.dropWhile=gp,Qe.fill=mp,Qe.filter=vg,Qe.flatMap=bg,Qe.flatMapDeep=xg,Qe.flatMapDepth=Tg,Qe.flatten=Jd,Qe.flattenDeep=_p,Qe.flattenDepth=vp,Qe.flip=Hg,Qe.flow=F5,Qe.flowRight=B5,Qe.fromPairs=wp,Qe.functions=Bm,Qe.functionsIn=Nm,Qe.groupBy=Pg,Qe.initial=bp,Qe.intersection=xp,Qe.intersectionBy=Tp,Qe.intersectionWith=Pp,Qe.invert=zm,Qe.invertBy=Hm,Qe.invokeMap=Sg,Qe.iteratee=Zc,Qe.keyBy=Cg,Qe.keys=Co,Qe.keysIn=$o,Qe.map=yl,Qe.mapKeys=Um,Qe.mapValues=jm,Qe.matches=N5,Qe.matchesProperty=$5,Qe.memoize=xl,Qe.merge=Km,Qe.mergeWith=bu,Qe.method=z5,Qe.methodOf=H5,Qe.mixin=Gc,Qe.negate=Tl,Qe.nthArg=U5,Qe.omit=Zm,Qe.omitBy=Gm,Qe.once=Wg,Qe.orderBy=Mg,Qe.over=j5,Qe.overArgs=Ug,Qe.overEvery=K5,Qe.overSome=Z5,Qe.partial=$c,Qe.partialRight=uu,Qe.partition=Eg,Qe.pick=Ym,Qe.pickBy=xu,Qe.property=Eu,Qe.propertyOf=G5,Qe.pull=Mp,Qe.pullAll=tu,Qe.pullAllBy=Ep,Qe.pullAllWith=Dp,Qe.pullAt=Rp,Qe.range=Y5,Qe.rangeRight=X5,Qe.rearg=jg,Qe.reject=Ig,Qe.remove=Ip,Qe.rest=Kg,Qe.reverse=Fc,Qe.sampleSize=Og,Qe.set=qm,Qe.setWith=Qm,Qe.shuffle=kg,Qe.slice=Lp,Qe.sortBy=Bg,Qe.sortedUniq=$p,Qe.sortedUniqBy=zp,Qe.split=b5,Qe.spread=Zg,Qe.tail=Hp,Qe.take=Wp,Qe.takeRight=Up,Qe.takeRightWhile=jp,Qe.takeWhile=Kp,Qe.tap=ag,Qe.throttle=Gg,Qe.thru=wl,Qe.toArray=_u,Qe.toPairs=Tu,Qe.toPairsIn=Pu,Qe.toPath=i3,Qe.toPlainObject=wu,Qe.transform=Jm,Qe.unary=Yg,Qe.union=Zp,Qe.unionBy=Gp,Qe.unionWith=Yp,Qe.uniq=Xp,Qe.uniqBy=qp,Qe.uniqWith=Qp,Qe.unset=e5,Qe.unzip=Bc,Qe.unzipWith=iu,Qe.update=t5,Qe.updateWith=i5,Qe.values=f0,Qe.valuesIn=n5,Qe.without=Jp,Qe.words=Cu,Qe.wrap=Xg,Qe.xor=eg,Qe.xorBy=tg,Qe.xorWith=ig,Qe.zip=ng,Qe.zipObject=rg,Qe.zipObjectDeep=sg,Qe.zipWith=og,Qe.entries=Tu,Qe.entriesIn=Pu,Qe.extend=yu,Qe.extendWith=Sl,Gc(Qe,Qe),Qe.add=r3,Qe.attempt=Mu,Qe.camelCase=a5,Qe.capitalize=Au,Qe.ceil=s3,Qe.clamp=r5,Qe.clone=Qg,Qe.cloneDeep=em,Qe.cloneDeepWith=tm,Qe.cloneWith=Jg,Qe.conformsTo=im,Qe.deburr=Su,Qe.defaultTo=V5,Qe.divide=o3,Qe.endsWith=l5,Qe.eq=aa,Qe.escape=c5,Qe.escapeRegExp=h5,Qe.every=_g,Qe.find=wg,Qe.findIndex=qd,Qe.findKey=Im,Qe.findLast=yg,Qe.findLastIndex=Qd,Qe.findLastKey=Lm,Qe.floor=a3,Qe.forEach=ru,Qe.forEachRight=su,Qe.forIn=Om,Qe.forInRight=km,Qe.forOwn=Vm,Qe.forOwnRight=Fm,Qe.get=Wc,Qe.gt=nm,Qe.gte=rm,Qe.has=$m,Qe.hasIn=Uc,Qe.head=eu,Qe.identity=zo,Qe.includes=Ag,Qe.indexOf=yp,Qe.inRange=s5,Qe.invoke=Wm,Qe.isArguments=Ga,Qe.isArray=Kr,Qe.isArrayBuffer=sm,Qe.isArrayLike=No,Qe.isArrayLikeObject=xo,Qe.isBoolean=om,Qe.isBuffer=ka,Qe.isDate=am,Qe.isElement=lm,Qe.isEmpty=cm,Qe.isEqual=hm,Qe.isEqualWith=dm,Qe.isError=zc,Qe.isFinite=um,Qe.isFunction=ya,Qe.isInteger=fu,Qe.isLength=Pl,Qe.isMap=pu,Qe.isMatch=fm,Qe.isMatchWith=pm,Qe.isNaN=gm,Qe.isNative=mm,Qe.isNil=vm,Qe.isNull=_m,Qe.isNumber=gu,Qe.isObject=wo,Qe.isObjectLike=yo,Qe.isPlainObject=L0,Qe.isRegExp=Hc,Qe.isSafeInteger=wm,Qe.isSet=mu,Qe.isString=Al,Qe.isSymbol=Go,Qe.isTypedArray=u0,Qe.isUndefined=ym,Qe.isWeakMap=bm,Qe.isWeakSet=xm,Qe.join=Ap,Qe.kebabCase=d5,Qe.last=na,Qe.lastIndexOf=Sp,Qe.lowerCase=u5,Qe.lowerFirst=f5,Qe.lt=Tm,Qe.lte=Pm,Qe.max=l3,Qe.maxBy=c3,Qe.mean=h3,Qe.meanBy=d3,Qe.min=u3,Qe.minBy=f3,Qe.stubArray=Xc,Qe.stubFalse=qc,Qe.stubObject=q5,Qe.stubString=Q5,Qe.stubTrue=J5,Qe.multiply=p3,Qe.nth=Cp,Qe.noConflict=W5,Qe.noop=Yc,Qe.now=bl,Qe.pad=p5,Qe.padEnd=g5,Qe.padStart=m5,Qe.parseInt=_5,Qe.random=o5,Qe.reduce=Dg,Qe.reduceRight=Rg,Qe.repeat=v5,Qe.replace=w5,Qe.result=Xm,Qe.round=g3,Qe.runInContext=ar,Qe.sample=Lg,Qe.size=Vg,Qe.snakeCase=y5,Qe.some=Fg,Qe.sortedIndex=Op,Qe.sortedIndexBy=kp,Qe.sortedIndexOf=Vp,Qe.sortedLastIndex=Fp,Qe.sortedLastIndexBy=Bp,Qe.sortedLastIndexOf=Np,Qe.startCase=x5,Qe.startsWith=T5,Qe.subtract=m3,Qe.sum=_3,Qe.sumBy=v3,Qe.template=P5,Qe.times=e3,Qe.toFinite=ba,Qe.toInteger=Gr,Qe.toLength=vu,Qe.toLower=A5,Qe.toNumber=ra,Qe.toSafeInteger=Am,Qe.toString=lo,Qe.toUpper=S5,Qe.trim=C5,Qe.trimEnd=M5,Qe.trimStart=E5,Qe.truncate=D5,Qe.unescape=R5,Qe.uniqueId=n3,Qe.upperCase=I5,Qe.upperFirst=jc,Qe.each=ru,Qe.eachRight=su,Qe.first=eu,Gc(Qe,function(){var de={};return ha(Qe,function(Le,$e){co.call(Qe.prototype,$e)||(de[$e]=Le)}),de}(),{chain:!1}),Qe.VERSION=ne,Qo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(de){Qe[de].placeholder=Qe}),Qo(["drop","take"],function(de,Le){io.prototype[de]=function($e){$e=$e===ee?1:Ao(Gr($e),0);var Ke=this.__filtered__&&!Le?new io(this):this.clone();return Ke.__filtered__?Ke.__takeCount__=Ro($e,Ke.__takeCount__):Ke.__views__.push({size:Ro($e,Er),type:de+(Ke.__dir__<0?"Right":"")}),Ke},io.prototype[de+"Right"]=function($e){return this.reverse()[de]($e).reverse()}}),Qo(["filter","map","takeWhile"],function(de,Le){var $e=Le+1,Ke=$e==rr||$e==ur;io.prototype[de]=function(Xe){var Je=this.clone();return Je.__iteratees__.push({iteratee:$r(Xe,3),type:$e}),Je.__filtered__=Je.__filtered__||Ke,Je}}),Qo(["head","last"],function(de,Le){var $e="take"+(Le?"Right":"");io.prototype[de]=function(){return this[$e](1).value()[0]}}),Qo(["initial","tail"],function(de,Le){var $e="drop"+(Le?"":"Right");io.prototype[de]=function(){return this.__filtered__?new io(this):this[$e](1)}}),io.prototype.compact=function(){return this.filter(zo)},io.prototype.find=function(de){return this.filter(de).head()},io.prototype.findLast=function(de){return this.reverse().find(de)},io.prototype.invokeMap=qr(function(de,Le){return typeof de=="function"?new io(this):this.map(function($e){return C0($e,de,Le)})}),io.prototype.reject=function(de){return this.filter(Tl($r(de)))},io.prototype.slice=function(de,Le){de=Gr(de);var $e=this;return $e.__filtered__&&(de>0||Le<0)?new io($e):(de<0?$e=$e.takeRight(-de):de&&($e=$e.drop(de)),Le!==ee&&(Le=Gr(Le),$e=Le<0?$e.dropRight(-Le):$e.take(Le-de)),$e)},io.prototype.takeRightWhile=function(de){return this.reverse().takeWhile(de).reverse()},io.prototype.toArray=function(){return this.take(Er)},ha(io.prototype,function(de,Le){var $e=/^(?:filter|find|map|reject)|While$/.test(Le),Ke=/^(?:head|last)$/.test(Le),Xe=Qe[Ke?"take"+(Le=="last"?"Right":""):Le],Je=Ke||/^find/.test(Le);Xe&&(Qe.prototype[Le]=function(){var Hn=this.__wrapped__,sr=Ke?[1]:arguments,hr=Hn instanceof io,_r=sr[0],br=hr||Kr(Hn),Mr=function(eo){var no=Xe.apply(Qe,Ma([eo],sr));return Ke&&Lr?no[0]:no};br&&$e&&typeof _r=="function"&&_r.length!=1&&(hr=br=!1);var Lr=this.__chain__,Nr=!!this.__actions__.length,Hr=Je&&!Lr,Xr=hr&&!Nr;if(!Je&&br){Hn=Xr?Hn:new io(this);var Wr=de.apply(Hn,sr);return Wr.__actions__.push({func:wl,args:[Mr],thisArg:ee}),new ea(Wr,Lr)}return Hr&&Xr?de.apply(this,sr):(Wr=this.thru(Mr),Hr?Ke?Wr.value()[0]:Wr.value():Wr)})}),Qo(["pop","push","shift","sort","splice","unshift"],function(de){var Le=j0[de],$e=/^(?:push|sort|unshift)$/.test(de)?"tap":"thru",Ke=/^(?:pop|shift)$/.test(de);Qe.prototype[de]=function(){var Xe=arguments;if(Ke&&!this.__chain__){var Je=this.value();return Le.apply(Kr(Je)?Je:[],Xe)}return this[$e](function(Hn){return Le.apply(Kr(Hn)?Hn:[],Xe)})}}),ha(io.prototype,function(de,Le){var $e=Qe[Le];if($e){var Ke=$e.name+"";co.call(a0,Ke)||(a0[Ke]=[]),a0[Ke].push({name:Le,func:$e})}}),a0[ul(ee,He).name]=[{name:"wrapper",func:ee}],io.prototype.clone=D2,io.prototype.reverse=R2,io.prototype.value=I2,Qe.prototype.at=lg,Qe.prototype.chain=cg,Qe.prototype.commit=hg,Qe.prototype.next=dg,Qe.prototype.plant=fg,Qe.prototype.reverse=pg,Qe.prototype.toJSON=Qe.prototype.valueOf=Qe.prototype.value=gg,Qe.prototype.first=Qe.prototype.head,y0&&(Qe.prototype[y0]=ug),Qe},r0=c2();$a?(($a.exports=r0)._=r0,Zl._=r0):Eo._=r0}).call(lodash)}(lodash$1,lodash$1.exports)),lodash$1.exports}var lodashExports=requireLodash();function makeFont(ie,te,ee,ne){return`${ee?ee+" ":""}${ne?ne+" ":""}${ie}px ${te}`}function numberToStringWithLeadingZero(ie,te){if(!isNumber(ie))return"n/a";if(!isInteger(te))throw new TypeError("Invalid length: must be integer");if(te<0||te>24)throw new TypeError("Invalid length: must be between 0 and 24");return te===0?ie.toString():("000000000000000000000000"+ie.toString()).slice(-te)}function numDependencyFormatter(ie){const te=new Map;return ee=>{let ne=te.get(ee);return ne!==void 0||(ne=ie(ee),te.set(ee,ne)),ne}}const formatterOptions={decimalSign:".",decimalSignFractional:"'"},formatterOptionsLibraryOverrides={},FORMAT_EN={groupingSeparator:",",decimalSign:"."},FORMAT_EU={groupingSeparator:".",decimalSign:","},FORMAT_FR={groupingSeparator:" ",decimalSign:","},FORMAT_NONE={groupingSeparator:"",decimalSign:"."},LOCALE_FORMATS=new Map([["en",FORMAT_EN],["th",FORMAT_EN],["ja",FORMAT_EN],["ko",FORMAT_EN],["zh",FORMAT_EN],["zh_TW",FORMAT_EN],["ar",FORMAT_EN],["he_IL",FORMAT_EN],["ms_MY",FORMAT_EN],["vi",FORMAT_EN],["de",FORMAT_EU],["es",FORMAT_EU],["it",FORMAT_EU],["tr",FORMAT_EU],["pt",FORMAT_EU],["id_ID",FORMAT_EU],["fr",FORMAT_FR],["pl",FORMAT_FR],["ru",FORMAT_FR]]);function getNumberFormat(ie){if(ie)return{decimalSign:formatterOptions.decimalSign,groupingSeparator:""};const te=window.language||"";return{...LOCALE_FORMATS.get(te)??FORMAT_NONE,...formatterOptionsLibraryOverrides}}var DP=20,RM=1,MAX_DP=1e6,MAX_POWER=1e6,NE=-7,PE=21,STRICT=!1,NAME="[big.js] ",INVALID=NAME+"Invalid ",INVALID_DP=INVALID+"decimal places",INVALID_RM=INVALID+"rounding mode",DIV_BY_ZERO=NAME+"Division by zero",P={},UNDEFINED=void 0,NUMERIC=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function _Big_(){function ie(te){var ee=this;if(!(ee instanceof ie))return te===UNDEFINED&&arguments.length===0?_Big_():new ie(te);if(te instanceof ie)ee.s=te.s,ee.e=te.e,ee.c=te.c.slice();else{if(typeof te!="string"){if(ie.strict===!0&&typeof te!="bigint")throw TypeError(INVALID+"value");te=te===0&&1/te<0?"-0":String(te)}parse(ee,te)}ee.constructor=ie}return ie.prototype=P,ie.DP=DP,ie.RM=RM,ie.NE=NE,ie.PE=PE,ie.strict=STRICT,ie.roundDown=0,ie.roundHalfUp=1,ie.roundHalfEven=2,ie.roundUp=3,ie}function parse(ie,te){var ee,ne,re;if(!NUMERIC.test(te))throw Error(INVALID+"number");for(ie.s=te.charAt(0)=="-"?(te=te.slice(1),-1):1,(ee=te.indexOf("."))>-1&&(te=te.replace(".","")),(ne=te.search(/e/i))>0?(ee<0&&(ee=ne),ee+=+te.slice(ne+1),te=te.substring(0,ne)):ee<0&&(ee=te.length),re=te.length,ne=0;ne<re&&te.charAt(ne)=="0";)++ne;if(ne==re)ie.c=[ie.e=0];else{for(;re>0&&te.charAt(--re)=="0";);for(ie.e=ee-ne-1,ie.c=[],ee=0;ne<=re;)ie.c[ee++]=+te.charAt(ne++)}return ie}function round(ie,te,ee,ne){var re=ie.c;if(ee===UNDEFINED&&(ee=ie.constructor.RM),ee!==0&&ee!==1&&ee!==2&&ee!==3)throw Error(INVALID_RM);if(te<1)ne=ee===3&&(ne||!!re[0])||te===0&&(ee===1&&re[0]>=5||ee===2&&(re[0]>5||re[0]===5&&(ne||re[1]!==UNDEFINED))),re.length=1,ne?(ie.e=ie.e-te+1,re[0]=1):re[0]=ie.e=0;else if(te<re.length){if(ne=ee===1&&re[te]>=5||ee===2&&(re[te]>5||re[te]===5&&(ne||re[te+1]!==UNDEFINED||re[te-1]&1))||ee===3&&(ne||!!re[0]),re.length=te,ne){for(;++re[--te]>9;)if(re[te]=0,te===0){++ie.e,re.unshift(1);break}}for(te=re.length;!re[--te];)re.pop()}return ie}function stringify(ie,te,ee){var ne=ie.e,re=ie.c.join(""),se=re.length;if(te)re=re.charAt(0)+(se>1?"."+re.slice(1):"")+(ne<0?"e":"e+")+ne;else if(ne<0){for(;++ne;)re="0"+re;re="0."+re}else if(ne>0)if(++ne>se)for(ne-=se;ne--;)re+="0";else ne<se&&(re=re.slice(0,ne)+"."+re.slice(ne));else se>1&&(re=re.charAt(0)+"."+re.slice(1));return ie.s<0&&ee?"-"+re:re}P.abs=function(){var ie=new this.constructor(this);return ie.s=1,ie};P.cmp=function(ie){var te,ee=this,ne=ee.c,re=(ie=new ee.constructor(ie)).c,se=ee.s,ae=ie.s,le=ee.e,ce=ie.e;if(!ne[0]||!re[0])return ne[0]?se:re[0]?-ae:0;if(se!=ae)return se;if(te=se<0,le!=ce)return le>ce^te?1:-1;for(ae=(le=ne.length)<(ce=re.length)?le:ce,se=-1;++se<ae;)if(ne[se]!=re[se])return ne[se]>re[se]^te?1:-1;return le==ce?0:le>ce^te?1:-1};P.div=function(ie){var te=this,ee=te.constructor,ne=te.c,re=(ie=new ee(ie)).c,se=te.s==ie.s?1:-1,ae=ee.DP;if(ae!==~~ae||ae<0||ae>MAX_DP)throw Error(INVALID_DP);if(!re[0])throw Error(DIV_BY_ZERO);if(!ne[0])return ie.s=se,ie.c=[ie.e=0],ie;var le,ce,he,fe,Ae,pe=re.slice(),Oe=le=re.length,Fe=ne.length,Ne=ne.slice(0,le),ze=Ne.length,He=ie,We=He.c=[],je=0,Ue=ae+(He.e=te.e-ie.e)+1;for(He.s=se,se=Ue<0?0:Ue,pe.unshift(0);ze++<le;)Ne.push(0);do{for(he=0;he<10;he++){if(le!=(ze=Ne.length))fe=le>ze?1:-1;else for(Ae=-1,fe=0;++Ae<le;)if(re[Ae]!=Ne[Ae]){fe=re[Ae]>Ne[Ae]?1:-1;break}if(fe<0){for(ce=ze==le?re:pe;ze;){if(Ne[--ze]<ce[ze]){for(Ae=ze;Ae&&!Ne[--Ae];)Ne[Ae]=9;--Ne[Ae],Ne[ze]+=10}Ne[ze]-=ce[ze]}for(;!Ne[0];)Ne.shift()}else break}We[je++]=fe?he:++he,Ne[0]&&fe?Ne[ze]=ne[Oe]||0:Ne=[ne[Oe]]}while((Oe++<Fe||Ne[0]!==UNDEFINED)&&se--);return!We[0]&&je!=1&&(We.shift(),He.e--,Ue--),je>Ue&&round(He,Ue,ee.RM,Ne[0]!==UNDEFINED),He};P.eq=function(ie){return this.cmp(ie)===0};P.gt=function(ie){return this.cmp(ie)>0};P.gte=function(ie){return this.cmp(ie)>-1};P.lt=function(ie){return this.cmp(ie)<0};P.lte=function(ie){return this.cmp(ie)<1};P.minus=P.sub=function(ie){var te,ee,ne,re,se=this,ae=se.constructor,le=se.s,ce=(ie=new ae(ie)).s;if(le!=ce)return ie.s=-ce,se.plus(ie);var he=se.c.slice(),fe=se.e,Ae=ie.c,pe=ie.e;if(!he[0]||!Ae[0])return Ae[0]?ie.s=-ce:he[0]?ie=new ae(se):ie.s=1,ie;if(le=fe-pe){for((re=le<0)?(le=-le,ne=he):(pe=fe,ne=Ae),ne.reverse(),ce=le;ce--;)ne.push(0);ne.reverse()}else for(ee=((re=he.length<Ae.length)?he:Ae).length,le=ce=0;ce<ee;ce++)if(he[ce]!=Ae[ce]){re=he[ce]<Ae[ce];break}if(re&&(ne=he,he=Ae,Ae=ne,ie.s=-ie.s),(ce=(ee=Ae.length)-(te=he.length))>0)for(;ce--;)he[te++]=0;for(ce=te;ee>le;){if(he[--ee]<Ae[ee]){for(te=ee;te&&!he[--te];)he[te]=9;--he[te],he[ee]+=10}he[ee]-=Ae[ee]}for(;he[--ce]===0;)he.pop();for(;he[0]===0;)he.shift(),--pe;return he[0]||(ie.s=1,he=[pe=0]),ie.c=he,ie.e=pe,ie};P.mod=function(ie){var te,ee=this,ne=ee.constructor,re=ee.s,se=(ie=new ne(ie)).s;if(!ie.c[0])throw Error(DIV_BY_ZERO);return ee.s=ie.s=1,te=ie.cmp(ee)==1,ee.s=re,ie.s=se,te?new ne(ee):(re=ne.DP,se=ne.RM,ne.DP=ne.RM=0,ee=ee.div(ie),ne.DP=re,ne.RM=se,this.minus(ee.times(ie)))};P.neg=function(){var ie=new this.constructor(this);return ie.s=-ie.s,ie};P.plus=P.add=function(ie){var te,ee,ne,re=this,se=re.constructor;if(ie=new se(ie),re.s!=ie.s)return ie.s=-ie.s,re.minus(ie);var ae=re.e,le=re.c,ce=ie.e,he=ie.c;if(!le[0]||!he[0])return he[0]||(le[0]?ie=new se(re):ie.s=re.s),ie;if(le=le.slice(),te=ae-ce){for(te>0?(ce=ae,ne=he):(te=-te,ne=le),ne.reverse();te--;)ne.push(0);ne.reverse()}for(le.length-he.length<0&&(ne=he,he=le,le=ne),te=he.length,ee=0;te;le[te]%=10)ee=(le[--te]=le[te]+he[te]+ee)/10|0;for(ee&&(le.unshift(ee),++ce),te=le.length;le[--te]===0;)le.pop();return ie.c=le,ie.e=ce,ie};P.pow=function(ie){var te=this,ee=new te.constructor("1"),ne=ee,re=ie<0;if(ie!==~~ie||ie<-1e6||ie>MAX_POWER)throw Error(INVALID+"exponent");for(re&&(ie=-ie);ie&1&&(ne=ne.times(te)),ie>>=1,!!ie;)te=te.times(te);return re?ee.div(ne):ne};P.prec=function(ie,te){if(ie!==~~ie||ie<1||ie>MAX_DP)throw Error(INVALID+"precision");return round(new this.constructor(this),ie,te)};P.round=function(ie,te){if(ie===UNDEFINED)ie=0;else if(ie!==~~ie||ie<-1e6||ie>MAX_DP)throw Error(INVALID_DP);return round(new this.constructor(this),ie+this.e+1,te)};P.sqrt=function(){var ie,te,ee,ne=this,re=ne.constructor,se=ne.s,ae=ne.e,le=new re("0.5");if(!ne.c[0])return new re(ne);if(se<0)throw Error(NAME+"No square root");se=Math.sqrt(+stringify(ne,!0,!0)),se===0||se===1/0?(te=ne.c.join(""),te.length+ae&1||(te+="0"),se=Math.sqrt(te),ae=((ae+1)/2|0)-(ae<0||ae&1),ie=new re((se==1/0?"5e":(se=se.toExponential()).slice(0,se.indexOf("e")+1))+ae)):ie=new re(se+""),ae=ie.e+(re.DP+=4);do ee=ie,ie=le.times(ee.plus(ne.div(ee)));while(ee.c.slice(0,ae).join("")!==ie.c.slice(0,ae).join(""));return round(ie,(re.DP-=4)+ie.e+1,re.RM)};P.times=P.mul=function(ie){var te,ee=this,ne=ee.constructor,re=ee.c,se=(ie=new ne(ie)).c,ae=re.length,le=se.length,ce=ee.e,he=ie.e;if(ie.s=ee.s==ie.s?1:-1,!re[0]||!se[0])return ie.c=[ie.e=0],ie;for(ie.e=ce+he,ae<le&&(te=re,re=se,se=te,he=ae,ae=le,le=he),te=new Array(he=ae+le);he--;)te[he]=0;for(ce=le;ce--;){for(le=0,he=ae+ce;he>ce;)le=te[he]+se[ce]*re[he-ce-1]+le,te[he--]=le%10,le=le/10|0;te[he]=le}for(le?++ie.e:te.shift(),ce=te.length;!te[--ce];)te.pop();return ie.c=te,ie};P.toExponential=function(ie,te){var ee=this,ne=ee.c[0];if(ie!==UNDEFINED){if(ie!==~~ie||ie<0||ie>MAX_DP)throw Error(INVALID_DP);for(ee=round(new ee.constructor(ee),++ie,te);ee.c.length<ie;)ee.c.push(0)}return stringify(ee,!0,!!ne)};P.toFixed=function(ie,te){var ee=this,ne=ee.c[0];if(ie!==UNDEFINED){if(ie!==~~ie||ie<0||ie>MAX_DP)throw Error(INVALID_DP);for(ee=round(new ee.constructor(ee),ie+ee.e+1,te),ie=ie+ee.e+1;ee.c.length<ie;)ee.c.push(0)}return stringify(ee,!1,!!ne)};P.toJSON=P.toString=function(){var ie=this,te=ie.constructor;return stringify(ie,ie.e<=te.NE||ie.e>=te.PE,!!ie.c[0])};typeof Symbol<"u"&&(P[Symbol.for("nodejs.util.inspect.custom")]=P.toJSON);P.toNumber=function(){var ie=+stringify(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(ie.toString()))throw Error(NAME+"Imprecise conversion");return ie};P.toPrecision=function(ie,te){var ee=this,ne=ee.constructor,re=ee.c[0];if(ie!==UNDEFINED){if(ie!==~~ie||ie<1||ie>MAX_DP)throw Error(INVALID+"precision");for(ee=round(new ne(ee),ie,te);ee.c.length<ie;)ee.c.push(0)}return stringify(ee,ie<=ee.e||ee.e<=ne.NE||ee.e>=ne.PE,!!re)};P.valueOf=function(){var ie=this,te=ie.constructor;if(te.strict===!0)throw Error(NAME+"valueOf disallowed");return stringify(ie,ie.e<=te.NE||ie.e>=te.PE,!0)};var Big=_Big_();function formatNumber(ie,te,ee,ne,re){if(!Number.isFinite(ie))return`${ie}`;const se=Math.sign(ie)===-1?"-":"";ie=Math.abs(ie);let ae=ee===void 0?ie.toString():ie.toFixed(ee);if(ae.includes("e"))if(ne){const Ae=new Big(ie);ae=Ae.lt(1)?Ae.toFixed():Ae.toString()}else return`${se}${ae.replace(".",te.decimalSign)}`;const le=ae.split("."),ce=le[0];let he=le[1];const fe=groupByThousand(ce,te.groupingSeparator);return ee!==void 0&&(he=ee===0?void 0:ie.toFixed(ee).slice(-ee)),re!==void 0&&he!==void 0&&(he=stripEndingZeros(he,re)),he?`${se}${fe}${te.decimalSign}${he}`:`${se}${fe}`}function groupByThousand(ie,te){let ee=ie.length;const ne=[];for(;ee>0;){const re=Math.max(0,ee-3);ne.unshift(ie.slice(re,ee)),ee-=3}return ne.join(te)}function stripEndingZeros(ie,te){let ee=ie.length-1;for(let ne=ee;ne>=te&&ie[ne]==="0";ne--)ee--;return ie.slice(0,ee+1)}function parseNumber(ie,te){if(/^(NaN|[+-]?Infinity)$/.test(ie))return parseFloat(ie);ie=stripLTRMarks(ie);const ee=new RegExp(escapeRegExp(te.groupingSeparator),"g");return ee&&(ie=ie.replace(ee,"")),ie=ie.replace(te.decimalSign,"."),/^(\+|-)?\d+(?:\.\d+)?(?:e[+-]?\d+)?$/.test(ie)?parseFloat(ie):NaN}class NumericFormatter{constructor(te={}){Ee(this,"_options");this._options=te}format(te,ee){if(!Number.isFinite(te))return String(te);const{ignoreLocaleNumberFormat:ne,precision:re,minPrecision:se}=this._options,ae=getNumberFormat(ne||(ee==null?void 0:ee.ignoreLocaleNumberFormat));return re===void 0?NumericFormatter._formatNoEImpl(te,ae,void 0,se):formatNumber(te,ae,re,!1,se)}parse(te,ee){const{ignoreLocaleNumberFormat:ne,precision:re}=this._options,se=getNumberFormat(ne||(ee==null?void 0:ee.ignoreLocaleNumberFormat)),ae=parseNumber(te,se);return Number.isFinite(ae)?re!==void 0?{res:!0,value:+ae.toFixed(re)}:{res:!0,value:ae}:{res:!1}}static formatNoE(te,ee){return this._formatNoEImpl(te,ee)}static _formatNoEImpl(te,ee,ne,re){return Number.isFinite(te)?formatNumber(te,ee??{groupingSeparator:"",decimalSign:"."},ne,!0,re):String(te)}}function normalizeMinTick(ie){const te=new Big(ie).toFixed().split(".")[1]||"",ee=Math.pow(10,te.length),ne=new Big(ie).mul(ee).toNumber();return{priceScale:ee,minMove:ne}}function parseVariableMinTickConfig(ie,te){var ne,re;const ee=[{minTick:isFiniteNumber(ie)?normalizeMinTick(ie):ie,price:1/0,maxIndex:1/0}];try{const se=te.split(" ").map((le,ce)=>{if(isEven(ce))return parseMinTickToken(le);{const he=Number(le);if(Number.isNaN(he))throw new Error(`Unexpected price limit: ${le}`);return he}});if(isEven(se.length))throw new Error("Theme must not have even number of elements");const ae=[];for(let le=0;le<se.length;le+=2){const ce=se[le],he=se[le+1]??1/0,fe=((ne=ae[ae.length-1])==null?void 0:ne.price)??0,Ae=((re=ae[ae.length-1])==null?void 0:re.maxIndex)??0,pe=getNumericTickValue(ce),Oe=he===1/0?1/0:new Big(he).minus(fe).div(pe).plus(Ae).toNumber();ae.push({minTick:ce,price:he,maxIndex:Oe})}return ae}catch{return ee}}function parseMinTickToken(ie){const te=Number(ie);if(Number.isFinite(te))return normalizeMinTick(te);const ee=ie.split("/");if(ee.length<2||ee.length>3)throw new Error(`Unexpected mintick: ${ie}`);const[ne,re,se]=ee,ae=Number(re),le=Number(ne),ce=se!==void 0?Number(se):void 0;if(!Number.isFinite(ae)||!Number.isFinite(le))throw new Error(`Invalid fractional minTick: ${ie}`);if(se!==void 0&&!Number.isFinite(ce))throw new Error(`Invalid minMove2 in minTick: ${ie}`);return{priceScale:ae,minMove:le,...ce!==void 0?{minMove2:ce}:{}}}function getNumericTickValue(ie){return typeof ie=="number"?ie:ie.minMove/ie.priceScale}class DecimalFormatter{constructor(te){Ee(this,"_priceScale");Ee(this,"_minMove");Ee(this,"_minMove2");Ee(this,"_ignoreMinMove");Ee(this,"_fractionalLength");Ee(this,"_variableMinTickData");Ee(this,"_formatterErrors",{custom:"custom_format_error",fraction:"fraction_format_error",secondFraction:"secondary_fraction_error"});const{priceScale:ee,minMove:ne,minMove2:re,ignoreMinMove:se,variableMinTick:ae,fractionalLength:le}=te;this._priceScale=ee,this._minMove=ne,this._minMove2=re,this._ignoreMinMove=se,this._fractionalLength=le,ae!==void 0&&(this._variableMinTickData=parseVariableMinTickConfig({priceScale:ee,minMove:ne,minMove2:re},ae))}formatImpl(te,ee={}){const{signPositive:ne,signNegative:re=!0,tailSize:se,cutFractionalByPrecision:ae=!1,useRtlFormat:le=!0,variableMinTickDataPrice:ce,ignoreLocaleNumberFormat:he,removeAllEndingZeros:fe}=ee;let Ae="";te<0?Ae=re===!1?"":"−":te!==0&&ne===!0&&(Ae="+");const pe=Math.abs(te),Oe=this._formatUnsigned(pe,se,ae,ce,he,fe);return le?forceLTRStr(Ae+Oe):Ae+Oe}parse(te,ee){let ne=stripLTRMarks(te);return ne=ne.replace("−","-"),ne.startsWith("+")&&(ne=ne.substring(1)),this._parseUnsigned(ne)}_removeEndingZeros(te,ee){let ne=te;for(let re=0;re<ee&&ne.endsWith("0");re++)ne=ne.slice(0,-1);return ne}_formatUnsigned(te,ee,ne,re,se,ae){let le=te.toFixed(2);return ae&&(le=this._removeEndingZeros(le,5)),le}_parseUnsigned(te){return parseFloat(te)}hasForexAdditionalPrecision(){return!1}}function getMatchingTickRule(ie){const{minTick:te,price:ee,variableMinTickData:ne,shouldCheckForEquality:re}=ie;return ne===void 0?isFiniteNumber(te)?normalizeMinTick(te):te:findTickFromData(ee,ne,re)}function findTickFromData(ie,te,ee=!1){for(let ne=0;ne<te.length;ne++){const re=te[ne];if(ie<re.price||ee&&ie===re.price)return re.minTick}return te[te.length-1].minTick}function calculateFractionalLength(ie,te,ee,ne){let re=0;if(ie>0&&te>0){let se=ie;for(ee&&ne!==void 0&&(se=ie/ne);se>1;)se/=10,re++}return re}function getTickFormatByPrice(ie,te,ee){const ne=ensure(getMatchingTickRule({price:ee,minTick:null,variableMinTickData:te,shouldCheckForEquality:!0})),{priceScale:re,minMove:se,minMove2:ae}=ne;return{priceScale:re,minMove:se,fractionalLength:calculateFractionalLength(re,se,ie,ae)}}class DecimalPriceFormatter extends DecimalFormatter{constructor(ee){super(ee);Ee(this,"_ignoreLocaleNumberFormat");const{minMove2:ne,ignoreLocaleNumberFormat:re}=ee;this._ignoreLocaleNumberFormat=re}hasForexAdditionalPrecision(){return this._minMove2===10}_parseUnsigned(ee,ne){return this._parseAsDecimal(ee,ne)}_formatUnsigned(ee,ne,re,se,ae,le){const ce={price:Math.abs(ee),priceScale:this._priceScale,minMove:this._minMove,fractionalLength:this._fractionalLength,tailSize:ne,cutFractionalByPrecision:re,ignoreLocaleNumberFormat:ae,removeAllEndingZeros:le};if(this._variableMinTickData!==void 0){const he=getTickFormatByPrice(!1,this._variableMinTickData,se??ce.price);Object.assign(ce,he),this._ignoreMinMove&&(ce.minMove=1)}return this._formatAsDecimal(ce)}_formatAsExponential(ee,ne){const re=Math.floor(.75*Math.log10(this._priceScale)),se=ee*Math.pow(10,re),ae=`e-${re}`,le=Math.log10(this._priceScale)-re;return`${se.toFixed(le).replace(".",ne.decimalSign)}${ae}`}_formatAsDecimal(ee){const{price:ne,priceScale:re,minMove:se,fractionalLength:ae=0,tailSize:le=0,cutFractionalByPrecision:ce,ignoreLocaleNumberFormat:he,removeAllEndingZeros:fe}=ee,Ae=getNumberFormat(this._ignoreLocaleNumberFormat||he);if(ne>=1e21)return ne.toString().replace(".",Ae.decimalSign);if(re>1e15)return this._formatAsExponential(ne,Ae);const pe=Math.pow(10,le)*re/(ce?1:se),Oe=1/pe;let Fe;if(pe>1)Fe=Math.floor(ne);else{const ze=Math.floor(Math.round(ne/Oe)*Oe);Fe=Math.round((ne-ze)/Oe)===0?ze:ze+Oe}let Ne="";if(pe>1){let ze;if(ce)ze=new Big(ne).times(pe).round().minus(new Big(Fe).times(pe)).toNumber();else{const je=Math.round(ne*pe)-Fe*pe;ze=parseFloat(je.toFixed(ae))}ze>=pe&&(ze-=pe,Fe+=1),ce?ze=new Big(ze).round(ae).toNumber():ze*=se;const He=numberToStringWithLeadingZero(ze,ae+le),We=this._removeEndingZeros(He,fe?He.length:le);Ne=We?Ae.decimalSign+We:""}return formatNumber(Fe,Ae)+Ne}_parseAsDecimal(ee,ne={}){const{ignoreLocaleNumberFormat:re}=ne,se=getNumberFormat(this._ignoreLocaleNumberFormat||re),ae=parseNumber(ee,se);return Number.isFinite(ae)?{value:ae,res:!0,suggest:this.formatImpl(ae)}:{error:this._formatterErrors.custom,res:!1}}}const SINGLE_FRACTION_PATTERN=/^\d+([.,]\d+)?$/;class FractionalPriceFormatter extends DecimalFormatter{constructor(te){super(te);const{minMove2:ee}=te;ee!=null&&ee>0&&ee!==2&&ee!==4&&ee!==8&&console.warn("invalid minmove2")}hasForexAdditionalPrecision(){return!1}_parseUnsigned(te){return this._minMove2?this._parseAsDoubleFractional(te):this._parseAsSingleFractional(te)}_formatUnsigned(te,ee,ne,re){const se={price:Math.abs(te),priceScale:this._priceScale,minMove:this._minMove,minMove2:this._minMove2,fractionalLength:ensure(this._fractionalLength),tailSize:ee};return this._variableMinTickData!==void 0&&Object.assign(se,getTickFormatByPrice(!0,this._variableMinTickData,re??se.price)),this._formatAsFractional(se)}_parseAsSingleFractional(te){if(SINGLE_FRACTION_PATTERN.test(te)){const re=parseFloat(te);return{value:re,res:!0,suggest:this.formatImpl(re)}}const ne=new RegExp(`^(-?)(\\d+)\\${formatterOptions.decimalSignFractional}(\\d+)$`).exec(te);if(ne){const re=!!ne[1],se=parseInt(ne[2]),ae=parseInt(ne[3]),le=this._priceScale,ce=this._patchFractPart(ae,1,le);if(ce>=le||ce<0)return{error:this._formatterErrors.fraction,res:!1};let he=se+ce/le;return re&&(he=-he),{value:he,res:!0,suggest:this.formatImpl(he)}}return{error:this._formatterErrors.custom,res:!1}}_parseAsDoubleFractional(te){if(SINGLE_FRACTION_PATTERN.test(te)){const re=parseFloat(te);return{value:re,res:!0,suggest:this.formatImpl(re)}}const ne=new RegExp(`^(-?)(\\d+)\\${formatterOptions.decimalSignFractional}(\\d+)\\${formatterOptions.decimalSignFractional}(\\d+)$`).exec(te);if(ne){const re=!!ne[1],se=parseInt(ne[2]),ae=parseInt(ne[3]),le=parseInt(ne[4]),ce=this._minMove2,he=this._priceScale/ce,fe=this._patchFractPart(ae,1,he),Ae=this._patchFractPart(le,2,ce);if(fe>=he||fe<0)return{error:this._formatterErrors.fraction,res:!1};if(Ae>=ce||Ae<0)return{error:this._formatterErrors.secondFraction,res:!1};let pe=se+fe/he+Ae/(he*ce);return re&&(pe=-pe),{value:pe,res:!0,suggest:this.formatImpl(pe)}}return{error:this._formatterErrors.custom,res:!1}}_formatAsFractional(te){const{price:ee,tailSize:ne,priceScale:re,minMove:se,minMove2:ae,fractionalLength:le}=te,ce=re/se;let he=Math.floor(ee),fe=ne?Math.floor(ee*ce)-he*ce:Math.round(ee*ce)-he*ce;fe===ce&&(he+=1,fe=0);let Ae="";if(ne){let Oe=(ee-he-fe/ce)*ce;Oe=Math.round(Oe*10**ne),Ae=numberToStringWithLeadingZero(Oe,ne),Ae=this._removeEndingZeros(Ae,ne)}if(le==null)throw new Error("_fractionalLength is not calculated");let pe="";if(ae){const Oe=fe%ae;fe=(fe-Oe)/ae;const Fe=numberToStringWithLeadingZero(fe,le),Ne=this._getFractPart(Oe,2,ae);pe=Fe+formatterOptions.decimalSignFractional+Ne}else{const Oe=this._getFractPart(fe,1,re);pe=numberToStringWithLeadingZero(Oe*se,le)}return he.toString()+formatterOptions.decimalSignFractional+pe+Ae}_patchFractPart(te,ee,ne){const re={0:0,5:1},se={0:0,2:1,5:2,7:3},ae={0:0,1:1,2:2,3:3,5:4,6:5,7:6,8:7};return ne===2?Reflect.get(re,te)??-1:ne===4?Reflect.get(se,te)??-1:ne===8&&ee===2?Reflect.get(ae,te)??-1:te}_getFractPart(te,ee,ne){const re=[0,5],se=[0,2,5,7],ae=[0,1,2,3,5,6,7,8];return ne===2?re[te]??-1:ne===4?se[te]??-1:ne===8&&ee===2?ae[te]??-1:te}}class PriceFormatter{constructor(te={}){Ee(this,"type","price");Ee(this,"_priceScale");Ee(this,"_minMove");Ee(this,"_minMove2");Ee(this,"_fractional");Ee(this,"_variableMinTick");Ee(this,"_ignoreMinMove");Ee(this,"_fractionalLength");Ee(this,"_ignoreLocaleNumberFormat");Ee(this,"_implementation");const{minMove2:ee,fractional:ne,variableMinTick:re,ignoreMinMove:se,ignoreLocaleNumberFormat:ae}=te,le=!te.minMove||se?1:te.minMove,ce=isFiniteNumber(te.priceScale)&&isInteger(te.priceScale)?te.priceScale:100;if(ce<0)throw new TypeError("Invalid priceScale base");const he=calculateFractionalLength(ce,le,ne,ee),fe={...te,minMove:le,priceScale:ce,fractionalLength:he};this._priceScale=ce,this._minMove=le,this._minMove2=ee,this._fractional=ne,this._variableMinTick=re,this._ignoreMinMove=se,this._ignoreLocaleNumberFormat=ae,this._fractionalLength=he,this._implementation=ne?new FractionalPriceFormatter(fe):new DecimalPriceFormatter(fe)}isFractional(){return!!this._fractional}state(){return{minMove:this._minMove,minMove2:this._minMove2,priceScale:this._priceScale,variableMinTick:this._variableMinTick,ignoreMinMove:this._ignoreMinMove,fractional:this._fractional}}formatChange(te,ee,ne={}){return this._implementation.formatImpl(ee-te,{...ne,variableMinTickDataPrice:Math.min(Math.abs(te),Math.abs(ee))})}format(te,ee){return this._implementation.formatImpl(te,ee)}parse(te,ee){return this._implementation.parse(te,ee)}hasForexAdditionalPrecision(){return this._implementation.hasForexAdditionalPrecision()}static serialize(te){return te.state()}static deserialize(te){return new PriceFormatter(te)}}class PercentageFormatter extends PriceFormatter{constructor(ee={}){ee.decimalPlaces!==void 0&&(ee.priceScale=Math.pow(10,ee.decimalPlaces));super(ee);Ee(this,"type","percentage")}state(){return{...super.state(),percent:!0}}parse(ee,ne){const re=ee.replace("%","");return super.parse(re,ne)}format(ee,ne={}){const{useRtlFormat:re=!0}=ne,se=super.format(ee,{...ne,useRtlFormat:!1})+"%";return re?forceLTRStr(se):se}static serialize(ee){return ee.state()}static deserialize(ee){return new PercentageFormatter(ee)}}class PipPriceFormatter extends PriceFormatter{constructor(ee){var te=(...i4)=>(super(...i4),Ee(this,"_isForex"),Ee(this,"_pipPriceScale"),Ee(this,"_pipMinMove"),Ee(this,"_pipMinMove2"),this);const{priceScale:ne,minMove:re=1,minMove2:se,type:ae,typespecs:le,ignoreLocaleNumberFormat:ce}=ee;(ae==="forex"||(Ae=>!!(le!=null&&le.includes("cfd"))&&["commodity","futures","index","stock","fund"].includes(Ae))(ae))&&se?(te({priceScale:se,ignoreLocaleNumberFormat:ce}),this._isForex=!0):(te({priceScale:1,ignoreLocaleNumberFormat:ce}),this._isForex=!1),this._pipPriceScale=ne,this._pipMinMove=re,this._pipMinMove2=se}format(ee,ne={}){const re=this._isForex?this._pipMinMove2:this._pipMinMove,se=this._pipPriceScale/(re??NaN);return super.format(ee*se,ne)}}const getNumericFormatter=numDependencyFormatter(ie=>new NumericFormatter({precision:ie})),getPercentageFormatter=numDependencyFormatter(ie=>new PercentageFormatter({priceScale:Math.pow(10,ie??2),minMove:1})),pipFormatterCache=new WeakMap;function getPipFormatter(ie){let te=pipFormatterCache.get(ie);return te||(te=new PipPriceFormatter({priceScale:ie.pricescale,minMove:ie.minmov,minMove2:ie.minmove2,type:ie.type,typespecs:ie.typespecs}),pipFormatterCache.set(ie,te)),te}class CallbackHitTestObject{constructor(te){Ee(this,"componentId",0);this.cb=te}hitTest(te,ee){return this.cb(te,ee)}}class CompositeRenderer{constructor(te){Ee(this,"_renderers",[]);Ee(this,"_globalAlpha",1);this._hitTestCollector=te}insert(te,ee){this._renderers.splice(ee,0,te)}append(...te){this._renderers.push(...te)}clear(){this._renderers.length=0}setGlobalAlpha(te){this._globalAlpha=te}hitTest(te,ee){var ne;for(const re of this._renderers){const se=(ne=re.hitTest)==null?void 0:ne.call(re,te,ee);if(se)return se}return null}draw(te){te.useBitmapCoordinateSpace(ee=>{const ne=ee.context;ne.save(),ne.globalAlpha=this._globalAlpha,this._renderers.map(re=>{var se;re.draw(te),re.hitTest&&((se=this._hitTestCollector)==null||se.call(this,new CallbackHitTestObject((ae,le)=>{var ce;return((ce=re.hitTest)==null?void 0:ce.call(re,ae,le))??null})))}),ne.restore()})}}class ViewBoxTransform{constructor(te){Ee(this,"_originalViewBox");this._originalViewBox=te}apply(te,ee){const ne=ee.targetViewBox;te.translate(ne.x,ne.y),te.scale(ne.width/this._originalViewBox.width,ne.height/this._originalViewBox.height),te.beginPath(),te.rect(0,0,this._originalViewBox.width,this._originalViewBox.height),te.clip(),te.translate(-this._originalViewBox.x,-this._originalViewBox.y)}}class SvgTransformApplier{constructor(te){Ee(this,"_transformOperations");this._transformOperations=te}apply(te){this._transformOperations!==null?(te.save(),applyTransform(te,this._transformOperations)):te.restore()}}function getFloatAttribute(ie,te){const ee=ie.getAttribute(te);return parseFloat(ee??"")}function parseLinearGradient(ie){const te=ie.getAttribute("gradientUnits");if(te==="objectBoundingBox"){console.warn(`Unsupported linearGradient gradientUnits: ${te}`);return}const ee=[],ne=ie.getElementsByTagName("stop");for(let ce=0;ce<ne.length;++ce){const he=ne[ce],fe=getFloatAttribute(he,"offset"),Ae=he.getAttribute("stop-color");Ae!==null&&ee.push([Number.isFinite(fe)?fe:0,Ae])}const re=getFloatAttribute(ie,"x1"),se=getFloatAttribute(ie,"y1"),ae=getFloatAttribute(ie,"x2"),le=getFloatAttribute(ie,"y2");return ce=>{const he=ce.createLinearGradient(re,se,ae,le);for(const fe of ee)he.addColorStop(fe[0],fe[1]);return he}}function parseDefs(ie){const te={},ee=ie.children;for(let re=0;re<ee.length;++re){const se=ee[re],ae=se.getAttribute("id");ae&&(se.tagName==="linearGradient"?te[ae]=ensure(parseLinearGradient(se)):console.warn(`Unsupported defs tag: ${se.tagName}`))}const ne=new WeakMap;return{getStyle:(re,se)=>{const ae=te[re];if(!ae)return;let le=ne.get(se);if(le===void 0&&(le=new Map,ne.set(se,le)),le.has(re))return le.get(re);const ce=ae(se);return le.set(re,ce),ce}}}function parseNumericArgs(ie,te){const ee=ie.split(/[,\s]+/g).map(re=>parseFloat(re.trim()));let ne=0;for(const re of ee){if(!Number.isFinite(re)&&ne<te)return null;ne+=1}return ee}function parseSvgNode(ie,te,ee,ne=Object.create(null)){const re=ie.children;let se,ae=ne;if(ie.tagName==="g"||ie.tagName==="svg"){ae={...ne,...parseStyleAttributes(ie,ee,!1)};const le=parseTransform(ie);le&&(se=le,te.push(new SvgTransformApplier(se)))}for(let le=0;le<re.length;++le){const ce=re[le];ce.tagName!=="defs"&&parseSvgNode(ce,te,ee,ae)}switch(ie.tagName){case"g":case"svg":case"defs":break;case"path":te.push(new SvgPath(ie,ee,ne));break;case"circle":te.push(new SvgCircle(ie,ee,ne));break;case"ellipse":te.push(new SvgEllipse(ie,ee,ne));break;default:console.warn(`Unsupported tag name: ${ie.tagName}`);break}}const transformRegex=/([a-zA-Z]+)\((.*)\)/g;function parseTransform(ie){var re;const te=(re=ie.getAttribute("transform"))==null?void 0:re.toLowerCase();if(te===void 0)return null;const ee=[];let ne;transformRegex.lastIndex=0;do if(ne=transformRegex.exec(te),ne!==null){const se=ne[1],ae=ne[2];switch(se){case"matrix":{const le=parseNumericArgs(ae,6);le!==null&&ee.push({type:"matrix",a:le[0],b:le[1],c:le[2],d:le[3],e:le[4],f:le[5]});break}case"rotate":{const le=parseNumericArgs(ae,1);le!==null&&ee.push({type:"rotate",a:le[0],x:le[1],y:le[2]});break}case"translate":{const le=parseNumericArgs(ae,1);le!==null&&ee.push({type:"translate",x:le[0],y:le[1]});break}case"scale":{const le=parseNumericArgs(ae,1);le!==null&&ee.push({type:"scale",x:le[0],y:le[1]});break}default:console.warn(`Unsupported transform operation: ${se}`)}}while(ne!==null);return ee.length===0?null:ee}function parseStyleAttributes(ie,te,ee){const ne=Object.create(null),re=ie.getAttribute("fill");if(re!==null){const fe=extractUrlId(re);ne.getFillStyle=fe!==null?Ae=>ensure(te.getStyle(fe,Ae)):()=>re}const se=ie.getAttribute("stroke");if(se!==null){const fe=extractUrlId(se);ne.getStrokeStyle=fe!==null?Ae=>ensure(te.getStyle(fe,Ae)):()=>se}const ae=getFloatAttribute(ie,"stroke-width");Number.isFinite(ae)&&(ne.strokeWidth=ae);const le=getFloatAttribute(ie,"opacity");Number.isFinite(le)&&(ne.fillOpacity=le,ne.strokeOpacity=le);const ce=getFloatAttribute(ie,"stroke-opacity");Number.isFinite(ce)&&(ne.strokeOpacity=ce);const he=getFloatAttribute(ie,"fill-opacity");if(Number.isFinite(he)&&(ne.fillOpacity=he),ee){const fe=parseTransform(ie);fe!==null&&(ne.transform=fe)}return ne}function extractUrlId(ie){const te=/^url\(#(.*)\)$/.exec(ie);return(te==null?void 0:te[1])??null}class SvgRenderable{constructor(te,ee,ne){Ee(this,"_styleData");this._styleData={...ne,...parseStyleAttributes(te,ee,!0)}}apply(te,ee){if(!this._isValid())return;const{getFillStyle:ne,getStrokeStyle:re,strokeWidth:se,transform:ae,strokeOpacity:le,fillOpacity:ce}=this._styleData,he=ae!==void 0||le!==void 0||ce!==void 0;he&&(te.save(),ae!==void 0&&applyTransform(te,ae)),this._render(te);const fe=ne==null?void 0:ne(te);fe!=="none"&&(ee.doNotApplyColors||(ce!==void 0&&(te.globalAlpha=ce),te.fillStyle=fe??"black"),this._fill(te));const Ae=re==null?void 0:re(te);Ae!==void 0&&Ae!=="none"&&(se!==void 0&&(te.lineWidth=se),ee.doNotApplyColors||(ce!==void 0&&(te.globalAlpha=ce),te.strokeStyle=Ae),this._stroke(te)),he&&te.restore()}_fill(te){te.fill()}_stroke(te){te.stroke()}_isValid(){return!0}}class SvgPath extends SvgRenderable{constructor(ee,ne,re){super(ee,ne,re);Ee(this,"_path");Ee(this,"_fillRule");const se=ee.getAttribute("d");this._path=se!==null?new Path2D(se):null;const ae=ee.getAttribute("fill-rule");this._fillRule=ae!==null?ae:void 0}_render(){}_fill(ee){ee.fill(ensure(this._path),this._fillRule)}_stroke(ee){ee.stroke(ensure(this._path))}_isValid(){return this._path!==null}}class SvgCircle extends SvgRenderable{constructor(ee,ne,re){super(ee,ne,re);Ee(this,"_cx");Ee(this,"_cy");Ee(this,"_r");this._cx=getFloatAttribute(ee,"cx"),this._cy=getFloatAttribute(ee,"cy"),this._r=getFloatAttribute(ee,"r")}_render(ee){ee.beginPath(),ee.arc(this._cx,this._cy,this._r,0,2*Math.PI)}_isValid(){return Number.isFinite(this._cx)&&Number.isFinite(this._cy)&&Number.isFinite(this._r)}}class SvgEllipse extends SvgRenderable{constructor(ee,ne,re){super(ee,ne,re);Ee(this,"_cx");Ee(this,"_cy");Ee(this,"_rx");Ee(this,"_ry");this._cx=getFloatAttribute(ee,"cx"),this._cy=getFloatAttribute(ee,"cy"),this._rx=getFloatAttribute(ee,"rx"),this._ry=getFloatAttribute(ee,"ry")}_render(ee){ee.beginPath(),ee.ellipse(this._cx,this._cy,this._rx,this._ry,0,0,2*Math.PI)}_isValid(){return Number.isFinite(this._cx)&&Number.isFinite(this._cy)&&Number.isFinite(this._rx)&&Number.isFinite(this._ry)}}function applyTransform(ie,te){for(const ee of te)switch(ee.type){case"matrix":ie.transform(ee.a,ee.b,ee.c,ee.d,ee.e,ee.f);break;case"rotate":ee.x!==void 0&&ee.y!==void 0&&ie.translate(ee.x,ee.y),ie.rotate(ee.a*Math.PI/180),ee.x!==void 0&&ee.y!==void 0&&ie.translate(-ee.x,-ee.y);break;case"scale":ie.scale(ee.x,ee.y!==void 0?ee.y:ee.x);break;case"translate":ie.translate(ee.x,ee.y!==void 0?ee.y:0);break;default:NOTREACHED()}}let domParser;function svgRenderer(ie){const te=(domParser||(domParser=new DOMParser)).parseFromString(ie,"application/xml"),ee=[],ne=te.getElementsByTagName("svg")[0],re=ensure(ne.getAttribute("viewBox")).split(" ").map(parseFloat),se={x:re[0],y:re[1],width:re[2],height:re[3]};ee.push(new ViewBoxTransform(se));let ae={getStyle:()=>""};const le=ne.getElementsByTagName("defs");return le.length>0&&(ae=parseDefs(le[0])),parseSvgNode(ne,ee,ae),{viewBox:()=>se,render:(ce,he)=>{ce.save();for(const fe of ee)fe.apply(ce,he);ce.restore()}}}const AnchorStyleConsts={RegularAnchorRadius:6,RegularStrokeWidth:1,RegularSelectedStrokeWidth:3},AnchorColor="#2A62FF";function anchorColor(){return AnchorColor}class ToolPaneView{constructor(te,ee){Ee(this,"_lineAnchorRenderers",[]);Ee(this,"_data",Object.create(null));this._source=te,this._model=ee}get _hitTestCollector(){return this._source.hitTestCollector}zOrder(){return this._model.currentCreating==this._source||this._model.currentActive===this._source||this._model.currentHovered===this._source?"normal":"under"}points(){return this._data.points}update(te){this._data=te,this._updateImpl()}addAnchors(te){let ee=this.points();this._model.currentCreating===this._source&&(ee=ee.slice(0,ensure(this._model.pointCreating)+1)),te.append(this.createLineAnchor({points:ee},0))}_anchorRadius(){return AnchorStyleConsts.RegularAnchorRadius}isHoveredSource(){return this._model.currentHovered===this._source}isSelectedSource(){return this._model.isSelected(this._source)}areAnchorsVisible(){return this.isHoveredSource()||this.isSelectedSource()}_lineAnchorColors(te){const ee=this._source.series.getPane().getHeight();return te.map(ne=>this._model.backgroundColorAtYPercentFromTop(ne.y/ee))}createLineAnchor(te,ee=0){const{points:ne}=te,re=this._getLineAnchorRenderer(ee);return re.setData({points:ne,color:anchorColor(),backgroundColors:this._lineAnchorColors(ne),currentPoint:this._model.currentPoint,radius:AnchorStyleConsts.RegularAnchorRadius,strokeWidth:AnchorStyleConsts.RegularStrokeWidth,selected:this.isSelectedSource(),selectedStrokeWidth:AnchorStyleConsts.RegularSelectedStrokeWidth,visible:this.areAnchorsVisible(),linePointBeingEdited:this._model.currentEditing===this._source?this._model.pointEditing:null}),re}_getLineAnchorRenderer(te){for(;this._lineAnchorRenderers.length<=te;)this._lineAnchorRenderers.push(new LineAnchorRenderer);return this._lineAnchorRenderers[te]}}var TextMode=(ie=>(ie[ie.Preview=0]="Preview",ie[ie.Edit=1]="Edit",ie))(TextMode||{});class BaseTextPaneView extends ToolPaneView{constructor(ee,ne,re){super(ee,ne);Ee(this,"_creatingFinished",!1);Ee(this,"_mode",1);Ee(this,"_textWasEdited",!1);Ee(this,"_textEditor",null);this._editingHelper=re}isCreationFinished(){return this._creatingFinished}startTextEditing(){this._mode=1,this._textWasEdited=!1}_isTextEditMode(){return this._mode===1}_placeHolderMode(ee=!1){var he;const ne=!this._isTextEditMode(),re=this._model.currentHovered===this._source,se=!ee||((he=this._model.lastHittestData())==null?void 0:he.areaName)!==AreaName.AnchorPoint,ae=!0,le=!this._textValue(),ce=this._model.isSelected(this._source);return ne&&re&&se&&ae&&le&&ce}_textValue(){return this._source.properties().text}_textDisplay(){const{text:ee,placeholder:ne}=this._source.properties();return ee||(this._textWasEdited?"​":ne)}_textDisplayColor(){const ee=this._textColor();return this._textValue()?ee:getLightenRGBA(ee,.5)}_textColor(){return this._source.properties().textColor}_textCursorType(){return this.isSelectedSource()?PaneCursor.text:PaneCursor.unset}_updateEditor(ee){var ne;!this._textEditor&&this._isTextEditMode()?this._activateEditMode(ee):(ne=this._textEditor)==null||ne.update({textInfo:ee})}_activateEditMode(ee){if(this._textEditor)return;const{textColor:ne,text:re,placeholder:se,wordWrap:ae}=this._source.properties();this._textEditor=this._editingHelper.showTextEditor({text:re,placeholder:se,textColor:ne,multiLine:ae,textInfo:ee,onExit:()=>{this._deactiveEditMode(),this._textValue()?this._editingHelper.accept():this._editingHelper.abort()},onInput:le=>{this._source.updateProps({text:le})}})}_deactiveEditMode(){this._creatingFinished||(this._creatingFinished=!0),ensure(this._textEditor).dispose(),this._mode=0,this._textWasEdited=!0,this._textEditor=null}closeTextEditor(){this._deactiveEditMode()}}const angleIcon=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M8.55 2.78 2.7 15H15v-1h-4.01a6.2 6.2 0 0 0-1.36-3.95 7.94 7.94 0 0 0-2.57-1.83l2.4-5-.91-.44ZM6.63 9.12 4.29 14H10a5.18 5.18 0 0 0-1.12-3.3 6.93 6.93 0 0 0-2.24-1.58Z"/></svg>
`,priceIcon=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M3 2h11v1H3V2Zm5.5 1.8.35.35 2 2 .36.35-.71.7-.35-.35L9 5.71v6.58l1.15-1.14.35-.36.7.71-.35.35-2 2-.35.36-.35-.36-2-2-.36-.35.71-.7.35.35L8 12.29V5.71L6.85 6.85l-.35.36-.7-.71.35-.35 2-2 .35-.36ZM3.5 16H3v-1h11v1H3.5Z"/></svg>
`,timeIcon=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M2 3v2H1v9h1v2h1v-2h1V5H3V3H2Zm6.2 4.5-.35.35L6.71 9h4.58l-1.14-1.15-.36-.35.71-.7.35.35 2 2 .36.35-.36.35-2 2-.35.36-.7-.71.35-.35L11.29 10H6.71l1.14 1.15.36.35-.71.7-.35-.35-2-2-.36-.35.36-.35 2-2 .35-.36.7.71ZM3 6H2v7h1V6Zm12-2.5V3h1v2h1v9h-1v2h-1v-2h-1V5h1V3.5ZM15 6h1v7h-1V6Z"/></svg>
`,Offset=18,iconStrokeLight="#F9F9F9",iconsStrokeDark="#303030";let _tempCtx=null,_iconRenderer=null;function getIconRenderer(){return _iconRenderer||(_iconRenderer={angle:svgRenderer(angleIcon),priceRange:svgRenderer(priceIcon),barsRange:svgRenderer(timeIcon)}),_iconRenderer}class StatsRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_hitTest",new HitTestResult(HitTarget.MovePoint));Ee(this,"_preRenderedData",null);Ee(this,"_textWidthCache",new et)}setData(ee){super.setData(ee),this._preRenderedData=null}updatePoint(ee){this._data&&(this._data.point=ee)}drawImpl(ee){const ne=ee.context;if(!this._data||this._data.text===null)return;const re=this._preRender();if(!re)return;const{horizontalPixelRatio:se,verticalPixelRatio:ae}=ee,{point:le,horzAlign:ce,doNotAlignText:he,backgroundRoundRect:fe,backgroundColor:Ae,color:pe,lineSpacing:Oe,icons:Fe,isDark:Ne}=this._data,{font:ze,lineHeight:He,lines:We,padding:je,rectSize:Ue,textPointOffset:Ge}=re,Ze=Math.round(le.x*se),Ye=Math.round(le.y*ae),qe=Math.round(Ue.width*se),nr=Math.round(Ue.height*ae);if((ce===HorizontalAlign.Right||ce===HorizontalAlign.Center)&&(he||(ne.textAlign=ce===HorizontalAlign.Right?"end":"center")),fe?(drawRoundRect(ne,Ze,Ye,qe,nr,fe*se),ne.fillStyle=Ae,ne.fill(),ne.globalAlpha=1):(ne.fillStyle=Ae,ne.fillRect(Ze,Ye,qe,nr),ne.globalAlpha=1),Fe){const Jt=Math.max(0,(He-Offset)/2),rr=Math.round((le.x+je.left)*se);let lr=le.y+je.top+Jt;for(const ur of Fe){const Sr=Math.round(lr*ae);this._drawIcon(ne,rr,Sr,getIconRenderer()[ur],!!Ne,ee),lr+=He+Oe}}const ir=le.x+Ge.x;let tr=le.y+Ge.y;ne.fillStyle=pe,ne.textBaseline="middle",ne.font=ze;const or=Math.round(He/2);drawScaled(ne,se,ae,()=>{for(const Jt of We)ne.fillText(Jt,ir,tr+or),tr+=He+Oe})}hitTest(ee){const ne=this._data,re=this._preRender();if(!ne||!re)return null;const se=new Point(ne.point.x+re.rectSize.width,ne.point.y+re.rectSize.height);return pointInBox$1(ee,box(ne.point,se))?this._hitTest:null}rectSize(){const ee=this._preRender();return ee?size$1({width:ee.rectSize.width,height:ee.rectSize.height}):null}_preRender(){if(!this._data)return null;if(this._preRenderedData)return this._preRenderedData;const{fontSize:ee=12,text:ne,wordWrapWidth:re,paddingBottom:se,paddingTop:ae,paddingLeft:le,paddingRight:ce,icons:he,bold:fe,italic:Ae,lineSpacing:pe}=this._data,Oe=makeFont(ee,this._data.font,Ae?"italic":void 0,fe?"bold":void 0),Fe=(()=>{if(_tempCtx!==null)return _tempCtx;const Ze=createDisconnectedCanvas(document,size$1({width:0,height:0}));return _tempCtx=getPrescaledContext2D(Ze),_tempCtx})();Fe.textBaseline="middle",Fe.font=Oe;const Ne=ne===null?[]:wordWrap(ne,Oe,this._textWidthCache,!0,re).map(Ze=>Ze.text);let ze=0;if(re)ze=re;else for(const Ze of Ne)ze=Math.max(ze,Fe.measureText(Ze).width);const He={top:ae,right:ce,bottom:se,left:le},We=Math.max(ee,he!=null&&he.length?Offset:0),je=We*Ne.length+pe*(Ne.length-1),Ue={width:ze+He.left+He.right,height:je+He.top+He.bottom},Ge={x:He.left,y:He.top};if(he){const Ze=this._data.textPadding!==void 0?this._data.textPadding:ee/2;Ge.x+=Offset+Ze,Ue.width+=Offset+Ze}return Ue.width%2!==0&&(Ue.width+=1),this._preRenderedData={rectSize:Ue,padding:He,textPointOffset:Ge,lines:Ne,lineHeight:We,font:Oe},this._preRenderedData}_drawIcon(ee,ne,re,se,ae,le){ee.fillStyle=ae?iconStrokeLight:iconsStrokeDark,se.render(ee,{targetViewBox:{x:ne,y:re,width:Math.round(Offset*le.horizontalPixelRatio),height:Math.round(Offset*le.verticalPixelRatio)},doNotApplyColors:!0})}}class TrendToolWithStatsPaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_mode",TextMode.Preview);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_labelData",null);Ee(this,"_label",null);Ee(this,"_middlePoint",null);Ee(this,"_statsRenderer",new StatsRenderer)}renderer(){return this._renderer}_updateAndReturnStatsRenderer(ee){this._statsRenderer.setData(this._statLabelData());const ne=this._statsRenderer.rectSize();if(ne!==null){const re=this._targetRect(ee,ne);this._statsRenderer.updatePoint(new Point(re.left,re.top))}return this._statsRenderer}_targetRect(ee,ne){const re=this._source.properties().statsPosition,se=this._getPointsForStats(),ae=re===StatsPosition.Auto?StatsPosition.Center:re;let le=se[ae].x+12,ce=se[ae].y;const he=this.points(),fe=he[1].y<he[0].y&&he[1].x<he[0].x||he[1].y>he[0].y&&he[1].x>he[0].x;fe?ce-=12+ne.height:ce+=12;const{mediaSize:Ae}=ee;if(re===StatsPosition.Auto&&!arePointsEqual(se[StatsPosition.Left],se[StatsPosition.Right])){le<0?le=0:le+ne.width>Ae.width&&(le=Ae.width-ne.width),ce<0?ce=0:ce+ne.height>Ae.height&&(ce=Ae.height-ne.height);const pe=box(new Point(le,ce),new Point(le+ne.width,ce+ne.height)),Oe=lineSegment(se[StatsPosition.Left],se[StatsPosition.Right]);intersectLineSegmentAndBox(Oe,pe)&&(ce=fe?se[ae].y+12:se[ae].y-12-ne.height,le=Math.min(se[StatsPosition.Center].x,Ae.width)-ne.width)}return{left:Math.floor(le),top:Math.floor(ce),width:ne.width,height:ne.height}}_priceRange(){var he;const[ee,ne]=this._source.controlPoints,re=this._source.properties(),se=re.showPriceRange,ae=re.showPercentPriceRange,le=re.showPipsPriceRange;let ce=null;if(this._source.priceScale()&&(se||ae||le)){const fe=[],Ae=ne.price-ee.price;if(se||ae){const Fe=Ae/Math.abs(ee.price),Ne=[];if(se){const ze=this._source.series.priceFormatter(),He="formatChange"in ze&&lodashExports.isFunction(ze.formatChange)?(he=ze.formatChange)==null?void 0:he.call(ze,ne.price,ee.price):ze.format(Ae);Ne.push(He)}if(ae){const ze=getPercentageFormatter().format(100*Fe);Ne.push(se?`(${ze})`:ze)}fe.push(Ne.join(" "))}const pe=this._source.symbolInfo(),Oe=pe&&getPipFormatter(pe);le&&Oe&&fe.push(Oe.format(Ae)),ce=fe.join(", ")}return ce}_statLabelData(){const[ee,ne]=this._source.controlPoints,re=this._source.properties(),se=[];let ae,le,ce,he;const fe=this._priceRange();fe!==void 0&&se.push("priceRange");const Ae=re.showBarsRange,pe=re.showDateTimeRange,Oe=re.showDistance,Fe=re.showAngle;if(Fe||Oe){const Ue=ensure(this._source.pointToScreenPoint(ee));ce=ensure(this._source.pointToScreenPoint(ne)).subtract(Ue),he=Math.round(ce.length()*1e5)/1e5}if(Ae||pe||Oe){if(ae="",Ae){const Ue=ensure(this._source.getIndex(ne))-ensure(this._source.getIndex(ee));ae+=ensure(re.formatBarCount)({count:forceLTRStr(String(Ue))})}if(pe){const Ue=ee.time,Ge=ne.time;if(Ue&&Ge){const Ze=startWithLTR(this._source.timeSpanFormatter()(Ue,Ge));Ze&&(ae+=Ae?" ("+Ze+")":Ze)}}Oe&&(ae&&(ae+=", "),ae+=ensure(re.formatDistance)({distance:forceLTRStr(getNumericFormatter().format(Math.round(Number(he))))})),ae&&se.push("barsRange")}if(Fe){let Ue;if(he!==void 0&&he>0&&ce!==void 0&&(ce=ce.normalized(),Ue=Math.acos(ce.x),ce.y>0&&(Ue=-Ue)),typeof Ue=="number"&&!isNaN(Ue)){const Ge=Ue*180/Math.PI;le=Math.round(Ge*100)/100+"º",se.push("angle")}}this._label=[forceLTRStr(fe??""),ae,le].filter(Ue=>!!Ue).join(`
`)||null;const Ne=this._model.isDarkTheme(),ze=Ne?"#464646e6":"#f2f2f2e6",He=Ne?"#FFFFFF":"#1a1a1a",We=this.points(),je={point:We[1],text:this._label,color:He,isDark:Ne,font:ChartFontFamily,fontSize:12,lineSpacing:8,backgroundColor:ze,backgroundRoundRect:4,paddingLeft:12,paddingRight:12,paddingTop:12,paddingBottom:12,textPadding:12,doNotAlignText:!0,icons:se,bold:!1,italic:!1,lines:[],wordWrapWidth:0,vertAlign:VerticalAlign.Top,horzAlign:HorizontalAlign.Left};return We[1].y<We[0].y&&(je.vertAlign=VerticalAlign.Bottom),We[1].x<We[0].x&&(je.horzAlign=HorizontalAlign.Right),this._labelData=je,je}}class TextRenderer extends BaseTextRenderer{getTextInfo(){const te=this._getInternalData(),ee=this.fontStyle(),ne=this._getFontInfo();return{...te,lineSpacing:this.lineSpacing(),font:ee,fontSize:ne.fontSize,centerRotation:this.centerTextRotation()}}setCursorType(te){var ee,ne,re;((ne=(ee=this._hitTest)==null?void 0:ee.details)==null?void 0:ne.cursorType)!==te&&((re=this._hitTest)==null||re.mergeData({cursorType:te}))}}class TrendLinePaneView extends TrendToolWithStatsPaneView{constructor(){super(...arguments);Ee(this,"_trendRenderer",new LineRenderer(void 0,void 0,new HitTestResult(HitTarget.MovePoint)));Ee(this,"_labelRenderer",new TextRenderer(new HitTestResult(HitTarget.MovePoint)))}_getPointsForStats(){return[this.points()[0],ensure(this._middlePoint),this.points()[1]]}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties();!ne.showPriceRange&&!ne.showPercentPriceRange&&!ne.showPipsPriceRange&&!ne.showBarsRange&&!ne.showDateTimeRange&&!ne.showDistance&&!ne.showAngle&&(this._label=null,this._labelData&&(this._labelData.text=""));const re=ee[0],se=ee[1];this._middlePoint=new Point(midPoint(re,se));const ae=this._source.getScope(),{mediaSize:{width:le,height:ce}}=ae;let he;const fe=ne.text,Ae=this._isTextEditMode(),pe=this._placeHolderMode(!0);if(ne.showLabel&&(fe||pe||Ae)){const He=re.x<se.x?re:se,We=He===re?se:re,je=ne.vertLabelsAlign,Ue=ne.horzLabelsAlign;let Ge;Ue==="left"?Ge=He.clone():Ue==="right"?Ge=We.clone():Ge=new Point((re.x+se.x)/2,(re.y+se.y)/2);const Ze=Math.atan((We.y-He.y)/(We.x-He.x));this._labelRenderer.setData({points:[Ge],text:this._textDisplay(),color:this._textDisplayColor(),vertAlign:je,horzAlign:Ue,fontFamily:ChartFontFamily,offsetX:0,offsetY:0,bold:ne.bold,italic:ne.italic,fontSize:ne.fontSize,forceTextAlign:!0,angle:Ze,decorator:pe?PlusTextRendererDecorator.instance():void 0}),this._labelRenderer.setCursorType(this._textCursorType()),this._renderer.append(this._labelRenderer),this._needLabelExclusionPath(this._labelRenderer)&&(he=getTextBoundaries(this._labelRenderer,le,ce)??void 0),this._labelRenderer.isOutOfScreen(le,ce)?this.closeTextEditor():this._updateEditor(this._labelRenderer.getTextInfo())}const Oe=ne.linecolor,Fe={points:ee,lineColor:Oe,lineWidth:ne.linewidth,lineStyle:ne.linestyle,extendLeft:ne.extendLeft,extendRight:ne.extendRight,leftEnd:ne.leftEnd,rightEnd:ne.rightEnd,excludeBoundaries:he?[he]:void 0};this._trendRenderer.setData(Fe),this._renderer.insert(this._trendRenderer,0);const Ne=box(new Point(0,0),new Point(le,ce));let ze=!1;if(ne.statsPosition===StatsPosition.Auto&&(arePointsEqual(re,se)?ze=!pointInBox$1(re,Ne):ze=intersectLineSegmentAndBox(lineSegment(re,se),Ne)===null),((this.isHoveredSource()||this.isSelectedSource())&&this._isTextEditMode()||ne.alwaysShowStats)&&!ze&&ee.length===2&&this._renderer.append(this._updateAndReturnStatsRenderer(ae)),this._middlePoint&&!Ae){const He=(this.isHoveredSource()||this.isSelectedSource())&&ne.showMiddlePoint;this._renderer.append(new SelectionRenderer({points:[new AnchorPoint(this._middlePoint)],bgColors:this._lineAnchorColors([this._middlePoint]),color:Oe,visible:He&&this.areAnchorsVisible(),hitTarget:HitTarget.Regular}))}this.addAnchors(this._renderer)}_needLabelExclusionPath(ee,ne){const re=this._source.properties();return(ne??re.vertLabelsAlign)==="middle"&&needTextExclusionPath(ee)}}class TrendLinePrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_line",new TrendLinePaneView(this,this.model,this.editingHelper));Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_paneView",[this._line])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._paneView[0].update({points:ee})}isCreationFinished(){return this._line.isCreationFinished()}startTextEditing(){return this._line.startTextEditing()}}class TrendLineTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",TrendLineToolType);Ee(this,"steps",2);Ee(this,"extendLeft",!1);Ee(this,"extendRight",!1);Ee(this,"showPriceLabels",!1);Ee(this,"showPriceRange",!1);Ee(this,"showPercentPriceRange",!1);Ee(this,"showPipsPriceRange",!1);Ee(this,"showDateTimeRange",!1);Ee(this,"showBarsRange",!1);Ee(this,"showDistance",!1);Ee(this,"showAngle",!1);Ee(this,"alwaysShowStats",!1);Ee(this,"rightEnd",LineEnd.Normal)}createPrimitive(ee){const ne=getI18nService(ee);return new TrendLinePrimitive({id:this.id,points:[],linecolor:"#2962FF",linewidth:2,linestyle:0,extendLeft:this.extendLeft,extendRight:this.extendRight,leftEnd:0,rightEnd:this.rightEnd,showLabel:!1,horzLabelsAlign:HorizontalAlign.Center,vertLabelsAlign:VerticalAlign.Bottom,textColor:"#2962FF",fontSize:14,text:"",placeholder:"",wordWrap:!0,bold:!1,italic:!1,alwaysShowStats:this.alwaysShowStats,showMiddlePoint:!1,showPriceLabels:this.showPriceLabels,showPriceRange:this.showPriceRange,showPercentPriceRange:this.showPercentPriceRange,showPipsPriceRange:this.showPipsPriceRange,showBarsRange:this.showBarsRange,showDateTimeRange:this.showDateTimeRange,showDistance:this.showDistance,showAngle:this.showAngle,statsPosition:StatsPosition.Right,formatBarCount:re=>ne.t("tool.line.common.bars",re),formatDistance:re=>ne.t("tool.line.common.distance",re)},...this.getTextResetArgs(ee))}finishDrawing(){ensure(this._drawingSession).finishDrawing()}}class ArrowTool extends TrendLineTool{constructor(){super(...arguments);Ee(this,"type",ArrowToolType);Ee(this,"rightEnd",LineEnd.Arrow)}}const ArrowArrow={type:ArrowToolType,icon:icon$1u,Ctor:ArrowTool};var ArrowMarkDirection=(ie=>(ie.up="up",ie.down="down",ie.left="left",ie.right="right",ie))(ArrowMarkDirection||{});class ArrowMarkRenderer extends BitmapCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const{color:ee,direction:ne,points:re}=this._data,se=re[0],ae=te.context;ae.fillStyle=ee,ne==="up"||ne==="down"?this._drawVerticalArrow(ae,se,ne,te):(ne==="left"||ne==="right")&&this._drawHorizontalArrow(ae,se,ne,te)}_drawVerticalArrow(te,ee,ne,re){const{horizontalPixelRatio:se,verticalPixelRatio:ae}=re,le=Math.max(1,Math.floor(se))%2?.5:0,ce=ne==="up"?1:-1,he=ce*Math.round(12*ae),fe=ceiledEven(19.5*se)/2+le,Ae=ce*Math.round(10*ae),pe=ceiledEven(10*se)/2+le,Oe=Math.round(ee.x*se)+le,Fe=Math.round(ee.y*ae);te.beginPath(),te.moveTo(Oe,Fe),te.lineTo(Oe+fe,Fe+he),te.lineTo(Oe+pe,Fe+he),te.lineTo(Oe+pe,Fe+he+Ae),te.lineTo(Oe-pe,Fe+he+Ae),te.lineTo(Oe-pe,Fe+he),te.lineTo(Oe-fe,Fe+he),te.closePath(),te.fill()}_drawHorizontalArrow(te,ee,ne,re){const{horizontalPixelRatio:se,verticalPixelRatio:ae}=re,le=Math.max(1,Math.floor(se))%2?.5:0,ce=ne==="left"?1:-1,he=ce*Math.round(12*se)+le,fe=ceiledEven(19.5*ae)/2+le,Ae=ce*Math.round(22*se)+le,pe=ceiledEven(10*ae)/2+le,Oe=Math.round(ee.x*se)+le,Fe=Math.round(ee.y*ae)+le;te.beginPath(),te.moveTo(Oe,Fe),te.lineTo(Oe+he,Fe+fe),te.lineTo(Oe+he,Fe+pe),te.lineTo(Oe+Ae,Fe+pe),te.lineTo(Oe+Ae,Fe-pe),te.lineTo(Oe+he,Fe-pe),te.lineTo(Oe+he,Fe-fe),te.closePath(),te.fill()}hitTest(te){if(!this._data)return null;const{direction:ee,points:ne}=this._data,re=ne[0],se=19.5,ae=22,le=22,ce=19.5;let he,fe,Ae,pe;switch(ee){case"up":he=re.x-se/2,fe=he+se,Ae=re.y,pe=Ae+ae;break;case"down":he=re.x-se/2,fe=he+se,pe=re.y,Ae=pe-ae;break;case"left":he=re.x,fe=he+le,Ae=re.y-ce/2,pe=Ae+ce;break;case"right":fe=re.x,he=fe-le,Ae=re.y-ce/2,pe=Ae+ce;break;default:return null}const{x:Oe,y:Fe}=te;return Oe>=he&&Oe<=fe&&Fe>=Ae&&Fe<=pe?new HitTestResult(HitTarget.MovePoint):null}}class ArrowMarkPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_arrowMarkRenderer",new ArrowMarkRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();this._arrowMarkRenderer.setData({points:this.points(),color:ee.color,direction:ee.direction}),this._renderer.append(this._arrowMarkRenderer),this._renderer.append(new SelectionRenderer({points:this.points(),bgColors:this._lineAnchorColors(this.points()),visible:this.areAnchorsVisible(),hitTarget:HitTarget.MovePoint}))}}class ArrowMarkPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ArrowMarkPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const[ee]=this.controlPoints,ne=this.pointToScreenPoint(ee),re=new AnchorPoint(ne,{pointIndex:0});this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ee.time,ne.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ee.price,ne.y)),this._lines.update({points:[re]})}}class ArrowMarkTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"steps",1);Ee(this,"direction",ArrowMarkDirection.up)}createPrimitive(){return new ArrowMarkPrimitive({id:this.id,points:[],color:"#089981FF",direction:this.direction},...this.resetArgs)}}const icon$1t=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M17 12v-6h-6v6h-4.865l7.865 9.438 7.865-9.438h-4.865zm-7-7h8v6h6l-10 12-10-12h6v-6z"></path></svg>
`,ArrowMarkDownToolType="tool.arrow.arrowMarkDown";class ArrowMarkDownTool extends ArrowMarkTool{constructor(){super(...arguments);Ee(this,"type",ArrowMarkDownToolType);Ee(this,"direction",ArrowMarkDirection.down)}}const ArrowMarkDown={type:ArrowMarkDownToolType,icon:icon$1t,Ctor:ArrowMarkDownTool},icon$1s=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M22.38 4.04h.04a1.3 1.3 0 0 1 1.21.33c.37.36.42.84.33 1.2v.04l-2.45 8.32c-.14.55-.57.91-1 1.04-.45.14-1.2.07-1.55-.63l-.34-.64-12.6 10.03c-.3.25-.67.31-1 .25a1.3 1.3 0 0 1-1.01-1.06c-.05-.31.02-.69.29-.99l.02-.02a35.13 35.13 0 0 0 .47-.57 1749.6 1749.6 0 0 0 5-6.15l3.7-4.57.91-1.13-.63-.33c-.7-.36-.77-1.1-.64-1.55.13-.44.5-.86 1.03-1l8.22-2.57zm-7.95 3.53c-.35.08-.5.56-.2.7l1.71.91-.64.8a17294.8 17294.8 0 0 1-10.24 12.6l-.01.02c-.17.19.15.52.33.35l13.55-10.78.92 1.7c.14.3.62.16.7-.2l2.44-8.31c.05-.24-.1-.4-.35-.35l-8.2 2.56zM5.8 23.27z"></path></svg>
`,ArrowMarkerToolType="tool.arrow.arrowMarker";class ArrowRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const ee=this._data.points;if(ee.length<2)return;const ne=te.context;ne.fillStyle=this._data.color,ne.strokeStyle=this._data.color,ne.lineJoin="round",ne.lineCap="round";let re=new Point(ee[0]);const se=new Point(ee[1]);let ae=se.subtract(re);ae.length()<22&&(re=se.addScaled(ae.normalized(),-22),ae=se.subtract(re));const ce=new Point(ae.y,-ae.x).normalized(),he=this._arrowGeometry(ae.length()),fe=ae.normalized();ne.lineWidth=(()=>{let Ae=Math.round(.02*ae.length());return Ae=Math.min(Ae,5),Ae=Math.max(Ae,2),Ae})(),ne.beginPath(),ne.moveTo(re.x,re.y);for(let Ae=0;Ae<he.length;Ae++){const pe=he[Ae],Oe=re.addScaled(fe,pe.x).addScaled(ce,pe.y);ne.lineTo(Oe.x,Oe.y)}ne.lineTo(ee[1].x,ee[1].y);for(let Ae=he.length-1;Ae>=0;Ae--){const pe=he[Ae],Oe=re.addScaled(fe,pe.x).addScaled(ce,-pe.y);ne.lineTo(Oe.x,Oe.y)}ne.lineTo(re.x,re.y),ne.stroke(),ne.fill()}_arrowGeometry(te){const ee=calculateArrowHeadWidth(te),ne=[],re=te>=35?.1:0,se=0,ae=te-ee+ee*re,le=te-ee,ce=te,he=1.22*ee;return ne.push({x:se,y:0}),ne.push({x:ae,y:he/4}),ne.push({x:le,y:he/2}),ne.push({x:ce,y:0}),ne}_hittestGeometry(te){const ee=calculateArrowHeadWidth(te),ne=[],re=0,se=te-ee,ae=te,le=1.22*ee,ce=le/4,he=le/2;return ne.push({x:re,y:0}),ne.push({x:se,y:ce}),ne.push({x:se,y:he}),ne.push({x:ae,y:0}),ne}hitTest({x:te,y:ee}){if(!this._data)return null;const ne=this._data.points;if(ne.length<2)return null;const re=new Point(te,ee),se=new Point(ne[1]);let ae=new Point(ne[0]),le=se.subtract(ae);const ce=le.length();ce<22&&(ae=se.addScaled(le.normalized(),-22),le=se.subtract(ae));const he=re.subtract(ae),fe=le.dotProduct(he)/ce;if(fe<0||fe>ce)return null;const Ae=le.scaled(1/ce),pe=ae.addScaled(Ae,fe),Oe=re.subtract(pe),Fe=interactionTolerance().line,Ne=this._hittestGeometry(ce);for(let ze=Ne.length-2;ze>=0;ze--){const He=Ne[ze],We=Ne[ze+1];if(fe>=He.x){const je=We.x-He.x,Ue=We.y-He.y,Ge=(fe-He.x)/je,Ze=He.y+Ue*Ge;return Oe.length()<=Ze+Fe?new HitTestResult(HitTarget.MovePoint):null}}return Oe.length()<3?new HitTestResult(HitTarget.MovePoint):null}}function calculateArrowHeadWidth(ie){if(ie<92)return 18;let se=ie*.25;return se=Math.min(se,106),se=Math.max(se,18),se=Math.min(se,ie*.9),se}class ArrowMarkerPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_arrowRenderer",new ArrowRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();this._arrowRenderer.setData({points:this.points(),color:ee.color}),this._renderer.append(this._arrowRenderer),this.addAnchors(this._renderer)}}class ArrowMarkerPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ArrowMarkerPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(new AnchorPoint(le,{pointIndex:ae}))}),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:ee})}}class ArrowMarkerTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ArrowMarkerToolType);Ee(this,"steps",2)}createPrimitive(){return new ArrowMarkerPrimitive({id:this.id,points:[],color:"#1E53E5FF"},...this.resetArgs)}}const ArrowMarker={type:ArrowMarkerToolType,icon:icon$1s,Ctor:ArrowMarkerTool},icon$1r=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M16 17h6v-6h-6v-4.865l-9.438 7.865 9.438 7.865v-4.865zm7 1h-6v6l-12-10 12-10v6h6v8z"></path></svg>
`,ArrowMarkLeftToolType="tool.arrow.arrowMarkLeft";class ArrowMarkLeftTool extends ArrowMarkTool{constructor(){super(...arguments);Ee(this,"type",ArrowMarkLeftToolType);Ee(this,"direction",ArrowMarkDirection.left)}}const ArrowMarkLeft={type:ArrowMarkLeftToolType,icon:icon$1r,Ctor:ArrowMarkLeftTool},icon$1q=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M12 11h-6v6h6v4.865l9.438-7.865-9.438-7.865v4.865zm-7 7v-8h6v-6l12 10-12 10v-6h-6z"></path></svg>
`,ArrowMarkRightToolType="tool.arrow.arrowMarkRight";class ArrowMarkRightTool extends ArrowMarkTool{constructor(){super(...arguments);Ee(this,"type",ArrowMarkRightToolType);Ee(this,"direction",ArrowMarkDirection.right)}}const ArrowMarkRight={type:ArrowMarkRightToolType,icon:icon$1q,Ctor:ArrowMarkRightTool},icon$1p=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M11 16v6h6v-6h4.865l-7.865-9.438-7.865 9.438h4.865zm7 7h-8v-6h-6l10-12 10 12h-6v6z"></path></svg>
`,ArrowMarkUpToolType="tool.arrow.arrowMarkUp";class ArrowMarkUpTool extends ArrowMarkTool{constructor(){super(...arguments);Ee(this,"type",ArrowMarkUpToolType);Ee(this,"direction",ArrowMarkDirection.up)}}const ArrowMarkUp={type:ArrowMarkUpToolType,icon:icon$1p,Ctor:ArrowMarkUpTool},icon$1o=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M1.789 23l.859-.854.221-.228c.18-.19.38-.409.597-.655.619-.704 1.238-1.478 1.815-2.298.982-1.396 1.738-2.776 2.177-4.081 1.234-3.667 5.957-4.716 8.923-1.263 3.251 3.785-.037 9.38-5.379 9.38h-9.211zm9.211-1c4.544 0 7.272-4.642 4.621-7.728-2.45-2.853-6.225-2.015-7.216.931-.474 1.408-1.273 2.869-2.307 4.337-.599.852-1.241 1.653-1.882 2.383l-.068.078h6.853z"></path><path d="M18.182 6.002l-1.419 1.286c-1.031.935-1.075 2.501-.096 3.48l1.877 1.877c.976.976 2.553.954 3.513-.045l5.65-5.874-.721-.693-5.65 5.874c-.574.596-1.507.609-2.086.031l-1.877-1.877c-.574-.574-.548-1.48.061-2.032l1.419-1.286-.672-.741z"></path></g></svg>
`,BrushToolType="tool.brush.brush";class PolygonRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){const ee=te.context,ne=this._data;if(!ne)return;const re=ne.points.length;if(!re)return;if(re===1){const ce=ne.points[0],he=ne.lineWidth/2;this._drawPoint(ee,ce,he,ne.lineColor)}ee.beginPath();const se=ne.lineStyle===LineStyleType.solid?"round":"butt",ae=ne.lineCap??se;ee.lineCap=ae,ee.strokeStyle=ne.lineColor,ee.lineWidth=ne.lineWidth,ee.lineJoin=ne.lineJoin??"round",setLineStyle(ee,ne.lineStyle);const le=ne.points[0];ee.moveTo(le.x,le.y);for(const ce of ne.points)ee.lineTo(ce.x,ce.y);if(ne.background&&ne.filled&&(ee.fillStyle=generateColor(ne.background,ne.transparency),ee.fill()),ne.background&&ne.filled&&!ne.skipClosePath&&ee.closePath(),re>1){if(ne.leftEnd===LineEnd.Arrow){const ce=this._correctArrowPoints(new Point(ne.points[1]),new Point(ne.points[0]),ee.lineWidth,ae);drawArrow(ce[0],ce[1],ee,ee.lineWidth,dpr1PixelRatioInfo)}if(ne.rightEnd===LineEnd.Arrow){const ce=this._correctArrowPoints(new Point(ne.points[re-2]),new Point(ne.points[re-1]),ee.lineWidth,ae);drawArrow(ce[0],ce[1],ee,ee.lineWidth,dpr1PixelRatioInfo)}}ne.lineWidth>0&&ee.stroke()}_drawPoint(te,ee,ne,re){ne&&(te.beginPath(),te.fillStyle=re,te.arc(ee.x,ee.y,ne,0,2*Math.PI,!0),te.fill(),te.closePath())}_correctArrowPoints(te,ee,ne,re){const se=ee.subtract(te),ae=se.length();if(re==="butt"||ae<1)return[te,ee];const le=ae+ne/2,ce=se.scaled(le/ae).add(te);return[te,ce]}hitTest(te){const ee=this._data;if(!ee)return null;const{points:ne}=ee,re=Math.max(interactionTolerance().line,Math.ceil(ee.lineWidth/2)),se=ne.length,ae=new HitTestResult(HitTarget.MovePoint);if(se===1){const le=ne[0];return pointInCircle(te,le,re)?ae:null}for(let le=1;le<se;le++){const ce=ne[le-1],he=ne[le];if(distanceToSegment(ce,he,te).distance<=re)return ae}if(ee.background&&se>0){const le=ne[0],ce=ne[se-1];if(distanceToSegment(le,ce,te).distance<=re)return ae}return null}}class BrushPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_polygonRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(ee.length===0)return;const ne=[ee[0]],re=Math.max(1,this._source.properties().smooth);for(let le=1;le<ee.length;le++){const ce=ee[le].subtract(ee[le-1]),he=ce.length(),fe=Math.min(5,Math.floor(he/re)),Ae=ce.normalized().scaled(he/fe);for(let pe=0;pe<fe-1;pe++){const Oe=ee[le-1].add(Ae.scaled(pe));ne.push(Oe)}ne.push(ee[le])}const se=this._smoothArray(ne,re),ae=this._createPolygonRendererData(se);if(this._polygonRenderer.setData(ae),this._renderer.append(this._polygonRenderer),this._source.isCreationFinished()){const le=ae.points.length;if(le>0){const ce=le>1?[new AnchorPoint(ae.points[0],{hitTarget:HitTarget.Regular,pointIndex:0}),new AnchorPoint(ae.points[le-1],{hitTarget:HitTarget.Regular,pointIndex:1})]:[new AnchorPoint(ae.points[0],{hitTarget:HitTarget.Regular,pointIndex:0})],he=new SelectionRenderer({points:ce,bgColors:this._lineAnchorColors(ce),visible:this.areAnchorsVisible(),hitTarget:HitTarget.Regular});this._renderer.append(he)}}}_smoothArray(ee,ne){if(ee.length===1)return ee;const re=new Array(ee.length);for(let se=0;se<ee.length;se++){let ae=new Point(0,0);for(let le=0;le<ne;le++){const ce=Math.max(se-le,0),he=Math.min(se+le,ee.length-1);ae=ae.add(ee[ce]),ae=ae.add(ee[he])}re[se]=ae.scaled(.5/ne)}return re.push(ee[ee.length-1]),re}_createPolygonRendererData(ee){const ne=this._source.properties();return{points:ee,lineColor:ne.lineColor,lineWidth:ne.lineWidth,lineStyle:LineStyleType.solid}}}class BrushPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new BrushPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))])}updateDrag(ee,ne,re,se,ae,le){this._currentDragTarget=ee;const ce=se-re,he=le-ae;this._props.points.forEach((fe,Ae)=>{fe.time=ne[Ae].time+ce,fe.price=ne[Ae].price+he}),this.updateAllViews(),this.requestUpdate()}updateStroke(ee){this.controlPoints.push(ee),this.updateAllViews(),this.requestUpdate()}abort(){return DrawingAbortBehavior.None}updateAllViews(){const ee=[],ne=[],re=[];this.controlPoints.forEach(se=>{const ae=this.pointToScreenPoint(se);ee.push(new AnchorPoint(ae))}),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:ee})}}const threshold=3;class BrushTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",BrushToolType);Ee(this,"steps",1/0);Ee(this,"_drawPoints",[])}createPrimitive(){return new BrushPrimitive({id:generateUuid(),points:[],smooth:5,lineColor:"#00BCD4FF",lineWidth:2},...this.resetArgs)}processEvent(ee){var ne;switch(ee.type){case InputEventType.DRAG_START:{const re=ensure(ee.asMouseInputEvent()),se=re.source.chart.getCrosshairPosition();if(!isValidPosition(se))return;const ae=ensure(se.paneIndex),le=this._startCreationOnChart(re.source,ae,!1,!1),ce=se,he=ensure(getXCoordinate(this.chartService,se.x,{useExtended:!this.disableExtendTime})),fe=ensure(le.getTargetSeries().coordinateToPrice(se.y));re.accept(),this._disableDefaultDrag(),this._drawPoints.push(ce);const Ae=this.createPrimitive();le.startDrawing(Ae),Ae.updateStroke({time:he,price:fe});break}case InputEventType.DRAG:{const re=ensure(ee.asMouseInputEvent()),se=re.source.chart.getCrosshairPosition();if(!isValidPosition(se))return;const ae=se;if(euclideanDistanceBetweenPoints(ae,ensure(last$1(this._drawPoints)))>threshold){const ce=ensure(getXCoordinate(this.chartService,se.x,{useExtended:!this.disableExtendTime})),he=ensure((ne=this._drawingSession)==null?void 0:ne.getTargetSeries().coordinateToPrice(se.y)),fe={time:ce,price:he};this._drawPoints.push(ae),this.primitive.updateStroke(fe)}re.accept();break}case InputEventType.DRAG_END:{ensure(ee.asMouseInputEvent()).accept(),this.abortDrawing();break}case InputEventType.DROP:{ensure(ee.asMouseInputEvent()).accept(),this._drawingSession&&this.finishDrawing();break}}}_disableDefaultDrag(){this.chartService.chart.applyOptions({handleScale:!1,handleScroll:!1})}_enableDefaultDrag(){this.chartService.chart.applyOptions({handleScale:!0,handleScroll:!0})}finishDrawing(){super.finishDrawing(),this._enableDefaultDrag(),this._drawPoints=[]}useMagnetedPosition(){return!1}}const BrushBrush={type:BrushToolType,icon:icon$1o,Ctor:BrushTool},icon$1n=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 23" width="25" height="23"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M13.402 0L6.78144 6.71532C6.67313 6.82518 6.5917 6.95862 6.54354 7.10518L5.13578 11.3889C4.89843 12.1111 5.08375 12.9074 5.61449 13.4458L5.68264 13.5149L0 19.2789L8.12695 22.4056L11.2874 19.1999L11.3556 19.269C11.8863 19.8073 12.6713 19.9953 13.3834 19.7546L17.6013 18.3285C17.7493 18.2784 17.8835 18.1945 17.9931 18.0832L24.6912 11.2892L23.9857 10.5837L17.515 17.147L7.70658 7.19818L14.1076 0.705575L13.402 0ZM6.07573 11.7067L7.24437 8.15061L16.576 17.6158L13.0701 18.8012C12.7141 18.9215 12.3215 18.8275 12.0562 18.5584L6.31509 12.7351C6.04972 12.466 5.95706 12.0678 6.07573 11.7067ZM6.30539 14.3045L10.509 18.5682L7.87935 21.2355L1.78414 18.8904L6.30539 14.3045Z"></path></svg>
`,HighlighterToolType="tool.brush.highlighter";class HighlighterTool extends BrushTool{constructor(){super(...arguments);Ee(this,"type",HighlighterToolType)}createPrimitive(){return new BrushPrimitive({id:generateUuid(),points:[],smooth:5,lineColor:"#F2364533",lineWidth:20},...this.resetArgs)}}const BrushHighlighter={type:HighlighterToolType,icon:icon$1n,Ctor:HighlighterTool},icon$1m=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M20.534 4.664l-13.318 4.701.333.943 13.318-4.701zM20.802 22.371l-13.285-4.689-.333.943 13.285 4.689z"></path><path d="M5.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 19c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,DisjointChannelToolType="tool.channel.disjointChannel";function intersectLineWithViewport(ie,te,ee,ne,re,se,ae){const le=ie.x>=0&&ie.x<=re&&ie.y>=0&&ie.y<=se,ce=te.x>=0&&te.x<=re&&te.y>=0&&te.y<=se;if(le&&ce&&!ee&&!ne)return[ie,te];if(ie.x<0&&te.x<0&&(ie.x<te.x?!ne:!ee)||ie.x>re&&te.x>re&&(ie.x<te.x?!ee:!ne)||ie.y<0&&te.y<0&&(ie.y<te.y?!ne:!ee)||ie.y>se&&te.y>se&&(ie.y<te.y?!ee:!ne))return null;const he=[];if(ie.x===te.x){if(ie.x<0||ie.x>re)return null;ie.y<te.y?he.push(new Point(ie.x,ae===0?0:ie.y<0?ie.y%ae:-(ae-ie.y%ae)),new Point(te.x,se)):he.push(new Point(ie.x,ae===0?se:ie.y>se?se+(ie.y-se)%ae:se+(ae-(se-ie.y)%ae)),new Point(te.x,0))}else if(ie.y===te.y){if(ie.y<0||ie.y>se)return null;ie.x<te.x?he.push(new Point(ae===0?0:ie.x<0?ie.x%ae:-(ae-ie.x%ae),ie.y),new Point(re,te.y)):he.push(new Point(ae===0?re:ie.x>re?re+(ie.x-re)%ae:re+(ae-(re-ie.x)%ae),ie.y),new Point(0,te.y))}else{const Ae=(te.y-ie.y)/(te.x-ie.x),pe=ie.y-Ae*ie.x,Oe=(We,je,Ue)=>We>=je&&We<=Ue?We:null,Fe=Oe(pe,0,se);if(Fe!==null)if(ae>0&&(ie.x<=0||ee&&ie.x<te.x)){const We=ie.x<=0?Math.hypot(0-ie.x,Fe-ie.y)%ae:ae-Math.hypot(0-ie.x,Fe-ie.y)%ae,je=Math.cos(Math.atan(Ae))*We,Ue=Ae*je;he.push(new Point(-je,Fe-Ue))}else he.push(new Point(0,Fe));const Ne=Oe(Ae*re+pe,0,se);if(Ne!==null)if(ae>0&&(ie.x>=re||ee&&ie.x>te.x)){const We=ie.x>=re?Math.hypot(ie.x-re,ie.y-Ne)%ae:ae-Math.hypot(ie.x-re,ie.y-Ne)%ae,je=Math.cos(Math.atan(Ae))*We,Ue=Ae*je;he.push(new Point(re+je,Ne+Ue))}else he.push(new Point(re,Ne));const ze=Oe(-pe/Ae,0,re);if(ze!==null&&(ze!==0||Fe!==0))if(ae>0&&(ie.y<=0||ee&&ie.y<te.y)){const We=ie.y<=0?Math.hypot(ie.x-ze,ie.y)%ae:ae-Math.hypot(ie.x-ze,ie.y)%ae,je=Math.cos(Math.atan(Ae))*We,Ue=Ae*je;he.push(new Point(ze-Math.sign(Ae)*je,0-Math.sign(Ae)*Ue))}else he.push(new Point(ze,0));const He=Oe((se-pe)/Ae,0,re);if(He!==null&&(He!==0||Ne!==se))if(ae>0&&(ie.y>=se||ee&&ie.y>te.y)){const We=ie.y>=se?Math.hypot(ie.x-He,ie.y-se)%ae:ae-Math.hypot(ie.x-He,ie.y-se)%ae,je=Math.cos(Math.atan(Ae))*We,Ue=Ae*je;he.push(new Point(He+Math.sign(Ae)*je,se+Math.sign(Ae)*Ue))}else he.push(new Point(He,se))}if(he.length<1)return null;he.length<2&&he.push(he[0]);const fe=(Ae,pe,Oe,Fe)=>Math.sign(Ae.x-pe.x)===Math.sign(Oe.x-Fe.x)&&Math.sign(Ae.y-pe.y)===Math.sign(Oe.y-Fe.y);return!ee&&le?[ie,fe(he[0],he[1],ie,te)?he[1]:he[0]]:!ne&&ce?[fe(he[0],he[1],ie,te)?he[0]:he[1],te]:fe(he[0],he[1],ie,te)?[he[0],he[1]]:[he[1],he[0]]}class ParallelChannelRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_backgroundPolygon",null);Ee(this,"_clippedLines",new Map);Ee(this,"_hitTest",new HitTestResult(HitTarget.MovePoint))}setData(ee){super.setData(ee),this._backgroundPolygon=null,this._clippedLines.clear()}hitTest(ee,ne){if(!this._data)return null;const{line1:re,line2:se,middleLine:ae}=this._data,le=ne.mediaSize,ce=interactionTolerance().line;for(const he of[re,se,ae]){if(!he)continue;const fe=this._getClippedLine(he,this._data,le);if(fe&&distanceToSegment(fe.points[0],fe.points[1],ee).distance<=ce)return this._hitTest}return null}drawImpl(ee){if(!this._data)return;const{line1:ne,line2:re,middleLine:se,skipLines:ae,skipTopLine:le,fillBackground:ce,backColor:he,excludeBoundaries:fe}=this._data,Ae=ee.context;if(Ae.lineCap="round",ce&&re){const pe=this._getBackgroundPolygon(this._data,ee.mediaSize);if(pe.length>0){Ae.beginPath();const Oe=pe[0];Ae.moveTo(Oe.x*ee.horizontalPixelRatio,Oe.y*ee.verticalPixelRatio);for(let Fe=1;Fe<pe.length;Fe++){const Ne=pe[Fe];Ae.lineTo(Ne.x*ee.horizontalPixelRatio,Ne.y*ee.verticalPixelRatio)}Ae.fillStyle=he,Ae.fill()}}ae||(ne&&this._drawLine(ee,ne,this._data),!le&&re&&this._drawLine(ee,re,this._data),se&&this._drawLine(ee,se,this._data)),fe!==void 0&&Ae.restore()}_drawLine(ee,ne,re){const se=this._getClippedLine(ne,re,ee.mediaSize);if(!se)return;const ae=ee.context;ae.lineWidth=Math.max(1,Math.floor(se.lineWidth*ee.horizontalPixelRatio)),ae.lineCap=se.lineStyle===LineStyleType.solid?"round":"butt",setLineStyle(ae,se.lineStyle),ae.strokeStyle=se.color;const[le,ce]=se.points,he=le.x*ee.horizontalPixelRatio,fe=le.y*ee.verticalPixelRatio,Ae=ce.x*ee.horizontalPixelRatio,pe=ce.y*ee.verticalPixelRatio;drawPixelPerfectLine(ae,he,fe,Ae,pe)}_getClippedLine(ee,ne,re){if(this._clippedLines.has(ee))return this._clippedLines.get(ee)??null;const[se,ae]=ee.points,le=se.x!==ae.x?{extendLeft:ne.extendLeft,extendRight:ne.extendRight}:void 0,ce=computeDashPattern(ee.lineWidth,ee.lineStyle),he=intersectLineWithViewport(se,ae,!!(le!=null&&le.extendLeft),!!(le!=null&&le.extendRight),re.width,re.height,sumArrayValues(ce)),fe=he?{...ee,points:he}:null;return this._clippedLines.set(ee,fe),fe}_getBackgroundPolygon(ee,ne){return this._backgroundPolygon||(this._backgroundPolygon=this._getBackgroundPolygonImpl(ee,ne)??[]),this._backgroundPolygon}_getBackgroundPolygonImpl(ee,ne){if(!ee.line2)return null;const[re,se]=ee.line1.points,[ae,le]=ee.line2.points;if(arePointsEqual(re,se)||arePointsEqual(ae,le)||distanceToLine(re,se,ae).distance<1e-6||distanceToLine(re,se,le).distance<1e-6||ne.width<=0||ne.height<=0)return null;let ce=[new Point(0,0),new Point(ne.width,0),new Point(ne.width,ne.height),new Point(0,ne.height)];return ce=clipStep(ce,re,se,le),ee.extendRight||(ce=clipStep(ce,se,le,ae)),ce=clipStep(ce,le,ae,re),ee.extendLeft||(ce=clipStep(ce,ae,re,se)),ce}}function clipStep(ie,te,ee,ne){if(ie===null)return null;const re=lineThroughPoints(te,ee),se=halfplaneThroughPoint(re,ne);return intersectPolygonAndHalfplane(ie,se)}function safeSumBy(ie,te){let ee;for(let ne=0;ne<ie.length;ne++){const re=te(ie[ne]);re!==void 0&&(ee=ee===void 0?re:ee+re)}return ee}function sumArrayValues(ie){return!ie||ie.length===0?0:safeSumBy(ie,te=>te)??0}class DisjointChannelRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super();Ee(this,"_parallelChannelRenderer");Ee(this,"_intersectionRenderer");Ee(this,"_selectedRenderer");this._parallelChannelRenderer=new ParallelChannelRenderer,this._intersectionRenderer=new DisjointChannelIntersectionRenderer,this._selectedRenderer=this._intersectionRenderer}setData(ee){if(ee.points.length<4)return;const[ne,re,se,ae]=ee.points,le=arePointsEqual(ne,re),ce=arePointsEqual(se,ae),he=distanceToLine(ne,re,se).distance,fe=distanceToLine(ne,re,ae).distance,Ae=he<1e-6&&fe<1e-6;if(le||ce||Ae){this._selectedRenderer=null;return}intersectLines(lineThroughPoints(ne,re),lineThroughPoints(se,ae))!==null?(this._intersectionRenderer.setData(ee),this._selectedRenderer=this._intersectionRenderer):(this._parallelChannelRenderer.setData({line1:{color:"rgba(0,0,0,0)",lineStyle:LineStyleType.solid,lineWidth:0,points:[ne,re]},line2:{color:"rgba(0,0,0,0)",lineStyle:LineStyleType.solid,lineWidth:0,points:[ae,se]},extendLeft:ee.extendleft,extendRight:ee.extendright,skipLines:!0,fillBackground:!0,backColor:ee.backcolor,hittestOnBackground:ee.hittestOnBackground}),this._selectedRenderer=this._parallelChannelRenderer)}hitTest(ee,ne){return this._selectedRenderer?this._selectedRenderer.hitTest(ee,ne):null}drawImpl(ee){this._selectedRenderer&&this._selectedRenderer.drawImpl(ee)}}class DisjointChannelIntersectionRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){return!this._data||!this._data.hittestOnBackground,null}drawImpl(te){return new CanvasRenderingTarget2D(te.context,te.mediaSize,te.bitmapSize).useMediaCoordinateSpace(ne=>{if(!this._data||this._data.points.length<4)return;const re=ne.context,se=this._data.backcolor;re.fillStyle=se;for(const ae of this._visiblePolygons(ne.mediaSize)){re.beginPath(),re.moveTo(ae[0].x,ae[0].y);for(let le=1;le<ae.length;le++)re.lineTo(ae[le].x,ae[le].y);re.fill()}})}_visiblePolygons(te){const ee=ensure(this._data),[ne,re,se,ae]=ee.points;if(te.width<=0||te.height<=0)return[];const le=intersectLines(lineThroughPoints(ne,re),lineThroughPoints(se,ae));if(le===null)return[];const ce=[new Point(0,0),new Point(te.width,0),new Point(te.width,te.height),new Point(0,te.height)],he=[];{const fe=ne.subtract(re).add(le),Ae=ae.subtract(se).add(le);let pe=clipPolygonByEdge(ce,le,fe,[Ae,Ae]);pe=transformPolygonInDataSpace(pe,ee),pe=clipPolygonByEdge(pe,Ae,le,[fe,fe]),pe!==null&&he.push(pe)}{const fe=re.subtract(ne).add(le),Ae=se.subtract(ae).add(le);let pe=clipPolygonByEdge(ce,le,fe,[Ae,Ae]);pe=transformPolygonInDataSpace(pe,ee),pe=clipPolygonByEdge(pe,Ae,le,[fe,fe]),pe!==null&&he.push(pe)}return he}}function clipPolygonAlongVerticalX(ie,te,ee){if(ie===null)return null;const ne=createLine(1,0,-ee),re=halfplaneThroughPoint(ne,new Point(te,0));return intersectPolygonAndHalfplane(ie,re)}function transformPolygonInDataSpace(ie,te){const[ee,ne]=te.points;return te.extendleft||(ie=clipPolygonAlongVerticalX(ie,ee.x,ne.x)),te.extendright||(ie=clipPolygonAlongVerticalX(ie,ne.x,ee.x)),ie}class DisjointChannelPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRendererPoints12",new LineRenderer);Ee(this,"_trendLineRendererPoints43",new LineRenderer);Ee(this,"_disjointChannelRenderer",new DisjointChannelRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),[re,se]=ee;let ae,le;if(ee.length>=3){ae=new Point(se.x,ee[2].y);const he=se.y-re.y;le=new Point(re.x,ae.y+he),ne.fillBackground&&(this._disjointChannelRenderer.setData({extendleft:!!ne.extendLeft,extendright:!!ne.extendRight,points:[re,se,ae,le],fillBackground:!0,backcolor:ne.background}),this._renderer.append(this._disjointChannelRenderer))}this._trendLineRendererPoints12.setData(this._createLineStyle(re,se,ne)),this._renderer.append(this._trendLineRendererPoints12),ae&&le&&(this._trendLineRendererPoints43.setData(this._createLineStyle(le,ae,ne)),this._renderer.append(this._trendLineRendererPoints43));const ce=[re,se];ae&&ce.push(new AnchorPoint(ae,{pointIndex:2,cursorType:PaneCursor.ns,resizeDirections:AnchorResizeVert,style:AnchorStyle.square})),le&&ce.push(new AnchorPoint(le,{pointIndex:3})),this._model.currentCreating===this._source&&ce.pop(),this._renderer.append(this.createLineAnchor({points:ce},0))}_createLineStyle(ee,ne,re){return{points:[ee,ne],lineColor:re.lineColor,lineWidth:re.lineWidth,lineStyle:re.lineStyle,extendLeft:re.extendLeft,extendRight:re.extendRight,leftEnd:re.leftEnd,rightEnd:re.rightEnd}}}class DisjointChannelPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new DisjointChannelPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){const se=.5*(this.controlPoints[1].price+this.controlPoints[2].price);if(ee<3&&super.setPoint(ee,ne,re),ee!==0&&ee!==2){if(ee===1){const ae=this.controlPoints[1].price-se;this.controlPoints[2].price=this.controlPoints[1].price-2*ae}else if(ee===3){const ae=ne.price-this.controlPoints[2].price;this.controlPoints[0].price=this.controlPoints[1].price-ae,this.controlPoints[0].time=ne.time}}}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class DisjointChannelTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",DisjointChannelToolType);Ee(this,"steps",3)}createPrimitive(){return new DisjointChannelPrimitive({id:this.id,points:[],lineColor:"#089981FF",lineWidth:2,lineStyle:LineStyleType.solid,fillBackground:!0,background:"#08998133"},...this.resetArgs)}}const channelDisjointChannel={type:DisjointChannelToolType,icon:icon$1m,Ctor:DisjointChannelTool},icon$1l=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.5 23h13v-1h-13z"></path><path d="M7.55 13.088l13.29-6.254-.426-.905-13.29 6.254z"></path><path d="M5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 15c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FlatTopBottomToolType="tool.channel.flatTopBottom";class FlatTopBottomPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRendererPoints12",new LineRenderer);Ee(this,"_trendLineRendererPoints43",new LineRenderer);Ee(this,"_disjointChannelRenderer",new DisjointChannelRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const[ne,re]=ee,se=this._source.properties();let ae,le;ee.length===3&&(ae=new Point(re.x,ee[2].y),le=new Point(ne.x,ae.y),se.fillBackground&&(this._disjointChannelRenderer.setData({extendleft:se.extendLeft,extendright:se.extendRight,points:[ne,re,ae,le],backcolor:se.backgroundColor,fillBackground:se.fillBackground}),this._renderer.append(this._disjointChannelRenderer)));const ce=(fe,Ae)=>({points:[fe,Ae],lineColor:se.lineColor,lineWidth:se.lineWidth,lineStyle:se.lineStyle,extendLeft:se.extendLeft,extendRight:se.extendRight,leftEnd:se.leftEnd,rightEnd:se.rightEnd});if(this._trendLineRendererPoints12.setData(ce(ne,re)),this._renderer.append(this._trendLineRendererPoints12),ee.length===2){this.addAnchors(this._renderer);return}if(!ae||!le){this.addAnchors(this._renderer);return}this._trendLineRendererPoints43.setData(ce(le,ae)),this._renderer.append(this._trendLineRendererPoints43);const he=[ne,re,new AnchorPoint(ae,{pointIndex:2}),new AnchorPoint(le,{pointIndex:3})];this._model.currentCreating===this._source&&he.pop(),this._renderer.append(this.createLineAnchor({points:he},0))}}class FlatTopBottomPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FlatTopBottomPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){if(ee===2)this.controlPoints[1].time=ne.time;else if(ee===3){this.controlPoints[0].time=ne.time,this.controlPoints[2].price=ne.price;return}super.setPoint(ee,ne,re)}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class FlatTopBottomTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FlatTopBottomToolType);Ee(this,"steps",3)}createPrimitive(){return new FlatTopBottomPrimitive({id:this.id,points:[],lineColor:"#FF9800FF",lineStyle:LineStyleType.solid,lineWidth:2,fillBackground:!0,backgroundColor:"#FF980033",extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},...this.resetArgs)}}const channelFlatTopBottom={type:FlatTopBottomToolType,icon:icon$1l,Ctor:FlatTopBottomTool},icon$1k=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M8.354 18.354l10-10-.707-.707-10 10zM12.354 25.354l5-5-.707-.707-5 5z"></path><path d="M20.354 17.354l5-5-.707-.707-5 5z"></path><path d="M19.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,ParallelChannelToolType="tool.channel.parallelChannel",coeffs=[-.25,0,.25,.5,.75,1,1.25];class ParallelChannelPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_channelRenderers",Array.from({length:coeffs.length-1}).map(()=>new ParallelChannelRenderer));Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<=1)return;const ne=this._source.properties(),re=ee[0],se=ee[1];let ae=0,le=null,ce=null;ee.length===3&&(ae=ee[2].y-ee[0].y,le=re.add(new Point(0,ae)),ce=se.add(new Point(0,ae)));const he=ne.levels.filter(Fe=>Fe.visible);he.length===1&&he.push(he[0]),this._channelRenderers.length!==he.length-1&&(this._channelRenderers=Array.from({length:he.length-1}).map(()=>{const Fe=new ParallelChannelRenderer;return Fe.setHitTest(new HitTestResult(HitTarget.MovePoint)),Fe}));const fe=[],Ae=ne.backgroundColor;for(let Fe=0;Fe<he.length-1;Fe++){const Ne=he[Fe],ze=he[Fe+1];let He=re,We=se,je=re,Ue=se;if(ee.length===3){const Ze=ae*Ne.coeff,Ye=ae*ze.coeff;He=re.add(new Point(0,Ze)),We=se.add(new Point(0,Ze)),je=re.add(new Point(0,Ye)),Ue=se.add(new Point(0,Ye))}const Ge={line1:{color:Ne.lineColor,lineStyle:Ne.lineStyle,lineWidth:Ne.lineWidth,points:[He,We]},line2:je&&Ue?{color:ze.lineColor,lineStyle:ze.lineStyle,lineWidth:ze.lineWidth,points:[je,Ue]}:void 0,skipTopLine:Fe!==he.length-2,extendLeft:ne.extendLeft,extendRight:ne.extendRight,fillBackground:ne.fillBackground,backColor:Ae,hittestOnBackground:!0};fe.push(Ge)}fe.forEach((Fe,Ne)=>{this._channelRenderers[Ne].setData(Fe),this._renderer.append(this._channelRenderers[Ne])});const pe=[];if(re&&pe.push(re),se&&pe.push(se),le&&ce){pe.push(new AnchorPoint(le,{pointIndex:2})),pe.push(new AnchorPoint(ce,{pointIndex:3}));const Fe=le.add(ce).scaled(.5);pe.push(new AnchorPoint(Fe,{pointIndex:4,resizeDirections:AnchorResizeVert,style:AnchorStyle.square}));const Ne=pe[0].point.add(pe[1].point).scaled(.5);pe.push(new AnchorPoint(Ne,{pointIndex:5,resizeDirections:AnchorResizeVert,style:AnchorStyle.square}))}const Oe=ee.length===3&&!le;(this._model.currentCreating===this._source||Oe)&&(pe.pop(),pe.pop()),this._renderer.append(this.createLineAnchor({points:pe},0))}}class ParallelChannelPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ParallelChannelPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){switch(ee){case 0:{super.setPoint(ee,ne,re),this._props.points[2]={time:re.startPoints[2].time+re.deltaTime,price:re.startPoints[2].price+re.deltaPrice};break}case 1:{super.setPoint(ee,ne,re);break}case 2:{super.setPoint(ee,ne,re),this._props.points[0]={time:re.startPoints[0].time+re.deltaTime,price:re.startPoints[0].price+re.deltaPrice};break}case 3:{this._props.points[1]={time:re.startPoints[1].time+re.deltaTime,price:re.startPoints[1].price+re.deltaPrice};break}case 4:{this._props.points[2].price=re.startPoints[2].price+re.deltaPrice;break}case 5:{this._props.points[0].price=re.startPoints[0].price+re.deltaPrice,this._props.points[1].price=re.startPoints[1].price+re.deltaPrice;break}}}addPoint(ee,ne){return ne===2&&(ee=this._convertLastPointTo3rdPoint(ee)),super.addPoint(ee,ne)}_convertLastPointTo3rdPoint(ee){const ne=ensure(this.pointToScreenPoint(ee)),re=ensure(this.pointToScreenPoint(this.controlPoints[1])),se=ensure(this.pointToScreenPoint(this.controlPoints[0])),ae=re.subtract(se),le=(ne.x-se.x)/ae.x,ce=se.addScaled(ae,le),he=ne.y-ce.y,fe=se.add(new Point(0,he));return ensure(this.screenPointToPoint(fe))}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class ParallelChannelTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ParallelChannelToolType);Ee(this,"steps",3)}createPrimitive(){return new ParallelChannelPrimitive({id:this.id,points:[],lineColor:"#2A62FF",lineStyle:LineStyleType.solid,lineWidth:2,fillBackground:!0,backgroundColor:"#2962FF33",extendLeft:!1,extendRight:!1,levels:coeffs.map((ee,ne)=>({lineColor:"#2A62FF",visible:[1,3,5].includes(ne),coeff:ee,lineStyle:ne===3?LineStyleType.dashed:LineStyleType.solid,lineWidth:[1,5].includes(ne)?2:1}))},...this.resetArgs)}}const channelParallelChannel={type:ParallelChannelToolType,icon:icon$1k,Ctor:ParallelChannelTool},icon$1j=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.551 17.98l13.284-7.033-.468-.884-13.284 7.033z"></path><path d="M6 11.801l16-8.471v4.17h1v-5.83l-18 9.529v5.301h1z"></path><path d="M6 24.67v-4.17h-1v5.83l18-9.529v-5.301h-1v4.699z"></path><path d="M5.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,RegressionTrendToolType="tool.channel.regressionTrend";function linearRegression(ie){var te,ee,ne=ie.length;if(ne===1)te=0,ee=ie[0][1];else{for(var re=0,se=0,ae=0,le=0,ce,he,fe,Ae=0;Ae<ne;Ae++)ce=ie[Ae],he=ce[0],fe=ce[1],re+=he,se+=fe,ae+=he*he,le+=he*fe;te=(ne*le-re*se)/(ne*ae-re*re),ee=se/ne-te*re/ne}return{m:te,b:ee}}function sum(ie){if(ie.length===0)return 0;var te=ie[0],ee=0,ne;if(typeof te!="number")return Number.NaN;for(var re=1;re<ie.length;re++){if(typeof ie[re]!="number")return Number.NaN;ne=te+ie[re],Math.abs(te)>=Math.abs(ie[re])?ee+=te-ne+ie[re]:ee+=ie[re]-ne+te,te=ne}return te+ee}function mean(ie){if(ie.length===0)throw new Error("mean requires at least one data point");return sum(ie)/ie.length}function sumNthPowerDeviations(ie,te){var ee=mean(ie),ne=0,re,se;for(se=0;se<ie.length;se++)re=ie[se]-ee,ne+=re*re;return ne}function variance(ie){if(ie.length===0)throw new Error("variance requires at least one data point");return sumNthPowerDeviations(ie)/ie.length}function standardDeviation(ie){if(ie.length===1)return 0;var te=variance(ie);return Math.sqrt(te)}class VerticalLineRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){if(!this._data||!this._hitTest)return null;const ee=interactionTolerance().line,ne=Math.abs(te.x-this._data.x)<=ee+this._data.lineWidth/2,re=this._data.top===void 0||this._data.top-te.y<=ee,se=this._data.bottom===void 0||te.y-this._data.bottom<=ee;return ne&&re&&se?this._hitTest:null}drawImpl(te){if(!this._data||this._data.lineWidth<=0)return;const{context:ee,horizontalPixelRatio:ne,verticalPixelRatio:re,mediaSize:se}=te,ae=this._data.x;if(ae<-this._data.lineWidth/2||ae>se.width+this._data.lineWidth/2)return;ee.lineCap="butt",ee.strokeStyle=this._data.lineColor,ee.lineWidth=Math.max(1,Math.floor(this._data.lineWidth*ne)),this._data.lineStyle!==void 0&&setLineStyle(ee,this._data.lineStyle);const le=this._data.top!==void 0?Math.max(0,this._data.top):0,ce=this._data.bottom!==void 0?Math.min(se.height,this._data.bottom):se.height,he=Math.round(ae*ne),fe=Math.floor(le*re),Ae=Math.ceil(ce*re);this._data.excludeBoundaries!==void 0&&addExclusionAreaByScope(te,this._data.excludeBoundaries),drawVerticalLine(ee,he,fe,Ae)}}const placeholderColor="#808080";class RegressionTrendPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_pearsonsLabelRenderer",new BaseTextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(!(ee!=null&&ee.length))return;const ne=this._buildGraphicData(),re=[ne.lines[1],ne.lines[0],ne.lines[2]].filter(Boolean);if(!re.length){this._renderer.append(...ee.map(le=>new VerticalLineRenderer({x:le.x,lineColor:placeholderColor,lineWidth:1}))),ee.length>1&&this._renderer.append(new LineRenderer({points:ee,lineColor:placeholderColor,lineWidth:1,lineStyle:LineStyleType.solid}));return}const se=this._source.properties().transparency;for(let le=1;le<re.length;le++){const ce=re[le],he=re[le-1],fe={line1:{color:ce.lineColor,lineStyle:ce.lineStyle,lineWidth:ce.lineWidth,points:[ce.points[0],ce.points[1]]},line2:{color:ce.lineColor,lineStyle:ce.lineStyle,lineWidth:ce.lineWidth,points:[he.points[0],he.points[1]]},extendLeft:!1,extendRight:ce.extendRight,backColor:generateColor(ce.lineColor,se),skipLines:!0,fillBackground:!0},Ae=new ParallelChannelRenderer;Ae.setHitTest(new HitTestResult(HitTarget.Regular)),Ae.setData(fe),this._renderer.append(Ae)}const ae=this._getTransparencyResetLines(re);for(let le=0;le<re.length;le++){const ce=new LineRenderer;ce.setData(ae[le]),ce.setHitTest(new HitTestResult(HitTarget.Regular)),this._renderer.append(ce)}ne.pearsons&&(ne.pearsons.color=resetTransparency(ne.pearsons.color),this._pearsonsLabelRenderer.setData(ne.pearsons),this._renderer.append(this._pearsonsLabelRenderer)),this.addAnchors(this._renderer)}_getTransparencyResetLines(ee){return ee.map(ne=>({...ne,lineColor:resetTransparency(ne.lineColor)}))}_buildGraphicData(){const ee={lines:[],pearsons:null},ne=this._source.properties(),re=[this._data.baseLine,this._data.downLine,this._data.upLine].filter(Boolean),se=[ne.baseLine,ne.downLine,ne.upLine];for(let ae=0;ae<re.length;ae++){const le=ensure(re[ae]),ce=se[ae];ee.lines.push({points:le.points,lineColor:ce.color,lineWidth:ce.lineWidth,lineStyle:ce.lineStyle,extendLeft:!1,extendRight:ne.extendLines,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal})}return this._data.pearsons&&ne.showPearsons&&(ee.pearsons={points:[this._data.pearsons.point],text:String(this._data.pearsons.value),color:ne.downLine.color,vertAlign:VerticalAlign.Top,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:4,fontSize:12}),ee}}class RegressionTrendPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"disableExtendTime",!0);Ee(this,"_lines",new RegressionTrendPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_regressionCache",null)}setPoint(ee,ne,re){super.setPoint(ee,ne,re),this._regressionCache=null}_calculateRegression(){const[ee,ne]=this.controlPoints,re=ensure(this.chart.timeScale().timeToIndex(ee.time)),se=ensure(this.chart.timeScale().timeToIndex(ne.time)),ae=Math.min(re,se),le=Math.max(re,se),he=this.series.data().slice(ae,le+1),fe=he.map(Ze=>Ze.customValues.close),Ae=standardDeviation(fe),{m:pe,b:Oe}=linearRegression(he.map((Ze,Ye)=>[Ye,Ze.customValues.close])),Fe=0,Ne=le-ae,ze=pe*Fe+Oe,He=pe*Ne+Oe,We=pe*Fe+Oe+2*Ae,je=pe*Ne+Oe+2*Ae,Ue=pe*Fe+Oe-2*Ae,Ge=pe*Ne+Oe-2*Ae;return{time0:ee.time,time1:ne.time,price0:ze,price1:He,upPrice0:We,upPrice1:je,downPrice0:Ue,downPrice1:Ge}}updateAllViews(){if(!this.controlPoints.length)return;const ee=Object.create(null),[ne,re]=this.controlPoints,se=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le}));if(this.isDrawing||this._currentDragTarget)this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ne.time,se[0].x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ne.price,se[0].y)),re&&(this._timeAxisViews[1].update(this._calculateTimeAxisViewData(re.time,se[1].x)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(re.price,se[1].y)),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(se[1].y,se[1].y)),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(se[0].x,se[1].x))),ee.points=se;else{this._regressionCache||(this._regressionCache=this._calculateRegression());const{time0:ae,time1:le,price0:ce,price1:he,upPrice0:fe,upPrice1:Ae,downPrice0:pe,downPrice1:Oe}=this._regressionCache,Fe=ensure(this.chart.timeScale().timeToCoordinate(ae)),Ne=ensure(this.chart.timeScale().timeToCoordinate(le)),ze=ensure(this.series.priceToCoordinate(ce)),He=ensure(this.series.priceToCoordinate(he)),We=ensure(this.series.priceToCoordinate(fe)),je=ensure(this.series.priceToCoordinate(Ae)),Ue=ensure(this.series.priceToCoordinate(pe)),Ge=ensure(this.series.priceToCoordinate(Oe));this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ae,Fe)),this._timeAxisViews[1].update(this._calculateTimeAxisViewData(le,Ne)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ce,ze)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(he,He)),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(ze,He)),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Fe,Ne));const Ze=[new AnchorPoint(new Point(Fe,ze),{pointIndex:0}),new AnchorPoint(new Point(Ne,He),{pointIndex:1})];ee.baseLine={points:Ze},ee.upLine={points:[new Point(Fe,We),new Point(Ne,je)]},ee.downLine={points:[new Point(Fe,Ue),new Point(Ne,Ge)]},ee.points=Ze}this._lines.update(ee)}}class RegressionTrendTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",RegressionTrendToolType);Ee(this,"steps",2);Ee(this,"disableExtendTime",!0)}createPrimitive(){return new RegressionTrendPrimitive({id:this.id,points:[],baseLine:{color:"#F23645",lineStyle:LineStyleType.dashed,lineWidth:1},upLine:{color:"#2962FF",lineStyle:LineStyleType.solid,lineWidth:2},downLine:{color:"#2962FF",lineStyle:LineStyleType.solid,lineWidth:2},extendLines:!1,showPearsons:!1,transparency:70},...this.resetArgs)}}const channelRegressionTrend={type:RegressionTrendToolType,icon:icon$1j,Ctor:RegressionTrendTool},icon$1i=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M10.5 13a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zm0-1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path><path fill="currentColor" fill-rule="evenodd" d="M6 5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H6zm16 1H6a1 1 0 0 0-1 1v12.06l2.79-2.79A1.5 1.5 0 0 1 9.54 16l2.48 1.29c.18.1.41.06.57-.08l4.23-3.92a1.5 1.5 0 0 1 2.08.04l4.1 4.1V7a1 1 0 0 0-1-1zm1 12.84l-4.8-4.8a.5.5 0 0 0-.7-.02l-4.23 3.92a1.5 1.5 0 0 1-1.71.24l-2.48-1.29a.5.5 0 0 0-.59.1L5 20.46V21a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-2.16z"></path></svg>
`,inputs=new Set;function pickImage(){for(const ie of inputs)ie.remove();return new Promise(ie=>{const te=document.createElement("input");te.type="file",te.accept=".jpg,.jpeg,.png,.webp",Object.assign(te.style,{display:"none"}),document.body.append(te),inputs.add(te),te.addEventListener("change",function(ee){const{files:ne}=ee.target;if(ne.length>0){const re=ne[0];re.size?ie(re):ie(null)}else ie(null);te.remove(),inputs.delete(te)}),setTimeout(()=>{te.click()})})}function fileToImage(ie){return new Promise(te=>{const ee=new Image,ne=URL.createObjectURL(ie);ee.onload=()=>{URL.revokeObjectURL(ne),te(ee)},ee.onerror=()=>{URL.revokeObjectURL(ne),te(null)},ee.src=ne})}function fileToDataURL(ie){return new Promise(te=>{const ee=new FileReader;ee.onload=()=>{te(ee.result)},ee.onerror=()=>{te("")},ee.readAsDataURL(ie)})}/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */function isScrollable(ie){return ie?ie.scrollHeight>ie.offsetHeight:!1}function isScrollAtTop(ie){return ie?ie.scrollTop===0:!1}function isScrollAtBottom(ie){return ie?Math.ceil(ie.scrollHeight-ie.scrollTop)===ie.clientHeight:!1}function areTopsMisaligned(ie){const te=new Set;return[].forEach.call(ie,ee=>te.add(ee.offsetTop)),te.size>1}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var AnimationFrame=function(){function ie(){this.rafIDs=new Map}return ie.prototype.request=function(te,ee){var ne=this;this.cancel(te);var re=requestAnimationFrame(function(se){ne.rafIDs.delete(te),ee(se)});this.rafIDs.set(te,re)},ie.prototype.cancel=function(te){var ee=this.rafIDs.get(te);ee&&(cancelAnimationFrame(ee),this.rafIDs.delete(te))},ie.prototype.cancelAll=function(){var te=this;this.rafIDs.forEach(function(ee,ne){te.cancel(ne)})},ie.prototype.getQueue=function(){var te=[];return this.rafIDs.forEach(function(ee,ne){te.push(ne)}),te},ie}();/**
 * @license
 * Copyright 2016 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */const cssClasses$1={CLOSING:"mdc-dialog--closing",OPEN:"mdc-dialog--open",OPENING:"mdc-dialog--opening",SCROLLABLE:"mdc-dialog--scrollable",SCROLL_LOCK:"mdc-dialog-scroll-lock",STACKED:"mdc-dialog--stacked",FULLSCREEN:"mdc-dialog--fullscreen",SCROLL_DIVIDER_HEADER:"mdc-dialog-scroll-divider-header",SCROLL_DIVIDER_FOOTER:"mdc-dialog-scroll-divider-footer",SURFACE_SCRIM_SHOWN:"mdc-dialog__surface-scrim--shown",SURFACE_SCRIM_SHOWING:"mdc-dialog__surface-scrim--showing",SURFACE_SCRIM_HIDING:"mdc-dialog__surface-scrim--hiding",SCRIM_HIDDEN:"mdc-dialog__scrim--hidden"},strings$2={ACTION_ATTRIBUTE:"data-mdc-dialog-action",BUTTON_DEFAULT_ATTRIBUTE:"data-mdc-dialog-button-default",BUTTON_SELECTOR:".mdc-dialog__button",CLOSED_EVENT:"MDCDialog:closed",CLOSE_ACTION:"close",CLOSING_EVENT:"MDCDialog:closing",CONTAINER_SELECTOR:".mdc-dialog__container",CONTENT_SELECTOR:".mdc-dialog__content",DESTROY_ACTION:"destroy",INITIAL_FOCUS_ATTRIBUTE:"data-mdc-dialog-initial-focus",OPENED_EVENT:"MDCDialog:opened",OPENING_EVENT:"MDCDialog:opening",SCRIM_SELECTOR:".mdc-dialog__scrim",SUPPRESS_DEFAULT_PRESS_SELECTOR:["textarea",".mdc-menu .mdc-list-item",".mdc-menu .mdc-deprecated-list-item"].join(", "),SURFACE_SELECTOR:".mdc-dialog__surface"},numbers$2={DIALOG_ANIMATION_CLOSE_TIME_MS:75,DIALOG_ANIMATION_OPEN_TIME_MS:150};/**
 * @license
 * Copyright 2017 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */class MDCDialogFoundation extends MDCFoundation{constructor(te){super({...MDCDialogFoundation.defaultAdapter,...te}),this.dialogOpen=!1,this.isFullscreen=!1,this.animationFrame=0,this.animationTimer=0,this.escapeKeyAction=strings$2.CLOSE_ACTION,this.scrimClickAction=strings$2.CLOSE_ACTION,this.autoStackButtons=!0,this.areButtonsStacked=!1,this.suppressDefaultPressSelector=strings$2.SUPPRESS_DEFAULT_PRESS_SELECTOR,this.animFrame=new AnimationFrame,this.contentScrollHandler=()=>{this.handleScrollEvent()},this.windowResizeHandler=()=>{this.layout()},this.windowOrientationChangeHandler=()=>{this.layout()}}static get cssClasses(){return cssClasses$1}static get strings(){return strings$2}static get numbers(){return numbers$2}static get defaultAdapter(){return{addBodyClass:()=>{},addClass:()=>{},areButtonsStacked:()=>!1,clickDefaultButton:()=>{},eventTargetMatches:()=>!1,getActionFromEvent:()=>"",getInitialFocusEl:()=>null,hasClass:()=>!1,isContentScrollable:()=>!1,notifyClosed:()=>{},notifyClosing:()=>{},notifyOpened:()=>{},notifyOpening:()=>{},releaseFocus:()=>{},removeBodyClass:()=>{},removeClass:()=>{},reverseButtons:()=>{},trapFocus:()=>{},registerContentEventHandler:()=>{},deregisterContentEventHandler:()=>{},isScrollableContentAtTop:()=>!1,isScrollableContentAtBottom:()=>!1,registerWindowEventHandler:()=>{},deregisterWindowEventHandler:()=>{}}}init(){this.adapter.hasClass(cssClasses$1.STACKED)&&this.setAutoStackButtons(!1),this.isFullscreen=this.adapter.hasClass(cssClasses$1.FULLSCREEN)}destroy(){this.animationTimer&&(clearTimeout(this.animationTimer),this.handleAnimationTimerEnd()),this.isFullscreen&&this.adapter.deregisterContentEventHandler("scroll",this.contentScrollHandler),this.animFrame.cancelAll(),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("orientationchange",this.windowOrientationChangeHandler)}open(te){this.dialogOpen=!0,this.adapter.notifyOpening(),this.adapter.addClass(cssClasses$1.OPENING),this.isFullscreen&&this.adapter.registerContentEventHandler("scroll",this.contentScrollHandler),te&&te.isAboveFullscreenDialog&&this.adapter.addClass(cssClasses$1.SCRIM_HIDDEN),this.adapter.registerWindowEventHandler("resize",this.windowResizeHandler),this.adapter.registerWindowEventHandler("orientationchange",this.windowOrientationChangeHandler),this.runNextAnimationFrame(()=>{this.adapter.addClass(cssClasses$1.OPEN),(!te||!te.isScrimless)&&this.adapter.addBodyClass(cssClasses$1.SCROLL_LOCK),this.layout()})}close(te=""){this.dialogOpen&&(this.dialogOpen=!1,this.adapter.notifyClosing(te),this.adapter.addClass(cssClasses$1.CLOSING),this.adapter.removeClass(cssClasses$1.OPEN),this.adapter.removeBodyClass(cssClasses$1.SCROLL_LOCK),this.isFullscreen&&this.adapter.deregisterContentEventHandler("scroll",this.contentScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("orientationchange",this.windowOrientationChangeHandler),cancelAnimationFrame(this.animationFrame),this.animationFrame=0,clearTimeout(this.animationTimer),this.animationTimer=setTimeout(()=>{this.adapter.releaseFocus(),this.handleAnimationTimerEnd(),this.adapter.notifyClosed(te)},numbers$2.DIALOG_ANIMATION_CLOSE_TIME_MS))}showSurfaceScrim(){this.adapter.addClass(cssClasses$1.SURFACE_SCRIM_SHOWING),this.runNextAnimationFrame(()=>{this.adapter.addClass(cssClasses$1.SURFACE_SCRIM_SHOWN)})}hideSurfaceScrim(){this.adapter.removeClass(cssClasses$1.SURFACE_SCRIM_SHOWN),this.adapter.addClass(cssClasses$1.SURFACE_SCRIM_HIDING)}handleSurfaceScrimTransitionEnd(){this.adapter.removeClass(cssClasses$1.SURFACE_SCRIM_HIDING),this.adapter.removeClass(cssClasses$1.SURFACE_SCRIM_SHOWING)}isOpen(){return this.dialogOpen}getEscapeKeyAction(){return this.escapeKeyAction}setEscapeKeyAction(te){this.escapeKeyAction=te}getScrimClickAction(){return this.scrimClickAction}setScrimClickAction(te){this.scrimClickAction=te}getAutoStackButtons(){return this.autoStackButtons}setAutoStackButtons(te){this.autoStackButtons=te}getSuppressDefaultPressSelector(){return this.suppressDefaultPressSelector}setSuppressDefaultPressSelector(te){this.suppressDefaultPressSelector=te}layout(){this.animFrame.request("poll_layout_change",()=>{this.layoutInternal()})}handleClick(te){if(this.adapter.eventTargetMatches(te.target,strings$2.SCRIM_SELECTOR)&&this.scrimClickAction!=="")this.close(this.scrimClickAction);else{const ne=this.adapter.getActionFromEvent(te);ne&&this.close(ne)}}handleKeydown(te){const ee=te.key==="Enter"||te.keyCode===13;if(!ee||this.adapter.getActionFromEvent(te))return;const re=te.composedPath?te.composedPath()[0]:te.target,se=this.suppressDefaultPressSelector?!this.adapter.eventTargetMatches(re,this.suppressDefaultPressSelector):!0;ee&&se&&this.adapter.clickDefaultButton()}handleDocumentKeydown(te){(te.key==="Escape"||te.keyCode===27)&&this.escapeKeyAction!==""&&this.close(this.escapeKeyAction)}handleScrollEvent(){this.animFrame.request("poll_scroll_position",()=>{this.toggleScrollDividerHeader(),this.toggleScrollDividerFooter()})}layoutInternal(){this.autoStackButtons&&this.detectStackedButtons(),this.toggleScrollableClasses()}handleAnimationTimerEnd(){this.animationTimer=0,this.adapter.removeClass(cssClasses$1.OPENING),this.adapter.removeClass(cssClasses$1.CLOSING)}runNextAnimationFrame(te){cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(()=>{this.animationFrame=0,clearTimeout(this.animationTimer),this.animationTimer=setTimeout(te,0)})}detectStackedButtons(){this.adapter.removeClass(cssClasses$1.STACKED);const te=this.adapter.areButtonsStacked();te&&this.adapter.addClass(cssClasses$1.STACKED),te!==this.areButtonsStacked&&(this.adapter.reverseButtons(),this.areButtonsStacked=te)}toggleScrollableClasses(){this.adapter.removeClass(cssClasses$1.SCROLLABLE),this.adapter.isContentScrollable()&&(this.adapter.addClass(cssClasses$1.SCROLLABLE),this.isFullscreen&&(this.toggleScrollDividerHeader(),this.toggleScrollDividerFooter()))}toggleScrollDividerHeader(){this.adapter.isScrollableContentAtTop()?this.adapter.hasClass(cssClasses$1.SCROLL_DIVIDER_HEADER)&&this.adapter.removeClass(cssClasses$1.SCROLL_DIVIDER_HEADER):this.adapter.addClass(cssClasses$1.SCROLL_DIVIDER_HEADER)}toggleScrollDividerFooter(){this.adapter.isScrollableContentAtBottom()?this.adapter.hasClass(cssClasses$1.SCROLL_DIVIDER_FOOTER)&&this.adapter.removeClass(cssClasses$1.SCROLL_DIVIDER_FOOTER):this.adapter.addClass(cssClasses$1.SCROLL_DIVIDER_FOOTER)}}var root_1$u=from_html('<div class="mdc-dialog__surface-scrim"></div>'),root$v=from_html('<div><div><div><!> <!></div></div> <div class="mdc-dialog__scrim"></div></div> <!>',1);function Dialog(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(or,"$aboveFullscreenShown",ee),{FocusTrap:se}=domFocusTrap,{closest:ae,matches:le}=ponyfill;let ce=prop(te,"use",19,()=>[]),he=prop(te,"class",3,""),fe=prop(te,"open",15,!1),Ae=prop(te,"selection",3,!1),pe=prop(te,"escapeKeyAction",3,"close"),Oe=prop(te,"scrimClickAction",3,"close"),Fe=prop(te,"autoStackButtons",3,!0),Ne=prop(te,"fullscreen",3,!1),ze=prop(te,"sheet",3,!1),He=prop(te,"noContentPadding",3,!1),We=prop(te,"container$class",3,""),je=prop(te,"surface$class",3,""),Ue=rest_props(te,["$$slots","$$events","$$legacy","use","class","open","selection","escapeKeyAction","scrimClickAction","autoStackButtons","fullscreen","sheet","noContentPadding","container$class","surface$class","children","over"]),Ge,Ze=state(void 0),Ye=new SvelteEventManager,qe=proxy({}),nr,ir=writable(!1),tr=getContext("SMUI:dialog:aboveFullscreen"),or=getContext("SMUI:dialog:aboveFullscreenShown")??writable(!1),Jt=getContext("SMUI:addLayoutListener"),rr,lr=[],ur=fr=>(lr.push(fr),()=>{const er=lr.indexOf(fr);er>=0&&lr.splice(er,1)});setContext("SMUI:dialog:actions:reversed",ir),setContext("SMUI:addLayoutListener",ur),setContext("SMUI:dialog:selection",Ae()),setContext("SMUI:dialog:aboveFullscreen",tr||Ne()),setContext("SMUI:dialog:aboveFullscreenShown",or),ze()&&setContext("SMUI:icon-button:context","dialog:sheet"),user_effect(()=>{get$2(Ze)&&get$2(Ze).getEscapeKeyAction()!==pe()&&get$2(Ze).setEscapeKeyAction(pe())}),user_effect(()=>{get$2(Ze)&&get$2(Ze).getScrimClickAction()!==Oe()&&get$2(Ze).setScrimClickAction(Oe())}),user_effect(()=>{get$2(Ze)&&get$2(Ze).getAutoStackButtons()!==Fe()&&get$2(Ze).setAutoStackButtons(Fe())}),user_effect(()=>{Fe()||store_set(ir,!0)}),Jt&&(rr=Jt(zr)),user_effect(()=>{get$2(Ze)&&get$2(Ze).isOpen()!==fe()&&(fe()?get$2(Ze).open({isAboveFullscreenDialog:!!tr}):get$2(Ze).close())});let Sr=re();user_effect(()=>{Ne()&&get$2(Ze)&&Sr!==re()&&(Sr=re(),re()?get$2(Ze).showSurfaceScrim():get$2(Ze).hideSurfaceScrim())}),onMount(()=>(nr=new se(Ge,{initialFocusEl:Or()??void 0}),set(Ze,new MDCDialogFoundation({addBodyClass:fr=>document.body.classList.add(fr),addClass:Pr,areButtonsStacked:()=>areTopsMisaligned(Er()),clickDefaultButton:()=>{const fr=dr();fr&&fr.click()},eventTargetMatches:(fr,er)=>fr?le(fr,er):!1,getActionFromEvent:fr=>{if(!fr.target)return"";const er=ae(fr.target,"[data-mdc-dialog-action]");return er&&er.getAttribute("data-mdc-dialog-action")},getInitialFocusEl:Or,hasClass:xr,isContentScrollable:()=>isScrollable(Cr()),notifyClosed:fr=>{fe(!1),dispatch(Fr(),"SMUIDialogClosed",fr?{action:fr}:{})},notifyClosing:fr=>dispatch(Fr(),"SMUIDialogClosing",fr?{action:fr}:{}),notifyOpened:()=>dispatch(Fr(),"SMUIDialogOpened",{}),notifyOpening:()=>dispatch(Fr(),"SMUIDialogOpening",{}),releaseFocus:()=>nr.releaseFocus(),removeBodyClass:fr=>document.body.classList.remove(fr),removeClass:mr,reverseButtons:()=>{store_set(ir,!0)},trapFocus:()=>nr.trapFocus(),registerContentEventHandler:(fr,er)=>{const Tr=Cr();Tr instanceof HTMLElement&&Ye.on(Tr,fr,er)},deregisterContentEventHandler:(fr,er)=>{const Tr=Cr();Tr instanceof HTMLElement&&Ye.off(Tr,fr,er)},isScrollableContentAtTop:()=>isScrollAtTop(Cr()),isScrollableContentAtBottom:()=>isScrollAtBottom(Cr()),registerWindowEventHandler:(fr,er)=>Ye.on(window,fr,er),deregisterWindowEventHandler:(fr,er)=>Ye.off(window,fr,er)}),!0),get$2(Ze).init(),()=>{var fr;(fr=get$2(Ze))==null||fr.destroy(),Ye.clear()})),onMount(()=>{const fr=to=>get$2(Ze)&&get$2(Ze).handleDocumentKeydown(to);document.body.addEventListener("keydown",fr);const er=()=>fe()&&get$2(Ze)&&get$2(Ze).layout();window.addEventListener("resize",er);const Tr=()=>fe()&&get$2(Ze)&&get$2(Ze).layout();return window.addEventListener("orientationchange",Tr),()=>{document.body.removeEventListener("keydown",fr),window.removeEventListener("resize",er),window.removeEventListener("orientationchange",Tr)}}),onDestroy(()=>{rr&&rr()});function xr(fr){return fr in qe?qe[fr]:Fr().classList.contains(fr)}function Pr(fr){qe[fr]||(qe[fr]=!0)}function mr(fr){(!(fr in qe)||qe[fr])&&(qe[fr]=!1)}function Er(){return[].slice.call(Fr().querySelectorAll(".mdc-dialog__button"))}function dr(){return Fr().querySelector("[data-mdc-dialog-button-default]")}function Cr(){return Fr().querySelector(".mdc-dialog__content")}function Or(){return Fr().querySelector("[data-mdc-dialog-initial-focus]")}function Ar(){tr&&store_set(or,!0),requestAnimationFrame(()=>{lr.forEach(fr=>fr())})}function Ir(){lr.forEach(fr=>fr())}function wr(){tr&&store_set(or,!1)}function Dr(){return fe()}function Ur(fr){fe(fr)}function zr(){var fr;return(fr=get$2(Ze))==null?void 0:fr.layout()}function Fr(){return Ge}var Jr=root$v(),po=first_child(Jr),so=fr=>{var er;Ar(),(er=te.onSMUIDialogOpening)==null||er.call(te,fr)},ho=fr=>{var er;Ir(),(er=te.onSMUIDialogOpened)==null||er.call(te,fr)},Lo=fr=>{var er;wr(),(er=te.onSMUIDialogClosed)==null||er.call(te,fr)},bo=fr=>{var er;get$2(Ze)&&get$2(Ze).handleClick(fr),(er=te.onclick)==null||er.call(te,fr)},Uo=fr=>{var er;get$2(Ze)&&get$2(Ze).handleKeydown(fr),(er=te.onkeydown)==null||er.call(te,fr)};attribute_effect(po,(fr,er)=>({class:fr,role:"alertdialog","aria-modal":"true",...er,onSMUIDialogOpening:so,onSMUIDialogOpened:ho,onSMUIDialogClosed:Lo,onclick:bo,onkeydown:Uo}),[()=>classMap({[he()]:!0,"mdc-dialog":!0,"mdc-dialog--stacked":!Fe(),"mdc-dialog--fullscreen":Ne(),"mdc-dialog--sheet":ze(),"mdc-dialog--no-content-padding":He(),"smui-dialog--selection":Ae(),...qe}),()=>exclude(Ue,["container$","surface$"])]);var Br=child(po);attribute_effect(Br,(fr,er)=>({class:fr,...er}),[()=>classMap({[We()]:!0,"mdc-dialog__container":!0}),()=>prefixFilter(Ue,"container$")]);var Vr=child(Br);attribute_effect(Vr,(fr,er)=>({class:fr,role:"alertdialog","aria-modal":"true",...er}),[()=>classMap({[je()]:!0,"mdc-dialog__surface":!0}),()=>prefixFilter(Ue,"surface$")]);var Yr=child(Vr);snippet(Yr,()=>te.children??noop$1);var Zr=sibling(Yr,2);{var uo=fr=>{var er=root_1$u();event("transitionend",er,()=>get$2(Ze)&&get$2(Ze).handleSurfaceScrimTransitionEnd()),append(fr,er)};if_block(Zr,fr=>{Ne()&&fr(uo)})}bind_this(po,fr=>Ge=fr,()=>Ge),action(po,(fr,er)=>useActions==null?void 0:useActions(fr,er),ce);var ro=sibling(po,2);snippet(ro,()=>te.over??noop$1),append(ie,Jr);var Rr=pop({isOpen:Dr,setOpen:Ur,layout:zr,getElement:Fr});return ne(),Rr}function ClassAdder(ie,te){push(te,!0);let ee=prop(te,"use",19,()=>[]),ne=prop(te,"class",3,""),re=prop(te,"component",3,SmuiElement),se=prop(te,"tag",3,"div"),ae=prop(te,"_smuiClass",3,""),le=prop(te,"_smuiClassMap",23,()=>({})),ce=prop(te,"_smuiContexts",19,()=>({})),he=prop(te,"_smuiProps",19,()=>({})),fe=rest_props(te,["$$slots","$$events","$$legacy","use","class","component","tag","_smuiClass","_smuiClassMap","_smuiContexts","_smuiProps","children"]),Ae;const pe=[];Object.entries(le()).forEach(([ze,He])=>{const We=getContext(He);We&&"subscribe"in We&&pe.push(We.subscribe(je=>{le()[ze]=je}))});for(let ze in ce())ce().hasOwnProperty(ze)&&setContext(ze,ce()[ze]);onDestroy(()=>{for(const ze of pe)ze()});function Oe(){return Ae.getElement()}var Fe=comment(),Ne=first_child(Fe);{let ze=user_derived(()=>classMap({[ne()]:!0,[ae()]:!0,...le()}));component(Ne,re,(He,We)=>{bind_this(We(He,spread_props({get tag(){return se()},get use(){return ee()},get class(){return get$2(ze)}},he,()=>fe,{children:(je,Ue)=>{var Ge=comment(),Ze=first_child(Ge);snippet(Ze,()=>te.children??noop$1),append(je,Ge)},$$slots:{default:!0}})),je=>Ae=je,()=>Ae)})}return append(ie,Fe),pop({getElement:Oe})}function Title(ie,te){push(te,!0);let ee=rest_props(te,["$$slots","$$events","$$legacy","children"]),ne;function re(){return ne.getElement()}return bind_this(ClassAdder(ie,spread_props({_smuiClass:"mdc-dialog__title",tag:"h2"},()=>ee,{children:(se,ae)=>{var le=comment(),ce=first_child(le);snippet(ce,()=>te.children??noop$1),append(se,le)},$$slots:{default:!0}})),se=>ne=se,()=>ne),pop({getElement:re})}function Content(ie,te){push(te,!0);let ee=rest_props(te,["$$slots","$$events","$$legacy","children"]),ne;function re(){return ne.getElement()}return bind_this(ClassAdder(ie,spread_props({_smuiClass:"mdc-dialog__content",tag:"div"},()=>ee,{children:(se,ae)=>{var le=comment(),ce=first_child(le);snippet(ce,()=>te.children??noop$1),append(se,le)},$$slots:{default:!0}})),se=>ne=se,()=>ne),pop({getElement:re})}var root$u=from_html("<button><!></button>");function Button(ie,te){push(te,!0);const ee=rest_props(te,["$$slots","$$events","$$legacy"]),{btnType:ne,...re}=ee;var se=root$u();attribute_effect(se,le=>({class:le,...re}),[()=>clsx$1("button",ne)],void 0,"svelte-25z81x");var ae=child(se);snippet(ae,()=>re.children??noop$1),append(ie,se),pop()}var root$t=from_html('<div class="dialog-footer svelte-1a2g0d7"><!> <!></div>');function DialogFooter(ie,te){push(te,!0);var ee=root$t(),ne=child(ee);Button(ne,{btnType:"secondary",onpointerup:()=>{var se;return(se=te.onCancel)==null?void 0:se.call(te)},children:(se,ae)=>{var le=text();template_effect(()=>set_text(le,te.cancelButtonText)),append(se,le)},$$slots:{default:!0}});var re=sibling(ne,2);Button(re,{btnType:"primary",onpointerup:()=>{var se;return(se=te.onConfirm)==null?void 0:se.call(te)},children:(se,ae)=>{var le=text();template_effect(()=>set_text(le,te.mainButtonText)),append(se,le)},$$slots:{default:!0}}),append(ie,ee),pop()}const handleClose=(ie,te,ee)=>{var re;const ne=new KeyboardEvent("keydown",{key:"Escape",code:"Escape",which:27,bubbles:!0,cancelable:!0});document.body.dispatchEvent(ne),(re=ee.handleClose)==null||re.call(ee)};var root_1$t=from_html('<div class="titleText svelte-1cp2oja"> </div> <button class="titleClose svelte-1cp2oja"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17" fill="currentColor"><path d="m.58 1.42.82-.82 15 15-.82.82z"></path><path d="m.58 15.58 15-15 .82.82-15 15z"></path></svg></button>',1);function DialogTitle(ie,te){push(te,!0);const ee=rest_props(te,["$$slots","$$events","$$legacy"]);{let ne=user_derived(()=>clsx$1("cl-title-block",te.noBorder&&"cl-title-block__no-border"));Title(ie,{get class(){return get$2(ne)},children:(re,se)=>{var ae=root_1$t(),le=first_child(ae),ce=child(le),he=sibling(le,2);he.__pointerup=[handleClose,ee,te],template_effect(()=>set_text(ce,te.title)),append(re,ae)},$$slots:{default:!0}})}pop()}delegate(["pointerup"]);const handleClick=async(ie,te)=>{const ee=await pickImage();ee&&set(te,await fileToDataURL(ee),!0)};var root_3$j=from_html('<img class="img svelte-1k3ap48" alt=""/>'),root_4$c=from_html('<div class="texts svelte-1k3ap48"><div class="headline svelte-1k3ap48"> </div> <div> </div> <div> </div></div>'),root_2$i=from_html('<div class="drop-zone svelte-1k3ap48"><!></div>'),root_1$s=from_html("<!> <!> <!>",1);function Dialog_1(ie,te){push(te,!0);const{t:ee}=useTranslation();let ne=state(!0),re,se=state("");const ae=()=>{set(ne,!1),te.onClose()},le=()=>{set(ne,!1),te.onClose(re)};Dialog(ie,{get open(){return get$2(ne)},onSMUIDialogClosed:ae,children:(ce,he)=>{var fe=root_1$s(),Ae=first_child(fe);{let Fe=user_derived(()=>ee("tool.image.dialog.title"));DialogTitle(Ae,{get title(){return get$2(Fe)},noBorder:!0})}var pe=sibling(Ae,2);Content(pe,{children:(Fe,Ne)=>{var ze=root_2$i();ze.__click=[handleClick,se];var He=child(ze);{var We=Ue=>{var Ge=root_3$j();template_effect(()=>set_attribute(Ge,"src",get$2(se))),append(Ue,Ge)},je=Ue=>{var Ge=root_4$c(),Ze=child(Ge),Ye=child(Ze),qe=sibling(Ze,2),nr=child(qe),ir=sibling(qe,2),tr=child(ir);template_effect((or,Jt,rr)=>{set_text(Ye,or),set_text(nr,Jt),set_text(tr,rr)},[()=>ee("tool.image.dialog.choose"),()=>ee("tool.image.dialog.imageTypes"),()=>ee("tool.image.dialog.sizeLimit")]),append(Ue,Ge)};if_block(He,Ue=>{get$2(se)?Ue(We):Ue(je,!1)})}append(Fe,ze)},$$slots:{default:!0}});var Oe=sibling(pe,2);{let Fe=user_derived(()=>ee("common.ok")),Ne=user_derived(()=>ee("common.cancel"));DialogFooter(Oe,{get mainButtonText(){return get$2(Fe)},get cancelButtonText(){return get$2(Ne)},onConfirm:le,onCancel:ae})}append(ce,fe)},$$slots:{default:!0}}),pop()}delegate(["click"]);class ImageRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(!this._data)return null;const{point:ee,cssWidth:ne,cssHeight:re}=this._data,se=new Point(ee.x,ee.y),ae=new Point(ee.x+ne,ee.y+re),le=box(se,ae);return pointInBox$1(te,le)?new HitTestResult(HitTarget.MovePoint):null}drawImpl(te){if(!this._data)return;const{angle:ee,img:ne,point:re,cssWidth:se,cssHeight:ae}=this._data,le=te.context;Math.abs(ee)<1e-4?le.drawImage(ne,re.x,re.y,se,ae):(le.translate(re.x,re.y),le.rotate(ee),le.drawImage(ne,0,0,se,ae))}}class ImagePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_imageRenderer",new ImageRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();if(!ee.image)return;const ne=this._calculateBox();ne&&(this._imageRenderer.setData({point:ne[0],img:this._data.imageElement,cssWidth:ee.cssWidth,cssHeight:ee.cssHeight,angle:0}),this._renderer.append(this._imageRenderer),this._addAnchors())}_addAnchors(){const ee=this._calculateBox();if(ee===void 0)return;const[ne,re]=ee,se=[new AnchorPoint(new Point(ne.x+1,ne.y+1),{pointIndex:0,cursorType:PaneCursor.nwse}),new AnchorPoint(new Point(re.x-1,ne.y+1),{pointIndex:0,cursorType:PaneCursor.nesw}),new AnchorPoint(new Point(ne.x+1,re.y-1),{pointIndex:2,cursorType:PaneCursor.nesw}),new AnchorPoint(new Point(re.x-1,re.y-1),{pointIndex:3,cursorType:PaneCursor.nwse})];this._renderer.append(this.createLineAnchor({points:se},0))}_calculateBox(){const ee=this._source.properties(),ne=ee.cssWidth,re=ee.cssHeight,[se]=this.points();if(!se)return;const ae=ne/2,le=re/2,ce=new Point(se.x-ae,se.y-le),he=new Point(se.x+ae,se.y+le);return[ce,he]}}class ImagePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_image",new ImagePaneView(this,this.model));Ee(this,"_paneView",[this._image]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_promise")}updateAllViews(){if(!this.controlPoints.length)return;if(!this._promise){this.loadImage();return}const ee=this._promise.value;if(!ee)return;const[ne]=this.controlPoints,re=new AnchorPoint(this.pointToScreenPoint(ne));this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ne.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ne.price,re.y)),this._image.update({points:[re],imageElement:ee})}loadImage(){const ee=new DeferredPromise;return fileToImage(this._props.image).then(ne=>{ee.complete(ne)}),this._promise=ee,ee.p}setPoint(ee,ne,re){var fe;const se=ensure((fe=this._promise)==null?void 0:fe.value),ae=this.pointToScreenPoint(this.controlPoints[0]),le=se.naturalWidth/se.naturalHeight,ce=Math.abs(ae.x-re.screenPoint.x),he=Math.round(ce*2);this._props.cssWidth=he,this._props.cssHeight=he/le}fitSize(){var Ne;if(this._props.cssWidth&&this._props.cssHeight)return;const ee=ensure((Ne=this._promise)==null?void 0:Ne.value),ne=this.getScope(),{width:re,height:se}=ne.mediaSize,ae=re/4,le=se/4,ce=ee.naturalWidth,he=ee.naturalHeight,fe=Math.min(1,ae/ce),Ae=Math.min(1,le/he),pe=Math.min(fe,Ae),Oe=Math.round(pe*ce),Fe=Math.round(pe*he);this.updateProps({cssWidth:Oe,cssHeight:Fe})}}var __getOwnPropDesc$8=Object.getOwnPropertyDescriptor,__decorateClass$8=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$8(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$7=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let ImageTool=class extends DrawingTool{constructor(te,ee,ne){super();Ee(this,"type",ImageToolType);Ee(this,"steps",0);Ee(this,"canGoBackward",!1);Ee(this,"image");this.guiService=te,this.toolService=ee,this.chartManagementService=ne}activated(){const te=this.guiService.showComponent({Component:Dialog_1,props:{onClose:async ee=>{this.canGoBackward=!0,te.dispose(),ee&&this.onImage(ee),this.toolService.switchBack()}}})}async onImage(te){this.image=te;const ee=this.chartManagementService.activeChart();this._startCreationOnChart(ee,0,!1);const ne=ee.mainSeriesWrapper.getSeries(),re=ee.chart.timeScale().width(),se=ne.getPane().getHeight(),ae=re/2,le=se/2,ce=ensure(ee.chart.timeScale().coordinateToTimeEx(ae)),he=ensure(ee.mainSeriesWrapper.getSeries().coordinateToPrice(le)),fe=this.createPrimitive();fe.attach(ne),await fe.loadImage(),fe.addPoint({time:ce,price:he},0),fe.fitSize(),ensure(ee.getContribution(DrawingContribId)).attachPrimitive(fe,!0)}processEvent(){}createPrimitive(){var te;return new ImagePrimitive({id:this.id,points:[],image:ensure(this.image||((te=this.presetProps)==null?void 0:te.image)),cssWidth:0,cssHeight:0},...this.resetArgs)}canKeepDrawing(){return!1}};ImageTool=__decorateClass$8([__decorateParam$7(0,IGuiService),__decorateParam$7(1,IToolService),__decorateParam$7(2,IChartManagementService)],ImageTool);class PasteImageTool extends ImageTool{activated(){}}const contentImage={type:ImageToolType,icon:icon$1i,Ctor:ImageTool};var __getOwnPropDesc$7=Object.getOwnPropertyDescriptor,__decorateClass$7=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$7(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$6=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let CursorTool=class extends BaseTool{constructor(te,ee){super();Ee(this,"canGoBackward",!1);Ee(this,"fallbackable",!0);this._chartManagementService=te,this._toolService=ee}processEvent(){}};CursorTool=__decorateClass$7([__decorateParam$6(0,IChartManagementService),__decorateParam$6(1,IToolService)],CursorTool);const icon$1h=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M11.682 16.09l3.504 6.068 1.732-1-3.497-6.057 3.595-2.1L8 7.74v10.512l3.682-2.163zm-.362 1.372L7 20V6l12 7-4.216 2.462 3.5 6.062-3.464 2-3.5-6.062z"></path></svg>
`,ToolType$3="tool.cursor.arrow";class CursorArrowTool extends CursorTool{get type(){return ToolType$3}activated(){this._chartManagementService.setPaneCursor(PaneCursor.arrow,!0),this.deactivate()}}const cursorArrow={type:ToolType$3,icon:icon$1h,Ctor:CursorArrowTool},icon$1g=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path d="M18 15h8v-1h-8z"></path><path d="M14 18v8h1v-8zM14 3v8h1v-8zM3 15h8v-1h-8z"></path></g></svg>
`,CursorCrossToolType="tool.cursor.cross";class CursorCrossTool extends CursorTool{get type(){return CursorCrossToolType}activated(){this._chartManagementService.setPaneCursor(PaneCursor.cross,!0),this.deactivate()}}const cursorCross={type:CursorCrossToolType,icon:icon$1g,Ctor:CursorCrossTool},icon$1f=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path d="m11.26 21 3.65-4.78 6.09-.66L10 8zm3.09-5.71-2.33 3.05-.8-8.3 7.02 4.82z"></path><path fill-rule="evenodd" d="M25 14a11 11 0 1 1-22 0 11 11 0 0 1 22 0m-1 0a10 10 0 1 1-20 0 10 10 0 0 1 20 0"></path></svg>
`,ToolType$2="tool.cursor.demo";class CursorDemoTool extends CursorTool{get type(){return ToolType$2}activated(){this._chartManagementService.setPaneCursor(PaneCursor.demonstration,!0),this.deactivate()}}const cursorDemo={type:ToolType$2,icon:icon$1f,Ctor:CursorDemoTool},icon$1e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><circle fill="currentColor" cx="14" cy="14" r="3"></circle></svg>
`,ToolType$1="tool.cursor.dot";class CursorDotTool extends CursorTool{get type(){return ToolType$1}activated(){this._chartManagementService.setPaneCursor(PaneCursor.dot,!0),this.deactivate()}}const cursorDot={type:ToolType$1,icon:icon$1e,Ctor:CursorDotTool},icon$1d=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 31" width="29" height="31"><g fill="currentColor" fill-rule="nonzero"><path d="M15.3 22l8.187-8.187c.394-.394.395-1.028.004-1.418l-4.243-4.243c-.394-.394-1.019-.395-1.407-.006l-11.325 11.325c-.383.383-.383 1.018.007 1.407l1.121 1.121h7.656zm-9.484-.414c-.781-.781-.779-2.049-.007-2.821l11.325-11.325c.777-.777 2.035-.78 2.821.006l4.243 4.243c.781.781.78 2.048-.004 2.832l-8.48 8.48h-8.484l-1.414-1.414z"></path><path d="M13.011 22.999h7.999v-1h-7.999zM13.501 11.294l6.717 6.717.707-.707-6.717-6.717z"></path></g></svg>
`,ToolType="tool.cursor.eraser";class CursorEraserTool extends CursorTool{constructor(){super(...arguments);Ee(this,"canGoBackward",!0);Ee(this,"fallbackable",!1)}get type(){return ToolType}activated(){this._chartManagementService.setPaneCursor(PaneCursor.eraser,!0),this.deactivate()}}const cursorEraser={type:ToolType,icon:icon$1d,Ctor:CursorEraserTool},icon$1c=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M23 4v21h1v-21z"></path><path d="M17 4v21h1v-21z"></path><path d="M5 16.5v8.5h1v-8.5z"></path><path d="M5 4v8.5h1v-8.5z"></path><path d="M5.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path d="M11 16.5v8.5h1v-8.5z"></path><path d="M11 4v8.5h1v-8.5z"></path><path d="M11.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,CyclicLinesToolType="tool.cycle.cyclicLines";class CyclicLinesPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_trendRenderer",new LineRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re={points:ee,lineColor:"#808080",lineWidth:1,lineStyle:LineStyleType.dashed,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendRenderer.setData(re),this._renderer.append(this._trendRenderer);for(let se=0;se<this._data.coordinates.length;se++){const le={x:this._data.coordinates[se],lineColor:ne.lineColor,lineWidth:ne.lineWidth,lineStyle:ne.lineStyle},ce=new VerticalLineRenderer;ce.setData(le),this._renderer.append(ce)}ee.length===2?this._renderer.append(this.createLineAnchor({points:ee},0)):this._renderer.append(this.createLineAnchor({points:ee},1))}}class CyclicLinesPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new CyclicLinesPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((pe,Oe)=>new AnchorPoint(this.pointToScreenPoint(pe),{pointIndex:Oe})),ne=ee.map(pe=>pe.x),re=ee.map(pe=>pe.y);this.controlPoints.forEach((pe,Oe)=>{this._timeAxisViews[Oe].update(this._calculateTimeAxisViewData(pe.time,ee[Oe].x)),this._priceAxisViews[Oe].update(this._calculatePriceAxisViewData(pe.price,ee[Oe].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se={points:ee,coordinates:[]},ae=this.controlPoints[0],le=this.controlPoints[1],ce=ensure(this.chart.timeScale().timeToIndexEx(ae.time)),he=le?this.chart.timeScale().timeToIndexEx(le.time):null,fe=le?ensure(he)-ce:1;if(fe===0)return;const Ae=this.chart.timeScale().getVisibleLogicalRange();if(Ae!==null){if(fe>0)for(let pe=ce;pe<=Ae.to;pe+=fe)se.coordinates.push(ensure(this.chart.timeScale().logicalToCoordinate(pe)));else for(let pe=ce;pe>=Ae.from;pe+=fe)se.coordinates.push(ensure(this.chart.timeScale().logicalToCoordinate(pe)));this._lines.update(se)}}}class CyclicLinesTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",CyclicLinesToolType);Ee(this,"steps",2)}createPrimitive(){return new CyclicLinesPrimitive({id:this.id,points:[],lineColor:"#80CCDBFF",lineWidth:2,lineStyle:LineStyleType.solid},...this.resetArgs)}}const CycleCyclicLines={type:CyclicLinesToolType,icon:icon$1c,Ctor:CyclicLinesTool},icon$1b=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M5.205 14.111l-.013-.172c-.054-.906.022-1.966.327-2.961.395-1.289 1.111-2.215 2.221-2.666l-.377-.926c-1.42.578-2.324 1.746-2.8 3.3-.346 1.128-.429 2.299-.369 3.313l.017.219.994-.106z"></path><path d="M11.051 8.554c1.12.893 1.766 2.343 2.973 6.099 1.274 3.963 1.947 5.48 3.28 6.557l.629-.778c-1.112-.899-1.754-2.345-2.956-6.085-1.28-3.982-1.957-5.503-3.302-6.575l-.623.782z"></path><path d="M21.722 21.558c1.439-.634 2.428-1.886 3.046-3.551.311-.836.509-1.726.618-2.616.066-.539.088-.967.088-1.227l-1 .002-.01.304c-.012.241-.035.51-.071.798-.101.818-.282 1.634-.563 2.39-.533 1.434-1.354 2.474-2.512 2.985l.403.915z"></path><path d="M9.5 9c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM19.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,SineLineToolType="tool.cycle.sineLine";class SineWaveRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(!this._data)return null;const ne=(te.x-this._data.point.x)*Math.PI/this._data.width,re=Math.sin(ne-Math.PI/2)*(this._data.height/2),se=this._data.point.y+re+this._data.height/2;return Math.abs(se-te.y)<=3?new HitTestResult(HitTarget.MovePoint):null}drawImpl(te){if(!this._data)return;const ee=te.context;ee.strokeStyle=this._data.color,ee.lineWidth=this._data.lineWidth,setLineStyle(ee,this._data.lineStyle),ee.beginPath(),ee.moveTo(this._data.point.x,this._data.point.y);const ne=Math.max(1,this._data.width/30),re=te.mediaSize.width-this._data.point.x+ne;for(let se=1;se<=re;se+=ne){const ae=se*Math.PI/this._data.width,le=Math.sin(ae-Math.PI/2)*(this._data.height/2),ce=this._data.point.x+se,he=this._data.point.y+le+this._data.height/2;ee.lineTo(ce,he)}ee.stroke()}}class SineLinePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.getScope().mediaSize.height,[re,se]=ee;if(2*Math.abs(re.x-se.x)===0){this.addAnchors(this._renderer);return}const[ae,le]=ee,ce=Math.abs(ae.x-le.x),he=le.y-ae.y,fe=this._source.properties(),Ae=fe.lineWidth,pe=ae.y<-Ae&&le.y<-Ae,Oe=ae.y>ne+Ae&&le.y>ne+Ae;if(pe||Oe)return;const Fe=2*ce,Ne=ae.x>0?ae.x-Math.ceil(ae.x/Fe)*Fe:ae.x+Math.floor(-ae.x/Fe)*Fe,ze={point:new Point(Ne,ae.y),width:ce,height:he,color:fe.lineColor,lineWidth:Ae,lineStyle:fe.lineStyle};this._renderer.append(new SineWaveRenderer(ze)),this.addAnchors(this._renderer)}}class SineLinePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new SineLinePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class SineLineTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",SineLineToolType);Ee(this,"steps",2)}createPrimitive(){return new SineLinePrimitive({id:this.id,points:[],lineColor:"#159980FF",lineWidth:2,lineStyle:LineStyleType.solid},...this.resetArgs)}}const CycleSineLine={type:SineLineToolType,icon:icon$1b,Ctor:SineLineTool},icon$1a=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M27.186 9.411c-.691-.27-1.429-.411-2.186-.411-3.314 0-6 2.686-6 6h1c0-2.761 2.239-5 5-5 .632 0 1.246.117 1.821.342l.364-.931z"></path><path fill-rule="nonzero" d="M9 15c0-3.314-2.686-6-6-6-.754 0-1.489.139-2.177.407l.363.932c.573-.223 1.185-.339 1.814-.339 2.761 0 5 2.239 5 5h1z"></path><path d="M8 15h1v1h-1v-1zm11 0h1v1h-1v-1zm1 0h-1c0-2.761-2.239-5-5-5s-5 2.239-5 5h-1c0-3.314 2.686-6 6-6s6 2.686 6 6z"></path><path fill-rule="nonzero" d="M8.5 19c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM19.5 19c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,TimeCyclesToolType="tool.cycle.timeCycles";let ArcRenderer$2=class extends MediaCoordinatesPaneRenderer{hitTest(te){if(this._data===null)return null;const{point:ee,width:ne,height:re}=this._data;if(te.y>ee.y||te.x<ee.x||te.x>ee.x+ne)return null;const se=new Point(ee.x+ne/2,ee.y);let ae=te.subtract(se);const le=re/ne;ae=new Point(ae.x,ae.y/le);const ce=ae.length(),he=ne/2;return Math.abs(ce-he)<3?new HitTestResult(HitTarget.MovePoint):null}drawImpl(te){if(this._data===null)return;const ee=te.context;ee.strokeStyle=this._data.color,ee.lineWidth=this._data.linewidth,setLineStyle(ee,this._data.linestyle),ee.save(),ee.translate(this._data.point.x+1,this._data.point.y),ee.scale(this._data.width,this._data.height),ee.beginPath(),ee.arc(.5,0,.5,Math.PI,0,!1),ee.restore(),ee.stroke(),this._data.fillBackground&&(ee.fillStyle=this._data.backcolor,ee.fill())}};class TimeCyclesPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties();for(let re=0;re<this._data.xPositions.length;re++){const se={point:new Point(this._data.xPositions[re],this._data.baseY),width:this._data.boxWidth,height:this._data.boxWidth,color:ne.lineColor,linewidth:ne.lineWidth,linestyle:ne.lineStyle,fillBackground:ne.fillBackground,backcolor:ne.background},ae=new ArcRenderer$2(se);this._renderer.append(ae)}this.addAnchors(this._renderer)}}class TimeCyclesPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new TimeCyclesPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}addPoint(ee,ne){return ne===1&&(ee.price=this.controlPoints[0].price),super.addPoint(ee,ne)}setPoint(ee,ne,re){super.setPoint(ee,ne,re),this.controlPoints.forEach(se=>se.price=ne.price)}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ze,He)=>new AnchorPoint(this.pointToScreenPoint(ze),{pointIndex:He})),ne=ee.map(ze=>ze.x);this.controlPoints.forEach((ze,He)=>{this._timeAxisViews[He].update(this._calculateTimeAxisViewData(ze.time,ee[He].x)),this._priceAxisViews[He].update(this._calculatePriceAxisViewData(ze.price,ee[He].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne)));const re=ensure(this.chart.timeScale().timeToIndexEx(this.controlPoints[0].time)),se=ensure(this.chart.timeScale().timeToIndexEx(this.controlPoints[1].time)),ae=Math.min(re,se),le=Math.max(re,se),ce=le-ae;if(ce===0)return;const he=ee[0],fe=ee[1],Ae=Math.abs(he.x-fe.x),pe=he.y;let Oe=Math.min(he.x,fe.x);const Fe=[];for(let ze=ae;Oe>-Ae;ze-=ce)Oe=ensure(this.chart.timeScale().logicalToCoordinate(ze)),Fe.push(Oe);let Ne=Math.max(he.x,fe.x);for(let ze=le;Ne<this.chart.timeScale().width();ze+=ce)Ne=ensure(this.chart.timeScale().logicalToCoordinate(ze)),Fe.push(Ne);this._lines.update({points:ee,boxWidth:Ae,baseY:pe,xPositions:Fe})}}class TimeCyclesTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",TimeCyclesToolType);Ee(this,"steps",2)}createPrimitive(){return new TimeCyclesPrimitive({id:this.id,points:[],lineColor:"#159980FF",background:"#6AA84F7F",fillBackground:!0,lineWidth:2,lineStyle:LineStyleType.solid},...this.resetArgs)}}const CycleTimeCycles={type:TimeCyclesToolType,icon:icon$1a,Ctor:TimeCyclesTool},icon$19=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.463 12.026l13.537-7.167-.468-.884-13.537 7.167z"></path><path d="M22.708 16.824l-17.884 9.468.468.884 17.884-9.468z"></path><path d="M22.708 9.824l-15.839 8.386.468.884 15.839-8.386z"></path><path d="M5.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 5c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibChannelToolType="tool.fib.fibChannel";var __defProp=Object.defineProperty,__getOwnPropDesc$6=Object.getOwnPropertyDescriptor,__decorateClass$6=(ie,te,ee,ne)=>{for(var re=__getOwnPropDesc$6(te,ee),se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(te,ee,re)||re);return re&&__defProp(te,ee,re),re};class FibWIthLabelsPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_labelsRenderers",new Map);Ee(this,"_textRenderers",new Map);Ee(this,"_levelLineRenderers",new Map)}get _percentageFormatter(){return getPercentageFormatter()}get _numericFormatter(){return getNumericFormatter()}getTextRenderer(ee){let ne=this._textRenderers.get(ee);return ne||(ne=new BaseTextRenderer,this._labelsRenderers.set(ee,ne)),ne}getLabelRenderer(ee){let ne=this._labelsRenderers.get(ee);return ne||(ne=new BaseTextRenderer(new HitTestResult(HitTarget.MovePoint)),this._labelsRenderers.set(ee,ne)),ne}getLevelLineRenderer(ee){return ensure(this._levelLineRenderers.has(ee)?this._levelLineRenderers.get(ee):this._levelLineRenderers.set(ee,new LineRenderer).get(ee))}_updateLabelForLevel(ee){const ne=this.getLabelRenderer(ee.levelIndex),re=this._source.properties(),se=!!re.showCoeffs,ae=!!re.showPrices;if(!se&&!ae)return null;const le=ee.coeff;let ce="";if(se){const he=re.coeffsAsPercents??!1;ce+=he?this._percentageFormatter.format(100*le,{signPositive:!1,tailSize:2}):this._numericFormatter.format(le)}return ae&&(ce+=" ("+ee.price+")"),this._updateRendererLabel(ee,ne,ce),ne}_updateRendererLabel(ee,ne,re){if(!re&&ee.decorator===void 0)return null;const{leftPoint:se,rightPoint:ae,horzAlign:le,extendLeft:ce,extendRight:he,...fe}=ee,[Ae,pe]=getTextAlignInBox({horzAlign:le,extendLeft:ce,extendRight:he,width:this._source.getScope().mediaSize.width,leftPoint:se,rightPoint:ae});return ne.setData({points:[Ae],text:re??"",horzAlign:pe,offsetX:4,offsetY:0,fontFamily:ChartFontFamily,fontSize:12,...fe}),ne}}__decorateClass$6([memoize$1],FibWIthLabelsPaneView.prototype,"_numericFormatter");class FibChannelRenderer extends ParallelChannelRenderer{_drawLine(te,ee,ne){var le;const{context:re,bitmapSize:se}=te,ae=(le=this._data)==null?void 0:le.excludeBoundaries;if(ae!==void 0){re.save(),re.beginPath(),re.rect(0,0,se.width,se.height);for(let ce=0;ce<ae.length;ce++){const{x:he,y:fe}=ae[ce],Ae=he*te.horizontalPixelRatio,pe=fe*te.verticalPixelRatio;ce===0?re.moveTo(Ae,pe):re.lineTo(Ae,pe)}re.closePath(),re.clip("evenodd")}super._drawLine(te,ee,ne),ae!==void 0&&re.restore()}}class FibChannelPaneView extends FibWIthLabelsPaneView{constructor(){super(...arguments);Ee(this,"_baseLineRenderer",new LineRenderer);Ee(this,"_lastLevelTrendRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(ee.length<2){this.addAnchors(this._renderer);return}const ne=this._source.properties(),re=ee[0],se=ee[1];if(ee.length<3){const he={points:[re,se],lineColor:ne.levels[0].color,lineWidth:ne.levelsStyle.linewidth,lineStyle:ne.levelsStyle.linestyle,extendLeft:ne.extendLeft,extendRight:ne.extendRight,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._baseLineRenderer.setData(he),this._renderer.append(this._baseLineRenderer),this.addAnchors(this._renderer);return}const{width:ae,height:le}=this._source.getScope().mediaSize;for(let he=0;he<ne.levels.length;he++){const fe=ne.levels[he];if(!fe.visible)continue;let Ae=null;for(let Ze=he+1;Ze<ne.levels.length;Ze++){const Ye=ne.levels[Ze];if(Ye.visible){Ae=Ye;break}}if(!Ae)break;const pe=fe.color,Oe=ne.extendLeft,Fe=ne.extendRight,Ne=ne.levelsStyle.linestyle,ze=ne.levelsStyle.linewidth,He=this._data.levels[he],We=this._updateLabelForLevel({levelIndex:he,coeff:fe.coeff,leftPoint:He.leftPoint1,rightPoint:ensure(He.rightPoint2),price:He.price,color:pe,horzAlign:ne.horzLabelsAlign,vertAlign:ne.vertLabelsAlign});let je;We!==null&&(this._renderer.append(We),je=getTextBoundaries(We,ae,le)??void 0);const Ue={line1:{color:pe,lineStyle:Ne,lineWidth:ze,points:[He.leftPoint1,He.rightPoint1]},line2:{color:pe,lineStyle:Ne,lineWidth:ze,points:[ensure(He.leftPoint2),ensure(He.rightPoint2)]},extendLeft:Oe,extendRight:Fe,backColor:generateColor(pe,ne.transparency,!0),skipTopLine:!0,fillBackground:ne.fillBackground,hittestOnBackground:!0,excludeBoundaries:je},Ge=new FibChannelRenderer;Ge.setData(Ue),this._renderer.append(Ge)}let ce=null;for(let he=ne.levels.length-1;he>=0;he--)if(ne.levels[he].visible){ce=he;break}if(ce!==null){const he=ne.levels[ce];if(he.visible){const fe=this._data.levels[ce],Ae=this._updateLabelForLevel({levelIndex:ce,coeff:he.coeff,leftPoint:fe.leftPoint1,rightPoint:fe.rightPoint1,price:fe.price,color:he.color,horzAlign:ne.horzLabelsAlign,vertAlign:ne.vertLabelsAlign});let pe;Ae!==null&&(this._renderer.append(Ae),pe=getTextBoundaries(Ae,ae,le)??void 0);const Oe={points:[fe.leftPoint1,fe.rightPoint1],lineColor:he.color,lineWidth:ne.levelsStyle.linewidth,lineStyle:ne.levelsStyle.linestyle,extendLeft:ne.extendLeft,extendRight:ne.extendRight,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal,excludeBoundaries:pe?[pe]:void 0};this._lastLevelTrendRenderer.setData(Oe),this._renderer.append(this._lastLevelTrendRenderer)}}this.addAnchors(this._renderer)}}class FibChannelPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibChannelPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((he,fe)=>new AnchorPoint(this.pointToScreenPoint(he),{pointIndex:fe})),ne=ee.map(he=>he.x),re=ee.map(he=>he.y);this.controlPoints.forEach((he,fe)=>{this._timeAxisViews[fe].update(this._calculateTimeAxisViewData(he.time,ee[fe].x)),this._priceAxisViews[fe].update(this._calculatePriceAxisViewData(he.price,ee[fe].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se=ee.length>2?ee[2].subtract(ee[0]):null,ae=ee[0],le=ee[1],ce=this._props.levels.reduce((he,fe,Ae)=>{if(!fe.visible||!se)return he;const pe=se.scaled(fe.coeff),Oe=ae.add(pe),Fe=le.add(pe);let Ne=null,ze=null,He=null;for(let je=Ae+1;je<this._props.levels.length;je++){const Ue=this._props.levels[je];if(Ue.visible){He=Ue;break}}if(He){const je=se.scaled(He.coeff);Ne=ae.add(je),ze=le.add(je)}const We=ensure(this.series.coordinateToPrice(Oe.y));return he.push({leftPoint1:Oe,rightPoint1:Fe,leftPoint2:Ne,rightPoint2:ze,price:this.series.priceFormatter().format(We)}),he},[]);this._lines.update({points:ee,levels:ce})}}class FibChannelTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibChannelToolType);Ee(this,"steps",3)}createPrimitive(){return new FibChannelPrimitive({id:this.id,points:[],showCoeffs:!0,showPrices:!0,fillBackground:!0,transparency:80,extendLeft:!1,extendRight:!1,horzLabelsAlign:HorizontalAlign.Left,vertLabelsAlign:VerticalAlign.Middle,coeffsAsPercents:!1,labelFontSize:12,levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{visible:!0,coeff:0,color:"#808080"},{visible:!0,coeff:.236,color:"#F23645"},{visible:!0,coeff:.382,color:"#FF9800"},{visible:!0,coeff:.5,color:"#4CAF50"},{visible:!0,coeff:.618,color:"#089981"},{visible:!0,coeff:.786,color:"#00BCD4"},{visible:!0,coeff:1,color:"#808080"},{visible:!0,coeff:1.618,color:"#2962FF"},{visible:!0,coeff:2.618,color:"#F23645"},{visible:!0,coeff:3.618,color:"#9C27B0"},{visible:!0,coeff:4.236,color:"#E91E63"}]},...this.resetArgs)}}const fibFibChannel={type:FibChannelToolType,icon:icon$19,Ctor:FibChannelTool},icon$18=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M23.868 7.825c2.791 3.916 2.918 9.33-.065 13.435-3.733 5.138-10.925 6.277-16.063 2.544l.721-.714c4.682 3.294 11.157 2.229 14.534-2.418 2.641-3.635 2.657-8.502.153-12.133l.721-.714z"></path><path d="M8.477 5.899c3.584-2.509 8.298-2.514 11.865-.127l.718-.721c-3.845-2.669-9.099-2.813-13.157.028-5.203 3.643-6.467 10.814-2.824 16.016l.718-.721c-3.201-4.737-2.022-11.185 2.68-14.476z"></path><path d="M14.5 22c4.142 0 7.5-3.358 7.5-7.5 0-4.142-3.358-7.5-7.5-7.5-4.142 0-7.5 3.358-7.5 7.5 0 4.142 3.358 7.5 7.5 7.5zm0 1c-4.694 0-8.5-3.806-8.5-8.5s3.806-8.5 8.5-8.5 8.5 3.806 8.5 8.5-3.806 8.5-8.5 8.5z"></path><path d="M14.5 19c2.485 0 4.5-2.015 4.5-4.5s-2.015-4.5-4.5-4.5-4.5 2.015-4.5 4.5 2.015 4.5 4.5 4.5zm0 1c-3.038 0-5.5-2.462-5.5-5.5s2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5-2.462 5.5-5.5 5.5z"></path><path d="M22.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibCirclesToolType="tool.fib.fibCircles";class EllipseRendererSimple extends MediaCoordinatesPaneRenderer{hitTest(te){var Ae;if(!this._data||((Ae=this._data)==null?void 0:Ae.points.length)<2)return null;const ee=this._data.points[0],ne=this._data.points[1],re=.5*Math.abs(ee.x-ne.x),se=Math.abs(ee.x-ne.x),ae=Math.abs(ee.y-ne.y);if(se<1||ae<1)return null;const le=ee.add(ne).scaled(.5);let ce=te.subtract(le);const he=(ne.y-ee.y)/(ne.x-ee.x);ce=new Point(ce.x,ce.y/he);let fe=ce.x*ce.x+ce.y*ce.y-re*re;return fe=sign(fe)*Math.sqrt(Math.abs(fe/re)),Math.abs(fe)<3?this._hitTest:this._data.fillBackground&&!this._data.noHitTestOnBackground&&fe<3?this._backgroundHitTest:null}drawImpl(te){if(!this._data)return;const ee=te.context;ee.lineCap="butt",ee.strokeStyle=this._data.color,ee.lineWidth=this._data.linewidth,this._data.linestyle!==void 0&&setLineStyle(ee,this._data.linestyle);const ne=this._data.points[0],re=this._data.points[1],se=Math.abs(ne.x-re.x),ae=Math.abs(ne.y-re.y);if(se<1||ae<1)return;const le=ne.add(re).scaled(.5);let ce=0;if(this._data.wholePoints){const[he,fe]=this._data.wholePoints;ce=Math.abs(he.x-fe.x)}ee.save(),ee.translate(le.x,le.y),ee.scale(1,ae/se),ee.beginPath(),ee.arc(0,0,se/2,0,2*Math.PI,!1),ee.restore(),ee.stroke(),this._data.fillBackground&&(this._data.wholePoints&&(ee.translate(le.x,le.y),ee.scale(1,ae/se),ee.arc(0,0,ce/2,0,2*Math.PI,!0)),ee.fillStyle=generateColor(this._data.backcolor,this._data.transparency,!0),ee.fill())}}class FibCirclesPaneView extends FibWIthLabelsPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const[ne,re]=ee,se=ne.add(re).scaled(.5),ae=Math.abs(re.x-ne.x),le=Math.abs(re.y-ne.y),ce=[],he=this._source.properties();he.levels.forEach((Oe,Fe)=>{const Ne=Oe.coeff,ze=Oe.color,He=[new Point(se.x-.5*ae*Ne,se.y-.5*le*Ne),new Point(se.x+.5*ae*Ne,se.y+.5*le*Ne)],We=new Point(se.x,se.y+.5*le*Ne);ce.push({color:ze,points:He,labelPoint:We,linewidth:Oe.linewidth,linestyle:Oe.linestyle,index:Fe,coeff:Oe.coeff})});const fe=he.fillBackground,Ae=he.transparency;for(let Oe=0;Oe<ce.length;Oe++){const Fe=ce[Oe],Ne=new EllipseRendererSimple({points:Fe.points,color:Fe.color,linewidth:Fe.linewidth,backcolor:Fe.color,wholePoints:Oe>0?ce[Oe-1].points:void 0,fillBackground:fe,transparency:Ae});Ne.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ne);const ze=this._updateLabelForLevel({levelIndex:Fe.index,coeff:Fe.coeff,color:Fe.color,price:"",vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Left,leftPoint:Fe.labelPoint,rightPoint:Fe.labelPoint});ze!==null&&this._renderer.append(ze)}const pe=he.trendline;pe.visible&&(this._trendLineRenderer.setData({points:[ne,re],lineColor:pe.color,lineWidth:pe.linewidth,lineStyle:pe.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(this._trendLineRenderer)),this.addAnchors(this._renderer)}}class FibCirclesPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibCirclesPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class FibCirclesTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibCirclesToolType);Ee(this,"steps",2)}createPrimitive(){return new FibCirclesPrimitive({id:this.id,points:[],levels:[{coeff:.236,color:"#F23645",linestyle:LineStyleType.solid,linewidth:2},{coeff:.382,color:"#FF9800",linestyle:LineStyleType.solid,linewidth:2},{coeff:.5,color:"#4CAF50",linestyle:LineStyleType.solid,linewidth:2},{coeff:.618,color:"#089981",linestyle:LineStyleType.solid,linewidth:2},{coeff:.786,color:"#00BCD4",linestyle:LineStyleType.solid,linewidth:2},{coeff:1,color:"#808080",linestyle:LineStyleType.solid,linewidth:2},{coeff:1.618,color:"#2962FF",linestyle:LineStyleType.solid,linewidth:2},{coeff:2.618,color:"#E91E63",linestyle:LineStyleType.solid,linewidth:2},{coeff:3.618,color:"#2962FF",linestyle:LineStyleType.solid,linewidth:2},{coeff:4.236,color:"#E91E63",linestyle:LineStyleType.solid,linewidth:2},{coeff:4.618,color:"#F23645",linestyle:LineStyleType.solid,linewidth:2}],transparency:80,fillBackground:!0,showCoeffs:!0,coeffsAsPercents:!1,trendline:{visible:!0,color:"#808080",linewidth:2,linestyle:LineStyleType.dashed}},...this.resetArgs)}}const fibFibCircles={type:FibCirclesToolType,icon:icon$18,Ctor:FibCirclesTool},icon$17=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M3 5h22v-1h-22z"></path><path d="M3 17h22v-1h-22z"></path><path d="M3 11h19.5v-1h-19.5z"></path><path d="M5.5 23h19.5v-1h-19.5z"></path><path d="M3.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibRetracementToolType="tool.fib.fibRetracement";function fibLevelCoordinate(ie,te,ee,ne,re){if(re)return Math.round(ensure(ie.coordinate)+ensure(te.coordinate)*ee);{const se=ensure(ie.price)+ensure(te.price)*ee;return ensure(ne.priceToCoordinate(se))}}function fibLevelPrice(ie,te,ee,ne,re){if(re){const se=ensure(ie.coordinate)+ensure(te.coordinate)*ee;return ensure(ne.coordinateToPrice(se))}else return ensure(ie.price)+ensure(te.price)*ee}class RectangleRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_scope")}getColor(){const ee=ensure(this._data);return!ee.backColor||ee.transparency===void 0?ee.backColor:generateColor(ee.backColor,ee.transparency,!0)}drawImpl(ee){const ne=this._data;if(this._scope=ee,!ne||ne.points.length<2||ne.lineWidth<=0&&!ne.backColor)return;const{horizontalPixelRatio:re,verticalPixelRatio:se,bitmapSize:ae}=ee,{extendLeft:le,extendRight:ce,lineWidth:he,middleLine:fe,color:Ae}=ne,[pe,Oe]=ne.points,Fe=box(pe,Oe),Ne=he?Math.max(1,Math.floor(he*re)):0,ze=this.getColor(),He=Math.max(1,Math.floor(re)),We=le?-he:Math.round(Fe.min.x*re),je=ce?ae.width+he:Math.round(Fe.max.x*re),Ue=Math.round(Fe.min.y*se),Ge=Math.round(Fe.max.y*se);fillRectWithBorder(ee,We,je,Ue,Ge,He,ze?{color:ze}:void 0,Ne===0?void 0:{color:Ae,lineStyle:ne.lineStyle,borderWidth:Ne,borderMode:"center"},fe?{...fe,lineWidth:Math.max(1,Math.floor(fe.lineWidth*se))}:void 0)}hitTest(ee){if(!this._data||this._data.points.length<2||!this._scope)return null;const ne=new HitTestResult(HitTarget.MovePoint),re=this._scope.mediaSize.width,[se,ae]=this._data.points,le=box(se,ae),ce=le.min,he=le.max,fe=new Point(he.x,ce.y),Ae=new Point(ce.x,he.y);if(this._extendAndHitTestLineSegment(ee,ce,fe,re)||this._extendAndHitTestLineSegment(ee,Ae,he,re))return ne;let Fe=distanceToSegment(fe,he,ee);if(Fe.distance<=3||(Fe=distanceToSegment(ce,Ae,ee),Fe.distance<=3))return ne;if(this._data.middleLine){const Ne=le.min.add(le.max).scaled(.5).y,ze=new Point(le.min.x,Ne),He=new Point(le.max.x,Ne);if(this._extendAndHitTestLineSegment(ee,ze,He,re))return ne}return this._data.fillBackground?this._hitTestBackground(ee,ce,he,re):null}_hitTestBackground(ee,ne,re,se){var le,ce;const ae=this._extendAndClipLineSegment(ne,re,se);return ae!==null&&pointInBox$1(ee,box(ae[0],ae[1]))?this._backgroundHitTest??((le=this._data)!=null&&le.backgroundHitTarget?new HitTestResult((ce=this._data)==null?void 0:ce.backgroundHitTarget):null):null}_extendAndHitTestLineSegment(ee,ne,re,se){const ae=this._extendAndClipLineSegment(ne,re,se);if(ae!==null){const[le,ce]=ae;if(distanceToSegment(le,ce,ee).distance<=3)return!0}return!1}_extendAndClipLineSegment(ee,ne,re){const se=ensure(this._data);if(arePointsEqual(ee,ne)&&!se.extendLeft&&!se.extendRight)return null;const ae=Math.min(ee.x,ne.x),le=Math.max(ee.x,ne.x),ce=se.extendLeft?0:Math.max(ae,0),he=se.extendRight?re:Math.min(le,re);return ce>he||he<=0||ce>=re?null:[new Point(ce,ee.y),new Point(he,ne.y)]}}const DefaultTextAlign=[HorizontalAlign.Center,VerticalAlign.Middle];function extractPointAndRect(ie){return{renderer:ie,point:ensure(ie.point()),rect:ie.rect(),horzAlign:ensure(ie.data().horzAlign)}}function placeTextLeftOfLabel(ie,te){const ee=ie.rect.x-te.rect.width-DEFAULT_PADDING;te.renderer.setPoint(new Point(ee+te.rect.width/2,te.point.y))}function placeTextRightOfLabel(ie,te){const ee=ie.rect.x+ie.rect.width+DEFAULT_PADDING;te.renderer.setPoint(new Point(ee+te.rect.width/2,te.point.y))}function isTooWide(ie,te){return te!==null&&ie.rect.width>te}function alignCenter(ie,te){const ee=ie.rect.x+(ie.rect.width+te.rect.width)/2,ne=ee-ie.rect.width/2,re=ee+ie.rect.width/2;ie&&ie.renderer.setPoint(new Point(ne+ie.rect.width/2,ie.point.y)),te&&te.renderer.setPoint(new Point(re+te.rect.width/2,te.point.y))}function getAlignWeight(ie){return{left:0,center:1,right:2}[ie]}const DEFAULT_PADDING=4;function calculateTextMaxAvailableWidth(ie){const{leftAnchorX:te,rightAnchorX:ee,extendLeft:ne,extendRight:re,screenWidth:se,labelRenderer:ae,horzLabelsAlign:le,labelAndTextHaveSameVertAlign:ce}=ie,he=ce?calcClampedLabelWidth(ae==null?void 0:ae.rect(),se):0;let fe=0;return ne||re?ne&&re?fe=se-he:ne?fe=ee-(le==="left"?he:0):re&&(fe=se-te-(le==="right"?he:0)):fe=ee-te-(le==="center"?he:0),fe-8}function calcClampedLabelWidth(ie,te){if(!ie)return 0;const ee=clamp(ie.x,0,te);return clamp(ie.x+ie.width,0,te)-ee}function clamp(ie,te,ee){return Math.max(te,Math.min(ee,ie))}function adjustLabelAndTextPosition(ie){const{labelAndTextHaveSameAlign:te,labelAndTextHaveSameVertAlign:ee,labelRenderer:ne,textRenderer:re,horzTextAlign:se,horzLabelsAlign:ae,textMaxWidth:le,extendLeft:ce=!1,extendRight:he=!1}=ie;if(te){const fe=extractPointAndRect(ne),Ae=extractPointAndRect(re);switch(se){case"left":ce?placeTextRightOfLabel(fe,Ae):placeTextLeftOfLabel(fe,Ae);break;case"center":if(isTooWide(Ae,le))return{hideText:!0};alignCenter(fe,Ae);break;case"right":he?placeTextLeftOfLabel(fe,Ae):placeTextRightOfLabel(fe,Ae);break}return{hideText:!1}}if(le!==null&&isTooWide(extractPointAndRect(re),le))return{hideText:!0};if(ee){const fe=ne.rect(),Ae=re.rect(),pe=ensure(re.point());if(getAlignWeight(se)<getAlignWeight(ae)){const Oe=Ae.x+Ae.width+DEFAULT_PADDING-fe.x;Oe>0&&re.setPoint(new Point(pe.x-Oe,pe.y))}else{const Oe=fe.x+fe.width+DEFAULT_PADDING-Ae.x;Oe>0&&re.setPoint(new Point(pe.x+Oe,pe.y))}}return{hideText:!1}}function adjustVerticalAlignToMiddle(ie){if(!ie)return;const te=ensure(ie.data()),ee=te.vertAlign;if(ee!==VerticalAlign.Middle){const ne=ensure(te.points)[0],se=(ee===VerticalAlign.Top?1:-1)*(getFontSize(te)+getLineSpacing(te));ie.setData({...te,vertAlign:VerticalAlign.Middle,points:[new Point({x:ne.x,y:ne.y+se})]})}}function getVerticalMiddleTextBounds(ie,te,ee,ne){if(ie!==null&&te===VerticalAlign.Middle){const re=getTextBoundaries(ie,ee,ne);if(re)return[re]}return[]}class FibHorizontalLevelsPaneView extends FibWIthLabelsPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_addLevels(ee){const{mediaSize:ne,levels:re,left:se,right:ae,showText:le,labelAlign:ce,textAlign:he,extendLeft:fe,extendRight:Ae,isOnScreen:pe,trendLineRenderer:Oe}=ee;let Fe=se,Ne=ae;Fe===Ne&&(fe&&Fe--,Ae&&Ne++);const{width:ze,height:He}=ne,We=[],je=[];this._model.isSelected(this._source);const[Ue,Ge]=ce;for(const Ze of re){const Ye=Ze.y,qe=new Point(Fe,Ye),nr=new Point(Ne,Ye),ir=!!Ze.text,tr=Ze.index,or=!1,Jt=!ir&&!0,[rr,lr]=Jt?DefaultTextAlign:he,ur=Ue===rr,Sr={levelIndex:tr,coeff:Ze.coeff,leftPoint:qe,rightPoint:nr,color:Ze.color,extendLeft:fe,extendRight:Ae},xr=!1;let Pr=null;const mr=le&&(ir||xr||or),Er=mr&&!ir&&!0;mr&&(!Er||!0)&&(Pr=ensure(this.getTextRenderer(tr)),this._updateRendererLabel({...Sr,horzAlign:rr,vertAlign:lr,color:Ze.color},Pr,Ze.text||"Text"));const dr=this._updateLabelForLevel({...Sr,price:Ze.price,horzAlign:Ue,vertAlign:Ge});let Cr=!1;if(Pr&&dr){const Or=Ge===lr;Cr=adjustLabelAndTextPosition({labelRenderer:dr,textRenderer:Pr,labelAndTextHaveSameAlign:ur,labelAndTextHaveSameVertAlign:Or,horzTextAlign:rr,horzLabelsAlign:Ue,textMaxWidth:Er?calculateTextMaxAvailableWidth({leftAnchorX:Fe,rightAnchorX:Ne,extendLeft:fe,extendRight:Ae,screenWidth:ze,horzLabelsAlign:Ue,labelRenderer:dr,labelAndTextHaveSameVertAlign:Or}):null,extendLeft:fe,extendRight:Ae}).hideText}if(pe&&(adjustVerticalAlignToMiddle(Pr),adjustVerticalAlignToMiddle(dr),!(!fe&&!Ae&&(Pr&&rr==="center"&&lr==="middle"&&Ne-4<Pr.rect().x+Pr.rect().width||dr&&Ue==="center"&&Ge==="middle"&&Fe+4>dr.rect().x)))){const Ar=[...getVerticalMiddleTextBounds(dr,Ge,ze,He),...getVerticalMiddleTextBounds(Cr?null:Pr,lr,ze,He)],Ir=this.getLevelLineRenderer(tr);Ir.setData({points:[qe,nr],lineColor:Ze.color,lineWidth:Ze.linewidth,lineStyle:Ze.linestyle,extendLeft:fe,extendRight:Ae,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal,excludeBoundaries:Ar,hitTestTolerance:4}),We.push(Ir)}dr&&!dr.isOutOfScreen(ze,He)&&je.push(dr),!Cr&&Pr&&!Pr.isOutOfScreen(ze,He)&&je.push(Pr)}for(const Ze of We)this._renderer.append(Ze);Oe&&this._renderer.append(Oe);for(const Ze of je)this._renderer.append(Ze)}}class FibRetracementPaneView extends FibHorizontalLevelsPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRenderer",new LineRenderer)}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re=ee[0],se=ee[1],ae=Math.min(re.x,se.x),le=Math.max(re.x,se.x),ce=ne.fillBackground,he=ne.transparency,fe=ne.extendLinesLeft,Ae=ne.extendLines,pe=this._source.getScope(),{width:Oe}=pe.mediaSize,Fe=!(ae>Oe&&!fe||le<0&&!Ae),Ne=ne.levels.reduce((Ue,Ge,Ze)=>(Ue.push({color:Ge.color,coeff:Ge.coeff,y:this._data.levels[Ze].y,price:this._data.levels[Ze].price,linewidth:ne.levelsStyle.linewidth,linestyle:ne.levelsStyle.linestyle,index:Ze}),Ue),[]);if(ce&&Fe)for(let Ue=1;Ue<Ne.length;Ue++){const Ge=Ne[Ue],Ze=Ne[Ue-1],Ye=new RectangleRenderer;Ye.setData({points:[new Point(ae,Ge.y),new Point(le,Ze.y)],color:Ge.color,lineWidth:0,backColor:Ge.color,transparency:he,extendLeft:fe,extendRight:Ae}),this._renderer.append(Ye)}let ze=ae,He=le;ze===He&&(fe&&(ze-=1),Ae&&(He+=1));const We=ne.trendline;let je=null;We.visible&&Fe&&(je=this._trendLineRenderer,je.setData({points:[re,se],lineColor:We.color,lineWidth:We.linewidth,lineStyle:We.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal})),this._addLevels({mediaSize:pe.mediaSize,levels:Ne,left:ze,right:He,showLabel:ne.showCoeffs||ne.showPrices,showText:ne.showText,labelAlign:[ne.horzLabelsAlign,ne.vertLabelsAlign],textAlign:[ne.horzTextAlign,ne.vertTextAlign],extendLeft:fe,extendRight:Ae,fontSize:ne.labelFontSize,isOnScreen:Fe,trendLineRenderer:je}),this.addAnchors(this._renderer)}}class FibRetracementPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibRetracementPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ze,He)=>new AnchorPoint(this.pointToScreenPoint(ze),{pointIndex:He})),ne=ee.map(ze=>ze.x),re=ee.map(ze=>ze.y);this.controlPoints.forEach((ze,He)=>{this._timeAxisViews[He].update(this._calculateTimeAxisViewData(ze.time,ee[He].x)),this._priceAxisViews[He].update(this._calculatePriceAxisViewData(ze.price,ee[He].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const[se,ae]=this.controlPoints,le=this._props.reverse,ce=le?se.price:ae.price,he=le?ae.price:se.price,fe=he-ce,Ae=ensure(this.series.priceToCoordinate(ce)),pe={price:ce,coordinate:Ae},Oe={price:fe,coordinate:ensure(this.series.priceToCoordinate(he))-Ae},Fe=!1,Ne=this._props.levels.reduce((ze,He,We)=>{if(!He.visible)return ze;const je=He.coeff,Ue=fibLevelCoordinate(pe,Oe,je,this.series,Fe),Ge=fibLevelPrice(pe,Oe,je,this.series,Fe);return ze.push({y:Ue,price:this.series.priceFormatter().format(Ge),index:We}),ze},[]);this._lines.update({points:ee,levels:Ne})}}class FibRetracementTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibRetracementToolType);Ee(this,"steps",2)}createPrimitive(){return new FibRetracementPrimitive({id:this.id,points:[],showCoeffs:!0,showPrices:!0,fillBackground:!0,transparency:80,extendLines:!1,extendLinesLeft:!1,horzLabelsAlign:HorizontalAlign.Left,vertLabelsAlign:VerticalAlign.Middle,showText:!0,horzTextAlign:HorizontalAlign.Center,vertTextAlign:VerticalAlign.Middle,reverse:!1,coeffsAsPercents:!1,fibLevelsBasedOnLogScale:!1,labelFontSize:12,trendline:{visible:!0,color:"#808080",linewidth:2,linestyle:LineStyleType.dashed},levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{coeff:0,color:"#808080",visible:!0},{coeff:.236,color:"#F23645",visible:!0},{coeff:.382,color:"#FF9800",visible:!0},{coeff:.5,color:"#4CAF50",visible:!0},{coeff:.618,color:"#089981",visible:!0},{coeff:.786,color:"#00BCD4",visible:!0},{coeff:1,color:"#808080",visible:!0},{coeff:1.618,color:"#2962FF",visible:!0},{coeff:2.618,color:"#F23645",visible:!0},{coeff:3.618,color:"#9C27B0",visible:!0},{coeff:4.236,color:"#E91E63",visible:!0}]},...this.resetArgs)}}const fibFibRetracement={type:FibRetracementToolType,icon:icon$17,Ctor:FibRetracementTool,keybinding:KeyCode.KeyF|KeyMod.Alt},icon$16=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M8 9.5c0 3.038 2.462 5.5 5.5 5.5s5.5-2.462 5.5-5.5v-.5h-1v.5c0 2.485-2.015 4.5-4.5 4.5s-4.5-2.015-4.5-4.5v-.5h-1v.5z"></path><path d="M0 9.5c0 7.456 6.044 13.5 13.5 13.5s13.5-6.044 13.5-13.5v-.5h-1v.5c0 6.904-5.596 12.5-12.5 12.5s-12.5-5.596-12.5-12.5v-.5h-1v.5z"></path><path d="M4 9.5c0 4.259 2.828 7.964 6.86 9.128l.48.139.277-.961-.48-.139c-3.607-1.041-6.137-4.356-6.137-8.167v-.5h-1v.5z"></path><path d="M16.141 18.628c4.032-1.165 6.859-4.869 6.859-9.128v-.5h-1v.5c0 3.811-2.53 7.125-6.136 8.167l-.48.139.278.961.48-.139z"></path><path d="M13.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM13.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibSpeedResistanceArcsToolType="tool.fib.fibSpeedResistanceArcs";let ArcRenderer$1=class extends MediaCoordinatesPaneRenderer{hitTest(te){const ee=this._data;if(ee===null||sign(te.y-ee.center.y)!==ee.dir&&!ee.fullCircles)return null;const re=te.subtract(ee.center).length(),se=interactionTolerance().curve;return Math.abs(re-ee.radius)<se?this._hitTest:ee.hittestOnBackground&&Math.abs(re)<=ee.radius+se?this._backgroundHitTest:null}drawImpl(te){const ee=this._data;if(!ee)return;const ne=te.context;ne.lineCap="round",ne.strokeStyle=ee.color,ne.lineWidth=ee.linewidth,ne.translate(ee.center.x,ee.center.y),ne.beginPath(),ee.fullCircles?ne.arc(0,0,ee.radius,0,2*Math.PI,!1):ee.dir>0?ne.arc(0,0,ee.radius,0,Math.PI,!1):ne.arc(0,0,ee.radius,Math.PI,0,!1),ne.stroke(),ee.fillBackground&&(ee.radius2&&(ee.fullCircles?ne.arc(0,0,ee.radius2,0,2*Math.PI,!0):ee.dir>0?ne.arc(0,0,ee.radius2,Math.PI,0,!0):ne.arc(0,0,ee.radius2,0,Math.PI,!0)),ne.fillStyle=generateColor(ee.color,ee.transparency,!0),ne.fill())}};class FibSpeedResistanceArcsPaneView extends FibWIthLabelsPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){var fe;this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re=ee[0],se=ee[1],ae=ne.fillBackground,le=ne.transparency,ce=ne.fullCircles;for(let Ae=0;Ae<this._data.levels.length;Ae++){const pe=this._data.levels[Ae],Oe={center:re,color:ne.levels[Ae].color,linewidth:ne.levelsStyle.linewidth,radius:pe.radius,dir:pe.dir,transparency:le,fillBackground:ae,hittestOnBackground:!0,fullCircles:ce,radius2:Ae>0?(fe=this._data.levels[Ae-1])==null?void 0:fe.radius:void 0},Fe=new HitTestResult(HitTarget.MovePoint),Ne=new ArcRenderer$1(Oe);Ne.setHitTest(Fe),this._renderer.append(Ne);const ze=this._updateLabelForLevel({levelIndex:Ae,coeff:ne.levels[Ae].coeff,leftPoint:pe.labelPoint,rightPoint:pe.labelPoint,price:"",color:ne.levels[Ae].color,horzAlign:HorizontalAlign.Left,vertAlign:VerticalAlign.Middle});ze!==null&&this._renderer.append(ze)}const he=ne.trendline;if(he.visible){const Ae={points:[re,se],lineColor:he.color,lineWidth:he.linewidth,lineStyle:he.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendLineRenderer.setData(Ae),this._renderer.append(this._trendLineRenderer)}this.addAnchors(this._renderer)}}class FibSpeedResistanceArcsPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibSpeedResistanceArcsPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le})),ne=ee.map(ae=>ae.x),re=ee.map(ae=>ae.y);this.controlPoints.forEach((ae,le)=>{this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ee[le].x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ee[le].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));let se=[];if(ee.length>1){const ae=ee[0],le=ee[1],ce=ae.subtract(le).length();se=this._props.levels.reduce((he,fe)=>{if(!fe.visible)return he;const Ae=fe.coeff,pe=Math.abs(ce*Ae),Oe=sign(le.y-ae.y),Fe=new Point(ae.x,ae.y+Oe*pe);return he.push({radius:pe,dir:Oe,labelPoint:Fe}),he},[])}this._lines.update({points:ee,levels:se})}}class FibSpeedResistanceArcsTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibSpeedResistanceArcsToolType);Ee(this,"steps",2)}createPrimitive(){return new FibSpeedResistanceArcsPrimitive({id:this.id,points:[],showCoeffs:!0,fillBackground:!0,transparency:80,fullCircles:!1,trendline:{visible:!0,color:"#808080",linewidth:2,linestyle:LineStyleType.dashed},levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{visible:!0,coeff:.236,color:"#F23645"},{visible:!0,coeff:.382,color:"#FF9800"},{visible:!0,coeff:.5,color:"#4CAF50"},{visible:!0,coeff:.618,color:"#089981"},{visible:!0,coeff:.786,color:"#00BCD4"},{visible:!0,coeff:1,color:"#808080"},{visible:!0,coeff:1.618,color:"#2962FF"},{visible:!0,coeff:2.618,color:"#E91E63"},{visible:!0,coeff:3.618,color:"#2962FF"},{visible:!0,coeff:4.236,color:"#E91E63"},{visible:!0,coeff:4.618,color:"#F23645"}]},...this.resetArgs)}}const fibFibSpeedResistanceArcs={type:FibSpeedResistanceArcsToolType,icon:icon$16,Ctor:FibSpeedResistanceArcsTool},icon$15=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4 2v19.5h1v-19.5zM15.5 10h-11v1h11zM17 12.5v11h1v-11zM6.29 22.417l10.162-10.162-.707-.707-10.162 10.162z" id="Line"></path><path d="M19.264 9.443l6.589-6.589-.707-.707-6.589 6.589z"></path><path d="M6.577 23.381l19.071-5.903-.296-.955-19.071 5.903z"></path><path d="M5.573 21.724l5.905-19.076-.955-.296-5.905 19.076z"></path><path d="M6.5 24h19.5v-1h-19.5z"></path><path d="M4.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibSpeedResistanceFanToolType="tool.fib.fibSpeedResistanceFan";let ChannelRenderer$1=class extends MediaCoordinatesPaneRenderer{drawImpl(te){if(this._data===null)return;const ee=te.context,ne=this._getVisiblePolygon(te.mediaSize);if(ne!==null){ee.beginPath(),ee.moveTo(ne[0].x,ne[0].y);for(let re=1;re<ne.length;re++)ee.lineTo(ne[re].x,ne[re].y);ee.fillStyle=generateColor(this._data.color,this._data.transparency,!0),ee.fill()}}_getVisiblePolygon(te){const ee=ensure(this._data),{p1:ne,p2:re,p3:se,p4:ae}=ee;if(arePointsEqual(ne,re)||arePointsEqual(se,ae)||distanceToLine(ne,re,se).distance<1e-6&&distanceToLine(ne,re,ae).distance<1e-6||te.width<=0||te.height<=0)return null;let le=[new Point(0,0),new Point(te.width,0),new Point(te.width,te.height),new Point(0,te.height)];return le=clipPolygonByEdge(le,ne,re,[ae,se]),le=clipPolygonByEdge(le,ae,se,[ne,re]),!arePointsEqual(se,ne)&&!ee.extendLeft&&(le=clipPolygonByEdge(le,se,ne,[re,ae])),le}};class FibSpeedResistanceFanPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_leftTextRenderers",new Map);Ee(this,"_rightTextRenderers",new Map);Ee(this,"_topTextRenderers",new Map);Ee(this,"_bottomTextRenderers",new Map)}getTextRenderers(ee,ne){const re={left:this._leftTextRenderers,right:this._rightTextRenderers,top:this._topTextRenderers,bottom:this._bottomTextRenderers};let se=re[ee].get(ne);return se||(se=new BaseTextRenderer,re[ee].set(ne,se)),se}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(ee.length<2)return;const ne=this._source.properties(),[re,se]=ee,ae=Math.min(re.x,se.x),le=Math.max(re.x,se.x),ce=Math.min(re.y,se.y),he=Math.max(re.y,se.y),fe=ne.grid.color,Ae=ne.grid.linewidth,pe=ne.grid.linestyle,Oe=ne.grid.visible,Fe=getNumericFormatter();for(let He=0;He<ne.hLevels.length;He++){const We=ne.hLevels[He],je=this._data.hLevels[He].y,Ue=new Point(ae,je),Ge=new Point(le,je);if(Oe){const Ze=new LineRenderer;Ze.setData({points:[Ue,Ge],lineColor:fe,lineWidth:Ae,lineStyle:pe,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(Ze)}if(ne.showLeftLabels){const Ze={points:[Ue],text:Fe.format(We.coeff),color:We.color,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Right,fontFamily:ChartFontFamily,offsetX:5,offsetY:0,fontSize:12,forceTextAlign:!0},Ye=this.getTextRenderers("left",He);Ye.setData(Ze),this._renderer.append(Ye)}if(ne.showRightLabels){const Ze={points:[Ge],text:Fe.format(We.coeff),color:We.color,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Left,fontFamily:ChartFontFamily,offsetX:5,offsetY:0,fontSize:12,forceTextAlign:!0},Ye=this.getTextRenderers("right",He);Ye.setData(Ze),this._renderer.append(Ye)}}for(let He=0;He<ne.vLevels.length;He++){const We=ne.vLevels[He],je=this._data.vLevels[He].x,Ue=new Point(je,ce),Ge=new Point(je,he);if(Oe){const Ze=new LineRenderer;Ze.setData({points:[Ue,Ge],lineColor:fe,lineWidth:Ae,lineStyle:pe,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(Ze)}if(ne.showTopLabels){const Ze={points:[Ue],text:Fe.format(We.coeff),color:We.color,vertAlign:VerticalAlign.Bottom,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:5,fontSize:12},Ye=this.getTextRenderers("top",He);Ye.setData(Ze),this._renderer.append(Ye)}if(ne.showBottomLabels){const Ze={points:[Ge],text:Fe.format(We.coeff),color:We.color,vertAlign:VerticalAlign.Top,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:5,fontSize:12},Ye=this.getTextRenderers("bottom",He);Ye.setData(Ze),this._renderer.append(Ye)}}const Ne=ne.fillBackground,ze=ne.transparency;for(let He=0;He<ne.hLevels.length;He++){const We=this._data.hLevels[He].y,je=He>0?this._data.hLevels[He-1].y:null;if(He>0&&Ne){const Ge=new ChannelRenderer$1;Ge.setData({p1:re,p2:new Point(se.x,We),p3:re,p4:new Point(se.x,je),color:ne.hLevels[He].color,transparency:ze,hittestOnBackground:!0,extendLeft:!1}),this._renderer.append(Ge)}const Ue=new LineRenderer;Ue.setData({points:[re,new Point(se.x,We)],lineColor:ne.hLevels[He].color,lineWidth:ne.linewidth,lineStyle:ne.linestyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),Ue.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ue)}for(let He=0;He<ne.vLevels.length;He++){const We=this._data.vLevels[He].x,je=He>0?this._data.vLevels[He-1].x:null;if(He>0&&Ne){const Ge=new ChannelRenderer$1;Ge.setData({p1:re,p2:new Point(We,se.y),p3:re,p4:new Point(je,se.y),color:ne.vLevels[He].color,transparency:ze,hittestOnBackground:!0,extendLeft:!1}),this._renderer.append(Ge)}const Ue=new LineRenderer;Ue.setData({points:[re,new Point(We,se.y)],lineColor:ne.vLevels[He].color,lineWidth:ne.linewidth,lineStyle:ne.linestyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),Ue.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ue)}this.addAnchors(this._renderer)}}class FibSpeedResistanceFanPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibSpeedResistanceFanPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((le,ce)=>new AnchorPoint(this.pointToScreenPoint(le),{pointIndex:ce})),ne=ee.map(le=>le.x),re=ee.map(le=>le.y);this.controlPoints.forEach((le,ce)=>{this._timeAxisViews[ce].update(this._calculateTimeAxisViewData(le.time,ee[ce].x)),this._priceAxisViews[ce].update(this._calculatePriceAxisViewData(le.price,ee[ce].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));let se=[],ae=[];if(ee.length>1){const[le,ce]=this.controlPoints,he=this._props.reverse,fe=he?ce.price-le.price:le.price-ce.price,Ae=he?le.price:ce.price;se=this._props.hLevels.reduce((ze,He)=>{const We=He.coeff,je=Ae+We*fe,Ue=ensure(this.series.priceToCoordinate(je));return ze.push({y:Ue}),ze},[]);const pe=ensure(this.chart.timeScale().timeToIndexEx(le.time)),Oe=ensure(this.chart.timeScale().timeToIndexEx(ce.time)),Fe=he?Oe-pe:pe-Oe,Ne=he?pe:Oe;ae=this._props.vLevels.reduce((ze,He)=>{const We=He.coeff,je=Math.round(Ne+We*Fe),Ue=ensure(this.chart.timeScale().logicalToCoordinate(je));return ze.push({x:Ue}),ze},[])}this._lines.update({points:ee,hLevels:se,vLevels:ae})}}class FibSpeedResistanceFanTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibSpeedResistanceFanToolType);Ee(this,"steps",2)}createPrimitive(){return new FibSpeedResistanceFanPrimitive({id:this.id,points:[],fillBackground:!0,transparency:80,grid:{color:"rgba(21, 56, 153, 0.8)",linewidth:1,linestyle:LineStyleType.solid,visible:!0},linewidth:2,linestyle:LineStyleType.solid,showTopLabels:!0,showBottomLabels:!0,showLeftLabels:!0,showRightLabels:!0,reverse:!1,hLevels:[{coeff:0,color:"#808080"},{coeff:.25,color:"#FF9800"},{coeff:.382,color:"#00BCD4"},{coeff:.5,color:"#4CAF50"},{coeff:.618,color:"#089981"},{coeff:.75,color:"#2962FF"},{coeff:1,color:"#808080"}],vLevels:[{coeff:0,color:"#808080"},{coeff:.25,color:"#FF9800"},{coeff:.382,color:"#00BCD4"},{coeff:.5,color:"#4CAF50"},{coeff:.618,color:"#089981"},{coeff:.75,color:"#2962FF"},{coeff:1,color:"#808080"}]},...this.resetArgs)}}const fibFibSpeedResistanceFan={type:FibSpeedResistanceFanToolType,icon:icon$15,Ctor:FibSpeedResistanceFanTool},icon$14=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4.395 10.18c3.432-4.412 10.065-4.998 13.675-.973l.745-.668c-4.044-4.509-11.409-3.858-15.209 1.027l.789.614z"></path><path d="M19.991 12.494c.877 2.718.231 5.487-1.897 7.543-2.646 2.556-6.752 2.83-9.188.477-1.992-1.924-2.027-5.38-.059-7.281 1.582-1.528 3.78-1.587 5.305-.115 1.024.99 1.386 2.424.876 3.491l.902.431c.709-1.482.232-3.37-1.084-4.641-1.921-1.855-4.734-1.78-6.695.115-2.378 2.297-2.337 6.405.059 8.719 2.846 2.749 7.563 2.435 10.577-.477 2.407-2.325 3.147-5.493 2.154-8.569l-.952.307z"></path><path d="M21.01 9.697l3.197-3.197-.707-.707-3.197 3.197z"></path><path d="M14.989 15.719l3.674-3.674-.707-.707-3.674 3.674z"></path><path d="M13.5 18c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM19.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibSpiralToolType="tool.fib.fibSpiral",M$1=[0,1,2,3,5,8,13,21,34,55,89];class FibonacciSpiralRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(this._data===null||this._data.points.length<2)return null;const ee=this._data.points[0],re=this._data.points[1].subtract(ee),se=re.normalized(),ae=se.transposed(),le=te.subtract(ee),ce=this._data.counterclockwise?-1:1,he=le.normalized();let fe=Math.acos(se.dotProduct(he));Math.asin(ae.dotProduct(he))<0&&(fe=2*Math.PI-fe);const Ae=le.length(),pe=interactionTolerance().curve;for(let Oe=0;Oe<4;Oe++){const Fe=ce*fe/(.5*Math.PI);let Ne=this._getFibonacciInterpolated(Fe+Oe*4);if(Ne!==null&&(Ne*=re.length()/5,Math.abs(Ne-Ae)<pe))return new HitTestResult(HitTarget.MovePoint)}return null}drawImpl(te){if(this._data===null||this._data.points.length<2)return;const ee=te.context,ne=this._data.points[0],re=this._data.points[1];ee.save(),ee.lineCap="round",ee.strokeStyle=this._data.color,ee.translate(ne.x,ne.y);let se=re.subtract(ne);const ae=se.length();se=se.normalized();let le=Math.acos(se.x);Math.asin(se.y)<0&&(le=2*Math.PI-le),ee.rotate(le),ee.scale(ae/5,ae/5),ee.lineWidth=this._data.linewidth,setLineStyle(ee,this._data.linestyle);const ce=Math.PI/100;ee.beginPath(),ee.moveTo(0,0);const he=this._data.counterclockwise?-1:1;for(let fe=0;fe<50*(M$1.length-1);fe++){const Ae=he*fe*ce,pe=this._getFibonacciInterpolated(fe/50);if(pe===null)break;const Oe=Math.cos(Ae)*pe,Fe=Math.sin(Ae)*pe;ee.lineTo(Oe,Fe)}ee.scale(5/ae,5/ae),ee.rotate(-le),ee.stroke(),ee.restore()}_getFibonacciInterpolated(te){const ee=Math.floor(te),ne=Math.ceil(te);if(ne>=M$1.length)return null;let re=te-ee;return re=Math.pow(re,1.15),M$1[ee]+(M$1[ne]-M$1[ee])*re}}class FibSpiralPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRenderer",new LineRenderer);Ee(this,"_spiralRenderer",new FibonacciSpiralRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties();{const re={points:ee,lineColor:ne.lineColor,lineWidth:ne.lineWidth,lineStyle:ne.lineStyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendLineRenderer.setData(re),this._renderer.append(this._trendLineRenderer)}{const re={points:ee,color:ne.lineColor,linewidth:ne.lineWidth,linestyle:ne.lineStyle,counterclockwise:ne.counterclockwise};this._spiralRenderer.setData(re),this._renderer.append(this._spiralRenderer)}this.addAnchors(this._renderer)}}class FibSpiralPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibSpiralPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class FibSpiralTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibSpiralToolType);Ee(this,"steps",2)}createPrimitive(){return new FibSpiralPrimitive({id:this.id,points:[],lineWidth:2,lineColor:"#00BCD4",lineStyle:LineStyleType.solid,counterclockwise:!1},...this.resetArgs)}}const fibFibSpiral={type:FibSpiralToolType,icon:icon$14,Ctor:FibSpiralTool},icon$13=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M19 4v21h1V4h-1Zm5 0v21h1V4h-1ZM6 12.95V25H5V12.95a2.5 2.5 0 0 1 0-4.9V4h1v4.05a2.5 2.5 0 0 1 1.67 3.7L8.7 12.8 8 13.5l-1-1c-.3.22-.63.38-1 .45ZM5.5 9a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM13 19.5a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm1 5.5v-3.05A2.5 2.5 0 0 1 12.5 18l-1-1 .7-.7 1.05 1.03c.23-.13.48-.23.75-.28V4h1v13.05a2.5 2.5 0 0 1 0 4.9V25h-1ZM8.97 14.47l1.56 1.56.7-.71-1.55-1.55-.7.7Z"></path></svg>
`,FibTimeZoneToolType="tool.fib.fibTimeZone";class FibTimeZonePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_trendRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_textRenderers",new Map)}renderer(){return this._renderer}getTextRenderer(ee){let ne=this._textRenderers.get(ee);return ne||(ne=new BaseTextRenderer,ne.setHitTestResult(new HitTestResult(HitTarget.MovePoint)),this._textRenderers.set(ee,ne)),ne}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<1)return;const ne=this._source.properties(),{width:re,height:se}=this._source.getScope().mediaSize;if(ne.fillBackground){const he=ne.transparency;for(let fe=1;fe<this._data.levels.length;fe++){const Ae=this._data.levels[fe-1],pe=this._data.levels[fe],Oe=ne.levels[fe].color,Fe={points:[new Point(pe.x,0),new Point(Ae.x,se)],color:Oe,lineWidth:0,backColor:Oe,transparency:he,extendLeft:!1,extendRight:!1},Ne=new RectangleRenderer;Ne.setData(Fe),this._renderer.append(Ne)}}let ae=ne.horzLabelsAlign;ae=ae===HorizontalAlign.Left?HorizontalAlign.Right:ae===HorizontalAlign.Right?HorizontalAlign.Left:HorizontalAlign.Center;const le=ne.vertLabelsAlign,ce=ne.showLabels;for(let he=0;he<ne.levels.length;he++){const fe=ne.levels[he];let Ae;const{x:pe}=this._data.levels[he];if(ce){let ze;switch(le){case"top":ze=new Point(pe,0);break;case"middle":ze=new Point(pe,se*.5);break;default:ze=new Point(pe,se);break}const He={points:[ze],text:String(fe.coeff),color:fe.color,vertAlign:le,horzAlign:ae,fontFamily:ChartFontFamily,offsetX:2,offsetY:0,fontSize:12},We=this.getTextRenderer(he);We.setData(He),this._needLabelExclusionPath()&&(Ae=getTextBoundaries(We,re,se)??void 0),this._renderer.append(We)}const Oe={x:pe,lineColor:fe.color,lineWidth:ne.levelsStyle.linewidth,lineStyle:ne.levelsStyle.linestyle,excludeBoundaries:Ae},Fe=new VerticalLineRenderer,Ne=new HitTestResult(HitTarget.MovePoint);Fe.setData(Oe),Fe.setHitTest(Ne),this._renderer.append(Fe)}if(ee.length===2){const he=ne.trendline,fe={points:ee,lineColor:he.color,lineWidth:he.linewidth,lineStyle:he.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendRenderer.setData(fe),this._renderer.append(this._trendRenderer)}if(ee.length===2)this._renderer.append(this.createLineAnchor({points:ee},0));else if(ee.length>0){const he=this.createLineAnchor({points:[new AnchorPoint(new Point(ee[0].x,se/2))]},0);this._renderer.append(he)}}_needLabelExclusionPath(){return this._source.properties().horzLabelsAlign==="center"}}class FibTimeZonePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibTimeZonePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((fe,Ae)=>new AnchorPoint(this.pointToScreenPoint(fe),{pointIndex:Ae})),ne=ee.map(fe=>fe.x),re=ee.map(fe=>fe.y);this.controlPoints.forEach((fe,Ae)=>{this._timeAxisViews[Ae].update(this._calculateTimeAxisViewData(fe.time,ee[Ae].x)),this._priceAxisViews[Ae].update(this._calculatePriceAxisViewData(fe.price,ee[Ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const[se,ae]=this.controlPoints,le=ensure(this.chart.timeScale().timeToIndexEx(se.time)),ce=ae?ensure(this.chart.timeScale().timeToIndexEx(ae.time))-le:1,he=this._props.levels.reduce((fe,Ae)=>{const pe=Math.round(le+Ae.coeff*ce),Oe=ensure(this.chart.timeScale().logicalToCoordinate(pe));return fe.push({x:Oe}),fe},[]);this._lines.update({points:ee,levels:he})}}class FibTimeZoneTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibTimeZoneToolType);Ee(this,"steps",2)}createPrimitive(){return new FibTimeZonePrimitive({id:this.id,points:[],horzLabelsAlign:HorizontalAlign.Right,vertLabelsAlign:VerticalAlign.Bottom,showLabels:!0,fillBackground:!1,transparency:80,trendline:{visible:!0,color:"#808080",linewidth:1,linestyle:LineStyleType.dashed},levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{coeff:0,color:"#808080FF"},{coeff:1,color:"#2962FFFF"},{coeff:2,color:"#2962FFFF"},{coeff:3,color:"#2962FFFF"},{coeff:5,color:"#2962FFFF"},{coeff:8,color:"#2962FFFF"},{coeff:13,color:"#2962FFFF"},{coeff:21,color:"#2962FFFF"},{coeff:34,color:"#2962FFFF"},{coeff:55,color:"#2962FFFF"},{coeff:89,color:"#2962FFFF"}]},...this.resetArgs)}}const fibFibTimZone={type:FibTimeZoneToolType,icon:icon$13,Ctor:FibTimeZoneTool},icon$12=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M21.5 23h-14v1h14zM5 7.5v14h1v-14z"></path><path d="M12 23c0-3.314-2.686-6-6-6h-.5v1h.5c2.761 0 5 2.239 5 5v.5h1v-.5z"></path><path d="M20 23c0-7.732-6.268-14-14-14h-.5v1h.5c7.18 0 13 5.82 13 13v.5h1v-.5z"></path><path d="M16 23c0-5.523-4.477-10-10-10h-.5v1h.5c4.971 0 9 4.029 9 9v.5h1v-.5z"></path><path d="M5.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,FibWedgeToolType="tool.fib.fibWedge";class ArcWedgeRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(this._data===null)return null;const ee=te.subtract(this._data.center),ne=ee.length();if(Math.abs(ne-this._data.radius)<=4){const re=te.subtract(this._data.p1).length(),se=te.subtract(this._data.p2).length();if(Math.max(re,se)<=this._data.p1.subtract(this._data.p2).length())return this._hitTest}if(this._data.fillBackground&&ne<=this._data.radius){const re=this._data.p1.subtract(this._data.center).normalized(),se=this._data.p2.subtract(this._data.center).normalized(),ae=ee.normalized(),le=re.dotProduct(se),ce=ae.dotProduct(re),he=ae.dotProduct(se);if(ce>=le&&he>=le)return this._backgroundHitTest}return null}drawImpl(te){if(this._data===null)return;const ee=te.context;if(ee.beginPath(),ee.strokeStyle=this._data.color,ee.lineWidth=this._data.linewidth,ee.arc(this._data.center.x,this._data.center.y,this._data.radius,this._data.angle1,this._data.angle2),ee.stroke(),!!this._data.fillBackground){if(ee.arc(this._data.center.x,this._data.center.y,this._data.prevRadius,this._data.angle2,this._data.angle1,!0),this._data.gradient){const ne=ee.createRadialGradient(this._data.center.x,this._data.center.y,this._data.prevRadius,this._data.center.x,this._data.center.y,this._data.radius);ne.addColorStop(0,generateColor(this._data.color1,this._data.transparency)),ne.addColorStop(1,generateColor(this._data.color2,this._data.transparency)),ee.fillStyle=ne}else ee.fillStyle=generateColor(this._data.color,this._data.transparency,!0);ee.fill()}}}class FibWedgePaneView extends FibWIthLabelsPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_baseTrendRenderer",new LineRenderer);Ee(this,"_edgeTrendRenderer",new LineRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(!(ee!=null&&ee.length))return;if(ee.length<3){this._updateRenderer();return}const[ne,re,se]=ee,ae=re.subtract(ne).normalized(),le=se.subtract(ne).normalized(),ce=new Point(1,0),he=new Point(0,1);let fe=Math.acos(ae.dotProduct(ce));ae.dotProduct(he)<0&&(fe=2*Math.PI-fe);let Ae=Math.acos(le.dotProduct(ce));if(le.dotProduct(he)<0&&(Ae=2*Math.PI-Ae),Ae<fe&&([fe,Ae]=[Ae,fe]),Math.abs(fe-Ae)>Math.PI){const Oe=Math.min(fe,Ae);fe=Math.max(fe,Ae),Ae=Oe+2*Math.PI}const pe=this._source.properties();if(ee.length>=2){const Oe=pe.levels.reduce((Fe,Ne,ze)=>{const He=Ne.coeff,We=Ne.color,je=Math.abs(re.subtract(ne).length()*He),Ue=ae.add(le).scaled(.5).normalized().scaled(je),Ge=ne.add(Ue),Ze=ne.add(ae.scaled(je)),Ye=ne.add(le.scaled(je));return Fe.push({coeff:He,color:We,radius:je,labelPoint:Ge,p1:Ze,p2:Ye,linewidth:pe.levelsStyle.linewidth,linestyle:pe.levelsStyle.linestyle,index:ze}),Fe},[]);this._updateRenderer(fe,Ae,Oe)}}_updateRenderer(ee=NaN,ne=NaN,re=[]){var ze;if(((ze=this.points())==null?void 0:ze.length)<2)return;const se=this._source.properties(),[ae,le]=this.points(),he=se.trendline.visible?se.trendline.linewidth:0,fe=se.trendline.linestyle;if(this._baseTrendRenderer.setData({points:[ae,le],lineColor:se.trendline.color,lineWidth:he,lineStyle:fe,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(this._baseTrendRenderer),this.points().length<3){this.addAnchors(this._renderer);return}let Ae=this.points()[2];const pe=le.subtract(ae).length(),Oe=Ae.subtract(ae).normalized();Ae=ae.add(Oe.scaled(pe)),this._edgeTrendRenderer.setData({points:[ae,Ae],lineColor:se.trendline.color,lineWidth:he,lineStyle:fe,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(this._edgeTrendRenderer);for(let He=re.length-1;He>=0;He--){const We=re[He],je=new ArcWedgeRenderer;je.setData({center:this.points()[0],radius:We.radius,prevRadius:He>0?re[He-1].radius:0,color:We.color,linewidth:We.linewidth,angle1:ee,angle2:ne,p1:We.p1,p2:We.p2,fillBackground:se.fillBackground,transparency:se.transparency,color1:"",color2:""}),je.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(je);const Ue=this._updateLabelForLevel({levelIndex:We.index,coeff:We.coeff,color:We.color,leftPoint:We.labelPoint,rightPoint:We.labelPoint,price:"",horzAlign:HorizontalAlign.Left,vertAlign:VerticalAlign.Middle});Ue&&this._renderer.append(Ue)}const Fe=[ae,le];this._model.currentCreating!==this._source&&Fe.push(new AnchorPoint(Ae,{pointIndex:2}));const Ne=this.createLineAnchor({points:Fe},0);this._renderer.append(Ne)}}class FibWedgePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FibWedgePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){if(super.setPoint(ee,ne,re),ee===2){const se=ensure(this.pointToScreenPoint(this.controlPoints[0]));let ae=ensure(this.pointToScreenPoint(this.controlPoints[1]));const ce=ensure(this.pointToScreenPoint(this.controlPoints[2])).subtract(se).length();let he=ae.subtract(se);he.length()<=0&&(he=new Point(1,0)),ae=se.add(he.normalized().scaled(ce));const fe=ensure(this.screenPointToPoint(ae));this.controlPoints[1]=fe}else{const se=ensure(this.pointToScreenPoint(this.controlPoints[0])),ae=ensure(this.pointToScreenPoint(this.controlPoints[1]));let le=ensure(this.pointToScreenPoint(this.controlPoints[2]));const ce=ae.subtract(se).length();let he=le.subtract(se);he.length()<=0&&(he=new Point(1,0)),le=se.add(he.normalized().scaled(ce));const fe=ensure(this.screenPointToPoint(le));this.controlPoints[2]=fe}}addPoint(ee,ne){if(ne===2){const re=ensure(this.pointToScreenPoint(this.controlPoints[0])),se=ensure(this.pointToScreenPoint(this.controlPoints[1]));let ae=ensure(this.pointToScreenPoint(ee));const le=se.subtract(re).length(),ce=ae.subtract(re).normalized();ae=re.add(ce.scaled(le)),ee=this.screenPointToPoint(ae)}return super.addPoint(ee,ne)}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class FibWedgeTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FibWedgeToolType);Ee(this,"steps",3)}createPrimitive(){return new FibWedgePrimitive({id:this.id,points:[],levels:[{coeff:.236,color:"#F23645"},{coeff:.382,color:"#FF9800"},{coeff:.5,color:"#4CAF50"},{coeff:.618,color:"#089981"},{coeff:.786,color:"#00BCD4"},{coeff:1,color:"#808080"}],levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},showCoeffs:!0,fillBackground:!0,transparency:80,trendline:{visible:!0,color:"#808080",linewidth:2,linestyle:LineStyleType.solid}},...this.resetArgs)}}const fibFibWedge={type:FibWedgeToolType,icon:icon$12,Ctor:FibWedgeTool},icon$11=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M20.349 20.654l4.489-.711-.156-.988-4.489.711z"></path><path d="M7.254 22.728l9.627-1.525-.156-.988-9.627 1.525z"></path><path d="M7.284 22.118l15.669-8.331-.469-.883-15.669 8.331z"></path><path d="M6.732 21.248l8.364-15.731-.883-.469-8.364 15.731z"></path><path d="M17.465 18.758l-8.188-8.188-.707.707 8.188 8.188z"></path><path d="M6.273 20.818l1.499-9.467-.988-.156-1.499 9.467z"></path><path d="M8.329 7.834l.715-4.516-.988-.156-.715 4.516z"></path><path d="M7.354 21.354l17-17-.707-.707-17 17z"></path><path d="M5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM7.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 22c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PitchfanToolType="tool.fib.pitchfan";class ChannelRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(this._data===null)return;const ee=te.context,ne=this._visiblePolygon(te.mediaSize);if(ne!==null){ee.beginPath(),ee.moveTo(ne[0].x,ne[0].y);for(let re=1;re<ne.length;re++)ee.lineTo(ne[re].x,ne[re].y);ee.fillStyle=generateColor(this._data.color,this._data.transparency,!0),ee.fill()}}_visiblePolygon(te){const ee=ensure(this._data),ne=ee.p1,re=ee.p2,se=ee.p3,ae=ee.p4,le=arePointsEqual(ne,re),ce=arePointsEqual(se,ae),he=distanceToLine(ne,re,se).distance,fe=distanceToLine(ne,re,ae).distance,Ae=he<1e-6&&fe<1e-6;if(le||ce||Ae||te.width<=0||te.height<=0)return null;let pe=[new Point(0,0),new Point(te.width,0),new Point(te.width,te.height),new Point(0,te.height)];return pe=clipPolygonByEdge(pe,ne,re,[ae,se]),pe=clipPolygonByEdge(pe,ae,se,[ne,re]),!arePointsEqual(se,ne)&&!ee.extendLeft&&(pe=clipPolygonByEdge(pe,se,ne,[re,ae])),pe}}class PitchfanPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_medianRenderer",new LineRenderer);Ee(this,"_sideRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const[ne]=ee,re=new AnchorPoint(ee.length===3?ee[1].add(ee[2]).scaled(.5):ee.length===2?ee[1]:ne,{pointIndex:3}),se=this._source.properties(),ae=se.median,le={points:[ne,re.point],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};if(this._medianRenderer.setData(le),this._renderer.append(this._medianRenderer),ee.length<3){this.addAnchors(this._renderer);return}const ce={points:[ee[1],ee[2]],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._sideRenderer.setData(ce),this._renderer.append(this._sideRenderer);const he=ee[2].subtract(ee[1]).scaled(.5),fe=se.fillBackground,Ae=se.transparency;let pe=0;se.levels.forEach(Oe=>{const Fe=Oe.coeff,Ne=Oe.color,ze=re.point.addScaled(he,Fe),He=re.point.addScaled(he,-Fe);if(fe){const Ue=new ChannelRenderer;Ue.setData({p1:ne,p2:ze,p3:ne,p4:re.point.addScaled(he,pe),color:Ne,transparency:Ae,hittestOnBackground:!0,extendLeft:!1}),this._renderer.append(Ue);const Ge=new ChannelRenderer;Ge.setData({p1:ne,p2:He,p3:ne,p4:re.point.addScaled(he,-pe),color:Ne,transparency:Ae,hittestOnBackground:!0,extendLeft:!1}),this._renderer.append(Ge)}pe=Fe;const We=new LineRenderer;We.setData({points:[ne,ze],lineColor:Ne,lineWidth:se.levelsStyle.linewidth,lineStyle:se.levelsStyle.linestyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),We.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(We);const je=new LineRenderer;je.setData({points:[ne,He],lineColor:Ne,lineWidth:se.levelsStyle.linewidth,lineStyle:se.levelsStyle.linestyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),je.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(je)}),this.addAnchors(this._renderer)}}class PitchfanPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PitchfanPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class PitchfanTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PitchfanToolType);Ee(this,"steps",3)}createPrimitive(){return new PitchfanPrimitive({id:this.id,points:[],fillBackground:!0,transparency:80,levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{coeff:.5,color:"#00BCD4"},{coeff:1,color:"#2962FF"}],median:{visible:!0,color:"#F23645",linewidth:2,linestyle:LineStyleType.solid}},...this.resetArgs)}}const fibPitchfan={type:PitchfanToolType,icon:icon$11,Ctor:PitchfanTool},icon$10=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4 25h22v-1h-22z" id="Line"></path><path d="M4 21h22v-1h-22z"></path><path d="M6.5 17h19.5v-1h-19.5z"></path><path d="M5 14.5v-3h-1v3zM6.617 9.275l10.158-3.628-.336-.942-10.158 3.628z"></path><path d="M18.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM4.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM4.5 18c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,TrendBasedFibExtensionToolType="tool.fib.trendBasedFibExtension";class TrendBasedFibExtensionPaneView extends FibHorizontalLevelsPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRendererPoints12",new LineRenderer);Ee(this,"_trendLineRendererPoints23",new LineRenderer);Ee(this,"_rectangleRenderers",new Map)}renderer(){return this._renderer}getRectRenderer(ee){return this._rectangleRenderers.has(ee)||this._rectangleRenderers.set(ee,new RectangleRenderer),ensure(this._rectangleRenderers.get(ee))}_updateImpl(){this._renderer.clear();const ee=this.points();if(ee.length<2)return;const[ne,re]=ee,se=this._source.properties(),ae=se.trendline;if(ae.visible){const He={points:[ne,re],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendLineRendererPoints12.setData(He),this._renderer.append(this._trendLineRendererPoints12)}if(ee.length<3){this.addAnchors(this._renderer);return}const le=se.levels.reduce((He,We,je)=>{const Ue=se.levels[je];if(!Ue.visible)return He;const Ge=Ue.coeff,Ze=Ue.color;return He.push({color:Ze,coeff:Ge,price:this._data.levels[je].price,y:this._data.levels[je].y,linewidth:se.levelsStyle.linewidth,linestyle:se.levelsStyle.linestyle,index:je}),He},[]),ce=ee[2];let he=null;ae.visible&&(he=this._trendLineRendererPoints23,he.setData({points:[re,ce],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}));const fe=se.fillBackground,Ae=se.transparency,pe=se.extendLinesLeft,Oe=se.extendLines,Fe=Math.min(ce.x,re.x),Ne=Math.max(ce.x,re.x);if(fe)for(let He=1;He<le.length;He++){const We=le[He-1],je=le[He],Ue={points:[new Point(Fe,je.y),new Point(Ne,We.y)],color:je.color,lineWidth:0,backColor:je.color,transparency:Ae,extendLeft:pe,extendRight:Oe},Ge=this.getRectRenderer(He);Ge.setData(Ue),this._renderer.append(Ge)}const ze=this._source.getScope();this._addLevels({levels:le,mediaSize:ze.mediaSize,left:Fe,right:Ne,showLabel:se.showCoeffs||se.showPrices,showText:se.showText,labelAlign:[se.horzLabelsAlign,se.vertLabelsAlign],textAlign:[se.horzTextAlign,se.vertTextAlign],extendLeft:pe,extendRight:Oe,fontSize:se.labelFontSize,isOnScreen:!0,trendLineRenderer:he}),this.addAnchors(this._renderer)}}class TrendBasedFibExtensionPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new TrendBasedFibExtensionPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le})),ne=ee.map(ae=>ae.x),re=ee.map(ae=>ae.y);this.controlPoints.forEach((ae,le)=>{this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ee[le].x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ee[le].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));let se=[];if(this.controlPoints.length>2){const[ae,le,ce]=this.controlPoints,he=this._props.reverse??!1,fe=he?ae.price:le.price,Ae=he?le.price:ae.price,pe=fe-Ae;let Oe=0,Fe;const ze=this.chart.options().rightPriceScale.mode===pi.Logarithmic&&this._props.fibLevelsBasedOnLogScale;ze&&(Oe=ensure(this.priceScale().priceToCoordinate(fe))-ensure(this.priceScale().priceToCoordinate(Ae)),Fe=ensure(this.priceScale().priceToCoordinate(ce.price)));const He={price:ce.price,coordinate:Fe??NaN},We={price:pe,coordinate:Oe};se=this._props.levels.reduce((je,Ue)=>{if(!Ue.visible)return je;const Ge=fibLevelCoordinate(He,We,Ue.coeff,this.series,ze),Ze=fibLevelPrice(He,We,Ue.coeff,this.series,ze);return je.push({y:Ge,price:this.series.priceFormatter().format(Ze)}),je},[])}this._lines.update({points:ee,levels:se})}}class TrendBasedFibExtensionTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",TrendBasedFibExtensionToolType);Ee(this,"steps",3)}createPrimitive(){return new TrendBasedFibExtensionPrimitive({id:this.id,points:[],showCoeffs:!0,showPrices:!0,fillBackground:!0,transparency:80,extendLines:!1,extendLinesLeft:!1,horzLabelsAlign:HorizontalAlign.Left,vertLabelsAlign:VerticalAlign.Middle,showText:!0,horzTextAlign:HorizontalAlign.Center,vertTextAlign:VerticalAlign.Middle,reverse:!1,coeffsAsPercents:!1,fibLevelsBasedOnLogScale:!1,labelFontSize:12,trendline:{visible:!0,color:"#808080",linewidth:2,linestyle:LineStyleType.dashed},levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{visible:!0,coeff:0,color:"#808080"},{visible:!0,coeff:.236,color:"#F23645"},{visible:!0,coeff:.382,color:"#FF9800"},{visible:!0,coeff:.5,color:"#4CAF50"},{visible:!0,coeff:.618,color:"#089981"},{visible:!0,coeff:.786,color:"#00BCD4"},{visible:!0,coeff:1,color:"#808080"},{visible:!0,coeff:1.618,color:"#2962FF"},{visible:!0,coeff:2.618,color:"#F23645"},{visible:!0,coeff:3.618,color:"#9C27B0"},{visible:!0,coeff:4.236,color:"#E91E63"}]},...this.resetArgs)}}const fibTrendBasedFibExtension={type:TrendBasedFibExtensionToolType,icon:icon$10,Ctor:TrendBasedFibExtensionTool},icon$$=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M20 2v22h1v-22z"></path><path d="M24 2v22h1v-22z"></path><path d="M4.673 11.471l3.69 10.333.942-.336-3.69-10.333z"></path><path d="M17 21.535v-19.535h-1v19.535z"></path><path d="M11.5 24h3v-1h-3z"></path><path d="M4.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM9.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM16.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,TrendBasedFibTimeToolType="tool.fib.trendBasedFibTime";class TrendBasedFibTimePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_trendLineRendererPoints12",new LineRenderer);Ee(this,"_trendLineRendererPoints23",new LineRenderer);Ee(this,"_textRenderers",new Map);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}getTextRenderers(ee){let ne=this._textRenderers.get(ee);return ne||(ne=new BaseTextRenderer,this._textRenderers.set(ee,ne)),ne}_needLabelExclusionPath(){return this._source.properties().horzLabelsAlign==="center"}_updateImpl(){this._renderer.clear();const ee=this._source.properties(),ne=this.points();if((ne==null?void 0:ne.length)<2)return;const[re,se]=ne,ae=ee.trendline;if(ae.visible){const Oe={points:[re,se],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendLineRendererPoints12.setData(Oe),this._renderer.append(this._trendLineRendererPoints12)}if(ne.length<3){this.addAnchors(this._renderer);return}const le=ne[2];if(ae.visible){const Oe={points:[se,le],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendLineRendererPoints23.setData(Oe),this._renderer.append(this._trendLineRendererPoints23)}const{width:ce,height:he}=this._source.getScope().mediaSize;if(ee.fillBackground){const Oe=ee.transparency;for(let Fe=1;Fe<this._data.levels.length;Fe++){const Ne=this._data.levels[Fe-1],ze=this._data.levels[Fe],He=ee.levels[Fe],We={points:[new Point(Ne.x,0),new Point(ze.x,he)],color:He.color,lineWidth:0,backColor:He.color,transparency:Oe,extendLeft:!1,extendRight:!1},je=new RectangleRenderer;je.setData(We),this._renderer.append(je)}}let fe=ee.horzLabelsAlign;fe=fe===HorizontalAlign.Left?HorizontalAlign.Right:fe===HorizontalAlign.Right?HorizontalAlign.Left:HorizontalAlign.Center;const Ae=ee.vertLabelsAlign,pe=ee.showCoeffs;for(let Oe=0;Oe<ee.levels.length;Oe++){const Fe=ee.levels[Oe],Ne=this._data.levels[Oe];let ze;if(pe){let Ue;switch(Ae){case"top":Ue=new Point(Ne.x,0);break;case"middle":Ue=new Point(Ne.x,he/2);break;default:Ue=new Point(Ne.x,he)}const Ge={points:[Ue],text:String(Fe.coeff),color:Fe.color,vertAlign:Ae,horzAlign:fe,fontFamily:ChartFontFamily,offsetX:2,offsetY:0,fontSize:12},Ze=this.getTextRenderers(Oe);Ze.setData(Ge),this._needLabelExclusionPath()&&(ze=getTextBoundaries(Ze,ce,he)??void 0),this._renderer.append(Ze)}const He={x:Ne.x,lineColor:Fe.color,lineWidth:ee.levelsStyle.linewidth,lineStyle:ee.levelsStyle.linestyle,excludeBoundaries:ze},We=new HitTestResult(HitTarget.MovePoint),je=new VerticalLineRenderer;je.setData(He),je.setHitTest(We),this._renderer.append(je)}this.addAnchors(this._renderer)}}class TrendBasedFibTimePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new TrendBasedFibTimePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((he,fe)=>new AnchorPoint(this.pointToScreenPoint(he),{pointIndex:fe})),ne=ee.map(he=>he.x),re=ee.map(he=>he.y);this.controlPoints.forEach((he,fe)=>{this._timeAxisViews[fe].update(this._calculateTimeAxisViewData(he.time,ee[fe].x)),this._priceAxisViews[fe].update(this._calculatePriceAxisViewData(he.price,ee[fe].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));let se=[];const[ae,le,ce]=this.controlPoints;if(this.controlPoints.length>2&&le.time!==ae.time&&this.chart.timeScale().getVisibleRange()){const he=ensure(this.chart.timeScale().timeToIndexEx(ae.time)),fe=ensure(this.chart.timeScale().timeToIndexEx(le.time)),Ae=ensure(this.chart.timeScale().timeToIndexEx(ce.time)),pe=fe-he,Oe=Ae;se=this._props.levels.reduce((Fe,Ne)=>{if(!Ne.visible)return Fe;const ze=Ne.coeff,He=Math.round(Oe+ze*pe);return Fe.push({x:ensure(this.chart.timeScale().logicalToCoordinate(He))}),Fe},[])}this._lines.update({points:ee,levels:se})}}class TrendBasedFibTimeTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",TrendBasedFibTimeToolType);Ee(this,"steps",3)}createPrimitive(){return new TrendBasedFibTimePrimitive({id:this.id,points:[],showCoeffs:!0,fillBackground:!0,transparency:80,horzLabelsAlign:HorizontalAlign.Right,vertLabelsAlign:VerticalAlign.Bottom,trendline:{visible:!0,color:"#808080",linewidth:2,linestyle:LineStyleType.dashed},levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{visible:!0,coeff:0,color:"#808080"},{visible:!0,coeff:.382,color:"#F23645"},{visible:!0,coeff:.618,color:"#4CAF50"},{visible:!0,coeff:1,color:"#089981"},{visible:!0,coeff:1.382,color:"#00BCD4"},{visible:!0,coeff:1.618,color:"#808080"},{visible:!0,coeff:2,color:"#2962FF"},{visible:!0,coeff:2.382,color:"#E91E63"},{visible:!0,coeff:2.618,color:"#9C27B0"},{visible:!0,coeff:3,color:"#673AB7"}]},...this.resetArgs)}}const fibTrendBasedFibTime={type:TrendBasedFibTimeToolType,icon:icon$$,Ctor:TrendBasedFibTimeTool},icon$_=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M3.5 11h21v-1h-21z"></path><path d="M3.5 18h21v-1h-21z"></path><path d="M10 3.5v21h1v-21z"></path><path d="M17 3.5v21h1v-21z"></path><path d="M22.5 4v-1h-19.5v19.5h1v-18.5z"></path><path d="M24 24h-18.507v1h19.507v-19.5h-1z"></path><path d="M3.5 26c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 5c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,GannBoxToolType="tool.gann.gannBox";class GannBoxPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_leftTextRenderers",new Map);Ee(this,"_rightTextRenderers",new Map);Ee(this,"_topTextRenderers",new Map);Ee(this,"_bottomTextRenderers",new Map)}getTextRenderers(ee,ne){const re={left:this._leftTextRenderers,right:this._rightTextRenderers,top:this._topTextRenderers,bottom:this._bottomTextRenderers};let se=re[ee].get(ne);return se||(se=new BaseTextRenderer,re[ee].set(ne,se)),se}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties();if(ee.length<2){this.addAnchors(this._renderer);return}const re=ee[0],se=ee[1],ae=Math.min(re.x,se.x),le=Math.min(re.y,se.y),ce=Math.max(re.x,se.x),he=Math.max(re.y,se.y),fe=ne.fillHorzBackground,Ae=ne.horzTransparency,pe=ne.fillVertBackground,Oe=ne.vertTransparency,Fe=getNumericFormatter();for(let We=0;We<ne.hLevels.length;We++){if(We>0&&fe){const Ze=new RectangleRenderer;Ze.setData({points:[new Point(ae,this._data.hLevels[We].y),new Point(ce,this._data.hLevels[We-1].y)],color:ne.hLevels[We].color,backColor:ne.hLevels[We].color,transparency:Ae,lineWidth:0,extendLeft:!1,extendRight:!1}),this._renderer.append(Ze)}const je=new LineRenderer,Ue=new Point(ae,this._data.hLevels[We].y),Ge=new Point(ce,this._data.hLevels[We].y);if(je.setData({points:[Ue,Ge],lineColor:ne.hLevels[We].color,lineWidth:ne.linewidth,lineStyle:ne.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(je),ne.showLeftLabels){const Ze=this.getTextRenderers("left",We);Ze.setData({points:[Ue],text:Fe.format(ne.hLevels[We].coeff),color:ne.hLevels[We].color,horzAlign:HorizontalAlign.Right,vertAlign:VerticalAlign.Middle,fontFamily:ChartFontFamily,offsetX:5,offsetY:0,fontSize:12,forceTextAlign:!0}),this._renderer.append(Ze)}if(ne.showRightLabels){const Ze=this.getTextRenderers("right",We);Ze.setData({points:[Ge],text:Fe.format(ne.hLevels[We].coeff),color:ne.hLevels[We].color,horzAlign:HorizontalAlign.Left,vertAlign:VerticalAlign.Middle,fontFamily:ChartFontFamily,offsetX:5,offsetY:0,fontSize:12}),this._renderer.append(Ze)}}for(let We=0;We<ne.vLevels.length;We++){const je=this._data.vLevels[We].x;if(We>0&&pe){const Ye=new RectangleRenderer;Ye.setData({points:[new Point(this._data.vLevels[We-1].x,le),new Point(je,he)],color:ne.vLevels[We].color,backColor:ne.vLevels[We].color,transparency:Oe,lineWidth:0,extendLeft:!1,extendRight:!1}),this._renderer.append(Ye)}const Ue=new LineRenderer,Ge=new Point(je,le),Ze=new Point(je,he);if(Ue.setData({points:[Ge,Ze],lineColor:ne.vLevels[We].color,lineWidth:ne.linewidth,lineStyle:ne.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(Ue),ne.showTopLabels){const Ye=this.getTextRenderers("top",We);Ye.setData({points:[Ge],text:Fe.format(ne.vLevels[We].coeff),color:ne.vLevels[We].color,vertAlign:VerticalAlign.Bottom,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:3,fontSize:12}),this._renderer.append(Ye)}if(ne.showBottomLabels){const Ye=this.getTextRenderers("bottom",We);Ye.setData({points:[Ze],text:Fe.format(ne.vLevels[We].coeff),color:ne.vLevels[We].color,vertAlign:VerticalAlign.Top,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:5,fontSize:12}),this._renderer.append(Ye)}}const Ne=new AnchorPoint(new Point(ee[0].x,ee[1].y),{pointIndex:2}),ze=new AnchorPoint(new Point(ee[1].x,ee[0].y),{pointIndex:3}),He=this.createLineAnchor({points:[...ee,Ne,ze]},0);this._renderer.append(He)}}class GannBoxPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new GannBoxPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){switch(ee){case 2:{this.controlPoints[0].time=ne.time,this.controlPoints[1].price=ne.price;break}case 3:{this.controlPoints[1].time=ne.time,this.controlPoints[0].price=ne.price;break}default:super.setPoint(ee,ne,re)}}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((le,ce)=>new AnchorPoint(this.pointToScreenPoint(le),{pointIndex:ce})),ne=ee.map(le=>le.x),re=ee.map(le=>le.y);this.controlPoints.forEach((le,ce)=>{this._timeAxisViews[ce].update(this._calculateTimeAxisViewData(le.time,ee[ce].x)),this._priceAxisViews[ce].update(this._calculatePriceAxisViewData(le.price,ee[ce].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));let se=[],ae=[];if(this.controlPoints.length>1&&this.chart.timeScale().getVisibleRange()){const[le,ce]=this.controlPoints,he=this._props.reverse,fe=he?le.price-ce.price:ce.price-le.price,Ae=he?ce.price:le.price;se=this._props.hLevels.reduce((ze,He)=>{const We=He.coeff,je=Ae+We*fe;return ze.push({y:ensure(this.series.priceToCoordinate(je))}),ze},[]);const pe=ensure(this.chart.timeScale().timeToIndexEx(le.time)),Oe=ensure(this.chart.timeScale().timeToIndexEx(ce.time)),Fe=he?pe-Oe:Oe-pe,Ne=he?Oe:pe;ae=this._props.vLevels.reduce((ze,He)=>{const We=He.coeff,je=Math.round(Ne+We*Fe),Ue=ensure(this.chart.timeScale().logicalToCoordinate(je));return ze.push({x:Ue}),ze},[])}this._lines.update({points:ee,hLevels:se,vLevels:ae})}}class GannBoxTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",GannBoxToolType);Ee(this,"steps",2)}createPrimitive(){return new GannBoxPrimitive({id:this.id,points:[],color:"rgba(21, 56, 153, 0.8)",linewidth:2,linestyle:LineStyleType.solid,showTopLabels:!0,showBottomLabels:!0,showLeftLabels:!0,showRightLabels:!0,fillHorzBackground:!0,horzTransparency:80,fillVertBackground:!0,vertTransparency:80,reverse:!1,fans:{color:"rgb(156, 156, 156)",visible:!1},hLevels:[{coeff:0,color:"#808080"},{coeff:.25,color:"#FF9800"},{coeff:.382,color:"#00BCD4"},{coeff:.5,color:"#4CAF50"},{coeff:.618,color:"#089981"},{coeff:.75,color:"#2962FF"},{coeff:1,color:"#808080"}],vLevels:[{coeff:0,color:"#808080 "},{coeff:.25,color:"#FF9800"},{coeff:.382,color:"#00BCD4"},{coeff:.5,color:"#4CAF50"},{coeff:.618,color:"#089981"},{coeff:.75,color:"#2962FF"},{coeff:1,color:"#808080"}]},...this.resetArgs)}}const gannGannBox={type:GannBoxToolType,icon:icon$_,Ctor:GannBoxTool},icon$Z=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.354 21.354l7.097-7.097-.707-.707-7.097 7.097z"></path><path d="M17.249 11.458l7.105-7.105-.707-.707-7.105 7.105z"></path><path d="M7.542 22.683l17.296-2.739-.156-.988-17.296 2.739z" id="Line"></path><path d="M7.538 22.062l15.708-7.661-.438-.899-15.708 7.661z"></path><path d="M6.802 20.97l7.695-15.777-.899-.438-7.695 15.777z"></path><path d="M6.285 20.741l2.76-17.423-.988-.156-2.76 17.423z"></path><path d="M5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM15.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,GannFanToolType="tool.gann.gannFan";class GannFanPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_textRenderers",new Map)}renderer(){return this._renderer}getTextRenderer(ee){let ne=this._textRenderers.get(ee);return ne||(ne=new BaseTextRenderer(new HitTestResult(HitTarget.MovePoint)),this._textRenderers.set(ee,ne)),ne}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=ee[0],re=ee[1],se=re.x-ne.x,ae=re.y-ne.y,le=this._source.properties(),ce=le.fillBackground,he=le.transparency,fe=le.showLabels,Ae=getNumericFormatter(),pe=le.levels.reduce((Oe,Fe,Ne)=>{const ze=Fe.coeff1,He=Fe.coeff2,We=ze/He,je=`${Ae.format(ze)}/${Ae.format(He)}`,Ue=Fe.color;let Ge,Ze;return ze>He?(Ge=re.x,Ze=ne.y+ae/We):(Ge=ne.x+se*We,Ze=re.y),Oe.push({label:je,color:Ue,x:Ge,y:Ze,index:Ne}),Oe},[]);for(let Oe=0;Oe<pe.length;Oe++){const Fe=pe[Oe],Ne=new Point(Fe.x,Fe.y);if(ce){const He=Fe.index<4,We=Fe.index>4&&Oe>0;if(He){const je=pe[Oe+1];if(je){const Ue=new ChannelRenderer;Ue.setData({p1:ne,p2:Ne,p3:ne,p4:new Point(je.x,je.y),color:Fe.color,transparency:he,hittestOnBackground:!0,extendLeft:!1}),this._renderer.append(Ue)}}else if(We){const je=pe[Oe-1];if(je){const Ue=new ChannelRenderer;Ue.setData({p1:ne,p2:Ne,p3:ne,p4:new Point(je.x,je.y),color:Fe.color,transparency:he,hittestOnBackground:!0,extendLeft:!1}),this._renderer.append(Ue)}}}const ze=new LineRenderer;if(ze.setData({points:[ne,Ne],lineColor:Fe.color,lineWidth:le.levelsStyle.linewidth,lineStyle:le.levelsStyle.linestyle,extendLeft:!1,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),ze.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(ze),fe){const He=this.getTextRenderer(Oe);He.setData({points:[Ne],text:Fe.label,color:Fe.color,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Left,fontFamily:ChartFontFamily,offsetX:0,offsetY:5,fontSize:12}),this._renderer.append(He)}}this.addAnchors(this._renderer)}}class GannFanPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new GannFanPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class GannFanTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",GannFanToolType);Ee(this,"steps",2)}createPrimitive(){return new GannFanPrimitive({id:this.id,points:[],linewidth:2,showLabels:!0,fillBackground:!0,transparency:80,levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{coeff1:1,coeff2:8,color:"#FF9800"},{coeff1:1,coeff2:4,color:"#089981"},{coeff1:1,coeff2:3,color:"#4CAF50"},{coeff1:1,coeff2:2,color:"#089981"},{coeff1:1,coeff2:1,color:"#00BCD4"},{coeff1:2,coeff2:1,color:"#2962FF"},{coeff1:3,coeff2:1,color:"#9C27B0"},{coeff1:4,coeff2:1,color:"#E91E63"},{coeff1:8,coeff2:1,color:"#F23645"}]},...this.resetArgs)}}const gannGannFan={type:GannFanToolType,icon:icon$Z,Ctor:GannFanTool},icon$Y=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M22.5 4v-1h-19.5v19.5h1v-18.5z"></path><path d="M5.493 24v1h19.507v-19.5h-1v18.5z"></path><path d="M5.275 23.432l18.213-18.213-.707-.707-18.213 18.213z"></path><path d="M5.568 24.383l19.079-5.906-.296-.955-19.079 5.906z" id="Line-Copy-18"></path><path d="M4.587 22.68l5.891-19.032-.955-.296-5.891 19.032z"></path><path d="M3.5 11h21v-1h-21z"></path><path d="M3.5 18h21v-1h-21z"></path><path d="M10 3.5v21h1v-21z"></path><path d="M17 3.5v21h1v-21z"></path><path d="M23.975 23.475l1.025 1.025c0-11.874-9.626-21.5-21.5-21.5l1.025 1.025c10.506.517 18.932 8.944 19.45 19.45z"></path><path d="M3.5 26c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 5c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,GannSquareToolType="tool.gann.gannSquare";class LimitedPrecisionNumericFormatter{constructor(te,ee){Ee(this,"_precision");Ee(this,"_numericFormatter");this._precision=te??1,this._numericFormatter=new NumericFormatter({precision:this._precision,ignoreLocaleNumberFormat:ee})}format(te,ee){const ne=te.toFixed(this._precision),re=Math.pow(10,-this._precision),se=Math.max(parseFloat(ne),re);return this._numericFormatter.format(se,ee)}parse(te,ee){const ne=this._numericFormatter.parse(te,ee);return ne.res?{res:!0,value:ne.value,suggest:this.format(ne.value)}:ne}}class GannArcRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(this._data===null)return null;const{center:ee,edge:ne,point:re}=this._data,se=te.subtract(ee),ae=ne.y/ne.x,le=new Point(se.x,se.y/ae),he=new Point(re.subtract(ee).x,re.subtract(ee).y/ae).length(),fe=le.length(),Ae=ne.x*le.x>=0&&ne.y*le.y>=0;return Math.abs(fe-he)<5&&Ae?new HitTestResult(HitTarget.MovePoint):null}drawImpl(te){if(this._data===null)return;const ee=te.context,{center:ne,edge:re,point:se,prevPoint:ae,color:le,linewidth:ce,transparency:he,fillBack:fe}=this._data,Ae=re.subtract(ne),pe=Ae.y/Ae.x;ee.lineCap="butt",ee.strokeStyle=le,ee.lineWidth=ce,ee.translate(ne.x,ne.y);const Oe=new Point(se.subtract(ne).x,se.subtract(ne).y/pe),Fe=new Point(ae.subtract(ne).x,ae.subtract(ne).y/pe);let Ne=Oe.length(),ze=Fe.length();ee.scale(1,pe);const He=Math.abs(re.x-ne.x);if(Math.abs(Ne)>He){const We=Math.sign(re.x-ne.x)*He;ee.rect(0,0,We,We),ee.clip()}fe&&(se.x<ne.x&&(Ne=-Ne,ze=-ze),ee.beginPath(),ee.moveTo(ze,0),ee.lineTo(Ne,0),ee.arcTo(Ne,Ne,0,Ne,Math.abs(Ne)),ee.lineTo(0,ze),ee.arcTo(ze,ze,ze,0,Math.abs(ze)),ee.fillStyle=generateColor(le,he,!0),ee.fill()),ee.beginPath(),se.x>ne.x?ee.arc(0,0,Math.abs(Ne),0,Math.PI/2,!1):ee.arc(0,0,Math.abs(Ne),-Math.PI/2,-Math.PI,!0),ee.scale(1,1/pe),ee.stroke()}}class GannSquarePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_verticalLevelsRenderers",new Map);Ee(this,"_horizontalLevelsRenderers",new Map);Ee(this,"_fanRenderers",new Map);Ee(this,"_arcRenderers",new Map);Ee(this,"_priceDiffTextRenderer",new BaseTextRenderer);Ee(this,"_indexDiffTextRenderer",new BaseTextRenderer);Ee(this,"_ratioTextRenderer",new BaseTextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}getVerticalLevelRenderer(ee){let ne=this._verticalLevelsRenderers.get(ee);return ne||(ne=new LineRenderer,this._verticalLevelsRenderers.set(ee,ne)),ne}getHorizontalLevelRenderer(ee){let ne=this._horizontalLevelsRenderers.get(ee);return ne||(ne=new LineRenderer,this._horizontalLevelsRenderers.set(ee,ne)),ne}getFanRenderer(ee){let ne=this._fanRenderers.get(ee);return ne||(ne=new LineRenderer,this._fanRenderers.set(ee,ne)),ne}getArcRenderer(ee){let ne=this._arcRenderers.get(ee);return ne||(ne=new GannArcRenderer,this._arcRenderers.set(ee,ne)),ne}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(ee.length<2){this.addAnchors(this._renderer);return}let[ne,re]=ee;const se=this._source.properties(),ae=se.reverse;ae&&([ne,re]=[re,ne]);const le=re.x-ne.x,ce=re.y-ne.y,Ae={barsCoordsRange:le,priceCoordsRange:ce,startPoint:ne,endPoint:re,p1:ne,p2:re,isLabelsVisible:se.showLabels,reversed:ae};this._prepareLevels(Ae),this._prepareFanLines(Ae),this._prepareArcs(Ae),this._prepareLabels(Ae);const pe=[ne,re];this._model.currentCreating===this._source&&pe.pop(),this._renderer.append(this.createLineAnchor({points:pe},0))}_prepareLevels(ee){const{startPoint:ne,endPoint:re,barsCoordsRange:se,priceCoordsRange:ae}=ee;this._source.properties().levels.forEach((ce,he)=>{if(!ce.visible)return;const fe=he/5,Ae=ne.x+fe*se,pe={points:[new Point(Ae,ne.y),new Point(Ae,re.y)],lineColor:ce.color,lineWidth:ce.width,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},Oe=this.getVerticalLevelRenderer(he);Oe.setData(pe),this._renderer.append(Oe);const Fe=ne.y+fe*ae,Ne={points:[new Point(ne.x,Fe),new Point(re.x,Fe)],lineColor:ce.color,lineWidth:ce.width,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},ze=this.getHorizontalLevelRenderer(he);ze.setData(Ne),this._renderer.append(ze)})}_prepareFanLines(ee){const{p1:ne,startPoint:re,endPoint:se,barsCoordsRange:ae,priceCoordsRange:le}=ee;this._source.properties().fanlines.forEach((ce,he)=>{if(!ce.visible)return;const fe=ce.x,Ae=ce.y;let pe,Oe;fe>Ae?(pe=se.x,Oe=re.y+Ae/fe*le):(Oe=se.y,pe=re.x+fe/Ae*ae);const Fe={points:[ne,new Point(pe,Oe)],lineColor:ce.color,lineWidth:ce.width,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},Ne=this.getFanRenderer(he);Ne.setData(Fe),this._renderer.append(Ne)})}_prepareArcs(ee){const{p1:ne,startPoint:re,endPoint:se,barsCoordsRange:ae,priceCoordsRange:le}=ee;let ce=ne;const he=this._source.properties().arcsBackground.fillBackground,fe=this._source.properties().arcsBackground.transparency;this._source.properties().arcs.forEach((Ae,pe)=>{if(!Ae.visible)return;const Oe=Ae.x/5,Fe=Ae.y/5,Ne=re.x+Oe*ae,ze=re.y+Fe*le,He={center:re,point:new Point(Ne,ze),edge:se,color:Ae.color,linewidth:Ae.width,fillBack:he,transparency:fe,prevPoint:ce},We=this.getArcRenderer(pe);We.setData(He),this._renderer.append(We),ce=He.point})}_prepareLabels(ee){const{p1:ne,p2:re,isLabelsVisible:se,reversed:ae}=ee;if(!se)return;let le=this._data.priceDiff,ce=this._data.barDiff;if(le==null||ce==null)return;ae&&(le=-le,ce=-ce);const he=new Point(ne.x,re.y),fe=forceLTRStr(this._data.priceDiffStr),Ae=this._getLabelData(he,fe);Ae.horzAlign=ce>0?HorizontalAlign.Right:HorizontalAlign.Left,Ae.vertAlign=le>0?VerticalAlign.Bottom:VerticalAlign.Top,Ae.offsetX=10,Ae.offsetY=le>0?8:10,Ae.forceTextAlign=!0,this._priceDiffTextRenderer.setData(Ae),this._renderer.append(this._priceDiffTextRenderer);const pe=new Point(re.x,ne.y),Oe=forceLTRStr(ce.toString()),Fe=this._getLabelData(pe,Oe);if(Fe.horzAlign=ce>0?HorizontalAlign.Left:HorizontalAlign.Right,Fe.vertAlign=le>0?VerticalAlign.Top:VerticalAlign.Bottom,Fe.offsetX=10,Fe.offsetY=le>0?10:8,Fe.forceTextAlign=!0,this._indexDiffTextRenderer.setData(Fe),this._renderer.append(this._indexDiffTextRenderer),!this._data.scaleRatio)return;const ze=forceLTRStr(this._data.scaleRatioStr),He=this._getLabelData(re,ze);He.horzAlign=ce>0?HorizontalAlign.Left:HorizontalAlign.Right,He.vertAlign=le>0?VerticalAlign.Bottom:VerticalAlign.Top,He.offsetX=10,He.offsetY=le>0?8:10,He.forceTextAlign=!0,this._ratioTextRenderer.setData(He),this._renderer.append(this._ratioTextRenderer)}_getLabelData(ee,ne){const re=this._source.properties().labelsStyle,se=this._source.properties().levels;return{points:[ee],text:ne,fontFamily:ChartFontFamily,fontSize:re.fontSize,bold:re.bold,italic:re.italic,color:se[se.length-1].color,backgroundColor:"transparent",horzAlign:HorizontalAlign.Center,vertAlign:VerticalAlign.Top,offsetX:0,offsetY:0,backgroundRoundRect:4}}}class GannSquarePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new GannSquarePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_scaleRatioFormatter",new LimitedPrecisionNumericFormatter(7));Ee(this,"scaleRatio",null)}addPoint(ee,ne){this.controlPoints.length>1&&this.controlPoints.pop();const re=super.addPoint(ee,ne);return should(this.series.priceScale().options().mode!==pi.Logarithmic),ne===1&&this.adjustEndPoint(),re}setPoint(ee,ne,re){super.setPoint(ee,ne,re),re.shiftkey?this._correctPoint(ee):this._correctScaleRatio()}_correctScaleRatio(){this.scaleRatio=this.getScaleRatio()}getPriceDiff(){const ee=this.controlPoints;if(ee.length<2)return null;const[ne,re]=ee;return re.price-ne.price}getIndexDiff(){const ee=this.controlPoints;if(ee.length<2)return null;const[ne,re]=ee;return ensure(this.chart.timeScale().timeToIndexEx(re.time))-ensure(this.chart.timeScale().timeToIndexEx(ne.time))}getScaleRatio(){const ee=this.getPriceDiff(),ne=this.getIndexDiff();return ee!==null&&ne!==null&&ne!==0?Math.abs(ee/ne):null}adjustEndPoint(){const[ee,ne]=this.controlPoints,re=this.pointToScreenPoint(ee),se=this.pointToScreenPoint(ne),ae=Math.abs(se.x-re.x);se.y>re.y?se.y=re.y+ae:se.y<re.y?se.y=re.y-ae:se.y=re.y,ne.price=ensure(this.series.coordinateToPrice(se.y))}isReversed(){return this._props.reverse}_correctFirstPoint(){this._correctPoint(this.isReversed()?0:1)}_correctPoint(ee){if(this.controlPoints.length<2)return;const ne=this.getIndexDiff();if(ne===null)return;const re=this.scaleRatio;if(re===null)return;const se=this.controlPoints[ee],ae=this.controlPoints[ee===0?1:0],le=se.price-ae.price>0,ce=ensure(this.chart.timeScale().timeToIndexEx(se.time))-ensure(this.chart.timeScale().timeToIndexEx(ae.time))>0;let he=le&&!ce||!le&&ce?-1:1;ee===0&&(he=-he),se.price=ae.price+he*ne*re}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((le,ce)=>new AnchorPoint(this.pointToScreenPoint(le),{pointIndex:ce})),ne=ee.map(le=>le.x),re=ee.map(le=>le.y);this.controlPoints.forEach((le,ce)=>{this._timeAxisViews[ce].update(this._calculateTimeAxisViewData(le.time,ee[ce].x)),this._priceAxisViews[ce].update(this._calculatePriceAxisViewData(le.price,ee[ce].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se=this.getPriceDiff(),ae=this.getScaleRatio();this._lines.update({points:ee,priceDiff:se,priceDiffStr:se?this.series.priceFormatter().format(se):"",barDiff:this.getIndexDiff(),scaleRatio:ae,scaleRatioStr:ae?this._scaleRatioFormatter.format(ae):""})}}class GannSquareTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",GannSquareToolType);Ee(this,"steps",2)}createPrimitive(){return new GannSquarePrimitive({id:this.id,points:[],fillBackground:!1,arcsBackground:{fillBackground:!0,transparency:80},reverse:!1,showLabels:!0,labelsStyle:{fontSize:12,bold:!1,italic:!1},levels:[{color:"#808080",width:2,visible:!0},{color:"#FF9800",width:2,visible:!0},{color:"#00bcd4",width:2,visible:!0},{color:"#4caf50",width:2,visible:!0},{color:"#089981",width:2,visible:!0},{color:"#808080",width:2,visible:!0}],fanlines:[{color:"#B39DDB",visible:!1,width:2,x:8,y:1},{color:"#F23645",visible:!1,width:2,x:5,y:1},{color:"#808080",visible:!1,width:2,x:4,y:1},{color:"#FF9800",visible:!1,width:2,x:3,y:1},{color:"#00bcd4",visible:!0,width:2,x:2,y:1},{color:"#4caf50",visible:!0,width:2,x:1,y:1},{color:"#089981",visible:!0,width:2,x:1,y:2},{color:"#089981",visible:!1,width:2,x:1,y:3},{color:"#2962FF",visible:!1,width:2,x:1,y:4},{color:"#9575cd",visible:!1,width:2,x:1,y:5},{color:"#B39DDB",visible:!1,width:2,x:1,y:8}],arcs:[{color:"#FF9800",visible:!0,width:2,x:1,y:0},{color:"#FF9800",visible:!0,width:2,x:1,y:1},{color:"#FF9800",visible:!0,width:2,x:1.5,y:0},{color:"#00bcd4",visible:!0,width:2,x:2,y:0},{color:"#00bcd4",visible:!0,width:2,x:2,y:1},{color:"#4caf50",visible:!0,width:2,x:3,y:0},{color:"#4caf50",visible:!0,width:2,x:3,y:1},{color:"#089981",visible:!0,width:2,x:4,y:0},{color:"#089981",visible:!0,width:2,x:4,y:1},{color:"#2962FF",visible:!0,width:2,x:5,y:0},{color:"#2962FF",visible:!0,width:2,x:5,y:1}]},...this.resetArgs)}}const gannGannSquare={type:GannSquareToolType,icon:icon$Y,Ctor:GannSquareTool},icon$X=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" stroke="currentColor" transform="translate(1 3)"><path d="M4.5 21.5h19V.5h-21v19m0-5h5m4 0h12M3 7.5h20M16.5 1v20"></path><path d="M9.5.5v12m0 4v5m-5.6-1.4l4.2-4.2M11 13L23 1M4.4 21l19.1-6M3.1 19.6L9 .5m14.5 21a21 21 0 0 0-21-21"></path><circle cx="2.5" cy="21.5" r="2"></circle><circle cx="9.5" cy="14.5" r="2"></circle></g></svg>
`,GannSquareFixedToolType="tool.gann.gannSquareFixed";class GannSquareFixedPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_verticalLevelsRenderers",new Map);Ee(this,"_horizontalLevelsRenderers",new Map);Ee(this,"_fanRenderers",new Map);Ee(this,"_arcRenderers",new Map);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}getVerticalLevelRenderer(ee){let ne=this._verticalLevelsRenderers.get(ee);return ne||(ne=new LineRenderer,this._verticalLevelsRenderers.set(ee,ne)),ne}getHorizontalLevelRenderer(ee){let ne=this._horizontalLevelsRenderers.get(ee);return ne||(ne=new LineRenderer,this._horizontalLevelsRenderers.set(ee,ne)),ne}getFanRenderer(ee){let ne=this._fanRenderers.get(ee);return ne||(ne=new LineRenderer,this._fanRenderers.set(ee,ne)),ne}getArcRenderer(ee){let ne=this._arcRenderers.get(ee);return ne||(ne=new GannArcRenderer,this._arcRenderers.set(ee,ne)),ne}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points().slice(),ne=this._data.screenPoints;if(ee.length<2||ne.length<2)return;const[re,se]=ne;ee[1]=new AnchorPoint(re,{pointIndex:1}),ee[2]=new AnchorPoint(se,{pointIndex:2});const ae=ee[0],le=ee.length===3?ee[2]:ee[1],ce=le.x-ae.x,he=le.y-ae.y,fe={barsCoordsRange:ce,priceCoordsRange:he,startPoint:ae,endPoint:le,p1:ae,p2:le};this._prepareLevels(fe),this._prepareFanLines(fe),this._prepareArcs(fe);const Ae=[ae,ee[1]];this._model.currentCreating===this._source&&Ae.pop(),this._renderer.append(this.createLineAnchor({points:Ae},0))}_prepareLevels(ee){const{startPoint:ne,endPoint:re,barsCoordsRange:se,priceCoordsRange:ae}=ee;this._source.properties().levels.forEach((ce,he)=>{if(!ce.visible)return;const fe=he/5,Ae=ne.x+fe*se,pe={points:[new Point(Ae,ne.y),new Point(Ae,re.y)],lineColor:ce.color,lineWidth:ce.width,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},Oe=this.getVerticalLevelRenderer(he);Oe.setData(pe),this._renderer.append(Oe);const Fe=ne.y+fe*ae,Ne={points:[new Point(ne.x,Fe),new Point(re.x,Fe)],lineColor:ce.color,lineWidth:ce.width,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},ze=this.getHorizontalLevelRenderer(he);ze.setData(Ne),this._renderer.append(ze)})}_prepareFanLines(ee){const{p1:ne,startPoint:re,endPoint:se,barsCoordsRange:ae,priceCoordsRange:le}=ee;this._source.properties().fanlines.forEach((ce,he)=>{if(!ce.visible)return;const fe=ce.x,Ae=ce.y;let pe,Oe;fe>Ae?(pe=se.x,Oe=re.y+Ae/fe*le):(Oe=se.y,pe=re.x+fe/Ae*ae);const Fe={points:[ne,new Point(pe,Oe)],lineColor:ce.color,lineWidth:ce.width,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},Ne=this.getFanRenderer(he);Ne.setData(Fe),this._renderer.append(Ne)})}_prepareArcs(ee){const{p1:ne,startPoint:re,endPoint:se,barsCoordsRange:ae,priceCoordsRange:le}=ee;let ce=ne;const he=this._source.properties().arcsBackground.fillBackground,fe=this._source.properties().arcsBackground.transparency;this._source.properties().arcs.forEach((Ae,pe)=>{if(!Ae.visible)return;const Oe=Ae.x/5,Fe=Ae.y/5,Ne=re.x+Oe*ae,ze=re.y+Fe*le,He={center:re,point:new Point(Ne,ze),edge:se,color:Ae.color,linewidth:Ae.width,fillBack:he,transparency:fe,prevPoint:ce},We=this.getArcRenderer(pe);We.setData(He),this._renderer.append(We),ce=He.point})}}class GannSquareFixedPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new GannSquareFixedPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}_calcAngle(){const ee=this.controlPoints;if(ee.length<2)return null;const[ne,re]=ee,se=this.pointToScreenPoint(ne),ae=this.pointToScreenPoint(re);if(se===null||ae===null)return null;let le=ae.subtract(se);if(le.length()<=0)return null;le=le.normalized();let ce=Math.acos(le.x);return le.y>0&&(ce=-ce),ce}getScreenPoints(){const ee=this.controlPoints;if(ee.length<2)return[];const ne=this._calcAngle();if(ne===null)return[];const[re,se]=ee,ae=ensure(this.pointToScreenPoint(re)),le=ensure(this.pointToScreenPoint(se)),ce=Math.sqrt(Math.pow(ae.x-le.x,2)+Math.pow(ae.y-le.y,2)),he=new Point(Math.cos(ne),-Math.sin(ne)),fe=he.normalized(),Ae=fe.x<0?-1:1,pe=fe.y<0?-1:1;return[ae.addScaled(he,ce),ae.add(new Point(5*ce*Ae,5*ce*pe))]}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee,screenPoints:this.getScreenPoints()})}}class GannSquareFixedTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",GannSquareFixedToolType);Ee(this,"steps",2)}createPrimitive(){return new GannSquareFixedPrimitive({id:this.id,points:[],fillBackground:!1,arcsBackground:{fillBackground:!0,transparency:80},reverse:!1,levels:[{color:"#808080",width:2,visible:!0},{color:"#FF9800",width:2,visible:!0},{color:"#00bcd4",width:2,visible:!0},{color:"#4caf50",width:2,visible:!0},{color:"#089981",width:2,visible:!0},{color:"#808080",width:2,visible:!0}],fanlines:[{color:"#B39DDB",visible:!1,width:2,x:8,y:1},{color:"#F23645",visible:!1,width:2,x:5,y:1},{color:"#808080",visible:!1,width:2,x:4,y:1},{color:"#FF9800",visible:!1,width:2,x:3,y:1},{color:"#00bcd4",visible:!0,width:2,x:2,y:1},{color:"#4caf50",visible:!0,width:2,x:1,y:1},{color:"#089981",visible:!0,width:2,x:1,y:2},{color:"#089981",visible:!1,width:2,x:1,y:3},{color:"#2962FF",visible:!1,width:2,x:1,y:4},{color:"#9575cd",visible:!1,width:2,x:1,y:5},{color:"#B39DDB",visible:!1,width:2,x:1,y:8}],arcs:[{color:"#FF9800",visible:!0,width:2,x:1,y:0},{color:"#FF9800",visible:!0,width:2,x:1,y:1},{color:"#FF9800",visible:!0,width:2,x:1.5,y:0},{color:"#00bcd4",visible:!0,width:2,x:2,y:0},{color:"#00bcd4",visible:!0,width:2,x:2,y:1},{color:"#4caf50",visible:!0,width:2,x:3,y:0},{color:"#4caf50",visible:!0,width:2,x:3,y:1},{color:"#089981",visible:!0,width:2,x:4,y:0},{color:"#089981",visible:!0,width:2,x:4,y:1},{color:"#2962FF",visible:!0,width:2,x:5,y:0},{color:"#2962FF",visible:!0,width:2,x:5,y:1}]},...this.resetArgs)}}const gannGannSquareFixed={type:GannSquareFixedToolType,icon:icon$X,Ctor:GannSquareFixedTool},icon$W=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4 15h8.5v-1h-8.5zM16.5 15h8.5v-1h-8.5z"></path><path d="M15 12v-8.5h-1v8.5zM14 16.5v8.5h1v-8.5z"></path><path d="M14.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,CrossLineToolType="tool.line.crossLine";class HorizontalLineRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){if(!this._data||!this._hitTest)return null;const ee=interactionTolerance().line,ne=Math.abs(te.y-this._data.y)<=ee+this._data.lineWidth/2,re=this._data.left===void 0||this._data.left-te.x<=ee,se=this._data.right===void 0||te.x-this._data.right<=ee;return ne&&re&&se?this._hitTest:null}drawImpl(te){if(!this._data)return;const{context:ee,horizontalPixelRatio:ne,verticalPixelRatio:re,mediaSize:se}=te;if(this._data.y<-this._data.lineWidth/2||this._data.y>se.height+this._data.lineWidth/2)return;ee.lineCap="butt",ee.strokeStyle=this._data.lineColor,ee.lineWidth=Math.max(1,Math.floor(this._data.lineWidth*ne)),this._data.lineStyle!==void 0&&setLineStyle(ee,this._data.lineStyle);const ae=this._data.left!==void 0?Math.max(this._data.left,0):0,le=this._data.right!==void 0?Math.min(this._data.right,se.width):se.width,ce=Math.round(this._data.y*re),he=Math.round(ae*ne),fe=Math.round(le*ne),Ae=this._data.excludeBoundaries;Ae!==void 0&&addExclusionAreaByScope(te,Ae),drawHorizontalLine(ee,ce,he,fe)}}class CrossLinePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_horizLineRenderer",new HorizontalLineRenderer(void 0,void 0,new HitTestResult(HitTarget.MovePoint)));Ee(this,"_vertLineRenderer",new VerticalLineRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)===0)return;const ne=this._source.properties();this._horizLineRenderer.setData({lineColor:ne.linecolor,lineStyle:ne.linestyle,lineWidth:ne.linewidth,y:ee[0].y}),this._vertLineRenderer.setData({lineColor:ne.linecolor,lineStyle:ne.linestyle,lineWidth:ne.linewidth,x:ee[0].x}),this._vertLineRenderer.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(this._horizLineRenderer),this._renderer.append(this._vertLineRenderer),this.addAnchors(this._renderer)}}class CrossLinePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_line",new CrossLinePaneView(this,this.model));Ee(this,"_paneView",[this._line]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ne,re)=>new AnchorPoint(this.pointToScreenPoint(ne),{pointIndex:re}));this.controlPoints.forEach((ne,re)=>{this._timeAxisViews[re].update(this._calculateTimeAxisViewData(ne.time,ee[re].x)),this._priceAxisViews[re].update(this._calculatePriceAxisViewData(ne.price,ee[re].y))}),this._paneView[0].update({points:ee})}priceAxisViews(){return this.properties().showPrice?this._priceAxisViews:[]}timeAxisViews(){return this.properties().showTime?this._timeAxisViews:[]}}class CrossLineTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",CrossLineToolType);Ee(this,"steps",1)}createPrimitive(){return new CrossLinePrimitive({id:this.id,points:[],linecolor:"#2A62FF",linestyle:LineStyleType.solid,linewidth:2,showPrice:!0,showTime:!0},...this.resetArgs)}}const lineCrossLine={type:CrossLineToolType,icon:icon$W,keybinding:KeyCode.KeyC|KeyMod.Alt,Ctor:CrossLineTool},icon$V=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4.354 25.354l5-5-.707-.707-5 5z"></path><path d="M12.354 17.354l5-5-.707-.707-5 5z"></path><path d="M20.354 9.354l5-5-.707-.707-5 5z"></path><path d="M18.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM10.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,ExtendedLineToolType="tool.line.extendedLine";class ExtendedLineTool extends TrendLineTool{constructor(){super(...arguments);Ee(this,"type",ExtendedLineToolType);Ee(this,"extendLeft",!0);Ee(this,"extendRight",!0)}}const lineExtendedLine={type:ExtendedLineToolType,icon:icon$V,Ctor:ExtendedLineTool},icon$U=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4 15h8.5v-1h-8.5zM16.5 15h8.5v-1h-8.5z"></path><path d="M14.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,HorizontalLineToolType="tool.line.horizontalLine";class HorizontalLinePaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_lineRenderer",new HorizontalLineRenderer(void 0,void 0,new HitTestResult(HitTarget.MovePoint)));Ee(this,"_labelRenderer",new TextRenderer);Ee(this,"_mode",TextMode.Preview)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)===0)return;const ne=this._source.properties();let re=!0;const{mediaSize:{width:se,height:ae}}=this._source.getScope(),le=ne.text,ce=this._isTextEditMode(),he=this._placeHolderMode();let fe;if(ne.showLabel&&le||he||ce){const Fe=ne.vertLabelsAlign,Ne=ne.horzLabelsAlign;let ze=0,He=0;Ne==="left"?He=3:Ne==="right"?(He=se,ze=3):He=se/2;const We=new Point(He,ee[0].y);this._labelRenderer.setData({points:[We],text:this._textDisplay(),color:this._textDisplayColor(),vertAlign:Fe,horzAlign:Ne,fontFamily:ChartFontFamily,offsetX:ze,offsetY:0,bold:ne.bold,italic:ne.italic,fontSize:ne.fontSize,forceTextAlign:!0,decorator:he?PlusTextRendererDecorator.instance():void 0}),this._labelRenderer.setCursorType(this._textCursorType()),this._isTextEditMode()||this._renderer.append(this._labelRenderer),this._needLabelExclusionPath(this._labelRenderer)&&(fe=getTextBoundaries(this._labelRenderer,se,ae)??void 0),re=this._labelRenderer.isOutOfScreen(se,ae),re?this.closeTextEditor():this._updateEditor(this._labelRenderer.getTextInfo())}const Ae={y:ee[0].y,lineColor:ne.lineColor,lineWidth:ne.lineWidth,lineStyle:ne.lineStyle,excludeBoundaries:fe};this._lineRenderer.setData(Ae);const pe=this._source.controlPoints[0].price;this._lineRenderer.setHitTest(new HitTestResult(HitTarget.MovePoint,{snappingPrice:pe}));const Oe=Ae.lineWidth/2+1;if(re=re&&(Ae.y<-Oe||Ae.y>ae+Oe),this._renderer.insert(this._lineRenderer,0),!re&&ee.length===1&&!this._isTextEditMode()){const Fe=new AnchorPoint(new Point(.9*se,ee[0].y),{pointIndex:0,resizeDirections:AnchorResizeVert}),Ne=this.createLineAnchor({points:[Fe]},0);this._renderer.append(Ne)}}_needLabelExclusionPath(ee,ne){const re=this._source.properties();return(ne??re.vertLabelsAlign)==="middle"&&needTextExclusionPath(ee)}}class HorizontalLinePrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new HorizontalLinePaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ne,re)=>new AnchorPoint(this.pointToScreenPoint(ne),{pointIndex:re}));this.controlPoints.forEach((ne,re)=>{this._priceAxisViews[re].update(this._calculatePriceAxisViewData(ne.price,ee[re].y))}),this._paneView[0].update({points:ee})}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){return this._lines.startTextEditing()}}class HorizontalLineTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",HorizontalLineToolType);Ee(this,"steps",1)}createPrimitive(ee){const ne=getI18nService(ee);return new HorizontalLinePrimitive({id:this.id,points:[],lineColor:"#2962FF",lineWidth:2,lineStyle:0,showPrice:!0,showLabel:!0,textColor:"#2962FF",fontSize:12,bold:!1,italic:!1,horzLabelsAlign:HorizontalAlign.Center,vertLabelsAlign:VerticalAlign.Middle,wordWrap:!0,text:"",placeholder:ne.t("tool.text.common.addText")},...this.getTextResetArgs(ee))}finishDrawing(){ensure(this._drawingSession).finishDrawing()}}const lineHorizontalLine={type:HorizontalLineToolType,icon:icon$U,keybinding:KeyCode.KeyH|KeyMod.Alt,Ctor:HorizontalLineTool},icon$T=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M8.5 15h16.5v-1h-16.5z"></path><path d="M6.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,HorizontalRayToolType="tool.line.horizontalRay";class HorzRayRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){if(this._data===null||this._data.points.length===0)return null;const ee=this._data.points[0];if(te.x<ee.x)return null;const ne=interactionTolerance().line;return Math.abs(te.y-ee.y)<=ne?this._hitTest:null}drawImpl(te){if(this._data===null||this._data.points.length===0)return;const{context:ee,horizontalPixelRatio:ne,verticalPixelRatio:re,bitmapSize:se}=te,ae=se.width,le=this._data.points[0],ce=le.y,he=Math.max(0,le.x),fe=Math.max(ae,le.x),Ae=this._data.linestyle===void 0||this._data.linestyle===LineStyleType.solid;ee.lineCap=Ae?"round":"butt",ee.strokeStyle=this._data.color,ee.lineWidth=Math.max(1,Math.floor(this._data.linewidth*ne)),this._data.linestyle!==void 0&&setLineStyle(ee,this._data.linestyle),this._data.excludeBoundaries!==void 0&&addExclusionAreaByScope(te,this._data.excludeBoundaries),drawHorizontalLine(ee,Math.round(ce*re),Math.round(he*ne),Math.round(fe*ne))}}class HorizontalRayPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_horzRayRenderer",new HorzRayRenderer);Ee(this,"_labelRenderer",new BaseTextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)===0)return;const ne=this._source.properties();let re,se=ee[0].clone();if(ne.showLabel&&ee.length===1){const le=ne.vertLabelsAlign,ce=ne.horzLabelsAlign,he=0;let fe=0;const Ae=ne.text,pe=ne.bold,Oe=ne.italic,Fe=ne.fontSize,{mediaSize:Ne}=this._source.getScope(),ze=Ne.width;if(ce==="right"){const We=this._labelRenderer.measure().width;se.x+We+3>=ze?se=se.add(new Point(We+3,0)):(se=new Point(ze,se.y),fe=3)}else ce==="center"&&(se=new Point((se.x+ze)/2,se.y));const He={points:[se],text:Ae,color:ne.textColor,vertAlign:le,horzAlign:ce,fontFamily:ChartFontFamily,offsetX:fe,offsetY:he,bold:pe,italic:Oe,fontSize:Fe,forceTextAlign:!0};if(this._labelRenderer.setData(He),this._renderer.append(this._labelRenderer),this._needLabelExclusionPath(this._labelRenderer)){const{width:We,height:je}=Ne;re=getTextBoundaries(this._labelRenderer,We,je)??void 0}}const ae={points:ee,color:ne.linecolor,linewidth:ne.linewidth,linestyle:ne.linestyle,excludeBoundaries:re};this._horzRayRenderer.setData(ae),this._horzRayRenderer.setHitTest(new HitTestResult(HitTarget.MovePoint,{snappingPrice:this._source.controlPoints[0].price})),this._renderer.append(this._horzRayRenderer),this.addAnchors(this._renderer)}_needLabelExclusionPath(ee,ne){const re=this._source.properties();return(ne??re.vertLabelsAlign)==="middle"&&needTextExclusionPath(ee)}}class HorizontalRayPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_line",new HorizontalRayPaneView(this,this.model));Ee(this,"_paneView",[this._line]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ne,re)=>new AnchorPoint(this.pointToScreenPoint(ne),{pointIndex:re}));this.controlPoints.forEach((ne,re)=>{this._priceAxisViews[re].update(this._calculatePriceAxisViewData(ne.price,ee[re].y))}),this._paneView[0].update({points:ee})}}class HorizontalRayTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",HorizontalRayToolType);Ee(this,"steps",1)}createPrimitive(){return new HorizontalRayPrimitive({id:this.id,points:[],linecolor:"#2962FF",linewidth:2,linestyle:0,showPrice:!0,showLabel:!1,textColor:"#2962FF",fontSize:12,bold:!1,italic:!1,text:"",horzLabelsAlign:HorizontalAlign.Center,vertLabelsAlign:VerticalAlign.Top},...this.resetArgs)}}const lineHorizontalRay={type:HorizontalRayToolType,icon:icon$T,keybinding:KeyCode.KeyJ|KeyMod.Alt,Ctor:HorizontalRayTool},icon$S=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero" clip-rule="evenodd"><path d="M22.4989 4C21.6705 4 20.9989 4.67157 20.9989 5.5C20.9989 5.91456 21.1664 6.28904 21.4387 6.56106C21.7106 6.83282 22.0848 7 22.4989 7C23.3274 7 23.9989 6.32843 23.9989 5.5C23.9989 4.67157 23.3274 4 22.4989 4ZM19.9989 5.5C19.9989 4.11929 21.1182 3 22.4989 3C23.8796 3 24.9989 4.11929 24.9989 5.5C24.9989 6.88071 23.8796 8 22.4989 8C21.9899 8 21.5159 7.8475 21.1209 7.58617L7.58575 21.1214C7.84733 21.5165 8 21.9907 8 22.5C8 23.8807 6.88071 25 5.5 25C4.11929 25 3 23.8807 3 22.5C3 21.1193 4.11929 20 5.5 20C6.00932 20 6.48351 20.1527 6.87864 20.4143L20.4136 6.87929C20.1518 6.48403 19.9989 6.0096 19.9989 5.5ZM5.5 21C4.67157 21 4 21.6716 4 22.5C4 23.3284 4.67157 24 5.5 24C6.32843 24 7 23.3284 7 22.5C7 22.0856 6.83265 21.7113 6.56066 21.4393C6.28867 21.1673 5.91435 21 5.5 21Z"></path><path d="M16 19.5C16 18.1193 17.1193 17 18.5 17H23.5C24.8807 17 26 18.1193 26 19.5V22.5C26 23.8807 24.8807 25 23.5 25H18.5C17.1193 25 16 23.8807 16 22.5V19.5ZM18.5 18C17.6716 18 17 18.6716 17 19.5V22.5C17 23.3284 17.6716 24 18.5 24H23.5C24.3284 24 25 23.3284 25 22.5V19.5C25 18.6716 24.3284 18 23.5 18H18.5Z"></path></g></svg>
`,InfoLineToolType="tool.line.infoLine";class InfoLineTool extends TrendLineTool{constructor(){super(...arguments);Ee(this,"type",InfoLineToolType);Ee(this,"showPriceRange",!0);Ee(this,"showPercentPriceRange",!0);Ee(this,"showPipsPriceRange",!0);Ee(this,"showBarsRange",!0);Ee(this,"showDistance",!0);Ee(this,"showAngle",!0);Ee(this,"alwaysShowStats",!0)}}const lineInfoLine={type:InfoLineToolType,icon:icon$S,Ctor:InfoLineTool},icon$R=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M8.354 20.354l5-5-.707-.707-5 5z"></path><path d="M16.354 12.354l8-8-.707-.707-8 8z"></path><path d="M14.5 15c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,RayToolType="tool.line.ray";class RayTool extends TrendLineTool{constructor(){super(...arguments);Ee(this,"type",RayToolType);Ee(this,"extendRight",!0)}}const lineRay={type:RayToolType,icon:icon$R,Ctor:RayTool},icon$Q=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M15.5 22.5c0-2.697-1.073-5.225-2.947-7.089l-.705.709c1.687 1.679 2.652 3.952 2.652 6.38h1z"></path><path d="M7.354 21.354l14-14-.707-.707-14 14z"></path><path d="M7.5 23h16.5v-1h-16.5z"></path><path d="M22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,TrendAngleToolType="tool.line.trendAngle";class AngleRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const ee=te.context;ee.translate(this._data.point.x,this._data.point.y),ee.strokeStyle=this._data.color,ee.setLineDash([1,2]);const ne=this._data.size;ee.beginPath(),ee.moveTo(0,0),ee.lineTo(ne,0),ee.arc(0,0,ne,0,-this._data.angle,this._data.angle>0),ee.stroke()}}class TrendAnglePaneView extends TrendToolWithStatsPaneView{constructor(){super(...arguments);Ee(this,"_trendRenderer",new LineRenderer(void 0,void 0,new HitTestResult(HitTarget.MovePoint)));Ee(this,"_angleLabelRenderer",new TextRenderer(new HitTestResult(HitTarget.MovePoint)));Ee(this,"_angleRenderer",new AngleRenderer);Ee(this,"_secondPoint",null)}_getPointsForStats(){return[this.points()[0],ensure(this._middlePoint),this.points()[1]]}_updateImpl(){this._renderer.clear();const ee=this._source,ne=ee.angle(),re=this.points();if(re.length>0&&ne!==null){const We=Math.cos(ne),je=-Math.sin(ne),Ue=new Point(We,je);this._secondPoint=re[0].addScaled(Ue,ensure(ee.distance())),this._middlePoint=midPoint(re[0],this._secondPoint)}if(re.length<2||this._secondPoint===null)return;const se=re[0],ae=re[1],le=this._source.properties();!le.showBarsRange&&!le.showPriceRange&&!le.showPercentPriceRange&&!le.showPipsPriceRange&&(this._label=null,this._labelData&&(this._labelData.text=""));const ce=le.linecolor,he={points:[se,this._secondPoint],lineColor:ce,lineWidth:le.linewidth,lineStyle:le.linestyle,extendLeft:le.extendLeft,extendRight:le.extendRight,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendRenderer.setData(he),this._renderer.append(this._trendRenderer);const fe=this._source.getScope(),Ae=box(new Point(0,0),new Point(fe.mediaSize.width,fe.mediaSize.height));let pe=!1;le.statsPosition===StatsPosition.Auto&&(pe=arePointsEqual(se,ae)?!pointInBox$1(se,Ae):intersectLineSegmentAndBox(lineSegment(se,ae),Ae)===null),(this.isHoveredSource()||this.isSelectedSource()||le.alwaysShowStats)&&!pe&&re.length===2&&this._renderer.append(this._updateAndReturnStatsRenderer(fe));const Oe=(this.isHoveredSource()||this.isSelectedSource())&&le.showMiddlePoint;this._middlePoint&&this._renderer.append(new SelectionRenderer({points:[new AnchorPoint(this._middlePoint,{pointIndex:0})],bgColors:this._lineAnchorColors([this._middlePoint]),color:ce,visible:Oe&&this.areAnchorsVisible(),hitTarget:HitTarget.Regular}));const Fe={point:se,angle:ee.angle()??0,color:ce,size:50};this._angleRenderer.setData(Fe),this._renderer.append(this._angleRenderer);const Ne=Fe.angle*180/Math.PI,ze=Math.round(Ne*100)/100+"º",He={points:[new Point(se.x+50,se.y)],text:forceLTRStr(ze),color:ce,horzAlign:HorizontalAlign.Left,fontFamily:ChartFontFamily,offsetX:5,offsetY:0,bold:le.bold,italic:le.italic,fontSize:le.fontSize,vertAlign:VerticalAlign.Middle};this._angleLabelRenderer.setData(He),this._renderer.append(this._angleLabelRenderer),this._renderer.append(this.createLineAnchor({points:[new AnchorPoint(se,{pointIndex:0}),new AnchorPoint(this._secondPoint,{pointIndex:1})]},0))}}class TrendAnglePrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_line",new TrendAnglePaneView(this,this.model,this.editingHelper));Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_paneView",[this._line]);Ee(this,"_angle",null);Ee(this,"_distance",0)}angle(){return this._angle}distance(){return this._distance}addPoint(ee,ne){const re=super.addPoint(ee,ne);return ne>0&&this._calculateAngle(),re}setPoint(ee,ne,re){super.setPoint(ee,ne,re),ee==1&&this._calculateAngle()}_calculateAngle(){const ee=ensure(this.pointToScreenPoint(this.controlPoints[0]));let ne=ensure(this.pointToScreenPoint(this.controlPoints[1])).subtract(ee);const re=ne.length();re>0?(ne=ne.normalized(),this._angle=Math.acos(ne.x),ne.y>0&&(this._angle=-this._angle),this._distance=re):this._angle=0}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._paneView[0].update({points:ee})}isCreationFinished(){return this._line.isCreationFinished()}startTextEditing(){return this._line.startTextEditing()}}class TrendAngleTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",TrendAngleToolType);Ee(this,"steps",2)}createPrimitive(ee){const ne=getI18nService(ee);return new TrendAnglePrimitive({id:this.id,points:[],linecolor:"#2962FF",linewidth:2,linestyle:0,extendLeft:!1,extendRight:!1,textColor:"#2962FF",fontSize:14,text:"",placeholder:"",wordWrap:!0,bold:!1,italic:!1,alwaysShowStats:!1,showMiddlePoint:!1,showPriceLabels:!1,showPriceRange:!1,showPercentPriceRange:!1,showPipsPriceRange:!1,showBarsRange:!1,showAngle:!1,statsPosition:StatsPosition.Right,formatBarCount:re=>ne.t("tool.line.common.bars",re)},...this.getTextResetArgs(ee))}finishDrawing(){ensure(this._drawingSession).finishDrawing()}}const lineTrendAngle={type:TrendAngleToolType,icon:icon$Q,Ctor:TrendAngleTool},icon$P=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.354 21.354l14-14-.707-.707-14 14z"></path><path d="M22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,lineTrendLine={type:TrendLineToolType,icon:icon$P,Ctor:TrendLineTool,keybinding:KeyCode.KeyT|KeyMod.Alt},icon$O=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M15 12.5v-8.5h-1v8.5zM14 16.5v8.5h1v-8.5z"></path><path d="M14.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,VerticalLineToolType="tool.line.verticalLine";class VerticalLinePaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_lineRenderer",new VerticalLineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_labelRenderer",new TextRenderer(new HitTestResult(HitTarget.MovePoint)))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)===0)return;const{mediaSize:{width:ne,height:re}}=this._source.getScope(),se=this._source.properties();this._placeHolderMode();let ae,le=!0;const ce={x:ee[0].x,lineColor:se.linecolor,lineWidth:se.linewidth,lineStyle:se.linestyle,excludeBoundaries:ae},he=ce.lineWidth/2+1;if(le=le&&(ce.x<-he||ce.x>ne+he),this._lineRenderer.setData(ce),this._lineRenderer.setHitTest(new HitTestResult(HitTarget.MovePoint,{})),this._renderer.insert(this._lineRenderer,0),!le&&ee.length===1&&!this._isTextEditMode()){const fe=new Point(ee[0].x,.9*re),Ae=new AnchorPoint(fe,{pointIndex:0,resizeDirections:AnchorResizeHorz});this._renderer.append(this.createLineAnchor({points:[Ae]},0))}}_needLabelExclusionPath(ee){const ne=this._source.properties(),re=ne.textOrientation==="horizontal",se=ne.text;if(re)return se.trim()!=="";if(ne.horzLabelsAlign!=="center")return!1;const ae=ee.getLinesInfo().lines;return ae.length%2===0?!1:ae[Math.floor(ae.length/2)].text.trim()!==""}}class VerticalLinePrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_line",new VerticalLinePaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._line]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ne,re)=>new AnchorPoint(this.pointToScreenPoint(ne),{pointIndex:re}));this.controlPoints.forEach((ne,re)=>{this._timeAxisViews[re].update(this._calculateTimeAxisViewData(ne.time,ee[re].x))}),this._paneView[0].update({points:ee})}isCreationFinished(){return this._line.isCreationFinished()}startTextEditing(){return this._line.startTextEditing()}}class VerticalLineTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",VerticalLineToolType);Ee(this,"steps",1)}createPrimitive(ee){const ne=getI18nService(ee);return new VerticalLinePrimitive({id:this.id,points:[],linecolor:"#2962FF",linewidth:2,linestyle:0,extendLine:!0,showTime:!0,showLabel:!1,horzLabelsAlign:HorizontalAlign.Center,vertLabelsAlign:VerticalAlign.Middle,textColor:"#2962FF",textOrientation:"vertical",fontSize:14,bold:!1,italic:!1,text:"",wordWrap:!0,placeholder:ne.t("tool.text.common.addText")},...this.getTextResetArgs(ee))}finishDrawing(){ensure(this._drawingSession).finishDrawing()}}const lineVerticalLine={type:VerticalLineToolType,icon:icon$O,keybinding:KeyCode.KeyV|KeyMod.Alt,Ctor:VerticalLineTool},icon$N=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M6.5 23v1h17.5v-17.5h-1v16.5z"></path><path fill-rule="nonzero" d="M21.5 5v-1h-17.5v17.5h1v-16.5z"></path><path fill-rule="nonzero" d="M4.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path fill-rule="nonzero" d="M13 9v13h1v-13z" id="Line"></path><path d="M13.5 6l2.5 3h-5z"></path><path fill-rule="nonzero" d="M19 14h-13v1h13z"></path><path d="M19 17v-5l3 2.5z"></path></g></svg>
`,DateAndPriceRangeToolType="tool.measurer.dataAndPriceRange";class DateAndPriceRangePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_distanceLineRenderer",new LineRenderer);Ee(this,"_distancePriceRenderer",new LineRenderer);Ee(this,"_backgroundRenderer",new RectangleRenderer);Ee(this,"_borderRenderer",new RectangleRenderer);Ee(this,"_textRenderer",new BaseTextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties();this._backgroundRenderer.setData({points:this.points(),color:"white",lineWidth:0,lineStyle:LineStyleType.solid,backColor:ee.background,extendLeft:!1,extendRight:!1}),this._renderer.append(this._backgroundRenderer);const[ne,re]=this.points();ee.drawBorder&&(this._borderRenderer.setData({points:this.points(),color:ee.borderColor,lineWidth:ee.borderWidth,lineStyle:LineStyleType.solid,backColor:"",extendLeft:!1,extendRight:!1}),this._renderer.append(this._borderRenderer));const se=ee.drawBorder?ee.borderWidth/2:0,{mediaSize:{height:ae}}=this._source.getScope(),le=Math.round((ne.y+re.y)/2),ce=new Point(ne.x+Math.sign(re.x-ne.x)*se,le),he=new Point(re.x+Math.sign(ne.x-re.x)*se,le);this._distanceLineRenderer.setData({points:[ce,he],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:Math.abs(ne.x-re.x)>=25*ee.lineWidth?LineEnd.Arrow:LineEnd.Normal}),this._renderer.append(this._distanceLineRenderer);const fe=Math.round((ne.x+re.x)/2),Ae=new Point(fe,ne.y+Math.sign(re.y-ne.y)*se),pe=new Point(fe,re.y+Math.sign(ne.y-re.y)*se);this._distancePriceRenderer.setData({points:[Ae,pe],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:Math.abs(Ae.y-pe.y)>=25*ee.lineWidth?LineEnd.Arrow:LineEnd.Normal}),this._renderer.append(this._distancePriceRenderer);let Oe;re.y>ne.y?Oe=new Point(.5*(ne.x+re.x),re.y-2*ee.fontSize):Oe=new Point(.5*(ne.x+re.x),re.y+.7*ee.fontSize);const Fe={x:0,y:10},Ne=ee.fontSize,ze={points:[Oe],text:this._data.labelText,color:ee.textColor,fontFamily:ChartFontFamily,offsetX:Fe.x,offsetY:Fe.y,lineSpacing:8,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,fontSize:Ne,backgroundRoundRect:4,boxPaddingHorz:.4*Ne+Ne/3,boxPaddingVert:.2*Ne+Ne/3,boxShadow:{shadowColor:ee.boxShadow,shadowBlur:4,shadowOffsetY:1},backgroundColor:ee.labelBackground};this._textRenderer.setData(ze);const He=this._textRenderer.measure(),We=calculateLabelPosition(He,ne,re,Fe,ae);this._textRenderer.setPoint(We),this._textRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(this._textRenderer),ee.showAnchors&&this.addAnchors(this._renderer)}}class DateAndPriceRangePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new DateAndPriceRangePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const[ee,ne]=this.controlPoints;if(!ne)return;const re=this.pointToScreenPoint(ee),se=this.pointToScreenPoint(ne),ae=[new AnchorPoint(re,{pointIndex:0}),new AnchorPoint(se,{pointIndex:1})];this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ee.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ee.price,re.y)),this._timeAxisViews[1].update(this._calculateTimeAxisViewData(ne.time,se.x)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(ne.price,se.y)),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(re.y,se.y)),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(re.x,se.x));const le=[],ce=ne.price-ee.price,he=ce/ee.price,fe=ce*this._props.base;le.push(`${this._ctx.priceLabelFormatter(ce)} (${this._ctx.percentageFormatter(he)}) ${fe.toFixed(0)}`);const Ae=ensure(this.chart.timeScale().timeToIndexEx(ee.time)),Oe=ensure(this.chart.timeScale().timeToIndexEx(ne.time))-Ae,Fe=this._ctx.timeSpanFormatter(ee.time,ne.time);le.push(`${this._props.formatBarCount(Oe)}, ${Fe}`),this._lines.update({points:ae,labelText:le.join(`
`)})}}class DateAndPriceRangeTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",DateAndPriceRangeToolType);Ee(this,"steps",2)}getProps(ee){return{id:this.id,points:[],lineColor:"#2962FFFF",lineWidth:2,background:"#2962FF26",textColor:"#000000FF",fontSize:12,labelBackground:"#FFFFFF",formatBarCount:ne=>getI18nService(ee).t("tool.line.common.bars",{count:ne}),base:this.chartService.symbolInfo().pricescale,drawBorder:!1,borderWidth:2,borderColor:"#2962FFFF",boxShadow:"#00000033",showVolume:!0,showAnchors:!0}}createPrimitive(ee){return new DateAndPriceRangePrimitive(this.getProps(ee),...this.resetArgs)}}const MeasurerDateAndPriceRange={type:DateAndPriceRangeToolType,icon:icon$N,Ctor:DateAndPriceRangeTool},icon$M=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M20 14h-14v1h14z" id="Line"></path><path d="M20 17v-5l3 2.5z"></path><path fill-rule="nonzero" d="M24 8.5v16.5h1v-16.5zM4 4v16.5h1v-16.5z"></path><path fill-rule="nonzero" d="M4.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,DateRangeToolType="tool.measurer.dateRange";class DateRangePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_leftBorderRenderer",new LineRenderer);Ee(this,"_rightBorderRenderer",new LineRenderer);Ee(this,"_distancePriceRenderer",new LineRenderer);Ee(this,"_backgroundRenderer",new RectangleRenderer);Ee(this,"_textRenderer",new TextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties(),ne=ee.extendTop,re=ee.extendBottom,[se,ae]=this.points(),{mediaSize:{height:le}}=this._source.getScope(),ce=ne?0:Math.min(se.y,ae.y),he=re?le:Math.max(se.y,ae.y);this._backgroundRenderer.setData({points:[new Point(se.x,ce),new Point(ae.x,he)],color:"white",lineWidth:0,lineStyle:LineStyleType.solid,backColor:ee.background,extendLeft:!1,extendRight:!1}),this._renderer.append(this._backgroundRenderer);const fe=(je,Ue,Ge)=>{je.setData({points:[Ue,Ge],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(je)};fe(this._leftBorderRenderer,new Point(se.x,ce),new Point(se.x,he)),fe(this._rightBorderRenderer,new Point(ae.x,ce),new Point(ae.x,he));const Ae=Math.round((se.y+ae.y)/2),pe=new Point(se.x,Ae),Oe=new Point(ae.x,Ae);this._distancePriceRenderer.setData({points:[pe,Oe],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:Math.abs(pe.x-Oe.x)>=15*ee.lineWidth?LineEnd.Arrow:LineEnd.Normal}),this._renderer.append(this._distancePriceRenderer);const Fe={x:0,y:10},Ne=ee.fontSize,ze={points:this.points(),text:this._data.labelText,color:ee.textColor,fontFamily:ChartFontFamily,offsetX:Fe.x,offsetY:Fe.y,lineSpacing:8,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,fontSize:Ne,backgroundRoundRect:4,boxPaddingHorz:.4*Ne+Ne/3,boxPaddingVert:.2*Ne+Ne/3,boxShadow:{shadowColor:ee.boxShadow,shadowBlur:4,shadowOffsetY:1},backgroundColor:ee.labelBackground};this._textRenderer.setData(ze);const He=this._textRenderer.measure(),We=calculateLabelPosition(He,se,ae,Fe,le);this._textRenderer.setPoint(We),this._textRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(this._textRenderer),this.addAnchors(this._renderer)}}class DateRangePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new DateRangePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const[ee,ne]=this.controlPoints;if(!ne)return;const re=this.pointToScreenPoint(ee),se=this.pointToScreenPoint(ne),ae=[new AnchorPoint(re,{pointIndex:0}),new AnchorPoint(se,{pointIndex:1})];this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ee.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ee.price,re.y)),this._timeAxisViews[1].update(this._calculateTimeAxisViewData(ne.time,se.x)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(ne.price,se.y)),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(re.y,se.y)),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(re.x,se.x));const le=ensure(this.chart.timeScale().timeToIndexEx(ee.time)),he=ensure(this.chart.timeScale().timeToIndexEx(ne.time))-le,fe=this._ctx.timeSpanFormatter(ee.time,ne.time);this._lines.update({points:ae,labelText:`${this._props.formatBarCount(he)}, ${fe}`})}}class DateRangeTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",DateRangeToolType);Ee(this,"steps",2)}createPrimitive(ee){return new DateRangePrimitive({id:this.id,points:[],lineColor:"#2962FFFF",lineWidth:2,background:"#2962FF26",textColor:"#000000FF",fontSize:12,labelBackground:"#FFFFFF",formatBarCount:ne=>getI18nService(ee).t("tool.line.common.bars",{count:ne}),drawBorder:!1,borderWidth:2,borderColor:"#2962FFFF",boxShadow:"#00000033",showVolume:!1,extendTop:!1,extendBottom:!1},...this.resetArgs)}}const MeasurerDateRange={type:DateRangeToolType,icon:icon$M,Ctor:DateRangeTool},icon$L=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M4 5h16.5v-1h-16.5zM25 24h-16.5v1h16.5z" id="Line"></path><path fill-rule="nonzero" d="M6.5 26c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path fill-rule="nonzero" d="M14 9v14h1v-14z"></path><path d="M14.5 6l2.5 3h-5z"></path></g></svg>
`,PriceRangeToolType="tool.measurer.priceRange";class PriceRangePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_topBorderRenderer",new LineRenderer);Ee(this,"_bottomBorderRenderer",new LineRenderer);Ee(this,"_distanceRenderer",new LineRenderer);Ee(this,"_backgroundRenderer",new RectangleRenderer);Ee(this,"_labelRenderer",new TextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties(),ne=ee.extendLeft,re=ee.extendRight,[se,ae]=this.points(),le=Math.min(se.x,ae.x),ce=Math.max(se.x,ae.x);this._backgroundRenderer.setData({points:[new Point(le,se.y),new Point(ce,ae.y)],color:"white",lineWidth:0,lineStyle:LineStyleType.solid,backColor:ee.background,extendLeft:ne,extendRight:re}),this._renderer.append(this._backgroundRenderer);const he=(Ze,Ye,qe)=>{Ze.setData({points:[Ye,qe],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,extendLeft:ne,extendRight:re,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(Ze)};let fe=le,Ae=ce;fe===Ae&&(ne&&(fe-=1),re&&(Ae+=1)),he(this._topBorderRenderer,new Point(fe,se.y),new Point(Ae,se.y)),he(this._bottomBorderRenderer,new Point(fe,ae.y),new Point(Ae,ae.y));const pe=Math.round((se.x+ae.x)/2),Oe=new Point(pe,se.y),Fe=new Point(pe,ae.y),{mediaSize:{height:Ne}}=this._source.getScope();this._distanceRenderer.setData({points:[Oe,Fe],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:Math.abs(Oe.y-Fe.y)>=15*ee.lineWidth?LineEnd.Arrow:LineEnd.Normal}),this._renderer.append(this._distanceRenderer);let ze;ae.y>se.y?ze=new Point(.5*(se.x+ae.x),ae.y-2*ee.fontSize):ze=new Point(.5*(se.x+ae.x),ae.y+.7*ee.fontSize);const He={x:0,y:10},We=ee.fontSize,je={points:[ze],text:this._data.labelText,color:ee.textColor,fontFamily:ChartFontFamily,offsetX:He.x,offsetY:He.y,lineSpacing:8,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,fontSize:We,backgroundRoundRect:4,boxPaddingHorz:.4*We+We/3,boxPaddingVert:.2*We+We/3,boxShadow:{shadowColor:ee.boxShadow,shadowBlur:4,shadowOffsetY:1},backgroundColor:ee.labelBackground};this._labelRenderer.setData(je);const Ue=this._labelRenderer.measure(),Ge=calculateLabelPosition(Ue,se,ae,He,Ne);this._labelRenderer.setPoint(Ge),this._labelRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(this._labelRenderer),this.addAnchors(this._renderer)}}class PriceRangePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PriceRangePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const[ee,ne]=this.controlPoints;if(!ne)return;const re=this.pointToScreenPoint(ee),se=this.pointToScreenPoint(ne),ae=[new AnchorPoint(re,{pointIndex:0}),new AnchorPoint(se,{pointIndex:1})];this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ee.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ee.price,re.y)),this._timeAxisViews[1].update(this._calculateTimeAxisViewData(ne.time,se.x)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(ne.price,se.y)),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(re.y,se.y)),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(re.x,se.x));const le=ne.price-ee.price,ce=le/ee.price,he=le*this._props.base;this._lines.update({points:ae,labelText:`${this._ctx.priceLabelFormatter(le)} (${this._ctx.percentageFormatter(ce)}) ${he.toFixed(0)}`})}}class PriceRangeTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PriceRangeToolType);Ee(this,"steps",2)}createPrimitive(){return new PriceRangePrimitive({id:this.id,points:[],lineColor:"#2962FFFF",lineWidth:2,background:"#2962FF26",textColor:"#000000FF",fontSize:12,labelBackground:"#FFFFFF",base:this.chartService.symbolInfo().pricescale,drawBorder:!1,borderWidth:2,borderColor:"#2962FFFF",boxShadow:"#00000033",extendLeft:!1,extendRight:!1},...this.resetArgs)}}const MeasurerPriceRange={type:PriceRangeToolType,icon:icon$L,Ctor:PriceRangeTool},icon$K=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M21.487 5.248l-12.019 1.502.124.992 12.019-1.502zM6.619 9.355l-2.217 11.083.981.196 2.217-11.083zM6.534 22.75l12.071-1.509-.124-.992-12.071 1.509zM21.387 18.612l2.21-11.048-.981-.196-2.21 11.048zM8.507 9.214l10.255 10.255.707-.707-10.255-10.255z"></path><path d="M7.5 9c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM4.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM20.5 22c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PatternABCDToolType="tool.pattern.abcd";class PatternABCDPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_abRetracementTrend",new LineRenderer);Ee(this,"_cdRetracementTrend",new LineRenderer);Ee(this,"_polylineRenderer",new PolygonRenderer);Ee(this,"_abLabelRenderer",new BaseTextRenderer);Ee(this,"_cdLabelRenderer",new BaseTextRenderer);Ee(this,"_textRendererALabel",new BaseTextRenderer);Ee(this,"_textRendererBLabel",new BaseTextRenderer);Ee(this,"_textRendererCLabel",new BaseTextRenderer);Ee(this,"_textRendererDLabel",new BaseTextRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re=(Fe,Ne)=>({points:[Fe],text:Ne,color:ne.textColor,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:0,fontSize:ne.textFontSize,backgroundColor:ne.color,backgroundRoundRect:4}),se=(Fe,Ne)=>({points:[Fe,Ne],lineColor:ne.color,lineWidth:ne.lineWidth,lineStyle:LineStyleType.dotted,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),[ae,le,ce,he]=ee,fe={points:this.points(),lineColor:ne.color,lineWidth:ne.lineWidth,lineStyle:LineStyleType.solid,filled:!1,background:"rgba(0, 0, 0, 0)"};this._polylineRenderer.setData(fe),this._renderer.append(this._polylineRenderer);const Ae=re(ae,"A");Ae.vertAlign=le.y>ae.y?VerticalAlign.Bottom:VerticalAlign.Top,Ae.offsetY=5,this._textRendererALabel.setData(Ae),this._renderer.append(this._textRendererALabel);const pe=re(le,"B");if(pe.vertAlign=le.y<ae.y?VerticalAlign.Bottom:VerticalAlign.Top,pe.offsetY=5,this._textRendererBLabel.setData(pe),this._renderer.append(this._textRendererBLabel),ee.length>2){const Fe=re(ce,"C");Fe.vertAlign=ce.y<le.y?VerticalAlign.Bottom:VerticalAlign.Top,Fe.offsetY=5,this._textRendererCLabel.setData(Fe),this._renderer.append(this._textRendererCLabel)}if(ee.length>3){const Fe=re(he,"D");Fe.vertAlign=he.y<ce.y?VerticalAlign.Bottom:VerticalAlign.Top,Fe.offsetY=5,this._textRendererDLabel.setData(Fe),this._renderer.append(this._textRendererDLabel)}const Oe=getNumericFormatter(3);if(ee.length>=3){this._abRetracementTrend.setData(se(ae,ce)),this._renderer.append(this._abRetracementTrend);const Fe=ae.add(ce).scaled(.5),Ne=re(Fe,Oe.format(this._data.abRatio));this._abLabelRenderer.setData(Ne),this._renderer.append(this._abLabelRenderer)}if(ee.length>=4){this._cdRetracementTrend.setData(se(le,he)),this._renderer.append(this._cdRetracementTrend);const Fe=le.add(he).scaled(.5),Ne=re(Fe,Oe.format(this._data.cdRatio));this._cdLabelRenderer.setData(Ne),this._renderer.append(this._cdLabelRenderer)}this.addAnchors(this._renderer)}}class PatternABCDPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PatternABCDPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le})),ne=ee.map(ae=>ae.x),re=ee.map(ae=>ae.y);this.controlPoints.forEach((ae,le)=>{this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ee[le].x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ee[le].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se={points:ee,abRatio:NaN,cdRatio:NaN};if(ee.length>=3){const[ae,le,ce]=this.controlPoints;se.abRatio=Math.round(Math.abs((ce.price-le.price)/(le.price-ae.price))*1e3)/1e3}if(ee.length>=4){const[,ae,le,ce]=this.controlPoints;se.cdRatio=Math.round(Math.abs((ce.price-le.price)/(le.price-ae.price))*1e3)/1e3}this._lines.update(se)}}class PatternABCDTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PatternABCDToolType);Ee(this,"steps",4)}createPrimitive(){return new PatternABCDPrimitive({id:this.id,points:[],color:"#089981FF",lineWidth:2,background:getLightenRGBA("#089981FF",.15),textColor:"#ffffff",textFontSize:12},...this.resetArgs)}}const PatternABCD={type:PatternABCDToolType,icon:icon$K,Ctor:PatternABCDTool},icon$J=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path d="M15.246 21.895l1.121.355c-.172.625-.458 1.089-.857 1.393-.4.303-.907.455-1.521.455-.76 0-1.385-.26-1.875-.779-.49-.52-.734-1.23-.734-2.131 0-.953.246-1.693.738-2.221.492-.527 1.139-.791 1.941-.791.701 0 1.27.207 1.707.621.26.245.456.596.586 1.055l-1.145.273c-.068-.297-.209-.531-.424-.703-.215-.172-.476-.258-.783-.258-.424 0-.769.152-1.033.457-.264.305-.396.798-.396 1.48 0 .724.13 1.24.391 1.547.26.307.599.461 1.016.461.307 0 .572-.098.793-.293.221-.195.38-.503.477-.922z"></path><path fill-rule="nonzero" d="M20.449 8.505l2.103 9.112.974-.225-2.103-9.112zM13.943 14.011l7.631 4.856.537-.844-7.631-4.856zM14.379 11.716l4.812-3.609-.6-.8-4.812 3.609zM10.96 13.828l-4.721 6.744.819.573 4.721-6.744zM6.331 20.67l2.31-13.088-.985-.174-2.31 13.088zM9.041 7.454l1.995 3.492.868-.496-1.995-3.492z"></path><path fill-rule="nonzero" d="M8.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM12.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM20.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PatternCypherToolType="tool.pattern.cypher";class TriangleRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(this._data==null||this._data.points.length<2)return null;const[ee,ne]=this._data.points;let re=distanceToSegment(ee,ne,te);const se=interactionTolerance().line;if(re.distance<=se)return new HitTestResult(HitTarget.MovePoint);if(this._data.points.length!==3)return null;const ae=this._data.points[2];return re=distanceToSegment(ne,ae,te),re.distance<=se?new HitTestResult(HitTarget.MovePoint):(re=distanceToSegment(ae,ee,te),re.distance<=se?new HitTestResult(HitTarget.MovePoint):null)}drawImpl(te){if(this._data==null||this._data.points.length<2)return;const ee=te.context,ne=(this._data.lineStyle??LineStyleType.solid)===LineStyleType.solid?"round":"butt";ee.lineCap=ne,ee.lineJoin="round",ee.strokeStyle=this._data.color,ee.lineWidth=this._data.lineWidth,this._data.lineStyle!==void 0&&setLineStyle(ee,this._data.lineStyle);const[re,se,ae=se]=this._data.points,{mediaSize:le}=te;if(this._data.fillBackground&&Math.abs((re.x-ae.x)*(se.y-ae.y)-(se.x-ae.x)*(re.y-ae.y))>1e-10){let fe=[new Point(0,0),new Point(le.width,0),new Point(le.width,le.height),new Point(0,le.height)];if(fe=clipPolygonByEdge(fe,re,se,[se,ae]),fe=clipPolygonByEdge(fe,se,ae,[ae,re]),fe=clipPolygonByEdge(fe,ae,re,[re,se]),fe&&fe.length>1){ee.save(),ee.beginPath(),ee.moveTo(fe[0].x,fe[0].y);for(let Ae=1;Ae<fe.length;Ae++)ee.lineTo(fe[Ae].x,fe[Ae].y);ee.fillStyle=this._data.backColor,ee.fill(),ee.restore()}}const ce=[],he=ee.getLineDash().reduce((fe,Ae)=>fe+Ae,0);[[re,se],[se,ae],[ae,re]].forEach(([fe,Ae])=>{const pe=intersectLineWithViewport(fe,Ae,!1,!1,le.width,le.height,he);pe&&ce.push(pe)}),ce.length>0&&(ee.beginPath(),ce.forEach(([fe,Ae])=>{ee.moveTo(fe.x,fe.y),ee.lineTo(Ae.x,Ae.y)}),ee.stroke())}}class PatternXABCDPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_bcRetracementTrend",new LineRenderer);Ee(this,"_xdRetracementTrend",new LineRenderer);Ee(this,"_xbTrend",new LineRenderer);Ee(this,"_bdTrend",new LineRenderer);Ee(this,"_polylineRenderer",new PolygonRenderer);Ee(this,"_mainTriangleRenderer",new TriangleRenderer);Ee(this,"_triangleRendererPoints234",new TriangleRenderer);Ee(this,"_xbLabelRenderer",new BaseTextRenderer);Ee(this,"_acLabelRenderer",new BaseTextRenderer);Ee(this,"_bdLabelRenderer",new BaseTextRenderer);Ee(this,"_xdLabelRenderer",new BaseTextRenderer);Ee(this,"_textRendererALabel",new BaseTextRenderer);Ee(this,"_textRendererBLabel",new BaseTextRenderer);Ee(this,"_textRendererCLabel",new BaseTextRenderer);Ee(this,"_textRendererDLabel",new BaseTextRenderer);Ee(this,"_textRendererXLabel",new BaseTextRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re=(ze,He)=>({points:[ze],text:He,color:ne.textColor,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:0,fontSize:ne.textFontSize,backgroundColor:ne.color,backgroundRoundRect:4}),se=(ze,He)=>({points:[ze,He],lineColor:ne.color,lineWidth:1,lineStyle:LineStyleType.dotted,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),[ae,le,ce,he,fe]=ee,Ae={points:[ae,le,ee.length<3?le:ce],color:"rgba(0, 0, 0, 0)",lineWidth:ne.lineWidth,backColor:ne.background,fillBackground:!0};if(this._mainTriangleRenderer.setData(Ae),this._renderer.append(this._mainTriangleRenderer),ee.length>3){const ze={points:[ce,he,ee.length===5?fe:he],color:"rgba(0, 0, 0, 0)",lineWidth:ne.lineWidth,backColor:ne.background,fillBackground:!0};this._triangleRendererPoints234.setData(ze),this._renderer.append(this._triangleRendererPoints234)}const pe={points:ee,lineColor:ne.color,lineWidth:ne.lineWidth,background:ne.background,lineStyle:LineStyleType.solid,filled:!1};this._polylineRenderer.setData(pe),this._renderer.append(this._polylineRenderer);const Oe=getNumericFormatter(3);if(ee.length>=3){const ze=ae.add(ce).scaled(.5),He=re(ze,Oe.format(this._data.abRetracement));this._xbLabelRenderer.setData(He),this._renderer.append(this._xbLabelRenderer);const We=se(ae,ce);this._xbTrend.setData(We),this._renderer.append(this._xbTrend)}if(ee.length>=4){const ze=le.add(he).scaled(.5),He=re(ze,Oe.format(this._data.bcRetracement));this._acLabelRenderer.setData(He),this._renderer.append(this._acLabelRenderer);const We=se(le,he);this._bcRetracementTrend.setData(We),this._renderer.append(this._bcRetracementTrend)}if(ee.length>=5){const ze=ce.add(fe).scaled(.5),He=re(ze,Oe.format(this._data.cdRetracement));this._bdLabelRenderer.setData(He),this._renderer.append(this._bdLabelRenderer);const We=se(ae,fe);this._xdRetracementTrend.setData(We),this._renderer.append(this._xdRetracementTrend);const je=ae.add(fe).scaled(.5),Ue=re(je,Oe.format(this._data.xdRetracement));this._xdLabelRenderer.setData(Ue),this._renderer.append(this._xdLabelRenderer);const Ge=se(ce,fe);this._bdTrend.setData(Ge),this._renderer.append(this._bdTrend)}const Fe=re(ae,"X");Fe.vertAlign=le.y>ae.y?VerticalAlign.Bottom:VerticalAlign.Top,Fe.offsetY=5,this._textRendererXLabel.setData(Fe),this._renderer.append(this._textRendererXLabel);const Ne=re(le,"A");if(Ne.vertAlign=le.y<ae.y?VerticalAlign.Bottom:VerticalAlign.Top,Ne.offsetY=5,this._textRendererALabel.setData(Ne),this._renderer.append(this._textRendererALabel),ee.length>2){const ze=re(ce,"B");ze.vertAlign=ce.y<le.y?VerticalAlign.Bottom:VerticalAlign.Top,ze.offsetY=5,this._textRendererBLabel.setData(ze),this._renderer.append(this._textRendererBLabel)}if(ee.length>3){const ze=re(he,"C");ze.vertAlign=he.y<ce.y?VerticalAlign.Bottom:VerticalAlign.Top,ze.offsetY=5,this._textRendererCLabel.setData(ze),this._renderer.append(this._textRendererCLabel)}if(ee.length>4){const ze=re(fe,"D");ze.vertAlign=fe.y<he.y?VerticalAlign.Bottom:VerticalAlign.Top,ze.offsetY=5,this._textRendererDLabel.setData(ze),this._renderer.append(this._textRendererDLabel)}this.addAnchors(this._renderer)}}class PatternXABCDPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PatternXABCDPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le})),ne=ee.map(ae=>ae.x),re=ee.map(ae=>ae.y);this.controlPoints.forEach((ae,le)=>{this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ee[le].x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ee[le].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se={points:ee,abRetracement:NaN,bcRetracement:NaN,cdRetracement:NaN,xdRetracement:NaN};this._updateBaseData(se),this._lines.update(se)}_updateBaseData(ee){const ne=ee.points;if(ne.length>=3){const[re,se,ae]=this.controlPoints,le=Math.abs((ae.price-se.price)/(se.price-re.price));ee.abRetracement=Math.round(le*1e3)/1e3}if(ne.length>=4){const[,re,se,ae]=this.controlPoints,le=Math.abs((ae.price-se.price)/(se.price-re.price));ee.bcRetracement=Math.round(le*1e3)/1e3}if(ne.length>=5){const[re,se,ae,le,ce]=this.controlPoints,he=Math.abs((ce.price-le.price)/(le.price-ae.price)),fe=Math.abs((ce.price-se.price)/(se.price-re.price));ee.cdRetracement=Math.round(he*1e3)/1e3,ee.xdRetracement=Math.round(fe*1e3)/1e3}}}class PatternCypherPrimitive extends PatternXABCDPrimitive{_updateBaseData(te){const{points:ee}=te;if(ee.length>=3){const[ne,re,se]=this.controlPoints;if(te.abRetracement=Math.abs((se.price-re.price)/(re.price-ne.price)),ee.length>=4){const[ae,le,,ce]=this.controlPoints;te.bcRetracement=Math.abs((ce.price-ae.price)/(le.price-ae.price))}if(ee.length>=5){const[ae,,le,ce,he]=this.controlPoints;te.cdRetracement=Math.abs((he.price-ce.price)/(ce.price-le.price)),te.xdRetracement=Math.abs((he.price-ce.price)/(ae.price-ce.price))}}}}class PatternCypherTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PatternCypherToolType);Ee(this,"steps",5)}createPrimitive(){return new PatternCypherPrimitive({id:this.id,points:[],color:"#2962FFFF",lineWidth:2,background:getLightenRGBA("#2962FFFF",.15),textColor:"#ffffff",textFontSize:12},...this.resetArgs)}}const PatternCypher={type:PatternCypherToolType,icon:icon$J,Ctor:PatternCypherTool},icon$I=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M4.436 21.667l2.083-9.027-.974-.225-2.083 9.027zM10.046 16.474l-2.231-4.463-.894.447 2.231 4.463zM13.461 6.318l-2.88 10.079.962.275 2.88-10.079zM18.434 16.451l-2.921-10.224-.962.275 2.921 10.224zM21.147 12.089l-2.203 4.405.894.447 2.203-4.405zM25.524 21.383l-2.09-9.055-.974.225 2.09 9.055z"></path><path d="M1 19h7.5v-1h-7.5z"></path><path d="M12.5 19h4v-1h-4z"></path><path d="M20.5 19h6.5v-1h-6.5z"></path><path d="M6.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM10.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM25.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM14.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PatternHeadAndShouldersToolType="tool.pattern.headAndShoulders";class PatternHeadAndShouldersPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_trendLineRenderer",new LineRenderer);Ee(this,"_triangleRendererPoints234",new TriangleRenderer);Ee(this,"_intersect1Renderer",new TriangleRenderer);Ee(this,"_intersect2Renderer",new TriangleRenderer);Ee(this,"_polyLineRenderer",new PolygonRenderer);Ee(this,"_leftShoulderLabelRenderer",new BaseTextRenderer);Ee(this,"_headLabelRenderer",new BaseTextRenderer);Ee(this,"_rightShoulderLabelRenderer",new BaseTextRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(!(ee!=null&&ee.length))return;let ne,re;const[se,ae,le,ce,he,fe,Ae]=ee;if(ee.length>=5){const ze=intersectLineSegments(le,he,se,ae);if(ze){const He=he.subtract(le);ne=le.add(He.scaled(ze))}if(ee.length===7){const He=intersectLineSegments(le,he,fe,Ae);if(He){const We=he.subtract(le);re=le.add(We.scaled(He))}}}if(ee.length<2)return;const pe=this._source.properties(),Oe=(ze,He)=>({points:[ze],text:He,color:pe.textColor,horzAlign:HorizontalAlign.Center,vertAlign:VerticalAlign.Middle,fontFamily:ChartFontFamily,offsetX:0,offsetY:0,fontSize:pe.textFontSize,backgroundColor:pe.lineColor,backgroundRoundRect:4}),Fe=(ze,He,We)=>({points:[ze,He,We],color:"rgba(0, 0, 0, 0)",lineWidth:0,backColor:pe.background,fillBackground:pe.fillBackground}),Ne={points:ee,lineColor:pe.lineColor,lineWidth:pe.lineWidth,lineStyle:LineStyleType.solid,filled:!1,background:"rgba(0, 0, 0, 0)"};if(this._polyLineRenderer.setData(Ne),this._renderer.append(this._polyLineRenderer),ee.length>=5){let ze=le,He=he,We=!1,je=!1;ne?ze=ne:(ze=le,We=!0),re?He=re:(He=he,je=!0);const Ue={points:[ze,He],lineColor:pe.lineColor,lineWidth:pe.lineWidth,lineStyle:LineStyleType.dotted,extendLeft:We,extendRight:je,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._trendLineRenderer.setData(Ue),this._renderer.append(this._trendLineRenderer);const Ge=Fe(le,ce,he);this._triangleRendererPoints234.setData(Ge),this._renderer.append(this._triangleRendererPoints234)}if(ne){const ze=Fe(ne,ae,le);this._intersect1Renderer.setData(ze),this._renderer.append(this._intersect1Renderer)}if(re){const ze=Fe(he,fe,re);this._intersect2Renderer.setData(ze),this._renderer.append(this._intersect2Renderer)}if(ee.length>=2){const ze=Oe(ae,"Left Shoulder");ze.vertAlign=ae.y<se.y?VerticalAlign.Bottom:VerticalAlign.Top,ze.offsetY=5,this._leftShoulderLabelRenderer.setData(ze),this._renderer.append(this._leftShoulderLabelRenderer)}if(ee.length>=4){const ze=Oe(ce,"Head");ze.vertAlign=ce.y<le.y?VerticalAlign.Bottom:VerticalAlign.Top,ze.offsetY=5,this._headLabelRenderer.setData(ze),this._renderer.append(this._headLabelRenderer)}if(ee.length>=6){const ze=Oe(fe,"Right Shoulder");ze.vertAlign=fe.y<he.y?VerticalAlign.Bottom:VerticalAlign.Top,ze.offsetY=5,this._rightShoulderLabelRenderer.setData(ze),this._renderer.append(this._rightShoulderLabelRenderer)}this.addAnchors(this._renderer)}}class PatternHeadAndShouldersPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PatternHeadAndShouldersPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class PatternHeadAndShouldersTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PatternHeadAndShouldersToolType);Ee(this,"steps",7)}createPrimitive(){return new PatternHeadAndShouldersPrimitive({id:this.id,points:[],lineColor:"#089981FF",lineWidth:2,fillBackground:!0,background:getLightenRGBA("#089981FF",.15),textColor:"#ffffff",textFontSize:12,leftText:this.chartService.invokeWithinContext(ee=>ee.get(II18nService).t("tool.headAndShoulders.left")),headText:this.chartService.invokeWithinContext(ee=>ee.get(II18nService).t("tool.headAndShoulders.head")),rightText:this.chartService.invokeWithinContext(ee=>ee.get(II18nService).t("tool.headAndShoulders.right"))},...this.resetArgs)}}const PatternHeadAndShoulders={type:PatternHeadAndShouldersToolType,icon:icon$I,Ctor:PatternHeadAndShouldersTool},icon$H=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M.303 17.674l1.104.473.394-.919-1.104-.473z"></path><path d="M5.133 19.744l3.335 1.429.394-.919-3.335-1.429z"></path><path d="M12.134 22.744l3.352 1.436.394-.919-3.352-1.436z"></path><path d="M19.203 25.774l1.6.686.394-.919-1.6-.686z"></path><path d="M.3 4.673l1.13.484.394-.919-1.13-.484-.394.919zm.394-.919l1.13.484-.394.919-1.13-.484.394-.919z"></path><path d="M5.141 6.747l3.325 1.425.394-.919-3.325-1.425z"></path><path d="M12.133 9.744l3.353 1.437.394-.919-3.353-1.437z"></path><path d="M19.221 12.782l5.838 2.502.394-.919-5.838-2.502z"></path><path d="M3 7.473v8.969h1v-8.969zM8.93 9.871l-4.616 6.594.819.573 4.616-6.594zM11 19.5v-9h-1v9zM15.898 12.916l-4.616 6.594.819.573 4.616-6.594zM18 22.5v-9h-1v9zM24.313 5.212l-6.57 17.247.934.356 6.57-17.247z"></path><path d="M3.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM10.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 13c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM25.5 5c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 26c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM10.5 10c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PatternThreeDrivesToolType="tool.pattern.threeDrives";class PatternThreeDrivesPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_retrace1LabelRenderer",new BaseTextRenderer);Ee(this,"_retrace12LabelRenderer",new BaseTextRenderer);Ee(this,"_polyLineRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re=(ce,he)=>({points:[ce],text:he,color:ne.textColor,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,offsetX:0,offsetY:0,fontSize:ne.textFontSize,backgroundColor:ne.lineColor,backgroundRoundRect:4}),se=(ce,he)=>({points:[ce,he],lineColor:ne.lineColor,lineWidth:ne.lineWidth,lineStyle:LineStyleType.dotted,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),ae={points:ee,lineColor:ne.lineColor,lineWidth:ne.lineWidth,lineStyle:LineStyleType.solid,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal,background:"rgba(0, 0, 0, 0)",filled:!1};this._polyLineRenderer.setData(ae),this._renderer.append(this._polyLineRenderer);const le=getNumericFormatter(3);if(!isNaN(this._data.retrace1Ratio)){const ce=new LineRenderer;ce.setData(se(ee[1],ee[3])),this._renderer.append(ce);const he=ee[1].add(ee[3]).scaled(.5),fe=re(he,le.format(this._data.retrace1Ratio));this._retrace1LabelRenderer.setData(fe),this._renderer.append(this._retrace1LabelRenderer)}if(!isNaN(this._data.retrace2Ratio)){const ce=new LineRenderer;ce.setData(se(ee[3],ee[5])),this._renderer.append(ce);const he=ee[3].add(ee[5]).scaled(.5),fe=re(he,le.format(this._data.retrace2Ratio));this._retrace12LabelRenderer.setData(fe),this._renderer.append(this._retrace12LabelRenderer)}this.addAnchors(this._renderer)}}class PatternThreeDrivesPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PatternThreeDrivesPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le})),ne=ee.map(ae=>ae.x),re=ee.map(ae=>ae.y);this.controlPoints.forEach((ae,le)=>{this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ee[le].x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ee[le].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se={points:ee,retrace1Ratio:NaN,retrace2Ratio:NaN};if(ee.length>=4){const[,ae,le,ce]=this.controlPoints;se.retrace1Ratio=Math.round(100*Math.abs((ce.price-le.price)/(le.price-ae.price)))/100}if(ee.length>=6){const[,,,ae,le,ce]=this.controlPoints;se.retrace2Ratio=Math.round(100*Math.abs((ce.price-le.price)/(le.price-ae.price)))/100}this._lines.update(se)}}class PatternThreeDrivesTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PatternThreeDrivesToolType);Ee(this,"steps",7)}createPrimitive(){return new PatternThreeDrivesPrimitive({id:this.id,points:[],lineColor:"#673AB7FF",lineWidth:2,background:getLightenRGBA("#673AB7FF",.15),fillBackground:!0,textColor:"#ffffff",textFontSize:12},...this.resetArgs)}}const PatternThreeDrives={type:PatternThreeDrivesToolType,icon:icon$H,Ctor:PatternThreeDrivesTool},icon$G=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M9.457 18.844l-5.371 2.4.408.913 5.371-2.4z"></path><path d="M13.13 17.203l.408.913 13.688-6.116-6.736-3.01-.408.913 4.692 2.097z"></path><path d="M11.077 5.88l5.34 2.386.408-.913-5.34-2.386z"></path><path d="M7.401 4.237l.408-.913-5.809-2.595v19.771h1v-18.229z"></path><path d="M3.708 20.772l5.51-14.169-.932-.362-5.51 14.169zM9.265 6.39l1.46 10.218.99-.141-1.46-10.218zM13.059 17.145l4.743-6.775-.819-.573-4.743 6.775z"></path><path d="M9.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM11.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 10c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM2.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PatternTriangleToolType="tool.pattern.triangle";class PatternTrianglePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_trendLineRendererPoints01",new LineRenderer);Ee(this,"_trendLineRendererPoints12",new LineRenderer);Ee(this,"_trendLineRendererPoints23",new LineRenderer);Ee(this,"_intersectionRenderer",new TriangleRenderer);Ee(this,"_aLabelRenderer",new BaseTextRenderer);Ee(this,"_bLabelRenderer",new BaseTextRenderer);Ee(this,"_cLabelRenderer",new BaseTextRenderer);Ee(this,"_dLabelRenderer",new BaseTextRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const[ne,re,se,ae]=ee;let le,ce,he;if(ee.length===4){if(Math.abs(se.x-ne.x)<1||Math.abs(ae.x-re.x)<1)return;const Ne=Math.min(ne.x,re.x,se.x,ae.x),ze=(se.y-ne.y)/(se.x-ne.x),He=ne.y+(Ne-ne.x)*ze,We=(ae.y-re.y)/(ae.x-re.x),je=re.y+(Ne-re.x)*We;if(Math.abs(ze-We)<1e-6)return;ce=new Point(Ne,He),he=new Point(Ne,je);const Ue=(re.y-ne.y+(ne.x*ze-re.x*We))/(ze-We);if(Ue<Ne){const Ze=Math.max(ne.x,re.x,se.x,ae.x);ce=new Point(Ze,ne.y+(Ze-ne.x)*ze),he=new Point(Ze,re.y+(Ze-re.x)*We)}const Ge=ne.y+(Ue-ne.x)*ze;le=new Point(Ue,Ge)}const fe=this._source.properties(),Ae=(Ne,ze)=>({points:[Ne],text:ze,color:fe.textColor,fontFamily:ChartFontFamily,vertAlign:VerticalAlign.Middle,horzAlign:HorizontalAlign.Center,offsetX:0,offsetY:0,fontSize:fe.textFontSize,backgroundColor:fe.lineColor,backgroundRoundRect:4}),pe=(Ne,ze)=>({points:[Ne,ze],lineColor:fe.lineColor,lineWidth:fe.lineWidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal});if(this._trendLineRendererPoints01.setData(pe(ne,re)),this._renderer.append(this._trendLineRendererPoints01),ee.length>=3&&(this._trendLineRendererPoints12.setData(pe(re,se)),this._renderer.append(this._trendLineRendererPoints12)),ee.length===4&&(this._trendLineRendererPoints23.setData(pe(se,ae)),this._renderer.append(this._trendLineRendererPoints23),le&&ce&&he)){const Ne={points:[ensure(ce),ensure(he),le],color:fe.lineColor,lineWidth:fe.lineWidth,backColor:fe.background,fillBackground:fe.fillBackground,lineStyle:LineStyleType.dotted};this._intersectionRenderer.setData(Ne),this._renderer.append(this._intersectionRenderer)}const Oe=Ae(ne,"A");Oe.vertAlign=re.y>ne.y?VerticalAlign.Bottom:VerticalAlign.Top,Oe.offsetY=5,this._aLabelRenderer.setData(Oe),this._renderer.append(this._aLabelRenderer);const Fe=Ae(re,"B");if(Fe.vertAlign=re.y<ne.y?VerticalAlign.Bottom:VerticalAlign.Top,Fe.offsetY=5,this._bLabelRenderer.setData(Fe),this._renderer.append(this._bLabelRenderer),ee.length>2){const Ne=Ae(se,"C");Ne.vertAlign=se.y<re.y?VerticalAlign.Bottom:VerticalAlign.Top,Ne.offsetY=5,this._cLabelRenderer.setData(Ne),this._renderer.append(this._cLabelRenderer)}if(ee.length>3){const Ne=Ae(ae,"D");Ne.vertAlign=ae.y<se.y?VerticalAlign.Bottom:VerticalAlign.Top,Ne.offsetY=5,this._dLabelRenderer.setData(Ne),this._renderer.append(this._dLabelRenderer)}this.addAnchors(this._renderer)}}class PatternTrianglePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PatternTrianglePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class PatternTriangleTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PatternTriangleToolType);Ee(this,"steps",4)}createPrimitive(){return new PatternTrianglePrimitive({id:this.id,points:[],lineColor:"#673AB7FF",lineWidth:2,background:getLightenRGBA("#673AB7FF",.15),fillBackground:!0,textColor:"#ffffff",textFontSize:12},...this.resetArgs)}}const PatternTriangle={type:PatternTriangleToolType,icon:icon$G,Ctor:PatternTriangleTool},icon$F=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M20.449 8.505l2.103 9.112.974-.225-2.103-9.112zM13.943 14.011l7.631 4.856.537-.844-7.631-4.856zM14.379 11.716l4.812-3.609-.6-.8-4.812 3.609zM10.96 13.828l-4.721 6.744.819.573 4.721-6.744zM6.331 20.67l2.31-13.088-.985-.174-2.31 13.088zM9.041 7.454l1.995 3.492.868-.496-1.995-3.492z"></path><path d="M8.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM12.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM20.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PatternXABCDToolType="tool.pattern.xabcd";class PatternXABCDTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PatternXABCDToolType);Ee(this,"steps",5)}createPrimitive(){return new PatternXABCDPrimitive({id:this.id,points:[],color:"#2962FFFF",lineWidth:2,background:getLightenRGBA("#2962FFFF",.15),textColor:"#ffffff",textFontSize:12},...this.resetArgs)}}const PatternXABCD={type:PatternXABCDToolType,icon:icon$F,Ctor:PatternXABCDTool},icon$E=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M6.5 23h12v-1h-12z" id="Line"></path><path d="M21.596 20.715l3.091-9.66-.952-.305-3.091 9.66z"></path><path d="M8.413 22.664l1.95-6.094-.952-.305-1.95 6.094z"></path><path d="M11.602 12.695l3.085-9.641-.952-.305-3.085 9.641z"></path><path d="M11.783 16.167l6.817 5.454.625-.781-6.817-5.454z"></path><path d="M15.976 18.652l3.711-11.598-.952-.305-3.711 11.598z"></path><path d="M4.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM10.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM20.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,InsidePitchforkToolType="tool.pitchfork.insidePitchfork";var PitchforkStyle=(ie=>(ie[ie.Original=0]="Original",ie[ie.SchiffModified=1]="SchiffModified",ie[ie.Inside=2]="Inside",ie[ie.Schiff=3]="Schiff",ie))(PitchforkStyle||{});class PitchforkPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_medianRenderer",new LineRenderer);Ee(this,"_sideRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const[ne,re,se]=ee,ae=ee.length===3?re.add(se).scaled(.5):ee.length===2?re:ne,le=new AnchorPoint(ae,{pointIndex:3});this._updateRenderer(le)}_updateRenderer(ee){if(!ee)return;const ne=this.points(),re=this._source.properties(),se=re.median,ae={points:[ne[0],ee.point],lineColor:se.color,lineWidth:se.linewidth,lineStyle:se.linestyle,extendLeft:re.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};if(this._medianRenderer.setData(ae),this._renderer.append(this._medianRenderer),ne.length<3){this.addAnchors(this._renderer);return}const le={points:[ne[1],ne[2]],lineColor:se.color,lineWidth:se.linewidth,lineStyle:se.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._sideRenderer.setData(le),this._renderer.append(this._sideRenderer);const ce=ne[2].subtract(ne[1]).scaled(.5),he=ee.point.subtract(ne[0]);let fe=0;const Ae=re.fillBackground,pe=re.transparency;re.levels.forEach(Oe=>{if(!Oe.visible)return;const Fe=Oe.coeff,Ne=Oe.color,ze=Oe.linewidth,He=Oe.linestyle,We=ee.point.addScaled(ce,Fe),je=We.add(he),Ue=ee.point.addScaled(ce,-Fe),Ge=Ue.add(he);if(Ae){const ir=ee.point.addScaled(ce,fe),tr={p1:We,p2:je,p3:ir,p4:ir.add(he),color:Ne,transparency:pe,hittestOnBackground:!0,extendLeft:re.extendLines},or=new ChannelRenderer;or.setData(tr),this._renderer.append(or);const Jt=ee.point.addScaled(ce,-fe),rr={p1:Ue,p2:Ge,p3:Jt,p4:Jt.add(he),color:Ne,transparency:pe,hittestOnBackground:!0,extendLeft:re.extendLines},lr=new ChannelRenderer;lr.setData(rr),this._renderer.append(lr)}fe=Fe;const Ze=new LineRenderer,Ye={points:[We,je],lineColor:Ne,lineWidth:ze,lineStyle:He,extendLeft:re.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};Ze.setData(Ye),Ze.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ze);const qe=new LineRenderer,nr={points:[Ue,Ge],lineColor:Ne,lineWidth:ze,lineStyle:He,extendLeft:re.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};qe.setData(nr),qe.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(qe)}),this.addAnchors(this._renderer)}}class InsidePitchforkPaneView extends PitchforkPaneView{constructor(){super(...arguments);Ee(this,"_backSideRenderer",new LineRenderer);Ee(this,"_centerRenderer",new LineRenderer)}_updateRenderer(ee){const ne=this.points();if((ne==null?void 0:ne.length)<2)return;const re=ne[0].add(ne[1]).scaled(.5);if(!ee||!re){this.addAnchors(this._renderer);return}const se=this._source.properties(),ae=se.median;if(ne.length===3){const le={points:[re,ne[2]],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._medianRenderer.setData(le),this._renderer.append(this._medianRenderer)}{const le={points:[ne[0],ne[1]],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};if(this._backSideRenderer.setData(le),this._renderer.append(this._backSideRenderer),ne.length<3){this.addAnchors(this._renderer);return}}{const le={points:[ne[1],ne[2]],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._sideRenderer.setData(le),this._renderer.append(this._sideRenderer)}{const le=ne[2].subtract(ne[1]).scaled(.5),ce=ne[2].subtract(re);let he=0;const fe=se.fillBackground,Ae=se.transparency,pe={points:[ee.point,ee.point.add(ce)],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:se.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._centerRenderer.setData(pe),this._renderer.append(this._centerRenderer),se.levels.forEach(Oe=>{if(Oe.visible){const Fe=Oe.coeff,Ne=Oe.color,ze=Oe.linewidth,He=Oe.linestyle,We=ee.point.addScaled(le,Fe),je=We.add(ce),Ue=ee.point.addScaled(le,-Fe),Ge=Ue.add(ce);if(fe){{const qe=ee.point.addScaled(le,he),nr={p1:We,p2:je,p3:qe,p4:qe.add(ce),color:Ne,transparency:Ae,hittestOnBackground:!0,extendLeft:se.extendLines},ir=new ChannelRenderer;ir.setData(nr),this._renderer.append(ir)}{const qe=ee.point.addScaled(le,-he),nr={p1:Ue,p2:Ge,p3:qe,p4:qe.add(ce),color:Ne,transparency:Ae,hittestOnBackground:!0,extendLeft:se.extendLines},ir=new ChannelRenderer;ir.setData(nr),this._renderer.append(ir)}}he=Fe;const Ze=new LineRenderer;Ze.setData({points:[We,je],lineColor:Ne,lineWidth:ze,lineStyle:He,extendLeft:se.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),Ze.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ze);const Ye=new LineRenderer;Ye.setData({points:[Ue,Ge],lineColor:Ne,lineWidth:ze,lineStyle:He,extendLeft:se.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),Ye.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ye)}})}this.addAnchors(this._renderer)}}class ModifiedSchiffPitchforkPaneView extends PitchforkPaneView{constructor(){super(...arguments);Ee(this,"_backSideRenderer",new LineRenderer)}_calcModifiedBase(){if(this.points().length>1)return this.points()[0].add(this.points()[1]).scaled(.5)}_updateRenderer(ee){const ne=this.points();if((ne==null?void 0:ne.length)<2)return;const re=this._calcModifiedBase(),se=this._source.properties(),ae=se.median;{const le={points:[ne[0],ne[1]],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};if(this._backSideRenderer.setData(le),this._renderer.append(this._backSideRenderer),!ee||!re){this.addAnchors(this._renderer);return}}{const le={points:[re,ee.point],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:se.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};if(this._medianRenderer.setData(le),this._renderer.append(this._medianRenderer),ne.length<3){this.addAnchors(this._renderer);return}}{const le={points:[ne[1],ne[2]],lineColor:ae.color,lineWidth:ae.linewidth,lineStyle:ae.linestyle,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};this._sideRenderer.setData(le),this._renderer.append(this._sideRenderer)}{const le=ne[2].subtract(ne[1]).scaled(.5),ce=ee.point.subtract(re),he=se.fillBackground,fe=se.transparency;let Ae=0;se.levels.forEach(pe=>{if(!pe.visible)return;const Oe=pe.coeff,Fe=pe.color,Ne=pe.linewidth,ze=pe.linestyle,He=ee.point.addScaled(le,Oe),We=He.add(ce),je=ee.point.addScaled(le,-Oe),Ue=je.add(ce);if(he){const nr=ee.point.addScaled(le,Ae),ir={p1:He,p2:We,p3:nr,p4:nr.add(ce),color:Fe,transparency:fe,hittestOnBackground:!0,extendLeft:se.extendLines},tr=new ChannelRenderer;tr.setData(ir),this._renderer.append(tr);const or=ee.point.addScaled(le,-Ae),Jt={p1:je,p2:Ue,p3:or,p4:or.add(ce),color:Fe,transparency:fe,hittestOnBackground:!0,extendLeft:se.extendLines},rr=new ChannelRenderer;rr.setData(Jt),this._renderer.append(rr)}Ae=Oe;const Ge={points:[He,We],lineColor:Fe,lineWidth:Ne,lineStyle:ze,extendLeft:se.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},Ze=new LineRenderer;Ze.setData(Ge),Ze.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ze);const Ye={points:[je,Ue],lineColor:Fe,lineWidth:Ne,lineStyle:ze,extendLeft:se.extendLines,extendRight:!0,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},qe=new LineRenderer;qe.setData(Ye),qe.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(qe)})}this.addAnchors(this._renderer)}}class SchiffPitchforkPaneView extends ModifiedSchiffPitchforkPaneView{_calcModifiedBase(){var te;if(((te=this.points())==null?void 0:te.length)>2){const ee=this.points()[0].x,ne=.5*(this.points()[0].y+this.points()[1].y);return new Point(ee,ne)}}}const map={[PitchforkStyle.Original]:PitchforkPaneView,[PitchforkStyle.Inside]:InsidePitchforkPaneView,[PitchforkStyle.SchiffModified]:ModifiedSchiffPitchforkPaneView,[PitchforkStyle.Schiff]:SchiffPitchforkPaneView};class PitchforkPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_paneView",[]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}ensurePaneView(){var ee;if(!((ee=this._paneView)!=null&&ee.length)){const ne=map[this._props.style];this._paneView=[new ne(this,this.model)]}}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this.ensurePaneView(),this._paneView[0].update({points:ee})}}class InsidePitchforkTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",InsidePitchforkToolType);Ee(this,"steps",3)}createPrimitive(){return new PitchforkPrimitive({id:this.id,points:[],fillBackground:!0,transparency:80,style:2,median:{visible:!0,color:"#F23645",linewidth:2,linestyle:0},extendLines:!1,levels:[{coeff:.25,color:"#ffb74d",visible:!1,linestyle:0,linewidth:2},{coeff:.382,color:"#81c784",visible:!1,linestyle:0,linewidth:2},{coeff:.5,color:"#089981",visible:!0,linestyle:0,linewidth:2},{coeff:.618,color:"#089981",visible:!1,linestyle:0,linewidth:2},{coeff:.75,color:"#00bcd4",visible:!1,linestyle:0,linewidth:2},{coeff:1,color:"#2962FF",visible:!0,linestyle:0,linewidth:2},{coeff:1.5,color:"#9c27b0",visible:!1,linestyle:0,linewidth:2},{coeff:1.75,color:"#e91e63",visible:!1,linestyle:0,linewidth:2},{coeff:2,color:"#F77C80",visible:!1,linestyle:0,linewidth:2}]},...this.resetArgs)}}const pitchforkInsidePitchfork={type:InsidePitchforkToolType,icon:icon$E,Ctor:InsidePitchforkTool},icon$D=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.854 22.854l14-14-.707-.707-14 14z"></path><path d="M8.336 13.043l8.621 8.621.707-.707-8.621-8.621zM9.149 10.558l7.058-7.058-.707-.707-7.058 7.058z" id="Line"></path><path d="M20.149 21.558l7.058-7.058-.707-.707-7.058 7.058z"></path><path d="M5.5 23h11v-1h-11z"></path><path d="M7.5 13c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,ModifiedSchiffPitchforkToolType="tool.pitchfork.modifiedSchiffPitchfork";class ModifiedSchiffPitchforkTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ModifiedSchiffPitchforkToolType);Ee(this,"steps",3)}createPrimitive(){return new PitchforkPrimitive({id:this.id,points:[],fillBackground:!0,transparency:80,style:PitchforkStyle.SchiffModified,median:{visible:!0,color:"#F23645",linewidth:2,linestyle:0},extendLines:!1,levels:[{coeff:.25,color:"#ffb74d",visible:!1,linestyle:0,linewidth:2},{coeff:.382,color:"#81c784",visible:!1,linestyle:0,linewidth:2},{coeff:.5,color:"#089981",visible:!0,linestyle:0,linewidth:2},{coeff:.618,color:"#089981",visible:!1,linestyle:0,linewidth:2},{coeff:.75,color:"#00bcd4",visible:!1,linestyle:0,linewidth:2},{coeff:1,color:"#2962FF",visible:!0,linestyle:0,linewidth:2},{coeff:1.5,color:"#9c27b0",visible:!1,linestyle:0,linewidth:2},{coeff:1.75,color:"#e91e63",visible:!1,linestyle:0,linewidth:2},{coeff:2,color:"#F77C80",visible:!1,linestyle:0,linewidth:2}]},...this.resetArgs)}}const pitchforkModifiedSchiffPitchfork={type:ModifiedSchiffPitchforkToolType,icon:icon$D,Ctor:ModifiedSchiffPitchforkTool},icon$C=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.275 21.432l12.579-12.579-.707-.707-12.579 12.579z"></path><path d="M6.69 13.397l7.913 7.913.707-.707-7.913-7.913zM7.149 10.558l7.058-7.058-.707-.707-7.058 7.058z"></path><path d="M18.149 21.558l7.058-7.058-.707-.707-7.058 7.058z"></path><path d="M5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 13c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM16.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PitchforkToolType="tool.pitchfork.pitchfork";class PitchforkTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PitchforkToolType);Ee(this,"steps",3)}createPrimitive(){return new PitchforkPrimitive({id:this.id,points:[],fillBackground:!0,transparency:80,style:PitchforkStyle.Original,median:{visible:!0,color:"#F23645",linewidth:2,linestyle:0},extendLines:!1,levels:[{coeff:.25,color:"#ffb74d",visible:!1,linestyle:0,linewidth:2},{coeff:.382,color:"#81c784",visible:!1,linestyle:0,linewidth:2},{coeff:.5,color:"#089981",visible:!0,linestyle:0,linewidth:2},{coeff:.618,color:"#089981",visible:!1,linestyle:0,linewidth:2},{coeff:.75,color:"#00bcd4",visible:!1,linestyle:0,linewidth:2},{coeff:1,color:"#2962FF",visible:!0,linestyle:0,linewidth:2},{coeff:1.5,color:"#9c27b0",visible:!1,linestyle:0,linewidth:2},{coeff:1.75,color:"#e91e63",visible:!1,linestyle:0,linewidth:2},{coeff:2,color:"#F77C80",visible:!1,linestyle:0,linewidth:2}]},...this.resetArgs)}}const pitchforkPitchfork={type:PitchforkToolType,icon:icon$C,Ctor:PitchforkTool},icon$B=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M10.275 20.432l11.579-11.579-.707-.707-11.579 11.579z"></path><path d="M8.336 13.043l8.621 8.621.707-.707-8.621-8.621zM9.149 10.558l7.058-7.058-.707-.707-7.058 7.058z" id="Line"></path><path d="M20.149 21.558l7.058-7.058-.707-.707-7.058 7.058z"></path><path d="M6.5 23h10v-1h-10z"></path><path d="M4.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM7.5 13c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,SchiffPitchforkToolType="tool.pitchfork.schiffPitchfork";class SchiffPitchforkTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",SchiffPitchforkToolType);Ee(this,"steps",3)}createPrimitive(){return new PitchforkPrimitive({id:this.id,points:[],fillBackground:!0,transparency:80,style:PitchforkStyle.Schiff,median:{visible:!0,color:"#F23645",linewidth:2,linestyle:0},extendLines:!1,levels:[{coeff:.25,color:"#ffb74d",visible:!1,linestyle:0,linewidth:2},{coeff:.382,color:"#81c784",visible:!1,linestyle:0,linewidth:2},{coeff:.5,color:"#089981",visible:!0,linestyle:0,linewidth:2},{coeff:.618,color:"#089981",visible:!1,linestyle:0,linewidth:2},{coeff:.75,color:"#00bcd4",visible:!1,linestyle:0,linewidth:2},{coeff:1,color:"#2962FF",visible:!0,linestyle:0,linewidth:2},{coeff:1.5,color:"#9c27b0",visible:!1,linestyle:0,linewidth:2},{coeff:1.75,color:"#e91e63",visible:!1,linestyle:0,linewidth:2},{coeff:2,color:"#F77C80",visible:!1,linestyle:0,linewidth:2}]},...this.resetArgs)}}const pitchforkSchiffPitchfork={type:SchiffPitchforkToolType,icon:icon$B,Ctor:SchiffPitchforkTool},icon$A=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M6 6v6.5h1v-6.5zM7 22v-2.5h-1v2.5zM11 11v2.5h1v-2.5zM12 24v-7.5h-1v7.5zM16 5v5.5h1v-5.5zM17 21v-2.5h-1v2.5zM21 7v4.5h1v-4.5zM22 19v-2.5h-1v2.5z"></path><path d="M6 13v6h1v-6h-1zm-1-1h3v8h-3v-8z"></path><path d="M11 16h1v-2h-1v2zm-1-3h3v4h-3v-4z"></path><path d="M16 18h1v-7h-1v7zm-1-8h3v9h-3v-9z"></path><path d="M21 16h1v-4h-1v4zm-1-5h3v6h-3v-6z"></path></g></svg>
`,BarsPatternToolType="tool.projection.barsPattern";var BarsPatternMode=(ie=>(ie[ie.Bars=0]="Bars",ie[ie.Line=1]="Line",ie[ie.OpenClose=2]="OpenClose",ie[ie.LineOpen=3]="LineOpen",ie[ie.LineHigh=4]="LineHigh",ie[ie.LineLow=5]="LineLow",ie[ie.LineHL2=6]="LineHL2",ie))(BarsPatternMode||{});const patternValueExtractors={[BarsPatternMode.Bars]:ie=>[ie[2],ie[3]],[BarsPatternMode.Line]:ie=>ie[4],[BarsPatternMode.OpenClose]:ie=>[ie[1],ie[4]],[BarsPatternMode.LineOpen]:ie=>ie[1],[BarsPatternMode.LineHigh]:ie=>ie[2],[BarsPatternMode.LineLow]:ie=>ie[3],[BarsPatternMode.LineHL2]:ie=>(ie[2]+ie[3])/2},defaultColor="#808080";class BarsPatternPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_vertLineRenderer1",new VerticalLineRenderer);Ee(this,"_vertLineRenderer2",new VerticalLineRenderer);Ee(this,"_medianRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.controlPoints,re=this._data.patternData,se=re.length;if(se>0&&ne.length===2){const ae=this._source.properties(),le=ae.mode,ce=ae.color,he=Math.abs((ee[0].x-ee[1].x)/(se-1)),fe=this._data.scale,Ae=He=>ensure(this._source.priceScale().priceToCoordinate(He))*fe,[{time:pe},{time:Oe}]=ne,Fe=pe<Oe?ee[0]:ee[1],Ne=Fe.x,ze=Fe.y-Ae(this._data.firstPatternPrice);if(le===BarsPatternMode.Bars||le===BarsPatternMode.OpenClose){const He=patternValueExtractors[le];for(let je=0;je<se;je++){const Ue=Math.round(Ne+je*he+.5),Ge=He(re[je]).map((Ye,qe)=>{const nr=2*qe-1,ir=Ue+nr,tr=Math.round(Ae(Ye))+ze;return new Point(ir,tr)}),Ze=new RectangleRenderer;Ze.setData({points:Ge,color:ce,backColor:ce,lineWidth:1,transparency:10,extendLeft:!1,extendRight:!1}),this._renderer.append(Ze)}const We={points:ee};this._renderer.append(this.createLineAnchor(We,0))}else NOTIMPLEMENTED()}else this._vertLineRenderer1.setData({x:ee[0].x,lineColor:defaultColor,lineWidth:1,lineStyle:LineStyleType.solid}),this._renderer.append(this._vertLineRenderer1),this._vertLineRenderer2.setData({x:ee[1].x,lineColor:defaultColor,lineWidth:1,lineStyle:LineStyleType.solid}),this._renderer.append(this._vertLineRenderer2),this._medianRenderer.setData({points:ee,lineColor:defaultColor,lineWidth:1,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(this._medianRenderer)}}const primaryIndexMap={0:2,1:4,2:1,3:1,4:2,5:3,6:-1},flippedIndexMap={0:3,1:4,2:4,3:1,4:2,5:3,6:-1};class BarsPatternPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new BarsPatternPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_pattern",[]);Ee(this,"_scale",1);Ee(this,"_pointsCoordinatePricesDiff",null)}addPoint(ee,ne){const re=super.addPoint(ee,ne);if(isPointAccepted(re)&&ne==1){const[se,ae]=this.controlPoints,le=ensure(this.chart.timeScale().timeToIndex(se.time,!0)),ce=ensure(this.chart.timeScale().timeToIndex(ae.time,!0)),he=Math.min(le,ce),fe=Math.max(le,ce);if(this._pattern=this._createPattern(he,fe),this._pattern.length>0){le>ce&&this.controlPoints.reverse();const Ae=this._patternPriceDiff();this.controlPoints[1].price=this.controlPoints[0].price+Ae,this.controlPoints[1].time=this.series.dataByIndex(fe).time}this._updatePointsCoordinatePricesDiff()}return this.updateProps({indexPoints:cloneDeep(this.controlPoints.slice()),points:this.controlPoints.map(se=>{const ae=ensure(this.chart.timeScale().timeToIndex(se.time)),ce=ensure(this.series.dataByIndex(ae)).customValues.high,he=ensure(this.series.priceToCoordinate(ce));return se.price=ensure(this.series.coordinateToPrice(he-33)),se})}),re}setPoint(ee,ne,re){if(ee===1&&ne.time<=this.controlPoints[0].time){const se=ensure(this.chart.timeScale().timeToIndex(this.controlPoints[0].time));ne.time=ensure(this.series.dataByIndex(se+1)).time}if(ee===0&&ne.time>=this.controlPoints[1].time){const se=ensure(this.chart.timeScale().timeToIndex(this.controlPoints[1].time));ne.time=ensure(this.series.dataByIndex(se-1)).time}super.setPoint(ee,ne,re)}_updatePointsCoordinatePricesDiff(){this._pointsCoordinatePricesDiff=this._calculatePointsCoordinatePricesDiff()}_calculatePointsCoordinatePricesDiff(){if(this.controlPoints.length===2){const[{price:ee},{price:ne}]=this.controlPoints;return this._priceCoordinateDiff([ee,ne])??null}return null}_priceCoordinateDiff(ee){const ne=this._pricesToCoordinates(ee);if(ne)return ne[1]-ne[0]}_pricesToCoordinates(ee){return ee.map(ne=>ensure(this.series.priceToCoordinate(ne)))}firstPatternPrice(){const{mode:ee,flipped:ne}=this.properties(),re=this._pattern[0];if(ee===BarsPatternMode.LineHL2)return(re[2]+re[3])/2;const se=ee;return ne?re[flippedIndexMap[se]]:re[primaryIndexMap[se]]}lastPatternPrice(){const{mode:ee,flipped:ne}=this.properties(),re=this._pattern[this._pattern.length-1];if(ee===BarsPatternMode.LineHL2)return(re[2]+re[3])/2;const se=ee;return ne?re[flippedIndexMap[se]]:re[primaryIndexMap[se]]}_patternPriceDiff(){return this.lastPatternPrice()-this.firstPatternPrice()}_createPattern(ee,ne){const re=this.series.data(),se=[];for(let ae=ee;ae<=ne;ae++){const le=ensure(re[ae]);se.push([le.time,le.customValues.open,le.customValues.high,le.customValues.low,le.customValues.close])}return se}_calculateScale(){let ee=1;if(this.controlPoints.length===2){const ne=this._calculatePatternCoordinatePricesDiff();if(!ne)return ee;const re=this._calculatePointsCoordinatePricesDiff();if(re!==null&&(ee=parseFloat((re/ne).toFixed(8))),this._pointsCoordinatePricesDiff!==re){if(this._scale!==ee)return this._updateLastPoint(),this._scale;this._updatePointsCoordinatePricesDiff()}}return ee}_calculatePatternCoordinatePricesDiff(){return this._pattern.length>0?this._priceCoordinateDiff([this.firstPatternPrice(),this.lastPatternPrice()])??null:null}_updateLastPoint(){if(this.controlPoints.length<2)return;const ee=this._scale,ne=this._calculatePatternCoordinatePricesDiff(),re=this._pricesToCoordinates([this.controlPoints[0].price]);if(ne!==null&&re){const ae=+(ee*ne).toFixed(8)+re[0],le=ensure(this.series.coordinateToPrice(ae));this.controlPoints[1].price=le,this._updatePointsCoordinatePricesDiff()}}getScale(){return this._scale=this._calculateScale()}updateAllViews(){if(!this.controlPoints.length)return;let ee=NaN,ne=NaN,re=[];this.isDrawing||(ee=this.getScale(),ne=this.firstPatternPrice(),re=this._pattern);const se=this.controlPoints.map((ce,he)=>new AnchorPoint(this.pointToScreenPoint(ce),{pointIndex:he})),ae=se.map(ce=>ce.x),le=se.map(ce=>ce.y);this.controlPoints.forEach((ce,he)=>{this._timeAxisViews[he].update(this._calculateTimeAxisViewData(ce.time,se[he].x)),this._priceAxisViews[he].update(this._calculatePriceAxisViewData(ce.price,se[he].y))}),ae.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ae),Math.max.apply(null,ae))),le.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,le),Math.max.apply(null,le))),this._paneView[0].update({points:se,scale:ee,firstPatternPrice:ne,patternData:re})}}class BarsPatternTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",BarsPatternToolType);Ee(this,"steps",2);Ee(this,"disableExtendTime",!0)}createPrimitive(){return new BarsPatternPrimitive({id:this.id,points:[],color:"#2962FF",indexPoints:[],mode:BarsPatternMode.Bars,flipped:!1,mirrored:!1},...this.resetArgs)}onlyDrawingOnMainSeries(){return!0}}const ProjectionBarsPattern={type:BarsPatternToolType,icon:icon$A,Ctor:BarsPatternTool},icon$z=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path d="M19 11h5l-2.5 3z"></path><circle cx="21.5" cy="16.5" r="1.5"></circle><path fill-rule="nonzero" d="M22 11v-6h-1v6z"></path><path d="M14 18h1v3h-1z" id="Path"></path><path d="M14 5h1v6h-1z"></path><path d="M7 19h1v3h-1z"></path><path d="M7 6h1v7h-1z"></path><path fill-rule="nonzero" d="M7 13v6h1v-6h-1zm-1-1h3v8h-3v-8zM14 18h1v-7h-1v7zm-1-8h3v9h-3v-9z"></path></g></svg>
`,ForecastToolType="tool.projection.forecast";var AlertStatus=(ie=>(ie[ie.Waiting=0]="Waiting",ie[ie.Success=1]="Success",ie[ie.Failure=2]="Failure",ie))(AlertStatus||{}),Direction=(ie=>(ie[ie.Up=1]="Up",ie[ie.Down=2]="Down",ie))(Direction||{});const hourMinuteSecondFormat="%h:%m:%s",hourMinuteFormat="%h:%m",TOKEN_REGEX=/%h|%m|%s+|%ss+|%ss|%ampm|%s/g;class TimeFormatter{constructor(te=hourMinuteSecondFormat){Ee(this,"_isTwelveHoursFormat",!1);Ee(this,"_tokensAndDelimiters",[]);const ee=TOKEN_REGEX;let ne,re=0;for(;(ne=ee.exec(te))!==null;){const ae=ne[0],le=te.substring(re,ne.index);le!==""&&this._tokensAndDelimiters.push(le),this._tokensAndDelimiters.push(ae),ae==="%ampm"&&(this._isTwelveHoursFormat=!0),re=ne.index+ae.length}const se=te.substring(re);se&&this._tokensAndDelimiters.push(se)}format(te){return this._formatTime(te,!1)}formatLocal(te){return this._formatTime(te,!0)}_formatTime(te,ee){let ne=ee?te.getHours():te.getUTCHours();const re=ee?te.getMinutes():te.getUTCMinutes(),se=ee?te.getSeconds():te.getUTCSeconds(),ae=ee?te.getMilliseconds():te.getUTCMilliseconds();let le="";this._isTwelveHoursFormat&&(le=ne>=12?"PM":"AM",ne=ne%12||12);let ce="",he=!1;for(let fe=this._tokensAndDelimiters.length-1;fe>=0;fe--){const Ae=this._tokensAndDelimiters[fe];let pe="";switch(Ae){case"%h":pe=numberToStringWithLeadingZero(ne,2);break;case"%m":pe=numberToStringWithLeadingZero(re,2);break;case"%s":pe=numberToStringWithLeadingZero(se,2);break;case"%s+":if(se!==0)pe=numberToStringWithLeadingZero(se,2);else{he=!0;continue}break;case"%ss":pe=numberToStringWithLeadingZero(ae,3);break;case"%ss+":if(ae!==0)pe=numberToStringWithLeadingZero(ae,3);else{he=!0;continue}break;case"%ampm":pe=le;break;default:if(he){he=!1;continue}pe=Ae}ce=pe+ce}return ce}}let deferredPromises;function loadImage(ie){deferredPromises||(deferredPromises=new Map);const te=deferredPromises.get(ie);if(te)return te;const ee=new DeferredPromise;deferredPromises.set(ie,ee);const ne=new Image;return ne.onload=()=>{URL.revokeObjectURL(ie),ee.complete(ne)},ne.src=ie,ee}const clockIconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAQAAABKmM6bAAAAZ0lEQVR4Xl2OsQmAMBRErwgSsHAJV3GHgEVKl3ADixSClViKYPkHfEI+Wsg1j8dxnCQCiQ1jJRFcFIybHsNYCCJXvCSsJonzp/YXbiKzs7d8pavyEBP2yQEji5YV+1KIkmjI/ouRID31wXKLSuZPUAAAAABJRU5ErkJggg==",failureIconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAQAAABKmM6bAAAARElEQVR4AWMgHvy/9//5f34gzQZiQYSeAyEPkOYE0iAhMJOTAc4ixXjR/13/r/7////h/zn/pSFCT/43/lcHS6X9fwgANMArS3ikrioAAAAASUVORK5CYII=",successIconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAKCAQAAADI+WwIAAAAb0lEQVQIHWXAMQpBAQAG4L9eKQdQSr3JpFzC5CoOoJzBSUzK+iallNWkrG99pUymDxHw5Z+RdX4ZOpnmm57aXiuWunnScXAxTGLhqMyNth1muVNq1AYKK2wVeTBGo8JZP2/mgEk+KWxQ5ZfSUS8vV97kThm/FD/aAAAAAElFTkSuQmCC",S=makeFont(14,ChartFontFamily,"normal"),A=makeFont(14,ChartFontFamily,"bold"),C=makeFont(11,ChartFontFamily,"normal"),M=makeFont(12,ChartFontFamily,"normal"),k=makeFont(10,ChartFontFamily,"normal");class ForecastRenderer extends MediaCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_sourceWidth");Ee(this,"_sourceHeight");Ee(this,"_sourceRectLeftOffset");Ee(this,"_targetWidth");Ee(this,"_targetHeight");Ee(this,"_targetRectLeftOffset");Ee(this,"_target1TextWidthCache",new et);Ee(this,"_target1BoldTextWidthCache",new et);Ee(this,"_target2TextWidthCache",new et);Ee(this,"_source1TextWidthCache",new et);Ee(this,"_source2TextWidthCache",new et)}hitTest(ee){if(this._data===null||this._data.points.length<2)return null;const ne=this._data.points[0],se=this._data.points[1].subtract(ne),ae=ee.subtract(ne),le=Math.abs(se.x),ce=Math.abs(se.y),he=sign(se.y)*(ce-ce*Math.sqrt(1-ae.x*ae.x/(le*le)));if(Math.abs(he-ae.y)<3)return new HitTestResult(HitTarget.MovePoint);const fe=this._targetLabelHitTest(ee);return fe||this._sourceLabelHitTest(ee)}_targetLabelHitTest(ee){if(this._data===null||this._targetWidth===void 0||this._targetHeight===void 0||this._targetRectLeftOffset===void 0)return null;let ne=this._targetHeight+5;this._data.status&&(ne+=24);const re=this._data.direction===Direction.Up?-1:1,se=this._data.points[1],ae=se.x-this._targetRectLeftOffset,le=se.y+3*re,ce=se.y+re*(ne+3),he=Math.min(le,ce),fe=Math.max(le,ce);return ee.x>=ae&&ee.x<=ae+this._targetWidth&&ee.y>=he&&ee.y<=fe?new HitTestResult(HitTarget.MovePoint):null}_sourceLabelHitTest(ee){if(this._data===null||this._sourceWidth===void 0||this._sourceHeight===void 0||this._sourceRectLeftOffset===void 0)return null;const ne=this._data.direction===Direction.Up?1:-1,re=this._data.points[0],se=re.x-this._sourceRectLeftOffset,ae=re.y+3*ne,le=re.y+ne*(3+this._sourceHeight+5),ce=Math.min(ae,le),he=Math.max(ae,le);return ee.x>=se&&ee.x<=se+this._sourceWidth&&ee.y>=ce&&ee.y<=he?new HitTestResult(HitTarget.MovePoint):null}drawImpl(ee){if(!this._data||this._data.points.length<2)return;const ne=ee.context,re=ee.mediaSize,se=this._data.points[0],ae=this._data.points[1],le=ae.subtract(se),ce=Math.abs(le.x),he=Math.abs(le.y);ne.lineCap="butt",ne.strokeStyle=this._data.color,ne.lineWidth=this._data.linewidth;let fe,Ae,pe;le.y<0?(fe=Math.PI/2,Ae=le.x>0?0:Math.PI,pe=1):(fe=-Math.PI/2,Ae=le.x>0?0:-Math.PI,pe=-1),ne.beginPath(),ne.ellipse(se.x,ae.y,ce,he,0,fe,Ae,fe>Ae),ne.stroke(),this._drawTargetLabel(ne,re),this._drawStartLabel(ne,re);const Oe=Math.max(8,4*this._data.linewidth);let Fe;if(Math.abs(le.x)<1||Math.abs(le.y)<1)Fe=Math.atan(le.x/le.y);else{let Ne=0,ze=Math.PI/2,He=(Ne+ze)/2,We=0,je=0;if(le.length()>Oe){let Ue=0;for(;Ue<10;){We=ce*Math.sin(He),je=he*(1-Math.cos(He));const Ge=Math.sqrt((We-ce)**2+(je-he)**2);if(Math.abs(Ge-Oe)<1)break;Ge>Oe?Ne=He:ze=He,He=(Ne+ze)/2,Ue++}}Fe=Math.atan((ce-We)/(he-je)),le.x*le.y<0&&(Fe=-Fe)}ne.fillStyle=this._data.color,ne.save(),ne.beginPath(),ne.translate(ae.x,ae.y),ne.rotate(-Fe),ne.moveTo(0,0),ne.lineTo(-Oe/2,pe*Oe),ne.lineTo(Oe/2,pe*Oe),ne.lineTo(0,0),ne.restore(),ne.fill()}_drawTargetLabel(ee,ne){if(this._data===null)return;ee.save();const{targetLine1:re,targetLine2:se,targetLine3:ae,targetLine4:le,clockWhite:ce,direction:he,targetBackColor:fe,targetStrokeColor:Ae,centersColor:pe,targetTextColor:Oe,successBackground:Fe,successTextColor:Ne,failureBackground:ze,failureTextColor:He,successIcon:We,failureIcon:je,status:Ue,points:Ge}=this._data,Ze=Ge[1];ee.font=S;const Ye=this._target1TextWidthCache.measureText(ee,re),qe=this._target1TextWidthCache.measureText(ee,se),nr=this._target1TextWidthCache.measureText(ee," ");ee.font=C;const ir=this._target2TextWidthCache.measureText(ee,ae),tr=this._target2TextWidthCache.measureText(ee,le),or=this._target2TextWidthCache.measureText(ee," "),Jt=(ce==null?void 0:ce.width)??0;this._targetWidth=Math.max(Ye+qe+nr,ir+tr+Jt+2*or)+8+4,this._targetHeight=38;const rr=Ze.x+this._targetWidth-ne.width+5;this._targetRectLeftOffset=Math.max(20,Math.min(this._targetWidth-15,rr));const lr=he===Direction.Up?Direction.Down:Direction.Up,ur=this._drawBalloon(ee,Ze,this._targetWidth,this._targetHeight,lr,this._targetRectLeftOffset);ee.fillStyle=fe,ee.fill(),ee.lineWidth=2,ee.strokeStyle=Ae,ee.stroke(),ee.beginPath(),ee.arc(Ze.x,Ze.y,3,0,2*Math.PI,!1),ee.fillStyle=pe,ee.fill(),ee.textBaseline="top",ee.fillStyle=Oe,ee.font=S,ee.textAlign=isRtl()?"right":"left";const Sr=ur.x+4+2,xr=ur.y+3+2,Pr=this._targetWidth-8-4,mr=calcTextHorizontalShift(ee,Pr-qe-nr);ee.fillText(re,Sr+mr,xr);const Er=calcTextHorizontalShift(ee,Pr-Ye);ee.fillText(se,Sr+Ye+nr+Er,xr);const dr=xr+14+3;ee.font=C;const Cr=calcTextHorizontalShift(ee,Pr-tr-Jt-or);ee.fillText(ae,Sr+Cr,dr);const Or=calcTextHorizontalShift(ee,Pr-ir-or-Jt-tr);ce&&ee.drawImage(ce,Sr+ir+or+Or,dr+1);const Ar=calcTextHorizontalShift(ee,Pr-ir-Jt);if(ee.fillText(le,Sr+ir+Jt+2*or+Ar,dr),!Ue){ee.restore();return}let Ir,wr,Dr,Ur;ee.font=A;const zr=18;Ue===AlertStatus.Success?(Ir=this._data.successText,wr=Fe,Dr=Ne,Ur=We):(Ir=this._data.failureText,wr=ze,Dr=He,Ur=je);const Fr=this._target1BoldTextWidthCache.measureText(ee,Ir),Jr=Math.round((this._targetWidth-Fr)/2),po=calcTextHorizontalShift(ee,Fr);ee.fillStyle=wr,he===Direction.Up?(drawRoundRect(ee,ur.x-1,ur.y-zr-2,this._targetWidth+2,zr,5),ee.fill(),ee.fillStyle=Dr,ee.fillText(Ir,ur.x+Jr+po,ur.y-zr+1),Ur&&ee.drawImage(Ur,ur.x+Jr-Ur.width-4,ur.y-zr-2+Math.abs(zr-Ur.height)/2)):(drawRoundRect(ee,ur.x-1,ur.y+this._targetHeight+2,this._targetWidth+2,zr,5),ee.fill(),ee.fillStyle=Dr,ee.fillText(Ir,ur.x+Jr+po,ur.y+this._targetHeight+5),Ur&&ee.drawImage(Ur,ur.x+Jr-Ur.width-4,ur.y+this._targetHeight+10-Math.abs(zr-Ur.height)/2)),ee.restore()}_drawStartLabel(ee,ne){if(!this._data)return;ee.save(),ee.font=M;const re=this._source1TextWidthCache.measureText(ee,this._data.sourceLine1);ee.font=k;const se=this._source2TextWidthCache.measureText(ee,this._data.sourceLine2);this._sourceWidth=Math.max(re,se)+6+4,this._sourceHeight=32;const ae=this._data.points[0],le=ae.x+this._sourceWidth-ne.width+5;this._sourceRectLeftOffset=Math.max(20,Math.min(this._sourceWidth-15,le));const ce=this._drawBalloon(ee,ae,this._sourceWidth,this._sourceHeight,this._data.direction,this._sourceRectLeftOffset);ee.fillStyle=this._data.sourceBackColor,ee.fill(),ee.lineWidth=2,ee.strokeStyle=this._data.sourceStrokeColor,ee.stroke(),ee.textAlign=isRtl()?"right":"left",ee.textBaseline="top",ee.fillStyle=this._data.sourceTextColor;const he=calcTextHorizontalShift(ee,this._sourceWidth-6-4),fe=ce.x+4+2+he,Ae=ce.y+2+2;ee.font=M,ee.fillText(this._data.sourceLine1,fe,Ae),ee.font=k,ee.fillText(this._data.sourceLine2,fe,Ae+14),ee.beginPath(),ee.arc(ae.x,ae.y,3,0,2*Math.PI,!1),ee.fillStyle=this._data.centersColor,ee.fill(),ee.restore()}_drawBalloon(ee,ne,re,se,ae,le=20){ee.beginPath();const ce=10,he=5,fe=3;let Ae;if(ae===Direction.Down){Ae={x:ne.x-le,y:ne.y-he-6-se};const pe=Ae.x,Oe=Ae.y,Fe=pe+re;return ee.moveTo(pe+fe,Oe),ee.lineTo(Fe-fe,Oe),ee.arcTo(Fe,Oe,Fe,Oe+fe,fe),ee.lineTo(Fe,Oe+se-fe),ee.arcTo(Fe,Oe+se,Fe-fe,Oe+se,fe),ee.lineTo(pe+le+ce/2,Oe+se),ee.lineTo(pe+le,Oe+se+he),ee.lineTo(pe+le-ce/2,Oe+se),ee.lineTo(pe+fe,Oe+se),ee.arcTo(pe,Oe+se,pe,Oe+se-fe,fe),ee.lineTo(pe,Oe+fe),ee.arcTo(pe,Oe,pe+fe,Oe,fe),Ae}else{Ae={x:ne.x-le,y:ne.y+he+6+se};const pe=Ae.x,Oe=Ae.y,Fe=pe+re;return ee.moveTo(pe+fe,Oe),ee.lineTo(Fe-fe,Oe),ee.arcTo(Fe,Oe,Fe,Oe-fe,fe),ee.lineTo(Fe,Oe-se+fe),ee.arcTo(Fe,Oe-se,Fe-fe,Oe-se,fe),ee.lineTo(pe+le+ce/2,Oe-se),ee.lineTo(pe+le,Oe-se-he),ee.lineTo(pe+le-ce/2,Oe-se),ee.lineTo(pe+fe,Oe-se),ee.arcTo(pe,Oe-se,pe,Oe-se+fe,fe),ee.lineTo(pe,Oe-fe),ee.arcTo(pe,Oe,pe+fe,Oe,fe),{x:pe,y:Oe-se}}}}class ForecastPaneView extends ToolPaneView{constructor(ee,ne){super(ee,ne);Ee(this,"_predictionRenderer",new ForecastRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));loadImage(clockIconUrl).p.then(()=>{this._source.requestUpdate()}),loadImage(successIconUrl).p.then(()=>{this._source.requestUpdate()}),loadImage(failureIconUrl).p.then(()=>{this._source.requestUpdate()})}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=this._source.properties(),re=ne.transparency;this._predictionRenderer.setData({points:ee,color:ne.linecolor,linewidth:ne.linewidth,targetLine1:this._data.diffText,targetLine2:this._data.durationString,targetLine3:this._data.priceText,targetLine4:this._data.targetTimeText,status:this._data.status,targetBackColor:generateColor(ne.targetBackColor,re),targetStrokeColor:generateColor(ne.targetStrokeColor,re),targetTextColor:ne.targetTextColor,sourceBackColor:generateColor(ne.sourceBackColor,re),sourceStrokeColor:generateColor(ne.sourceStrokeColor,re),sourceTextColor:ne.sourceTextColor,successBackground:generateColor(ne.successBackground,re),successTextColor:ne.successTextColor,failureBackground:generateColor(ne.failureBackground,re),failureTextColor:ne.failureTextColor,sourceLine1:this._data.sourcePriceText,sourceLine2:this._data.sourceTimeText,direction:this._data.direction,clockWhite:loadImage(clockIconUrl).value??void 0,successIcon:loadImage(successIconUrl).value??void 0,failureIcon:loadImage(failureIconUrl).value??void 0,centersColor:"#000000",successText:ne.successText,failureText:ne.failureText}),this._renderer.append(this._predictionRenderer),this.addAnchors(this._renderer)}}class ForecastPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ForecastPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}addPoint(ee,ne){const re=super.addPoint(ee,ne);return this.recalculateStateByData(),re}setPoint(ee,ne,re){super.setPoint(ee,ne,re),this.recalculateStateByData()}endMoving(){super.endMoving(),this.recalculateStateByData()}status(){return this._props.status}setStatus(ee){this._props.status=ee}direction(){if(this.controlPoints.length<2)return Direction.Up;const ee=this.controlPoints[0];return this.controlPoints[1].price>ee.price?Direction.Up:Direction.Down}recalculateStateByData(){if(this.setStatus(AlertStatus.Waiting),this.controlPoints.length<2)return;const ee=this.controlPoints[1],ne=this.chart.timeScale().getVisibleRange();if(!ne||ee.time>ne.to)return;const re=this.chart.timeScale().timeToIndex(ee.time);if(re===null)return;const se=this.series.dataByIndex(re);if(se===null)return;const ae=this.direction(),le=ensure(se.customValues.high),ce=ensure(se.customValues.low),he=ee.price,fe=ae===Direction.Up&&le>=he||ae===Direction.Down&&ce<=he;this.setStatus(fe?AlertStatus.Success:AlertStatus.Failure)}updateAllViews(){var Ye;if(((Ye=this.controlPoints)==null?void 0:Ye.length)<1)return;const ee=this.controlPoints.map((qe,nr)=>new AnchorPoint(this.pointToScreenPoint(qe),{pointIndex:nr})),ne=ee.map(qe=>qe.x),re=ee.map(qe=>qe.y);this.controlPoints.forEach((qe,nr)=>{this._timeAxisViews[nr].update(this._calculateTimeAxisViewData(qe.time,ee[nr].x)),this._priceAxisViews[nr].update(this._calculatePriceAxisViewData(qe.price,ee[nr].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re)));const se=this.series.priceFormatter(),[ae,le]=this.controlPoints,ce=le.price-ae.price,he=ce/Math.abs(ae.price)*100,fe=forceLTRStr(se.format(le.price)),Ae=forceLTRStr(`${se.format(ce)} (${getPercentageFormatter().format(he)})`),pe=new Date(ae.time*1e3),Oe=new Date(le.time*1e3),Fe=this._ctx.chartService.interval(),Ne=Fe.isDWM(),ze=Fe.isSeconds()||Fe.isTicks();let He="",We="";const je=this._ctx.dateFormatter;if(pe&&Oe){const qe=new TimeFormatter(ze?hourMinuteSecondFormat:hourMinuteFormat),nr=Ne?"":`  ${qe.format(Oe)}`;He=`${je(Oe)}${nr}`,We=this._props.formatTargetLine2(startWithLTR(this._ctx.timeSpanFormatter(pe.getTime(),Oe.getTime())))}const Ue=se.format(ae.price);let Ge="";const Ze=new TimeFormatter(ze?hourMinuteSecondFormat:hourMinuteFormat);Ge=`${je(pe)}${Ne?"":"  "+Ze.format(pe)}`,this._paneView[0].update({points:ee,priceText:fe,diffText:Ae,targetTimeText:He,durationString:We,sourcePriceText:Ue,sourceTimeText:Ge,direction:this.direction(),status:this.status()})}}class ForecastTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ForecastToolType);Ee(this,"steps",2)}createPrimitive(ee){const ne=getI18nService(ee);return new ForecastPrimitive({id:this.id,points:[],linecolor:"#2962FF",linewidth:2,sourceBackColor:"#2962FF",sourceTextColor:"#ffffff",sourceStrokeColor:"#2962FF",targetStrokeColor:"#2962FF",targetBackColor:"#2962FF",targetTextColor:"#ffffff",successBackground:"#4caf50",successTextColor:"#ffffff",failureBackground:"#F23645",failureTextColor:"#ffffff",status:AlertStatus.Waiting,transparency:10,centersColor:"#202020",successText:ne.t("tool.forecast.success"),failureText:ne.t("tool.forecast.failure"),formatTargetLine2:re=>ne.t("tool.forecast.in",{timeSpan:re})},...this.resetArgs)}}const ProjectionForecast={type:ForecastToolType,icon:icon$z,Ctor:ForecastTool},icon$y=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M4.529 18.21l3.157-1.292-.379-.926-3.157 1.292z"></path><path fill-rule="nonzero" d="M9.734 16.081l2.97-1.215-.379-.926-2.97 1.215z"></path><path fill-rule="nonzero" d="M14.725 14.039l2.957-1.21-.379-.926-2.957 1.21z"></path><path fill-rule="nonzero" d="M19.708 12.001l3.114-1.274-.379-.926-3.114 1.274z"></path><path d="M8 18h1v3h-1z" id="Path"></path><path d="M8 9h1v5h-1z"></path><path fill-rule="nonzero" d="M8 18h1v-4h-1v4zm-1-5h3v6h-3v-6z" id="Rectangle-44"></path><path d="M18 16h1v3h-1z" id="Path"></path><path d="M18 3h1v6h-1z"></path><path fill-rule="nonzero" d="M18 16h1v-7h-1v7zm-1-8h3v9h-3v-9z" id="Rectangle-44"></path><path d="M13 6h1v5h-1z"></path><path d="M13 15h1v5h-1z"></path><path fill-rule="nonzero" d="M13 15h1v-4h-1v4zm-1-5h3v6h-3v-6z"></path><path fill-rule="nonzero" d="M2.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,GhostFeedToolType="tool.projection.ghostFeed";class PaneRendererSeriesBase extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_bars",[])}hitTest(ee){const ne=this._bars;if(ne.length===0)return null;const re=this._getTolerance(),se=ne[0],ae=ne[ne.length-1];if(ee.x<se.left-re||ee.x>ae.right+re)return null;let le=0,ce=ne.length-1,he=-1;for(;le<=ce;){const pe=Math.floor((le+ce)/2),Oe=ne[pe];if(ee.x>=Oe.left&&ee.x<=Oe.right){he=pe;break}ee.x>Oe.right?le=pe+1:ce=pe-1}if(he===-1)return null;if(this._isPointAtBar(ne[he],ee.y,re))return this._getHitTest();let fe=he;for(;fe>=1&&ee.x-ne[fe-1].right<re;)fe--;let Ae=he;for(;Ae<=ne.length-2&&ne[Ae+1].left-ee.x<re;)Ae++;for(let pe=fe;pe<=Ae;pe++)if(pe!==he&&this._isPointAtBar(ne[pe],ee.y,re))return this._getHitTest();return null}_getHitTest(){return new HitTestResult(HitTarget.Regular)}_isPointAtBar(ee,ne,re){const se=Math.min(ee.high,ee.low),ae=Math.max(ee.high,ee.low);return se-re<=ne&&ne<=ae+re}}function computeCandleGeometry(ie,te,ee,ne){const re=Math.floor(te);return ie.map(se=>{let ae=ge((se.right-se.left)*ne,te);ae>=2&&re%2!==ae%2&&ae--;const le=Math.floor(.5*ae),ce=function(He,We){let je=Math.floor(1*We);He<=2*je&&(je=Math.floor(.5*(He-1)));const Ue=Math.max(Math.floor(We),je);return He<=2*Ue?Math.max(Math.floor(We),Math.floor(1*We)):Ue}(ae,te),he=Math.round(se.center*te),fe=he-le,Ae=fe+ae-1,pe=Math.abs(Math.max(se.open,se.close)-Math.min(se.open,se.close))*ee,Oe=Math.round(Math.min(se.open,se.close)*ee),Fe=Math.round(Math.max(se.open,se.close)*ee);let Ne=Math.min(Math.floor(te),Math.floor(ae*te));Ne=Math.max(Math.floor(te),Math.min(Ne,ae));const ze=Math.floor(.5*Ne);return{rawBodyHeight:pe,top:Oe,bottom:Fe,center:he,left:fe,right:Ae,candleWidth:ae,high:Math.round(se.high*ee),low:Math.round(se.low*ee),wickWidth:Ne,wickOffset:ze,borderWidth:ce}})}class PaneRendererCandles extends PaneRendererSeriesBase{constructor(){super(...arguments);Ee(this,"_scaleCoeff",1);Ee(this,"_borderVisible",!1);Ee(this,"_wickVisible",!1);Ee(this,"_bodyVisible",!0);Ee(this,"_borderColor");Ee(this,"_wickColor");Ee(this,"_isPriceScaleInverted",!1)}setData(ee){super.setData(ee),this._bars=ee.bars,this._scaleCoeff=ee.scaleCoeff??1,this._borderVisible=ee.borderVisible,this._bodyVisible=ee.bodyVisible,this._wickVisible=ee.wickVisible,this._borderColor=ee.borderColor,this._wickColor=ee.wickColor,this._hitTest=ee.hittest,this._isPriceScaleInverted=ee.isPriceScaleInverted}hitTest(ee){return!this._wickVisible&&!this._borderVisible&&!this._bodyVisible?null:super.hitTest(ee)}drawImpl(ee){var le;const{context:ne,horizontalPixelRatio:re,verticalPixelRatio:se}=ee;if(!this._data||((le=this._bars)==null?void 0:le.length)===0)return;const ae=computeCandleGeometry(this._bars,re,se,this._scaleCoeff);this._wickVisible&&this._drawWicks(ne,ae),this._borderVisible&&this._drawBorder(ne,ae),this._bodyVisible&&this._drawCandles(ne,ae)}_calcBarWidth(ee){const ne=Math.floor(ee);return Math.max(ne,Math.floor(Me(ensure(this._data).barSpacing,ee)))}_getTolerance(){return interactionTolerance().series}_getHitTest(){return this._hitTest||new HitTestResult(HitTarget.Regular)}_isPointAtBar(ee,ne,re){const se=this._bodyVisible||this._borderVisible,ae=this._wickVisible;if(!se&&!ae)return!1;if(se){const le=ae?Math.min(ee.high,ee.low):Math.min(ee.open,ee.close),ce=ae?Math.max(ee.high,ee.low):Math.max(ee.open,ee.close);return le-re<=ne&&ne<=ce+re}else{const le=Math.min(ee.open,ee.close),ce=Math.max(ee.open,ee.close);return ee.high-re<=ne&&ne<=le+re||ce-re<=ne&&ne<=ee.low+re}}_drawWicks(ee,ne){let re="",se=null;this._bars.forEach((ae,le)=>{const ce=ae.wickColor??ensure(this._wickColor);ce!==re&&(ee.fillStyle=ce,re=ce);let{top:he,bottom:fe}=ne[le];const{rawBodyHeight:Ae,borderWidth:pe,center:Oe,high:Fe,low:Ne,wickWidth:ze,wickOffset:He}=ne[le];this._isPriceScaleInverted&&([he,fe]=[fe,he]);let We=Oe-He;const je=We+ze-1;se!==null&&(We=Math.max(se+1,We),We=Math.min(We,je));const Ue=je-We+1;Ae<=pe&&(he!==Fe&&(he=Math.round(he-.5*pe)),fe=fe!==Ne?Math.round(he-.5*pe)+pe-1:Ne-1),he!==Fe&&ee.fillRect(We,Fe,Ue,he-Fe),Ne-fe-1&&ee.fillRect(We,fe+1,Ue,Ne-fe-1),se=je})}_drawBorder(ee,ne){let re="",se=null;this._bars.forEach((ae,le)=>{const ce=ae.borderColor??ensure(this._borderColor);if(ce!==re&&(ee.fillStyle=ce,re=ce),this._bodyVisible&&ae.hollow)return;let{left:he}=ne[le];const{rawBodyHeight:fe,top:Ae,bottom:pe,right:Oe,borderWidth:Fe}=ne[le];se!==null&&(he=Math.max(se+1,he),he=Math.min(he,Oe));const Ne=Oe-he+1;fe<=Fe?ee.fillRect(he,Math.round(Ae-.5*Fe),Ne,Fe):Ne>2*Fe?z(ee,he,Ae,Ne,pe-Ae+1,Fe):ee.fillRect(he,Ae,Ne,pe-Ae+1),se=Oe})}_drawCandles(ee,ne){let re="";this._bars.forEach((se,ae)=>{let{top:le,bottom:ce,left:he,right:fe}=ne[ae];const{rawBodyHeight:Ae,borderWidth:pe,candleWidth:Oe}=ne[ae],Fe=fe-he+1;if(!(this._borderVisible&&Oe<=2*pe)||se.hollow)if(se.color!==re&&(ee.fillStyle=se.color,re=se.color),se.hollow)ee.fillStyle=se.color,Ae<=pe?ee.fillRect(he,Math.round(le-.5*pe),Oe,pe):z(ee,he,le,Fe,ce-le+1,pe);else if(!this._borderVisible&&Ae<=pe)ee.fillRect(he,Math.round(le-.5*pe),Oe,pe);else{if(this._borderVisible&&(he+=pe,le+=pe,fe-=pe,ce-=pe),le>ce)return;ee.fillRect(he,le,fe-he+1,ce-le+1)}})}}class GhostFeedPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(!(ee!=null&&ee.length))return;const ne=this._source.priceScale(),re=this._source.properties(),se=re.candleStyle,ae=se.upColor,le=se.downColor,ce=se.borderUpColor,he=se.borderDownColor,fe=this._source.timeScale().barSpacing(),Ae=fe,pe=this._data.segments.map((je,Ue)=>{if(Ue>=ee.length-1)return null;let Ge=ee[Ue],Ze=ee[Ue+1],Ye=this._source.controlPoints[Ue],qe=this._source.controlPoints[Ue+1],nr=this._source.controlPoints[Ue].price,ir=this._source.controlPoints[Ue+1].price,tr=1;Ge.x>Ze.x&&([Ge,Ze]=[Ze,Ge],[nr,ir]=[ir,nr],[Ye,qe]=[qe,Ye],tr=-1);const or=ensure(this._source.timeScale().timeToIndexEx(Ye.time)),Jt=ensure(ne.priceToCoordinate(nr)),rr=ensure(ne.priceToCoordinate(ir)),lr=je.bars(),ur=lr.length,Sr=(rr-Jt)/(ur-1),xr=[];let Pr=tr>0?0:ur-1;const mr=tr>0?ur:-1;for(let Er=0;Pr!==mr;Pr+=tr,Er++){const dr=Jt+Er*Sr,Cr=ensure(ne.coordinateToPrice(dr)),Or=lr[Pr],Ar=Or.c>=Or.o,Ir=ensure(this._source.timeScale().logicalToCoordinate(or+Er));xr.push({open:ensure(ne.priceToCoordinate(Cr+Or.o)),high:ensure(ne.priceToCoordinate(Cr+Or.h)),low:ensure(ne.priceToCoordinate(Cr+Or.l)),close:ensure(ne.priceToCoordinate(Cr+Or.c)),color:Ar?ae:le,borderColor:Ar?ce:he,hollow:!1,center:Ir,left:Ir-Ae/2,right:Ir+Ae/2,timePointIndex:or+Er})}return{bars:xr}}).filter(je=>je!==null);for(let je=1;je<this.points().length;je++){const Ue={points:[this.points()[je-1],this.points()[je]],lineColor:"#000",lineWidth:1,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},Ge=new LineRenderer;Ge.setData(Ue),Ge.setHitTest(new HitTestResult(HitTarget.MovePoint)),this._renderer.append(Ge)}const Oe=se.drawWick,Fe=se.drawBorder,Ne=se.borderColor,ze=se.wickColor,He=1-re.transparency/100,We=new CompositeRenderer;We.setGlobalAlpha(He);for(const je of pe){const Ue=new PaneRendererCandles;Ue.setData({bars:je.bars,barSpacing:fe,wickVisible:Oe,bodyVisible:!0,borderVisible:Fe,borderColor:Ne,wickColor:ze,barWidth:Ae,hittest:new HitTestResult(HitTarget.MovePoint),isPriceScaleInverted:!1}),We.append(Ue)}this._renderer.append(We),this.addAnchors(this._renderer)}}class Segment{constructor(te,ee,ne=[]){this._source=te,this._segmentIndex=ee,this._bars=ne}setBars(te){this._bars=te}generate(){this._bars=[];const te=this._source.controlPoints,ee=te[this._segmentIndex],ne=te[this._segmentIndex+1];if(!ee||!ne)return;const re=this._source.getIndex(ee),se=this._source.getIndex(ne);if(re===se)return;const ae=this._segmentIndex?re+1:re,le=Math.sign(se-re);for(let ce=ae;ce!==se;ce+=le)this._bars.push(this._createBar())}bars(){return this._bars}setSize(te){if(te<this._bars.length)this._bars.splice(te,this._bars.length-te);else for(;this._bars.length<te;)this._bars.push(this._createBar())}_createBar(){const te=this._source.properties().averageHL,ee=this._source.properties().variance/100,ne=this._source.properties().base;let re=Math.random();const se=te*(1-2*re)*ee;re=Math.random();const ae=te*(1+(.5-re)*ee),le=se-ae/2,ce=le+ae;return{o:(le+Math.random()*ae)/ne,h:ce/ne,l:le/ne,c:(le+Math.random()*ae)/ne}}}class GhostFeedPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new GhostFeedPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_segments",[])}addPoint(ee,ne){return super.addPoint(ee,ne),this.controlPoints.length>2&&this._generateBars(this.controlPoints.length-3),AddPointResponse.Accept}setPoint(ee,ne,re){if(super.setPoint(ee,ne,re),ee>0){const se=this.getIndex(this.controlPoints[ee]),ae=this.getIndex(this.controlPoints[ee-1]),le=se-ae;this._segments[ee-1].setSize(Math.abs(le))}if(ee<this.controlPoints.length-1){const se=this.getIndex(this.controlPoints[ee+1]),ae=this.getIndex(this.controlPoints[ee]),le=se-ae;this._segments[ee].setSize(Math.abs(le))}}_generateBars(ee){this._segments.length<=ee&&(this._segments.push(new Segment(this,ee)),this._segments[ee].generate())}abort(){return this.model.markCreatingFinishedOrAborted(this),this.controlPoints.pop(),this._props.points.length<2?DrawingAbortBehavior.Remove:DrawingAbortBehavior.None}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._paneView[0].update({points:ee,segments:this._segments})}}class GhostFeedTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",GhostFeedToolType);Ee(this,"steps",1/0)}createPrimitive(ee){const ne=this._calculateATR(ee),re=ee.chartService.symbolInfo().pricescale;return new GhostFeedPrimitive({id:this.id,points:[],base:re,averageHL:ne*re,variance:50,candleStyle:{upColor:"#ACE5DC",downColor:"#FAA1A4",drawWick:!0,drawBorder:!0,borderColor:"#378658",borderUpColor:"#089981",borderDownColor:"#F23645",wickColor:"#808080"},transparency:50},...this.resetArgs)}_calculateATR(ee){const ne=getMainSeries(ee).data(),re=[];return ne.forEach(ae=>{const{high:le,low:ce}=ae.customValues;re.push(le-ce)}),re.length===0?0:re.reduce((ae,le)=>ae+le,0)/re.length}onlyDrawingOnMainSeries(){return!0}}function getMainSeries(ie){return ie.chartService.mainSeriesWrapper.getSeries()}const ProjectionGhostFeed={type:GhostFeedToolType,icon:icon$y,Ctor:GhostFeedTool},icon$x=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M4.5 5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2 6.5A2.5 2.5 0 0 1 6.95 6H24v1H6.95A2.5 2.5 0 0 1 2 6.5zM4.5 15a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2 16.5a2.5 2.5 0 0 1 4.95-.5h13.1a2.5 2.5 0 1 1 0 1H6.95A2.5 2.5 0 0 1 2 16.5zM22.5 15a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm-18 6a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM2 22.5a2.5 2.5 0 0 1 4.95-.5H24v1H6.95A2.5 2.5 0 0 1 2 22.5z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M22.4 8.94l-1.39.63-.41-.91 1.39-.63.41.91zm-4 1.8l-1.39.63-.41-.91 1.39-.63.41.91zm-4 1.8l-1.4.63-.4-.91 1.39-.63.41.91zm-4 1.8l-1.4.63-.4-.91 1.39-.63.41.91z"></path></svg>
`,LongPositionToolType="tool.projection.longPosition";function calculateLevel(ie){const te=ensure(ie.chartService.chart.timeScale().getVisibleLogicalRange());let ee=Number.POSITIVE_INFINITY,ne=Number.NEGATIVE_INFINITY;for(let le=te.from;le<=te.to;le++){const ce=ie.chartService.mainSeriesWrapper.getSeries().dataByIndex(le);if(!ce)break;const{high:he,low:fe}=ce.customValues;ee=Math.min(fe,ee),ne=Math.max(he,ne)}const re=Math.abs(ne-ee),se=ie.chartService.symbolInfo(),ae=se.pricescale/se.minmov;return Math.round(.2*re*ae)}var RiskRewardPointIndex=(ie=>(ie[ie.Entry=0]="Entry",ie[ie.Close=1]="Close",ie[ie.ActualEntry=2]="ActualEntry",ie[ie.ActualClose=3]="ActualClose",ie))(RiskRewardPointIndex||{}),RiskDisplayMode=(ie=>(ie.Percentage="percents",ie.Money="money",ie))(RiskDisplayMode||{});class PositionPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_entryLineRenderer",new LineRenderer);Ee(this,"_stopLineRenderer",new LineRenderer);Ee(this,"_targetLineRenderer",new LineRenderer);Ee(this,"_positionLineRenderer",new LineRenderer);Ee(this,"_fullStopBgRenderer",new RectangleRenderer);Ee(this,"_stopBgRenderer",new RectangleRenderer);Ee(this,"_fullTargetBgRenderer",new RectangleRenderer);Ee(this,"_targetBgRenderer",new RectangleRenderer);Ee(this,"_stopLabelRenderer",new BaseTextRenderer);Ee(this,"_middleLabelRenderer",new BaseTextRenderer);Ee(this,"_profitLabelRenderer",new BaseTextRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}isLabelVisible(){return this.isHoveredSource()||this.isSelectedSource()||this._source.properties().alwaysShowStats}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if((ee==null?void 0:ee.length)<2)return;const ne=ee.length===4,re=this._source.lastBarData();if(!re)return;const se=re.closePrice,ae=this._source.stopPrice(),le=this._source.profitPrice(),ce=this._source.calculatePL(se),he=this._source.symbolInfo();if(!he)return;const fe=this._source.priceScale(),Ae=this._source.timeScale(),pe=ee[RiskRewardPointIndex.Entry].y,Oe=ensure(fe.priceToCoordinate(ae)),Fe=ensure(fe.priceToCoordinate(le)),Ne=ensure(fe.priceToCoordinate(se)),ze=ensure(Ae.logicalToCoordinate(re.index)),He=ee[RiskRewardPointIndex.Entry].x,We=ee[RiskRewardPointIndex.ActualEntry]?ee[RiskRewardPointIndex.ActualEntry].x:ee[RiskRewardPointIndex.Close].x,je=ee[RiskRewardPointIndex.ActualClose]?ee[RiskRewardPointIndex.ActualClose].x:ee[RiskRewardPointIndex.Close].x,Ue=ee[RiskRewardPointIndex.Close].x,Ge=this._source.entryPrice(),Ze=this._source.stopPrice(),Ye=this._source.profitPrice(),qe={pl:ce,isClosed:ne,entryLevel:pe,stopLevel:Oe,profitLevel:Fe,closeLevel:Ne,closeBar:ze,left:He,entryX:We,right:je,edge:Ue,entryPrice:Ge,stopPrice:Ze,profitPrice:Ye,currentPrice:se},{mediaSize:{width:nr,height:ir}}=this._source.getScope();let tr=Ue<-5||He>nr+5;this._createBackgroundRenderers(qe),this._createLinesRenderers(qe);const or=getPipFormatter(he);if(this._createLabelsRenderers(qe,or),tr=[this._profitLabelRenderer,this._stopLabelRenderer,this._middleLabelRenderer].reduce((lr,ur)=>lr&&ur.isOutOfScreen(nr,ir),tr),tr)return;const[Jt]=ee,rr=[new AnchorPoint(new Point(He,Jt.y),{pointIndex:0}),new AnchorPoint(new Point(Ue,Jt.y),{pointIndex:1,resizeDirections:AnchorResizeHorz}),new AnchorPoint(new Point(He,Oe),{pointIndex:2,resizeDirections:AnchorResizeVert}),new AnchorPoint(new Point(He,Fe),{pointIndex:3,resizeDirections:AnchorResizeVert})];this._renderer.append(this.createLineAnchor({points:rr},0))}_createBackgroundRenderers(ee){const ne=this._source.properties();{const re={points:[new Point(ee.left,ee.entryLevel),new Point(ee.edge,ee.stopLevel)],color:"white",lineWidth:0,backColor:ne.stopBackground,transparency:ne.stopBackgroundTransparency,extendLeft:!1,extendRight:!1,fillBackground:!0,backgroundHitTarget:HitTarget.MovePoint};this._fullStopBgRenderer.setData(re),this._renderer.append(this._fullStopBgRenderer)}if(ee.pl<0&&ee.entryX!==ee.right){const re=new Point(ee.entryX,ee.entryLevel),se=new Point(ee.right,ee.closeLevel),le=100-100*(1-(.01*ne.stopBackgroundTransparency)**3),ce={points:[re,se],color:"white",lineWidth:0,backColor:ne.stopBackground,fillBackground:!0,transparency:le,extendLeft:!1,extendRight:!1,backgroundHitTarget:HitTarget.MovePoint};this._stopBgRenderer.setData(ce),this._renderer.append(this._stopBgRenderer)}{const re={points:[new Point(ee.left,ee.entryLevel),new Point(ee.edge,ee.profitLevel)],color:"white",lineWidth:0,backColor:ne.profitBackground,fillBackground:!0,transparency:ne.profitBackgroundTransparency,extendLeft:!1,extendRight:!1,backgroundHitTarget:HitTarget.MovePoint};this._fullTargetBgRenderer.setData(re),this._renderer.append(this._fullTargetBgRenderer)}if(ee.pl>0&&ee.entryX!==ee.right){const re=new Point(ee.entryX,ee.entryLevel),se=new Point(ee.right,ee.closeLevel),le=100-100*(1-(.01*ne.profitBackgroundTransparency)**3),ce={points:[re,se],color:"white",lineWidth:0,backColor:ne.profitBackground,fillBackground:!0,transparency:le,extendLeft:!1,extendRight:!1,backgroundHitTarget:HitTarget.MovePoint};this._targetBgRenderer.setData(ce),this._renderer.append(this._targetBgRenderer)}}_createLinesRenderers(ee){const ne=this.points(),re=this._source.properties(),se=(ae,le,ce,he)=>{const fe={points:[le,ce],lineColor:he??re.linecolor,lineWidth:re.linewidth,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal};ae.setData(fe),this._renderer.append(ae)};if(ne[RiskRewardPointIndex.ActualEntry]){const ae=ne[RiskRewardPointIndex.ActualEntry],le=ee.isClosed?ne[RiskRewardPointIndex.ActualClose]:new Point(ee.closeBar,ee.closeLevel),ce={points:[ae,le],lineColor:re.linecolor,lineWidth:1,lineStyle:LineStyleType.dashed,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Arrow};this._positionLineRenderer.setData(ce),this._renderer.append(this._positionLineRenderer)}{const ae=new Point(ee.left,ne[RiskRewardPointIndex.Entry].y),le=new Point(ee.edge,ne[RiskRewardPointIndex.Entry].y);se(this._entryLineRenderer,ae,le)}{const ae=new Point(ee.left,ee.stopLevel),le=new Point(ee.edge,ee.stopLevel);se(this._stopLineRenderer,ae,le,re.stopBackground)}{const ae=new Point(ee.left,ee.profitLevel),le=new Point(ee.edge,ee.profitLevel);se(this._targetLineRenderer,ae,le,re.profitBackground)}}_createLabelsRenderers(ee,ne){if(!this.isLabelVisible())return;const re=this.points(),se=this._creareMiddleLabel(ee),ae=this._createStopLabel(ee,ne),le=this._createTargetLabel(ee,ne),ce=[this._profitLabelRenderer,this._stopLabelRenderer,this._middleLabelRenderer].reduce((Ae,pe)=>Math.max(Ae,pe.measure().width),0),he=ee.edge-ee.left,fe=this._anchorRadius();if(he-ce-fe<=8&&(le&&(le.offsetY+=fe+8,this._profitLabelRenderer.setData(le)),ae&&(ae.offsetY+=fe+8,this._stopLabelRenderer.setData(ae)),se)){let Ae;if(this._source.chart.options().rightPriceScale.mode===pi.Logarithmic){const ze=Math.abs(re[0].y-ee.stopLevel);Ae=Math.abs(re[0].y-ee.profitLevel)-ze>1?-1:1}else{const ze=Math.abs(ee.stopPrice-ee.entryPrice);Ae=Math.abs(ee.profitPrice-ee.entryPrice)-ze>1?-1:1}const pe=ee.profitLevel<ee.stopLevel?1:-1,Oe=ensure(se.points)[0],Fe=.5*this._middleLabelRenderer.measure().height+fe+8,Ne=Oe.add(new Point(0,pe*Ae*Fe));se.points=[Ne],this._middleLabelRenderer.setData(se)}}_creareMiddleLabel(ee){const{entryPrice:ne,profitPrice:re,stopPrice:se,currentPrice:ae,pl:le,left:ce,edge:he,isClosed:fe}=ee,Ae=Math.abs(ne-re)/Math.abs(ne-se),pe=this._source.properties(),Oe=new Point((ce+he)/2,Math.round(this.points()[0].y));let Fe="",Ne="";const ze=getNumericFormatter().format(Math.round(Ae*100)/100);if(this.points()[1]){const Ue=this._source.series.priceFormatter();if("formatChange"in Ue&&lodashExports.isFunction(Ue.formatChange)){const Ge=Math.max(ae,ne),Ze=Math.min(ae,ne);Ne=le>=0?Ue.formatChange(Ge,Ze):Ue.formatChange(Ze,Ge)}else Ne=Ue.format(le)}const He=this._data.qty/pe.lotSize,We=Math.floor(He);if(pe.compact)Ne&&(Fe+=Ne+" ~ "),Fe+=We+`
`,Fe+=ze;else{const Ue=fe?pe.closeText:pe.openText;Ne&&(Fe+=pe.formatStatusAndPnl({status:Ue,pnl:Ne})+", "),Fe+=pe.formatQty({qty:String(We)})+`
`,Fe+=pe.formatRatio({riskRewardRatio:ze})+" "}let je=pe.linecolor;return le<0?je=pe.stopBackground:le>0&&(je=pe.profitBackground),this._addCenterLabel(this._middleLabelRenderer,{p:Oe,txt:Fe,color:je,vertAlign:VerticalAlign.Middle,offsetY:0,border:"white"})}_addCenterLabel(ee,ne){const re=this._source.properties(),se={fontFamily:ChartFontFamily,offsetX:3,horzAlign:"center",backgroundRoundRect:4,points:[ne.p],text:ne.txt,color:re.textcolor,offsetY:ne.offsetY,vertAlign:ne.vertAlign,backgroundColor:resetTransparency(ne.color),fontSize:re.fontsize,borderColor:ne.border};return ee.setData(se),this._renderer.append(ee),se}_createStopLabel(ee,ne){var We;const{stopPrice:re,entryPrice:se,left:ae,edge:le,stopLevel:ce}=ee,he=this._source.properties(),fe=Math.abs(re-se),Ae=Math.round(fe/se*1e4)/100,pe=new Point((ae+le)/2,ce),Oe=this._source.series.priceFormatter(),Fe="formatChange"in Oe&&lodashExports.isFunction(Oe.formatChange)?(We=Oe.formatChange)==null?void 0:We.call(Oe,Math.max(re,se),Math.min(re,se)):Oe.format(fe),ze=getPercentageFormatter().format(Ae);let He="";return he.compact?He=`${Fe} (${ze}) ${this._data.amountStop}`:He=he.formatTextStop({stopChange:forceLTRStr(Fe),stopChangePercent:forceLTRStr(ze),stopChangePip:ne?forceLTRStr(ne.format(fe)):"",amount:forceLTRStr(String(this._data.amountStop))}),this._addCenterLabel(this._stopLabelRenderer,{p:pe,txt:He,color:he.stopBackground,vertAlign:se<re?VerticalAlign.Bottom:VerticalAlign.Top,offsetY:0})}_createTargetLabel(ee,ne){var je;const{profitPrice:re,entryPrice:se,stopPrice:ae,left:le,edge:ce,profitLevel:he}=ee,fe=this._source.properties(),Ae=Math.abs(re-se),pe=Math.round(Ae/se*1e4)/100,Oe=new Point((le+ce)/2,he),Fe=this._source.series.priceFormatter(),Ne="formatChange"in Fe&&lodashExports.isFunction(Fe.formatChange)?(je=Fe.formatChange)==null?void 0:je.call(Fe,Math.max(re,se),Math.min(re,se)):Fe.format(Ae),ze=getPercentageFormatter(),He=ze.format(pe);let We="";return fe.compact?We=`${Ne} (${He}) ${this._data.amountTarget}`:We=fe.formatTextTarget({profitChange:Ne,profitChangePercent:forceLTRStr(ze.format(pe)),profitChangePip:ne?forceLTRStr(ne.format(Ae)):"",amount:forceLTRStr(""+this._data.amountTarget)}),this._addCenterLabel(this._profitLabelRenderer,{p:Oe,txt:We,color:fe.profitBackground,vertAlign:se<ae?VerticalAlign.Top:VerticalAlign.Bottom,offsetY:0})}}class PositionBasePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PositionPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_data",Object.defineProperties({riskSize:NaN,qty:NaN,amountStop:NaN,amountTarget:NaN,_stopPrice:NaN,stopPrice:NaN,_targetPrice:NaN,targetPrice:NaN},{stopPrice:{get:()=>this._data._stopPrice,set:ee=>(this._props.stopLevel=Math.round(Math.abs(ee-this.entryPrice())*this.ownerSourceBase()),this._data._stopPrice=ee,!0)},targetPrice:{get:()=>this._data._targetPrice,set:ee=>(this._props.profitLevel=Math.round(Math.abs(ee-this.entryPrice())*this.ownerSourceBase()),this._data._targetPrice=ee,!0)}}))}addPoint(ee,ne){ee.price=this._roundPrice(ee.price),super.addPoint(ee,ne);const re=this._getClosePointIndex(this.getIndex(ee)),se=this.series.dataByIndex(re),ae={price:ee.price,time:se.time};this.controlPoints[1]=ae;const le=this._calculateActualEntry(ee,ae);if(le){this.controlPoints[2]=le;const ce=this._findClosePoint(le,ae);ce&&(this.controlPoints[3]=ce)}return this._data._stopPrice=this.stopPrice(),this._data._targetPrice=this.profitPrice(),AddPointResponse.Accept}setPoint(ee,ne,re){switch(ee){case 0:this._changeEntryPoint(ne);break;case 2:this._data.stopPrice=this.prepareStopPrice(ne.price);break;case 3:this._data.targetPrice=this.prepareProfitPrice(ne.price);break;case 1:ne.price=this.controlPoints[0].price,super.setPoint(1,ne,re),this.recalculate();break}}move(){this.recalculate()}_getClosePointIndex(ee){const ne=this.timeScale(),re=Math.round(ne.width()/ne.barSpacing());return ee+Math.max(3,Math.round(.15*re))}lastBarData(){const ee=this.series.barsProvider(),ne=ee.firstIndex(),re=ee.lastIndex();if(ne===null||re===null||isNaN(ne)||isNaN(re))return null;const se=this.controlPoints;if(se.length===4){const fe=se[RiskRewardPointIndex.ActualClose],Ae=this.getIndex(fe);return Ae<ne?null:{closePrice:fe.price,index:Math.min(re,Ae)}}const ae=se[RiskRewardPointIndex.Close],le=this.getIndex(ae);if(le<ne)return null;const ce=Math.min(re,le),he=this.series.dataByIndex(ce,kt.NearestLeft);return he===null?null:{closePrice:ensure(he.customValues.close),index:ensure(this.timeScale().timeToIndexEx(he.time))}}isLogPriceScale(){return this.chart.options().rightPriceScale.mode===pi.Logarithmic}symbolInfo(){return this._ctx.chartService.symbolInfo()}ownerSourceBase(){const ee=this._ctx.chartService.symbolInfo();return ee?ee.pricescale/ee.minmov:100}_roundPrice(ee){const ne=this.ownerSourceBase();return Math.round(ee*ne)/ne}entryPrice(){return this.controlPoints[0].price}_riskFormatter(ee){return ee===RiskDisplayMode.Percentage?getNumericFormatter(2):getNumericFormatter()}recalculate(){const ee=this.controlPoints;if(ee.length===0)return;const ne=[ee[0],ee[1]],re=this._calculateActualEntry(ee[0],ee[1]);if(re){ne.push(re);const se=this._findClosePoint(re,ee[1]);se&&ne.push(se)}this.controlPoints.length=0,this.controlPoints.push(...ne),this._data._stopPrice=this.stopPrice(),this._data._targetPrice=this.profitPrice()}_recalculateRiskSize(){const ee=this.properties(),ne=ee.risk,re=ee.riskDisplayMode,se=ee.accountSize;re==="percents"?this._data.riskSize=ne/100*se:ne>se?(ee.risk=se,this._data.riskSize=se):this._data.riskSize=ne}_recalculateRisk(){const ee=this.properties(),ne=ee.riskDisplayMode,re=this._data.riskSize,se=ee.accountSize;let ae=ee.risk;ae=roundValue(ne==="percents"?re/se*100:se/100*ae),ee.risk=parseFloat(this._riskFormatter(ne).format(ae,{ignoreLocaleNumberFormat:!0}))}_recalculateAmount(){if(this.controlPoints.length===0)return;const ne=this.properties().accountSize,re=this.entryPrice(),se=this._data.qty,ae=this.stopPrice(),le=this.profitPrice(),ce=this._ownerSourcePointValue();this._data.amountTarget=this._amountTarget(ne,le,re,se,ce),this._data.amountStop=this._amountStop(ne,ae,re,se,ce)}_recalculateQty(){if(this.controlPoints.length===0)return;const ee=this.entryPrice(),ne=this.stopPrice(),re=this._data.riskSize,se=this._entryPointCurrencyRate(),ae=se===null?NaN:re/(Math.abs(ee-ne)*this._ownerSourcePointValue()*se);this._data.qty=ae}_entryPointCurrencyRate(){return 1}_closePointCurrencyRate(){return 1}_ownerSourcePointValue(){return 1}_changeEntryPoint(ee){const ne=this._data.stopPrice,re=this._data.targetPrice,se=1/this.ownerSourceBase(),ae=Math.min(ne,re)+se,le=Math.max(ne,re)-se;ee.price=Math.max(ae,Math.min(le,this._roundPrice(ee.price))),this.controlPoints[0]=ee,this.controlPoints[1]={...this.controlPoints[1],price:ee.price},this._data.stopPrice=ne,this._data.targetPrice=re,this.recalculate()}_calculateActualEntry(ee,ne){const re=this.series.barsProvider(),se=ensure(re.firstIndex()),ae=this.getIndex(ee),le=Math.max(ae,se),ce=ee.price,he=ensure(re.lastIndex()),fe=this.getIndex(ne),Ae=Math.min(he,fe-1);if(le>Ae)return null;for(let pe=le;pe<Ae+1;pe++){const Oe=this.series.dataByIndex(pe);if(Oe.customValues.high>=ce&&Oe.customValues.low<=ce)return{time:Oe.time,price:ce}}return null}_findClosePoint(ee,ne){const re=this.series.barsProvider(),se=ensure(re.firstIndex()),ae=Math.max(this.getIndex(ee),se),le=ensure(re.lastIndex()),ce=Math.min(le,this.getIndex(ne)-1);if(ae>ce)return null;for(let he=ae;he<ce+1;he++){const fe=this.series.dataByIndex(he),Ae=this._checkStopPrice(fe);if(Ae!=null)return{time:fe.time,price:Ae}}return null}updateAllViews(){if(!this.controlPoints.length)return;this._recalculateRiskSize(),this._recalculateRisk(),this._recalculateQty(),this._recalculateAmount();const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{ae>1||(this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y)))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._paneView[0].update({points:ee,...this._data})}}function roundValue(ie){return parseFloat(ie.toFixed(2))}class PositionLongPrimitive extends PositionBasePrimitive{stopPrice(){return this.entryPrice()-this.properties().stopLevel/this.ownerSourceBase()}profitPrice(){return this.entryPrice()+this.properties().profitLevel/this.ownerSourceBase()}calculatePL(te){return te-this.entryPrice()}prepareStopPrice(te){te=this._roundPrice(te);const ee=this.entryPrice()-1/this.ownerSourceBase();return Math.min(te,ee)}prepareProfitPrice(te){te=this._roundPrice(te);const ee=this.entryPrice()+1/this.ownerSourceBase();return Math.max(te,ee)}_checkStopPrice(te){const ee=this.stopPrice(),ne=this.profitPrice();return te.customValues.low<=ee?ee:te.customValues.high>=ne?ne:null}_amountTarget(te,ee,ne,re,se){const ae=this._closePointCurrencyRate();return ae===null?NaN:roundValue(te+(ee-ne)*re*se/ae)}_amountStop(te,ee,ne,re,se){const ae=this._closePointCurrencyRate();return ae===null?NaN:roundValue(te-(ne-ee)*re*se/ae)}}class LongPositionTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",LongPositionToolType);Ee(this,"steps",1)}createPrimitive(ee){const ne=calculateLevel(ee);return new PositionLongPrimitive({id:this.id,points:[],linecolor:"#808080",linewidth:1,textcolor:"#ffffff",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",fillBackground:!0,stopBackground:"#F23645",profitBackground:"#089981",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"#667b8b",compact:!1,riskDisplayMode:"percents",accountSize:1e3,lotSize:1,risk:25,alwaysShowStats:!1,showPriceLabels:!0,currency:"NONE",stopLevel:ne,profitLevel:ne,formatTextTarget:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.target",re)),formatTextStop:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.stop",re)),formatStatusAndPnl:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.pnl",re)),formatQty:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.qty",re)),formatRatio:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.ratio",re)),openText:this.chartService.invokeWithinContext(re=>re.get(II18nService).t("tool.position.open")),closeText:this.chartService.invokeWithinContext(re=>re.get(II18nService).t("tool.position.close"))},...this.resetArgs)}}const ProjectionLongPosition={type:LongPositionToolType,icon:icon$x,Ctor:LongPositionTool},icon$w=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M4.5 24a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM2 22.5a2.5 2.5 0 0 0 4.95.5H24v-1H6.95a2.5 2.5 0 0 0-4.95.5zM4.5 14a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM2 12.5a2.5 2.5 0 0 0 4.95.5h13.1a2.5 2.5 0 1 0 0-1H6.95a2.5 2.5 0 0 0-4.95.5zM22.5 14a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-18-6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM2 6.5a2.5 2.5 0 0 0 4.95.5H24V6H6.95A2.5 2.5 0 0 0 2 6.5z"></path><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M22.4 20.06l-1.39-.63-.41.91 1.39.63.41-.91zm-4-1.8l-1.39-.63-.41.91 1.39.63.41-.91zm-4-1.8l-1.4-.63-.4.91 1.39.63.41-.91zm-4-1.8L9 14.03l-.4.91 1.39.63.41-.91z"></path></svg>
`,ShortPositionToolType="tool.projection.shortPosition";class PositionShortPrimitive extends PositionBasePrimitive{stopPrice(){return this.entryPrice()+this.properties().stopLevel/this.ownerSourceBase()}profitPrice(){return this.entryPrice()-this.properties().profitLevel/this.ownerSourceBase()}calculatePL(te){return this.entryPrice()-te}prepareStopPrice(te){te=this._roundPrice(te);const ee=this.entryPrice()+1/this.ownerSourceBase();return Math.max(te,ee)}prepareProfitPrice(te){te=this._roundPrice(te);const ee=this.entryPrice()-1/this.ownerSourceBase();return Math.min(te,ee)}_checkStopPrice(te){const ee=this.stopPrice(),ne=this.profitPrice(),{high:re,low:se}=te.customValues;return re>=ee?ee:se<=ne?ne:null}_amountTarget(te,ee,ne,re,se){const ae=this._closePointCurrencyRate();return ae===null?NaN:roundValue(te+(ne-ee)*re*se/ae)}_amountStop(te,ee,ne,re,se){const ae=this._closePointCurrencyRate();return ae===null?NaN:roundValue(te-(ee-ne)*re*se/ae)}}class ShortPositionTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ShortPositionToolType);Ee(this,"steps",1)}createPrimitive(ee){const ne=calculateLevel(ee);return new PositionShortPrimitive({id:this.id,points:[],linecolor:"#808080",linewidth:1,textcolor:"#ffffff",fontsize:12,fillLabelBackground:!0,labelBackgroundColor:"#585858",fillBackground:!0,stopBackground:"#F23645",profitBackground:"#089981",stopBackgroundTransparency:80,profitBackgroundTransparency:80,drawBorder:!1,borderColor:"#667b8b",compact:!1,riskDisplayMode:"percents",accountSize:1e3,lotSize:1,risk:25,alwaysShowStats:!1,showPriceLabels:!0,currency:"NONE",stopLevel:ne,profitLevel:ne,formatTextTarget:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.target",re)),formatTextStop:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.stop",re)),formatStatusAndPnl:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.pnl",re)),formatQty:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.qty",re)),formatRatio:re=>this.chartService.invokeWithinContext(se=>se.get(II18nService).t("tool.position.ratio",re)),openText:this.chartService.invokeWithinContext(re=>re.get(II18nService).t("tool.position.open")),closeText:this.chartService.invokeWithinContext(re=>re.get(II18nService).t("tool.position.close"))},...this.resetArgs)}}const ProjectionShortPosition={type:ShortPositionToolType,icon:icon$w,Ctor:ShortPositionTool},icon$v=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M23.886 21.431c-.953-8.558-7.742-15.354-16.299-16.315l-.112.994c8.093.909 14.516 7.338 15.417 15.432l.994-.111z"></path><path d="M5 7.5v14h1v-14zM21.5 23h-14v1h14z"></path><path d="M5.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,ProjectionToolType="tool.projection.projection";class ProjectionPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_arcWedgeRenderer",new ArcWedgeRenderer);Ee(this,"_baseTrendRenderer",new LineRenderer);Ee(this,"_edgeTrendRenderer",new LineRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){FibWedgePaneView.prototype._updateImpl.call(this)}_getPoints(){const ee=this.points();if(ee.length<3)return ee;const[ne,re,se]=ee,ae=se.pointIndex,le=re.subtract(ne).length(),ce=se.subtract(ne).normalized().scaled(le),he=new AnchorPoint(ne.add(ce),{pointIndex:ae});return[ne,re,he]}_updateRenderer(ee=NaN,ne=NaN,re=[]){const se=this.points();if(se.length<2)return;const ae=this._source.properties(),[le,ce,he]=this._getPoints(),fe=ae.trendline.color,Ae=ae.lineWidth,pe=ae.trendline.linestyle;if(this._baseTrendRenderer.setData({points:[le,ce],lineColor:fe,lineWidth:Ae,lineStyle:pe,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(this._baseTrendRenderer),se.length<3){this.addAnchors(this._renderer);return}this._edgeTrendRenderer.setData({points:[le,he],lineColor:fe,lineWidth:Ae,lineStyle:pe,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal}),this._renderer.append(this._edgeTrendRenderer);const Oe=re[0];this._arcWedgeRenderer.setData({center:le,radius:Oe.radius,prevRadius:0,color:fe,color1:ae.color0,color2:ae.color1,linewidth:Ae,angle1:ee,angle2:ne,p1:Oe.p1,p2:Oe.p2,fillBackground:ae.fillBackground,transparency:ae.transparency,gradient:!0}),this._renderer.append(this._arcWedgeRenderer),this.addAnchors(this._renderer)}}class ProjectionPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ProjectionPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){FibWedgePrimitive.prototype.setPoint.call(this,ee,ne,re)}addPoint(ee,ne){return FibWedgePrimitive.prototype.addPoint.call(this,ee,ne)}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((se,ae)=>new AnchorPoint(this.pointToScreenPoint(se),{pointIndex:ae})),ne=ee.map(se=>se.x),re=ee.map(se=>se.y);this.controlPoints.forEach((se,ae)=>{this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,ee[ae].x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,ee[ae].y))}),ne.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}}class ProjectionTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ProjectionToolType);Ee(this,"steps",3)}createPrimitive(){return new ProjectionPrimitive({id:this.id,points:[],showCoeffs:!0,fillBackground:!0,transparency:80,color0:"#2962FF",color1:"#9C27B0",lineWidth:2,trendline:{visible:!0,color:"#9C9C9C",linestyle:LineStyleType.solid},levelsStyle:{linewidth:2,linestyle:LineStyleType.solid},levels:[{coeff:1,color:"#808080"}]},...this.resetArgs)}}const ProjectionProjection={type:ProjectionToolType,icon:icon$v,Ctor:ProjectionTool},icon$u=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M8.013 23.846c4.923 2.247 9.792 2.626 13.448-.517l-.652-.758c-3.277 2.817-7.775 2.467-12.381.365l-.415.91z"></path><path d="M24.035 20.056c2.262-4.176 1.814-8.73-.13-12.98l-.909.416c1.826 3.993 2.244 8.24.16 12.088l.879.476z"></path><path d="M8.221 21.401l13.249-14.077-.728-.685-13.249 14.077z"></path><path d="M6.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,ArcToolType="tool.shape.arc";function rotationMatrix(ie){const te=Math.cos(ie),ee=Math.sin(ie);return[[te,-ee,0],[ee,te,0],[0,0,1]]}function scalingMatrix(ie,te){return[[ie,0,0],[0,te,0],[0,0,1]]}function translationMatrix(ie,te){return[[1,0,ie],[0,1,te],[0,0,1]]}function transformPoint(ie,te){const ee=[te.x,te.y,1],ne=[0,0,0];for(let re=0;re<3;re++)for(let se=0;se<3;se++)ne[re]+=ie[re][se]*ee[se];return new Point(ne[0],ne[1])}function thirdPointCursorType(ie,te){const ee=te.x-ie.x,ne=te.y-ie.y,re=Math.abs(Math.atan2(ee,ne));return re>Math.PI/4&&re<3*Math.PI/4?PaneCursor.ns:PaneCursor.ew}class ArcRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){const ee=this._data;if(!ee||ee.points.length<2)return;const ne=te.context,re=ee.points[0],se=ee.points[1];if(ee.points.length<3){ne.strokeStyle=ee.lineColor,ne.lineWidth=ee.lineWidth,ne.beginPath(),ne.moveTo(re.x,re.y),ne.lineTo(se.x,se.y),ne.stroke();return}let ae=ee.points[2];const{distance:le}=distanceToLine(re,se,ae);if(le<1){ne.strokeStyle=ee.lineColor,ne.lineWidth=ee.lineWidth,ne.beginPath(),ne.moveTo(re.x,re.y),ne.lineTo(se.x,se.y),ne.stroke();return}const ce=se.subtract(re),he=re.add(se).scaled(.5),fe=new Point(-ce.y,ce.x).normalized();ae=he.add(fe.scaled(le)),ne.strokeStyle=ee.lineColor,ne.lineWidth=ee.lineWidth;const Ae=ce.length(),pe=ce.x/Ae,Oe=ce.y/Ae;let Fe=Math.acos(pe);Oe<0&&(Fe=-Fe);let Ne=ee.points[2],ze=translationMatrix(-he.x,-he.y);Ne=transformPoint(ze,Ne),ze=rotationMatrix(-Fe),Ne=transformPoint(ze,Ne),ze=scalingMatrix(1,Ae/(2*le)),Ne=transformPoint(ze,Ne);const He=Ne.y<0;ne.save(),ne.beginPath(),ne.translate(re.x,re.y),ne.rotate(Fe);const We=Ae,je=1-Math.sqrt(3)/2,Ue=le/(Ae*je);if(ne.scale(1,Ue),He){const Ge=-2*Math.PI/3,Ze=-Math.PI/3;ne.arc(.5*Ae,Ae*Math.sqrt(3)/2,We,Ge,Ze,!1)}else{const Ge=Math.PI/3,Ze=2*Math.PI/3;ne.arc(.5*Ae,-Ae*Math.sqrt(3)/2,We,Ge,Ze,!1)}ne.restore(),ne.stroke(),ne.fillStyle=ee.background,ne.fill()}hitTest(te){if(!this._data||this._data.points.length<3)return null;const ee=interactionTolerance().curve,ne=this._data.points[0],re=this._data.points[1];let se=this._data.points[2];const ae=distanceToLine(ne,re,se).distance;if(ae<1)return distanceToLine(ne,re,te).distance<ee?new HitTestResult(HitTarget.MovePoint):null;const le=re.subtract(ne),ce=le.length(),he=ne.add(re).scaled(.5);let fe=se.subtract(he).normalized();se=he.add(fe.scaled(ae));const Ae=le.x/ce,pe=le.y/ce;let Oe=Math.acos(Ae);pe<0&&(Oe=-Oe);let Fe=translationMatrix(-ne.x,-ne.y);te=transformPoint(Fe,te),fe=transformPoint(Fe,fe),Fe=rotationMatrix(-Oe),te=transformPoint(Fe,te),fe=transformPoint(Fe,fe);const Ne=ce*(1-Math.sqrt(3)/2)/ae;if(Fe=scalingMatrix(1,Ne),te=transformPoint(Fe,te),fe=transformPoint(Fe,fe),te.y*fe.y<0)return null;let ze;te.y<0?ze=new Point(.5*ce,ce*Math.sqrt(3)/2):ze=new Point(.5*ce,-ce*Math.sqrt(3)/2);const He=te.subtract(ze).length();return Math.abs(He-ce)<=ee?new HitTestResult(HitTarget.MovePoint):null}}class ArcPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_arcRenderer",new ArcRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();if(this._arcRenderer.setData({points:this.points(),lineColor:ee.lineColor,lineWidth:ee.lineWidth,background:ee.backgroundColor}),this._renderer.append(this._arcRenderer),this.points().length<=2){this.addAnchors(this._renderer);return}const[ne,re,se]=this.points(),ae=[ne,re],{distance:le}=distanceToLine(ne,re,se),ce=re.subtract(ne),he=ne.add(re).scaled(.5),fe=new Point(-ce.y,ce.x).normalized(),Ae=he.add(fe.scaled(le)),pe=he.add(fe.scaled(-le)),Oe=ce.length(),Fe=ce.x/Oe,Ne=ce.y/Oe;let ze=Math.acos(Fe);Ne<0&&(ze=-ze);let He=se,We=translationMatrix(-he.x,-he.y);He=transformPoint(We,He),We=rotationMatrix(-ze),He=transformPoint(We,He),We=scalingMatrix(1,Oe/(2*le)),He=transformPoint(We,He);const je=He.y>=0?Ae:pe,Ue=new AnchorPoint(je,{pointIndex:2,cursorType:thirdPointCursorType(ne,re)});ae.push(Ue);const Ge=this.createLineAnchor({points:ae});this._renderer.append(Ge)}}class ArcPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ArcPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_dist",null)}startChanging(){const[ee,ne,re]=this.controlPoints,se=this.pointToScreenPoint(ee),ae=this.pointToScreenPoint(ne),le=this.pointToScreenPoint(re),ce=distanceToLine(se,ae,le).distance,he=ae.subtract(se),fe=new Point(-he.y,he.x),Ae=se.add(ae).scaled(.5),pe=le.subtract(Ae).dotProduct(fe)<0;this._dist=pe?-ce:ce}onDragEnd(){super.onDragEnd(),this._dist=null}setPoint(ee,ne,re){const se=this.pointToScreenPoint(this.controlPoints[0]),ae=this.pointToScreenPoint(this.controlPoints[1]),le=ensure(this._dist);switch(ee){case 0:{const ce={time:ensure(re.startPoint).time+re.deltaTime,price:ensure(re.startPoint).price+re.deltaPrice},he=this.pointToScreenPoint(ce),fe=ae.subtract(he),Ae=he.add(ae).scaled(.5),pe=new Point(-fe.y,fe.x).normalized(),Oe=Ae.add(pe.scaled(le));this.controlPoints[0]=ce,this.controlPoints[2]=this.screenPointToPoint(Oe);break}case 1:{const ce={time:ensure(re.startPoint).time+re.deltaTime,price:ensure(re.startPoint).price+re.deltaPrice},he=this.pointToScreenPoint(ce),fe=he.subtract(se),Ae=se.add(he).scaled(.5),pe=new Point(-fe.y,fe.x).normalized(),Oe=Ae.add(pe.scaled(le));this.controlPoints[1]=ce,this.controlPoints[2]=this.screenPointToPoint(Oe);break}case 2:{let ce=new Point(re.screenPoint);const he=ae.subtract(se),fe=se.add(ae).scaled(.5),{distance:Ae}=distanceToLine(se,ae,ce),pe=new Point(-he.y,he.x).normalized(),Oe=fe.add(pe.scaled(Ae)),Fe=fe.add(pe.scaled(-Ae)),Ne=he.length(),ze=he.x/Ne,He=he.y/Ne;let We=Math.acos(ze);He<0&&(We=-We);let je=translationMatrix(-fe.x,-fe.y);ce=transformPoint(je,ce);let Ue=transformPoint(je,Oe);je=rotationMatrix(-We),ce=transformPoint(je,ce),Ue=transformPoint(je,Ue),je=scalingMatrix(1,Ne/(2*Ae)),ce=transformPoint(je,ce),Ue=transformPoint(je,Ue);const Ge=ce.y*Ue.y>=0?Oe:Fe;this.controlPoints[2]=this.screenPointToPoint(Ge);break}}}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce),this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,le.x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,le.y))}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re})}}class ArcTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",ArcToolType);Ee(this,"steps",3)}createPrimitive(){return new ArcPrimitive({id:this.id,points:[],lineColor:"#E91E63FF",lineWidth:2,backgroundColor:"#E91E6333"},...this.resetArgs)}}const ShapeArc={type:ArcToolType,icon:icon$u,Ctor:ArcTool},icon$t=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path stroke="currentColor" d="M16 14a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"></path><path fill="currentColor" fill-rule="evenodd" d="M4.5 14a9.5 9.5 0 0 1 18.7-2.37 2.5 2.5 0 0 0 0 4.74A9.5 9.5 0 0 1 4.5 14Zm19.7 2.5a10.5 10.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5ZM22.5 14a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg>
`,CircleToolType="tool.shape.circle";class CircleRenderer extends BitmapCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const{center:ee,radius:ne,lineWidth:re,color:se,background:ae}=this._data,le=te.context;le.save();const{horizontalPixelRatio:ce,verticalPixelRatio:he}=te,fe=Math.max(1,Math.floor(ce)),Ae=fe%2/2,pe=Math.round(ee.x*ce)+Ae,Oe=Math.round(ee.y*he)+Ae,Fe=Math.round(pe+ne*ce),Ne=Math.max(1,Math.floor(re*ce)),ze=Fe-pe-Ne;ze>0&&(le.fillStyle=ae,le.beginPath(),le.moveTo(pe+ze,Oe),le.arc(pe,Oe,ze,0,2*Math.PI,!1),le.fill());const He=Math.max(fe/2,Fe-pe-Ne/2);le.strokeStyle=se,le.lineWidth=Ne,le.beginPath(),le.moveTo(pe+He,Oe),le.arc(pe,Oe,He,0,2*Math.PI,!1),le.stroke()}hitTest(te){if(!this._data)return null;const{center:ee,radius:ne}=this._data,re=interactionTolerance().curve;return pointInCircle(te,ee,ne+re)?ne>re&&pointInCircle(te,ee,ne-re)?null:new HitTestResult(HitTarget.MovePoint):null}}class CirclePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_circleRenderer",new CircleRenderer)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties(),[ne,re]=this.points(),se=Math.hypot(ne.x-re.x,ne.y-re.y);this._circleRenderer.setData({center:ne,radius:se,color:ee.lineColor,lineWidth:ee.lineWidth,background:ee.backgroundColor}),this._renderer.append(this._circleRenderer),this._renderer.append(this.createLineAnchor({points:[ne,re]}))}}class CirclePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new CirclePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],[re,se]=this.controlPoints,ae=[];this.controlPoints.forEach((le,ce)=>{const he=this.pointToScreenPoint(le);ee.push(he.x),ne.push(he.y);const fe=new AnchorPoint(he,{pointIndex:ce,hitTarget:ce===0?HitTarget.MovePoint:HitTarget.ChangePoint});ae.push(fe)}),this._timeAxisViews[0].update(this._calculateTimeAxisViewData(re.time,ae[0].x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(re.price,ae[0].y)),se&&(this._timeAxisViews[1].update(this._calculateTimeAxisViewData(se.time,ae[1].x)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(se.price,ae[1].y))),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:ae})}}class CircleTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",CircleToolType);Ee(this,"steps",2)}createPrimitive(){return new CirclePrimitive({id:this.id,points:[],lineColor:"#FF9800FF",lineWidth:2,backgroundColor:"#FF980033"},...this.resetArgs)}}const ShapeCircle={type:CircleToolType,icon:icon$t,Ctor:CircleTool},icon$s=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M6.256 20.652c.548-3.024 1.607-5.962 3.329-8.312l-.807-.591c-1.825 2.493-2.933 5.565-3.506 8.725l.984.178z"></path><path d="M12.243 9.657c2.365-1.764 5.345-2.846 8.416-3.402l-.178-.984c-3.21.581-6.326 1.712-8.836 3.584l.598.802z"></path><path d="M10.5 12c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,CurveToolType="tool.shape.curve";function quadroBezierHitTest(ie,te,ee,ne,re){const se=ee.subtract(ie).length()+ee.subtract(te).length(),ae=Math.max(3/se,.02);let le;for(let ce=0;;ce+=ae){ce>1&&(ce=1);const he=ie.scaled((1-ce)*(1-ce)),fe=ee.scaled(2*ce*(1-ce)),Ae=te.scaled(ce*ce),pe=he.add(fe).add(Ae);if(le!==void 0){const{distance:Oe}=distanceToSegment(pe,le,ne);if(Oe<re)return!0}else if(pe.subtract(ne).length()<re)return!0;if(le=pe,ce===1)break}return!1}function cubicBezierHitTest(ie,te,ee,ne,re,se){const ae=te.subtract(ie).length()+ee.subtract(te).length()+ne.subtract(ee).length(),le=Math.max(3/ae,.02);let ce;for(let he=0;;he+=le){he>1&&(he=1);const fe=evaluateCubicBezierPoint(ie,te,ee,ne,he);if(ce!==void 0){const{distance:Ae}=distanceToSegment(fe,ce,re);if(Ae<se)return!0}else if(fe.subtract(re).length()<se)return!0;if(ce=fe,he>=1)break}return!1}function evaluateCubicBezierPoint(ie,te,ee,ne,re){re=clamp$1(re,0,1);const se=1-re,ae=ie.scaled(se*se*se),le=te.scaled(3*se*se*re),ce=ee.scaled(3*se*re*re),he=ne.scaled(re*re*re);return ae.add(le).add(ce).add(he)}function buildExtendedSegments(ie,te){for(let ee=0;ee<te.length;ee++){const ne=te[ee],re=ne[0];ie.moveTo(re.x,re.y);for(let se=1;se<ne.length;se++){const ae=ne[se];ie.lineTo(ae.x,ae.y)}}}function hitTestExtendedPoints(ie,te,ee){for(const ne of ee)for(let re=1;re<ne.length;re++){const se=ne[re-1],ae=ne[re],{distance:le}=distanceToSegment(se,ae,ie);if(le<te)return new HitTestResult(HitTarget.MovePoint)}return null}class BezierQuadroRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const[ee,ne,re]=this._data.points,se=te.context;if(se.lineCap="round",se.strokeStyle=this._data.lineColor,se.lineWidth=this._data.lineWidth,setLineStyle(se,this._data.lineStyle),this._data.points.length===2){se.beginPath(),se.moveTo(ee.x,ee.y),se.lineTo(ne.x,ne.y),se.stroke();return}const ae=ne.subtract(ee),le=re.subtract(ae.scaled(.25)),ce=re.add(ae.scaled(.25));this._data.fillBack&&this._data.points.length>2&&(se.fillStyle=this._data.backColor,se.beginPath(),se.moveTo(ee.x,ee.y),se.quadraticCurveTo(le.x,le.y,re.x,re.y),se.quadraticCurveTo(ce.x,ce.y,ne.x,ne.y),se.fill()),se.beginPath(),buildExtendedSegments(se,this._data.extendLeftSegments),se.moveTo(ee.x,ee.y),se.quadraticCurveTo(le.x,le.y,re.x,re.y),se.quadraticCurveTo(ce.x,ce.y,ne.x,ne.y),buildExtendedSegments(se,this._data.extendRightSegments),this._data.leftEnd===LineEnd.Arrow&&drawArrow(le,ee,se,se.lineWidth,dpr1PixelRatioInfo),this._data.rightEnd===LineEnd.Arrow&&drawArrow(ce,ne,se,se.lineWidth,dpr1PixelRatioInfo),se.stroke()}hitTest(te){if(this._data&&this._data.points.length===3){const ee=interactionTolerance().curve,[ne,re,se]=this._data.points,ae=re.subtract(ne),le=se.subtract(ae.scaled(.25)),ce=se.add(ae.scaled(.25));if(quadroBezierHitTest(se,ne,le,te,ee))return new HitTestResult(HitTarget.MovePoint);if(quadroBezierHitTest(se,re,ce,te,ee))return new HitTestResult(HitTarget.MovePoint);let he=hitTestExtendedPoints(te,ee,this._data.extendLeftSegments);return he===null&&(he=hitTestExtendedPoints(te,ee,this._data.extendRightSegments)),he}return null}}class CurvePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_bezierQuadroRenderer",new BezierQuadroRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties(),ne=[],re=[];this.points().length===3&&(ee.extendLeft&&NOTIMPLEMENTED(),ee.extendRight&&NOTIMPLEMENTED());const le={points:[...this.points()],lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,leftEnd:ee.leftEnd,rightEnd:ee.rightEnd,fillBack:ee.fillBack,backColor:ee.backColor,extendLeftSegments:ne,extendRightSegments:re};this._bezierQuadroRenderer.setData(le),this._renderer.append(this._bezierQuadroRenderer),this.addAnchors(this._renderer)}}class CurvePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new CurvePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateMove(ee,ne){super.updateMove(ee,ne),ne===1&&this._updateControlPoint()}addPoint(ee,ne){const re=super.addPoint(ee,ne);return isPointAccepted(re)&&ne===1&&this._updateControlPoint(),re}_updateControlPoint(){this.controlPoints[2]=this._calculateControlPoint()}_calculateControlPoint(){const ee=this.pointToScreenPoint(this.controlPoints[0]),ne=this.pointToScreenPoint(this.controlPoints[1]),se=ne.subtract(ee).scaled(.5).transposed().scaled(.3),le=ee.add(ne).scaled(.5).add(se);return this.screenPointToPoint(le)}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce),ae<=1&&(this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,le.x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,le.y)))}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re})}}class CurveTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",CurveToolType);Ee(this,"steps",2)}createPrimitive(){return new CurvePrimitive({id:this.id,points:[],lineColor:"#2962FFFF",lineWidth:2,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal,extendLeft:!1,extendRight:!1,fillBack:!1,backColor:"#2962FF33"},...this.resetArgs)}}const ShapeCurve={type:CurveToolType,icon:icon$s,Ctor:CurveTool},icon$r=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M17.605 19.584c.295-2.304-.584-3.586-3.274-5.959-2.462-2.172-3.191-3.241-2.94-5.111l-.991-.133c-.312 2.322.567 3.61 3.269 5.994 2.452 2.163 3.181 3.227 2.943 5.083l.992.127z"></path><path d="M6.053 24.868c3.772 1.644 7.307 1.643 9.712-1.249l-.769-.64c-2.045 2.458-5.133 2.459-8.544.972l-.4.917z"></path><path d="M12.949 5.087c2.044-2.525 5.157-2.54 8.602-1.036l.4-.917c-3.81-1.663-7.376-1.646-9.779 1.324l.777.629z"></path><path d="M4.5 25c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM16.5 23c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM11.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM23.5 6c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,DoubleCurveToolType="tool.shape.doubleCurve";class BezierCubicRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const ee=te.context;ee.lineCap="round",ee.strokeStyle=this._data.lineColor,ee.lineWidth=this._data.lineWidth,setLineStyle(ee,this._data.lineStyle);const ne=this._data.points[0],re=this._data.points[1];if(this._data.points.length===2)ee.beginPath(),ee.moveTo(ne.x,ne.y),ee.lineTo(re.x,re.y),ee.stroke(),this._data.leftEnd===LineEnd.Arrow&&drawArrow(re,ne,ee,ee.lineWidth,dpr1PixelRatioInfo),this._data.rightEnd===LineEnd.Arrow&&drawArrow(ne,re,ee,ee.lineWidth,dpr1PixelRatioInfo);else{const se=this._data.points[2],ae=this._data.points[3],le=ae.subtract(ne),ce=se.subtract(le.scaled(.25)),he=se.add(le.scaled(.25)),fe=ae.subtract(se),Ae=ae.subtract(fe.scaled(.25)),pe=ae.add(fe.scaled(.25));this._data.fillBack&&this._data.points.length>2&&(ee.fillStyle=this._data.backColor,ee.beginPath(),ee.moveTo(ne.x,ne.y),ee.quadraticCurveTo(ce.x,ce.y,se.x,se.y),ee.bezierCurveTo(he.x,he.y,Ae.x,Ae.y,ae.x,ae.y),ee.quadraticCurveTo(pe.x,pe.y,re.x,re.y),ee.fill()),ee.beginPath(),buildExtendedSegments(ee,this._data.extendLeftPoints),ee.moveTo(ne.x,ne.y),ee.quadraticCurveTo(ce.x,ce.y,se.x,se.y),ee.bezierCurveTo(he.x,he.y,Ae.x,Ae.y,ae.x,ae.y),ee.quadraticCurveTo(pe.x,pe.y,re.x,re.y),buildExtendedSegments(ee,this._data.extendRightPoints),this._data.leftEnd===LineEnd.Arrow&&drawArrow(ce,ne,ee,ee.lineWidth,dpr1PixelRatioInfo),this._data.rightEnd===LineEnd.Arrow&&drawArrow(pe,re,ee,ee.lineWidth,dpr1PixelRatioInfo),ee.stroke()}}hitTest(te){const ee=this._data;if(!ee||ee.points.length!==4)return null;const ne=interactionTolerance().curve,[re,se,ae,le]=ee.points,ce=le.subtract(re),he=ae.subtract(ce.scaled(.25)),fe=ae.add(ce.scaled(.25)),Ae=se.subtract(ae),pe=le.subtract(Ae.scaled(.25)),Oe=le.add(Ae.scaled(.25)),Fe=quadroBezierHitTest(ae,re,he,te,ne),Ne=cubicBezierHitTest(ae,fe,pe,le,te,ne),ze=quadroBezierHitTest(le,se,Oe,te,ne);if(Fe||Ne||ze)return new HitTestResult(HitTarget.MovePoint);let He=hitTestExtendedPoints(te,ne,ee.extendLeftPoints);return He===null&&(He=hitTestExtendedPoints(te,ne,ee.extendRightPoints)),He}}class DoubleCurvePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_bezierCubicRenderer",new BezierCubicRenderer)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties(),ne=[],re=[],ae={points:this.points(),lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,leftEnd:ee.leftEnd,rightEnd:ee.rightEnd,fillBack:ee.fillBack,backColor:ee.backColor,extendLeftPoints:ne,extendRightPoints:re};this._bezierCubicRenderer.setData(ae),this._renderer.append(this._bezierCubicRenderer),this.addAnchors(this._renderer)}}class DoubleCurvePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new DoubleCurvePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateMove(ee,ne){super.updateMove(ee,ne),ne===1&&this._updateControlPoints()}addPoint(ee,ne){const re=super.addPoint(ee,ne);return ne===1&&this._updateControlPoints(),re}_updateControlPoints(){const ee=this._calculateControlPoints();this.controlPoints[2]=ee[0],this.controlPoints[3]=ee[1]}_calculateControlPoints(){const ee=this.pointToScreenPoint(this.controlPoints[0]),ne=this.pointToScreenPoint(this.controlPoints[1]),se=ne.subtract(ee).scaled(.5).transposed().scaled(.3),ae=ee.add(ne).scaled(1/3),le=ee.add(ne).scaled(2/3),ce=ae.add(se),he=le.subtract(se),fe=this.screenPointToPoint(ce),Ae=this.screenPointToPoint(he);return[fe,Ae]}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce),ae<2&&(this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,le.x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,le.y)))}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re})}}class DoubleCurveTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",DoubleCurveToolType);Ee(this,"steps",2)}createPrimitive(){return new DoubleCurvePrimitive({id:this.id,points:[],lineColor:"#2962FFFF",lineWidth:2,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal,extendLeft:!1,extendRight:!1,fillBack:!1,backColor:"#2962FF33"},...this.resetArgs)}}const ShapeDoubleCurve={type:DoubleCurveToolType,icon:icon$r,Ctor:DoubleCurveTool},icon$q=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M12.435 6.136c-4.411.589-7.983 3.039-9.085 6.27l.946.323c.967-2.836 4.209-5.059 8.271-5.602l-.132-.991zM3.347 16.584c1.101 3.243 4.689 5.701 9.117 6.283l.13-.991c-4.079-.537-7.335-2.767-8.301-5.613l-.947.321zM16.554 22.865c4.381-.582 7.94-3 9.071-6.2l-.943-.333c-.994 2.811-4.224 5.006-8.26 5.542l.132.991zM25.646 12.394c-1.107-3.225-4.675-5.668-9.078-6.257l-.133.991c4.056.542 7.293 2.76 8.265 5.591l.946-.325z"></path><path d="M14.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM14.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM25.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,EllipseToolType="tool.shape.ellipse",TwoPI=2*Math.PI;class EllipseRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(!this._data||this._data.points.length<2)return;const ee=te.context,[ne,re]=this._data.points;if(this._data.points.length<3){ee.strokeStyle=this._data.color,ee.lineWidth=this._data.lineWidth,ee.beginPath(),ee.moveTo(ne.x,ne.y),ee.lineTo(re.x,re.y),ee.stroke();return}const se=this._data.points[2],ae=distanceToLine(ne,re,se).distance;if(ae<1){ee.strokeStyle=this._data.color,ee.lineWidth=this._data.lineWidth,ee.beginPath(),ee.moveTo(ne.x,ne.y),ee.lineTo(re.x,re.y),ee.stroke();return}const le=re.subtract(ne),ce=ne.add(re).scaled(.5);ee.strokeStyle=this._data.color,ee.lineWidth=this._data.lineWidth;const he=le.length(),fe=le.x/he,Ae=le.y/he;let pe=Math.acos(fe);Ae<0&&(pe=-pe);let Oe=this._data.points[2],Fe=translationMatrix(-ce.x,-ce.y);Oe=transformPoint(Fe,Oe),Fe=rotationMatrix(-pe),Oe=transformPoint(Fe,Oe),Fe=scalingMatrix(1,he/(2*ae)),Oe=transformPoint(Fe,Oe);const Ne=Oe.y<0;ee.save(),ee.beginPath(),ee.translate(ce.x,ce.y),ee.rotate(pe),ee.scale(1,2*ae/he),ee.arc(0,0,.5*he,0,TwoPI,Ne),ee.restore(),ee.stroke(),ee.fillStyle=this._data.background,ee.fill()}hitTest(te){if(!this._data||this._data.points.length<3)return null;const[ee,ne,re]=this._data.points,se=ne.subtract(ee),ae=ee.add(ne).scaled(.5),le=distanceToLine(ee,ne,re).distance,ce=se.length(),he=se.x/ce,fe=se.y/ce;let Ae=Math.acos(he);fe<0&&(Ae=-Ae);let pe=translationMatrix(-ae.x,-ae.y),Oe=transformPoint(pe,te);pe=rotationMatrix(-Ae),Oe=transformPoint(pe,Oe),pe=scalingMatrix(1,ce/(2*le)),Oe=transformPoint(pe,Oe);const Fe=.5*ce,Ne=interactionTolerance().curve,ze=Oe.length();return Math.abs(ze-Fe)<=Ne?new HitTestResult(HitTarget.MovePoint):null}}class EllipsePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_ellipseRenderer",new EllipseRenderer)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties();if(this._ellipseRenderer.setData({points:this.points(),color:ee.lineColor,lineWidth:ee.lineWidth,background:ee.backgroundColor}),this._renderer.append(this._ellipseRenderer),this.points().length===2){this.addAnchors(this._renderer);return}const[ne,re,se]=this.points(),ae=distanceToLine(ne,re,se).distance,le=re.subtract(ne),ce=ne.add(re).scaled(.5),he=new Point(-le.y,le.x).normalized(),fe=ce.add(he.scaled(ae)),Ae=ce.add(he.scaled(-ae)),pe=thirdPointCursorType(ne,re),Oe=[ne,re,new AnchorPoint(fe,{pointIndex:2,cursorType:pe}),new AnchorPoint(Ae,{pointIndex:3,cursorType:pe})];this._renderer.append(this.createLineAnchor({points:Oe}))}}class EllipsePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new EllipsePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_fakePointAdded",!1);Ee(this,"_dist",null)}startChanging(){const ee=this.pointToScreenPoint(this.controlPoints[0]),ne=this.pointToScreenPoint(this.controlPoints[1]),re=this.pointToScreenPoint(this.controlPoints[2]);this._dist=distanceToLine(ee,ne,re).distance}onDragEnd(){super.onDragEnd(),this._dist=null}setPoint(ee,ne,re){switch(ee){case 0:{const se={time:ensure(re.startPoint).time+re.deltaTime,price:ensure(re.startPoint).price+re.deltaPrice};if(re.shiftkey)this._snapPoint45Degree(se,this.controlPoints[1]),this.controlPoints[0]=se,this.controlPoints[2]=this._preparePointInternal(this.controlPoints[2],re,!0),this.controlPoints[0].time===this.controlPoints[1].time&&this._fixVerticalDiameterPoints(this.controlPoints[0],this.controlPoints[1],this.controlPoints[2]);else{const ae=this.pointToScreenPoint(se),le=this.pointToScreenPoint(this.controlPoints[1]),ce=le.subtract(ae),he=ae.add(le).scaled(.5),Ae=new Point(-ce.y,ce.x).normalized().scaled(ensure(this._dist)),pe=he.add(Ae);this.controlPoints[0]=se,this.controlPoints[2]=this.screenPointToPoint(pe)}break}case 1:{const se={time:ensure(re.startPoint).time+re.deltaTime,price:ensure(re.startPoint).price+re.deltaPrice};if(re.shiftkey)this._snapPoint45Degree(se,this.controlPoints[0]),this.controlPoints[1]=se,this.controlPoints[2]=this._preparePointInternal(this.controlPoints[2],re,!0),this.controlPoints[0].time===this.controlPoints[1].time&&this._fixVerticalDiameterPoints(this.controlPoints[1],this.controlPoints[0],this.controlPoints[2]);else{const ae=this.pointToScreenPoint(this.controlPoints[0]),le=this.pointToScreenPoint(se),ce=le.subtract(ae),he=ae.add(le).scaled(.5),Ae=new Point(-ce.y,ce.x).normalized().scaled(ensure(this._dist)),pe=he.add(Ae);this.controlPoints[1]=se,this.controlPoints[2]=this.screenPointToPoint(pe)}break}case 2:case 3:{const se=new Point(re.screenPoint),ae=this.pointToScreenPoint(this.controlPoints[0]),le=this.pointToScreenPoint(this.controlPoints[1]),ce=le.subtract(ae),he=ae.add(le).scaled(.5),fe=new Point(-ce.y,ce.x).normalized(),Ae=distanceToLine(ae,le,se).distance,pe=he.add(fe.scaled(Ae));this.controlPoints[2]=this.screenPointToPoint(pe);break}}}_fixVerticalDiameterPoints(ee,ne,re){const se=this.pointToScreenPoint(ee),ae=this.pointToScreenPoint(ne),le=this.chart.timeScale(),ce=ensure(le.timeToCoordinateEx(ee.time)),he=ensure(le.timeToCoordinateEx(re.time));let fe=2*Math.abs(ce-he);fe*=ne.price>ee.price?1:-1;const Ae=this.screenPointToPoint(new Point(se.x,ae.y+fe));ee.price=Ae.price}_snapPoint45Degree(ee,ne){const re=this.chart.timeScale(),se=this.pointToScreenPoint(ee),ae=this.pointToScreenPoint(ne),le=se.x-ae.x,ce=se.y-ae.y,he=le<0?-1:1,fe=ce<0?-1:1,Ae=Math.max(Math.abs(le),Math.abs(ce)),pe=ensure(re.coordinateToTimeEx(ae.x+Ae*he)),Oe=ensure(re.timeToCoordinateEx(pe)),Fe=Math.abs(Oe-ae.x),Ne=ensure(this.series.coordinateToPrice(ae.y+Fe*fe));ee.time=pe,ee.price=Ne}_preparePointInternal(ee,ne,re=!1){let se={...ee};if(ne!=null&&ne.shiftkey){const ae=this.controlPoints.length,le=this._fakePointAdded||ae===2||re;if(!this._fakePointAdded&&ae===3&&!re)return se;if(le){this._snapPoint45Degree(ee,this.controlPoints[0]),this._fakePointAdded?this.controlPoints[1]=ee:re||(this._fakePointAdded=!0,this.controlPoints.push(ee));const ce=this.pointToScreenPoint(this.controlPoints[0]),he=this.pointToScreenPoint(this.controlPoints[1]),fe=he.x-ce.x,Ae=he.y-ce.y,pe=Math.sqrt(fe*fe+Ae*Ae)/2,Oe=he.subtract(ce),Fe=ce.add(he).scaled(.5),Ne=new Point(-Oe.y,Oe.x).normalized(),ze=Fe.add(Ne.scaled(pe));let He=this.screenPointToPoint(ze);(isNaN(He.price)||isNaN(He.time))&&(He=this.screenPointToPoint(Fe)),se=He}}else this._fakePointAdded&&(this.controlPoints.splice(1,1),this._fakePointAdded=!1);return se}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],[re,se,ae]=this.controlPoints,le=[];this.controlPoints.forEach((ce,he)=>{const fe=this.pointToScreenPoint(ce);ee.push(fe.x),ne.push(fe.y);const Ae=new AnchorPoint(fe,{pointIndex:he,hitTarget:HitTarget.ChangePoint});le.push(Ae)}),this._timeAxisViews[0].update(this._calculateTimeAxisViewData(re.time,le[0].x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(re.price,le[0].y)),se&&(this._timeAxisViews[1].update(this._calculateTimeAxisViewData(se.time,le[1].x)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(se.price,le[1].y))),ae&&(this._timeAxisViews[2].update(this._calculateTimeAxisViewData(ae.time,le[2].x)),this._priceAxisViews[2].update(this._calculatePriceAxisViewData(ae.price,le[2].y))),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:le})}}class EllipseTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",EllipseToolType);Ee(this,"steps",3)}createPrimitive(){return new EllipsePrimitive({id:this.id,points:[],lineColor:"#F23645FF",lineWidth:2,backgroundColor:"#F2364533"},...this.resetArgs)}}const ShapeEllipse={type:EllipseToolType,icon:icon$q,Ctor:EllipseTool},icon$p=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M11 10.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm4 7a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0zm11-8.8V13h1V7h-6v1h4.3l-7.42 7.41a2.49 2.49 0 0 0-2.76 0l-3.53-3.53a2.5 2.5 0 1 0-4.17 0L1 18.29l.7.71 6.42-6.41a2.49 2.49 0 0 0 2.76 0l3.53 3.53a2.5 2.5 0 1 0 4.17 0z"></path></svg>
`,PathToolType="tool.shape.path";class PathPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_poligonRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();this._poligonRenderer.setData({points:this.points(),lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,leftEnd:ee.leftEnd,rightEnd:ee.rightEnd}),this._renderer.append(this._poligonRenderer),this.addAnchors(this._renderer)}}class PathPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PathPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))])}abort(){return this.updateProps({points:this.controlPoints.slice(0,this.controlPoints.length-1)}),this._props.points.length<2?DrawingAbortBehavior.Remove:DrawingAbortBehavior.None}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce)}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re})}}class PathTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PathToolType);Ee(this,"steps",1/0)}createPrimitive(){return new PathPrimitive({id:this.id,points:[],lineColor:"#2962FFFF",lineWidth:2,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Arrow},...this.resetArgs)}}const ShapePath={type:PathToolType,icon:icon$p,Ctor:PathTool},icon$o=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M16.5 6h4v-1h-4z" id="Line"></path><path d="M16.5 15h4v-1h-4z"></path><path d="M8.5 23h4v-1h-4z"></path><path d="M8.298 11.591l5.097-4.46-.659-.753-5.097 4.46zM22 7.5v5h1v-5z"></path><path d="M14 16.5v4h1v-4z"></path><path d="M6 14.5v6h1v-6z"></path><path d="M6.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM14.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM14.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM14.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PolylineToolType="tool.shape.polyline";class PolylinePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_polygonRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();this._polygonRenderer.setData({points:this.points(),lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,filled:this._data.filled,background:ee.backgroundColor}),this._renderer.append(this._polygonRenderer),this.addAnchors(this._renderer)}}class PolylinePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PolylinePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_filled",!1)}addPoint(ee,ne){if(this.controlPoints.length>1){const re=this.pointToScreenPoint(ee),se=this.controlPoints[this.controlPoints.length-2],ae=this.pointToScreenPoint(se),le=euclideanDistanceBetweenPoints(re,ae),ce=interactionTolerance().minDistanceBetweenPoints;if(le<ce)return AddPointResponse.Reject;const he=this.pointToScreenPoint(this.controlPoints[0]);if(euclideanDistanceBetweenPoints(re,he)<ce)return this._filled=!0,this.controlPoints.splice(ne,1),AddPointResponse.AcceptAndFinish}return super.addPoint(ee,ne)}setPoint(ee,ne,re){if(!(ee===0||ee===this.controlPoints.length-1))return;const ae=ee===this.controlPoints.length-1?this.controlPoints[0]:this.controlPoints[this.controlPoints.length-1],le=this.pointToScreenPoint(ae);euclideanDistanceBetweenPoints(re.screenPoint,le)<interactionTolerance().minDistanceBetweenPoints&&(this._filled=!0)}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce)}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re,filled:this._filled})}}class PolylineTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PolylineToolType);Ee(this,"steps",1/0)}createPrimitive(){return new PolylinePrimitive({id:this.id,points:[],lineColor:"#00BCD4FF",lineWidth:2,backgroundColor:"#00BCD433"},...this.resetArgs)}}const ShapePolyline={type:PolylineToolType,icon:icon$o,Ctor:PolylineTool},icon$n=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M7.5 6h13v-1h-13z" id="Line"></path><path d="M7.5 23h13v-1h-13z"></path><path d="M5 7.5v13h1v-13z"></path><path d="M22 7.5v13h1v-13z"></path><path d="M5.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 7c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM22.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM5.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,RectangleToolType="tool.shape.rect";class RectanglePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_rectangleRenderer",new RectangleRenderer)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties(),ne=ee.extendLeft,re=ee.extendRight,se={points:this.points(),color:ee.color,lineWidth:ee.lineWidth,lineStyle:ee.lineStyle,backColor:ee.backColor,extendLeft:ne,extendRight:re};this._renderer.append(this._rectangleRenderer),this._rectangleRenderer.setData(se),this._addAnchors()}_addAnchors(){const[ee,ne]=this.points(),re=ee.x-ne.x,se=ee.y-ne.y,ae=Math.sign(re*se),le=ae<0?PaneCursor.nesw:PaneCursor.nwse,ce=ae<0?PaneCursor.nwse:PaneCursor.nesw,he=[new AnchorPoint(ee,{pointIndex:0,cursorType:le}),new AnchorPoint(ne,{pointIndex:1,cursorType:le}),new AnchorPoint(new Point(ee.x,ne.y),{pointIndex:2,cursorType:ce}),new AnchorPoint(new Point(ne.x,ee.y),{pointIndex:3,cursorType:ce}),new AnchorPoint(new Point(ee.x,(ee.y+ne.y)/2),{pointIndex:4,resizeDirections:AnchorResizeHorz,style:AnchorStyle.square}),new AnchorPoint(new Point(ne.x,(ee.y+ne.y)/2),{pointIndex:5,resizeDirections:AnchorResizeHorz,style:AnchorStyle.square}),new AnchorPoint(new Point((ee.x+ne.x)/2,ee.y),{pointIndex:6,resizeDirections:AnchorResizeVert,style:AnchorStyle.square}),new AnchorPoint(new Point((ee.x+ne.x)/2,ne.y),{pointIndex:7,resizeDirections:AnchorResizeVert,style:AnchorStyle.square})],fe=this.createLineAnchor({points:he},0);this._renderer.append(fe)}}class RectanglePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new RectanglePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}setPoint(ee,ne,re){if(ee<2)return super.setPoint(ee,ne,re);switch(ee){case 2:{this.controlPoints[1].price=re.endPrice,this.controlPoints[0].time=re.endTime;break}case 3:{this.controlPoints[0].price=re.endPrice,this.controlPoints[1].time=re.endTime;break}case 4:{this.controlPoints[0].time=re.endTime;break}case 5:{this.controlPoints[1].time=re.endTime;break}case 6:{this.controlPoints[0].price=re.endPrice;break}case 7:{this.controlPoints[1].price=re.endPrice;break}}}updateAllViews(){const[ee,ne]=this.controlPoints;if(!ee)return;const re=this.pointToScreenPoint(ee),se=[new AnchorPoint(re,{pointIndex:0})];if(ne){const ae=this.pointToScreenPoint(ne);se.push(new AnchorPoint(ae,{pointIndex:1})),this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(re.y,ae.y)),this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(re.x,ae.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ee.price,re.y)),this._priceAxisViews[1].update(this._calculatePriceAxisViewData(ne.price,ae.y)),this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ee.time,re.x)),this._timeAxisViews[1].update(this._calculateTimeAxisViewData(ne.time,ae.x))}this._lines.update({points:se})}}class RectangleTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",RectangleToolType);Ee(this,"steps",2)}createPrimitive(){return new RectanglePrimitive({id:this.id,points:[],color:"#9C27B0FF",lineWidth:2,lineStyle:LineStyleType.solid,backColor:"#9C27B033",extendLeft:!1,extendRight:!1},...this.resetArgs)}}const ShapeRectangle={type:RectangleToolType,icon:icon$n,Ctor:RectangleTool,keybinding:KeyCode.KeyR|KeyMod.Alt|KeyMod.Shift},icon$m=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M14.743 3.55l-4.208 4.208.707.707 4.208-4.208zM7.71 10.583l-4.187 4.187.707.707 4.187-4.187zM3.536 18.244l6.171 6.171.707-.707-6.171-6.171zM13.232 24.475l4.22-4.22-.707-.707-4.22 4.22zM20.214 17.494l4.217-4.217-.707-.707-4.217 4.217zM24.423 9.716l-6.218-6.218-.707.707 6.218 6.218z"></path><path d="M2.5 18c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM9.5 11c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM16.5 4c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM11.5 27c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM18.5 20c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM25.5 13c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,RotatedRectangleToolType="tool.shape.rotatedRect";class RotatedRectanglePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_poligonRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this.points();if(!(ee!=null&&ee.length))return;let ne=0;ee.length===3&&(ne=distanceToLine(ee[0],ee[1],ee[2]).distance);const re=this._source.properties(),[se,ae]=ee,le=[];if(le.push(se),ae&&le.push(ae),ee.length===2){const he={points:ee,lineColor:re.color,lineWidth:1,lineStyle:LineStyleType.solid,extendLeft:!1,extendRight:!1,leftEnd:LineEnd.Normal,rightEnd:LineEnd.Normal},fe=new LineRenderer;fe.setData(he),this._renderer.append(fe)}else if(ee.length===3){const he=ae.subtract(se),fe=new Point(he.y,-he.x).normalized().scaled(ne),Ae=fe.scaled(-1),pe=se.add(fe),Oe=ae.add(fe),Fe=ae.add(Ae),Ne=se.add(Ae),ze={points:[pe,Oe,Fe,Ne],lineColor:re.color,lineWidth:re.linewidth,lineStyle:LineStyleType.solid,filled:re.fillBackground,background:re.backgroundColor,transparency:re.transparency};this._poligonRenderer.setData(ze),this._renderer.append(this._poligonRenderer);const He=thirdPointCursorType(se,ae);le.push(...ze.points.map(We=>new AnchorPoint(We,{pointIndex:2,cursorType:He})))}const ce=this.createLineAnchor({points:le},0);this._renderer.append(ce)}}class RotatedRectanglePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new RotatedRectanglePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_distance",null)}startChanging(ee){if(super.startChanging(ee),ee===0||ee===1){const ne=this.pointToScreenPoint(this.controlPoints[0]),re=this.pointToScreenPoint(this.controlPoints[1]),se=this.pointToScreenPoint(this.controlPoints[2]);this._distance=distanceToLine(ne,re,se).distance}}endChanging(){this._distance=null}setPoint(ee,ne,re){if(super.setPoint(ee,ne,re),ee==0||ee===1){const se=this.controlPoints,ae=ensure(this.pointToScreenPoint(se[0])),ce=ensure(this.pointToScreenPoint(se[1])).subtract(ae),he=new Point(ce.y,-ce.x).normalized().scaled(ensure(this._distance)),fe=ae.add(he),Ae=ensure(this.screenPointToPoint(fe));this.controlPoints[2]=Ae}}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce)}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re})}}class RotatedRectangleTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",RotatedRectangleToolType);Ee(this,"steps",3)}createPrimitive(){return new RotatedRectanglePrimitive({id:this.id,points:[],backgroundColor:"#4caf50",color:"#4caf50",fillBackground:!0,linewidth:2,transparency:80},...this.resetArgs)}}const ShapeRotatedRectangle={type:RotatedRectangleToolType,icon:icon$m,Ctor:RotatedRectangleTool,keybinding:KeyCode.KeyR|KeyMod.Alt|KeyMod.Shift},icon$l=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M8.5 23h11v-1h-11zM6 8.5v12h1v-12zM7.483 8.28l12.293 13.112.73-.684-12.293-13.112z"></path><path d="M6.5 8c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM6.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM21.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,TriangleToolType="tool.shape.triangle";class TrianglePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_polygonRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();this._polygonRenderer.setData({points:this.points(),lineColor:ee.lineColor,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,filled:!0,background:ee.backgroundColor}),this._renderer.append(this._polygonRenderer),this.addAnchors(this._renderer)}}class TrianglePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new TrianglePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ee.push(le.x),ne.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});re.push(ce),this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,le.x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,le.y))}),ee.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ee),Math.max.apply(null,ee))),ne.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,ne),Math.max.apply(null,ne))),this._lines.update({points:re})}}class TriangleTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",TriangleToolType);Ee(this,"steps",3)}createPrimitive(){return new TrianglePrimitive({id:this.id,points:[],lineColor:"#089981FF",lineWidth:2,backgroundColor:"#08998133"},...this.resetArgs)}}const ShapeTriangle={type:TriangleToolType,icon:icon$l,Ctor:TriangleTool},icon$k=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M6 21.586l3.586-3.586h13.407c.004 0 .007-11.993.007-11.993 0-.007-17-.007-17-.007v15.586zm-1 2.414v-18.005c0-.549.451-.995.995-.995h17.01c.549 0 .995.45.995 1.007v11.986c0 .556-.45 1.007-1.007 1.007h-12.993l-5 5z"></path></svg>
`,CalloutToolType="tool.text.callout";class CalloutRenderer extends MediaCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_textInfoCache",null);Ee(this,"_hitTest",null)}_calcTextSize(){if(this._data===null||this._data.points.length<2)return null;if(this._textInfoCache===null){const ee=this._data.textData.fontSize,ne=this._data.textData.lines.length,re=ee*ne,se=this._data.textData.maxWidth,ae=2*2+2*8;this._textInfoCache={textWidth:se,textHeight:re,totalWidth:se+ae,totalHeight:re+ae}}return this._textInfoCache}setData(ee){(this._data===null||!isEqual(this._data.textData.lines,ee.textData.lines)||this._data.textData.font!==ee.textData.font||this._data.textData.maxWidth!==ee.textData.maxWidth)&&(this._textInfoCache=null),this._data=ee}setHitTestResult(ee){this._hitTest=ee}hitTest(ee){if(this._data===null||this._data.points.length<2)return null;const ne=this._data.points[0],re=this._data.points[1];if(ne.subtract(ee).length()<3)return new HitTestResult(HitTarget.ChangePoint);const se=ensure(this._calcTextSize()),ae=re.x-se.totalWidth/2,le=re.y-se.totalHeight/2;return ee.x>=ae&&ee.x<=ae+se.totalWidth&&ee.y>=le&&ee.y<=le+se.totalHeight?this._hitTest:null}getTextInfo(){const ee=ensure(this._data),ne=isRtl()?"right":"left",re=ee.points[1].clone(),se=ensure(this._calcTextSize()),ae=se.totalWidth,le=se.totalHeight,ce=re.x-ae/2,he=re.y-le/2;return{font:ee.textData.font,fontSize:ee.textData.fontSize,lineSpacing:0,textTop:he+10,textBottom:he+le-10,textLeft:ce+10,textRight:ce+ae-10,textAlign:ne}}drawImpl(ee){if(this._data===null||this._data.points.length<2)return;const ne=this._data.points[0].clone(),re=this._data.points[1].clone(),se=ee.context;se.lineCap="round",se.strokeStyle=this._data.borderColor,se.lineWidth=this._data.borderWidth,se.textBaseline="bottom",se.font=this._data.textData.font;const{textWidth:ae,textHeight:le,totalWidth:ce,totalHeight:he}=ensure(this._calcTextSize()),fe=re.x-ce/2,Ae=re.y-he/2;let pe=0;const Oe=ae+4>16,Fe=le+4>16;se.textAlign=isRtl()?"right":"left";const Ne=calcTextHorizontalShift(se,ae);if(ne.x>fe+ce?pe=20:ne.x>fe&&(pe=10),ne.y>Ae+he?pe+=2:ne.y>Ae&&(pe+=1),se.translate(fe,Ae),ne.x-=fe,ne.y-=Ae,re.x-=fe,re.y-=Ae,se.beginPath(),se.moveTo(8,0),pe===10?Oe?(se.lineTo(re.x-8,0),se.lineTo(ne.x,ne.y),se.lineTo(re.x+8,0),se.lineTo(ce-8,0)):(se.lineTo(ne.x,ne.y),se.lineTo(ce-8,0)):se.lineTo(ce-8,0),pe===20?(se.lineTo(ne.x,ne.y),se.lineTo(ce,8)):se.arcTo(ce,0,ce,8,8),pe===21?Fe?(se.lineTo(ce,re.y-8),se.lineTo(ne.x,ne.y),se.lineTo(ce,re.y+8),se.lineTo(ce,he-8)):(se.lineTo(ne.x,ne.y),se.lineTo(ce,he-8)):se.lineTo(ce,he-8),pe===22?(se.lineTo(ne.x,ne.y),se.lineTo(ce-8,he)):se.arcTo(ce,he,ce-8,he,8),pe===12?Oe?(se.lineTo(re.x+8,he),se.lineTo(ne.x,ne.y),se.lineTo(re.x-8,he),se.lineTo(8,he)):(se.lineTo(ne.x,ne.y),se.lineTo(8,he)):se.lineTo(8,he),pe===2?(se.lineTo(ne.x,ne.y),se.lineTo(0,he-8)):se.arcTo(0,he,0,he-8,8),pe===1?Fe?(se.lineTo(0,re.y+8),se.lineTo(ne.x,ne.y),se.lineTo(0,re.y-8),se.lineTo(0,8)):(se.lineTo(ne.x,ne.y),se.lineTo(0,8)):se.lineTo(0,8),pe===0?(se.lineTo(ne.x,ne.y),se.lineTo(8,0)):se.arcTo(0,0,8,0,8),se.stroke(),se.fillStyle=this._data.backColor,se.fill(),se.translate(-fe,-Ae),!this._data.skipTextDrawing){se.fillStyle=this._data.color;let ze=Ae+8+2+this._data.textData.fontSize;const He=fe+8+2+Ne;for(const We of this._data.textData.lines)se.fillText(We.text,He,ze),ze+=this._data.textData.fontSize}}}class CalloutPaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_calloutRenderer",new CalloutRenderer);Ee(this,"_textWidthCache",new et);Ee(this,"_mode",TextMode.Preview)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<2)return;const ee=this._source.properties(),[ne,re]=this.points(),se=makeFont(ee.fontSize,ChartFontFamily,(ee.bold?"bold ":"")+(ee.italic?"italic ":"")),ae=ee.wordWrap?ee.wordWrapWidth:void 0,le=wordWrap(this._textDisplay(),se,this._textWidthCache,!1,ae),ce=le.filter(pe=>!pe.hidden);let he;ae!==void 0?he=ae:he=ce.reduce((pe,Oe)=>Math.max(pe,measureText(Oe.text,se,this._textWidthCache).width),0);const fe={points:[ne,re],color:this._textDisplayColor(),backColor:ee.backgroundColor,textData:{originalText:this._textDisplay(),linesIncludingHidden:le,lines:ce,maxWidth:he,font:se,fontSize:ee.fontSize},borderColor:ee.borderColor,borderWidth:ee.borderWidth,skipTextDrawing:this._isTextEditMode()};this._calloutRenderer.setData(fe),this._calloutRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:this._textCursorType()})),this._renderer.append(this._calloutRenderer),this._updateEditor(this._calloutRenderer.getTextInfo());const Ae=this.createLineAnchor({points:[ne]},0);if(this._renderer.append(Ae),ae!==void 0){const pe=new AnchorPoint({x:re.x+ae/2+10,y:re.y},{pointIndex:1}),Oe=this.createLineAnchor({points:[pe]},1);this._renderer.append(Oe)}}}class CalloutPrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new CalloutPaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ne.push(le.x),re.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});ee.push(ce),this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,le.x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,le.y))}),ne.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}addPoint(ee,ne){const re=super.addPoint(ee,ne);return ne===1&&this.startTextEditing(),re}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){this._lines.startTextEditing()}}class CalloutTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",CalloutToolType);Ee(this,"steps",2)}createPrimitive(ee){const ne=getI18nService(ee);return new CalloutPrimitive({id:this.id,points:[],text:"",placeholder:ne.t("tool.text.common.addText"),fontSize:14,textColor:"#ffffff",backgroundColor:"#0097A7B2",borderColor:"#0097A7FF",borderWidth:2,wordWrap:!1,wordWrapWidth:100},...this.getTextResetArgs(ee))}}const TextCallout={type:CalloutToolType,icon:icon$k,Ctor:CalloutTool},icon$j=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none"><path fill="currentColor" fill-rule="nonzero" d="M12 8C8.68629 8 6 10.6863 6 14V20H18C21.3137 20 24 17.3137 24 14C24 10.6863 21.3137 8 18 8H12ZM5 14C5 10.134 8.13401 7 12 7H18C21.866 7 25 10.134 25 14C25 17.866 21.866 21 18 21H6C5.44772 21 5 20.5523 5 20V14Z"></path></svg>
`,CommentToolType="tool.text.comment";class CommentRenderer extends MediaCoordinatesPaneRenderer{hitTest(te){if(this._data===null||this._data.points.length===0)return null;const{points:[ee],innerWidth:ne,innerHeight:re}=this._data,se=ee.x,ae=ee.y-re,le=box(new Point(se,ae),new Point(se+ne,ae+re));return pointInBox$1(te,le)?new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:PaneCursor.text}):null}drawImpl(te){if(this._data===null||this._data.points.length===0)return;const ee=te.context,{points:[ne],innerWidth:re,innerHeight:se,backgroundColor:ae,borderColor:le,borderRadius:ce}=this._data,he=ne.x,fe=ne.y-se;ee.translate(he,fe),drawRoundRect(ee,0,0,re,se,[ce,ce,ce,2]),ee.fillStyle=ae,ee.fill(),ee.strokeStyle=le,ee.lineWidth=2,ee.stroke(),ee.closePath()}}class CommentPaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_labelRenderer",new TextRenderer);Ee(this,"_commentRenderer",new CommentRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties(),ne={text:this._textDisplay(),fontSize:ee.fontSize,offsetX:0,offsetY:0,points:this.points(),vertAlign:VerticalAlign.Bottom,horzAlign:HorizontalAlign.Left,fontFamily:ChartFontFamily,color:this._textDisplayColor(),boxPaddingVert:Math.round(ee.fontSize/1.3),boxPaddingHorz:12};this._labelRenderer.setData(ne),this._labelRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:this._textCursorType()}));const re=this._labelRenderer.getTextInfo();this._updateEditor(re);const se=this._labelRenderer.measure(),ae={points:this.points(),borderColor:ee.borderColor,backgroundColor:ee.backgroundColor,innerWidth:se.width,innerHeight:se.height,borderRadius:Math.min(se.width,this._labelRenderer.lineHeight()+2*Math.round(ee.fontSize/1.3))/2};if(this._commentRenderer.setData(ae),ae.points.length===1){const le=this.createLineAnchor({points:ae.points},0);this._renderer.append(le)}this._renderer.append(this._commentRenderer),this._isTextEditMode()||this._renderer.append(this._labelRenderer)}}class CommentPrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new CommentPaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=this.controlPoints[0],re=this.pointToScreenPoint(ne),se=new AnchorPoint(re,{pointIndex:0,hitTarget:HitTarget.ChangePoint});ee.push(se),this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ne.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ne.price,re.y)),this._lines.update({points:ee})}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){this._lines.startTextEditing()}}class CommentTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",CommentToolType);Ee(this,"steps",1)}createPrimitive(ee){const ne=getI18nService(ee);return new CommentPrimitive({id:this.id,points:[],text:"",placeholder:ne.t("tool.text.common.addText"),fontSize:16,textColor:"#ffffff",backgroundColor:"#2962FFFF",borderColor:"#2962FFFF",wordWrap:!1},...this.getTextResetArgs(ee))}}const TextComment={type:CommentToolType,icon:icon$j,Ctor:CommentTool},icon$i=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M7.382 16h14.483l-4.167-5 4.167-5h-15.865v12.764l1.382-2.764zm-2.382 7v-18h19l-5 6 5 6h-16l-3 6z"></path></svg>
`,FlagMarkToolType="tool.text.flagMark";class FlagMarkRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(!this._data)return;const ee=te.context,ne=Math.round(this._data.point.x)-.5,re=Math.round(this._data.point.y-22)-.5;ee.translate(ne,re),ee.fillStyle="#434651",drawRoundRect(ee,0,0,2,22,1),ee.fill(),ee.fillStyle=this._data.color,ee.beginPath(),ee.moveTo(6.87,0),ee.bezierCurveTo(5.62,0,4.46,.23,3.32,.69),ee.bezierCurveTo(3.26,.71,3.2,.75,3.15,.8),ee.bezierCurveTo(3.06,.89,3,1.02,3,1.16),ee.lineTo(3,1.19),ee.lineTo(3,12.5),ee.bezierCurveTo(3,12.8,3.3,13.02,3.59,12.93),ee.bezierCurveTo(4.61,12.64,5.94,12.44,6.87,12.44),ee.bezierCurveTo(8.5,12.44,10.09,12.83,11.63,13.21),ee.bezierCurveTo(13.19,13.6,14.79,14,16.45,14),ee.bezierCurveTo(17.59,14,18.65,13.81,19.69,13.43),ee.bezierCurveTo(19.88,13.36,20,13.18,20,12.98),ee.lineTo(20,1.19),ee.bezierCurveTo(20,1.06,19.83,.93,19.66,.99),ee.bezierCurveTo(18.63,1.38,17.58,1.56,16.45,1.56),ee.bezierCurveTo(14.82,1.56,13.23,1.17,11.69,.79),ee.bezierCurveTo(10.14,.4,8.53,0,6.87,0),ee.closePath(),ee.fill()}hitTest(te){if(!this._data)return null;const{x:ee,y:ne}=this._data.point;return te.x>=ee&&te.x<=ee+20&&te.y>=ne-22&&te.y<=ne?new HitTestResult(HitTarget.MovePoint):null}}class FlagMarkPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_flagMarkRenderer",new FlagMarkRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._source.properties();this._flagMarkRenderer.setData({point:this.points()[0],color:ee.color}),this._renderer.append(this._flagMarkRenderer),this._renderer.append(new SelectionRenderer({points:this.points(),bgColors:this._lineAnchorColors(this.points()),visible:this.areAnchorsVisible(),hitTarget:HitTarget.MovePoint}))}}class FlagMarkPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new FlagMarkPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[];this.controlPoints.forEach((ne,re)=>{const se=this.pointToScreenPoint(ne),ae=new AnchorPoint(se,{pointIndex:re,hitTarget:HitTarget.ChangePoint});ee.push(ae),this._timeAxisViews[re].update(this._calculateTimeAxisViewData(ne.time,se.x)),this._priceAxisViews[re].update(this._calculatePriceAxisViewData(ne.price,se.y))}),this._lines.update({points:ee})}}class FlagMarkTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",FlagMarkToolType);Ee(this,"steps",1)}createPrimitive(){return new FlagMarkPrimitive({id:this.id,points:[],color:"#2962FFFF"},...this.resetArgs)}}const TextFlagMark={type:FlagMarkToolType,icon:icon$i,Ctor:FlagMarkTool},icon$h=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M5 3h17v13H5V3Zm8 14H5a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h17a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-8v4.05a2.5 2.5 0 1 1-1 0V17Zm.5 8a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM14 5h3a1 1 0 0 1 1 1v2h-1V6h-3v7h2v1h-5v-1h2V6h-3v2H9V6a1 1 0 0 1 1-1h4Z"></path></svg>
`,NoteToolType="tool.text.note",Styles={CircleRadius:2,RoundRectRadius:4,LabelVertPadding:6,LabelHorzPadding:8,TextMargins:2,Blur:4,ShadowOffsetY:2};class NoteRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_textLabelRenderer",new BaseTextRenderer);Ee(this,"_textInfoCache",null);Ee(this,"_lineHitTest",new HitTestResult(HitTarget.MovePoint));Ee(this,"_textHitTest",new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:PaneCursor.text}))}setTextHitTestResult(ee){this._textHitTest=ee}_calcTextSize(){if(this._data===null||this._data.points.length<2)return null;if(this._textInfoCache===null){const ee=this._textLabelRenderer.getLinesInfo(),ne=this._data.textData.fontSize*ee.lines.length,re=ee.linesMaxWidth,se=Styles.RoundRectRadius,le=2*Styles.TextMargins+2*se;this._textInfoCache={textWidth:re,textHeight:ne,totalWidth:re+le,totalHeight:ne+le}}return this._textInfoCache}setData(ee){(this._data===null||this._data.textData.text!==ee.textData.text||this._data.textData.fontSize!==ee.textData.fontSize)&&(this._textInfoCache=null),this._data=ee;const ne=ee.points[1];this._textLabelRenderer.setData({horzAlign:HorizontalAlign.Left,vertAlign:VerticalAlign.Middle,points:[ne],text:ee.textData.text||" ",color:ee.textData.color,fontFamily:ChartFontFamily,fontSize:ee.textData.fontSize,bold:ee.textData.bold,italic:ee.textData.italic,offsetX:0,offsetY:0,borderColor:ee.drawBorder?ee.borderColor:void 0,borderWidth:1,backgroundColor:ee.drawBackground?ee.backgroundColor:void 0,backgroundRoundRect:Styles.RoundRectRadius,boxPaddingVert:Styles.LabelVertPadding,boxPaddingHorz:Styles.LabelHorzPadding,boxShadow:ee.drawBorder||ee.drawBackground?{shadowColor:ee.shadowColor,shadowBlur:Styles.Blur,shadowOffsetY:Styles.ShadowOffsetY}:void 0,skipTextDrawing:ee.skipTextDrawing});const re=this._textLabelRenderer.rect(),se=ee.points[0],ae=ee.points[1],le=Math.round(Math.atan2(ae.y-se.y,ae.x-se.x)*180/Math.PI),ce=alignByAngle(le);let he=ae;switch(ce.horzAlign){case HorizontalAlign.Center:he=he.add(new Point(-.5*re.width,0));break;case HorizontalAlign.Right:he=he.add(new Point(-re.width,0));break}switch(ce.vertAlign){case VerticalAlign.Top:he=he.add(new Point(0,.5*re.height));break;case VerticalAlign.Bottom:he=he.add(new Point(0,-.5*re.height));break}this._textLabelRenderer.setPoint(he)}getTextInfo(){var pe,Oe;const ee=ensure(this._data),ne=isRtl()?"right":"left",re=Styles.RoundRectRadius,se=Styles.TextMargins,ae=ensure(this._calcTextSize()),le=this._textLabelRenderer.rect(),ce=ensure((Oe=(pe=this._textLabelRenderer.data())==null?void 0:pe.points)==null?void 0:Oe[0]).add(new Point(0,-.5*le.height)),{totalWidth:he,totalHeight:fe}=ae,Ae=re+se;return{font:ChartFontFamily,fontSize:ee.textData.fontSize,lineSpacing:0,textTop:ce.y+Ae,textBottom:ce.y+fe-Ae,textLeft:ce.x+Ae,textRight:ce.x+he-Ae,textAlign:ne}}hitTest(ee){const ne=this._data;if(ne===null||ne.points.length<2)return null;const re=interactionTolerance().line+.5,se=ne.points[0],ae=ne.points[1];if(distanceToSegment(se,ae,ee).distance<=re)return this._lineHitTest;const ce=this._textLabelRenderer.rect(),he=box(new Point(ce.x,ce.y),new Point(ce.x+ce.width,ce.y+ce.height));return pointInBox$1(ee,he)?this._textHitTest:null}drawImpl(ee){const ne=this._data;if(ne===null||ne.points.length<2)return;const re=ee.context,se=ne.points[0],ae=ne.points[1];re.strokeStyle=ne.lineColor,re.lineWidth=Math.max(1,Math.floor(ee.horizontalPixelRatio)),re.beginPath();const[le,ce]=addPixelPerfectLineToPath(re,se.x,se.y,ae.x,ae.y,ee);re.stroke();const he=Math.round(Styles.CircleRadius*ee.horizontalPixelRatio);re.fillStyle=ne.lineColor,re.beginPath(),re.arc(le,ce,he,0,2*Math.PI,!1),re.fill(),re.beginPath(),re.strokeStyle=ne.circleBorderColor,re.lineWidth=1;const fe=Math.round(Styles.CircleRadius*ee.horizontalPixelRatio+.5*ee.horizontalPixelRatio);re.arc(le,ce,fe,0,2*Math.PI,!1),re.stroke(),this._textLabelRenderer.drawImpl(ee)}}class NotePaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_noteRenderer",new NoteRenderer);Ee(this,"_mode",TextMode.Preview)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),!this._data||this._data.points.length<2)return;const ee=this._source.properties(),se={textData:{fontSize:ee.fontSize,text:this._textDisplay(),color:this._textDisplayColor(),bold:ee.bold,italic:ee.italic},shadowColor:"rgba(0, 0, 0, 0.2)",points:this.points(),lineColor:ee.lineColor,drawBackground:ee.drawBackground,drawBorder:ee.drawBorder,backgroundColor:ee.backgroundColor,borderColor:ee.borderColor,circleBorderColor:"#ffffff",skipTextDrawing:this._isTextEditMode()};this._renderer.append(this._noteRenderer),this._noteRenderer.setData(se),this._noteRenderer.setTextHitTestResult(new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:this._textCursorType()})),this._renderer.append(this.createLineAnchor({points:this.points()},0));const ae=this._noteRenderer.getTextInfo();this._updateEditor(ae)}}class NotePrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new NotePaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[];this.controlPoints.forEach((se,ae)=>{const le=this.pointToScreenPoint(se);ne.push(le.x),re.push(le.y);const ce=new AnchorPoint(le,{pointIndex:ae,hitTarget:HitTarget.ChangePoint});ee.push(ce),this._timeAxisViews[ae].update(this._calculateTimeAxisViewData(se.time,le.x)),this._priceAxisViews[ae].update(this._calculatePriceAxisViewData(se.price,le.y))}),ne.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee})}addPoint(ee,ne){const re=super.addPoint(ee,ne);return ne===1&&this.startTextEditing(),re}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){this._lines.startTextEditing()}}class NoteTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",NoteToolType);Ee(this,"steps",2)}createPrimitive(ee){const ne=getI18nService(ee);return new NotePrimitive({id:this.id,points:[],text:"",placeholder:ne.t("tool.text.common.addText"),fontSize:14,textColor:"#1A1A1AFF",drawBackground:!0,backgroundColor:"#ffffff",drawBorder:!1,borderColor:"#EBEBEBFF",lineColor:"#1A1A1AFF",wordWrap:!0},...this.getTextResetArgs(ee))}}const TextNote={type:NoteToolType,icon:icon$h,Ctor:NoteTool},icon$g=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M21 11.25c0 1.97-1.03 4.2-2.6 6.53a67.74 67.74 0 0 1-4.23 5.45l-.17.2-.17-.2a67.74 67.74 0 0 1-4.23-5.45C8.03 15.44 7 13.22 7 11.25A7.13 7.13 0 0 1 14 4c3.84 0 7 3.22 7 7.25Zm-6.07 12.63-.28.34L14 25l-.65-.78-.28-.34C9.9 20.06 6 15.4 6 11.25A8.13 8.13 0 0 1 14 3c4.42 0 8 3.7 8 8.25 0 4.14-3.89 8.81-7.07 12.63ZM17 11a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm1 0a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"></path></svg>
`,PinToolType="tool.text.pin",icon$f=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 30" width="24" height="30"><path fill="#2962FF" fill-rule="evenodd" d="m12 30 .88-.77C20.25 22.73 24 17.07 24 12.09 24 5.04 18.54 0 12 0S0 5.04 0 12.1c0 4.97 3.75 10.64 11.12 17.13L12 30Zm0-13a5 5 0 1 0 0-10 5 5 0 0 0 0 10Z"/></svg>
`;let svg;function getSvg(){return svg||(svg=svgRenderer(icon$f))}function drawTooltipPath(ie){const{ctx:te,scope:ee,left:ne,top:re,width:se,height:ae,point:le,caretPos:ce,mode:he}=ie,{horizontalPixelRatio:fe,verticalPixelRatio:Ae}=ee,pe=Math.max(1,Math.floor(fe))%2/2,Oe=Math.round(le.x*fe)+pe,Fe=he===0?Math.max(1,Math.floor(fe)):0,Ne=Math.round(ne*fe)+Fe/2,ze=Math.round(re*Ae)+Fe/2,He=Math.round(se*fe)-Fe,We=Math.round(ae*Ae)-Fe,je=Math.round(12*fe),Ue=Math.round(10*Ae),Ge=Oe-je/2,Ze=Oe+je/2,Ye=Math.atan(10/6),qe=4*Math.cos(Ye),nr=4*Math.sin(Ye),ir=4*fe;if(te.beginPath(),te.moveTo(Ne,ze+ir),te.arcTo(Ne,ze,Ne+ir,ze,ir),ce==="top"){const tr=ze,or=ze-Ue;te.lineTo(Ge-ir,tr),te.arcTo(Ge,tr,Ge+qe,tr-nr,ir),te.lineTo(Oe-1.2*qe,or+1.2*nr),te.arcTo(Oe,or,Oe+1.2*qe,or+1.2*nr,1.2*qe),te.lineTo(Ze-qe,tr-nr),te.arcTo(Ze,tr,Ze+ir,tr,ir)}if(te.lineTo(Ne+He-ir,ze),te.arcTo(Ne+He,ze,Ne+He,ze+ir,ir),te.lineTo(Ne+He,ze+We-ir),te.arcTo(Ne+He,ze+We,Ne+He-ir,ze+We,ir),ce==="bottom"){const tr=ze+We,or=tr+Ue;te.lineTo(Ze+ir,tr),te.arcTo(Ze,tr,Ze-qe,tr+nr,ir),te.lineTo(Oe+1.2*qe,or-1.2*nr),te.arcTo(Oe,or,Oe-1.2*qe,or-1.2*nr,1.2*qe),te.lineTo(Ge+qe,tr+nr),te.arcTo(Ge,tr,Ge-ir,tr,ir)}te.lineTo(Ne+ir,ze+We),te.arcTo(Ne,ze+We,Ne,ze+We-ir,ir),te.closePath()}class PinRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){if(this._data!==null){const{point:ee,left:ne,top:re,width:se,height:ae,tooltipVisible:le}=this._data,ce=ee.x,he=ee.y,fe=getSvg().viewBox(),Ae=box(new Point(ce-fe.width/2,he-fe.height),new Point(ce+fe.width/2,he));if(pointInBox$1(te,Ae))return new HitTestResult(HitTarget.MovePoint);if(le){const pe=box(new Point(ne,re),new Point(ne+se,re+ae));if(pointInBox$1(te,pe))return new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:this._data.cursorType});const Oe=Ae.min.y,Fe=pe.min.y,Ne=Fe<Oe?Ae.max.y:pe.max.y,ze=Fe<Oe?Fe:Oe,He=box(new Point(Ae.min.x-8,Ne),new Point(Ae.max.x+8,ze));if(pointInBox$1(te,He))return new HitTestResult(HitTarget.MovePoint)}}return null}drawImpl(te){if(!this._data)return;const{horizontalPixelRatio:ee,verticalPixelRatio:ne,context:re}=te,se=Math.max(1,Math.floor(ee))%2/2,ae=Math.max(1,Math.floor(ne))%2/2,{point:le,markerColor:ce}=this._data,he=Math.round(le.x*ee)+se,fe=Math.round(le.y*ne)+ae,Ae=getSvg().viewBox();re.fillStyle=ce,getSvg().render(re,{targetViewBox:{x:he-ee*Ae.width/2,y:fe-ee*Ae.height,width:ee*Ae.width,height:ee*Ae.height},doNotApplyColors:!0}),this._data.tooltipVisible&&this._drawTooltipOn(re,te)}_drawTooltipOn(te,ee){te.save();const ne=ensure(this._data),{point:re,textColor:se,font:ae,fontSize:le,backgroundColor:ce,borderColor:he,boxShadowColor:fe,width:Ae,textWidth:pe,left:Oe,top:Fe,height:Ne,lineSpacing:ze,caretPos:He,lines:We}=ne,{horizontalPixelRatio:je,verticalPixelRatio:Ue}=ee;if(te.font=ae,ce){te.fillStyle=ce;let Ye=!1;fe&&(te.save(),te.shadowColor=fe,te.shadowBlur=4,te.shadowOffsetX=0,te.shadowOffsetY=2,Ye=!0),drawTooltipPath({ctx:te,scope:ee,left:Oe,top:Fe,width:Ae,height:Ne,point:re,caretPos:He,mode:1}),te.fill(),Ye&&te.restore()}he&&(te.lineWidth=Math.max(1,Math.floor(je)),te.strokeStyle=he,drawTooltipPath({ctx:te,scope:ee,left:Oe,top:Fe,width:Ae,height:Ne,point:re,caretPos:He,mode:0}),te.stroke()),te.textBaseline="middle",te.fillStyle=se,te.textAlign=isRtl()?"right":"left";const Ge=Oe+12+calcTextHorizontalShift(te,pe);let Ze=Fe+12+le/2;drawScaled(te,je,Ue,()=>{for(const Ye of We)te.fillText(Ye,Ge,Ze),Ze+=le+ze}),te.restore()}getTextInfo(){const{font:te,fontSize:ee,width:ne,left:re,top:se,height:ae,lineSpacing:le}=ensure(this._data);return{font:te,fontSize:ee,lineSpacing:le,textTop:se+12,textBottom:se+ae-12,textLeft:re+12,textRight:re+ne-12,textAlign:isRtl()?"right":"left"}}}class PinPaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_pinRenderer",new PinRenderer);Ee(this,"_textWidthCache",new et)}renderer(){return this._renderer}isLabelVisible(){return this.isHoveredSource()||this.isSelectedSource()}_updateImpl(){this._renderer.clear();const ee=this._data;if(!ee||ee.points.length===0)return;const ne=this.isLabelVisible(),re=this._source.properties(),se=makeFont(re.fontSize,ChartFontFamily,re.italic?"italic":void 0,re.bold?"bold":void 0);let ae,le;re.drawBackground&&(ae=re.backgroundColor,le="rgba(0, 0, 0, 0.2)");const{mediaSize:ce}=this._source.getScope(),he=Math.min(236,ce.width),fe=he-24,Ae=this.points()[0],pe=wordWrap(this._textDisplay(),se,this._textWidthCache,!1,fe),Oe=pe.filter(Ze=>!Ze.hidden).map(Ze=>Ze.text),Fe=re.fontSize;let Ne=Oe.length*Fe+24;Oe.length>1&&(Ne+=5*(Oe.length-1));let ze=Math.round(Ae.x-he/2);const He=getSvg().viewBox();let We=Math.round(Ae.y-He.height-Ne-13);const je=Ae.x<24||Ae.x+24>ce.width;let Ue=je?null:"top";We<10?We=Ae.y+13:je||(Ue="bottom"),ze<10?ze=10:ze+he+10>ce.width&&(ze=ce.width-he-10),this._pinRenderer.setData({linesIncludingHidden:pe,lines:this._isTextEditMode()?[]:Oe,font:se,fontSize:Fe,backgroundColor:ae,boxShadowColor:le,borderColor:re.drawBorder?re.borderColor:void 0,textColor:this._textDisplayColor(),markerColor:re.markerColor,point:Ae,tooltipVisible:ne,width:he,height:Ne,left:ze,top:We,caretPos:Ue,lineSpacing:5,textWidth:fe,cursorType:this.isSelectedSource()?PaneCursor.text:PaneCursor.unset}),this._updateEditor(this._pinRenderer.getTextInfo()),this._renderer.append(this._pinRenderer);const Ge=new SelectionRenderer({points:this.points(),bgColors:this._lineAnchorColors(this.points()),visible:this.areAnchorsVisible(),hitTarget:HitTarget.MovePoint});this._renderer.append(Ge)}}class PinPrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PinPaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_fixedPoint",null)}isFixed(){return this.properties().fixed}addPoint(ee,ne){return this.isFixed()&&(this._fixedPoint=this.pointToScreenPoint(ee)),super.addPoint(ee,ne)}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],[ne]=this.controlPoints,re=this.isFixed()?ensure(this._fixedPoint):this.pointToScreenPoint(ne),se=new AnchorPoint(re,{pointIndex:0,hitTarget:HitTarget.ChangePoint});ee.push(se),this.isFixed()||(this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ne.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ne.price,re.y))),this._lines.update({points:ee})}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){return this._lines.startTextEditing()}}class PinTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",PinToolType);Ee(this,"steps",1);Ee(this,"fixed",!1)}createPrimitive(ee){const ne=getI18nService(ee);return new PinPrimitive({id:this.id,points:[],text:"",placeholder:ne.t("tool.text.common.addText"),fontSize:14,textColor:"#1A1A1AFF",markerColor:"#2962FFFF",drawBackground:!0,backgroundColor:"#ffffff",drawBorder:!1,borderColor:"#EBEBEBFF",wordWrap:!0,fixed:this.fixed},...this.getTextResetArgs(ee))}}const TextPin={type:PinToolType,icon:icon$g,Ctor:PinTool},icon$e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M18.4 17.78c1.57-2.34 2.6-4.56 2.6-6.53A7.13 7.13 0 0 0 14 4c-3.84 0-7 3.22-7 7.25 0 1.97 1.03 4.2 2.6 6.53a67.74 67.74 0 0 0 4.23 5.45l.17.2.17-.2a67.72 67.72 0 0 0 4.23-5.45Zm-3.75 6.44.28-.34C18.1 20.06 22 15.4 22 11.25A8.13 8.13 0 0 0 14 3c-4.42 0-8 3.7-8 8.25 0 4.14 3.89 8.81 7.07 12.63l.28.34.65.78.65-.78ZM14 14a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8Zm11 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm0 1.41a1.5 1.5 0 1 0-1 0V20h-2v1h2v3.93a3.48 3.48 0 0 1-1.1-.47c-.54-.37-.9-.86-.9-1.46h-1c0 1.06.64 1.82 1.35 2.29.7.46 1.54.71 2.15.71.6 0 1.45-.25 2.15-.71A2.76 2.76 0 0 0 28 23h-1c0 .6-.36 1.1-.9 1.46-.36.23-.76.4-1.1.47V21h2v-1h-2v-1.09Z"></path></svg>
`,PinFixedToolType="tool.text.pinFixed";class PinFixedTool extends PinTool{constructor(){super(...arguments);Ee(this,"fixed",!0)}}const TextPinFixed={type:PinFixedToolType,icon:icon$e,Ctor:PinFixedTool},icon$d=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path d="M6.995 5c.008 0 .005 15.5.005 15.5h-1v-15.493c0-.556.451-1.007.995-1.007h17.01c.549 0 .995.45.995 1.007v11.986c0 .556-.45 1.007-1.007 1.007h-12.993l-3.104 3.104-.707-.707 3.397-3.397h13.407c.004 0 .007-11.993.007-11.993 0-.007-17.005-.007-17.005-.007z"></path><path d="M6.5 24c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path></g></svg>
`,PriceLabelToolType="tool.text.priceLabel";class PriceLabelRenderer extends MediaCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_measureCache",null)}drawImpl(ee){if(this._data===null||this._data.points.length===0)return;const ne=ee.context;ne.font=this._data.font;const re=ne.measureText(this._data.label),se=this._data.fontSize,ae=10,le=5,ce=re.width+2*ae,he=se+2*le,fe=-9,Ae=15,pe=this._data.points[0].x+9,Oe=this._data.points[0].y-(he+Ae),Fe=calcTextHorizontalShift(ne,re.width);this._measureCache={innerWidth:ce,innerHeight:he,tailLeft:fe,tailHeight:Ae},ne.textAlign=isRtl()?"right":"left",ne.translate(pe,Oe),ne.beginPath(),ne.moveTo(12,he),ne.lineTo(-9,he+Ae),ne.lineTo(5,he),ne.lineTo(3,he),ne.arcTo(0,he,0,0,3),ne.lineTo(0,3),ne.arcTo(0,0,ce,0,3),ne.lineTo(ce-3,0),ne.arcTo(ce,0,ce,he,3),ne.lineTo(ce,he-3),ne.arcTo(ce,he,0,he,3),ne.lineTo(12,he),ne.fillStyle=this._data.backgroundColor,ne.fill(),ne.strokeStyle=this._data.borderColor,ne.lineWidth=2,ne.stroke(),ne.closePath(),ne.textBaseline="alphabetic",ne.fillStyle=this._data.color;const Ne=ae+Fe,ze=he/2+Math.floor(.35*se);ne.fillText(this._data.label,Ne,ze),ne.beginPath(),ne.arc(-9,he+15,2.5,0,2*Math.PI,!1),ne.fillStyle=this._data.borderColor,ne.fill(),ne.strokeStyle="#ffffff",ne.lineWidth=1,ne.stroke(),ne.closePath()}hitTest(ee){if(this._data===null||this._data.points.length===0||!this._measureCache)return null;const ne=this._data.points[0].x,re=this._data.points[0].y,se=ne-this._measureCache.tailLeft,ae=re-(this._measureCache.innerHeight+this._measureCache.tailHeight),le=box(new Point(se,ae),new Point(se+this._measureCache.innerWidth,ae+this._measureCache.innerHeight));return pointInBox$1(ee,le)?new HitTestResult(HitTarget.MovePoint):null}}class PriceLabelPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_priceLabelRenderer",new PriceLabelRenderer)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),!this._data)return;this._renderer.clear();const ee=this._source.properties(),ne=ee.fontSize,re={points:this.points(),borderColor:ee.borderColor,backgroundColor:ee.backgroundColor,color:ee.color,font:makeFont(ne,ChartFontFamily,"",ee.fontWeight),fontSize:ne,label:this._data.label};this._priceLabelRenderer.setData(re),this._renderer.append(this._priceLabelRenderer),this._renderer.append(new SelectionRenderer({points:this.points(),bgColors:this._lineAnchorColors(re.points),visible:this.areAnchorsVisible(),hitTarget:HitTarget.MovePoint}))}}class PriceLabelPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PriceLabelPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=this._ctx.priceLabelFormatter(this.controlPoints[0].price);this.controlPoints.forEach((re,se)=>{const ae=this.pointToScreenPoint(re),le=new AnchorPoint(ae,{pointIndex:se,hitTarget:HitTarget.ChangePoint});ee.push(le),this._timeAxisViews[se].update(this._calculateTimeAxisViewData(re.time,ae.x)),this._priceAxisViews[se].update(this._calculatePriceAxisViewData(re.price,ae.y))}),this._lines.update({points:ee,label:ne})}}class PriceLabelTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PriceLabelToolType);Ee(this,"steps",1)}createPrimitive(){return new PriceLabelPrimitive({id:this.id,points:[],fontSize:14,fontWeight:"bold",color:"#ffffff",backgroundColor:"#2962FFFF",borderColor:"#2962FFFF"},...this.resetArgs)}}const TextPriceLabel={type:PriceLabelToolType,icon:icon$d,Ctor:PriceLabelTool},icon$c=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M22 3H5v13h17V3ZM5 17h8v4.05a2.5 2.5 0 1 0 1 0V17h8a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1Zm10 6.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM13 4h1v1h.5A2.5 2.5 0 0 1 17 7.5V8h-1v-.5c0-.83-.67-1.5-1.5-1.5H14v3h.5a2.5 2.5 0 0 1 0 5H14v1h-1v-1h-.5a2.5 2.5 0 0 1-2.5-2.5V11h1v.5c0 .83.67 1.5 1.5 1.5h.5v-3h-.5a2.5 2.5 0 0 1 0-5h.5V4Zm0 2h-.5a1.5 1.5 0 0 0 0 3h.5V6Zm1 4v3h.5a1.5 1.5 0 0 0 0-3H14Z"></path></svg>
`,PriceNoteToolType="tool.text.priceNote";function fillScaledRadius(ie,te){const ne=Math.max(1,Math.floor(te))%2===1?.5:0;return Math.round(ie*te)+ne}class PriceNodeRenderer extends BitmapCoordinatesPaneRenderer{constructor(){super(...arguments);Ee(this,"_priceLabelRenderer",new BaseTextRenderer(new HitTestResult(HitTarget.MovePoint)))}setData(ee){this._data=ee;const ne=ee.points[0],re=ee.points[1],se=Math.round(180*Math.atan2(re.y-ne.y,re.x-ne.x)/Math.PI);this._priceLabelRenderer.setData({...alignByAngle(se),points:[re],text:ee.text,color:ee.textColor,fontFamily:ChartFontFamily,fontSize:ee.fontSize,bold:ee.bold,italic:ee.italic,offsetX:0,offsetY:0,borderColor:ee.borderColor,borderWidth:1,backgroundColor:ee.backgroundColor,backgroundRoundRect:4,boxPaddingVert:6,boxPaddingHorz:8})}hitTest(ee){const ne=this._data;if(ne===null)return null;const re=interactionTolerance().line;return distanceToSegment(ne.points[0],ne.points[1],ee).distance<=re?new HitTestResult(HitTarget.MovePoint):this._priceLabelRenderer.hitTest(ee)}drawImpl(ee){const ne=this._data;if(ne===null||ne.points.length<2)return;const{horizontalPixelRatio:re,verticalPixelRatio:se,context:ae}=ee;ae.save();const le=Math.round(ne.points[0].x*re),ce=Math.round(ne.points[0].y*se),he=Math.round(ne.points[1].x*re),fe=Math.round(ne.points[1].y*se);ae.lineCap="round",setLineStyle(ae,LineStyleType.solid),ae.strokeStyle=ne.lineColor,ae.fillStyle=ne.lineColor,ae.lineWidth=Math.round(re);const Ae=fillScaledRadius(2,re);createCircle(ae,le,ce,Ae),ae.fill(),ne.excludeBoundaries!==void 0&&(ae.save(),addExclusionAreaByScope(ee,ne.excludeBoundaries)),drawLine(ae,le,ce,he,fe),ne.excludeBoundaries!==void 0&&ae.restore(),this._priceLabelRenderer.drawImpl(ee);const pe=re;ae.strokeStyle=ne.circleBorderColor,ae.lineWidth=pe;const Oe=Ae+pe/2;createCircle(ae,le,ce,Oe),ae.stroke(),ae.restore()}}class PriceNotePaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_priceNoteRenderer",new PriceNodeRenderer);Ee(this,"_customLabelRenderer",new BaseTextRenderer)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),!this._data)return;const ee=this.points();if(ee.length<2)return;const ne=this._source.properties(),se={text:this._data.labelText,points:ee,lineColor:ne.lineColor,circleBorderColor:"#ffffff",backgroundColor:ne.labelBackgroundColor,borderColor:ne.labelBorderColor,textColor:ne.labelTextColor,fontSize:ne.labelFontSize,bold:ne.labelBold,italic:ne.labelItalic,excludeBoundaries:void 0};if(ne.showLineText){const ae=ee[0],le=ee[1],ce=ae.x<le.x?ae:le,he=ce===ae?le:ae,fe=ne.vertTextAlign,Ae=ne.horzTextAlign;let pe;Ae==="left"?pe=ce.clone():Ae==="right"?pe=he.clone():pe=new Point((ae.x+le.x)/2,(ae.y+le.y)/2);const Oe=Math.atan((he.y-ce.y)/(he.x-ce.x)),Fe={points:[pe],text:ne.text,color:ne.textColor,vertAlign:fe,horzAlign:Ae,fontFamily:ChartFontFamily,offsetX:0,offsetY:0,bold:ne.bold,italic:ne.italic,fontSize:ne.fontSize,forceTextAlign:!0,angle:Oe,cursorType:PaneCursor.unset};if(this._customLabelRenderer.setData(Fe),this._renderer.append(this._customLabelRenderer),fe===VerticalAlign.Middle){const{mediaSize:{width:Ne,height:ze}}=this._source.getScope();se.excludeBoundaries=getTextBoundaries(this._customLabelRenderer,Ne,ze)??void 0}}this._priceNoteRenderer.setData(se),this._renderer.append(this._priceNoteRenderer),this._renderer.append(this.createLineAnchor({points:this.points()},0))}}class PriceNotePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new PriceNotePaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=[],re=[],se=this._ctx.priceLabelFormatter(this.controlPoints[0].price);this.controlPoints.forEach((ae,le)=>{const ce=this.pointToScreenPoint(ae);ne.push(ce.x),re.push(ce.y);const he=new AnchorPoint(ce,{pointIndex:le,hitTarget:HitTarget.ChangePoint});ee.push(he),this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ce.x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ce.y))}),ne.length&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,ne),Math.max.apply(null,ne))),re.length&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,re),Math.max.apply(null,re))),this._lines.update({points:ee,labelText:se})}}class PriceNoteTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",PriceNoteToolType);Ee(this,"steps",2)}createPrimitive(){return new PriceNotePrimitive({id:this.id,points:[],showLineText:!1,text:"",fontSize:14,textColor:"#2962FFFF",vertTextAlign:"top",horzTextAlign:"center",labelTextColor:"#ffffff",labelFontSize:12,labelBold:!1,labelItalic:!1,labelBackgroundColor:"#2962FFFF",labelBorderColor:"#2962FFFF",lineColor:"#2962FFFF"},...this.resetArgs)}}const TextPriceNote={type:PriceNoteToolType,icon:icon$c,Ctor:PriceNoteTool},icon$b=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="nonzero"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.48 5.46a.5.5 0 0 0-.96 0l-.98 3.03a.5.5 0 0 1-.47.35H8.88a.5.5 0 0 0-.3.9l2.58 1.87a.5.5 0 0 1 .18.56l-.98 3.03a.5.5 0 0 0 .77.56l2.58-1.87a.5.5 0 0 1 .58 0l2.58 1.87c.4.28.92-.1.77-.56l-.98-3.03a.5.5 0 0 1 .18-.56l2.57-1.87a.5.5 0 0 0-.3-.9h-3.18a.5.5 0 0 1-.47-.35l-.98-3.03zM14 7.24l-.5 1.56a1.5 1.5 0 0 1-1.43 1.04h-1.65l1.33.96c.53.39.75 1.06.55 1.68l-.51 1.57 1.33-.97a1.5 1.5 0 0 1 1.76 0l1.33.97-.5-1.57c-.2-.62.01-1.3.54-1.68l1.33-.96h-1.65a1.5 1.5 0 0 1-1.42-1.04L14 7.24z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M15 20.95a10 10 0 1 0-1 .05v6h1v-6.05zM14 20a9 9 0 1 0 0-18 9 9 0 0 0 0 18z"></path></g></svg>
`,SignpostToolType="tool.text.signpost";class SignpostRenderer extends BitmapCoordinatesPaneRenderer{hitTest(te){if(this._data===null)return null;const[ee,ne]=this._hitTestLineOrEmoji(this._data,te);return ee||ne?new HitTestResult(HitTarget.MovePoint):null}_hitTestLineOrEmoji(te,ee){const ne=interactionTolerance().line,{x:re,poleTopY:se,poleBottomY:ae,plate:le}=te,ce=new Point(re,se),he=new Point(re,ae),fe=distanceToSegment(ce,he,ee).distance<ne,Ae=!1;return!fe&&le!==void 0&&NOTIMPLEMENTED(),[fe,Ae]}drawImpl(te){if(!this._data)return;const ee=te.context,{poleColor:ne,plate:re}=this._data,{horizontalPixelRatio:se,verticalPixelRatio:ae}=te;ee.save();const le=Math.max(1,Math.floor(se)),ce=le%2?.5:0;ee.beginPath(),ee.strokeStyle=ne,ee.lineWidth=le;const he=Math.round(this._data.x*se)+ce,fe=Math.round(this._data.poleTopY*ae),Ae=Math.round(this._data.poleBottomY*ae);ee.moveTo(he,fe),ee.lineTo(he,Ae),re&&NOTIMPLEMENTED(),ee.stroke(),re&&NOTIMPLEMENTED(),ee.restore()}}class SignpostPaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_labelRenderer",new TextRenderer);Ee(this,"_signpostRenderer",new SignpostRenderer);Ee(this,"_mode",TextMode.Preview)}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),!this._data)return;const ee=this._updateLabelTextRenderer(this._source.getScope());this._updateTimelineRenderer(ee),this._renderer.append(this._signpostRenderer),this._renderer.append(this._labelRenderer);const ne=this.points()[0],re=new AnchorPoint(ee.point,ne);this._renderer.append(this.createLineAnchor({points:[re]},0))}_updateLabelTextRenderer(ee){const ne=this._source.properties(),{height:re,width:se}=ee.mediaSize,ae=this.points()[0];let le,ce,he;this._data.startsOnSeriesData?ae.y>this._data.barLow?(le=!0,he=Math.max(ae.y,this._data.barLow),ce=-1):(le=!1,he=Math.min(ae.y,this._data.barHigh),ce=1):(le=!1,he=ae.y,ae.y>re/2?ce=-1:ce=1),he>=-1e-10&&he<=re+1e-10&&(he=Math.min(re-2,Math.max(2,he)));const fe={text:this._textDisplay(),fontSize:ne.fontSize,bold:ne.bold,italic:ne.italic,offsetX:0,offsetY:0,points:[new Point(ae.x,he)],forceCalculateMaxLineWidth:!0,vertAlign:ce===-1?VerticalAlign.Bottom:VerticalAlign.Top,horzAlign:HorizontalAlign.Center,fontFamily:ChartFontFamily,backgroundRoundRect:4,boxPaddingVert:6,boxPaddingHorz:8,wordWrapWidth:134,color:this._textDisplayColor(),borderColor:"#EBEBEB",borderWidth:1,backgroundColor:"#ffffff",skipTextDrawing:this._isTextEditMode()};this._labelRenderer.setData(fe);const Ae=this._labelRenderer.measure().height,pe=3;let Oe=he,Fe,Ne;this._data.startsOnSeriesData?le?(Fe=this._data.barLow+pe,Oe=Math.max(Fe+Ae,he),Ne=Oe-Ae):(Ne=this._data.barHigh-pe,Oe=Math.min(Ne-Ae,he),Fe=Oe+Ae):(Ne=re,Fe=ce===-1?he:he+Ae);let ze=ae;return Oe!==he&&(ze=new Point(ae.x,Oe),this._labelRenderer.setData({...fe,points:[ze]})),this._labelRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:this._textCursorType()})),this._labelRenderer.isOutOfScreen(se,re)?this._deactiveEditMode():this._updateEditor(this._labelRenderer.getTextInfo()),{point:ze,shapeUpsideDown:le,poleTopY:Fe,poleBottomY:Ne,labelDirection:ce}}_updateTimelineRenderer(ee){const ne=this._source.properties(),re={emojiRadius:16,poleColor:"#1A1A1AFF",svgRenderer:void 0,poleTopY:ee.poleTopY,poleBottomY:ee.poleBottomY,x:ee.point.x};ne.showImage&&NOTIMPLEMENTED(),this._signpostRenderer.setData(re)}}class SignpostPrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new SignpostPaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))])}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],ne=this.controlPoints[0],re=this.pointToScreenPoint(ne),se=new AnchorPoint(re,{pointIndex:0,hitTarget:HitTarget.ChangePoint,cursorType:PaneCursor.ns,style:AnchorStyle.square,resizeDirections:AnchorResizeVert});ee.push(se),this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ne.time,re.x));const ae=this.chart.timeScale().timeToIndex(ne.time);let le=NaN,ce=NaN;if(ae!==null){const he=this.series.dataByIndex(ae);he&&isSeriesData(he)&&(le=ensure(this.series.priceToCoordinate(he.customValues.high)),ce=ensure(this.series.priceToCoordinate(he.customValues.low)))}this._lines.update({points:ee,startsOnSeriesData:isFinite(le)&&isFinite(ce)&&ae!==null,barHigh:le,barLow:ce})}addPoint(ee,ne){const re=super.addPoint(ee,ne);return this.startTextEditing(),re}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){this._lines.startTextEditing()}}class SignpostTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",SignpostToolType);Ee(this,"steps",1);Ee(this,"previewBeforePlace",!0)}createPrimitive(ee){const ne=getI18nService(ee);return new SignpostPrimitive({id:this.id,points:[],text:"",placeholder:ne.t("tool.text.common.addText"),fontSize:12,textColor:"#1A1A1AFF",wordWrap:!1,emoji:"",showImage:!1,position:50},...this.getTextResetArgs(ee))}}const TextSignpost={type:SignpostToolType,icon:icon$b,Ctor:SignpostTool},icon$a=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M8 6.5c0-.28.22-.5.5-.5H14v16h-2v1h5v-1h-2V6h5.5c.28 0 .5.22.5.5V9h1V6.5c0-.83-.67-1.5-1.5-1.5h-12C7.67 5 7 5.67 7 6.5V9h1V6.5Z"></path></svg>
`,TextToolType="tool.text.text";class TextPaneView extends BaseTextPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_textRenderer",new TextRenderer)}renderer(){return this._renderer}_updateImpl(){this._renderer.clear();const ee=this._data;if(!ee||ee.points.length===0)return;const ne=this._source.properties(),re={points:this.points(),text:this._textDisplay(),color:this._textColor(),fontSize:ne.fontSize,boxPadding:ne.fontSize/6,fontFamily:ChartFontFamily,vertAlign:"top",horzAlign:"left",offsetX:0,offsetY:0};if(this._textRenderer.setData(re),this._textRenderer.setHitTestResult(new HitTestResult(HitTarget.MovePoint,{areaName:AreaName.Text,cursorType:this._textCursorType()})),this._isTextEditMode())this._updateEditor(this._textRenderer.getTextInfo());else{this._renderer.append(this._textRenderer);const se=ee.points[0],ae=this._textRenderer.measure(),le=ae.width,ce=ae.height,he=new AnchorPoint({x:se.x+le/2,y:se.y+ce});this._renderer.append(new SelectionRenderer({points:[he],bgColors:this._lineAnchorColors([he]),visible:this.areAnchorsVisible(),hitTarget:HitTarget.MovePoint}))}}}class TextPrimitive extends BaseTextPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new TextPaneView(this,this.model,this.editingHelper));Ee(this,"_paneView",[this._lines]);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_fixedPoint",null)}isFixed(){return this.properties().fixed}addPoint(ee,ne){return this.isFixed()&&(this._fixedPoint=this.pointToScreenPoint(ee)),super.addPoint(ee,ne)}updateAllViews(){if(!this.controlPoints.length)return;const ee=[],[ne]=this.controlPoints,re=this.isFixed()?ensure(this._fixedPoint):this.pointToScreenPoint(ne),se=new AnchorPoint(re,{pointIndex:0,hitTarget:HitTarget.ChangePoint});ee.push(se),this.isFixed()||(this._timeAxisViews[0].update(this._calculateTimeAxisViewData(ne.time,re.x)),this._priceAxisViews[0].update(this._calculatePriceAxisViewData(ne.price,re.y))),this._lines.update({points:ee})}isCreationFinished(){return this._lines.isCreationFinished()}startTextEditing(){return this._lines.startTextEditing()}}class TextTool extends BaseTextTool{constructor(){super(...arguments);Ee(this,"type",TextToolType);Ee(this,"steps",1);Ee(this,"fixed",!1)}createPrimitive(ee){const ne=getI18nService(ee);return new TextPrimitive({id:this.id,points:[],text:"",placeholder:ne.t("tool.text.common.addText"),fontSize:14,textColor:"#2962FFFF",wordWrap:!1,fixed:this.fixed},...this.getTextResetArgs(ee))}}const TextText={type:TextToolType,icon:icon$a,Ctor:TextTool},icon$9=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M8.5 6a.5.5 0 0 0-.5.5V9H7V6.5C7 5.67 7.67 5 8.5 5h12c.83 0 1.5.67 1.5 1.5V9h-1V6.5a.5.5 0 0 0-.5-.5H15v16h2v1h-5v-1h2V6H8.5ZM25 17.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Zm0 1.41a1.5 1.5 0 1 0-1 0V20h-2v1h2v3.93a3.48 3.48 0 0 1-1.1-.47c-.54-.37-.9-.86-.9-1.46h-1c0 1.06.64 1.82 1.35 2.29.7.46 1.54.71 2.15.71.6 0 1.45-.25 2.15-.71A2.76 2.76 0 0 0 28 23h-1c0 .6-.36 1.1-.9 1.46-.36.23-.76.4-1.1.47V21h2v-1h-2v-1.09Z"></path></svg>
`,AnchoredTextToolType="tool.text.anchoredText";class AnchoredTextTool extends TextTool{constructor(){super(...arguments);Ee(this,"type",AnchoredTextToolType);Ee(this,"fixed",!0)}}const TextAnchoredText={type:AnchoredTextToolType,icon:icon$9,Ctor:AnchoredTextTool},icon$8=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M5.238 18.469l4.17-4.17-.707-.707-4.17 4.17zM16.47 17.763l-.707.707-4.265-4.265.707-.707zM22.747 13.546l-4.192 4.192.707.707 4.192-4.192z"></path><path fill-rule="nonzero" d="M10.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path d="M11.148 7h-1.098v-4.137c-.401.375-.874.652-1.418.832v-.996c.286-.094.598-.271.934-.533.336-.262.566-.567.691-.916h.891v5.75z"></path><path d="M23.355 5.527l1.094-.113c.031.247.124.443.277.588.154.145.331.217.531.217.229 0 .423-.093.582-.279.159-.186.238-.467.238-.842 0-.352-.079-.615-.236-.791-.158-.176-.363-.264-.615-.264-.315 0-.598.139-.848.418l-.891-.129.563-2.98h2.902v1.027h-2.07l-.172.973c.245-.122.495-.184.75-.184.487 0 .9.177 1.238.531.339.354.508.814.508 1.379 0 .471-.137.892-.41 1.262-.372.505-.889.758-1.551.758-.529 0-.96-.142-1.293-.426-.333-.284-.533-.665-.598-1.145z"></path></g></svg>
`,Wave12345ToolType="tool.wave.12345";class LabelRenderer extends BitmapCoordinatesPaneRenderer{constructor(ee,ne){super(ee);Ee(this,"_hitTestResult");this._hitTestResult=ne}hitTest(ee){const ne=this._getCenter(),re=this.data().circleRadius,se={min:new Point(ne.x-re,ne.y-re),max:new Point(ne.x+re,ne.y+re)};return pointInBox$1(ee,se)?this._hitTestResult:null}drawImpl(ee){const ne=ee.context,{horizontalPixelRatio:re,verticalPixelRatio:se}=ee,ae=Math.max(1,Math.floor(re))%2/2,le=this._getCenter(),ce=Math.round(le.x*re)+ae,he=Math.round(le.y*se)+ae,fe=this.data();if(fe.showCircle){const Ae=Math.round(ce+fe.circleRadius*re)-ce-fe.circleBorderWidth*re/2;ne.strokeStyle=fe.color,ne.lineWidth=fe.circleBorderWidth*re,ne.beginPath(),ne.moveTo(ce+Ae,he),ne.arc(ce,he,Ae,0,2*Math.PI),ne.stroke()}ne.font=makeFont(fe.fontSize,fe.font,fe.bold?"bold":void 0),ne.textBaseline="middle",ne.textAlign="center",ne.fillStyle=fe.color,drawScaled(ne,re,se,()=>{const Ae=.05*fe.fontSize;ne.fillText(fe.letter,ce/re,he/se+Ae)}),ne.restore()}_getCenter(){const ee=this.data(),ne=ee.vertAlign==="bottom"?-1:1,re=ee.point.y+ne*(ee.yOffset+ee.circleRadius),se=ee.point.x;return new Point(se,re)}}const LabelStylePreset={4:{font:24,circle:36,circleBorderWidth:1,bold:!0},3:{font:20,circle:28,circleBorderWidth:1,bold:!1},2:{font:18,circle:22,circleBorderWidth:1,bold:!1},1:{font:16,circle:22,circleBorderWidth:1,bold:!1},0:{font:11,circle:14,circleBorderWidth:1,bold:!0}};class Wave3PaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_polylineRenderer",new PolygonRenderer)}renderer(){return this._renderer}_updateImpl(){this.renderer().clear();const ee=this._source.properties();if(ee.showWave){const ce={points:this.points(),lineColor:ee.color,lineWidth:ee.lineWidth,lineStyle:LineStyleType.solid,filled:!1,background:"rgba(0, 0, 0, 0)",lineJoin:"round"};this._polylineRenderer.setData(ce),this._renderer.append(this._polylineRenderer)}const ne=this.areAnchorsVisible()?0:1;let re=1;if(this.points().length>2){const ce=this.points()[2],he=this.points()[1];re=sign(ce.y-he.y)}let se=0;this._model.currentCreating===this._source&&(se=1);const ae=resetTransparency(ee.color);for(let ce=0;ce<this.points().length-se;ce++,re=-re){if(ce<ne)continue;const he=this._data.labels[ce];let fe=he.label;he.decoration==="circle"||he.decoration==="brackets"&&(fe="("+fe+")");const Ae=LabelStylePreset[he.group],pe=new HitTestResult(HitTarget.ChangePoint,{areaName:AreaName.AnchorPoint,componentIndex:ce,resizeDirections:AnchorResizeAll});this._renderer.append(new LabelRenderer({point:this.points()[ce],letter:fe,color:ae,font:ChartFontFamily,fontSize:Ae.font,bold:Ae.bold,showCircle:he.decoration==="circle",circleRadius:Ae.circle/2,circleBorderWidth:Ae.circleBorderWidth,yOffset:10,vertAlign:re===1?"top":"bottom"},pe))}const le=this.points().slice();this._model.currentCreating===this._source&&le.pop(),this._renderer.append(this.createLineAnchor({points:le},0))}}const u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14];class WavePrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new Wave3PaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"_priceAxisPaneViews",[new PriceRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisPaneViews",[new TimeRangeAxisPaneView(Object.create(null))]);Ee(this,"_timeAxisViews",[]);Ee(this,"_priceAxisViews",[])}updateAllViews(){if(!this.controlPoints.length)return;const ee=this.controlPoints.map((ae,le)=>new AnchorPoint(this.pointToScreenPoint(ae),{pointIndex:le})),ne={points:ee,labels:[]},re=ee.map(ae=>ae.x),se=ee.map(ae=>ae.y);this.controlPoints.forEach((ae,le)=>{this._timeAxisViews[le].update(this._calculateTimeAxisViewData(ae.time,ee[le].x)),this._priceAxisViews[le].update(this._calculatePriceAxisViewData(ae.price,ee[le].y)),ne.labels[le]=this.getLabelStyle(le)}),re.length>1&&this._timeAxisPaneViews[0].update(this._calculateTimeAxisPaneViewsData(Math.min.apply(null,re),Math.max.apply(null,re))),se.length>1&&this._priceAxisPaneViews[0].update(this._calculatePriceAxisPaneViewData(Math.min.apply(null,se),Math.max.apply(null,se))),this._lines.update(ne)}getLabelStyle(ee){const ne=this.properties().degree,se=u.length-ne-1,ae=Math.floor(se/3),le=this.labelsGroup()[ae][ee];return{group:ae,bold:ae%2!==0,decoration:["","brackets","circle"][se%3],label:le}}}class Wave3Primitive extends WavePrimitive{constructor(){super(...arguments);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}}class Wave5Primitive extends WavePrimitive{constructor(){super(...arguments);Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null)),new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null)),new PriceLabelPriceAxisView(Object.create(null))])}}class Wave12345Primitive extends Wave5Primitive{labelsGroup(){return[["0","1","2","3","4","5"],["0","i","ii","iii","iv","v"],["0","1","2","3","4","5"],["0","I","II","III","IV","V"],["0","1","2","3","4","5"]]}}class Wave12345Tool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",Wave12345ToolType);Ee(this,"steps",6)}createPrimitive(){return new Wave12345Primitive({id:this.id,points:[],color:"#3D85C6FF",lineWidth:2,showWave:!0,degree:7},...this.resetArgs)}}const Wave12345={type:Wave12345ToolType,icon:icon$8,Ctor:Wave12345Tool},icon$7=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M5.238 18.469l4.17-4.17-.707-.707-4.17 4.17zM16.47 17.763l-.707.707-4.265-4.265.707-.707zM22.747 13.546l-4.192 4.192.707.707 4.192-4.192z"></path><path fill-rule="nonzero" d="M10.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path d="M13.746 7h-1.258l-.5-1.301h-2.289l-.473 1.301h-1.227l2.23-5.727h1.223l2.293 5.727zm-2.129-2.266l-.789-2.125-.773 2.125h1.563z"></path><path d="M26.246 4.895l1.121.355c-.172.625-.458 1.089-.857 1.393-.4.303-.907.455-1.521.455-.76 0-1.385-.26-1.875-.779-.49-.52-.734-1.23-.734-2.131 0-.953.246-1.693.738-2.221.492-.527 1.139-.791 1.941-.791.701 0 1.27.207 1.707.621.26.245.456.596.586 1.055l-1.145.273c-.068-.297-.209-.531-.424-.703-.215-.172-.476-.258-.783-.258-.424 0-.769.152-1.033.457-.264.305-.396.798-.396 1.48 0 .724.13 1.24.391 1.547.26.307.599.461 1.016.461.307 0 .572-.098.793-.293.221-.195.38-.503.477-.922z"></path></g></svg>
`,WaveABCToolType="tool.wave.abc";class WaveABCPrimitive extends Wave3Primitive{labelsGroup(){return[["0","A","B","C"],["0","a","b","c"],["0","A","B","C"],["0","a","b","c"],["0","A","B","C"]]}}class WaveABCTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",WaveABCToolType);Ee(this,"steps",4)}createPrimitive(){return new WaveABCPrimitive({id:this.id,points:[],color:"#3D85C6FF",lineWidth:2,showWave:!0,degree:7},...this.resetArgs)}}const WaveABC={type:WaveABCToolType,icon:icon$7,Ctor:WaveABCTool},icon$6=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M5.238 18.469l4.17-4.17-.707-.707-4.17 4.17zM16.47 17.763l-.707.707-4.265-4.265.707-.707zM22.747 13.546l-4.192 4.192.707.707 4.192-4.192z"></path><path fill-rule="nonzero" d="M10.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path d="M13.746 7h-1.258l-.5-1.301h-2.289l-.473 1.301h-1.227l2.23-5.727h1.223l2.293 5.727zm-2.129-2.266l-.789-2.125-.773 2.125h1.563z"></path><path d="M22.582 7v-5.727h4.246v.969h-3.09v1.27h2.875v.965h-2.875v1.559h3.199v.965z"></path></g></svg>
`,WaveABCDEToolType="tool.wave.abcde";class WaveABCDEPrimitive extends Wave5Primitive{labelsGroup(){return[["0","A","B","C","D","E"],["0","a","b","c","d","e"],["0","A","B","C","D","E"],["0","a","b","c","d","e"],["0","A","B","C","D","E"]]}}class WaveABCDETool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",WaveABCDEToolType);Ee(this,"steps",6)}createPrimitive(){return new WaveABCDEPrimitive({id:this.id,points:[],color:"#FF9800FF",lineWidth:2,showWave:!0,degree:7},...this.resetArgs)}}const WaveABCDE={type:WaveABCDEToolType,icon:icon$6,Ctor:WaveABCDETool},icon$5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M5.238 18.469l4.17-4.17-.707-.707-4.17 4.17zM16.47 17.763l-.707.707-4.265-4.265.707-.707zM22.747 13.546l-4.192 4.192.707.707 4.192-4.192z"></path><path fill-rule="nonzero" d="M10.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path d="M8.395 7l-1.367-5.727h1.184l.863 3.934 1.047-3.934h1.375l1.004 4 .879-4h1.164l-1.391 5.727h-1.227l-1.141-4.281-1.137 4.281z"></path><path d="M24.086 7v-2.41l-2.098-3.316h1.355l1.348 2.266 1.32-2.266h1.332l-2.105 3.324v2.402z"></path></g></svg>
`,WaveWXYToolType="tool.wave.wxy";class WaveWXYPrimitive extends Wave3Primitive{labelsGroup(){return[["0","A","B","C"],["0","a","b","c"],["0","A","B","C"],["0","a","b","c"],["0","A","B","C"]]}}class WaveWXYTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",WaveWXYToolType);Ee(this,"steps",4)}createPrimitive(){return new WaveWXYPrimitive({id:this.id,points:[],color:"#6AA84FFF",lineWidth:2,showWave:!0,degree:7},...this.resetArgs)}}const WaveWXY={type:WaveWXYToolType,icon:icon$5,Ctor:WaveWXYTool},icon$4=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor"><path fill-rule="nonzero" d="M5.238 18.469l4.17-4.17-.707-.707-4.17 4.17zM16.47 17.763l-.707.707-4.265-4.265.707-.707zM22.747 13.546l-4.192 4.192.707.707 4.192-4.192z"></path><path fill-rule="nonzero" d="M10.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM17.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM24.5 14c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5zM3.5 21c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z"></path><path d="M8.395 7l-1.367-5.727h1.184l.863 3.934 1.047-3.934h1.375l1.004 4 .879-4h1.164l-1.391 5.727h-1.227l-1.141-4.281-1.137 4.281z"></path><path d="M22.086 7v-1.043l3.008-3.715h-2.668v-.969h4.191v.898l-3.137 3.863h3.258v.965z"></path></g></svg>
`,WaveWXYXZToolType="tool.wave.wxyxz";class WaveWXYXZPrimitive extends Wave5Primitive{labelsGroup(){return[["0","W","X","Y","X","Z"],["0","w","x","y","x","z"],["0","W","X","Y","X","Z"],["0","w","x","y","x","z"],["0","W","X","Y","X","Z"]]}}class WaveWXYXZTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"type",WaveWXYXZToolType);Ee(this,"steps",6)}createPrimitive(){return new WaveWXYXZPrimitive({id:this.id,points:[],color:"#6AA84FFF",lineWidth:2,showWave:!0,degree:7},...this.resetArgs)}}const WaveWXYXZ={type:WaveWXYXZToolType,icon:icon$4,Ctor:WaveWXYXZTool},Arrows={name:"toolGroup.arrow",items:[ArrowMarker,ArrowArrow,ArrowMarkUp,ArrowMarkDown,ArrowMarkLeft,ArrowMarkRight]},Brushs={name:"toolGroup.brush",items:[BrushBrush,BrushHighlighter]},Channels={name:"toolGroup.channel",items:[channelParallelChannel,channelRegressionTrend,channelFlatTopBottom,channelDisjointChannel]},Contents={name:"toolGroup.content",items:[contentImage]},Cursors={items:[cursorCross,cursorDot,cursorArrow,cursorDemo]},Cycles={name:"toolGroup.cycle",items:[CycleCyclicLines,CycleTimeCycles,CycleSineLine]},Erasers={items:[cursorEraser]},Fibs={name:"toolGroup.fib",items:[fibFibRetracement,fibTrendBasedFibExtension,fibFibChannel,fibFibTimZone,fibFibSpeedResistanceFan,fibTrendBasedFibTime,fibFibCircles,fibFibSpiral,fibFibSpeedResistanceArcs,fibFibWedge,fibPitchfan]},Ganns={name:"toolGroup.gann",items:[gannGannBox,gannGannSquareFixed,gannGannSquare,gannGannFan]},Lines={name:"toolGroup.line",items:[lineTrendLine,lineRay,lineInfoLine,lineExtendedLine,lineTrendAngle,lineHorizontalLine,lineHorizontalRay,lineVerticalLine,lineCrossLine]},Measurers={name:"toolGroup.measurer",items:[MeasurerPriceRange,MeasurerDateRange,MeasurerDateAndPriceRange]},Patterns={name:"toolGroup.pattern",items:[PatternXABCD,PatternCypher,PatternHeadAndShoulders,PatternABCD,PatternTriangle,PatternThreeDrives]},Pitchforks={name:"toolGroup.pitchfork",items:[pitchforkPitchfork,pitchforkSchiffPitchfork,pitchforkModifiedSchiffPitchfork,pitchforkInsidePitchfork]},Projections={name:"toolGroup.proj",items:[ProjectionLongPosition,ProjectionShortPosition,ProjectionForecast,ProjectionBarsPattern,ProjectionGhostFeed,ProjectionProjection]},Shapes={name:"toolGroup.shape",items:[ShapeRectangle,ShapeRotatedRectangle,ShapePath,ShapeCircle,ShapeEllipse,ShapePolyline,ShapeTriangle,ShapeArc,ShapeCurve,ShapeDoubleCurve]},Texts$1={name:"toolGroup.text",items:[TextText,TextAnchoredText,TextNote,TextPriceNote,TextPin,TextPinFixed,{type:"tool.text.table",icon:textTable,disabled:!0},TextCallout,TextComment,TextPriceLabel,TextSignpost,TextFlagMark]},VolumnBaseds={name:"toolGroup.volumn",items:[{type:"tool.volumnBased.anchoredVwap",icon:volumnBasedAnchoredVwap,disabled:!0},{type:"tool.volumnBased.fixedRangeVolumnProfile",icon:volumnBasedFixedRangeVolumnProfile,disabled:!0},{type:"tool.volumnBased.anchoredVolumnProfile",icon:volumnBasedAnchoredVolumnProfile,disabled:!0}]},Waves={name:"toolGroup.wave",items:[Wave12345,WaveABC,WaveABCDE,WaveWXY,WaveWXYXZ]},CursorTools={moreTip:"tool.more.cursor",groups:[Cursors,Erasers]},LineTools={moreTip:"tool.more.trendLine",groups:[Lines,Channels,Pitchforks]},FibAndGannTools={moreTip:"tool.more.gannAndFib",groups:[Fibs,Ganns]},PatternTools={moreTip:"tool.more.pattern",groups:[Patterns,Waves,Cycles]},MeasureTools={moreTip:"tool.more.forecastAndMeasure",groups:[Projections,VolumnBaseds,Measurers]},ShapesTools={moreTip:"tool.more.shapes",groups:[Brushs,Arrows,Shapes]},AnnotationTools={moreTip:"tool.more.annotation",groups:[Texts$1,Contents]};class GradientColorCache{constructor(){Ee(this,"_color1","");Ee(this,"_color2","");Ee(this,"_colors",new Map)}gradientColor(te,ee,ne){if(te===ee)return ee;const re=Math.max(0,Math.min(100,Math.round(ne*100)));(this._color1!==te||this._color2!==ee)&&(this._colors.clear(),this._color1=te,this._color2=ee);let se=this._colors.get(re);return se===void 0&&(se=gradientColorAtPercent(te,ee,re/100),this._colors.set(re,se)),se}}class ToolModel{constructor(te,ee){Ee(this,"_currentPoint",null);Ee(this,"_currentCreating",null);Ee(this,"_currentActive",null);Ee(this,"_hoveredSource",null);Ee(this,"_currentEditing",null);Ee(this,"_pointEditing",null);Ee(this,"_pointCreating",null);Ee(this,"_lastHoveredHittestData",null);Ee(this,"_onFocus",new Emitter);Ee(this,"onFocus",this._onFocus.event);Ee(this,"_onBlur",new Emitter);Ee(this,"onBlur",this._onBlur.event);Ee(this,"_backgroundColorAtYPercentFromTop",new GradientColorCache);this.chartService=te,this.themeService=ee}isDarkTheme(){return this.themeService.isDark()}backgroundColorAtYPercentFromTop(te){const ee=this.chartService.chart.options().layout.background;if(ee.type===Ai.Solid)return ee.color;{const ne=ee.topColor,re=ee.bottomColor;return this._backgroundColorAtYPercentFromTop.gradientColor(ne,re,te)}}get currentCreating(){return this._currentCreating}get currentActive(){return this._currentActive}get currentHovered(){return this._hoveredSource}get pointEditing(){return this._pointEditing}get pointCreating(){return this._pointCreating}get currentEditing(){return this._currentEditing}get currentPoint(){return this._currentPoint}setCurrentPoint(te){this._currentPoint=te}lastHittestData(){return this._lastHoveredHittestData}markPointEditingStarted(te,ee){this._currentEditing=te,this._pointEditing=ee}markPointEditingFinishedOrAborted(){this._currentEditing=null,this._pointEditing=-1}markCreatingStarted(te){this._currentCreating=te}markCreatingPoint(te){this._pointCreating=te}markCreatingFinishedOrAborted(te){this._currentCreating===te&&(this._currentCreating=null,this._pointCreating=null)}setHoveredSource(te,ee){var ne;this._hoveredSource!==te&&((ne=this._hoveredSource)==null||ne.updateHover()),this._lastHoveredHittestData=ee.details??null,te.updateHover(),this._hoveredSource=te}unhover(te){te==null||te.updateHover(),te===this._hoveredSource&&(this._hoveredSource=null),this._lastHoveredHittestData=null}focus(te){var ee;te.disableUserSelection||(te!==this._currentActive&&((ee=this._currentActive)==null||ee.updateActive(!1)),te.updateActive(!0),this._currentActive=te,this._onFocus.fire(te))}blur(te){te==null||te.updateActive(!1),te===this._currentActive&&(this._currentActive&&this._onBlur.fire(this._currentActive),this._currentActive=null)}reset(){const te=this._currentActive;this._currentPoint=null,this._currentCreating=null,this._currentActive=null,this._hoveredSource=null,this._currentEditing=null,this._pointEditing=null,this._pointCreating=null,te&&this._onBlur.fire(te)}isSelected(te){return te===this._currentActive}}const DemoHighlightBackground=getLightenRGBA("#f67782");class PanePrimitive{constructor(te){Ee(this,"_chart");Ee(this,"_requestUpdate");te&&(this._chart=te)}requestUpdate(){this._requestUpdate&&this._requestUpdate()}attached({chart:te,requestUpdate:ee}){this._chart=te,this._requestUpdate=ee,this.requestUpdate()}detached(){this._chart=void 0,this._requestUpdate=void 0}get chart(){return ensure(this._chart)}}class DemoHighlightPaneRenderer{constructor(te){this._data=te}draw(te){te.useBitmapCoordinateSpace(ee=>{const{x:ne,y:re,background:se,radius:ae}=this._data;if(ne<0||re<0)return;const le=ee.context;le.fillStyle=se,le.beginPath(),le.arc(ne*ee.horizontalPixelRatio,re*ee.verticalPixelRatio,ae*ee.horizontalPixelRatio,0,TwoPI,!1),le.fill()})}}class DemoHighlightPaneView{constructor(te){this._data=te}renderer(){return new DemoHighlightPaneRenderer(this._data)}zOrder(){return"top"}update(te){this._data=te}}class DemoHighlightPrimitive extends PanePrimitive{constructor(ee,ne){super();Ee(this,"_paneView");this._data=ee,this.detach=ne,this._paneView=[new DemoHighlightPaneView(ee)]}updateData(ee){Object.assign(this._data,ee),this.updateAllViews(),this.requestUpdate()}paneViews(){return this._paneView}updateAllViews(){this._paneView.forEach(ee=>ee.update(this._data))}}const icon$3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M4.05 14a9.95 9.95 0 1 1 19.9 0 9.95 9.95 0 0 1-19.9 0ZM14 3a11 11 0 1 0 0 22 11 11 0 0 0 0-22Zm-3 13.03a.5.5 0 0 1 .64.3 2.5 2.5 0 0 0 4.72 0 .5.5 0 0 1 .94.34 3.5 3.5 0 0 1-6.6 0 .5.5 0 0 1 .3-.64Zm.5-4.53a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm5 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"></path></svg>
`;/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var twemoji=function(){var ie={base:"https://twemoji.maxcdn.com/v/14.0.2/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:We,toCodePoint:Ze},onerror:function(){this.parentNode&&this.parentNode.replaceChild(ce(this.alt,!1),this)},parse:je,replace:Ue,test:Ge},te={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},ee=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef0-\udef6]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedd-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7c\ude80-\ude86\ude90-\udeac\udeb0-\udeba\udec0-\udec2\uded0-\uded9\udee0-\udee7]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,ne=/\uFE0F/g,re="‍",se=/[&<>'"]/g,ae=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,le=String.fromCharCode;return ie;function ce(Ye,qe){return document.createTextNode(qe?Ye.replace(ne,""):Ye)}function he(Ye){return Ye.replace(se,Ne)}function fe(Ye,qe){return"".concat(qe.base,qe.size,"/",Ye,qe.ext)}function Ae(Ye,qe){for(var nr=Ye.childNodes,ir=nr.length,tr,or;ir--;)tr=nr[ir],or=tr.nodeType,or===3?qe.push(tr):or===1&&!("ownerSVGElement"in tr)&&!ae.test(tr.nodeName.toLowerCase())&&Ae(tr,qe);return qe}function pe(Ye){return Ze(Ye.indexOf(re)<0?Ye.replace(ne,""):Ye)}function Oe(Ye,qe){for(var nr=Ae(Ye,[]),ir=nr.length,tr,or,Jt,rr,lr,ur,Sr,xr,Pr,mr,Er,dr,Cr;ir--;){for(Jt=!1,rr=document.createDocumentFragment(),lr=nr[ir],ur=lr.nodeValue,xr=0;Sr=ee.exec(ur);){if(Pr=Sr.index,Pr!==xr&&rr.appendChild(ce(ur.slice(xr,Pr),!0)),Er=Sr[0],dr=pe(Er),xr=Pr+Er.length,Cr=qe.callback(dr,qe),dr&&Cr){mr=new Image,mr.onerror=qe.onerror,mr.setAttribute("draggable","false"),tr=qe.attributes(Er,dr);for(or in tr)tr.hasOwnProperty(or)&&or.indexOf("on")!==0&&!mr.hasAttribute(or)&&mr.setAttribute(or,tr[or]);mr.className=qe.className,mr.alt=Er,mr.src=Cr,Jt=!0,rr.appendChild(mr)}mr||rr.appendChild(ce(Er,!1)),mr=null}Jt&&(xr<ur.length&&rr.appendChild(ce(ur.slice(xr),!0)),lr.parentNode.replaceChild(rr,lr))}return Ye}function Fe(Ye,qe){return Ue(Ye,function(nr){var ir=nr,tr=pe(nr),or=qe.callback(tr,qe),Jt,rr;if(tr&&or){ir="<img ".concat('class="',qe.className,'" ','draggable="false" ','alt="',nr,'"',' src="',or,'"'),Jt=qe.attributes(nr,tr);for(rr in Jt)Jt.hasOwnProperty(rr)&&rr.indexOf("on")!==0&&ir.indexOf(" "+rr+"=")===-1&&(ir=ir.concat(" ",rr,'="',he(Jt[rr]),'"'));ir=ir.concat("/>")}return ir})}function Ne(Ye){return te[Ye]}function ze(){return null}function He(Ye){return typeof Ye=="number"?Ye+"x"+Ye:Ye}function We(Ye){var qe=typeof Ye=="string"?parseInt(Ye,16):Ye;return qe<65536?le(qe):(qe-=65536,le(55296+(qe>>10),56320+(qe&1023)))}function je(Ye,qe){return(!qe||typeof qe=="function")&&(qe={callback:qe}),(typeof Ye=="string"?Fe:Oe)(Ye,{callback:qe.callback||fe,attributes:typeof qe.attributes=="function"?qe.attributes:ze,base:typeof qe.base=="string"?qe.base:ie.base,ext:qe.ext||ie.ext,size:qe.folder||He(qe.size||ie.size),className:qe.className||ie.className,onerror:qe.onerror||ie.onerror})}function Ue(Ye,qe){return String(Ye).replace(ee,qe)}function Ge(Ye){ee.lastIndex=0;var qe=ee.test(Ye);return ee.lastIndex=0,qe}function Ze(Ye,qe){for(var nr=[],ir=0,tr=0,or=0;or<Ye.length;)ir=Ye.charCodeAt(or++),tr?(nr.push((65536+(tr-55296<<10)+(ir-56320)).toString(16)),tr=0):55296<=ir&&ir<=56319?tr=ir:nr.push(ir.toString(16));return nr.join(qe||"-")}}();const Icons$1=[{title:"tool.emoji.group.smiles&people",icons:["😀","😃","😄","😁","😆","😅","😂","🤣","☺️","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😛","😝","😜","🤪","🤨","🧐","🤓","😎","🤩","🥳","😏","😒","😞","😔","😟","😕","🙁","☹️","😣","😖","😫","😩","🥺","😢","😭","😤","😠","😡","🤬","🤯","😳","🥵","🥶","😱","😨","😰","😥","😓","🤗","🤔","🤭","🤫","🤥","😶","😐","😑","😬","🙄","😯","😦","😧","😮","😲","🥱","😴","🤤","😪","😵","🤐","🥴","🤢","🤮","🤧","😷","🤒","🤕","🤑","🤠","😈","👿","👹","👺","🤡","💩","👻","💀","☠️","👽","👾","🤖","🎃","😺","😸","😹","😻","😼","😽","🙀","😿","😾","👋","🤚","🖐","✋","🖖","👌","🤏","✌️","🤞","🤟","🤘","🤙","👈","👉","👆","🖕","👇","☝️","👍","👎","✊","👊","🤛","🤜","👏","🙌","👐","🤲","🤝","🙏","✍️","💅","🤳","💪","🦾","🦵","🦿","🦶","👂","🦻","👃","🧠","🦷","🦴","👀","👁","👅","👄","💋","🩸","👶","🧒","👦","👧","🧑","👱","👨","🧔","👨‍🦰","👨‍🦱","👨‍🦳","👨‍🦲","👩","👩‍🦰","🧑‍🦰","👩‍🦱","🧑‍🦱","👩‍🦳","🧑‍🦳","👩‍🦲","🧑‍🦲","👱‍♀️","👱‍♂️","🧓","👴","👵","🙍","🙍‍♂️","🙍‍♀️","🙎","🙎‍♂️","🙎‍♀️","🙅","🙅‍♂️","🙅‍♀️","🙆","🙆‍♂️","🙆‍♀️","💁","💁‍♂️","💁‍♀️","🙋","🙋‍♂️","🙋‍♀️","🧏","🧏‍♂️","🧏‍♀️","🙇","🙇‍♂️","🙇‍♀️","🤦","🤦‍♂️","🤦‍♀️","🤷","🤷‍♂️","🤷‍♀️","🧑‍⚕️","👨‍⚕️","👩‍⚕️","🧑‍🎓","👨‍🎓","👩‍🎓","🧑‍🏫","👨‍🏫","👩‍🏫","🧑‍⚖️","👨‍⚖️","👩‍⚖️","🧑‍🌾","👨‍🌾","👩‍🌾","🧑‍🍳","👨‍🍳","👩‍🍳","🧑‍🔧","👨‍🔧","👩‍🔧","🧑‍🏭","👨‍🏭","👩‍🏭","🧑‍💼","👨‍💼","👩‍💼","🧑‍🔬","👨‍🔬","👩‍🔬","🧑‍💻","👨‍💻","👩‍💻","🧑‍🎤","👨‍🎤","👩‍🎤","🧑‍🎨","👨‍🎨","👩‍🎨","🧑‍✈️","👨‍✈️","👩‍✈️","🧑‍🚀","👨‍🚀","👩‍🚀","🧑‍🚒","👨‍🚒","👩‍🚒","👮","👮‍♂️","👮‍♀️","🕵","🕵️‍♂️","🕵️‍♀️","💂","💂‍♂️","💂‍♀️","👷","👷‍♂️","👷‍♀️","🤴","👸","👳","👳‍♂️","👳‍♀️","👲","🧕","🤵","👰","🤰","🤱","👼","🎅","🤶","🦸","🦸‍♂️","🦸‍♀️","🦹","🦹‍♂️","🦹‍♀️","🧙","🧙‍♂️","🧙‍♀️","🧚","🧚‍♂️","🧚‍♀️","🧛","🧛‍♂️","🧛‍♀️","🧜","🧜‍♂️","🧜‍♀️","🧝","🧝‍♂️","🧝‍♀️","🧞","🧞‍♂️","🧞‍♀️","🧟","🧟‍♂️","🧟‍♀️","💆","💆‍♂️","💆‍♀️","💇","💇‍♂️","💇‍♀️","🚶","🚶‍♂️","🚶‍♀️","🧍","🧍‍♂️","🧍‍♀️","🧎","🧎‍♂️","🧎‍♀️","🧑‍🦯","👨‍🦯","👩‍🦯","🧑‍🦼","👨‍🦼","👩‍🦼","🧑‍🦽","👨‍🦽","👩‍🦽","🏃","🏃‍♂️","🏃‍♀️","💃","🕺","🕴","👯","👯‍♂️","👯‍♀️","🧖","🧖‍♂️","🧖‍♀️","🧑‍🤝‍🧑","👭","👫","👬","💏","👨‍❤️‍💋‍👨","👩‍❤️‍💋‍👩","💑","👨‍❤️‍👨","👩‍❤️‍👩","👪","👨‍👩‍👦","👨‍👩‍👧","👨‍👩‍👧‍👦","👨‍👩‍👦‍👦","👨‍👩‍👧‍👧","👨‍👨‍👦","👨‍👨‍👧","👨‍👨‍👧‍👦","👨‍👨‍👦‍👦","👨‍👨‍👧‍👧","👩‍👩‍👦","👩‍👩‍👧","👩‍👩‍👧‍👦","👩‍👩‍👦‍👦","👩‍👩‍👧‍👧","👨‍👦","👨‍👦‍👦","👨‍👧","👨‍👧‍👦","👨‍👧‍👧","👩‍👦","👩‍👦‍👦","👩‍👧","👩‍👧‍👦","👩‍👧‍👧","🗣","👤","👥","👣"]},{title:"tool.emoji.group.animals&nature",icons:["🐶","🐱","🐭","🐹","🐰","🦊","🐻","🐼","🐨","🐯","🦁","🐮","🐷","🐽","🐸","🐵","🙈","🙉","🙊","🐒","🐔","🐧","🐦","🐤","🐣","🐥","🦆","🦅","🦉","🦇","🐺","🐗","🐴","🦄","🐝","🐛","🦋","🐌","🐞","🐜","🦟","🦗","🕷","🕸","🦂","🐢","🐍","🦎","🦖","🦕","🐙","🦑","🦐","🦞","🦀","🐡","🐠","🐟","🐬","🐳","🐋","🦈","🐊","🐅","🐆","🦓","🦍","🦧","🐘","🦛","🦏","🐪","🐫","🦒","🦘","🐃","🐂","🐄","🐎","🐖","🐏","🐑","🦙","🐐","🦌","🐕","🐩","🦮","🐕‍🦺","🐈","🐓","🦃","🦚","🦜","🦢","🦩","🕊","🐇","🦝","🦨","🦡","🦦","🦥","🐁","🐀","🐿","🦔","🐾","🐉","🐲","🌵","🎄","🌲","🌳","🌴","🌱","🌿","☘️","🍀","🎍","🎋","🍃","🍂","🍁","🍄","🐚","🌾","💐","🌷","🌹","🥀","🌺","🌸","🌼","🌻","🌞","🌝","🌛","🌜","🌚","🌕","🌖","🌗","🌘","🌑","🌒","🌓","🌔","🌙","🌎","🌍","🌏","🪐","💫","⭐️","🌟","✨","⚡️","☄️","💥","🔥","🌪","🌈","☀️","🌤","⛅️","🌥","☁️","🌦","🌧","⛈","🌩","🌨","❄️","☃️","⛄️","🌬","💨","💧","💦","☔️","🌊","🌫"]},{title:"tool.emoji.group.food&drink",icons:["🍏","🍎","🍐","🍊","🍋","🍌","🍉","🍇","🍓","🍈","🍒","🍑","🥭","🍍","🥥","🥝","🍅","🍆","🥑","🥦","🥬","🥒","🌶","🌽","🥕","🧄","🧅","🥔","🍠","🥐","🥯","🍞","🥖","🥨","🧀","🥚","🍳","🧈","🥞","🧇","🥓","🥩","🍗","🍖","🌭","🍔","🍟","🍕","🥪","🥙","🧆","🌮","🌯","🥗","🥘","🥫","🍝","🍜","🍲","🍛","🍣","🍱","🥟","🦪","🍤","🍙","🍚","🍘","🍥","🥠","🥮","🍢","🍡","🍧","🍨","🍦","🥧","🧁","🍰","🎂","🍮","🍭","🍬","🍫","🍿","🍩","🍪","🌰","🥜","🍯","🥛","🍼","☕️","🍵","🧃","🥤","🍶","🍺","🍻","🥂","🍷","🥃","🍸","🍹","🧉","🍾","🧊","🥄","🍴","🍽","🥣","🥡","🥢","🧂"]},{title:"tool.emoji.group.activity",icons:["⚽️","🏀","🏈","⚾️","🥎","🎾","🏐","🏉","🥏","🎱","🪀","🏓","🏸","🏒","🏑","🥍","🏏","🥅","⛳️","🪁","🏹","🎣","🤿","🥊","🥋","🎽","🛹","🛷","⛸","🥌","🎿","⛷","🏂","🪂","🏋️","🏋️‍♂️","🏋️‍♀️","🤼","🤼‍♂️","🤼‍♀️","🤸‍♀️","🤸","🤸‍♂️","⛹️","⛹️‍♂️","⛹️‍♀️","🤺","🤾","🤾‍♂️","🤾‍♀️","🏌️","🏌️‍♂️","🏌️‍♀️","🏇","🧘","🧘‍♂️","🧘‍♀️","🏄","🏄‍♂️","🏄‍♀️","🏊","🏊‍♂️","🏊‍♀️","🤽","🤽‍♂️","🤽‍♀️","🚣","🚣‍♂️","🚣‍♀️","🧗","🧗‍♂️","🧗‍♀️","🚵","🚵‍♂️","🚵‍♀️","🚴","🚴‍♂️","🚴‍♀️","🏆","🥇","🥈","🥉","🏅","🎖","🏵","🎗","🎫","🎟","🎪","🤹","🤹‍♂️","🤹‍♀️","🎭","🎨","🎬","🎤","🎧","🎼","🎹","🥁","🎷","🎺","🎸","🪕","🎻","🎲","🎯","🎳","🎮","🎰","🧩"]},{title:"tool.emoji.group.travel&places",icons:["🚗","🚕","🚙","🚌","🚎","🏎","🚓","🚑","🚒","🚐","🚚","🚛","🚜","🦯","🦽","🦼","🛴","🚲","🛵","🏍","🛺","🚨","🚔","🚍","🚘","🚖","🚡","🚠","🚟","🚃","🚋","🚞","🚝","🚄","🚅","🚈","🚂","🚆","🚇","🚊","🚉","✈️","🛫","🛬","🛩","💺","🛰","🚀","🛸","🚁","🛶","⛵️","🚤","🛥","🛳","⛴","🚢","⚓️","⛽️","🚧","🚦","🚥","🚏","🗺","🗿","🗽","🗼","🏰","🏯","🏟","🎡","🎢","🎠","⛲️","⛱","🏖","🏝","🏜","🌋","⛰","🏔","🗻","🏕","⛺️","🏠","🏡","🏘","🏚","🏗","🏭","🏢","🏬","🏣","🏤","🏥","🏦","🏨","🏪","🏫","🏩","💒","🏛","⛪️","🕌","🕍","🛕","🕋","⛩","🛤","🛣","🗾","🎑","🏞","🌅","🌄","🌠","🎇","🎆","🌇","🌆","🏙","🌃","🌌","🌉","🌁"]},{title:"tool.emoji.group.objects",icons:["⌚️","📱","📲","💻","⌨️","🖥","🖨","🖱","🖲","🕹","🗜","💽","💾","💿","📀","📼","📷","📸","📹","🎥","📽","🎞","📞","☎️","📟","📠","📺","📻","🎙","🎚","🎛","🧭","⏱","⏲","⏰","🕰","⌛️","⏳","📡","🔋","🔌","💡","🔦","🕯","🪔","🧯","🛢","💸","💵","💴","💶","💷","💰","💳","💎","⚖️","🧰","🔧","🔨","⚒","🛠","⛏","🔩","⚙️","🧱","⛓","🧲","🔫","💣","🧨","🪓","🔪","🗡","⚔️","🛡","🚬","⚰️","⚱️","🏺","🔮","📿","🧿","💈","⚗️","🔭","🔬","🕳","🩹","🩺","💊","💉","🧬","🦠","🧫","🧪","🌡","🧹","🧺","🧻","🚽","🚰","🚿","🛁","🛀","🧼","🪒","🧽","🧴","🛎","🔑","🗝","🚪","🪑","🛋","🛏","🛌","🧸","🖼","🛍","🛒","🎁","🎈","🎏","🎀","🎊","🎉","🎎","🏮","🎐","🧧","✉️","📩","📨","📧","💌","📥","📤","📦","🏷","📪","📫","📬","📭","📮","📯","📜","📃","📄","📑","🧾","📊","📈","📉","🗒","🗓","📆","📅","🗑","📇","🗃","🗳","🗄","📋","📁","📂","🗂","🗞","📰","📓","📔","📒","📕","📗","📘","📙","📚","📖","🔖","🧷","🔗","📎","🖇","📐","📏","🧮","📌","📍","✂️","🖊","🖋","✒️","🖌","🖍","📝","✏️","🔍","🔎","🔏","🔐","🔒","🔓","🧳","🌂","☂️","🧵","🧶","👓","🕶","🥽","🥼","🦺","👔","👕","👖","🧣","🧤","🧥","🧦","👗","👘","🥻","🩱","🩲","🩳","👙","👚","👛","👜","👝","🎒","👞","👟","🥾","🥿","👠","👡","🩰","👢","👑","👒","🎩","🎓","🧢","⛑","💄","💍","💼"]},{title:"tool.emoji.group.symbols",icons:["❤️","🧡","💛","💚","💙","💜","🖤","🤍","🤎","💔","❣️","💕","💞","💓","💗","💖","💘","💝","💟","☮️","✝️","☪️","🕉","☸️","✡️","🔯","🕎","☯️","☦️","🛐","⛎","♈️","♉️","♊️","♋️","♌️","♍️","♎️","♏️","♐️","♑️","♒️","♓️","🆔","⚛️","🉑","☢️","☣️","📴","📳","🈶","🈚️","🈸","🈺","🈷️","✴️","🆚","💮","🉐","㊙️","㊗️","🈴","🈵","🈹","🈲","🅰️","🅱️","🆎","🆑","🅾️","🆘","❌","⭕️","🛑","⛔️","📛","🚫","💯","💢","♨️","🚷","🚯","🚳","🚱","🔞","📵","🚭","❗️","❕","❓","❔","‼️","⁉️","🔅","🔆","〽️","⚠️","🚸","🔱","⚜️","🔰","♻️","✅","🈯️","💹","❇️","✳️","❎","🌐","💠","Ⓜ️","🌀","💤","🏧","🚾","♿️","🅿️","🈳","🈂️","🛂","🛃","🛄","🛅","🚹","🚺","🚼","🚻","🚮","🎦","📶","🈁","🔣","ℹ️","🔤","🔡","🔠","🆖","🆗","🆙","🆒","🆕","🆓","0️⃣","1️⃣","2️⃣","3️⃣","4️⃣","5️⃣","6️⃣","7️⃣","8️⃣","9️⃣","🔟","🔢","#️⃣","*️⃣","⏏️","▶️","⏸","⏯","⏹","⏺","⏭","⏮","⏩","⏪","⏫","⏬","◀️","🔼","🔽","➡️","⬅️","⬆️","⬇️","↗️","↘️","↙️","↖️","↕️","↔️","↪️","↩️","⤴️","⤵️","🔀","🔁","🔂","🔄","🔃","🎵","🎶","➕","➖","➗","✖️","♾","💲","💱","™️","©️","®️","〰️","➰","➿","🔚","🔙","🔛","🔝","🔜","✔️","☑️","🔘","🔴","🟠","🟡","🟢","🔵","🟣","⚫️","⚪️","🟤","🔺","🔻","🔸","🔹","🔶","🔷","🔳","🔲","▪️","▫️","◾️","◽️","◼️","◻️","🟥","🟧","🟨","🟩","🟦","🟪","⬛️","⬜️","🟫","🔈","🔇","🔉","🔊","🔔","🔕","📣","📢","👁‍🗨","💬","💭","🗯","♠️","♣️","♥️","♦️","🃏","🎴","🀄️","🕐","🕑","🕒","🕓","🕔","🕕","🕖","🕗","🕘","🕙","🕚","🕛","🕜","🕝","🕞","🕟","🕠","🕡","🕢","🕣","🕤","🕥","🕦","🕧"]},{title:"tool.emoji.group.flags",icons:["🏳️","🏴","🏁","🚩","🏳️‍🌈","🏴‍☠️","🇦🇫","🇦🇽","🇦🇱","🇩🇿","🇦🇸","🇦🇩","🇦🇴","🇦🇮","🇦🇶","🇦🇬","🇦🇷","🇦🇲","🇦🇼","🇦🇺","🇦🇹","🇦🇿","🇧🇸","🇧🇭","🇧🇩","🇧🇧","🇧🇾","🇧🇪","🇧🇿","🇧🇯","🇧🇲","🇧🇹","🇧🇴","🇧🇦","🇧🇼","🇧🇷","🇮🇴","🇻🇬","🇧🇳","🇧🇬","🇧🇫","🇧🇮","🇰🇭","🇨🇲","🇨🇦","🇮🇨","🇨🇻","🇧🇶","🇰🇾","🇨🇫","🇹🇩","🇨🇱","🇨🇳","🇨🇽","🇨🇨","🇨🇴","🇰🇲","🇨🇬","🇨🇩","🇨🇰","🇨🇷","🇨🇮","🇭🇷","🇨🇺","🇨🇼","🇨🇾","🇨🇿","🇩🇰","🇩🇯","🇩🇲","🇩🇴","🇪🇨","🇪🇬","🇸🇻","🇬🇶","🇪🇷","🇪🇪","🇪🇹","🇪🇺","🇫🇰","🇫🇴","🇫🇯","🇫🇮","🇫🇷","🇬🇫","🇵🇫","🇹🇫","🇬🇦","🇬🇲","🇬🇪","🇩🇪","🇬🇭","🇬🇮","🇬🇷","🇬🇱","🇬🇩","🇬🇵","🇬🇺","🇬🇹","🇬🇬","🇬🇳","🇬🇼","🇬🇾","🇭🇹","🇭🇳","🇭🇰","🇭🇺","🇮🇸","🇮🇳","🇮🇩","🇮🇷","🇮🇶","🇮🇪","🇮🇲","🇮🇱","🇮🇹","🇯🇲","🇯🇵","🎌","🇯🇪","🇯🇴","🇰🇿","🇰🇪","🇰🇮","🇽🇰","🇰🇼","🇰🇬","🇱🇦","🇱🇻","🇱🇧","🇱🇸","🇱🇷","🇱🇾","🇱🇮","🇱🇹","🇱🇺","🇲🇴","🇲🇰","🇲🇬","🇲🇼","🇲🇾","🇲🇻","🇲🇱","🇲🇹","🇲🇭","🇲🇶","🇲🇷","🇲🇺","🇾🇹","🇲🇽","🇫🇲","🇲🇩","🇲🇨","🇲🇳","🇲🇪","🇲🇸","🇲🇦","🇲🇿","🇲🇲","🇳🇦","🇳🇷","🇳🇵","🇳🇱","🇳🇨","🇳🇿","🇳🇮","🇳🇪","🇳🇬","🇳🇺","🇳🇫","🇰🇵","🇲🇵","🇳🇴","🇴🇲","🇵🇰","🇵🇼","🇵🇸","🇵🇦","🇵🇬","🇵🇾","🇵🇪","🇵🇭","🇵🇳","🇵🇱","🇵🇹","🇵🇷","🇶🇦","🇷🇪","🇷🇴","🇷🇺","🇷🇼","🇼🇸","🇸🇲","🇸🇦","🇸🇳","🇷🇸","🇸🇨","🇸🇱","🇸🇬","🇸🇽","🇸🇰","🇸🇮","🇬🇸","🇸🇧","🇸🇴","🇿🇦","🇰🇷","🇸🇸","🇪🇸","🇱🇰","🇧🇱","🇸🇭","🇰🇳","🇱🇨","🇵🇲","🇻🇨","🇸🇩","🇸🇷","🇸🇿","🇸🇪","🇨🇭","🇸🇾","🇹🇼","🇹🇯","🇹🇿","🇹🇭","🇹🇱","🇹🇬","🇹🇰","🇹🇴","🇹🇹","🇹🇳","🇹🇷","🇹🇲","🇹🇨","🇹🇻","🇻🇮","🇺🇬","🇺🇦","🇦🇪","🇬🇧","🏴󠁧󠁢󠁥󠁮󠁧󠁿","🏴󠁧󠁢󠁳󠁣󠁴󠁿","🏴󠁧󠁢󠁷󠁬󠁳󠁿","🇺🇳","🇺🇸","🇺🇾","🇺🇿","🇻🇺","🇻🇦","🇻🇪","🇻🇳","🇼🇫","🇪🇭","🇾🇪","🇿🇲","🇿🇼"]}],EmojiToolType="tool.emoji",base="https://cdnjs.cloudflare.com/ajax/libs/twemoji/13.0.1/";function getTwemojiUrl(ie,te){let ee="";return twemoji.parse(ie,ne=>(ee=`${base}${te==="svg"?"svg":"72x72"}/${ne}.${te==="svg"?"svg":"png"}`,!1)),ee}class SvgIconTool extends DrawingTool{constructor(){super(...arguments);Ee(this,"steps",1)}}class SvgIconPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines");Ee(this,"_timeAxisViews",[new TimeLabelTimeAxisView(Object.create(null))]);Ee(this,"_priceAxisViews",[new PriceLabelPriceAxisView(Object.create(null))]);Ee(this,"_changePointData",null)}startChanging(ee,ne){const re=this.pointToScreenPoint(this.controlPoints[0]),se=this.properties(),ae=se.size;let le;if(ne)le=this.pointToScreenPoint(ne);else{const he=new Point(0,Math.max(80,ae)/2),fe=se.angle,Ae=rotationMatrix(fe),pe=transformPoint(Ae,he);le=re.add(pe)}const ce=re.subtract(le).length();this._changePointData={centerPoint:re,initialLength:ce,initialSize:ae}}setPoint(ee,ne){const{centerPoint:re,initialLength:se,initialSize:ae}=ensure(this._changePointData),le=this.pointToScreenPoint(ne),ce=this.properties();if(ee===0||ee===1){const he=le.subtract(re).normalized();let fe=Math.acos(-he.x);Math.asin(he.y)>0&&(fe=2*Math.PI-fe),ee===0&&(fe+=Math.PI),ce.angle=fe}else{const he=re.subtract(le).length()/se,fe=ae*he;ce.size=fe}}updateAllViews(){if(!this.controlPoints.length)return;const ee=[];this.controlPoints.forEach((ne,re)=>{const se=this.pointToScreenPoint(ne),ae=new AnchorPoint(se,{pointIndex:re,hitTarget:HitTarget.ChangePoint});ee.push(ae),this._timeAxisViews[re].update(this._calculateTimeAxisViewData(ne.time,se.x)),this._priceAxisViews[re].update(this._calculatePriceAxisViewData(ne.price,se.y))}),this._lines.update({points:ee})}}class SvgIconRenderer extends MediaCoordinatesPaneRenderer{drawImpl(te){if(this._data===null)return;const{size:ee,svg:ne,point:re,angle:se,color:ae,background:le,selected:ce}=this._data,he=te.context;he.translate(re.x,re.y);const fe=se-Math.PI/2;he.rotate(fe);const Ae=ee/2;ce&&(he.fillStyle=le,he.strokeStyle="#1E53E5",he.beginPath(),he.rect(-Ae,-Ae,ee,ee),he.closePath(),he.fill(),he.stroke()),ne&&(he.translate(-Ae,-Ae),ae!==null&&(he.fillStyle=ae),ne.render(he,{targetViewBox:{x:0,y:0,width:ee,height:ee},doNotApplyColors:ae!==null}))}hitTest(te){if(this._data===null)return null;const{size:ee,angle:ne,point:re}=this._data,se=rotationMatrix(-ne),ae=transformPoint(se,te.subtract(re)),le=ee/2;return Math.abs(ae.x)<=le&&Math.abs(ae.y)<=le?new HitTestResult(HitTarget.MovePoint):null}isOutOfScreen(te,ee){if(this._data===null)return!0;const{size:ne,point:re,angle:se}=this._data;let ae;return se%(Math.PI/2)===0?ae=ne/2:ae=Math.sqrt(ne**2*2)/2,re.x+ae<0||re.x-ae>ee||re.y+ae<0||re.y-ae>te}}class SvgIconPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector));Ee(this,"_iconRenderer",new SvgIconRenderer);Ee(this,"_svgRenderer")}renderer(){return this._renderer}_updateImpl(){if(this._renderer.clear(),this.points().length<1)return;const ee=this._source.properties(),ne=ee.size,re=ee.angle,se=this.areAnchorsVisible();this._svgRenderer||(this._svgRenderer=svgRenderer(ee.icon));const ae={point:this.points()[0],color:this._iconColor(),background:this._calculateBackgroundColor(),svg:this._svgRenderer,size:ne,angle:re,selected:se};this._iconRenderer.setData(ae);const le=this._source.getScope(),{mediaSize:{width:ce,height:he}}=le;this._iconRenderer.isOutOfScreen(he,ce)||this._renderer.append(this._iconRenderer);const[fe]=this.points(),pe=Math.max(80,ne)/2;let Oe=new Point(pe,0),Fe=new Point(0,pe);const Ne=rotationMatrix(re);Oe=transformPoint(Ne,Oe),Fe=transformPoint(Ne,Fe);const ze=fe.add(Oe),He=fe.subtract(Oe),We=fe.add(Fe),je=fe.subtract(Fe),Ue=thirdPointCursorType(ze,He),Ge=[new AnchorPoint(ze,{pointIndex:0}),new AnchorPoint(He,{pointIndex:1}),new AnchorPoint(We,{pointIndex:2,cursorType:Ue,style:AnchorStyle.square}),new AnchorPoint(je,{pointIndex:3,cursorType:Ue,style:AnchorStyle.square})],Ze=this.createLineAnchor({points:Ge},0);this._renderer.append(Ze)}_calculateBackgroundColor(){return generateColor(this._model.backgroundColorAtYPercentFromTop(this.points()[0].y/this._source.series.getPane().getHeight()),60,!0)}}class EmojiPaneView extends SvgIconPaneView{_iconColor(){return null}}class EmojiPrimitive extends SvgIconPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new EmojiPaneView(this,this.model));Ee(this,"_paneView",[this._lines])}}class EmojiTool extends SvgIconTool{constructor(){super(...arguments);Ee(this,"type",EmojiToolType)}createPrimitive(){var ee;return new EmojiPrimitive({id:this.id,points:[],size:40,icon:ensure((ee=this.presetProps)==null?void 0:ee.icon),angle:.5*Math.PI},...this.resetArgs)}}const iconEmoji={type:EmojiToolType,icon:icon$3,Ctor:EmojiTool},icon$2=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M24.13 14.65a6.2 6.2 0 0 0-.46-9.28c-2.57-2.09-6.39-1.71-8.75.6l-.92.91-.92-.9c-2.36-2.32-6.18-2.7-8.75-.61a6.2 6.2 0 0 0-.46 9.28l9.07 8.92c.58.57 1.53.57 2.12 0l9.07-8.92Zm-9.77 8.2 9.07-8.91a5.2 5.2 0 0 0-.39-7.8c-2.13-1.73-5.38-1.45-7.42.55L14 8.29l-1.62-1.6c-2.03-2-5.29-2.28-7.42-.55a5.2 5.2 0 0 0-.4 7.8l9.08 8.91c.2.2.52.2.72 0Z"></path></svg>
`,Icons=[{title:"tool.icon.group.gestures&smileys",icons:['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.84 13.2c.34-.58.54-1.2.54-1.95a3.4 3.4 0 0 0-3.36-3.34H16.6c.19-.5.34-1.1.34-1.82 0-2.84-1.47-4.09-3.72-4.09-2.4 0-2.27 3.7-2.8 4.24-.89.9-1.94 2.6-2.69 3.26H3.87c-.69 0-1.25.56-1.25 1.25v9.38c0 .69.56 1.25 1.25 1.25h2.5c.59 0 1.08-.4 1.22-.94 1.73.04 2.93 1.56 6.94 1.56h.87c3.01 0 4.37-1.54 4.41-3.72.52-.72.8-1.69.68-2.62.38-.72.53-1.58.35-2.46Zm-2.41 2.1c.49.83.05 1.93-.55 2.25.3 1.9-.69 2.57-2.07 2.57h-1.48c-2.8 0-4.61-1.47-6.7-1.47v-7.27h.42c1.1 0 2.66-2.77 3.7-3.81 1.1-1.11.73-2.96 1.47-3.7 1.85 0 1.85 1.3 1.85 2.22 0 1.53-1.11 2.22-1.11 3.7h4.06c.83 0 1.48.73 1.48 1.47s-.5 1.48-.87 1.48c.53.57.64 1.77-.2 2.56ZM6.06 18.87a.94.94 0 1 1-1.87 0 .94.94 0 0 1 1.87 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.84 10.8c.18-.88.03-1.74-.35-2.46.11-.93-.16-1.9-.68-2.62C19.77 3.54 18.41 2 15.4 2h-.87c-4.05 0-5.3 1.56-6.9 1.56H7.2c-.22-.2-.5-.31-.83-.31h-2.5c-.69 0-1.25.56-1.25 1.25v9.38c0 .69.56 1.24 1.25 1.24h2.5c.47 0 .87-.25 1.09-.62h.27c.75.66 1.8 2.37 2.69 3.26.53.53.4 4.24 2.8 4.24 2.25 0 3.72-1.25 3.72-4.1 0-.71-.15-1.3-.34-1.8h1.42a3.4 3.4 0 0 0 3.36-3.35c0-.75-.2-1.37-.54-1.95ZM5.13 13.56a.94.94 0 1 1 0-1.87.94.94 0 0 1 0 1.87Zm12.9.66h-4.07c0 1.47 1.1 2.16 1.1 3.69 0 .93 0 2.21-1.84 2.21-.74-.73-.37-2.58-1.48-3.69-1.03-1.04-2.58-3.8-3.69-3.8h-.43V5.34c2.1 0 3.91-1.47 6.71-1.47h1.48c1.38 0 2.37.66 2.07 2.57.6.32 1.04 1.42.55 2.25.84.8.73 2 .2 2.56.37 0 .87.74.87 1.48s-.65 1.48-1.48 1.48Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6.06 10.75H2.94a.94.94 0 0 0-.94.94v9.37c0 .52.42.94.94.94h3.12c.52 0 .94-.42.94-.94V11.7a.94.94 0 0 0-.94-.94ZM4.5 20.44a.94.94 0 1 1 0-1.88.94.94 0 0 1 0 1.88ZM17 5.18c0 1.66-1.01 2.59-1.3 3.7h3.97c1.3 0 2.32 1.08 2.33 2.26 0 .7-.3 1.46-.76 1.93.38.91.32 2.19-.37 3.1.34 1.02 0 2.26-.64 2.92.17.7.09 1.28-.24 1.75-.8 1.14-2.77 1.16-4.44 1.16h-.11c-1.89 0-3.43-.69-4.67-1.24a6.15 6.15 0 0 0-2.06-.63.47.47 0 0 1-.46-.47v-8.35c0-.13.05-.25.14-.33 1.55-1.53 2.21-3.15 3.48-4.42.58-.58.79-1.46 1-2.3.17-.73.53-2.26 1.32-2.26.94 0 2.81.31 2.81 3.18Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M2 4.19v9.37c0 .52.42.94.94.94h3.12c.52 0 .94-.42.94-.94V4.2a.94.94 0 0 0-.94-.94H2.94a.94.94 0 0 0-.94.94ZM3.56 12a.94.94 0 1 1 1.88 0 .94.94 0 0 1-1.88 0ZM14.2 22c-.8 0-1.15-1.53-1.33-2.26-.2-.84-.41-1.72-.99-2.3-1.27-1.27-1.93-2.89-3.48-4.42a.47.47 0 0 1-.14-.33V4.34c0-.26.2-.46.46-.47a6.15 6.15 0 0 0 2.06-.63A11.21 11.21 0 0 1 15.44 2h.1c1.68 0 3.66.02 4.45 1.16.33.47.41 1.06.24 1.75.64.66.98 1.9.64 2.92.69.91.75 2.19.37 3.1.47.47.76 1.22.76 1.93a2.33 2.33 0 0 1-2.33 2.27H15.7c.29 1.1 1.3 2.03 1.3 3.69 0 2.87-1.88 3.18-2.81 3.18Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18.75 7.38h-3.37c.06-.3.09-.59.09-.88 0-1.87-1.37-3.25-3.6-3.25-1.77 0-2.22 1.9-2.95 3.08-.3.48-.67.9-1.01 1.3H7.9c-.6.7-.9.93-1.18.93h-.1c-.23-.2-.53-.31-.87-.31h-2.5c-.69 0-1.25.5-1.25 1.13v9c0 .62.56 1.12 1.25 1.12h2.5c.34 0 .64-.12.86-.31h.1c1.13 0 2.63 1.56 4.98 1.56h.83c2.44 0 3.86-1.51 3.9-3.56.5-.7.73-1.6.63-2.45.14-.28.24-.57.3-.87h1.4A3.27 3.27 0 0 0 22 10.63a3.3 3.3 0 0 0-3.25-3.26Zm0 4.62h-3.56c.5.57.57 1.67-.19 2.38.44.77.07 1.79-.5 2.1.25 1.53-.4 2.4-1.98 2.4h-.83c-1.78 0-3.02-1.4-4.69-1.55v-6.9c.99-.13 1.68-.84 2.3-1.56.45-.49.86-.98 1.21-1.55.57-.92 1.02-2.2 1.37-2.2.9 0 1.71.35 1.71 1.38 0 1.38-1.03 2.07-1.03 2.75h6.19c.72 0 1.38.64 1.38 1.38A1.4 1.4 0 0 1 18.75 12ZM5.44 17a.94.94 0 1 1-1.88 0 .94.94 0 0 1 1.88 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M5.25 7.38h3.37a4.51 4.51 0 0 1-.09-.88c0-1.87 1.37-3.25 3.6-3.25 1.77 0 2.22 1.9 2.95 3.08.3.48.67.9 1.01 1.3h.01c.6.7.9.93 1.18.93h.1c.23-.2.53-.31.87-.31h2.5c.69 0 1.25.5 1.25 1.13v9c0 .62-.56 1.12-1.25 1.12h-2.5c-.34 0-.64-.12-.86-.31h-.1c-1.13 0-2.63 1.56-4.98 1.56h-.83c-2.44 0-3.86-1.51-3.9-3.56-.5-.7-.73-1.6-.63-2.45a3.64 3.64 0 0 1-.3-.87h-1.4A3.27 3.27 0 0 1 2 10.63a3.3 3.3 0 0 1 3.25-3.26Zm0 4.62h3.56c-.5.57-.57 1.67.19 2.38-.44.77-.07 1.79.5 2.1-.25 1.53.4 2.4 1.98 2.4h.83c1.78 0 3.02-1.4 4.69-1.55v-6.9c-.99-.13-1.68-.84-2.3-1.56-.45-.49-.86-.98-1.21-1.55-.57-.92-1.02-2.2-1.37-2.2-.9 0-1.71.35-1.71 1.38 0 1.38 1.03 2.07 1.03 2.75H5.25c-.72 0-1.38.64-1.38 1.38 0 .74.64 1.37 1.38 1.37Zm13.31 5a.94.94 0 1 0 1.88 0 .94.94 0 0 0-1.88 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Zm3.5 1.25h-.65a6.8 6.8 0 0 1-5.7 0H8.5a5.25 5.25 0 0 0-5.25 5.25v1.63c0 1.03.84 1.87 1.88 1.87h13.75c1.03 0 1.87-.84 1.87-1.88V18.5c0-2.9-2.35-5.25-5.25-5.25Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M7.38 5.25v3.37a4.51 4.51 0 0 0-.88-.09c-1.87 0-3.25 1.37-3.25 3.6 0 1.77 1.9 2.22 3.08 2.95.48.3.9.67 1.3 1.01v.01c.7.6.93.9.93 1.18v.1c-.2.23-.31.53-.31.87v2.5c0 .69.5 1.25 1.13 1.25h9c.62 0 1.12-.56 1.12-1.25v-2.5c0-.34-.12-.64-.31-.86v-.1c0-1.13 1.56-2.63 1.56-4.98v-.83c0-2.44-1.51-3.86-3.56-3.9-.7-.5-1.6-.73-2.45-.63a3.64 3.64 0 0 0-.87-.3v-1.4A3.27 3.27 0 0 0 10.63 2a3.3 3.3 0 0 0-3.26 3.25Zm4.62 0v3.56c.57-.5 1.67-.57 2.38.19.77-.44 1.79-.07 2.1.5 1.53-.25 2.4.4 2.4 1.98v.83c0 1.78-1.4 3.02-1.55 4.69h-6.9c-.13-.99-.84-1.68-1.56-2.3-.49-.45-.98-.86-1.55-1.21-.92-.57-2.2-1.02-2.2-1.37 0-.9.35-1.71 1.38-1.71 1.38 0 2.07 1.03 2.75 1.03V5.25c0-.72.64-1.38 1.38-1.38.74 0 1.37.64 1.37 1.38Zm5 13.31a.94.94 0 1 1 0 1.88.94.94 0 0 1 0-1.88Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M16.63 18.75v-3.37c.28.06.58.09.87.09 1.87 0 3.25-1.37 3.25-3.6 0-1.77-1.9-2.22-3.08-2.95-.48-.3-.9-.67-1.3-1.01V7.9c-.7-.6-.93-.9-.93-1.18v-.1c.2-.23.31-.53.31-.87v-2.5c0-.69-.5-1.25-1.13-1.25h-9C5 2 4.5 2.56 4.5 3.25v2.5c0 .34.12.64.31.86v.1c0 1.13-1.56 2.63-1.56 4.98v.83c0 2.44 1.51 3.86 3.56 3.9.7.5 1.6.73 2.45.63.28.14.57.24.87.3v1.4A3.27 3.27 0 0 0 13.37 22a3.3 3.3 0 0 0 3.26-3.25Zm-4.63 0v-3.56c-.57.5-1.67.57-2.38-.19-.77.44-1.79.07-2.1-.5-1.53.25-2.4-.4-2.4-1.98v-.83c0-1.78 1.4-3.02 1.55-4.69h6.9c.13.99.84 1.68 1.56 2.3.49.45.98.86 1.55 1.21.92.57 2.2 1.02 2.2 1.37 0 .9-.35 1.71-1.38 1.71-1.38 0-2.07-1.03-2.75-1.03v6.19c0 .72-.64 1.38-1.38 1.38A1.4 1.4 0 0 1 12 18.75ZM7 5.44a.94.94 0 1 1 0-1.88.94.94 0 0 1 0 1.88Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18.06a8.07 8.07 0 1 1 .02-16.14A8.07 8.07 0 0 1 12 20.06Zm-3.23-8.7a1.29 1.29 0 1 0 0-2.58 1.29 1.29 0 0 0 0 2.57Zm6.46 0a1.29 1.29 0 1 0 0-2.58 1.29 1.29 0 0 0 0 2.57Zm.16 2.92a4.4 4.4 0 0 1-6.78 0 .97.97 0 0 0-1.36-.12.97.97 0 0 0-.13 1.36 6.33 6.33 0 0 0 9.75 0 .97.97 0 1 0-1.48-1.24Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18.06a8.07 8.07 0 1 1 .02-16.14A8.07 8.07 0 0 1 12 20.06Zm-3.23-8.7a1.29 1.29 0 1 0 0-2.58 1.29 1.29 0 0 0 0 2.57Zm6.46-2.59a1.29 1.29 0 1 0 0 2.58 1.29 1.29 0 0 0 0-2.58Zm.32 5.81h-7.1a.97.97 0 0 0-.97.97c0 .53.44.97.97.97h7.1c.53 0 .97-.44.97-.97a.97.97 0 0 0-.97-.97Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18.06a8.07 8.07 0 1 1 .02-16.14A8.07 8.07 0 0 1 12 20.06Zm-3.23-8.7a1.29 1.29 0 1 0 0-2.58 1.29 1.29 0 0 0 0 2.57Zm6.46-2.59a1.29 1.29 0 1 0 0 2.58 1.29 1.29 0 0 0 0-2.58ZM12 13.94c-1.62 0-3.15.7-4.19 1.96a.97.97 0 1 0 1.5 1.23 3.5 3.5 0 0 1 5.39 0c.32.4.93.48 1.36.13a.97.97 0 0 0 .13-1.36A5.44 5.44 0 0 0 12 13.94Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Zm1.88 5.63h-.45c-.89.4-1.94.42-2.86 0h-.45c-1.03 0-1.87.83-1.87 1.87v5.31c0 .52.42.94.94.94h.62v5.31c0 .52.42.94.94.94h2.5c.52 0 .94-.42.94-.94v-5.31h.62c.52 0 .94-.42.94-.94V9.5c0-1.04-.84-1.88-1.88-1.88Z"></path></svg>']},{title:"tool.icon.group.symbols&flags",icons:['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.13 5.13c-1.92 0-3.64-1.25-6.32-1.25-1.23 0-2.28.25-3.16.59A1.88 1.88 0 1 0 2.94 5.5v15.88c0 .34.28.62.62.62h.63c.34 0 .62-.28.62-.63v-3.25a10.75 10.75 0 0 1 5-1.12c1.91 0 3.64 1.25 6.32 1.25 2.28 0 3.98-.88 5.02-1.56.53-.35.85-.94.85-1.57V5.75a1.87 1.87 0 0 0-2.61-1.73c-1.4.6-2.87 1.1-4.26 1.1Zm5 10a7.35 7.35 0 0 1-4 1.24c-2.34 0-3.98-1.25-6.32-1.25-1.7 0-3.77.37-5 .94V7a7.35 7.35 0 0 1 4-1.25c2.34 0 3.98 1.25 6.32 1.25 1.7 0 3.76-.68 5-1.25v9.38Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M11.35 9.42v2.66c1.02.23 1.92.6 2.87.87v-2.66c-1.02-.23-1.93-.6-2.87-.87Zm8.72-4.8a11.4 11.4 0 0 1-4.57 1.24c-2.1 0-3.82-1.36-6.45-1.36a7.6 7.6 0 0 0-2.66.47 2.19 2.19 0 1 0-3.3 1.01v15.08c0 .52.42.94.94.94h.63c.52 0 .94-.42.94-.94v-3.68c1.1-.48 2.48-.87 4.46-.87 2.1 0 3.82 1.36 6.46 1.36 1.88 0 3.38-.64 4.78-1.6.34-.23.54-.61.54-1.03v-9.5c0-.9-.94-1.5-1.77-1.13Zm-11.6 10.1c-1 .1-1.95.32-2.87.64v-2.75c1.02-.36 1.85-.59 2.87-.68v2.79Zm11.5-5.26c-.92.38-1.8.76-2.87.94v2.77c.96-.13 2-.46 2.87-1.01v2.75c-.98.63-1.9.97-2.87 1.06v-2.8a6.6 6.6 0 0 1-2.88-.22v2.64c-.93-.3-1.85-.66-2.87-.84v-2.67a8.68 8.68 0 0 0-2.88-.15V9.2c-.87.12-1.74.4-2.87.81V7.26c1.3-.48 1.95-.77 2.87-.86v2.8a6.64 6.64 0 0 1 2.88.22V6.79c.92.29 1.84.65 2.87.83v2.67c.93.2 1.86.27 2.88.1V7.6c1.05-.19 2.04-.53 2.87-.88v2.75Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.5 5.86c-2.1 0-3.82-1.36-6.46-1.36a7.6 7.6 0 0 0-2.65.47 2.19 2.19 0 1 0-3.3 1.01v15.08c0 .52.42.94.94.94h.63c.51 0 .93-.42.93-.94v-3.68c1.11-.48 2.49-.87 4.47-.87 2.1 0 3.83 1.36 6.46 1.36 1.88 0 3.38-.64 4.78-1.6.34-.23.54-.61.54-1.03v-9.5c0-.9-.94-1.51-1.77-1.13a11.37 11.37 0 0 1-4.57 1.25Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.06 4.45a5.34 5.34 0 0 0-7.29.53l-.77.8-.77-.8a5.34 5.34 0 0 0-7.29-.53 5.6 5.6 0 0 0-.38 8.12l7.55 7.8c.5.5 1.28.5 1.77 0l7.56-7.8a5.6 5.6 0 0 0-.38-8.12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M10.93 3.1 8.49 8.03l-5.47.8a1.2 1.2 0 0 0-.66 2.04l3.95 3.85-.93 5.44a1.2 1.2 0 0 0 1.73 1.26L12 18.86l4.89 2.57a1.2 1.2 0 0 0 1.73-1.26l-.93-5.44 3.95-3.85c.7-.69.32-1.9-.66-2.04l-5.47-.8-2.44-4.95a1.2 1.2 0 0 0-2.14 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m20.98 8.84-5.47-.8-2.44-4.95a1.2 1.2 0 0 0-2.14 0L8.49 8.04l-5.47.8a1.2 1.2 0 0 0-.66 2.04l3.95 3.85-.93 5.44a1.2 1.2 0 0 0 1.73 1.26L12 18.86l4.89 2.57a1.2 1.2 0 0 0 1.73-1.26l-.93-5.44 3.95-3.85c.7-.69.32-1.9-.66-2.04Zm-5.22 5.26.89 5.18L12 16.84l-4.65 2.44.89-5.18-3.76-3.66 5.2-.75L12 4.97l2.33 4.72 5.2.75-3.77 3.66Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18.93 12.68v3.84c0 .96-.34 1.78-1.01 2.46A3.33 3.33 0 0 1 15.47 20h-10c-.96 0-1.78-.34-2.45-1.02A3.36 3.36 0 0 1 2 16.52V6.48c0-.96.34-1.78 1.02-2.46A3.33 3.33 0 0 1 5.46 3h10.01c.5 0 .97.1 1.4.3.13.06.2.15.22.28a.38.38 0 0 1-.1.35l-.6.6a.38.38 0 0 1-.27.11c-.03 0-.06 0-.1-.02a2.13 2.13 0 0 0-.55-.07h-10c-.54 0-.99.18-1.37.56-.37.38-.56.84-.56 1.37v10.04c0 .53.19.99.56 1.37.38.38.83.56 1.36.56h10.01c.53 0 .98-.18 1.36-.56.38-.38.56-.84.56-1.37v-3.06c0-.1.04-.2.11-.27l.77-.77a.38.38 0 0 1 .28-.12c.05 0 .1 0 .14.03.16.07.24.18.24.35Zm2.78-5.9-9.79 9.83c-.2.19-.42.29-.68.29-.27 0-.5-.1-.69-.3l-5.17-5.18a.94.94 0 0 1-.29-.7c0-.26.1-.49.29-.68L6.7 8.7c.2-.2.42-.29.69-.29.26 0 .5.1.68.3l3.17 3.17 7.78-7.82c.19-.19.42-.29.68-.29.27 0 .5.1.69.3L21.7 5.4c.2.2.29.43.29.7 0 .26-.1.49-.29.68Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m8.8 19.16-6.5-6.5a1 1 0 0 1 0-1.41l1.4-1.41a1 1 0 0 1 1.42 0L9.5 14.2l9.38-9.37a1 1 0 0 1 1.41 0l1.42 1.41a1 1 0 0 1 0 1.41l-11.5 11.5a1 1 0 0 1-1.42 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m15.8 12 5.68-5.69c.7-.7.7-1.82 0-2.52L20.2 2.52c-.7-.7-1.83-.7-2.52 0L12 8.21 6.31 2.52c-.7-.7-1.82-.7-2.52 0L2.52 3.8c-.7.7-.7 1.83 0 2.52L8.21 12l-5.69 5.69c-.7.7-.7 1.82 0 2.52l1.27 1.27c.7.7 1.83.7 2.52 0L12 15.79l5.69 5.69c.7.7 1.83.7 2.52 0l1.27-1.27c.7-.7.7-1.83 0-2.52L15.79 12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M17.71 4.15a9.84 9.84 0 1 1-11.44 0 .96.96 0 0 1 1.4.3l.62 1.12c.24.42.13.95-.26 1.23a6.66 6.66 0 1 0 7.93 0 .95.95 0 0 1-.25-1.23l.62-1.11a.95.95 0 0 1 1.38-.31Zm-4.12 8.33V2.95a.95.95 0 0 0-.96-.95h-1.27a.95.95 0 0 0-.95.95v9.53c0 .52.43.95.96.95h1.26c.53 0 .96-.43.96-.95Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M8.49 13.08H6.86c-.3 0-.54.24-.54.54v6.49c0 .3.25.54.54.54H8.5c.3 0 .54-.24.54-.54v-6.49c0-.3-.24-.54-.54-.54Zm-4.33 3.24H2.54c-.3 0-.54.25-.54.54v3.25c0 .3.24.54.54.54h1.62c.3 0 .54-.24.54-.54v-3.25c0-.3-.24-.54-.54-.54Zm8.65-6.48H11.2c-.3 0-.54.24-.54.54v9.73c0 .3.24.54.54.54h1.62c.3 0 .54-.24.54-.54v-9.73c0-.3-.24-.54-.54-.54Zm4.33-3.25H15.5c-.3 0-.54.25-.54.55V20.1c0 .3.24.54.54.54h1.63c.3 0 .54-.24.54-.54V7.14c0-.3-.25-.55-.54-.55Zm4.32-3.24h-1.62c-.3 0-.54.24-.54.54v16.22c0 .3.24.54.54.54h1.62c.3 0 .54-.24.54-.54V3.89c0-.3-.24-.54-.54-.54Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M16.63 7.05a6.78 6.78 0 0 0-11.2 3.29.49.49 0 0 1-.47.37H2.65a.48.48 0 0 1-.48-.57 10 10 0 0 1 16.74-5.37l1.44-1.44A.97.97 0 0 1 22 4v5.4c0 .54-.43.98-.97.98h-5.4a.97.97 0 0 1-.69-1.65l1.69-1.69ZM2.97 13.61h5.4a.97.97 0 0 1 .69 1.66l-1.69 1.68a6.78 6.78 0 0 0 11.2-3.29.49.49 0 0 1 .47-.37h2.31c.3 0 .53.27.48.57a10 10 0 0 1-16.74 5.37l-1.44 1.44A.97.97 0 0 1 2 20v-5.4c0-.54.43-.98.97-.98Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.52 2h-1.88a.48.48 0 0 0-.47.5l.16 3.29a9.81 9.81 0 0 0-7.5-3.47 9.83 9.83 0 1 0 6.59 17.14.48.48 0 0 0 .02-.7l-1.34-1.34a.48.48 0 0 0-.65-.02 6.98 6.98 0 1 1 1.18-9.14l-4.03-.19a.48.48 0 0 0-.5.48v1.88a.48.48 0 0 0 .48.47h7.94a.48.48 0 0 0 .48-.47V2.48a.48.48 0 0 0-.48-.47Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 3.94a8.06 8.06 0 1 1 0 16.12 8.06 8.06 0 0 1 0-16.12ZM12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 6.77a3.23 3.23 0 1 0 0 6.46 3.23 3.23 0 0 0 0-6.46Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M11.23 21.6C5.55 13.37 4.5 12.52 4.5 9.5a7.5 7.5 0 1 1 15 0c0 3.02-1.05 3.87-6.73 12.1a.94.94 0 0 1-1.54 0Zm.77-8.98a3.12 3.12 0 1 0 0-6.24 3.12 3.12 0 0 0 0 6.25Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19.86 22H4.14A2.14 2.14 0 0 1 2 19.86V4.14C2 2.96 2.96 2 4.14 2h15.72C21.04 2 22 2.96 22 4.14v15.72c0 1.18-.96 2.14-2.14 2.14Zm-9.14-4.38 8.21-8.21a.71.71 0 0 0 0-1.01l-1-1.01a.71.71 0 0 0-1.02 0l-6.7 6.7-3.12-3.13a.71.71 0 0 0-1.01 0l-1.01 1a.71.71 0 0 0 0 1.02l4.64 4.64c.28.28.73.28 1 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm5.8 11.13c0 .27-.21.48-.48.48h-3.7v3.71c0 .27-.22.49-.5.49h-2.25a.49.49 0 0 1-.48-.49v-3.7H6.68a.49.49 0 0 1-.49-.5v-2.25c0-.27.22-.48.49-.48h3.7V6.68c0-.27.22-.49.5-.49h2.25c.27 0 .48.22.48.49v3.7h3.71c.27 0 .49.22.49.5v2.25Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20ZM6.68 13.61a.49.49 0 0 1-.49-.48v-2.26c0-.27.22-.48.49-.48h10.64c.27 0 .49.21.49.48v2.26c0 .27-.22.48-.49.48H6.68Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm4.9 12.63c.2.18.2.5 0 .68l-1.6 1.6a.48.48 0 0 1-.68 0L12 14.25 9.37 16.9a.48.48 0 0 1-.68 0l-1.6-1.6a.48.48 0 0 1 0-.68L9.75 12 7.1 9.37a.48.48 0 0 1 0-.68l1.6-1.6c.18-.19.49-.19.68 0L12 9.74l2.63-2.64c.18-.2.5-.2.68 0l1.6 1.6c.19.18.19.49 0 .68L14.26 12l2.64 2.63Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Zm-9.73-6.7c-2.2 0-3.6.93-4.7 2.58-.14.21-.1.5.1.65l1.4 1.06c.22.16.52.13.68-.08.72-.92 1.21-1.45 2.31-1.45.82 0 1.84.53 1.84 1.33 0 .6-.5.92-1.3 1.37-.96.54-2.21 1.2-2.21 2.85v.16c0 .27.21.49.48.49h2.26c.27 0 .48-.22.48-.49v-.05c0-1.15 3.36-1.2 3.36-4.3 0-2.34-2.43-4.11-4.7-4.11Zm-.27 10a1.86 1.86 0 1 0 0 3.72 1.86 1.86 0 0 0 0-3.71Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Zm-11.16 5.3 7.42-7.42a.65.65 0 0 0 0-.92l-.91-.9a.65.65 0 0 0-.91 0l-6.05 6.04-2.83-2.82a.65.65 0 0 0-.91 0l-.91.9a.65.65 0 0 0 0 .92l4.2 4.2c.24.25.65.25.9 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 4.44a1.7 1.7 0 1 1 0 3.38 1.7 1.7 0 0 1 0-3.38Zm2.26 10.24c0 .26-.22.48-.49.48h-3.54a.48.48 0 0 1-.49-.48v-.97c0-.27.22-.48.49-.48h.48v-2.58h-.48a.48.48 0 0 1-.49-.49v-.97c0-.26.22-.48.49-.48h2.58c.26 0 .48.22.48.48v4.04h.48c.27 0 .49.21.49.48v.97Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.53 10.75h-1.18a8.44 8.44 0 0 0-7.1-7.1V2.47a.47.47 0 0 0-.47-.47h-1.56a.47.47 0 0 0-.47.47v1.18a8.44 8.44 0 0 0-7.1 7.1H2.47a.47.47 0 0 0-.47.47v1.56c0 .26.21.47.47.47h1.18a8.44 8.44 0 0 0 7.1 7.1v1.18c0 .26.21.47.47.47h1.56c.26 0 .47-.21.47-.47v-1.18a8.44 8.44 0 0 0 7.1-7.1h1.18c.26 0 .47-.21.47-.47v-1.56a.47.47 0 0 0-.47-.47Zm-8.28 7.06v-1.6a.47.47 0 0 0-.47-.46h-1.56a.47.47 0 0 0-.47.47v1.59a5.94 5.94 0 0 1-4.56-4.56h1.6c.25 0 .46-.21.46-.47v-1.56a.47.47 0 0 0-.47-.47H6.2a5.94 5.94 0 0 1 4.56-4.56v1.6c0 .25.21.46.47.46h1.56c.26 0 .47-.21.47-.47V6.2a5.94 5.94 0 0 1 4.56 4.56h-1.6a.47.47 0 0 0-.46.47v1.56c0 .26.21.47.47.47h1.59a5.94 5.94 0 0 1-4.56 4.56Zm0-5.81a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18.06a8.06 8.06 0 1 1 0-16.12 8.06 8.06 0 0 1 0 16.12ZM16.1 9.5 13.6 12l2.5 2.5c.2.2.2.5 0 .7l-.9.9a.48.48 0 0 1-.7 0L12 13.6l-2.5 2.5a.48.48 0 0 1-.7 0l-.9-.9a.48.48 0 0 1 0-.7l2.5-2.5-2.5-2.5a.48.48 0 0 1 0-.7l.9-.9c.2-.2.5-.2.7 0l2.5 2.5 2.5-2.5c.2-.2.5-.2.7 0l.9.9c.2.2.2.5 0 .7Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 1.94a8.06 8.06 0 1 1 0 16.12 8.06 8.06 0 0 1 0-16.12Zm5.65 5.25-.9-.92a.48.48 0 0 0-.69 0l-5.7 5.65-2.41-2.43a.48.48 0 0 0-.68 0l-.92.9c-.19.2-.2.5 0 .7L10 16.76c.19.2.5.2.68 0l6.96-6.9c.19-.19.2-.5 0-.68Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm5.25 4.75a7.42 7.42 0 0 1 .83 9.5L7.74 5.93a7.42 7.42 0 0 1 9.5.83Zm-10.5 10.5a7.42 7.42 0 0 1-.83-9.5l10.34 10.33a7.42 7.42 0 0 1-9.5-.83Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.57 9.86h-6.43V3.43c0-.79-.64-1.43-1.43-1.43H11.3c-.8 0-1.43.64-1.43 1.43v6.43H3.43c-.79 0-1.43.64-1.43 1.43v1.42c0 .8.64 1.43 1.43 1.43h6.43v6.43c0 .79.64 1.43 1.43 1.43h1.42c.8 0 1.43-.64 1.43-1.43v-6.43h6.43c.79 0 1.43-.64 1.43-1.43V11.3c0-.8-.64-1.43-1.43-1.43Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.57 9.86H3.43c-.79 0-1.43.64-1.43 1.43v1.42c0 .8.64 1.43 1.43 1.43h17.14c.79 0 1.43-.64 1.43-1.43V11.3c0-.8-.64-1.43-1.43-1.43Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.68 15.05 15.13 12l5.55-3.05a.94.94 0 0 0 .36-1.3l-.76-1.3a.94.94 0 0 0-1.3-.34l-5.42 3.28.14-6.33a.94.94 0 0 0-.94-.96h-1.52a.94.94 0 0 0-.94.96l.14 6.33-5.42-3.28a.94.94 0 0 0-1.3.33l-.76 1.32a.94.94 0 0 0 .36 1.29L8.87 12l-5.55 3.05a.94.94 0 0 0-.36 1.3l.76 1.3c.26.46.85.61 1.3.34l5.42-3.28-.14 6.33c-.01.53.41.96.94.96h1.52c.53 0 .95-.43.94-.96l-.14-6.33 5.42 3.28a.94.94 0 0 0 1.3-.33l.76-1.32a.94.94 0 0 0-.36-1.29Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Zm-10 2.02a1.85 1.85 0 1 0 0 3.7 1.85 1.85 0 0 0 0-3.7Zm-1.76-6.67.3 5.48c.01.26.22.46.48.46h1.96c.26 0 .47-.2.48-.46l.3-5.48a.48.48 0 0 0-.48-.51h-2.56c-.28 0-.5.23-.48.5Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.77 18.39a1.67 1.67 0 0 1-1.44 2.5H3.67a1.67 1.67 0 0 1-1.45-2.5l8.34-14.45a1.67 1.67 0 0 1 2.88 0l8.33 14.45ZM12 15.4a1.6 1.6 0 1 0 0 3.2 1.6 1.6 0 0 0 0-3.2Zm-1.52-5.74.26 4.72c.01.22.2.4.42.4h1.68c.22 0 .4-.18.42-.4l.26-4.72a.42.42 0 0 0-.42-.44h-2.2c-.24 0-.43.2-.42.44Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.88 11.5A11.14 11.14 0 0 0 12 5.32c-4.27 0-8 2.5-9.88 6.16a1.12 1.12 0 0 0 0 1.02A11.14 11.14 0 0 0 12 18.67c4.27 0 8-2.5 9.88-6.16a1.12 1.12 0 0 0 0-1.02ZM12 17a5 5 0 1 1 0-10 5 5 0 0 1 0 10Zm0-8.33c-.3 0-.6.05-.88.13a1.66 1.66 0 0 1-2.32 2.32A3.33 3.33 0 1 0 12 8.67Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 16.5a4.48 4.48 0 0 1-4.47-4.16L4.26 9.81c-.43.54-.83 1.1-1.15 1.73a1.01 1.01 0 0 0 0 .92C4.8 15.76 8.16 18 12 18c.84 0 1.65-.13 2.43-.33l-1.62-1.25a4.5 4.5 0 0 1-.81.08Zm9.8 1.82-3.45-2.67a10.35 10.35 0 0 0 2.54-3.2 1.01 1.01 0 0 0 0-.9A10.02 10.02 0 0 0 12 6c-1.6 0-3.2.4-4.6 1.18L3.42 4.1a.5.5 0 0 0-.7.08L2.1 5a.5.5 0 0 0 .08.7l18.39 14.2a.5.5 0 0 0 .7-.08l.61-.8a.5.5 0 0 0-.08-.7Zm-5.73-4.44-1.23-.95a2.96 2.96 0 0 0-3.63-3.81c.19.25.29.56.29.88 0 .1-.02.21-.05.31l-2.3-1.78a4.45 4.45 0 0 1 6.03.29 4.5 4.5 0 0 1 .89 5.06Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 3.25c-5.52 0-10 3.64-10 8.13 0 1.93.84 3.7 2.23 5.1a9.94 9.94 0 0 1-2.14 3.74.31.31 0 0 0-.06.34.3.3 0 0 0 .28.19 8.93 8.93 0 0 0 5.5-2c1.27.47 2.69.75 4.19.75 5.52 0 10-3.64 10-8.13 0-4.48-4.48-8.12-10-8.12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19.9 4.51c-2.25-1.9-5.74-1.61-7.9.59-2.16-2.2-5.65-2.5-7.9-.59a5.91 5.91 0 0 0-.42 8.64l6.85 6.98a2.05 2.05 0 0 0 2.94 0l6.85-6.98a5.91 5.91 0 0 0-.41-8.64Zm-.92 7.32-6.85 6.98c-.1.1-.17.1-.26 0l-6.85-6.98a4.03 4.03 0 0 1 .28-5.88c1.52-1.28 3.86-1.09 5.33.4L12 7.76l1.37-1.4c1.47-1.5 3.82-1.68 5.33-.4 2 1.68 1.7 4.44.28 5.88Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m19.91 12 1.8-1.76a.93.93 0 0 0-.42-1.58l-2.44-.62.69-2.42a.95.95 0 0 0-1.16-1.16l-2.42.69-.63-2.45a.94.94 0 0 0-1.57-.42L12 4.1l-1.76-1.8a.94.94 0 0 0-1.57.4l-.63 2.46-2.42-.7a.95.95 0 0 0-1.16 1.17l.7 2.42-2.45.62a.93.93 0 0 0-.42 1.58L4.09 12l-1.8 1.75a.93.93 0 0 0 .42 1.58l2.44.63-.69 2.42a.95.95 0 0 0 1.16 1.16l2.42-.7.63 2.45a.93.93 0 0 0 1.57.42l1.76-1.8 1.76 1.8c.49.53 1.4.3 1.57-.42l.63-2.44 2.42.69a.95.95 0 0 0 1.16-1.16l-.7-2.42 2.45-.63a.93.93 0 0 0 .42-1.58L19.91 12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 3.25c-5.52 0-10 3.64-10 8.13 0 1.85.78 3.56 2.07 4.93a9.91 9.91 0 0 1-1.81 2.86.94.94 0 0 0 .68 1.58c2.4 0 4.3-1 5.43-1.8 1.13.35 2.35.55 3.63.55 5.52 0 10-3.64 10-8.12 0-4.5-4.48-8.13-10-8.13Zm0 14.37c-1.04 0-2.07-.16-3.06-.47l-.89-.28-.76.54a8.4 8.4 0 0 1-2.24 1.13c.28-.47.56-1 .77-1.57l.42-1.1-.8-.85c-.72-.75-1.56-2-1.56-3.64 0-3.45 3.64-6.25 8.12-6.25 4.48 0 8.13 2.8 8.13 6.25 0 3.44-3.65 6.24-8.13 6.24Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M13.88 3.88a1.88 1.88 0 1 1-3.76 0 1.88 1.88 0 0 1 3.76 0ZM12 18.24A1.88 1.88 0 1 0 12 22a1.88 1.88 0 0 0 0-3.75Zm8.13-8.13a1.88 1.88 0 1 0 0 3.76 1.88 1.88 0 0 0 0-3.76ZM5.74 12A1.88 1.88 0 1 0 2 12a1.88 1.88 0 0 0 3.75 0Zm.5 3.87a1.88 1.88 0 1 0 0 3.75 1.88 1.88 0 0 0 0-3.75Zm11.5 0a1.88 1.88 0 1 0 0 3.75 1.88 1.88 0 0 0 0-3.75ZM6.25 4.38a1.87 1.87 0 1 0 0 3.75 1.87 1.87 0 0 0 0-3.75Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m20.98 8.85-5.47-.8-2.44-4.94A1.19 1.19 0 0 0 12 2.45c-.43 0-.85.22-1.07.66L8.49 8.05l-5.47.8a1.2 1.2 0 0 0-.66 2.03l3.95 3.85-.93 5.42a1.2 1.2 0 0 0 1.73 1.26L12 18.85l4.88 2.56a1.2 1.2 0 0 0 1.73-1.26l-.92-5.42 3.95-3.85a1.2 1.2 0 0 0-.66-2.03Zm-4.55 4.6-.67.65.16.93.73 4.23-3.82-2-.83-.43V4.99l1.9 3.85.42.85.93.13 4.27.63-3.09 3Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19.36 2.14 3.12 9.64c-1.87.87-1.25 3.62.75 3.62h6.87v6.87c0 2 2.75 2.62 3.63.75l7.5-16.24c.62-1.5-1-3.13-2.5-2.5Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 6.44a5.56 5.56 0 1 1-.01 11.13A5.56 5.56 0 0 1 12 6.44ZM12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12.02 2A7.57 7.57 0 0 0 5.3 5.56c-.3.4-.2.98.2 1.28l1.68 1.28c.4.3.98.23 1.3-.16.98-1.23 1.7-1.94 3.23-1.94 1.2 0 2.7.78 2.7 1.94 0 .88-.73 1.34-1.92 2-1.38.78-3.22 1.74-3.22 4.16v.38c0 .52.42.94.94.94h2.83c.52 0 .94-.42.94-.94v-.23c0-1.67 4.9-1.74 4.9-6.27 0-3.41-3.55-6-6.86-6Zm-.4 14.59a2.7 2.7 0 1 0 .01 5.42 2.7 2.7 0 0 0 0-5.42Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M9.03 18.57h.78v-5.64h-.78a.78.78 0 0 1-.78-.78v-1.87c0-.43.35-.78.78-.78h4.38c.43 0 .78.35.78.78v8.3h.78c.43 0 .78.34.78.77v1.87c0 .43-.35.78-.78.78H9.03a.78.78 0 0 1-.78-.78v-1.87c0-.43.35-.78.78-.78ZM12 2a2.81 2.81 0 1 0 0 5.62A2.81 2.81 0 0 0 12 2Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.13 18.88a3.13 3.13 0 1 1-6.26-.01 3.13 3.13 0 0 1 6.26 0Zm-5.9-15.9.54 10.63c.02.5.43.89.93.89h2.6c.5 0 .9-.4.93-.9l.53-10.62a.94.94 0 0 0-.93-.98h-3.66a.94.94 0 0 0-.93.98Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 17.42a7.42 7.42 0 1 1 0-14.83 7.42 7.42 0 0 1 0 14.83Zm0-12.58a5.16 5.16 0 1 0 0 10.32 5.16 5.16 0 0 0 0-10.32Zm0 7.74a2.58 2.58 0 1 1 0-5.17 2.58 2.58 0 0 1 0 5.17Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M9.75 15.03c0 .87-.45 2.3-1.53 2.3-1.07 0-1.52-1.43-1.52-2.3 0-.87.45-2.3 1.52-2.3 1.08 0 1.53 1.43 1.53 2.3ZM22 12.93c0 1.32-.13 2.73-.73 3.95-1.58 3.2-5.92 3.12-9.03 3.12-3.16 0-7.76.11-9.4-3.12A8.92 8.92 0 0 1 2 12.92c0-1.74.58-3.4 1.73-4.73a6.52 6.52 0 0 1-.32-2.03c0-.9.2-1.35.6-2.16 1.9 0 3.1.37 4.54 1.5a15.96 15.96 0 0 1 7.05-.03A6.44 6.44 0 0 1 20.09 4c.4.81.6 1.26.6 2.16 0 .68-.1 1.36-.32 2A7.18 7.18 0 0 1 22 12.93Zm-2.68 2.1c0-1.83-1.11-3.44-3.06-3.44-.79 0-1.54.14-2.34.25a12.25 12.25 0 0 1-3.75 0c-.78-.11-1.54-.25-2.34-.25-1.95 0-3.06 1.61-3.06 3.44 0 3.66 3.35 4.22 6.27 4.22h2c2.94 0 6.28-.56 6.28-4.22Zm-3.44-2.3c-1.08 0-1.53 1.43-1.53 2.3 0 .87.45 2.3 1.53 2.3 1.07 0 1.53-1.43 1.53-2.3 0-.87-.46-2.3-1.53-2.3Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M11.87 6.82c.04.02.07.06.12.06.04 0 .1-.01.11-.06.01-.05-.07-.09-.12-.1-.07-.04-.16-.05-.22-.01-.01 0-.03.02-.02.04.01.05.09.04.13.07Zm-.85.06c.04 0 .07-.04.11-.06.05-.03.12-.02.14-.07 0-.01 0-.03-.02-.04-.07-.03-.15-.02-.22 0-.05.03-.13.06-.12.12 0 .04.07.06.1.05Zm8.63 10.9c-.14-.16-.2-.46-.28-.78-.07-.31-.15-.65-.41-.87a1.05 1.05 0 0 0-.32-.2 4.52 4.52 0 0 0-.14-3.08 10.42 10.42 0 0 0-1.82-2.9c-.66-.85-1.31-1.65-1.3-2.82.02-1.8.2-5.13-2.96-5.13-4 0-3 4.04-3.04 5.28a4.53 4.53 0 0 1-.88 2.53c-.74.88-1.78 2.3-2.27 3.78-.24.7-.35 1.4-.25 2.08-.25.22-.44.57-.64.79-.17.16-.4.23-.67.32-.26.1-.54.23-.72.57a1 1 0 0 0-.1.48c0 .15.01.3.04.46.04.32.1.61.03.81-.2.57-.23.96-.09 1.24.15.29.45.41.79.48.67.14 1.6.1 2.31.5.78.4 1.56.54 2.19.4.45-.1.82-.38 1-.8.5 0 1.04-.2 1.9-.25.58-.05 1.3.2 2.15.16.02.09.05.18.1.26.32.66.93.96 1.57.9a2.85 2.85 0 0 0 1.89-1.09c.53-.64 1.4-.9 1.98-1.25.3-.18.53-.4.55-.72.01-.32-.17-.67-.6-1.16ZM11.98 5.4c.39-.87 1.34-.85 1.72-.02.26.56.14 1.21-.16 1.58l-.5-.19c.05-.05.12-.1.16-.18.18-.46-.01-1.05-.36-1.07-.29-.01-.54.43-.46.9a2.78 2.78 0 0 0-.5-.17c-.05-.27-.02-.57.1-.85Zm-1.59-.45c.4 0 .82.56.75 1.3-.14.05-.28.1-.4.19.05-.35-.13-.79-.37-.77-.33.03-.39.83-.07 1.1.04.03.07 0-.23.22-.61-.57-.41-2.04.32-2.04Zm-.53 2.37.55-.4c.19-.18.53-.56 1.1-.56.27 0 .6.09 1 .34.25.16.45.18.89.37.33.13.53.38.4.7-.1.29-.42.57-.88.72-.43.14-.77.62-1.49.58-.15-.01-.27-.04-.38-.08-.3-.14-.47-.41-.78-.59-.33-.19-.51-.4-.57-.6-.06-.19 0-.35.16-.48ZM10 20.38c-.1 1.37-1.71 1.34-2.94.7-1.17-.62-2.68-.25-2.99-.85-.09-.19-.09-.5.1-1.04.1-.3.03-.63-.02-.94-.05-.3-.07-.58.04-.78.13-.26.33-.35.57-.44.4-.14.47-.13.77-.39.21-.22.37-.5.56-.7.2-.21.39-.32.69-.27.32.05.59.27.86.63l.76 1.39c.37.77 1.68 1.89 1.6 2.69Zm-.05-1.01a8.38 8.38 0 0 0-.56-.77c.27 0 .55-.09.65-.35.09-.24 0-.58-.3-.97-.52-.71-1.49-1.27-1.49-1.27a2.11 2.11 0 0 1-.96-1.17 2.64 2.64 0 0 1-.01-1.37c.2-.9.73-1.77 1.06-2.31.1-.07.03.12-.34.8-.33.64-.95 2.09-.1 3.23.02-.81.22-1.64.54-2.4.47-1.08 1.46-2.93 1.54-4.4.04.02.17.12.24.15.18.1.31.26.49.4.48.4 1.11.36 1.66.05.24-.14.43-.3.62-.35.38-.12.7-.34.87-.59.3 1.2 1 2.9 1.45 3.74.24.45.72 1.39.92 2.53.13 0 .28.01.43.05.54-1.4-.46-2.9-.91-3.32-.19-.18-.2-.25-.1-.25.49.44 1.14 1.32 1.37 2.3.11.46.13.93.02 1.4.64.26 1.4.7 1.2 1.36h-.17c.13-.4-.15-.69-.89-1.02-.76-.34-1.4-.34-1.5.49-.47.16-.7.57-.83 1.06-.11.44-.14.97-.17 1.56-.02.3-.14.7-.27 1.13-1.25.9-3 1.29-4.46.29Zm10.05-.45c-.03.65-1.6.77-2.47 1.81a2.6 2.6 0 0 1-1.7 1 1.28 1.28 0 0 1-1.32-.75c-.18-.44-.09-.9.05-1.42.14-.56.36-1.13.38-1.59.03-.6.07-1.11.17-1.51.1-.4.26-.67.53-.82l.04-.02c.03.51.29 1.04.74 1.15.49.13 1.2-.3 1.5-.64.35-.01.6-.03.88.2.39.33.28 1.18.67 1.63.41.45.54.76.53.96ZM10.02 7.8l.3.28c.27.2.63.4 1.07.4.46 0 .88-.22 1.25-.41.19-.1.42-.28.57-.4.16-.14.24-.25.13-.27-.11 0-.1.1-.24.2-.17.13-.38.3-.54.39-.29.16-.76.4-1.17.4-.4 0-.73-.2-.97-.38l-.3-.27c-.06-.06-.08-.18-.17-.2-.06 0-.07.15.07.26Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M17.65 12.57c-.01-1.64.73-2.88 2.23-3.79A4.8 4.8 0 0 0 16.1 6.8c-1.59-.12-3.32.93-3.95.93-.67 0-2.2-.88-3.41-.88-2.5.04-5.14 1.98-5.14 5.94 0 1.17.21 2.38.64 3.63.57 1.64 2.63 5.66 4.79 5.59 1.12-.03 1.92-.8 3.38-.8 1.42 0 2.16.8 3.41.8 2.17-.03 4.04-3.68 4.58-5.33-2.9-1.37-2.75-4.02-2.75-4.1Zm-2.53-7.33c1.22-1.45 1.1-2.77 1.07-3.24a4.73 4.73 0 0 0-3.03 1.56 4.27 4.27 0 0 0-1.14 3.2c1.16.1 2.23-.5 3.1-1.52Z"></path></svg>']},{title:"tool.icon.group.nature",icons:['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.97 3.45c-.2-.44-.75-.45-.99-.04a5.95 5.95 0 0 1-5.2 3.03H12a6.67 6.67 0 0 0-6.67 6.67c0 .24.03.48.05.71 2.22-1.58 5.42-2.93 9.95-2.93.3 0 .56.25.56.55 0 .31-.25.56-.56.56C6.6 12 2.9 17.35 2.08 19.36a1.11 1.11 0 0 0 2.06.85c.05-.13.73-1.67 2.5-3.15a6.65 6.65 0 0 0 6.07 2.68c5.45-.4 9.29-5.29 9.29-11.27 0-1.75-.38-3.55-1.03-5.02Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m21.3 10.67-2.33-1.58.53-2.78a1.59 1.59 0 0 0-1.85-1.85l-2.77.53-1.57-2.34c-.6-.87-2.03-.87-2.62 0L9.11 5l-2.76-.53A1.58 1.58 0 0 0 4.5 6.32l.53 2.77-2.33 1.58a1.58 1.58 0 0 0 0 2.62l2.33 1.58-.53 2.77a1.58 1.58 0 0 0 1.85 1.86l2.76-.54 1.58 2.34a1.58 1.58 0 0 0 2.62 0l1.57-2.34 2.77.54c.53.1 1.05-.06 1.42-.43.37-.38.53-.9.43-1.42l-.53-2.78 2.33-1.58a1.58 1.58 0 0 0 0-2.62ZM16.9 14l.68 3.56-3.55-.68-2.03 3-2.03-3-3.55.68.69-3.56-3-2.03 3-2.03-.69-3.57 3.56.7 2.02-3 2.03 3 3.55-.7-.69 3.57 3 2.03-3 2.03ZM12 7.94a4.07 4.07 0 1 0 .01 8.14A4.07 4.07 0 0 0 12 7.94Zm0 6.25a2.19 2.19 0 1 1 0-4.38 2.19 2.19 0 0 1 0 4.38Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12.9 22c3.08 0 5.9-1.4 7.77-3.7a1.88 1.88 0 0 0-1.8-3.03 5.2 5.2 0 0 1-3.55-9.63 1.88 1.88 0 0 0-.6-3.47A10 10 0 1 0 12.9 22Zm0-18.13c.51 0 1 .05 1.49.14a7.07 7.07 0 0 0 4.83 13.1A8.1 8.1 0 0 1 4.78 12a8.13 8.13 0 0 1 8.12-8.13Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 13.29c-.02.68-.6 1.21-1.28 1.21h-2.16v.63c0 .85-.19 1.66-.53 2.38l2.35 2.36a1.25 1.25 0 0 1-1.76 1.76l-2.14-2.13a5.6 5.6 0 0 1-3.54 1.25v-9.53a.47.47 0 0 0-.47-.47h-.94a.47.47 0 0 0-.47.47v9.53a5.6 5.6 0 0 1-3.54-1.25l-2.14 2.13a1.25 1.25 0 0 1-1.76-1.76l2.35-2.36a5.6 5.6 0 0 1-.53-2.39v-.62H3.28c-.69 0-1.26-.53-1.28-1.21-.02-.71.55-1.29 1.25-1.29h2.19V9.7L3.62 7.89a1.25 1.25 0 0 1 1.76-1.76l2.14 2.13h8.96l2.14-2.13a1.25 1.25 0 0 1 1.76 1.76l-1.82 1.83V12h2.19c.7 0 1.27.58 1.25 1.29ZM12.04 2a4.37 4.37 0 0 0-4.38 4.38h8.75A4.37 4.37 0 0 0 12.04 2Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M17.31 8.25h-4.5l1.66-5.07a.94.94 0 0 0-.9-1.18H7.93a.94.94 0 0 0-.93.81L5.76 12.2a.94.94 0 0 0 .93 1.06h4.63l-1.8 7.6a.94.94 0 0 0 1.73.68l6.87-11.87a.94.94 0 0 0-.8-1.41Z"></path></svg>']},{title:"tool.icon.group.nature",icons:['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18.73 19.04a.54.54 0 0 0-.64-.42c-.48.11-1.22.25-2.03.25a5.75 5.75 0 0 1-5.42-3.82h5.07a.53.53 0 0 0 .53-.42l.28-1.26a.54.54 0 0 0-.52-.66h-6a9.64 9.64 0 0 1 .01-1.88h6.55a.54.54 0 0 0 .52-.42l.3-1.33a.54.54 0 0 0-.53-.65h-6.18a5.6 5.6 0 0 1 5.26-3.35c.64 0 1.27.1 1.69.18.27.06.55-.1.62-.38l.54-1.98a.54.54 0 0 0-.42-.67A13 13 0 0 0 16 2a9.54 9.54 0 0 0-9.14 6.43H5.4c-.3 0-.54.24-.54.53v1.33c0 .3.24.54.54.54h.96c-.04.6-.05 1.3 0 1.88H5.4c-.3 0-.54.24-.54.54v1.27c0 .3.24.53.54.53h1.34A9.35 9.35 0 0 0 16.01 22c1.17 0 2.16-.2 2.72-.35a.54.54 0 0 0 .4-.62l-.4-1.99Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18.6 16.29h-2.02c-.3 0-.54.24-.54.53v2.27h-5.47v-5.66h3.75c.3 0 .54-.24.54-.54v-1.78c0-.3-.24-.54-.54-.54h-3.75V7.73c0-1.44 1.1-2.54 2.76-2.54 1.06 0 2.05.5 2.57.84.23.14.53.09.7-.12l1.28-1.59a.54.54 0 0 0-.1-.76A7.67 7.67 0 0 0 13.25 2C9.59 2 7 4.35 7 7.62v2.95H5.75c-.3 0-.54.24-.54.54v1.78c0 .3.24.54.54.54H7v5.71H5.4c-.3 0-.54.24-.54.54v1.78c0 .3.24.54.53.54h13.22c.3 0 .53-.24.53-.54v-4.64c0-.3-.24-.53-.53-.53Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m14.55 11.12-4.22-1.24a1.15 1.15 0 0 1 .32-2.26h2.6c.47 0 .94.15 1.33.42a.6.6 0 0 0 .76-.08l1.36-1.33a.63.63 0 0 0-.07-.96 5.52 5.52 0 0 0-3.38-1.17V2.62a.63.63 0 0 0-.63-.62h-1.25a.63.63 0 0 0-.62.63V4.5h-.1A4.28 4.28 0 0 0 6.4 9.17a4.47 4.47 0 0 0 3.28 3.78l4 1.17a1.15 1.15 0 0 1-.32 2.26h-2.6c-.47 0-.94-.15-1.33-.42a.6.6 0 0 0-.76.08L7.3 17.37a.63.63 0 0 0 .07.96 5.52 5.52 0 0 0 3.38 1.17v1.88c0 .34.28.62.62.62h1.25c.35 0 .63-.28.63-.63V19.5a4.41 4.41 0 0 0 4.13-2.84 4.29 4.29 0 0 0-2.83-5.53Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18.6 4.86c.3 0 .54-.24.54-.54V2.54c0-.3-.24-.54-.53-.54H5.39c-.3 0-.53.24-.53.54v2c0 .29.24.53.53.53H9.2c1.22 0 2.15.44 2.72 1.22H5.4c-.3 0-.53.24-.53.53v1.79c0 .3.24.53.53.53h7.09c-.28 1.61-1.47 2.62-3.34 2.62H5.4c-.3 0-.53.24-.53.54v2.36c0 .15.06.3.17.4l7.37 6.8c.1.09.23.14.36.14h3.69c.48 0 .72-.6.36-.93l-6.74-6.22a6.12 6.12 0 0 0 6.18-5.7h2.36c.3 0 .53-.25.53-.54V6.82c0-.3-.24-.53-.53-.53h-2.62c-.16-.52-.37-1-.64-1.43h3.26Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19.1 2h-2.9c-.21 0-.4.12-.5.3l-2.46 5.05c-.65 1.55-1.21 3.21-1.21 3.21h-.06s-.56-1.66-1.21-3.2L8.28 2.3A.54.54 0 0 0 7.8 2H4.9c-.41 0-.67.43-.48.79L7.99 9.5H5.4c-.3 0-.53.24-.53.54v1.42c0 .3.24.54.53.54h3.94l.88 1.66v1.2H5.4c-.3 0-.53.24-.53.53v1.43c0 .3.24.54.53.54h4.82v4.1c0 .3.24.54.54.54h2.5c.3 0 .53-.24.53-.54v-4.1h4.83c.3 0 .53-.24.53-.54V15.4c0-.3-.24-.53-.53-.53h-4.83v-1.2l.89-1.66h3.94c.3 0 .53-.24.53-.54v-1.42c0-.3-.24-.54-.53-.54H16l3.57-6.71A.53.53 0 0 0 19.1 2Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M14.11 14.86c3.8 0 6.46-2.66 6.46-6.47 0-3.82-2.66-6.39-6.46-6.39H6.82c-.3 0-.53.24-.53.54v9.22H3.96c-.3 0-.53.24-.53.54v2.02c0 .3.24.54.53.54H6.3v1.43H3.96c-.3 0-.53.24-.53.53v1.79c0 .3.24.53.53.53H6.3v2.32c0 .3.24.54.53.54h2.62c.3 0 .53-.24.53-.54v-2.32h7.2c.3 0 .54-.24.54-.53v-1.79c0-.3-.24-.53-.53-.53h-7.2v-1.43h4.13Zm-4.14-9.8h3.52c2.08 0 3.34 1.3 3.34 3.33 0 2.04-1.26 3.37-3.4 3.37H9.97v-6.7Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.58 9.77c.23 0 .42-.2.42-.42V7.96a.42.42 0 0 0-.42-.42h-1.66l.64-2.8a.42.42 0 0 0-.4-.5h-1.6c-.2 0-.37.13-.41.32l-.5 2.98h-3.82l-.68-2.98a.42.42 0 0 0-.4-.33h-1.53c-.2 0-.37.14-.41.33l-.7 2.98H6.34l-.6-2.97a.42.42 0 0 0-.42-.34H3.86a.42.42 0 0 0-.4.51l.62 2.8H2.42a.42.42 0 0 0-.42.42v1.39c0 .23.19.42.42.42h2.16l.25 1.1H2.42a.42.42 0 0 0-.42.42v1.4c0 .22.19.4.42.4h2.91l1.42 6.35c.04.19.21.33.4.33h1.98c.2 0 .36-.14.4-.33L11 13.1h1.92l1.47 6.34c.04.19.21.33.4.33h1.98c.2 0 .36-.14.4-.33l1.47-6.34h2.94c.23 0 .42-.19.42-.42V11.3a.42.42 0 0 0-.42-.41h-2.43l.26-1.11h2.17Zm-13.2 5.2c-.21.9-.23 1.64-.25 1.64h-.04s-.06-.76-.24-1.64l-.38-1.87h1.35l-.44 1.87Zm.96-4.1H7.02l-.23-1.1h2.8l-.25 1.1Zm2.18 0 .07-.3c.07-.27.12-.55.17-.8h.4c.05.25.1.53.17.8l.07.3h-.88Zm4.55 4.1c-.18.88-.24 1.64-.24 1.64h-.04c-.02 0-.04-.74-.25-1.64l-.43-1.87h1.36l-.4 1.87Zm.87-4.1H14.6l-.25-1.1h2.83l-.24 1.1Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.04 12h-2.15c-.28 0-.53.22-.53.5 0 4.5-3.66 6.64-7.5 6.64v-7.1l6-1.34a.54.54 0 0 0 .43-.52V8.35c0-.35-.32-.6-.66-.53L9.86 9.11V7.75l6-1.34a.54.54 0 0 0 .43-.52V4.06c0-.34-.32-.6-.66-.52L9.86 4.82V2.54c0-.3-.24-.54-.54-.54h-2.5c-.3 0-.53.24-.53.54v3.08l-2.44.54a.54.54 0 0 0-.42.52v1.83c0 .34.32.6.65.52l2.2-.49V9.9l-2.43.54a.54.54 0 0 0-.42.53v1.83c0 .34.32.6.65.52l2.2-.5v8.64c0 .3.25.54.54.54h3.55c5.99 0 9.97-3.47 10.2-9.45a.54.54 0 0 0-.53-.55Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M16.62 11.48c1.08-.56 1.77-1.54 1.61-3.18-.2-2.24-2.05-2.99-4.49-3.2V2h-1.9v3.02c-.48 0-.99 0-1.5.02V2H8.46v3.1c-.7.02-1.5.01-3.8 0v2.02c1.5-.03 2.28-.12 2.46.84v8.5c-.12.75-.72.64-2.08.62l-.38 2.25 3.8.01V22h1.9v-2.62l1.5.01V22h1.9v-2.66c3.17-.17 5.3-.97 5.58-3.96.22-2.4-.92-3.47-2.71-3.9Zm-6.24-4.22c1.07 0 4.42-.34 4.42 1.9 0 2.12-3.35 1.87-4.42 1.87V7.26Zm0 9.83v-4.16c1.28 0 5.2-.36 5.2 2.08 0 2.35-3.92 2.08-5.2 2.08Z"></path></svg>']},{title:"tool.icon.group.currency",icons:['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.61 4.25c.83-.83.24-2.25-.93-2.25H3.32a1.32 1.32 0 0 0-.93 2.25l8.36 8.36v7.52H8.56c-.86 0-1.56.7-1.56 1.56 0 .17.14.31.31.31h9.38c.17 0 .31-.14.31-.31 0-.87-.7-1.57-1.56-1.57h-2.19v-7.5l8.36-8.37Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m21.73 19.3-3.9-3.9a.94.94 0 0 0-.66-.28h-.64a8.12 8.12 0 1 0-1.4 1.4v.65c0 .25.1.48.27.66l3.9 3.9c.36.36.95.36 1.32 0l1.1-1.11a.94.94 0 0 0 0-1.33Zm-11.6-4.18a5 5 0 1 1-.01-9.99 5 5 0 0 1 0 10Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M13.88 9.5v1.25c0 .26-.22.47-.47.47h-2.2v2.19c0 .25-.2.46-.46.46H9.5a.47.47 0 0 1-.47-.46v-2.2H6.84a.47.47 0 0 1-.46-.46V9.5c0-.26.2-.47.46-.47h2.2V6.84c0-.25.2-.47.46-.47h1.25c.26 0 .47.22.47.47v2.2h2.19c.25 0 .47.2.47.46Zm7.85 11.12-1.1 1.1a.93.93 0 0 1-1.33 0l-3.9-3.89a.94.94 0 0 1-.27-.66v-.64a8.12 8.12 0 1 1 1.4-1.4h.64c.25 0 .49.1.66.27l3.9 3.9c.36.36.36.95 0 1.32Zm-6.3-10.5a5.3 5.3 0 1 0-10.6 0 5.3 5.3 0 0 0 10.6 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m11.73 8.26-6.4 5.27v5.7a.56.56 0 0 0 .56.55l3.89-.01a.56.56 0 0 0 .55-.56V15.9a.56.56 0 0 1 .56-.56h2.22a.56.56 0 0 1 .56.56v3.32a.56.56 0 0 0 .55.56h3.89a.56.56 0 0 0 .56-.55v-5.7l-6.4-5.26a.42.42 0 0 0-.54 0Zm10.12 3.58-2.9-2.4v-4.8a.42.42 0 0 0-.42-.42h-1.95a.42.42 0 0 0-.41.42v2.52L13.06 4.6a1.67 1.67 0 0 0-2.12 0l-8.79 7.24a.42.42 0 0 0-.05.59l.88 1.07a.42.42 0 0 0 .59.06l8.16-6.73a.42.42 0 0 1 .54 0l8.16 6.73a.42.42 0 0 0 .59-.05l.89-1.08a.42.42 0 0 0-.06-.59Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18.06a8.06 8.06 0 1 1 0-16.12 8.06 8.06 0 0 1 0 16.12Zm2.5-4.2-3.43-2.5a.49.49 0 0 1-.2-.38V6.35c0-.26.22-.48.48-.48h1.3c.26 0 .48.22.48.48v5.72l2.7 1.96c.21.16.25.46.1.68l-.76 1.04a.49.49 0 0 1-.68.1Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 7.63v11.25c0 1.03-.84 1.87-1.88 1.87H3.88A1.88 1.88 0 0 1 2 18.87V7.63c0-1.03.84-1.87 1.88-1.87H7.3l.48-1.29c.28-.73.98-1.21 1.76-1.21h4.9c.78 0 1.48.48 1.75 1.21l.49 1.29h3.43c1.04 0 1.88.84 1.88 1.88Zm-5.31 5.62a4.7 4.7 0 1 0-9.39 0 4.7 4.7 0 0 0 9.39 0Zm-1.25 0a3.44 3.44 0 1 1-6.89-.01 3.44 3.44 0 0 1 6.89.01Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m21.33 14.4-1.72-.99c.17-.93.17-1.9 0-2.83l1.72-1c.2-.1.28-.34.22-.56a10.04 10.04 0 0 0-2.2-3.81.49.49 0 0 0-.6-.1l-1.72 1a7.61 7.61 0 0 0-2.45-1.42V2.71a.48.48 0 0 0-.38-.47c-1.48-.33-3-.31-4.4 0a.48.48 0 0 0-.38.47V4.7c-.9.32-1.73.8-2.45 1.41l-1.72-.99a.48.48 0 0 0-.6.1 9.98 9.98 0 0 0-2.2 3.8c-.07.23.02.46.22.57l1.72 1c-.17.93-.17 1.89 0 2.83l-1.72.99a.49.49 0 0 0-.22.56 10.04 10.04 0 0 0 2.2 3.82c.16.16.4.2.6.09l1.72-1c.72.63 1.55 1.1 2.45 1.42v1.99c0 .22.16.42.38.47 1.48.33 3 .31 4.4 0a.48.48 0 0 0 .38-.47V19.3c.9-.32 1.73-.8 2.45-1.41l1.72.99c.2.11.45.08.6-.1a9.98 9.98 0 0 0 2.2-3.8.5.5 0 0 0-.22-.58Zm-9.33.82a3.23 3.23 0 1 1 0-6.46 3.23 3.23 0 0 1 0 6.46Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M13.14 2.86c-.3-1.12-1.93-1.17-2.28 0-1.83 6.17-5.73 7.84-5.73 12.18A6.91 6.91 0 0 0 12 22c3.8 0 6.88-3.11 6.88-6.96 0-4.36-3.9-5.99-5.74-12.18ZM12 19.5a4.38 4.38 0 0 1-4.38-4.38.62.62 0 1 1 1.25 0c0 1.73 1.4 3.13 3.13 3.13a.62.62 0 1 1 0 1.25Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M3.25 19.5c0 .7.56 1.25 1.25 1.25h6.25V14.5h-7.5v5Zm10 1.25h6.25c.7 0 1.25-.56 1.25-1.25v-5h-7.5v6.25Zm7.5-12.5h-1.64a3.4 3.4 0 0 0-3.05-5c-1.62 0-2.67.83-4.02 2.67-1.35-1.84-2.4-2.67-4.02-2.67a3.44 3.44 0 0 0-3.44 3.44c0 .56.15 1.09.4 1.56H3.24C2.55 8.25 2 8.81 2 9.5v3.13c0 .34.28.62.63.62h18.75c.34 0 .62-.28.62-.63V9.5c0-.7-.56-1.25-1.25-1.25Zm-12.74 0a1.56 1.56 0 1 1 0-3.13c.78 0 1.35.13 3.37 3.13H8Zm8.05 0H12.7c2-2.99 2.57-3.13 3.36-3.13a1.56 1.56 0 1 1 0 3.13Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18.67 9.78H14.7l-3.65-6.39a.56.56 0 0 0-.48-.28H8.29a.56.56 0 0 0-.53.7l1.7 5.97H5.89l-1.5-2a.56.56 0 0 0-.45-.22H2.56a.56.56 0 0 0-.54.69L3.12 12l-1.1 3.75c-.1.35.17.7.54.7h1.38c.18 0 .34-.09.45-.23l1.5-2h3.57l-1.7 5.96c-.1.36.16.7.53.7h2.28c.2 0 .38-.1.48-.27l3.65-6.39h3.97c1.22 0 3.33-1 3.33-2.22 0-1.23-2.1-2.22-3.33-2.22Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M8.4 7.78H2.48A.47.47 0 0 1 2 7.31V4.2a1.4 1.4 0 0 1 1.4-1.4h4.07a1.4 1.4 0 0 1 1.4 1.4V7.3a.46.46 0 0 1-.46.47ZM22 7.31V4.2a1.4 1.4 0 0 0-1.4-1.41h-4.07a1.4 1.4 0 0 0-1.4 1.4v3.13a.47.47 0 0 0 .46.47h5.94A.46.46 0 0 0 22 7.3Zm-6.4 1.72a.47.47 0 0 0-.47.47v2.03c0 5-6.26 5-6.26 0V9.5a.47.47 0 0 0-.46-.47H2.47a.47.47 0 0 0-.47.48c0 .83.03 1.57 0 2.08 0 5.88 5.32 9.63 10.03 9.63 4.71 0 9.96-3.75 9.96-9.64-.02-.5 0-1.29 0-2.07a.47.47 0 0 0-.46-.48h-5.94Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15 14.5h1.5c.25 0 .5-.25.5-.5V8.75c0-.25-.25-.5-.5-.5H15c-.25 0-.5.25-.5.5V14c0 .25.25.5.5.5Zm3.75 0h1.5c.25 0 .5-.25.5-.5V5c0-.25-.25-.5-.5-.5h-1.5c-.25 0-.5.25-.5.5v9c0 .25.25.5.5.5Zm-11.25 0H9c.25 0 .5-.25.5-.5v-2.75c0-.25-.25-.5-.5-.5H7.5c-.25 0-.5.25-.5.5V14c0 .25.25.5.5.5Zm3.75 0h1.5c.25 0 .5-.25.5-.5V6.25c0-.25-.25-.5-.5-.5h-1.5c-.25 0-.5.25-.5.5V14c0 .25.25.5.5.5ZM21.38 17H4.5V5.12a.62.62 0 0 0-.63-.62H2.63a.62.62 0 0 0-.62.63v13.12c0 .69.56 1.25 1.25 1.25h18.13c.34 0 .62-.28.62-.63v-1.25a.62.62 0 0 0-.63-.62Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 8.88a6.87 6.87 0 0 1-8.16 6.75l-.94 1.06a.94.94 0 0 1-.7.31h-1.45v1.56c0 .52-.42.94-.94.94H8.25v1.56c0 .52-.42.94-.94.94H2.94a.94.94 0 0 1-.94-.94v-3.05c0-.25.1-.48.27-.66l6.32-6.32A6.87 6.87 0 1 1 22 8.88ZM15.12 7a1.88 1.88 0 1 0 3.76 0 1.88 1.88 0 0 0-3.75 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m21.45 7.55-1.8 1.8a.47.47 0 0 1-.67 0L14.65 5a.47.47 0 0 1 0-.66l1.8-1.8a1.88 1.88 0 0 1 2.65 0l2.35 2.35c.73.73.73 1.91 0 2.65ZM13.1 5.9 2.84 16.15l-.83 4.75a.94.94 0 0 0 1.1 1.09l4.74-.84L18.1 10.9a.47.47 0 0 0 0-.67L13.77 5.9a.47.47 0 0 0-.67 0Zm-6.25 9.37a.54.54 0 0 1 0-.77l6.01-6.01a.54.54 0 0 1 .78 0c.21.21.21.55 0 .77l-6.02 6.01a.54.54 0 0 1-.77 0Zm-1.41 3.29H7.3v1.42l-2.52.44-1.21-1.22.44-2.51h1.42v1.87Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 11.44c0-.82-.45-1.52-1.11-1.9V4.21c0-.3-.24-1.1-1.11-1.1-.25 0-.5.07-.7.23l-2.95 2.37a8.43 8.43 0 0 1-5.24 1.84H4.22C3 7.56 2 8.55 2 9.78v3.33c0 1.23 1 2.22 2.22 2.22H5.4a8.8 8.8 0 0 0 .81 4.96c.18.38.58.6.99.6h2.58c.9 0 1.45-1.04.9-1.76a4.42 4.42 0 0 1-.76-3.8h.98c1.9 0 3.76.66 5.24 1.84l2.95 2.36c.2.16.45.25.7.25.86 0 1.1-.8 1.1-1.11v-5.31A2.21 2.21 0 0 0 22 11.44Zm-3.33 4.91-1.15-.91a10.65 10.65 0 0 0-6.63-2.33V9.78c2.4 0 4.75-.83 6.63-2.33l1.15-.92v9.82Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.41 16.15c-.75-.8-2.16-2.03-2.16-6.02a6.17 6.17 0 0 0-5-6.07v-.81a1.25 1.25 0 1 0-2.5 0v.81c-2.87.6-5 3.03-5 6.07 0 4-1.4 5.21-2.16 6.02a1.25 1.25 0 0 0 .92 2.1H19.5a1.25 1.25 0 0 0 .91-2.1Zm-14.52.23c.83-1.1 1.73-2.9 1.74-6.23v-.03a4.37 4.37 0 1 1 8.75 0v.03c0 3.32.9 5.13 1.73 6.22H5.9ZM12 22a2.5 2.5 0 0 0 2.5-2.5h-5A2.5 2.5 0 0 0 12 22Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 8.5c-1.66 0-3 1.57-3 3.5s1.34 3.5 3 3.5 3-1.57 3-3.5-1.34-3.5-3-3.5Zm1.25 5.25c0 .14-.11.25-.25.25h-2a.25.25 0 0 1-.25-.25v-.5c0-.14.11-.25.25-.25h.5v-1.73h-.01a.25.25 0 0 1-.35-.06l-.28-.42a.25.25 0 0 1 .07-.34l.48-.32a.75.75 0 0 1 .42-.13h.42c.14 0 .25.11.25.25V13h.5c.14 0 .25.11.25.25v.5ZM21 6H3a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1Zm-.5 8.5a2 2 0 0 0-2 2h-13a2 2 0 0 0-2-2v-5a2 2 0 0 0 2-2h13c0 1.1.9 2 2 2v5Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m21.73 9.79-.89-.89a.94.94 0 0 0-1.32 0l-.23.22-4.41-4.41.22-.23a.94.94 0 0 0 0-1.32l-.89-.89a.94.94 0 0 0-1.32 0L8.03 7.14a.94.94 0 0 0 0 1.32l.88.89c.37.36.96.36 1.32 0l.23-.23L12 10.67l-3.16 3.17-.22-.22a1.25 1.25 0 0 0-1.77 0L2.37 18.1a1.25 1.25 0 0 0 0 1.77l1.76 1.76c.5.5 1.28.5 1.77 0l4.48-4.48c.5-.49.5-1.28 0-1.77l-.22-.22L13.33 12l1.55 1.54-.23.23a.94.94 0 0 0 0 1.32l.89.88c.36.37.96.37 1.32 0l4.87-4.86a.94.94 0 0 0 0-1.32Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 5.13a3.75 3.75 0 0 0-3.75 3.75.62.62 0 1 0 1.25 0 2.5 2.5 0 0 1 2.5-2.5.62.62 0 1 0 0-1.25Zm-3.12 14.8c0 .13.03.25.1.35l.96 1.44c.12.18.31.28.52.28h3.08c.2 0 .4-.1.52-.28l.96-1.44c.07-.1.1-.22.1-.34v-1.69H8.88v1.69ZM12 2a6.85 6.85 0 0 0-5.17 11.4c.65.74 1.67 2.3 2.04 3.6h1.88c0-.2-.03-.38-.08-.55-.22-.7-.9-2.53-2.43-4.29A4.98 4.98 0 0 1 12 3.88a5 5 0 0 1 3.76 8.28 12.34 12.34 0 0 0-2.42 4.28c-.06.18-.09.37-.09.56h1.88c.37-1.3 1.4-2.86 2.04-3.6A6.88 6.88 0 0 0 12 2Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 22a2.5 2.5 0 0 0 2.5-2.5h-5A2.5 2.5 0 0 0 12 22Zm8.41-5.85c-.75-.8-2.16-2.03-2.16-6.02a6.17 6.17 0 0 0-5-6.07v-.81a1.25 1.25 0 1 0-2.5 0v.81c-2.87.6-5 3.03-5 6.07 0 4-1.4 5.21-2.16 6.02a1.25 1.25 0 0 0 .92 2.1H19.5a1.25 1.25 0 0 0 .91-2.1Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.73 2.75a.67.67 0 0 0-.48-.48C20 2 19.01 2 18.03 2 14 2 11.58 4.16 9.78 7H5.7c-.63 0-1.38.46-1.67 1.03L2.1 11.9a.94.94 0 0 0 .84 1.36h4.05l-.88.88c-.44.44-.5 1.26 0 1.77l2 1.98c.43.44 1.25.52 1.76 0l.88-.87v4.05a.94.94 0 0 0 1.36.84l3.85-1.93A2.05 2.05 0 0 0 17 18.3v-4.08c2.83-1.81 5-4.24 5-8.25C22 5 22 4 21.73 2.75ZM17 8.56a1.56 1.56 0 1 1 0-3.12 1.56 1.56 0 0 1 0 3.12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M2.42 15.34h1.13c.76 3.58 4.76 5.58 8.45 5.58 3.7 0 7.7-2 8.45-5.58h1.13c.37 0 .56-.45.3-.7l-2.34-2.34a.42.42 0 0 0-.59 0l-2.33 2.33a.42.42 0 0 0 .3.71h1.22c-.71 1.9-2.96 3.02-5.03 3.28V12h1.82c.23 0 .41-.19.41-.42v-1.4a.42.42 0 0 0-.41-.41H13.1v-.19a3.35 3.35 0 1 0-2.22 0v.19H9.07a.42.42 0 0 0-.41.42v1.4c0 .22.18.41.41.41h1.82v6.62c-2.06-.26-4.32-1.38-5.03-3.28H7.1c.37 0 .56-.45.3-.7L5.04 12.3a.42.42 0 0 0-.6 0l-2.33 2.33a.42.42 0 0 0 .3.71ZM12 5.31a1.12 1.12 0 1 1 0 2.23 1.12 1.12 0 0 1 0-2.23Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M19.63 16.42a2.81 2.81 0 0 0-1.7-5.04h-.54A2.49 2.49 0 0 0 15.75 7h-.23a3.75 3.75 0 0 0-4.1-4.94A3.1 3.1 0 0 1 8.87 7h-.63a2.49 2.49 0 0 0-1.64 4.38h-.55a2.81 2.81 0 0 0-1.7 5.04A2.8 2.8 0 0 0 4.82 22H19.2a2.81 2.81 0 0 0 .44-5.58ZM9.5 12a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm6.23 5.43c-.41 1.09-2.28 2.07-3.73 2.07-1.45 0-3.32-.98-3.73-2.07a.32.32 0 0 1 .3-.43h6.86c.22 0 .38.22.3.43ZM14.5 14.5a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5Z"></path></svg>']},{title:"tool.icon.group.objects",icons:['<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m13.5 20.44-1 1c-.41.41-1.1.41-1.5 0L2.3 12.75a1.07 1.07 0 0 1 0-1.51L11 2.57c.42-.42 1.1-.42 1.52 0l.99.99c.42.42.41 1.12-.02 1.53L8.1 10.21h12.83c.6 0 1.07.48 1.07 1.08v1.42c0 .6-.48 1.08-1.07 1.08H8.1l5.38 5.12c.44.42.45 1.1.02 1.53Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m10.5 3.56 1-1c.41-.41 1.1-.41 1.5 0l8.69 8.68c.41.42.41 1.1 0 1.51L13 21.43c-.42.42-1.1.42-1.52 0l-.99-.99a1.07 1.07 0 0 1 .02-1.53l5.38-5.12H3.07c-.6 0-1.07-.48-1.07-1.08V11.3c0-.6.48-1.08 1.07-1.08H15.9L10.52 5.1a1.06 1.06 0 0 1-.02-1.53Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m3.56 13.5-.99-1a1.07 1.07 0 0 1 0-1.5l8.67-8.69c.42-.41 1.1-.41 1.52 0L21.43 11c.42.42.42 1.1 0 1.51l-1 1c-.42.42-1.1.4-1.52-.03L13.79 8.1v12.83c0 .6-.48 1.07-1.07 1.07h-1.43c-.6 0-1.07-.48-1.07-1.07V8.1l-5.13 5.38c-.41.44-1.1.45-1.53.02Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m20.44 10.5 1 1c.41.41.41 1.1 0 1.5l-8.68 8.69c-.42.41-1.1.41-1.51 0L2.57 13a1.07 1.07 0 0 1 0-1.52l.99-.99a1.07 1.07 0 0 1 1.53.02l5.12 5.38V3.07c0-.6.48-1.07 1.08-1.07h1.42c.6 0 1.08.48 1.08 1.07V15.9l5.12-5.38c.42-.44 1.1-.45 1.53-.02Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m6.25 11.22 8.9-8.9a1.1 1.1 0 0 1 1.56 0l1.04 1.04a1.1 1.1 0 0 1 0 1.55L10.69 12l7.06 7.09a1.1 1.1 0 0 1 0 1.55l-1.04 1.04a1.1 1.1 0 0 1-1.56 0l-8.9-8.9a1.1 1.1 0 0 1 0-1.56Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m17.75 12.78-8.9 8.9a1.1 1.1 0 0 1-1.56 0l-1.04-1.04a1.1 1.1 0 0 1 0-1.55L13.31 12 6.25 4.91a1.1 1.1 0 0 1 0-1.55L7.3 2.32a1.1 1.1 0 0 1 1.56 0l8.9 8.9a1.1 1.1 0 0 1 0 1.56Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m12.78 6.25 8.9 8.9a1.1 1.1 0 0 1 0 1.56l-1.04 1.04a1.1 1.1 0 0 1-1.55 0L12 10.69l-7.09 7.06a1.1 1.1 0 0 1-1.55 0L2.32 16.7a1.1 1.1 0 0 1 0-1.56l8.9-8.9a1.1 1.1 0 0 1 1.56 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m11.22 17.75-8.9-8.9a1.1 1.1 0 0 1 0-1.56l1.04-1.04a1.1 1.1 0 0 1 1.55 0L12 13.31l7.09-7.06a1.1 1.1 0 0 1 1.55 0l1.04 1.04a1.1 1.1 0 0 1 0 1.56l-8.9 8.9a1.1 1.1 0 0 1-1.56 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.36 16.76h-1.8V7.24h1.8a.94.94 0 0 0 .66-1.6l-3.36-3.37a.94.94 0 0 0-1.32 0L7.98 5.64c-.6.59-.18 1.6.66 1.6h1.8v9.52h-1.8a.94.94 0 0 0-.66 1.6l3.36 3.37c.36.36.96.36 1.32 0l3.36-3.37c.6-.59.18-1.6-.66-1.6Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M16.76 8.64v1.8H7.24v-1.8a.94.94 0 0 0-1.6-.66l-3.37 3.36a.94.94 0 0 0 0 1.32l3.37 3.36c.59.6 1.6.18 1.6-.66v-1.8h9.52v1.8a.94.94 0 0 0 1.6.66l3.37-3.36a.94.94 0 0 0 0-1.32l-3.37-3.36a.94.94 0 0 0-1.6.66Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 1 0 20 10 10 0 0 1 0-20Zm-1.17 5.79 3.05 2.92H6.52a.97.97 0 0 0-.97.97v.64c0 .54.43.97.97.97h7.36l-3.05 2.92c-.39.37-.4 1-.01 1.38l.44.44c.38.38 1 .38 1.37 0l5.35-5.34c.38-.38.38-1 0-1.37l-5.35-5.36a.96.96 0 0 0-1.37 0l-.44.44a.97.97 0 0 0 .01 1.39Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M2 12a10 10 0 1 1 20 0 10 10 0 0 1-20 0Zm5.79 1.17 2.92-3.05v7.36c0 .54.43.97.97.97h.64c.54 0 .97-.43.97-.97v-7.36l2.92 3.05c.37.39 1 .4 1.38.01l.44-.44c.38-.38.38-1 0-1.37L12.7 6.02a.96.96 0 0 0-1.37 0l-5.36 5.35a.96.96 0 0 0 0 1.37l.44.44a.97.97 0 0 0 1.39-.01Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Zm-5.79-1.17-2.92 3.05V6.52a.97.97 0 0 0-.97-.97h-.64a.97.97 0 0 0-.97.97v7.36l-2.92-3.05c-.37-.39-1-.4-1.38-.01l-.44.44a.96.96 0 0 0 0 1.37l5.34 5.35c.38.38 1 .38 1.37 0l5.35-5.35c.38-.38.38-1 0-1.37l-.44-.44a.97.97 0 0 0-1.38.01Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M17.67 3.35v17.3c0 1.2-1.45 1.8-2.3.95l-8.65-8.65a1.34 1.34 0 0 1 0-1.9l8.66-8.65c.84-.85 2.3-.25 2.3.95Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M6.33 20.65V3.35c0-1.2 1.45-1.8 2.3-.95l8.65 8.65c.52.52.52 1.38 0 1.9L8.62 21.6c-.84.85-2.3.25-2.3-.95Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M3.35 6.33h17.3c1.2 0 1.8 1.44.95 2.3l-8.65 8.65c-.52.52-1.38.52-1.9 0L2.4 8.62c-.85-.85-.25-2.3.95-2.3Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20.65 17.67H3.35c-1.2 0-1.8-1.45-.95-2.3l8.65-8.65a1.34 1.34 0 0 1 1.9 0l8.65 8.66c.85.84.25 2.3-.95 2.3Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m12.85 11.98 6.83 6.83a1.2 1.2 0 0 1 0 1.7l-1.14 1.13a1.2 1.2 0 0 1-1.7 0L12 16.81l-4.84 4.84a1.2 1.2 0 0 1-1.7 0L4.33 20.5a1.2 1.2 0 0 1 0-1.7L11.15 12a1.2 1.2 0 0 1 1.7 0Zm-1.7-9.63L4.33 9.18a1.2 1.2 0 0 0 0 1.7L5.46 12a1.2 1.2 0 0 0 1.7 0l4.83-4.84 4.84 4.84a1.2 1.2 0 0 0 1.7 0l1.13-1.13a1.2 1.2 0 0 0 0-1.7l-6.82-6.83a1.2 1.2 0 0 0-1.7 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M11.15 12.01 4.32 5.2a1.2 1.2 0 0 1 0-1.7l1.14-1.14a1.2 1.2 0 0 1 1.7 0l4.83 4.84 4.84-4.84a1.2 1.2 0 0 1 1.7 0l1.15 1.13a1.2 1.2 0 0 1 0 1.7l-6.83 6.83a1.2 1.2 0 0 1-1.7 0Zm1.7 9.64 6.83-6.83a1.2 1.2 0 0 0 0-1.7L18.54 12a1.2 1.2 0 0 0-1.7 0L12 16.82l-4.84-4.84a1.2 1.2 0 0 0-1.7 0l-1.14 1.14a1.2 1.2 0 0 0 0 1.7l6.83 6.82a1.2 1.2 0 0 0 1.7 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m5.98 10.94 8.5-8.5a1.5 1.5 0 0 1 2.12 0L18 3.85a1.5 1.5 0 0 1 0 2.12L11.99 12l6.03 6.02a1.5 1.5 0 0 1 0 2.12l-1.42 1.42a1.5 1.5 0 0 1-2.11 0l-8.5-8.5a1.5 1.5 0 0 1 0-2.12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m18.01 13.06-8.5 8.5a1.5 1.5 0 0 1-2.11 0l-1.41-1.41a1.5 1.5 0 0 1 0-2.12L12 12 5.99 5.98a1.5 1.5 0 0 1 0-2.11l1.4-1.43a1.5 1.5 0 0 1 2.12 0l8.5 8.5c.6.59.6 1.53 0 2.12Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m13.06 5.98 8.5 8.5a1.5 1.5 0 0 1 0 2.12L20.15 18a1.5 1.5 0 0 1-2.12 0L12 11.99l-6.02 6.03a1.5 1.5 0 0 1-2.12 0L2.44 16.6a1.5 1.5 0 0 1 0-2.11l8.5-8.5a1.5 1.5 0 0 1 2.12 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m10.94 18.02-8.5-8.5a1.5 1.5 0 0 1 0-2.12l1.41-1.42a1.5 1.5 0 0 1 2.12 0L12 12.01l6.03-6.03a1.5 1.5 0 0 1 2.12 0l1.4 1.42a1.5 1.5 0 0 1 0 2.11l-8.5 8.5c-.57.6-1.52.6-2.1 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20Zm-4.6-9.31 5.47 5.46c.38.38 1 .38 1.37 0l.68-.69c.38-.38.38-.99 0-1.36l-4.1-4.1 4.1-4.1c.38-.38.38-.99 0-1.36l-.68-.69a.96.96 0 0 0-1.37 0l-5.46 5.46a.97.97 0 0 0 0 1.38Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M2 12a10 10 0 1 1 20 0 10 10 0 0 1-20 0Zm9.31-4.6-5.46 5.47a.96.96 0 0 0 0 1.37l.69.68c.38.38.99.38 1.36 0l4.1-4.1 4.1 4.1c.38.38.99.38 1.36 0l.69-.68c.38-.38.38-1 0-1.37l-5.46-5.46a.97.97 0 0 0-1.38 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M22 12a10 10 0 1 1-20 0 10 10 0 0 1 20 0Zm-9.31 4.6 5.46-5.47c.38-.38.38-1 0-1.37l-.69-.68a.96.96 0 0 0-1.36 0l-4.1 4.1-4.1-4.1a.96.96 0 0 0-1.36 0l-.69.68a.96.96 0 0 0 0 1.37l5.46 5.46c.38.38 1 .38 1.38 0Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M2.32 9.42 9.2 3.48a.94.94 0 0 1 1.55.7v3.14C17.02 7.39 22 8.64 22 14.59c0 2.4-1.55 4.78-3.26 6.02-.53.39-1.29-.1-1.1-.73 1.78-5.66-.83-7.16-6.89-7.25v3.43a.94.94 0 0 1-1.55.71l-6.88-5.94a.94.94 0 0 1 0-1.41Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M21.68 9.42 14.8 3.48a.94.94 0 0 0-1.55.7v3.14C6.98 7.39 2 8.64 2 14.59c0 2.4 1.55 4.78 3.26 6.02.53.39 1.29-.1 1.1-.73-1.78-5.66.83-7.16 6.89-7.25v3.43c0 .81.95 1.23 1.55.71l6.88-5.94a.94.94 0 0 0 0-1.41Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M18 6.67 13.94 2.3c-.37-.4-1-.4-1.38 0L8.5 6.67a.94.94 0 0 0 .69 1.58h2.5v10.63H8.4a.47.47 0 0 0-.33.13l-2.2 2.19c-.29.3-.08.8.34.8h7.66c.51 0 .93-.42.93-.94V8.25h2.5A.94.94 0 0 0 18 6.67Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m18 17.33-4.06 4.37c-.37.4-1 .4-1.38 0L8.5 17.33a.94.94 0 0 1 .69-1.58h2.5V5.12H8.4A.47.47 0 0 1 8.08 5L5.88 2.8c-.29-.3-.08-.8.34-.8h7.66c.51 0 .93.42.93.94v12.81h2.5c.82 0 1.25.98.69 1.58Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M7.98 13.79h13.48c.3 0 .54-.24.54-.54v-2.5c0-.3-.24-.54-.54-.54H7.98V8.16c0-.96-1.15-1.43-1.82-.76L2.3 11.24c-.41.42-.41 1.1 0 1.52l3.85 3.84c.67.67 1.82.2 1.82-.76V13.8Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M16.02 10.21H2.54c-.3 0-.54.24-.54.54v2.5c0 .3.24.54.54.54h13.48v2.05c0 .96 1.15 1.43 1.82.76l3.85-3.84c.41-.42.41-1.1 0-1.52L17.84 7.4a1.07 1.07 0 0 0-1.82.76v2.05Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M13.79 16.02V2.54c0-.3-.24-.54-.54-.54h-2.5c-.3 0-.54.24-.54.54v13.48H8.16a1.07 1.07 0 0 0-.76 1.82l3.84 3.85c.42.41 1.1.41 1.52 0l3.84-3.85c.67-.67.2-1.82-.76-1.82H13.8Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M10.21 7.98v13.48c0 .3.24.54.54.54h2.5c.3 0 .54-.24.54-.54V7.98h2.05c.96 0 1.43-1.15.76-1.82L12.76 2.3a1.07 1.07 0 0 0-1.52 0L7.4 6.16c-.67.67-.2 1.82.76 1.82h2.05Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20Zm0-18.06a8.06 8.06 0 1 1 0 16.12 8.06 8.06 0 0 1 0-16.12Zm-.8 2.9h1.6c.27 0 .49.22.49.48V12h2.7c.43 0 .65.52.34.83l-3.99 3.99a.48.48 0 0 1-.68 0l-4-4a.48.48 0 0 1 .35-.82h2.7V7.32c0-.26.22-.48.48-.48Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 18.06a8.06 8.06 0 1 1 0-16.12 8.06 8.06 0 0 1 0 16.12Zm.8-2.9h-1.6a.49.49 0 0 1-.49-.48V12h-2.7a.48.48 0 0 1-.34-.83l3.99-3.99c.19-.19.5-.19.68 0l4 4c.3.3.08.82-.35.82h-2.7v4.68c0 .26-.22.48-.48.48Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m11.5 14.65-4.14 4.14 1.47 1.38c.67.68.2 1.83-.76 1.83h-5C2.47 22 2 21.52 2 20.93v-5c0-.96 1.15-1.43 1.83-.76l1.38 1.47 4.14-4.13a.71.71 0 0 1 1.01 0l1.13 1.13c.28.28.28.73 0 1Zm1-5.3 4.14-4.14-1.47-1.38c-.67-.68-.2-1.83.76-1.83h5c.6 0 1.07.48 1.07 1.07v5c0 .96-1.15 1.43-1.83.76L18.8 7.36l-4.14 4.13a.71.71 0 0 1-1.01 0l-1.13-1.13a.71.71 0 0 1 0-1Z"></path></svg>','<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="m2.2 19.65 4.44-4.44-1.47-1.38c-.67-.68-.2-1.83.76-1.83h5c.6 0 1.07.48 1.07 1.07v5c0 .96-1.15 1.43-1.83.76L8.8 17.36l-4.44 4.43a.71.71 0 0 1-1 0L2.2 20.66a.71.71 0 0 1 0-1.01Zm19.6-15.3L17.35 8.8l1.47 1.38c.67.68.2 1.83-.76 1.83h-5c-.6 0-1.07-.48-1.07-1.07v-5c0-.96 1.15-1.43 1.83-.76l1.38 1.47 4.44-4.43a.71.71 0 0 1 1 0l1.14 1.13c.28.28.28.73 0 1.01Z"></path></svg>']}],IconToolType="tool.icon";class IconPaneView extends SvgIconPaneView{_iconColor(){return this._source.properties().color}}class IconPrimitive extends SvgIconPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new IconPaneView(this,this.model));Ee(this,"_paneView",[this._lines])}}class IconTool extends SvgIconTool{constructor(){super(...arguments);Ee(this,"type",IconToolType)}createPrimitive(){var ee;return new IconPrimitive({id:this.id,points:[],color:"#2962FFFF",size:40,icon:ensure((ee=this.presetProps)==null?void 0:ee.icon),angle:.5*Math.PI},...this.resetArgs)}}const iconIcon={type:IconToolType,icon:icon$2,Ctor:IconTool},icon$1=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" d="M2 9.75a1.5 1.5 0 0 0-1.5 1.5v5.5a1.5 1.5 0 0 0 1.5 1.5h24a1.5 1.5 0 0 0 1.5-1.5v-5.5a1.5 1.5 0 0 0-1.5-1.5zm0 1h3v2.5h1v-2.5h3.25v3.9h1v-3.9h3.25v2.5h1v-2.5h3.25v3.9h1v-3.9H22v2.5h1v-2.5h3a.5.5 0 0 1 .5.5v5.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-5.5a.5.5 0 0 1 .5-.5z" transform="rotate(-45 14 14)"></path></svg>
`,MeasureToolType="tool.measure";class MeasurePrimitive extends DateAndPriceRangePrimitive{constructor(){super(...arguments);Ee(this,"disableUserSelection",!0)}properties(){const ee=super.properties();if(this.controlPoints.length<2)return ee;const[ne,re]=this.controlPoints,se=ne.price;return re.price>se?Object.assign({},ee,{background:ee.upBackground,labelBackground:ee.upColor,lineColor:ee.upColor}):Object.assign({},ee,{background:ee.downBackground,labelBackground:ee.downColor,lineColor:ee.downColor})}}class MeasureTool extends DateAndPriceRangeTool{constructor(){super(...arguments);Ee(this,"type",MeasureToolType)}getProps(ee){return{...super.getProps(ee),textColor:"#fff",lineWidth:1,upColor:"#2A62FF",upBackground:"#2A62FF26",downColor:"#F7525F",downBackground:"#F7525F26",drawBorder:!1,boxShadow:"",showAnchors:!1}}createPrimitive(ee){return new MeasurePrimitive(this.getProps(ee),...this.resetArgs)}}const measure={type:MeasureToolType,icon:icon$1,Ctor:MeasureTool},icon=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path d="M17.646 18.354l4 4 .708-.708-4-4z"></path><path d="M12.5 21a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17zm0-1a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15z"></path><path d="M9 13h7v-1H9z"></path><path d="M13 16V9h-1v7z"></path></svg>
`,ZoomInToolType="tool.zoomIn";class ZoomInPaneView extends ToolPaneView{constructor(){super(...arguments);Ee(this,"_backgroundRenderer",new RectangleRenderer);Ee(this,"_renderer",new CompositeRenderer(this._hitTestCollector))}renderer(){return this._renderer}_updateImpl(){this._renderer.clear(),!(this.points().length<2)&&(this._backgroundRenderer.setData({points:this.points(),color:"#2962FFFF",lineWidth:1,lineStyle:LineStyleType.solid,backColor:"#2962FF26"}),this._renderer.append(this._backgroundRenderer))}}class ZoomInPrimitive extends ToolPrimitive{constructor(){super(...arguments);Ee(this,"_lines",new ZoomInPaneView(this,this.model));Ee(this,"_paneView",[this._lines]);Ee(this,"disableUserSelection",!0)}updateAllViews(){if(!this.controlPoints.length)return;const[ee,ne]=this.controlPoints;if(!ne)return;const re=this.pointToScreenPoint(ee),se=this.pointToScreenPoint(ne),ae=[new AnchorPoint(re,{pointIndex:0}),new AnchorPoint(se,{pointIndex:1})];this._lines.update({points:ae})}}var __getOwnPropDesc$5=Object.getOwnPropertyDescriptor,__decorateClass$5=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$5(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$5=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let ZoomInTool=class extends DrawingTool{constructor(te){super();Ee(this,"type",ZoomInToolType);Ee(this,"steps",2);this.chartManagementService=te}createPrimitive(){return new ZoomInPrimitive({id:this.id,points:[]},...this.resetArgs)}finishDrawing(){var ne;super.finishDrawing();const[te,ee]=ensure(this._drawingSession).primitive.controlPoints;(ne=this._drawingSession)==null||ne.detach(),this.chartService.zoomToViewport(te.time,ee.time,te.price,ee.price)}activated(){super.activated(),this.chartManagementService.setPaneCursor(PaneCursor.zoomIn,!0)}deactivated(){var te;(te=this._drawingSession)==null||te.detach(),super.deactivated(),this.chartManagementService.setPaneCursor(PaneCursor.unset)}useMagnetedPosition(){return!1}isDrawingTool(){return!1}};ZoomInTool=__decorateClass$5([__decorateParam$5(0,IChartManagementService)],ZoomInTool);const zoomIn={type:ZoomInToolType,icon,Ctor:ZoomInTool};var __getOwnPropDesc$4=Object.getOwnPropertyDescriptor,__decorateClass$4=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$4(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$4=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let DrawingContrib=class extends Disposable{constructor(te,ee,ne,re,se,ae,le){super();Ee(this,"_primitives",new Map);Ee(this,"_hiddenPrimitives",new Map);Ee(this,"_hitTestObjects",new Map);Ee(this,"_pendingHitTestObjects",new Map);Ee(this,"_model");Ee(this,"_currentDrag");Ee(this,"_demoHighlight");Ee(this,"_toolbar");Ee(this,"_visible",!0);this.chartService=te,this.chartManagementService=ee,this.toolService=ne,this.commandService=se,this._model=new ToolModel(te,le),ne.activeTool||ne.switchTool(CursorCrossToolType),this._register(this._toolbar=re.showComponent({Component:Toolbar,props:{visible:!1,...this.getToolbarHandlers()}})),this._register(this._model.onFocus(()=>{this._toolbar.update({visible:!0})})),this._register(this._model.onBlur(()=>{this._toolbar.update({visible:!1})})),this._register(te.onChartBlur(()=>{this._model.currentActive&&this._model.blur(this._model.currentActive)})),this._register(te.onCrosshairMove(ce=>{var ze;this.model.setCurrentPoint(ce.point?new Point(ce.localX,ce.localY):null);const he=ee.getDefaultPaneCursor();if(showDemoCursor(he)&&!this._demoHighlight&&ce.point){const He=ensure(ce.paneIndex),We=ensure(this.chartService.getPane(He));this._demoHighlight=new DemoHighlightPrimitive({x:ce.point.x,y:ce.point.y,radius:18,background:DemoHighlightBackground},()=>{this._demoHighlight&&(We==null||We.detachPrimitive(this._demoHighlight))}),We.attachPrimitive(this._demoHighlight)}if(this._demoHighlight&&(!showDemoCursor(he)||!ce.point)&&(this._demoHighlight.detach(),this._demoHighlight=void 0),this._currentDrag)return;if(!ce.point){this._model.unhover(this._model.currentHovered);return}const{x:fe,y:Ae}=ce.point;(ze=this._demoHighlight)==null||ze.updateData({x:fe,y:Ae});const pe=this._hitTest(fe,Ae);if(!pe){this._model.unhover(this._model.currentHovered);return}const{primitiveId:Oe,hitTestResult:Fe}=pe,Ne=ensure(this._primitives.get(Oe));this._model.setHoveredSource(Ne,Fe),showCursor(he,PaneCursor.eraser)||this._updateCursor(Fe,!1)})),this._register(te.onClick(ce=>{var Ae;if((Ae=ce.sourceEvent)!=null&&Ae.shiftKey){const pe=ensure(ce.paneIndex),Oe=ensure(getXCoordinate(this.chartService,ce.localX,{useExtended:!0})),Fe=ensure(ensure(this.chartService.getPaneSeries(pe)).coordinateToPrice(ce.localY));this.commandService.executeCommand(MeasureToolType,this.chartService,{points:[{time:Oe,price:Fe}]});return}const he=this._hitTest(ce.localX,ce.localY);if(!he){this.model.currentActive&&this._model.blur(this._model.currentActive);return}const fe=ensure(this._primitives.get(he.primitiveId));showCursor(ee.getDefaultPaneCursor(),PaneCursor.eraser)?this.detachPrimitive(fe):(this._model.currentActive===fe&&isTextDetails(he.hitTestResult.details)&&ensure(fe.asTextToolPrimitive()).startTextEditing(),this._model.focus(fe))})),this._register(te.onMouseDragStart(()=>{var He;((He=this.toolService.activeTool)==null?void 0:He.type)!==MeasureToolType&&this._clearMeasure();const ce=this.chartService.chart.getCrosshairPosition();if(!isValidPosition(ce))return;const he=this._hitTest(ce.x,ce.y);if(!he)return;const{primitiveId:fe,hitTestResult:Ae}=he,pe=ensure(this._primitives.get(fe)),Oe=ensure(this.chartService.chart.timeScale().coordinateToTimeEx(ce.x)),Fe=ensure(ce.paneIndex),Ne=ensure(this.chartService.getPaneSeries(Fe)),ze=ensure(Ne.coordinateToPrice(ce.y));this._currentDrag={primitive:pe,hitTestResult:Ae,points:cloneDeep(pe.controlPoints),startX:ce.x,startTime:Oe,startY:ce.y,startPrice:ze,takeEffect:!1,series:Ne,editScope:ne.acquireToolScope({useMagnet:Ae.target===HitTarget.MovePoint,isDrawing:!0})},this._model.setHoveredSource(pe,Ae),this._disableDefaultDrag(),this._updateCursor(Ae,!0)})),this._register(te.onMouseDrag(ce=>{var Fe,Ne;if(!this._currentDrag)return;this._updateCursor(this._currentDrag.hitTestResult,!0);const he=this.chartService.chart.getCrosshairPosition();if(!this._currentDrag.takeEffect){if(euclideanDistance(he.x,he.y,this._currentDrag.startX,this._currentDrag.startY)<DragEffectMinDistance)return;this._currentDrag.takeEffect=!0,(Ne=(Fe=this._currentDrag.primitive).onDragStart)==null||Ne.call(Fe,this._currentDrag.hitTestResult),this.model.focus(this._currentDrag.primitive),this._toolbar.update({visible:!1})}const fe=new Point(he),Ae=this._currentDrag.hitTestResult.details;let pe,Oe;if(isAnchorDetails(Ae)&&(this.model.markPointEditingStarted(this._currentDrag.primitive,Ae.componentIndex),canResizeHorz(Ae.resizeDirections)||(pe=this._currentDrag.startTime),canResizeVert(Ae.resizeDirections)||(Oe=this._currentDrag.startPrice)),pe===void 0&&(pe=getXCoordinate(this.chartService,he.x,{clamp:!0,useExtended:!this._currentDrag.primitive.disableExtendTime})),Oe===void 0){const ze=clamp$1(he.y,0,this._currentDrag.series.getPane().getHeight());Oe=ensure(this._currentDrag.series.coordinateToPrice(ze))}this._currentDrag.primitive.updateDrag(this._currentDrag.hitTestResult.target,this._currentDrag.points,this._currentDrag.startTime,pe,this._currentDrag.startPrice,Oe,fe,this._currentDrag.hitTestResult.details,{shiftkey:ce.shiftKey})})),this._register(te.onMouseDrop(()=>{var ce;(ce=this._currentDrag)!=null&&ce.takeEffect&&this._currentDrag.primitive&&this._toolbar.update({visible:!0}),this._resetDragStatus()})),this._register(te.onMouseDropCanceled(()=>{this._resetDragStatus()})),this._register(te.onDrawingsVisibility(ce=>{this._visible!==ce&&(this._visible=ce,this.model.reset(),ce?(should(!this._primitives.size),this._primitives=this._hiddenPrimitives,this._hiddenPrimitives=new Map,this._primitives.values().forEach(he=>{he.reAttach()})):(should(!this._hiddenPrimitives.size),this._hiddenPrimitives=this._primitives,this._primitives=new Map,this._hitTestObjects.clear(),this._pendingHitTestObjects.clear(),this._hiddenPrimitives.values().forEach(he=>{he.detach()})))})),this._register(ae.onPaste(ce=>{this.handlePaste(ce)}))}dispose(){super.dispose(),this._primitives.values().forEach(te=>te.detach()),this._primitives.clear(),this._hiddenPrimitives.values().forEach(te=>te.detach()),this._hiddenPrimitives.clear(),this._hitTestObjects.clear(),this._pendingHitTestObjects.clear()}handlePaste(te){var re;const ee=parseFragmentString(te.html),ne=(re=te.files)==null?void 0:re.filter(se=>se.type.startsWith("image"));if(ne&&ne.length)for(const se of ne){const ae=Reflect.get(ee??{},FileNameKey);this._pasteImage(se,ae===se.name?ee??void 0:void 0)}if(ee&&ee.type!==ImageToolType){this._pasteFragment(ee);return}}getToolbarHandlers(){return{onRemove:()=>{this.commandService.executeCommand(RemoveDrawingCommand)},onLock:()=>{},onCopy:()=>{this.commandService.executeCommand(CopyDrawingCommand)},onClone:()=>{this.commandService.executeCommand(CloneDrawingCommand)}}}get model(){return this._model}_updateCursor(te,ee){const ne=te.details;if(isAnchorDetails(ne)){const{resizeDirections:re}=ne;if(canResizeAll(re)&&!ne.cursorType){this.chartService.showPaneCursor(PaneCursor.arrow);return}if(canResizeHorz(re)&&!ne.cursorType){this.chartService.showPaneCursor(PaneCursor.ew);return}if(canResizeVert(re)&&!ne.cursorType){this.chartService.showPaneCursor(PaneCursor.ns);return}}if(ne!=null&&ne.cursorType){this.chartService.showPaneCursor(ne.cursorType);return}if(ee){this.chartService.showPaneCursor(PaneCursor.grabbing);return}if(te.target===HitTarget.ChangePoint){this.chartService.showPaneCursor(PaneCursor.arrow);return}te.target===HitTarget.MovePoint&&this.chartService.showPaneCursor(PaneCursor.pointer)}_resetDragStatus(){var te,ee,ne;this._currentDrag&&(this._enableDefaultDrag(),(te=this._currentDrag.editScope)==null||te.dispose(),this._currentDrag.takeEffect&&((ne=(ee=this._currentDrag.primitive).onDragEnd)==null||ne.call(ee,this._currentDrag.hitTestResult),this.chartService.showPaneCursor(PaneCursor.pointer),isAnchorDetails(this._currentDrag.hitTestResult.details)&&this.model.markPointEditingFinishedOrAborted()),this._currentDrag=void 0)}_disableDefaultDrag(){this.chartService.chart.applyOptions({handleScale:!1,handleScroll:!1})}_enableDefaultDrag(){this.chartService.chart.applyOptions({handleScale:!0,handleScroll:!0})}_hitTest(te,ee){const ne=new Point(te,ee),re={mediaSize:{width:this.chartService.chart.timeScale().width(),height:this.chartService.mainSeriesWrapper.getSeries().getPane().getHeight()}};for(const[se,ae]of this._hitTestObjects.entries())for(let le=ae.length-1;le>=0;le--){const ce=ae[le].hitTest(ne,re);if(ce)return{hitTestResult:ce,primitiveId:se}}return null}_pasteFragment(te){const ee=this.chartService.chart.timeScale().width(),ne=this.chartService.mainSeriesWrapper.getSeries().getPane().getHeight(),re=this.chartService.chart.timeScale().coordinateToTimeEx(ee/2);if(re===null)return;const se=this.chartService.mainSeriesWrapper.getSeries().coordinateToPrice(ne/2);if(se===null)return;const{props:ae}=te,le=re-ae.points[0].time,ce=se-ae.points[0].price;ae.points.forEach(he=>{he.time=he.time+le,he.price=he.price+ce}),Reflect.deleteProperty(ae,"id"),this.commandService.executeCommand(te.type,this.chartService,0,ae)}async _pasteImage(te,ee){this.toolService.switchTool(PasteImageToolType);const ne=this.toolService.activeTool;if(ee){const re=this.chartService.chart.timeScale().width(),se=this.chartService.mainSeriesWrapper.getSeries().getPane().getHeight(),ae=this.chartService.chart.timeScale().coordinateToTimeEx(re/2);if(ae===null)return;const le=this.chartService.mainSeriesWrapper.getSeries().coordinateToPrice(se/2);if(le===null)return;const ce=ee.props,he=ae-ce.points[0].time,fe=le-ce.points[0].price;ce.points.forEach(Ae=>{Ae.time=Ae.time+he,Ae.price=Ae.price+fe}),Reflect.deleteProperty(ce,"id"),ce.image=te,ne.receivePresetProps(void 0,0,ce)}else ne.onImage(te)}_clearMeasure(){const te=Array.from(this._primitives.values().filter(ee=>ee.type===MeasureToolType));for(;te.length;){const ee=ensure(te.pop());this.detachPrimitive(ee)}}detachPrimitive(te){var ne;should(te);const ee=te.id;this._model.currentHovered===te&&this._model.unhover(this._model.currentHovered),this._model.currentActive===te&&this._model.blur(this._model.currentActive),this._model.currentCreating===te&&this._model.markCreatingFinishedOrAborted(te),te===((ne=this._currentDrag)==null?void 0:ne.primitive)&&(this._currentDrag=void 0),te.detach(),this._primitives.delete(ee),this._hitTestObjects.delete(ee),this._pendingHitTestObjects.delete(ee),this.chartService.getStoreHandler().removeDrawingInfo(te.id)}attachPrimitive(te,ee){should(!this._primitives.has(te.id)),should(te.isAttached),te.type===MeasureToolType&&this._clearMeasure(),this._visible||this.chartManagementService.setHideBits(0),this._primitives.set(te.id,te),this.chartService.getStoreHandler().addDrawingInfo({id:te.id}),ee&&!te.disableUserSelection&&this._model.focus(te)}collectHitTestPrimitive(te,ee){if(!ee)return;const ne=ensure(this._primitives.get(te));if(this.model.currentCreating===ne)return;this._pendingHitTestObjects.has(te)||this._pendingHitTestObjects.set(te,[]);const re=ensure(this._pendingHitTestObjects.get(te));Array.isArray(ee)?re.push(...ee):re.push(ee),tick$1(()=>{if(!this._primitives.has(te))return;const se=ensure(this._pendingHitTestObjects.get(te));se.length&&(this._hitTestObjects.set(te,se),this._pendingHitTestObjects.set(te,[]))})}removeAll(){this._primitives.values().forEach(te=>{te.detach()}),this.chartService.getStoreHandler().removeAllDrawingInfos(),this._primitives.clear(),this._hiddenPrimitives.clear(),this._hitTestObjects.clear(),this._pendingHitTestObjects.clear(),this._model.reset()}};DrawingContrib=__decorateClass$4([__decorateParam$4(0,IChartService),__decorateParam$4(1,IChartManagementService),__decorateParam$4(2,IToolService),__decorateParam$4(3,IGuiService),__decorateParam$4(4,ICommandService),__decorateParam$4(5,IClipboardService),__decorateParam$4(6,IThemeService)],DrawingContrib);const PasteImageToolType="_tool.image.parse";let DrawingKeybindingContrib=class extends Disposable{constructor(ie,te,ee,ne){super(),this._register(ne.registerCommandAndKeybindingRule({id:"drawing.cancel",primary:KeyCode.Esc,weight:KeybindingWeight.ChartContrib,when:()=>!!get$1(ie.store).activeType,handler:()=>{var le;const re=te.activeChart(),se=ensure(re.getContribution(DrawingContribId)),ae=se.model.currentActive;if(ae){let ce=!1;const he=ae;se.model.currentCreating===ae&&he.abort()&&(se.detachPrimitive(ae),ce=!0),ce||(se.model.blur(he),se.model.unhover(he))}ae&&ae.type===((le=ie.activeTool)==null?void 0:le.type)&&get$1(ie.store).keepDrawingMode?ie.keepDrawingOrSwitchBack():ie.switchBack()}})),this._register(ne.registerCommandAndKeybindingRule({id:RemoveDrawingCommand,primary:KeyCode.Delete,secondary:[KeyCode.Backspace],weight:KeybindingWeight.ChartContrib,when:()=>{const re=te.activeChart();return!!ensure(re.getContribution(DrawingContribId)).model.currentActive},handler:()=>{const re=te.activeChart(),se=ensure(re.getContribution(DrawingContribId)),ae=ensure(se.model.currentActive);se.model.currentCreating!==ae&&se.detachPrimitive(ae)}})),this._register(ne.registerCommandAndKeybindingRule({id:CopyDrawingCommand,primary:KeyCode.KeyC|KeyMod.CtrlCmd,weight:KeybindingWeight.ChartContrib,when:()=>{const re=te.activeChart();return!!ensure(re.getContribution(DrawingContribId)).model.currentActive},handler:()=>{const re=te.activeChart(),se=ensure(re.getContribution(DrawingContribId)),ae=ensure(se.model.currentActive),le={html:toFragmentString(ae)};if(ae.type===ImageToolType){const ce=ae.properties().image;le.files=[ce]}ee.writeClipboard(le)}})),this._register(ne.registerCommandAndKeybindingRule({id:CloneDrawingCommand,primary:KeyCode.KeyD|KeyMod.CtrlCmd,weight:KeybindingWeight.ChartContrib,when:()=>{const re=te.activeChart();return!!ensure(re.getContribution(DrawingContribId)).model.currentActive},handler:()=>{const re=te.activeChart(),se=ensure(re.getContribution(DrawingContribId)),ae=ensure(se.model.currentActive),le={html:toFragmentString(ae)};if(ae.type===ImageToolType){const ce=ae.properties().image;le.files=[ce]}se.handlePaste(le)}}))}};DrawingKeybindingContrib=__decorateClass$4([__decorateParam$4(0,IToolService),__decorateParam$4(1,IChartManagementService),__decorateParam$4(2,IClipboardService),__decorateParam$4(3,IKeybindingsRegistry)],DrawingKeybindingContrib);let DrawingRegistryContrib=class extends Disposable{constructor(ie){super(),this.toolRegistry=ie,[CursorTools,LineTools,FibAndGannTools,PatternTools,MeasureTools,ShapesTools,AnnotationTools].forEach(({groups:ee})=>{ee.forEach(({items:ne})=>{ne.forEach(re=>{this.registerTool(re)})})}),this.registerTool(iconEmoji),this.registerTool(iconIcon),this.registerTool({...contentImage,type:PasteImageToolType,Ctor:PasteImageTool}),this.registerTool(measure),this.registerTool(zoomIn)}registerTool(ie){return this.toolRegistry.registerTool({id:ie.type,keybinding:ie.keybinding,createTool(te){const ee=ensure(ie.Ctor);return te.get(IInstantiationService).createInstance(ee)}})}};DrawingRegistryContrib=__decorateClass$4([__decorateParam$4(0,IToolRegistry)],DrawingRegistryContrib);var __getOwnPropDesc$3=Object.getOwnPropertyDescriptor,__decorateClass$3=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$3(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$3=(ie,te)=>(ee,ne)=>te(ee,ne,ie);const LABEL_HEIGHT=21,halfWidth=(LABEL_HEIGHT+1)/2,plusIcon="M7.5,7.5 m -7,0 a 7,7 0 1,0 14,0 a 7,7 0 1,0 -14,0 M4 7.5H11 M7.5 4V11",plusIconPath=new Path2D(plusIcon),plusIconSize=15;class CrosshairButtonPaneRenderer{constructor(te){Ee(this,"_data");this._data=te}draw(te){this._data.visible&&te.useBitmapCoordinateSpace(ee=>{const ne=ee.context,re=LABEL_HEIGHT,se=re+1;let ae=this._data.rightX-se,le=this._data.rightX-1;this._data.x&&isFinite(this._data.x)&&(ae=this._data.x-halfWidth,le=this._data.x+halfWidth);const ce=positionsBox(ae,le,ee.horizontalPixelRatio),he=positionsLine(this._data.y,ee.verticalPixelRatio,re);ne.fillStyle=this._data.color;const fe=[3,3,3,3].map(pe=>pe*ee.horizontalPixelRatio);ne.beginPath(),ne.roundRect(ce.position,he.position,ce.length,he.length,fe),ne.fill(),this._data.hovered&&(ne.fillStyle=this._data.hoverColor,ne.beginPath(),ne.roundRect(ce.position,he.position,ce.length,he.length,fe),ne.fill()),ne.translate(ce.position+3*ee.horizontalPixelRatio,he.position+3*ee.verticalPixelRatio),ne.scale(ee.horizontalPixelRatio,ee.verticalPixelRatio);const Ae=15/plusIconSize;ne.scale(Ae,Ae),ne.strokeStyle=this._data.textColor,ne.lineWidth=1,ne.stroke(plusIconPath)})}}class CrosshairButtonPaneView{constructor(){Ee(this,"_data",Object.create(null));Ee(this,"_rendererData",Object.create(null))}renderer(){return new CrosshairButtonPaneRenderer(this._rendererData)}zOrder(){return"top"}update(te,ee){this._data=te;const ne=(isFiniteNumber(this._data.price)?ee.priceToCoordinate(this._data.price):-1e4)||-1e4;this._rendererData={visible:this._data.visible&&ne>0,y:ne,x:this._data.x,color:this._data.crosshairColor,textColor:this._data.crosshairLabelColor,rightX:this._data.timeScaleWidth,hoverColor:this._data.hoverColor,hovered:this._data.hovered??!1}}}class CrosshairButton extends SeriesPrimitive{constructor(ee){super();Ee(this,"_paneViews");Ee(this,"_data",Object.create(null));Ee(this,"_source");this._paneViews=[new CrosshairButtonPaneView],this._source=ee}updateAllViews(){this._paneViews[0].update(this._data,this.series)}priceAxisViews(){return[]}paneViews(){return this._paneViews}showLabel(ee,ne,re){if(!this.isAttached)return;const se=this.chart.options().crosshair.horzLine.labelBackgroundColor;Object.assign(this._data,{price:ee,x:re,hovered:ne,timeScaleWidth:this.chart.timeScale().width(),crosshairColor:se,crosshairLabelColor:"#FFFFFF",hoverColor:this._source.hoverBackgroundColor()}),this.updateAllViews(),this.requestUpdate()}show(){this._data.visible=!0,this.isAttached&&(this.updateAllViews(),this.requestUpdate())}hide(){this._data.visible=!1,this.isAttached&&(this.updateAllViews(),this.requestUpdate())}}const lightColors={hoverBackground:"#4d4d4d"},darkColors={hoverBackground:"#585858"};function matchModifiers(ie){return ie.altKey&&ie.metaKey&&!ie.ctrlKey&&!ie.shiftKey}let CrosshairButtonContrib=class extends Disposable{constructor(te,ee,ne,re){super();Ee(this,"_buttonPrimitive");Ee(this,"_currentPrice",null);Ee(this,"_currentX",null);Ee(this,"_moveWithCursor",!1);Ee(this,"_attachDetails",null);this.chartService=te,this.chartGuiService=ee,this.toolService=ne,this.themeService=re,this._buttonPrimitive=new CrosshairButton(this),this._onToolChange(),this._register(ne.onDidChangeTool(()=>this._onToolChange())),this._register(te.onKeyDown(se=>{const ae=se.init.toKeyCodeChord();if(matchModifiers(ae)){if(ae.keyCode){this._moveWithCursor=!1;return}this._moveWithCursor=!0,this._currentX&&isFinite(this._currentX)&&this._currentPrice&&isFinite(this._currentPrice)&&(this._buttonPrimitive.showLabel(this._currentPrice,!0,this._currentX),this.chartService.showPaneCursor(PaneCursor.pointer))}})),this._register(te.onKeyUp(se=>{const ae=se.init.toKeyCodeChord();matchModifiers(ae)&&!ae.keyCode&&(this._moveWithCursor=!1,this._currentX&&isFinite(this._currentX)&&this._currentPrice&&isFinite(this._currentPrice)&&this._buttonPrimitive.showLabel(this._currentPrice,!1))})),this._register(te.onClick(se=>this._onClick(se))),this._register(te.onCrosshairMove(se=>this._onMouseMove(se)))}dispose(){var te;super.dispose(),(te=this._buttonPrimitive)==null||te.detach()}hoverBackgroundColor(){return this.themeService.getColorTheme().type==="light"?lightColors.hoverBackground:darkColors.hoverBackground}_onToolChange(){this.toolService.isDrawing()?this._buttonPrimitive.hide():this._buttonPrimitive.show()}_onClick(te){var ce;const ee=this._getMousePrice(te);if(ee===null)return;if(!this._moveWithCursor){const he=this._distanceFromRightScale(te);if(he===null||he>LABEL_HEIGHT)return}if(!this._attachDetails)return;should(te.point);const ne=this._buttonPrimitive.series.priceFormatter(),re=ensure(this.chartService.chart.panes().find(he=>{var fe;return he.paneIndex()===((fe=this._attachDetails)==null?void 0:fe.paneIndex)})),se=ensure(re.getHTMLElement()),ae={x:this._moveWithCursor?te.point.x-halfWidth+se.offsetLeft:this.chartService.chart.timeScale().width()-halfWidth*2+se.offsetLeft,y:te.point.y-halfWidth+se.offsetTop,width:halfWidth*2,height:LABEL_HEIGHT},le=re.paneIndex();this.chartGuiService.showCrosshairButtonMenu(((ce=this._attachDetails)==null?void 0:ce.paneIndex)===0?{anchor:ae,paneIndex:le,symbol:this.chartService.symbol(),priceVal:ee,price:ne.format(ee),bid:ne.format(ee),ask:ne.format(ee)}:{anchor:ae,paneIndex:le,price:ne.format(ee),priceVal:ee})}_onMouseMove(te){var ae,le;if(isDefined(te.paneIndex)&&((ae=this._attachDetails)==null?void 0:ae.paneIndex)!==te.paneIndex){this._attachDetails&&this._buttonPrimitive.detach();const he=ensure(this.chartService.chart.panes().find(fe=>fe.paneIndex()===te.paneIndex)).getSeries()[0];he&&(he.attachPrimitive(this._buttonPrimitive),this._attachDetails={paneIndex:te.paneIndex,series:he})}const ee=this._getMousePrice(te),ne=this._distanceFromRightScale(te),re=(le=te.point)==null?void 0:le.x;if(re===void 0||ee===null||ne===null||this.toolService.isDrawing()){this._buttonPrimitive.showLabel(NaN,!1),this._currentPrice=null,this._currentX=null;return}this._currentPrice=ee,this._currentX=re;const se=ne<LABEL_HEIGHT;this._buttonPrimitive.showLabel(ee,se,this._moveWithCursor?re:void 0),(se||this._moveWithCursor)&&this.chartService.showPaneCursor(PaneCursor.pointer)}_getMousePrice(te){return!te.point||!this._buttonPrimitive.isAttached||!this._buttonPrimitive.series?null:this._buttonPrimitive.series.coordinateToPrice(te.point.y)}_distanceFromRightScale(te){if(!te.point||!this.chartService.chart)return null;const ee=this.chartService.chart.timeScale().width();return Math.abs(ee-te.point.x)}};CrosshairButtonContrib=__decorateClass$3([__decorateParam$3(0,IChartService),__decorateParam$3(1,IChartGuiService),__decorateParam$3(2,IToolService),__decorateParam$3(3,IThemeService)],CrosshairButtonContrib);var Side=(ie=>(ie[ie.Buy=1]="Buy",ie[ie.Sell=-1]="Sell",ie))(Side||{});const BuyColor="#2A62FF",SellColor="#F23644";class Bound{constructor(te,ee,ne,re){Ee(this,"top");Ee(this,"right");Ee(this,"bottom");Ee(this,"left");this.top=te,this.right=ee,this.bottom=ne,this.left=re}get width(){return this.right-this.left}hitTest(te,ee){return te>=this.left&&te<=this.right&&ee>=this.top&&ee<=this.bottom}toString(){return`Bounding(top: ${this.top}, right: ${this.right}, bottom: ${this.bottom}, left: ${this.left})`}}class ExecBound extends Bound{constructor(te,ee,ne,re,se,ae){super(ne,re,se,ae),this.bar=te,this.execution=ee}}const ShapeConfigs={lineWidth:2,headHeight:4,bodyLength:15,marginBeforeFirst:10,gap:4};class ExecPaneRenderer{constructor(te,ee){this._data=te,this._boundCollector=ee}draw(te){this._data.items.length&&this._data.visible&&te.useMediaCoordinateSpace(ee=>{const ne=[],re=ee.context;this._data.items.forEach(se=>{const{x:ae,buys:le,sells:ce,lowY:he,highY:fe,bar:Ae}=se;let pe=he+ShapeConfigs.marginBeforeFirst;const Oe=ae;for(const ze of le){const He=Oe-ShapeConfigs.headHeight,We=pe+ShapeConfigs.headHeight,je=Oe,Ue=pe,Ge=Oe+ShapeConfigs.headHeight,Ze=pe+ShapeConfigs.headHeight,Ye=pe+2,qe=pe+ShapeConfigs.bodyLength;re.lineWidth=ShapeConfigs.lineWidth+2,re.strokeStyle=this._data.outlineColor,re.beginPath(),re.moveTo(He-1,We+1),re.lineTo(je,Ue),re.lineTo(Ge+1,Ze+1),re.moveTo(Oe,Ye),re.lineTo(Oe,qe+1),re.stroke(),re.lineWidth=ShapeConfigs.lineWidth,re.strokeStyle=this._data.buyColor,re.beginPath(),re.moveTo(He,We),re.lineTo(je,Ue),re.lineTo(Ge,Ze),re.moveTo(Oe,Ye),re.lineTo(Oe,qe),re.stroke(),ne.push(new ExecBound(Ae,ze,Ue-2,Ge+1,qe+1,He-1)),pe=qe+ShapeConfigs.gap}let Fe=fe-ShapeConfigs.marginBeforeFirst;const Ne=ae;for(const ze of ce){const He=Ne-ShapeConfigs.headHeight,We=Fe-ShapeConfigs.headHeight,je=Ne,Ue=Fe,Ge=Ne+ShapeConfigs.headHeight,Ze=Fe-ShapeConfigs.headHeight,Ye=Fe-2,qe=Fe-ShapeConfigs.bodyLength;re.lineWidth=ShapeConfigs.lineWidth+2,re.strokeStyle=this._data.outlineColor,re.beginPath(),re.moveTo(He-1,We-1),re.lineTo(je,Ue),re.lineTo(Ge+1,Ze-1),re.moveTo(Ne,Ye),re.lineTo(Ne,qe-1),re.stroke(),re.lineWidth=ShapeConfigs.lineWidth,re.strokeStyle=this._data.sellColor,re.beginPath(),re.moveTo(He,We),re.lineTo(je,Ue),re.lineTo(Ge,Ze),re.moveTo(Ne,Ye),re.lineTo(Ne,qe),re.stroke(),ne.push(new ExecBound(Ae,ze,qe-1,Ge+1,Ue+2,He-1)),Fe=qe-ShapeConfigs.gap}}),this._boundCollector(ne)})}}let HintPaneRenderer$1=class{constructor(te){this._data=te}draw(te){te.useMediaCoordinateSpace(ee=>{if(isUndefinedOrNull(this._data.x)||isUndefinedOrNull(this._data.y))return;const ne=ee.context,re=2,se=3,ae=this._data.x-se,le=this._data.y,ce=ae-re-se,he=le-re-1,fe=ce,Ae=le+re+1;ne.lineWidth=ShapeConfigs.lineWidth+2,ne.strokeStyle=this._data.outlineColor,ne.lineCap="square",ne.beginPath(),ne.moveTo(ce,he),ne.lineTo(ae,le),ne.lineTo(fe,Ae),ne.stroke(),ne.lineWidth=ShapeConfigs.lineWidth,ne.strokeStyle=this._data.color,ne.lineCap="butt",ne.beginPath(),ne.moveTo(ce,he),ne.lineTo(ae,le),ne.lineTo(fe,Ae),ne.stroke()})}};class ExecPaneView{constructor(te,ee){this._data=te,this._boundCollector=ee}renderer(){return new ExecPaneRenderer(this._data,this._boundCollector)}zOrder(){return"normal"}update(te){this._data=te}}let HintPaneView$1=class{constructor(te){this._data=te}renderer(){return new HintPaneRenderer$1(this._data)}zOrder(){return"top"}update(te){this._data=te}};class ExecPrimitive extends SeriesPrimitive{constructor(ee,ne,re,se){super(ne,re);Ee(this,"_paneView");Ee(this,"_primitiveData");this._primitiveData={items:[],...ee};const ae=this._calculateRendererData(this._primitiveData);this._paneView=new ExecPaneView(ae,se)}updateProps(ee){Object.assign(this._primitiveData,ee),this.updateAllViews(),this.requestUpdate()}_calculateRendererData(ee){const ne=[];return ee.items.forEach(re=>{let se=ensure(this.chart.timeScale().timeToIndex(re.time,!0));const ae=ne[ne.length-1];let le,ce=ensure(this.series.dataByIndex(se));if(should(isFiniteNumber(ce.time)),ce.time>re.time&&se>0&&(se--,ce=ensure(this.series.dataByIndex(se))),ae&&ae.time===ce.time)le=ae;else{const he=ensure(this.chart.timeScale().timeToCoordinate(ce.time)),fe=Math.floor(ensure(this.series.priceToCoordinate(ce.customValues.high))),Ae=Math.ceil(ensure(this.series.priceToCoordinate(ce.customValues.low)));le={x:he,highY:fe,lowY:Ae,bar:ce,time:ce.time,buys:[],sells:[]},ne.push(le)}re.side===Side.Buy?le.buys.push(re):le.sells.push(re)}),{visible:this._primitiveData.visible,items:ne,buyColor:this._primitiveData.buyColor,sellColor:this._primitiveData.sellColor,outlineColor:this._primitiveData.outlineColor}}addItem(ee){this._primitiveData.items.push(ee),this._primitiveData.items.sort((ne,re)=>re.time-ne.time),this.updateAllViews(),this.requestUpdate()}updateAllViews(){const ee=this._calculateRendererData(this._primitiveData);this._paneView.update(ee)}paneViews(){return[this._paneView]}}let HintPrimitive$1=class extends SeriesPrimitive{constructor(ee,ne=void 0,re=void 0){super(ne,re);Ee(this,"_paneView",new HintPaneView$1(Object.create(null)));this._primitiveData=ee}updateData(ee){ee?Object.assign(this._primitiveData,ee):(this._primitiveData.bar=void 0,this._primitiveData.execution=void 0)}_calculateRendererData(ee){if(!ee.bar||!ee.execution)return Object.create(null);const ne=ensure(this.series.priceToCoordinate(ee.execution.price));return{x:ensure(this.chart.timeScale().timeToCoordinate(ee.bar.time)),y:ne,color:ee.execution.side===Side.Sell?this._primitiveData.sellColor:this._primitiveData.buyColor,outlineColor:this._primitiveData.outlineColor}}updateAllViews(){const ee=this._calculateRendererData(this._primitiveData);this._paneView.update(ee)}paneViews(){return[this._paneView]}};var __getOwnPropDesc$2=Object.getOwnPropertyDescriptor,__decorateClass$2=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$2(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$2=(ie,te)=>(ee,ne)=>te(ee,ne,ie);const outlineColorId="#ffffff";let ExecutionContrib=class extends Disposable{constructor(te,ee,ne,re){super();Ee(this,"_shape");Ee(this,"_hint");Ee(this,"_hitTestBounds",[]);Ee(this,"_currentTooltipBound");this.chartService=te,this.chartGuiService=ee,this.i18nService=re,this._register(te.onDataLoaded(()=>{const se=te.mainSeriesWrapper.getSeries(),ae=BuyColor,le=SellColor,ce=outlineColorId;this._shape=new ExecPrimitive({visible:!0,buyColor:ae,sellColor:le,outlineColor:ce},te.chart,se,he=>{this._hitTestBounds=he}),this._hint=new HintPrimitive$1({buyColor:ae,sellColor:le,outlineColor:ce}),se.attachPrimitive(this._shape),se.attachPrimitive(this._hint),ne.executions(te.symbol()).then(he=>{he.forEach(fe=>this._handleExecutionUpdate(fe))})})),this._register(te.onSymbolChanged(()=>{const se=te.mainSeriesWrapper.getSeries();this._shape&&se.detachPrimitive(this._shape),this._hint&&se.detachPrimitive(this._hint)})),this._register(ne.onExecutionUpdated(se=>this._handleExecutionUpdate(se))),this._register(te.onCrosshairMove(se=>{var he;if(!se.point)return;const{x:ae,y:le}=se.point,ce=this._hitTestBounds.findLast(fe=>fe.hitTest(ae,le));ce?(te.showPaneCursor(PaneCursor.pointer),this._showTooltip(ce),ensure(this._hint).updateData({bar:ce.bar,execution:ce.execution})):((he=this._hint)==null||he.updateData(null),this._hideTooltip())})),this._register(te.onPositionsAndOrdersVisibility(se=>{var ae;(ae=this._shape)==null||ae.updateProps({visible:se}),se||(this._hitTestBounds.length=0)}))}dispose(){var te,ee;super.dispose(),(te=this._shape)==null||te.detach(),(ee=this._hint)==null||ee.detach(),this._hitTestBounds.length=0}_handleExecutionUpdate(te){ensure(this._shape).addItem(te)}_showTooltip(te){if(isEqual(this._currentTooltipBound,te))return;this._currentTooltipBound=te;const{t:ee,formatNumber:ne}=this.i18nService,{execution:re}=te;this.chartGuiService.showPaneTooltip({yPos:re.side===Side.Sell?"above":"below",anchor:{x:te.left,y:te.top,width:te.right-te.left,height:te.bottom-te.top},content:ee("tradePrimitive.execution.tip",{side:ee(re.side===Side.Buy?"trade.buy":"trade.sell"),qty:ne(re.qty),price:this.chartService.mainSeriesWrapper.getSeries().priceFormatter().format(re.price)})})}_hideTooltip(){this._currentTooltipBound&&(this._currentTooltipBound=void 0,this.chartGuiService.hidePaneTooltip())}};ExecutionContrib=__decorateClass$2([__decorateParam$2(0,IChartService),__decorateParam$2(1,IChartGuiService),__decorateParam$2(2,ITradeService),__decorateParam$2(3,II18nService)],ExecutionContrib);var OrderType=(ie=>(ie[ie.Limit=1]="Limit",ie[ie.Market=2]="Market",ie[ie.Stop=3]="Stop",ie[ie.StopLimit=4]="StopLimit",ie))(OrderType||{}),OrderStatus=(ie=>(ie[ie.Canceled=1]="Canceled",ie[ie.Filled=2]="Filled",ie[ie.Inactive=3]="Inactive",ie[ie.Placing=4]="Placing",ie[ie.Rejected=5]="Rejected",ie[ie.Working=6]="Working",ie))(OrderStatus||{}),ParentType=(ie=>(ie[ie.Order=1]="Order",ie[ie.Position=2]="Position",ie[ie.IndividualPosition=3]="IndividualPosition",ie))(ParentType||{});function isBracketOrder(ie){return!!ie.parentId}function isTakeProfitOrder(ie){return ie.parentId&&ie.type===1}function isStopLossOrder(ie){return ie.parentId&&ie.type===3}function isMarketOrder(ie){return ie.type===2}function isLongPosition(ie){return ie.side===Side.Buy}const Texts={cross:"✕",reverse:"⇌",TP:"TP",SL:"SL"};var LineMouseTarget=(ie=>(ie[ie.none=0]="none",ie[ie.widget=32]="widget",ie[ie.extended=48]="extended",ie[ie.qty=33]="qty",ie[ie.cancel=34]="cancel",ie[ie.tp=51]="tp",ie[ie.sl=52]="sl",ie[ie.reverse=53]="reverse",ie))(LineMouseTarget||{});function asDragTarget(ie){switch(ie){case 33:case 34:case 32:return 32;case 52:return 52;case 51:return 51;default:return 0}}class LineBtnBound extends Bound{constructor(te,ee,ne,re,se){super(ee,ne,re,se),this.targetType=te}}const WidgetConfigs={font:getFont(13),height:18,textPadding:10,btnPadding:7,borderRadius:4,gutterWidth:1,extendedGap:10,widgetMarginRight:66},TPColor="#089981",SLColor="#FF9800",OrderBackgroundColors={light:"#FFFFFF",dark:"#191919"};function getKindKey(ie,te,ee=!1){return ie<<2|(te===Side.Buy?1:0)<<1|(ee?1:0)}function getOrderKind(ie){const te=getKindKey(ie.type,ie.side,!!ie.parentId);return{[getKindKey(OrderType.Limit,Side.Buy)]:{key:"tradePrimitive.order.buyLimit",colorId:BuyColor},[getKindKey(OrderType.Market,Side.Buy)]:{key:"tradePrimitive.order.buyMarket",colorId:BuyColor},[getKindKey(OrderType.Limit,Side.Sell)]:{key:"tradePrimitive.order.sellLimit",colorId:SellColor},[getKindKey(OrderType.Market,Side.Sell)]:{key:"tradePrimitive.order.sellMarket",colorId:SellColor},[getKindKey(OrderType.Stop,Side.Sell)]:{key:"tradePrimitive.order.sellStop",colorId:SellColor},[getKindKey(OrderType.Limit,Side.Sell,!0)]:{key:"tradePrimitive.order.takeProfit",colorId:TPColor},[getKindKey(OrderType.Limit,Side.Buy,!0)]:{key:"tradePrimitive.order.takeProfit",colorId:TPColor},[getKindKey(OrderType.Stop,Side.Sell,!0)]:{key:"tradePrimitive.order.stopLoss",colorId:SLColor},[getKindKey(OrderType.Stop,Side.Buy,!0)]:{key:"tradePrimitive.order.stopLoss",colorId:SLColor}}[te]}let _textWidthCache;class LinePaneRenderer{constructor(te,ee){this._data=te,this._boundCollector=ee}get _textWidthCache(){return _textWidthCache||(_textWidthCache=new et(20)),_textWidthCache}draw(te){if(!this._data.visible)return;const ee=te.useBitmapCoordinateSpace(ne=>{if(!this._data.y)return;const re=ne.context;re.font=WidgetConfigs.font;const se=this._calculateGeomotry(ne),ae=se.bitmap,le=[ne.horizontalPixelRatio,2*ne.horizontalPixelRatio],ce=this._data.hoverBackground,he=ae.centerY,fe=this._data.rightX*ne.horizontalPixelRatio;re.save();const Ae=[ae.right];if((this._data.hoverTarget||this._data.active)&&(this._data.tpVisible&&this._data.dragTarget!==LineMouseTarget.tp&&Ae.push(ae.tpRight),this._data.slVisible&&this._data.dragTarget!==LineMouseTarget.sl&&Ae.push(ae.slRight),this._data.isPosition&&Ae.push(ae.rvLeft)),re.strokeStyle=this._data.foreground,re.lineWidth=ne.horizontalPixelRatio,re.beginPath(),re.moveTo(Math.min.apply(null,Ae),he),re.lineTo(fe,he),re.stroke(),drawRoundRectWithBorder(re,ae.left,ae.top,ae.width,ae.height,this._data.background,ae.borderWidth,[ae.borderRadius,ae.borderRadius,ae.borderRadius,ae.borderRadius],"transparent"),this._data.dragTarget===LineMouseTarget.tp){const pe=ae.tpTop+ae.halfHeight;re.strokeStyle=this._data.tpHoverBackground,re.beginPath(),re.setLineDash(le),re.moveTo(fe,pe),re.lineTo(ae.tpRight,pe),re.stroke(),re.setLineDash([])}if(this._data.dragTarget===LineMouseTarget.sl){const pe=ae.slTop+ae.halfHeight;re.strokeStyle=this._data.slHoverBackground,re.beginPath(),re.setLineDash(le),re.moveTo(fe,pe),re.lineTo(ae.slRight,pe),re.stroke(),re.setLineDash([])}switch((this._data.hoverTarget||this._data.active)&&(this._data.tpVisible&&drawRoundRectWithBorder(re,ae.tpLeft,ae.tpTop,ae.tpRight-ae.tpLeft,ae.height,this._data.hoverTarget===LineMouseTarget.tp?this._data.tpHoverBackground:this._data.background,ae.borderWidth,[ae.borderRadius,ae.borderRadius,ae.borderRadius,ae.borderRadius],this._data.tpForeground,le),this._data.slVisible&&drawRoundRectWithBorder(re,ae.slLeft,ae.slTop,ae.slRight-ae.slLeft,ae.height,this._data.hoverTarget===LineMouseTarget.sl?this._data.slHoverBackground:this._data.background,ae.borderWidth,[ae.borderRadius,ae.borderRadius,ae.borderRadius,ae.borderRadius],this._data.slForeground,le),this._data.isPosition&&drawRoundRectWithBorder(re,ae.rvLeft,ae.top,ae.rvRight-ae.rvLeft,ae.height,this._data.hoverTarget===LineMouseTarget.reverse?ce:this._data.background,ae.borderWidth,[ae.borderRadius,ae.borderRadius,ae.borderRadius,ae.borderRadius],this._data.foreground,le)),re.strokeStyle=ce,re.beginPath(),re.moveTo(ae.gutterLeft,ae.top),re.lineTo(ae.gutterLeft,ae.bottom),re.stroke(),re.beginPath(),re.moveTo(ae.gutterRight,ae.top),re.lineTo(ae.gutterRight,ae.bottom),re.stroke(),this._data.isPosition&&drawRoundRectWithBorder(re,ae.left,ae.top,ae.gutterLeft-ae.left,ae.height,this._data.foreground,ae.borderWidth,[ae.borderRadius,0,0,ae.borderRadius],this._data.foreground),this._data.hoverTarget){case LineMouseTarget.qty:this._data.isPosition||drawRoundRectWithBorder(re,ae.left,ae.top,ae.gutterLeft-ae.left,ae.height,ce,ae.borderWidth,[ae.borderRadius,0,0,ae.borderRadius],ce);break;case LineMouseTarget.cancel:drawRoundRectWithBorder(re,ae.gutterRight,ae.top,ae.right-ae.gutterRight,ae.height,ce,ae.borderWidth,[0,ae.borderRadius,ae.borderRadius,0],ce);break}return re.restore(),drawRoundRectWithBorder(re,ae.left,ae.top,ae.width,ae.height,"transparent",ae.borderWidth,[ae.borderRadius,ae.borderRadius,ae.borderRadius,ae.borderRadius],this._data.foreground),se});te.useMediaCoordinateSpace(ne=>{const re=ensure(ee).media,se=[new LineBtnBound(LineMouseTarget.widget,re.top,re.right,re.bottom,re.left),new LineBtnBound(LineMouseTarget.qty,re.top,re.gutterLeft,re.bottom,re.left),new LineBtnBound(LineMouseTarget.cancel,re.top,re.right,re.bottom,re.gutterRight)],ae=ne.context,le=re.top+re.halfHeight;if(ae.font=WidgetConfigs.font,ae.textBaseline="middle",ae.fillStyle=this._data.isPosition?this._data.background:this._data.foreground,ae.fillText(this._data.qtyText,re.qtyTextLeft,le),ae.fillStyle=this._data.foreground,this._data.labelText&&ae.fillText(this._data.labelText,re.labelTextLeft,le),ae.fillText(Texts.cross,re.crossTextLeft,le),this._data.hoverTarget||this._data.active){const ce=[];this._data.isPosition&&(ce.push(re.rvLeft),se.push(new LineBtnBound(LineMouseTarget.reverse,re.top,re.rvRight,re.bottom,re.rvLeft)),ae.fillStyle=this._data.foreground,ae.save(),ae.translate(re.rvTextLeft,re.top+re.halfHeight),ae.rotate(Math.PI/2),ae.fillText(Texts.reverse,-re.rvTextHeight/2,-re.rvTextWidth/2),ae.restore()),this._data.tpVisible&&(ce.push(re.tpLeft),se.push(new LineBtnBound(LineMouseTarget.tp,re.top,re.tpRight,re.bottom,re.tpLeft)),ae.fillStyle=this._data.tpForeground,ae.fillText(Texts.TP,re.tpTextLeft,re.tpTop+re.halfHeight)),this._data.slVisible&&(ce.push(re.slLeft),se.push(new LineBtnBound(LineMouseTarget.sl,re.top,re.slRight,re.bottom,re.slLeft)),ae.fillStyle=this._data.slForeground,ae.fillText(Texts.SL,re.slTextLeft,re.slTop+re.halfHeight)),ce.length&&se.unshift(new LineBtnBound(LineMouseTarget.extended,re.top,re.right,re.bottom,Math.min(...ce)))}this._boundCollector(se)})}_calculateGeomotry(te){const{horizontalPixelRatio:ee,verticalPixelRatio:ne,context:re}=te,se=Math.ceil(this._textWidthCache.measureText(re,this._data.qtyText)),ae=this._data.labelText?Math.ceil(this._textWidthCache.measureText(re,this._data.labelText)):0,le=Math.ceil(this._textWidthCache.measureText(re,Texts.reverse)),ce=Math.ceil(this._textWidthCache.measureText(re,Texts.cross)),he=Math.ceil(this._textWidthCache.measureText(re,Texts.TP)),fe=Math.ceil(this._textWidthCache.measureText(re,Texts.SL));let Ae;this._data.labelText?Ae=se+ae+ce+WidgetConfigs.textPadding*2+WidgetConfigs.btnPadding*4+WidgetConfigs.gutterWidth*2:Ae=se+ae+ce+WidgetConfigs.btnPadding*4+WidgetConfigs.gutterWidth;const pe=this._data.rightX-WidgetConfigs.widgetMarginRight,Oe=pe-Ae,Fe=WidgetConfigs.height/2,Ne=this._data.dragTarget===LineMouseTarget.widget?ensure(this._data.dragY):ensure(this._data.y),ze=Math.floor(Ne-Fe),He=Math.floor((this._data.dragY??-1)-Fe),We=ze+WidgetConfigs.height,je=WidgetConfigs.btnPadding*2+se,Ue=WidgetConfigs.btnPadding*2+ce,Ge=Oe+je,Ze=pe-Ue-WidgetConfigs.gutterWidth,Ye=Oe-WidgetConfigs.extendedGap,qe=Ye-WidgetConfigs.btnPadding*2-fe,nr=this._data.dragTarget===LineMouseTarget.sl?He:ze;let ir=qe,tr=ir-WidgetConfigs.btnPadding*2-he;const or=this._data.dragTarget===LineMouseTarget.tp?He:ze;this._data.slVisible||(tr=qe,ir=Ye);const Jt=Math.min(Oe,this._data.tpVisible?tr:Number.MAX_SAFE_INTEGER,this._data.slVisible?qe:Number.MAX_SAFE_INTEGER)-WidgetConfigs.extendedGap,rr=Jt-WidgetConfigs.btnPadding*2-ce;return{bitmap:{top:ze*ne,centerY:Ne*ne,bottom:We*ne,left:Oe*ee,right:pe*ee,width:Ae*ee,height:WidgetConfigs.height*ne,halfHeight:Fe*ne,borderWidth:ee,borderRadius:WidgetConfigs.borderRadius*ee,gutterLeft:Ge*ee,gutterRight:Ze*ee,slLeft:qe*ee,slRight:Ye*ee,slTop:nr*ne,tpLeft:tr*ee,tpRight:ir*ee,tpTop:or*ne,rvLeft:rr*ee,rvRight:Jt*ee},media:{top:ze,right:pe,bottom:We,left:Oe,gutterRight:Ze,gutterLeft:Ge,tpLeft:tr,tpRight:ir,tpTop:or,slLeft:qe,slRight:Ye,slTop:nr,rvLeft:rr,rvRight:Jt,tpTextLeft:tr+WidgetConfigs.btnPadding,slTextLeft:qe+WidgetConfigs.btnPadding,qtyTextLeft:Oe+WidgetConfigs.btnPadding,labelTextLeft:Ge+WidgetConfigs.textPadding,crossTextLeft:Ze+WidgetConfigs.btnPadding,rvTextLeft:rr+WidgetConfigs.btnPadding,rvTextWidth:ce,rvTextHeight:le,halfHeight:Fe,height:WidgetConfigs.height}}}}class HintPaneRenderer{constructor(te){this._data=te}draw(te){this._data.yList.length&&this._data.visible&&te.useBitmapCoordinateSpace(ee=>{const{context:ne,verticalPixelRatio:re,horizontalPixelRatio:se}=ee,ae=this._data.hoverBackground,le=7*ee.horizontalPixelRatio,ce=4*se,he=3*se,fe=this._data.x*se,Ae=3*se;for(let pe=0;pe<this._data.yList.length;pe++){const Oe=this._data.yList[pe]*re;if(this._data.hover[pe]&&(ne.fillStyle=ae,ne.beginPath(),ne.arc(fe,Oe,le,0,TwoPI,!1),ne.fill()),ne.fillStyle=this._data.foreground,ne.beginPath(),ne.arc(fe,Oe,ce,0,TwoPI,!1),ne.fill(),this._data.active[pe]||(ne.fillStyle=this._data.background,ne.beginPath(),ne.arc(fe,Oe,he,0,TwoPI,!1),ne.fill()),pe>=1){const Fe=this._data.yList[pe-1]*re;Math.abs(Oe-Fe)>2*Ae&&(ne.lineWidth=se,ne.strokeStyle=this._data.foreground,ne.beginPath(),ne.moveTo(fe,Fe+Ae),ne.lineTo(fe,Oe-Ae),ne.stroke())}}})}}class LinePaneView{constructor(te,ee){this._data=te,this._boundCollector=ee}renderer(){return new LinePaneRenderer(this._data,this._boundCollector)}zOrder(){return"normal"}update(te){this._data=te}}class HintPaneView{constructor(te){this._data=te}renderer(){return new HintPaneRenderer(this._data)}zOrder(){return"top"}update(te){this._data=te}}class LinePrimitive extends SeriesPrimitive{constructor(ee,ne,re,se,ae){super(ne,re);Ee(this,"_paneView");Ee(this,"_priceView");Ee(this,"_rendererData");this.data=ee,this._hint=ae,this._rendererData=this._calculateRendererData(),this._paneView=new LinePaneView(this._rendererData,se);const le=ee.type==="position";this._priceView=new PriceLabelPriceAxisView({foreground:le?this.data.background:this.data.foreground,border:le?this.data.background:this.data.foreground,background:le?this.data.foreground:this.data.background,coordinate:ensure(this._rendererData.y),text:re.priceFormatter().format(this.data.price),visible:!0})}_calculateRendererData(){var se,ae,le,ce,he,fe;const ee=this.chart.timeScale().width(),ne=ensure(this.series.priceToCoordinate(this.data.price));let re;return isUndefinedOrNull(this.data.dragPrice)?(se=this._priceView)==null||se.update({visible:!0,coordinate:ne,text:this.series.priceFormatter().format(this.data.price)}):(re=ensure(this.series.priceToCoordinate(this.data.dragPrice)),(le=this._priceView)==null||le.update({visible:((ae=this._rendererData)==null?void 0:ae.dragTarget)!==LineMouseTarget.widget,coordinate:ne,text:this.series.priceFormatter().format(this.data.dragPrice)})),{visible:this.data.visible,rightX:ee,y:ne,foreground:this.data.foreground,background:this.data.background,hoverBackground:this.data.hoverBackground,tpForeground:this.data.tpForeground,tpHoverBackground:this.data.tpHoverBackground,slForeground:this.data.slForeground,slHoverBackground:this.data.slHoverBackground,qtyText:this.data.qtyText,labelText:this.data.label??"",hoverTarget:(ce=this._rendererData)==null?void 0:ce.hoverTarget,slVisible:this.data.slVisible,tpVisible:this.data.tpVisible,active:(he=this._rendererData)==null?void 0:he.active,dragTarget:(fe=this._rendererData)==null?void 0:fe.dragTarget,dragY:re,isPosition:this.data.type==="position"}}updatePrimitive(ee){Object.assign(this.data,ee),this.updateAllViews(),this.requestUpdate()}updateHoverStatus(ee){this._hint.resetHover();const ne=!!ee;if(ne)switch(this.data.type){case"order":case"position":this._hint.updateData({parentHover:ne});break;case"tp":this._hint.updateData({tpHover:ne});break;case"sl":this._hint.updateData({slHover:ne});break;default:NOTREACHED()}this._rendererData.hoverTarget=ee,this.updateAllViews(),this.requestUpdate()}updateActiveStatus(ee){switch(this._hint.resetActive(),this.data.type){case"order":case"position":this._hint.updateData({parentActive:ee});break;case"tp":this._hint.updateData({tpActive:ee});break;case"sl":this._hint.updateData({slActive:ee});break;default:NOTREACHED()}this._rendererData.active=ee,this.updateAllViews(),this.requestUpdate()}updateDragStatus(ee,ne){if(this._rendererData.dragTarget=ee,this.data.dragPrice=ne,ee===LineMouseTarget.tp)this._hint.updateData({parentHover:!0,parentActive:!0,tpPrice:ne});else if(ee===LineMouseTarget.sl)this._hint.updateData({parentHover:!0,parentActive:!0,slPrice:ne});else if(ee===LineMouseTarget.widget)switch(this.data.type){case"order":this._hint.updateData({parentHover:!0,parentActive:!0,parentPrice:ne});break;case"tp":this._hint.updateData({tpHover:!0,tpActive:!0,tpPrice:ne});break;case"sl":this._hint.updateData({slHover:!0,slActive:!0,slPrice:ne});break}this.updateAllViews(),this.requestUpdate()}resetDragStatus(){this._rendererData.dragTarget=LineMouseTarget.none,this.data.dragPrice=void 0,this.updateAllViews(),this.requestUpdate()}updateAllViews(){this._rendererData=this._calculateRendererData(),this._paneView.update(this._rendererData)}priceAxisViews(){return[this._priceView]}paneViews(){return[this._paneView]}}class HintPrimitive extends SeriesPrimitive{constructor(ee,ne,re){super(ne,re);Ee(this,"_paneView");this._primitiveData=ee;const se=this._calculateRendererData(ee);this._paneView=new HintPaneView(se)}_calculateRendererData(ee){const re=this.chart.timeScale().width()-WidgetConfigs.widgetMarginRight/2,se=[{price:ee.parentPrice,hover:!!ee.parentHover,active:!!ee.parentActive}];return ee.slPrice&&se.push({price:ee.slPrice,hover:!!ee.slHover,active:!!ee.slActive}),ee.tpPrice&&se.push({price:ee.tpPrice,hover:!!ee.tpHover,active:!!ee.tpActive}),se.map(ae=>ae.price=ensure(this.series.priceToCoordinate(ae.price))),se.sort((ae,le)=>ae.price-le.price),{foreground:ee.foreground,background:ee.background,hoverBackground:ee.hoverBackground,x:re,yList:se.map(ae=>ae.price),hover:se.map(ae=>ae.hover),active:se.map(ae=>ae.active),visible:se.some(ae=>ae.active||ae.hover)}}resetActive(){Object.assign(this._primitiveData,{parentActive:!1,tpActive:!1,slActive:!1}),this.updateAllViews(),this.requestUpdate()}resetHover(){Object.assign(this._primitiveData,{parentHover:!1,tpHover:!1,slHover:!1}),this.updateAllViews(),this.requestUpdate()}updateData(ee){Object.assign(this._primitiveData,ee),this.updateAllViews(),this.requestUpdate()}updateAllViews(){const ee=this._calculateRendererData(this._primitiveData);this._paneView.update(ee)}paneViews(){return[this._paneView]}}var __getOwnPropDesc$1=Object.getOwnPropertyDescriptor,__decorateClass$1=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc$1(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam$1=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let TradeLineContrib=class extends Disposable{constructor(te,ee,ne,re,se){super();Ee(this,"_lines",new Map);Ee(this,"_hints",new Map);Ee(this,"_hitTestBounds",new Map);Ee(this,"_currentHovered");Ee(this,"_currentActive");Ee(this,"_currentTooltipBound");Ee(this,"_currentDrag");this.chartService=te,this.chartGuiService=ee,this.i18nService=re,this.themeService=se,this._register(te.onDataLoaded(()=>{ne.orders().then(ae=>{ae.forEach(le=>this._handleOrderUpdate(le))}),ne.positions().then(ae=>{ae.forEach(le=>this._handlePositionUpdate(le))})})),this._register(te.onSymbolChanged(()=>{const ae=this.chartService.mainSeriesWrapper.getSeries();this._resetActiveStatus(),this._resetHoverStatus(),this._resetDragStatus(),this._hideTooltip(),this._currentTooltipBound=void 0,this._hitTestBounds.clear(),this._lines.values().forEach(le=>{ae.detachPrimitive(le)}),this._lines.clear(),this._hints.values().forEach(le=>{ae.detachPrimitive(le)}),this._hints.clear()})),this._register(ne.onOrderUpdated(ae=>this._handleOrderUpdate(ae))),this._register(ne.onPositionUpdated(ae=>{this._handlePositionUpdate(ae.position)})),this._register(te.mainSeriesWrapper.onDataChanged(()=>{let ae;for(const[le,ce]of this._lines.entries()){if(!ce.data.order||!isMarketOrder(ce.data.order))continue;ae=ae??te.mainSeriesWrapper.getLastPrice(),ce.updatePrimitive({price:ae}),ensure(this._hints.get(le)).updateData({parentPrice:ae})}})),this._register(te.onCrosshairMove(ae=>{if(this._currentDrag||(this._resetHoverStatus(),!ae.point))return;const{x:le,y:ce}=ae.point;let he=!1;for(const[fe,Ae]of this._hitTestBounds.entries()){const pe=Ae.findLast(Oe=>Oe.hitTest(le,ce));if(pe){const Oe=ensure(this._lines.get(fe));Oe.updateHoverStatus(pe.targetType),this._currentHovered=Oe,te.showPaneCursor(PaneCursor.pointer),this._showTooltip(pe,Oe.data.type==="order"),he=!0;break}}he||this._hideTooltip()})),this._register(te.onClick(ae=>{if(this._resetActiveStatus(),!ae.point)return;const{x:le,y:ce}=ae.point;for(const[he,fe]of this._hitTestBounds.entries()){const Ae=fe.findLast(pe=>pe.hitTest(le,ce));if(Ae){const pe=ensure(this._lines.get(he));switch(pe.updateActiveStatus(!0),pe.updateHoverStatus(LineMouseTarget.none),this._currentActive=pe,te.showPaneCursor(PaneCursor.pointer),Ae.targetType){case LineMouseTarget.qty:pe.data.type==="position"?ne.showPositionBracketsDialog(ensure(pe.data.position),Object.create(null)):ne.showOrderDialog({...ensure(pe.data.order),modifyId:ensure(pe.data.order).id});break;case LineMouseTarget.cancel:pe.data.type==="position"?ne.showClosePositionDialog(ensure(pe.data.position)):ne.showCancelOrderDialog(ensure(pe.data.order).id);break;case LineMouseTarget.reverse:ne.showReversePositionDialog(ensure(pe.data.position));break}return}}})),this._register(te.onMouseDragStart(ae=>{const{mainSeriesWrapper:le}=te;for(const[ce,he]of this._hitTestBounds.entries()){const fe=he.findLast(Ae=>asDragTarget(Ae.targetType)!==LineMouseTarget.none&&Ae.hitTest(ae.localX,ae.localY));if(fe){const Ae=ensure(this._lines.get(ce));if(!(fe.targetType===LineMouseTarget.tp||fe.targetType===LineMouseTarget.sl||fe.targetType===LineMouseTarget.widget&&Ae.data.type!=="position"))continue;const pe=Ae.data.price??le.getLastPrice(),Oe=ensure(le.getSeries().priceToCoordinate(pe));this._currentDrag={line:Ae,mouseTarget:asDragTarget(fe.targetType),startX:ae.localX,startY:ae.localY,startPriceY:Oe,takeEffect:!1},this._currentActive=Ae,Ae.updateActiveStatus(!0),Ae.updateDragStatus(this._currentDrag.mouseTarget,pe),this._disableDefaultDrag(),this._hideTooltip(),te.showPaneCursor(PaneCursor.pointer);return}}})),this._register(te.onMouseDrag(ae=>{if(!this._currentDrag)return;if(!this._currentDrag.takeEffect){if(euclideanDistance(ae.localX,ae.localY,this._currentDrag.startX,this._currentDrag.startY)<DragEffectMinDistance)return;this._currentDrag.takeEffect=!0}const le=ae.localY-this._currentDrag.startY,ce=this._currentDrag.startPriceY+le;this._currentDrag.line.updateDragStatus(this._currentDrag.mouseTarget,ensure(te.mainSeriesWrapper.getSeries().coordinateToPrice(ce)))})),this._register(te.onMouseDrop(async ae=>{var pe;if(!((pe=this._currentDrag)!=null&&pe.takeEffect))return;const le=ae.localY-this._currentDrag.startY;if(Math.abs(le)<5)return this._resetDragStatus();const ce=this._currentDrag.startPriceY+le,he=te.mainSeriesWrapper.getSeries().coordinateToPrice(ce);should(he);const{line:fe,mouseTarget:Ae}=this._currentDrag;if(should(Ae!==LineMouseTarget.none),Ae===LineMouseTarget.tp){const Oe={symbol:fe.data.symbol,type:OrderType.Limit,side:fe.data.side===Side.Buy?Side.Sell:Side.Buy,qty:fe.data.qty,price:he,parentId:fe.data.originId,parentType:fe.data.type==="position"?ParentType.Position:ParentType.Order};await ne.showOrderDialog(Oe)}else if(Ae===LineMouseTarget.sl){const Oe={symbol:fe.data.symbol,type:OrderType.Stop,side:fe.data.side===Side.Buy?Side.Sell:Side.Buy,qty:fe.data.qty,price:he,parentId:fe.data.originId,parentType:fe.data.type==="position"?ParentType.Position:ParentType.Order};await ne.showOrderDialog(Oe)}else if(Ae===LineMouseTarget.widget){const Oe=ensure(fe.data.order),Fe={...Oe,price:he,modifyId:Oe.id};await ne.showOrderDialog(Fe)}this._enableDefaultDrag(),fe.resetDragStatus(),fe.updateActiveStatus(!0),this._resetHoverStatus(),this._currentDrag=void 0})),this._register(te.onMouseDropCanceled(()=>{this._resetDragStatus(),this._enableDefaultDrag()})),this._register(te.onPositionsAndOrdersVisibility(ae=>{this._lines.values().forEach(le=>le.updatePrimitive({visible:ae})),this._hints.values().forEach(le=>le.updateData({visible:ae})),ae||this._hitTestBounds.clear()}))}dispose(){super.dispose(),this._lines.values().forEach(te=>te.detach()),this._lines.clear(),this._hints.values().forEach(te=>te.detach()),this._hints.clear(),this._hitTestBounds.clear()}_disableDefaultDrag(){this.chartService.chart.applyOptions({handleScale:!1,handleScroll:!1,crosshair:{horzLine:{visible:!1},vertLine:{visible:!1,labelVisible:!1}}})}_enableDefaultDrag(){this.chartService.chart.applyOptions({handleScale:!0,handleScroll:!0,crosshair:{horzLine:{visible:!0},vertLine:{visible:!0,labelVisible:!0}}})}_handleOrderUpdate(te){var Ne,ze,He,We,je,Ue;const ee=this.chartService.mainSeriesWrapper,ne=ee.getSeries();if(te.status===OrderStatus.Canceled||te.status===OrderStatus.Filled){const Ge=this._lines.get(te.id);if(Ge&&(this._currentHovered===Ge&&this._resetHoverStatus(),this._currentActive===Ge&&this._resetActiveStatus(),((Ne=this._currentDrag)==null?void 0:Ne.line)===Ge&&this._resetDragStatus(),ne.detachPrimitive(Ge),this._lines.delete(te.id)),this._currentTooltipBound&&(ze=this._hitTestBounds.get(te.id))!=null&&ze.includes(this._currentTooltipBound)&&this._hideTooltip(),this._hitTestBounds.delete(te.id),isBracketOrder(te))isTakeProfitOrder(te)&&((He=this._lines.get(te.parentId))==null||He.updatePrimitive({tpVisible:!0}),(We=this._hints.get(te.parentId))==null||We.updateData({tpPrice:void 0})),isStopLossOrder(te)&&((je=this._lines.get(te.parentId))==null||je.updatePrimitive({slVisible:!0}),(Ue=this._hints.get(te.parentId))==null||Ue.updateData({slPrice:void 0}));else{const Ze=this._hints.get(te.id);Ze&&(ne.detachPrimitive(Ze),this._hints.delete(te.id))}return}const re=te.price??ee.getLastPrice(),se=this._lines.get(te.id);if(se){se.updatePrimitive({price:re,qty:te.qty,qtyText:this.i18nService.formatNumber(te.qty),order:te});const Ge=ensure(this._hints.get(te.parentId??te.id));isBracketOrder(te)||Ge.updateData({parentPrice:re}),isTakeProfitOrder(te)&&Ge.updateData({tpPrice:re}),isStopLossOrder(te)&&Ge.updateData({slPrice:re});return}const{key:ae,colorId:le}=getOrderKind(te),ce=le,he=this.themeService.isDark()?OrderBackgroundColors.dark:OrderBackgroundColors.light,fe=TPColor,Ae=SLColor;let pe;isBracketOrder(te)?pe=ensure(this._hints.get(te.parentId)):(pe=new HintPrimitive({visible:!0,parentPrice:re,foreground:ce,background:he,hoverBackground:generateColor(ce,80)},this.chartService.chart,ne),this._hints.set(te.id,pe),ne.attachPrimitive(pe));const Oe=isBracketOrder(te),Fe=new LinePrimitive({visible:!0,type:isBracketOrder(te)?isStopLossOrder(te)?"sl":"tp":"order",originId:te.id,symbol:te.symbol,side:te.side,qty:te.qty,qtyText:this.i18nService.formatNumber(te.qty),price:re,label:this.i18nService.t(ensure(ae)),foreground:ce,background:he,hoverBackground:generateColor(ce,80),tpForeground:fe,tpHoverBackground:generateColor(fe,80),slForeground:Ae,slHoverBackground:generateColor(Ae,80),tpVisible:!Oe,slVisible:!Oe,order:te},this.chartService.chart,ne,Ge=>{this._hitTestBounds.set(te.id,Ge)},pe);if(this._lines.set(te.id,Fe),ne.attachPrimitive(Fe),isBracketOrder(te)){const Ge=ensure(this._lines.get(te.parentId));isTakeProfitOrder(te)&&Ge.updatePrimitive({tpVisible:!1}),isStopLossOrder(te)&&Ge.updatePrimitive({slVisible:!1})}}_handlePositionUpdate(te){const ee=this._lines.get(te.id);if(ee){ee.updatePrimitive({price:te.avgPrice,qty:te.qty,qtyText:this.i18nService.formatNumber(te.qty),position:te});return}const ne=this.chartService.mainSeriesWrapper.getSeries(),re=isLongPosition(te)?BuyColor:SellColor,se=this.themeService.isDark()?OrderBackgroundColors.dark:OrderBackgroundColors.light,ae=TPColor,le=SLColor,ce=new HintPrimitive({visible:!0,parentPrice:te.avgPrice,foreground:re,background:se,hoverBackground:generateColor(re,80)},this.chartService.chart,ne);this._hints.set(te.id,ce),ne.attachPrimitive(ce);const he=new LinePrimitive({visible:!0,type:"position",originId:te.id,symbol:te.symbol,side:te.side,qty:te.qty,qtyText:this.i18nService.formatNumber(te.qty),price:te.avgPrice,foreground:re,background:se,hoverBackground:generateColor(re,80),tpForeground:ae,tpHoverBackground:generateColor(ae,80),slForeground:le,slHoverBackground:generateColor(le,80),tpVisible:!0,slVisible:!0,position:te},this.chartService.chart,ne,fe=>{this._hitTestBounds.set(te.id,fe)},ce);this._lines.set(te.id,he),ne.attachPrimitive(he)}_resetHoverStatus(){var te;(te=this._currentHovered)==null||te.updateHoverStatus(LineMouseTarget.none),this._currentHovered=void 0}_resetActiveStatus(){var te;(te=this._currentActive)==null||te.updateActiveStatus(!1),this._currentActive=void 0}_resetDragStatus(){if(!this._currentDrag)return;this.chartService.chart.applyOptions({handleScale:!0,handleScroll:!0,crosshair:{horzLine:{visible:!0},vertLine:{visible:!0,labelVisible:!0}}});const{line:te}=this._currentDrag;te.resetDragStatus(),te.updateHoverStatus(LineMouseTarget.none),this._currentDrag=void 0}_showTooltip(te,ee){if(isEqual(this._currentTooltipBound,te))return;this._currentTooltipBound=te;let ne="";const{t:re}=this.i18nService;switch(te.targetType){case LineMouseTarget.cancel:ne=re(ee?"tradePrimitive.order.tip.cancel":"tradePrimitive.position.tip.close");break;case LineMouseTarget.qty:ne=re(ee?"tradePrimitive.order.tip.modify":"tradePrimitive.position.tip.protect");break;case LineMouseTarget.sl:ne=re("tradePrimitive.order.tip.sl");break;case LineMouseTarget.tp:ne=re("tradePrimitive.order.tip.tp");break;case LineMouseTarget.reverse:ne=re("tradePrimitive.position.tip.rv");break}ne&&this.chartGuiService.showPaneTooltip({anchor:{x:te.left,y:te.top,width:te.right-te.left,height:te.bottom-te.top},content:ne})}_hideTooltip(){this._currentTooltipBound&&(this._currentTooltipBound=void 0,this.chartGuiService.hidePaneTooltip())}};TradeLineContrib=__decorateClass$1([__decorateParam$1(0,IChartService),__decorateParam$1(1,IChartGuiService),__decorateParam$1(2,ITradeService),__decorateParam$1(3,II18nService),__decorateParam$1(4,IThemeService)],TradeLineContrib);enable_legacy_mode_flag();function derivedWithCache(ie,te,ee){const ne=writable(ee),se=derived(ie,te,ee).subscribe(ae=>{isEqual(ae,get$1(ne))||ne.set(ae)});return onDestroy(()=>se()),ne}var Codepoint=(ie=>(ie[ie.a=97]="a",ie))(Codepoint||{});function isLowerAsciiLetter(ie){return ie>=CharCode.a&&ie<=CharCode.z}function compareSubstring(ie,te,ee=0,ne=ie.length,re=0,se=te.length){for(;ee<ne&&re<se;ee++,re++){const ce=ie.charCodeAt(ee),he=te.charCodeAt(re);if(ce<he)return-1;if(ce>he)return 1}const ae=ne-ee,le=se-re;return ae<le?-1:ae>le?1:0}function compareSubstringIgnoreCase(ie,te,ee=0,ne=ie.length,re=0,se=te.length){for(;ee<ne&&re<se;ee++,re++){let ce=ie.charCodeAt(ee),he=te.charCodeAt(re);if(ce===he)continue;if(ce>=128||he>=128)return compareSubstring(ie.toLowerCase(),te.toLowerCase(),ee,ne,re,se);isLowerAsciiLetter(ce)&&(ce-=32),isLowerAsciiLetter(he)&&(he-=32);const fe=ce-he;if(fe!==0)return fe}const ae=ne-ee,le=se-re;return ae<le?-1:ae>le?1:0}function startsWithIgnoreCase(ie,te){const ee=te.length;return te.length>ie.length?!1:compareSubstringIgnoreCase(ie,te,0,ee)===0}function stripWildcards(ie){return ie.replace(/\*/g,"")}/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var CssClasses=(ie=>(ie.RICH="mdc-tooltip--rich",ie.SHOWN="mdc-tooltip--shown",ie.SHOWING="mdc-tooltip--showing",ie.SHOWING_TRANSITION="mdc-tooltip--showing-transition",ie.HIDE="mdc-tooltip--hide",ie.HIDE_TRANSITION="mdc-tooltip--hide-transition",ie.MULTILINE_TOOLTIP="mdc-tooltip--multiline",ie.SURFACE="mdc-tooltip__surface",ie.SURFACE_ANIMATION="mdc-tooltip__surface-animation",ie.TOOLTIP_CARET_TOP="mdc-tooltip__caret-surface-top",ie.TOOLTIP_CARET_BOTTOM="mdc-tooltip__caret-surface-bottom",ie))(CssClasses||{});const numbers$1={BOUNDED_ANCHOR_GAP:4,UNBOUNDED_ANCHOR_GAP:8,MIN_VIEWPORT_TOOLTIP_THRESHOLD:8,HIDE_DELAY_MS:100,SHOW_DELAY_MS:100,MIN_WIDTH:40,MIN_HEIGHT:24,MAX_WIDTH:200,CARET_INDENTATION:24,ANIMATION_SCALE:.8,RICH_MAX_WIDTH:320},attributes={ARIA_EXPANDED:"aria-expanded",ARIA_HASPOPUP:"aria-haspopup",PERSISTENT:"data-mdc-tooltip-persistent",HAS_CARET:"data-mdc-tooltip-has-caret"};var XPosition=(ie=>(ie[ie.DETECTED=0]="DETECTED",ie[ie.START=1]="START",ie[ie.CENTER=2]="CENTER",ie[ie.END=3]="END",ie[ie.SIDE_START=4]="SIDE_START",ie[ie.SIDE_END=5]="SIDE_END",ie))(XPosition||{}),YPosition=(ie=>(ie[ie.DETECTED=0]="DETECTED",ie[ie.ABOVE=1]="ABOVE",ie[ie.BELOW=2]="BELOW",ie[ie.SIDE=3]="SIDE",ie))(YPosition||{}),AnchorBoundaryType=(ie=>(ie[ie.BOUNDED=0]="BOUNDED",ie[ie.UNBOUNDED=1]="UNBOUNDED",ie))(AnchorBoundaryType||{});const strings$1={LEFT:"left",RIGHT:"right",CENTER:"center",TOP:"top",BOTTOM:"bottom"};var PositionWithCaret=(ie=>(ie[ie.DETECTED=0]="DETECTED",ie[ie.ABOVE_START=1]="ABOVE_START",ie[ie.ABOVE_CENTER=2]="ABOVE_CENTER",ie[ie.ABOVE_END=3]="ABOVE_END",ie[ie.TOP_SIDE_START=4]="TOP_SIDE_START",ie[ie.CENTER_SIDE_START=5]="CENTER_SIDE_START",ie[ie.BOTTOM_SIDE_START=6]="BOTTOM_SIDE_START",ie[ie.TOP_SIDE_END=7]="TOP_SIDE_END",ie[ie.CENTER_SIDE_END=8]="CENTER_SIDE_END",ie[ie.BOTTOM_SIDE_END=9]="BOTTOM_SIDE_END",ie[ie.BELOW_START=10]="BELOW_START",ie[ie.BELOW_CENTER=11]="BELOW_CENTER",ie[ie.BELOW_END=12]="BELOW_END",ie))(PositionWithCaret||{}),YPositionWithCaret=(ie=>(ie[ie.ABOVE=1]="ABOVE",ie[ie.BELOW=2]="BELOW",ie[ie.SIDE_TOP=3]="SIDE_TOP",ie[ie.SIDE_CENTER=4]="SIDE_CENTER",ie[ie.SIDE_BOTTOM=5]="SIDE_BOTTOM",ie))(YPositionWithCaret||{}),XPositionWithCaret=(ie=>(ie[ie.START=1]="START",ie[ie.CENTER=2]="CENTER",ie[ie.END=3]="END",ie[ie.SIDE_START=4]="SIDE_START",ie[ie.SIDE_END=5]="SIDE_END",ie))(XPositionWithCaret||{});/**
 * @license
 * Copyright 2020 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */const{RICH,SHOWN,SHOWING,SHOWING_TRANSITION,HIDE,HIDE_TRANSITION,MULTILINE_TOOLTIP}=CssClasses,HAS_WINDOW=typeof window<"u";class MDCTooltipFoundation extends MDCFoundation{constructor(te){super({...MDCTooltipFoundation.defaultAdapter,...te}),this.tooltipShown=!1,this.anchorGap=numbers$1.BOUNDED_ANCHOR_GAP,this.xTooltipPos=XPosition.DETECTED,this.yTooltipPos=YPosition.DETECTED,this.tooltipPositionWithCaret=PositionWithCaret.DETECTED,this.minViewportTooltipThreshold=numbers$1.MIN_VIEWPORT_TOOLTIP_THRESHOLD,this.hideDelayMs=numbers$1.HIDE_DELAY_MS,this.showDelayMs=numbers$1.SHOW_DELAY_MS,this.anchorRect=null,this.parentRect=null,this.frameId=null,this.hideTimeout=null,this.showTimeout=null,this.addAncestorScrollEventListeners=new Array,this.removeAncestorScrollEventListeners=new Array,this.animFrame=new AnimationFrame,this.anchorBlurHandler=ee=>{this.handleAnchorBlur(ee)},this.documentClickHandler=ee=>{this.handleDocumentClick(ee)},this.documentKeydownHandler=ee=>{this.handleKeydown(ee)},this.tooltipMouseEnterHandler=()=>{this.handleTooltipMouseEnter()},this.tooltipMouseLeaveHandler=()=>{this.handleTooltipMouseLeave()},this.richTooltipFocusOutHandler=ee=>{this.handleRichTooltipFocusOut(ee)},this.windowScrollHandler=()=>{this.handleWindowScrollEvent()},this.windowResizeHandler=()=>{this.handleWindowChangeEvent()}}static get defaultAdapter(){return{getAttribute:()=>null,setAttribute:()=>{},removeAttribute:()=>{},addClass:()=>{},hasClass:()=>!1,removeClass:()=>{},getComputedStyleProperty:()=>"",setStyleProperty:()=>{},setSurfaceAnimationStyleProperty:()=>{},getViewportWidth:()=>0,getViewportHeight:()=>0,getTooltipSize:()=>({width:0,height:0}),getAnchorBoundingRect:()=>({top:0,right:0,bottom:0,left:0,width:0,height:0}),getParentBoundingRect:()=>({top:0,right:0,bottom:0,left:0,width:0,height:0}),getAnchorAttribute:()=>null,setAnchorAttribute:()=>null,isRTL:()=>!1,anchorContainsElement:()=>!1,tooltipContainsElement:()=>!1,focusAnchorElement:()=>{},registerEventHandler:()=>{},deregisterEventHandler:()=>{},registerAnchorEventHandler:()=>{},deregisterAnchorEventHandler:()=>{},registerDocumentEventHandler:()=>{},deregisterDocumentEventHandler:()=>{},registerWindowEventHandler:()=>{},deregisterWindowEventHandler:()=>{},notifyHidden:()=>{},notifyShown:()=>{},getTooltipCaretBoundingRect:()=>({top:0,right:0,bottom:0,left:0,width:0,height:0}),setTooltipCaretStyle:()=>{},clearTooltipCaretStyles:()=>{},getActiveElement:()=>null,isInstanceOfElement:()=>!1}}init(){this.richTooltip=this.adapter.hasClass(RICH),this.persistentTooltip=this.adapter.getAttribute(attributes.PERSISTENT)==="true",this.interactiveTooltip=!!this.adapter.getAnchorAttribute(attributes.ARIA_EXPANDED)&&this.adapter.getAnchorAttribute(attributes.ARIA_HASPOPUP)==="dialog",this.hasCaret=this.richTooltip&&this.adapter.getAttribute(attributes.HAS_CARET)==="true"}isShown(){return this.tooltipShown}isRich(){return this.richTooltip}isPersistent(){return this.persistentTooltip}handleAnchorMouseEnter(){this.tooltipShown?this.show():(this.clearHideTimeout(),this.showTimeout=setTimeout(()=>{this.show()},this.showDelayMs))}handleAnchorTouchstart(){this.showTimeout=setTimeout(()=>{this.show()},this.showDelayMs),this.adapter.registerWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch)}preventContextMenuOnLongTouch(te){te.preventDefault()}tooltipContainsRelatedTargetElement(te){return this.adapter.isInstanceOfElement(te)&&this.adapter.tooltipContainsElement(te)}anchorOrTooltipContainsTargetElement(te){return this.adapter.isInstanceOfElement(te)&&(this.adapter.tooltipContainsElement(te)||this.adapter.anchorContainsElement(te))}handleAnchorTouchend(){this.clearShowTimeout(),this.isShown()||this.adapter.deregisterWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch)}handleAnchorFocus(te){this.tooltipContainsRelatedTargetElement(te.relatedTarget)||(this.showTimeout=setTimeout(()=>{this.show()},this.showDelayMs))}handleAnchorMouseLeave(){this.clearShowTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.hideDelayMs)}handleAnchorClick(){this.tooltipShown?this.hide():this.show()}handleDocumentClick(te){this.richTooltip&&this.persistentTooltip&&this.anchorOrTooltipContainsTargetElement(te.target)||this.hide()}handleKeydown(te){if(normalizeKey(te)===KEY.ESCAPE){const ne=this.adapter.getActiveElement();let re=!1;return this.adapter.isInstanceOfElement(ne)&&(re=this.adapter.tooltipContainsElement(ne)),re&&this.adapter.focusAnchorElement(),this.hide(),te.stopPropagation(),!1}return!0}handleAnchorBlur(te){this.richTooltip&&(te.relatedTarget===null||this.tooltipContainsRelatedTargetElement(te.relatedTarget))||this.hide()}handleTooltipMouseEnter(){this.show()}handleTooltipMouseLeave(){this.clearShowTimeout(),this.hideTimeout=setTimeout(()=>{this.hide()},this.hideDelayMs)}handleRichTooltipFocusOut(te){this.anchorOrTooltipContainsTargetElement(te.relatedTarget)||te.relatedTarget===null&&this.interactiveTooltip||this.hide()}handleWindowScrollEvent(){this.persistentTooltip||this.hide()}handleWindowChangeEvent(){this.animFrame.request("poll_anchor",()=>{this.repositionTooltipOnAnchorMove()})}show(){if(this.clearHideTimeout(),this.clearShowTimeout(),!this.tooltipShown){this.tooltipShown=!0,this.adapter.removeAttribute("aria-hidden"),this.richTooltip&&(this.interactiveTooltip&&this.adapter.setAnchorAttribute("aria-expanded","true"),this.adapter.registerEventHandler("focusout",this.richTooltipFocusOutHandler)),this.persistentTooltip||(this.adapter.registerEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.registerEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.adapter.removeClass(HIDE),this.adapter.addClass(SHOWING),this.isTooltipMultiline()&&!this.richTooltip&&this.adapter.addClass(MULTILINE_TOOLTIP),this.anchorRect=this.adapter.getAnchorBoundingRect(),this.parentRect=this.adapter.getParentBoundingRect(),this.richTooltip?this.positionRichTooltip():this.positionPlainTooltip(),this.adapter.registerAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.registerDocumentEventHandler("click",this.documentClickHandler),this.adapter.registerDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.registerWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.registerWindowEventHandler("resize",this.windowResizeHandler);for(const te of this.addAncestorScrollEventListeners)te();this.frameId=requestAnimationFrame(()=>{this.clearAllAnimationClasses(),this.adapter.addClass(SHOWN),this.adapter.addClass(SHOWING_TRANSITION)})}}hide(){if(this.clearHideTimeout(),this.clearShowTimeout(),!!this.tooltipShown){this.frameId&&cancelAnimationFrame(this.frameId),this.tooltipShown=!1,this.adapter.setAttribute("aria-hidden","true"),this.adapter.deregisterEventHandler("focusout",this.richTooltipFocusOutHandler),this.richTooltip&&this.interactiveTooltip&&this.adapter.setAnchorAttribute("aria-expanded","false"),this.persistentTooltip||(this.adapter.deregisterEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.deregisterEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.clearAllAnimationClasses(),this.adapter.addClass(HIDE),this.adapter.addClass(HIDE_TRANSITION),this.adapter.removeClass(SHOWN),this.adapter.deregisterAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.deregisterDocumentEventHandler("click",this.documentClickHandler),this.adapter.deregisterDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.deregisterWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler),this.adapter.deregisterWindowEventHandler("contextmenu",this.preventContextMenuOnLongTouch);for(const te of this.removeAncestorScrollEventListeners)te()}}handleTransitionEnd(){const te=this.adapter.hasClass(HIDE);this.adapter.removeClass(SHOWING),this.adapter.removeClass(SHOWING_TRANSITION),this.adapter.removeClass(HIDE),this.adapter.removeClass(HIDE_TRANSITION),te&&this.showTimeout===null?this.adapter.notifyHidden():te||this.adapter.notifyShown()}clearAllAnimationClasses(){this.adapter.removeClass(SHOWING_TRANSITION),this.adapter.removeClass(HIDE_TRANSITION)}setTooltipPosition(te){const{xPos:ee,yPos:ne,withCaretPos:re}=te;if(this.hasCaret&&re){this.tooltipPositionWithCaret=re;return}ee&&(this.xTooltipPos=ee),ne&&(this.yTooltipPos=ne)}setAnchorBoundaryType(te){te===AnchorBoundaryType.UNBOUNDED?this.anchorGap=numbers$1.UNBOUNDED_ANCHOR_GAP:this.anchorGap=numbers$1.BOUNDED_ANCHOR_GAP}setShowDelay(te){this.showDelayMs=te}setHideDelay(te){this.hideDelayMs=te}isTooltipMultiline(){const te=this.adapter.getTooltipSize();return te.height>numbers$1.MIN_HEIGHT&&te.width>=numbers$1.MAX_WIDTH}positionPlainTooltip(){const{top:te,yTransformOrigin:ee,left:ne,xTransformOrigin:re}=this.calculateTooltipStyles(this.anchorRect),se=HAS_WINDOW?getCorrectPropertyName(window,"transform"):"transform";this.adapter.setSurfaceAnimationStyleProperty(`${se}-origin`,`${re} ${ee}`),this.adapter.setStyleProperty("top",`${te}px`),this.adapter.setStyleProperty("left",`${ne}px`)}positionRichTooltip(){var pe,Oe;this.adapter.setStyleProperty("width",""),this.adapter.setStyleProperty("left",`-${numbers$1.RICH_MAX_WIDTH}px`);const te=Number(this.adapter.getComputedStyleProperty("width").slice(0,-2)),ee=isFinite(te)?te:numbers$1.RICH_MAX_WIDTH,ne=Math.max(this.adapter.getViewportWidth()-2*numbers$1.MIN_VIEWPORT_TOOLTIP_THRESHOLD,numbers$1.MIN_WIDTH),re=Math.min(ne,ee);this.adapter.setStyleProperty("width",`${re}px`);const{top:se,yTransformOrigin:ae,left:le,xTransformOrigin:ce}=this.hasCaret?this.calculateTooltipWithCaretStyles(this.anchorRect):this.calculateTooltipStyles(this.anchorRect),he=HAS_WINDOW?getCorrectPropertyName(window,"transform"):"transform";this.adapter.setSurfaceAnimationStyleProperty(`${he}-origin`,`${ce} ${ae}`);const fe=le-(((pe=this.parentRect)==null?void 0:pe.left)??0),Ae=se-(((Oe=this.parentRect)==null?void 0:Oe.top)??0);this.adapter.setStyleProperty("top",`${Ae}px`),this.adapter.setStyleProperty("left",`${fe}px`)}calculateTooltipStyles(te){if(!te)return{top:0,left:0};const ee=this.adapter.getTooltipSize(),ne=this.calculateYTooltipDistance(te,ee.height),re=this.calculateXTooltipDistance(te,ee.width);return{top:ne.distance,yTransformOrigin:ne.yTransformOrigin,left:re.distance,xTransformOrigin:re.xTransformOrigin}}calculateXTooltipDistance(te,ee){const ne=!this.adapter.isRTL();let re,se,ae,le,ce,he,fe;if(this.richTooltip)re=ne?te.left-ee:te.right,se=ne?te.right:te.left-ee,he=ne?strings$1.RIGHT:strings$1.LEFT,fe=ne?strings$1.LEFT:strings$1.RIGHT;else{re=ne?te.left:te.right-ee,se=ne?te.right-ee:te.left,ae=te.left+(te.width-ee)/2;const Ne=te.left-(ee+this.anchorGap),ze=te.right+this.anchorGap;le=ne?Ne:ze,ce=ne?ze:Ne,he=ne?strings$1.LEFT:strings$1.RIGHT,fe=ne?strings$1.RIGHT:strings$1.LEFT}const Ae=[re,ae,se];this.xTooltipPos===XPosition.SIDE_START?Ae.push(le):this.xTooltipPos===XPosition.SIDE_END&&Ae.push(ce);const pe=this.richTooltip?this.determineValidPositionOptions(re,se):this.determineValidPositionOptions(...Ae);if(this.xTooltipPos===XPosition.START&&pe.has(re))return{distance:re,xTransformOrigin:he};if(this.xTooltipPos===XPosition.END&&pe.has(se))return{distance:se,xTransformOrigin:fe};if(this.xTooltipPos===XPosition.CENTER&&pe.has(ae))return{distance:ae,xTransformOrigin:strings$1.CENTER};if(this.xTooltipPos===XPosition.SIDE_START&&pe.has(le))return{distance:le,xTransformOrigin:fe};if(this.xTooltipPos===XPosition.SIDE_END&&pe.has(ce))return{distance:ce,xTransformOrigin:he};const Fe=(this.richTooltip?[{distance:se,xTransformOrigin:fe},{distance:re,xTransformOrigin:he}]:[{distance:ae,xTransformOrigin:strings$1.CENTER},{distance:re,xTransformOrigin:he},{distance:se,xTransformOrigin:fe}]).find(({distance:Ne})=>pe.has(Ne));return Fe||(te.left<0?{distance:this.minViewportTooltipThreshold,xTransformOrigin:strings$1.LEFT}:{distance:this.adapter.getViewportWidth()-(ee+this.minViewportTooltipThreshold),xTransformOrigin:strings$1.RIGHT})}determineValidPositionOptions(...te){const ee=new Set,ne=new Set;for(const re of te)this.positionHonorsViewportThreshold(re)?ee.add(re):this.positionDoesntCollideWithViewport(re)&&ne.add(re);return ee.size?ee:ne}positionHonorsViewportThreshold(te){const ee=this.adapter.getViewportWidth(),ne=this.adapter.getTooltipSize().width;return te+ne<=ee-this.minViewportTooltipThreshold&&te>=this.minViewportTooltipThreshold}positionDoesntCollideWithViewport(te){const ee=this.adapter.getViewportWidth(),ne=this.adapter.getTooltipSize().width;return te+ne<=ee&&te>=0}calculateYTooltipDistance(te,ee){const ne=te.bottom+this.anchorGap,re=te.top-(this.anchorGap+ee),ae=te.top+te.height/2-ee/2,le=[re,ne];this.yTooltipPos===YPosition.SIDE&&le.push(ae);const ce=this.determineValidYPositionOptions(...le);return this.yTooltipPos===YPosition.ABOVE&&ce.has(re)?{distance:re,yTransformOrigin:strings$1.BOTTOM}:this.yTooltipPos===YPosition.BELOW&&ce.has(ne)?{distance:ne,yTransformOrigin:strings$1.TOP}:this.yTooltipPos===YPosition.SIDE&&ce.has(ae)?{distance:ae,yTransformOrigin:strings$1.CENTER}:ce.has(ne)?{distance:ne,yTransformOrigin:strings$1.TOP}:ce.has(re)?{distance:re,yTransformOrigin:strings$1.BOTTOM}:{distance:ne,yTransformOrigin:strings$1.TOP}}determineValidYPositionOptions(...te){const ee=new Set,ne=new Set;for(const re of te)this.yPositionHonorsViewportThreshold(re)?ee.add(re):this.yPositionDoesntCollideWithViewport(re)&&ne.add(re);return ee.size?ee:ne}yPositionHonorsViewportThreshold(te){const ee=this.adapter.getViewportHeight(),ne=this.adapter.getTooltipSize().height;return te+ne+this.minViewportTooltipThreshold<=ee&&te>=this.minViewportTooltipThreshold}yPositionDoesntCollideWithViewport(te){const ee=this.adapter.getViewportHeight(),ne=this.adapter.getTooltipSize().height;return te+ne<=ee&&te>=0}calculateTooltipWithCaretStyles(te){this.adapter.clearTooltipCaretStyles();const ee=this.adapter.getTooltipCaretBoundingRect();if(!te||!ee)return{position:PositionWithCaret.DETECTED,top:0,left:0};const ne=ee.width/numbers$1.ANIMATION_SCALE,re=ee.height/numbers$1.ANIMATION_SCALE/2,se=this.adapter.getTooltipSize(),ae=this.calculateYWithCaretDistanceOptions(te,se.height,{caretWidth:ne,caretHeight:re}),le=this.calculateXWithCaretDistanceOptions(te,se.width,{caretWidth:ne,caretHeight:re});let ce=this.validateTooltipWithCaretDistances(ae,le);ce.size<1&&(ce=this.generateBackupPositionOption(te,se,{caretWidth:ne,caretHeight:re}));const{position:he,xDistance:fe,yDistance:Ae}=this.determineTooltipWithCaretDistance(ce),{yTransformOrigin:pe,xTransformOrigin:Oe}=this.setCaretPositionStyles(he,{caretWidth:ne,caretHeight:re});return{yTransformOrigin:pe,xTransformOrigin:Oe,top:Ae,left:fe}}calculateXWithCaretDistanceOptions(te,ee,ne){const{caretWidth:re,caretHeight:se}=ne,ae=!this.adapter.isRTL(),le=te.left+te.width/2,ce=te.left-(ee+this.anchorGap+se),he=te.right+this.anchorGap+se,fe=ae?ce:he,Ae=ae?he:ce,pe=le-(numbers$1.CARET_INDENTATION+re/2),Oe=le-(ee-numbers$1.CARET_INDENTATION-re/2),Fe=ae?pe:Oe,Ne=ae?Oe:pe,ze=le-ee/2;return new Map([[XPositionWithCaret.START,Fe],[XPositionWithCaret.CENTER,ze],[XPositionWithCaret.END,Ne],[XPositionWithCaret.SIDE_END,Ae],[XPositionWithCaret.SIDE_START,fe]])}calculateYWithCaretDistanceOptions(te,ee,ne){const{caretWidth:re,caretHeight:se}=ne,ae=te.top+te.height/2,le=te.bottom+this.anchorGap+se,ce=te.top-(this.anchorGap+ee+se),he=ae-(numbers$1.CARET_INDENTATION+re/2),fe=ae-ee/2,Ae=ae-(ee-numbers$1.CARET_INDENTATION-re/2);return new Map([[YPositionWithCaret.ABOVE,ce],[YPositionWithCaret.BELOW,le],[YPositionWithCaret.SIDE_TOP,he],[YPositionWithCaret.SIDE_CENTER,fe],[YPositionWithCaret.SIDE_BOTTOM,Ae]])}repositionTooltipOnAnchorMove(){const te=this.adapter.getAnchorBoundingRect();if(!te||!this.anchorRect)return;const ee=this.adapter.getViewportHeight();te.top+te.height<0||te.bottom-te.height>=ee||(te.top!==this.anchorRect.top||te.left!==this.anchorRect.left||te.height!==this.anchorRect.height||te.width!==this.anchorRect.width)&&(this.anchorRect=te,this.parentRect=this.adapter.getParentBoundingRect(),this.richTooltip?this.positionRichTooltip():this.positionPlainTooltip())}validateTooltipWithCaretDistances(te,ee){const ne=new Map,re=new Map,se=new Map([[YPositionWithCaret.ABOVE,[XPositionWithCaret.START,XPositionWithCaret.CENTER,XPositionWithCaret.END]],[YPositionWithCaret.BELOW,[XPositionWithCaret.START,XPositionWithCaret.CENTER,XPositionWithCaret.END]],[YPositionWithCaret.SIDE_TOP,[XPositionWithCaret.SIDE_START,XPositionWithCaret.SIDE_END]],[YPositionWithCaret.SIDE_CENTER,[XPositionWithCaret.SIDE_START,XPositionWithCaret.SIDE_END]],[YPositionWithCaret.SIDE_BOTTOM,[XPositionWithCaret.SIDE_START,XPositionWithCaret.SIDE_END]]]);for(const ae of se.keys()){const le=te.get(ae);if(this.yPositionHonorsViewportThreshold(le))for(const ce of se.get(ae)){const he=ee.get(ce);if(this.positionHonorsViewportThreshold(he)){const fe=this.caretPositionOptionsMapping(ce,ae);ne.set(fe,{xDistance:he,yDistance:le})}}if(this.yPositionDoesntCollideWithViewport(le))for(const ce of se.get(ae)){const he=ee.get(ce);if(this.positionDoesntCollideWithViewport(he)){const fe=this.caretPositionOptionsMapping(ce,ae);re.set(fe,{xDistance:he,yDistance:le})}}}return ne.size?ne:re}generateBackupPositionOption(te,ee,ne){const re=!this.adapter.isRTL();let se,ae;te.left<0?(se=this.minViewportTooltipThreshold+ne.caretHeight,ae=re?XPositionWithCaret.END:XPositionWithCaret.START):(se=this.adapter.getViewportWidth()-(ee.width+this.minViewportTooltipThreshold+ne.caretHeight),ae=re?XPositionWithCaret.START:XPositionWithCaret.END);let le,ce;te.top<0?(le=this.minViewportTooltipThreshold+ne.caretHeight,ce=YPositionWithCaret.BELOW):(le=this.adapter.getViewportHeight()-(ee.height+this.minViewportTooltipThreshold+ne.caretHeight),ce=YPositionWithCaret.ABOVE);const he=this.caretPositionOptionsMapping(ae,ce);return new Map([[he,{xDistance:se,yDistance:le}]])}determineTooltipWithCaretDistance(te){if(te.has(this.tooltipPositionWithCaret)){const se=te.get(this.tooltipPositionWithCaret);return{position:this.tooltipPositionWithCaret,xDistance:se.xDistance,yDistance:se.yDistance}}const ne=[PositionWithCaret.ABOVE_START,PositionWithCaret.ABOVE_CENTER,PositionWithCaret.ABOVE_END,PositionWithCaret.TOP_SIDE_START,PositionWithCaret.CENTER_SIDE_START,PositionWithCaret.BOTTOM_SIDE_START,PositionWithCaret.TOP_SIDE_END,PositionWithCaret.CENTER_SIDE_END,PositionWithCaret.BOTTOM_SIDE_END,PositionWithCaret.BELOW_START,PositionWithCaret.BELOW_CENTER,PositionWithCaret.BELOW_END].find(se=>te.has(se)),re=te.get(ne);return{position:ne,xDistance:re.xDistance,yDistance:re.yDistance}}caretPositionOptionsMapping(te,ee){switch(ee){case YPositionWithCaret.ABOVE:if(te===XPositionWithCaret.START)return PositionWithCaret.ABOVE_START;if(te===XPositionWithCaret.CENTER)return PositionWithCaret.ABOVE_CENTER;if(te===XPositionWithCaret.END)return PositionWithCaret.ABOVE_END;break;case YPositionWithCaret.BELOW:if(te===XPositionWithCaret.START)return PositionWithCaret.BELOW_START;if(te===XPositionWithCaret.CENTER)return PositionWithCaret.BELOW_CENTER;if(te===XPositionWithCaret.END)return PositionWithCaret.BELOW_END;break;case YPositionWithCaret.SIDE_TOP:if(te===XPositionWithCaret.SIDE_START)return PositionWithCaret.TOP_SIDE_START;if(te===XPositionWithCaret.SIDE_END)return PositionWithCaret.TOP_SIDE_END;break;case YPositionWithCaret.SIDE_CENTER:if(te===XPositionWithCaret.SIDE_START)return PositionWithCaret.CENTER_SIDE_START;if(te===XPositionWithCaret.SIDE_END)return PositionWithCaret.CENTER_SIDE_END;break;case YPositionWithCaret.SIDE_BOTTOM:if(te===XPositionWithCaret.SIDE_START)return PositionWithCaret.BOTTOM_SIDE_START;if(te===XPositionWithCaret.SIDE_END)return PositionWithCaret.BOTTOM_SIDE_END;break}throw new Error(`MDCTooltipFoundation: Invalid caret position of ${te}, ${ee}`)}setCaretPositionStyles(te,ee){const ne=this.calculateCaretPositionOnTooltip(te,ee);if(!ne)return{yTransformOrigin:0,xTransformOrigin:0};this.adapter.clearTooltipCaretStyles(),this.adapter.setTooltipCaretStyle(ne.yAlignment,ne.yAxisPx),this.adapter.setTooltipCaretStyle(ne.xAlignment,ne.xAxisPx);const re=ne.skew*(Math.PI/180),se=Math.cos(re);this.adapter.setTooltipCaretStyle("transform",`rotate(${ne.rotation}deg) skewY(${ne.skew}deg) scaleX(${se})`),this.adapter.setTooltipCaretStyle("transform-origin",`${ne.xAlignment} ${ne.yAlignment}`);for(const ae of ne.caretCorners)this.adapter.setTooltipCaretStyle(ae,"0");return{yTransformOrigin:ne.yTransformOrigin,xTransformOrigin:ne.xTransformOrigin}}calculateCaretPositionOnTooltip(te,ee){const ne=!this.adapter.isRTL(),re=this.adapter.getComputedStyleProperty("width"),se=this.adapter.getComputedStyleProperty("height");if(!re||!se||!ee)return;const ae=`calc((${re} - ${ee.caretWidth}px) / 2)`,le=`calc((${se} - ${ee.caretWidth}px) / 2)`,ce="0",he=`${numbers$1.CARET_INDENTATION}px`,fe=`calc(${re} - ${he})`,Ae=`calc(${se} - ${he})`,pe=35,Oe=Math.abs(90-pe),Fe=["border-bottom-right-radius","border-top-left-radius"],Ne=["border-bottom-left-radius","border-top-right-radius"],ze=20;switch(te){case PositionWithCaret.BELOW_CENTER:return{yAlignment:strings$1.TOP,xAlignment:strings$1.LEFT,yAxisPx:ce,xAxisPx:ae,rotation:-1*pe,skew:-1*ze,xTransformOrigin:ae,yTransformOrigin:ce,caretCorners:Fe};case PositionWithCaret.BELOW_END:return{yAlignment:strings$1.TOP,xAlignment:ne?strings$1.RIGHT:strings$1.LEFT,yAxisPx:ce,xAxisPx:he,rotation:ne?pe:-1*pe,skew:ne?ze:-1*ze,xTransformOrigin:ne?fe:he,yTransformOrigin:ce,caretCorners:ne?Ne:Fe};case PositionWithCaret.BELOW_START:return{yAlignment:strings$1.TOP,xAlignment:ne?strings$1.LEFT:strings$1.RIGHT,yAxisPx:ce,xAxisPx:he,rotation:ne?-1*pe:pe,skew:ne?-1*ze:ze,xTransformOrigin:ne?he:fe,yTransformOrigin:ce,caretCorners:ne?Fe:Ne};case PositionWithCaret.TOP_SIDE_END:return{yAlignment:strings$1.TOP,xAlignment:ne?strings$1.LEFT:strings$1.RIGHT,yAxisPx:he,xAxisPx:ce,rotation:ne?Oe:-1*Oe,skew:ne?-1*ze:ze,xTransformOrigin:ne?ce:re,yTransformOrigin:he,caretCorners:ne?Fe:Ne};case PositionWithCaret.CENTER_SIDE_END:return{yAlignment:strings$1.TOP,xAlignment:ne?strings$1.LEFT:strings$1.RIGHT,yAxisPx:le,xAxisPx:ce,rotation:ne?Oe:-1*Oe,skew:ne?-1*ze:ze,xTransformOrigin:ne?ce:re,yTransformOrigin:le,caretCorners:ne?Fe:Ne};case PositionWithCaret.BOTTOM_SIDE_END:return{yAlignment:strings$1.BOTTOM,xAlignment:ne?strings$1.LEFT:strings$1.RIGHT,yAxisPx:he,xAxisPx:ce,rotation:ne?-1*Oe:Oe,skew:ne?ze:-1*ze,xTransformOrigin:ne?ce:re,yTransformOrigin:Ae,caretCorners:ne?Ne:Fe};case PositionWithCaret.TOP_SIDE_START:return{yAlignment:strings$1.TOP,xAlignment:ne?strings$1.RIGHT:strings$1.LEFT,yAxisPx:he,xAxisPx:ce,rotation:ne?-1*Oe:Oe,skew:ne?ze:-1*ze,xTransformOrigin:ne?re:ce,yTransformOrigin:he,caretCorners:ne?Ne:Fe};case PositionWithCaret.CENTER_SIDE_START:return{yAlignment:strings$1.TOP,xAlignment:ne?strings$1.RIGHT:strings$1.LEFT,yAxisPx:le,xAxisPx:ce,rotation:ne?-1*Oe:Oe,skew:ne?ze:-1*ze,xTransformOrigin:ne?re:ce,yTransformOrigin:le,caretCorners:ne?Ne:Fe};case PositionWithCaret.BOTTOM_SIDE_START:return{yAlignment:strings$1.BOTTOM,xAlignment:ne?strings$1.RIGHT:strings$1.LEFT,yAxisPx:he,xAxisPx:ce,rotation:ne?Oe:-1*Oe,skew:ne?-1*ze:ze,xTransformOrigin:ne?re:ce,yTransformOrigin:Ae,caretCorners:ne?Fe:Ne};case PositionWithCaret.ABOVE_CENTER:return{yAlignment:strings$1.BOTTOM,xAlignment:strings$1.LEFT,yAxisPx:ce,xAxisPx:ae,rotation:pe,skew:ze,xTransformOrigin:ae,yTransformOrigin:se,caretCorners:Ne};case PositionWithCaret.ABOVE_END:return{yAlignment:strings$1.BOTTOM,xAlignment:ne?strings$1.RIGHT:strings$1.LEFT,yAxisPx:ce,xAxisPx:he,rotation:ne?-1*pe:pe,skew:ne?-1*ze:ze,xTransformOrigin:ne?fe:he,yTransformOrigin:se,caretCorners:ne?Fe:Ne};default:case PositionWithCaret.ABOVE_START:return{yAlignment:strings$1.BOTTOM,xAlignment:ne?strings$1.LEFT:strings$1.RIGHT,yAxisPx:ce,xAxisPx:he,rotation:ne?pe:-1*pe,skew:ne?ze:-1*ze,xTransformOrigin:ne?he:fe,yTransformOrigin:se,caretCorners:ne?Ne:Fe}}}clearShowTimeout(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}clearHideTimeout(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}attachScrollHandler(te){this.addAncestorScrollEventListeners.push(()=>{te("scroll",this.windowScrollHandler)})}removeScrollHandler(te){this.removeAncestorScrollEventListeners.push(()=>{te("scroll",this.windowScrollHandler)})}destroy(){this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=null),this.clearHideTimeout(),this.clearShowTimeout(),this.adapter.removeClass(SHOWN),this.adapter.removeClass(SHOWING_TRANSITION),this.adapter.removeClass(SHOWING),this.adapter.removeClass(HIDE),this.adapter.removeClass(HIDE_TRANSITION),this.richTooltip&&this.adapter.deregisterEventHandler("focusout",this.richTooltipFocusOutHandler),this.persistentTooltip||(this.adapter.deregisterEventHandler("mouseenter",this.tooltipMouseEnterHandler),this.adapter.deregisterEventHandler("mouseleave",this.tooltipMouseLeaveHandler)),this.adapter.deregisterAnchorEventHandler("blur",this.anchorBlurHandler),this.adapter.deregisterDocumentEventHandler("click",this.documentClickHandler),this.adapter.deregisterDocumentEventHandler("keydown",this.documentKeydownHandler),this.adapter.deregisterWindowEventHandler("scroll",this.windowScrollHandler),this.adapter.deregisterWindowEventHandler("resize",this.windowResizeHandler);for(const te of this.removeAncestorScrollEventListeners)te();this.animFrame.cancelAll()}}let counter$1=0;const isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints>0;var root$s=from_html("<div><div><!></div></div>");function Tooltip(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(rr,"$anchor",ee);let se=prop(te,"use",19,()=>[]),ae=prop(te,"class",3,""),le=prop(te,"style",3,""),ce=prop(te,"id",19,()=>"SMUI-tooltip-"+counter$1++),he=prop(te,"unbounded",3,!1),fe=prop(te,"xPos",3,"detected"),Ae=prop(te,"yPos",3,"detected"),pe=prop(te,"persistent",3,!1),Oe=prop(te,"interactive",19,pe),Fe=prop(te,"hideFromScreenreader",3,!1),Ne=prop(te,"showDelay",3,void 0),ze=prop(te,"hideDelay",3,void 0),He=prop(te,"surface$class",3,""),We=prop(te,"surface$style",3,""),je=prop(te,"triggerByAnchorFocus",3,!1),Ue=prop(te,"supportTouchDevice",3,!1),Ge=rest_props(te,["$$slots","$$events","$$legacy","use","class","style","id","unbounded","xPos","yPos","persistent","interactive","hideFromScreenreader","showDelay","hideDelay","surface$class","surface$style","children","triggerByAnchorFocus","supportTouchDevice"]),Ze,Ye=state(void 0),qe=new SvelteEventManager,nr={},ir=proxy({}),tr=proxy({}),or=proxy({}),Jt=proxy({}),rr=getContext("SMUI:tooltip:wrapper:anchor"),lr=getContext("SMUI:tooltip:wrapper:tooltip");const ur=getContext("SMUI:tooltip:rich"),Sr=isTouchDevice?Ue():!0,xr=user_derived(()=>({role:ur&&Oe()?"dialog":"tooltip",tabindex:ur&&pe()?-1:void 0}));let Pr;user_effect(()=>{get$2(Ye)&&Pr!==re()&&(Pr&&mr(Pr),re()&&Er(re()),Pr=re())}),user_effect(()=>{get$2(Ye)&&get$2(Ye).setAnchorBoundaryType(AnchorBoundaryType[he()?"UNBOUNDED":"BOUNDED"])}),user_effect(()=>{get$2(Ye)&&get$2(Ye).setTooltipPosition({xPos:XPosition[fe().toUpperCase()],yPos:YPosition[Ae().toUpperCase()]})}),user_effect(()=>{get$2(Ye)&&Ne()!=null&&get$2(Ye).setShowDelay(Ne())}),user_effect(()=>{get$2(Ye)&&ze()!=null&&get$2(Ye).setHideDelay(ze())}),onMount(()=>(set(Ye,new MDCTooltipFoundation({getAttribute:wr,setAttribute:Dr,removeAttribute:Ur,addClass:Cr,hasClass:dr,removeClass:Or,getComputedStyleProperty:er=>{const Tr=Vr();let to=getComputedStyle(Tr).getPropertyValue(er);return to==="auto"&&(Tr.classList.add("smui-banner--force-show"),to=getComputedStyle(Tr).getPropertyValue(er),Tr.classList.remove("smui-banner--force-show")),to},setStyleProperty:Ar,setSurfaceAnimationStyleProperty:Ir,getViewportWidth:()=>window.innerWidth,getViewportHeight:()=>window.innerHeight,getTooltipSize:()=>{const er=Vr();let Tr={width:er.offsetWidth,height:er.offsetHeight};return(Tr.width===0||Tr.height===0)&&(er.classList.add("smui-banner--force-show"),Tr={width:er.offsetWidth,height:er.offsetHeight},er.classList.remove("smui-banner--force-show")),Tr},getAnchorBoundingRect:()=>re()?re().getBoundingClientRect():null,getParentBoundingRect:()=>{let er=Vr().parentElement;return ur||(er=document.body),(er==null?void 0:er.getBoundingClientRect())||null},getAnchorAttribute:er=>re()?re().getAttribute(er):null,setAnchorAttribute:(er,Tr)=>{re()&&re().setAttribute(er,Tr)},isRTL:()=>getComputedStyle(Vr()).direction==="rtl",anchorContainsElement:er=>!!(re()&&re().contains(er)),tooltipContainsElement:er=>Vr().contains(er),focusAnchorElement:()=>{re()&&re().focus()},registerEventHandler:(er,Tr)=>qe.on(Vr(),er,Tr),deregisterEventHandler:(er,Tr)=>qe.off(Vr(),er,Tr),registerAnchorEventHandler:(er,Tr)=>re()&&qe.on(re(),er,Tr),deregisterAnchorEventHandler:(er,Tr)=>re()&&qe.off(re(),er,Tr),registerDocumentEventHandler:(er,Tr)=>qe.on(document.body,er,Tr),deregisterDocumentEventHandler:(er,Tr)=>qe.off(document.body,er,Tr),registerWindowEventHandler:(er,Tr)=>qe.on(window,er,Tr,er==="scroll"&&{capture:!0,passive:!0}||void 0),deregisterWindowEventHandler:(er,Tr)=>qe.off(window,er,Tr),notifyHidden:()=>{dispatch(Vr(),"SMUITooltipHidden")},getTooltipCaretBoundingRect:()=>{const er=Vr().querySelector(`.${CssClasses.TOOLTIP_CARET_TOP}`);return er?er.getBoundingClientRect():null},setTooltipCaretStyle:(er,Tr)=>{const to=Vr().querySelector(`.${CssClasses.TOOLTIP_CARET_TOP}`),Fo=Vr().querySelector(`.${CssClasses.TOOLTIP_CARET_BOTTOM}`);!to||!Fo||(to.style.setProperty(er,Tr),Fo.style.setProperty(er,Tr))},clearTooltipCaretStyles:()=>{const er=Vr().querySelector(`.${CssClasses.TOOLTIP_CARET_TOP}`),Tr=Vr().querySelector(`.${CssClasses.TOOLTIP_CARET_BOTTOM}`);!er||!Tr||(er.removeAttribute("style"),Tr.removeAttribute("style"))},getActiveElement:()=>document.activeElement}),!0),store_set(lr,Ze),()=>{re()&&mr(re()),qe.clear()})),onDestroy(()=>{var er,Tr,to,Fo,Sa,Ja;!ur&&typeof document<"u"&&document.body===((er=Vr())==null?void 0:er.parentElement)&&nr.parent!==((Tr=Vr())==null?void 0:Tr.parentElement)&&((to=nr.parent)!=null&&to.isConnected)&&((Fo=nr.parent)!=null&&Fo.insertBefore)&&nr.nextSibling&&((Sa=nr.parent)==null||Sa.insertBefore(Vr(),nr.nextSibling)),document.body===((Ja=Vr())==null?void 0:Ja.parentElement)&&Vr().remove(),Ze=null,set(Ye,null)});function mr(er){var Tr;Sr&&(qe.off(er,"focusout",zr),ur&&pe()?(qe.off(er,"click",Fr),qe.off(er,"keydown",Fr)):(qe.off(er,"mouseenter",Jr),qe.off(er,"focusin",po),qe.off(er,"mouseleave",so),qe.off(er,"touchstart",ho),qe.off(er,"touchend",Lo)),ur&&Oe()?(er.removeAttribute("aria-haspopup"),er.removeAttribute("aria-expanded"),er.removeAttribute("data-tooltip-id")):er.removeAttribute("aria-describedby"),(Tr=get$2(Ye))==null||Tr.destroy())}function Er(er){var Tr;Sr&&(je()&&qe.on(er,"focusout",zr),ur&&pe()?(qe.on(er,"click",Fr),qe.on(er,"keydown",Fr)):(qe.on(er,"mouseenter",Jr),je()&&qe.on(er,"focusin",po),qe.on(er,"mouseleave",so),qe.on(er,"touchstart",ho),qe.on(er,"touchend",Lo)),ur&&Oe()?(er.setAttribute("aria-haspopup","dialog"),er.setAttribute("aria-expanded","false"),er.setAttribute("data-tooltip-id",ce())):er.setAttribute("aria-describedby",ce()),ur||bo(),(Tr=get$2(Ye))==null||Tr.init())}function dr(er){return er in ir?ir[er]:Vr().classList.contains(er)}function Cr(er){ir[er]||(ir[er]=!0)}function Or(er){(!(er in ir)||ir[er])&&(ir[er]=!1)}function Ar(er,Tr){tr[er]!=Tr&&(Tr===""||Tr==null?delete tr[er]:tr[er]=Tr)}function Ir(er,Tr){Jt[er]!=Tr&&(Tr===""||Tr==null?delete Jt[er]:Jt[er]=Tr)}function wr(er){return er in or?or[er]??null:Vr().getAttribute(er)}function Dr(er,Tr){or[er]!==Tr&&(or[er]=Tr)}function Ur(er){(!(er in or)||or[er]!=null)&&(or[er]=void 0)}function zr(er){Vr().contains(er.relatedTarget)||get$2(Ye)&&get$2(Ye).hide()}function Fr(er){er.type==="keydown"&&er.key!=="Enter"&&er.key!==" "||get$2(Ye)&&get$2(Ye).handleAnchorClick()}function Jr(){get$2(Ye)&&get$2(Ye).handleAnchorMouseEnter()}function po(er){get$2(Ye)&&get$2(Ye).handleAnchorFocus(er)}function so(){get$2(Ye)&&get$2(Ye).handleAnchorMouseLeave()}function ho(){get$2(Ye)&&get$2(Ye).handleAnchorTouchstart()}function Lo(){get$2(Ye)&&get$2(Ye).handleAnchorTouchend()}function bo(){re()&&document.body!==Vr().parentNode&&(nr.parent=Vr().parentElement??void 0,nr.nextSibling=Vr().nextElementSibling??void 0,document.body.appendChild(Vr()))}function Uo(er){get$2(Ye)&&get$2(Ye).attachScrollHandler(er)}function Br(er){get$2(Ye)&&get$2(Ye).removeScrollHandler(er)}function Vr(){return Ze}function Yr(){return get$2(Ye)}var Zr=root$s(),uo=er=>{var Tr;get$2(Ye)&&get$2(Ye).handleTransitionEnd(),(Tr=te.ontransitionend)==null||Tr.call(te,er)};attribute_effect(Zr,(er,Tr,to)=>({class:er,style:Tr,"aria-hidden":"true",id:ce(),"data-mdc-tooltip-persistent":pe()?"true":void 0,"data-mdc-tooltip-has-caret":void 0,"data-hide-tooltip-from-screenreader":Fe()?"true":void 0,...get$2(xr),...or,...to,ontransitionend:uo}),[()=>classMap({[ae()]:!0,"cl-tooltip":!0,"mdc-tooltip":!0,"mdc-tooltip--rich":ur,...ir}),()=>Object.entries(tr).map(([er,Tr])=>`${er}: ${Tr};`).concat([le()]).join(" "),()=>exclude(Ge,["surface$"])]);var ro=child(Zr);attribute_effect(ro,(er,Tr,to)=>({class:er,style:Tr,...to}),[()=>classMap({[He()]:!0,"mdc-tooltip__surface":!0,"mdc-tooltip__surface-animation":!0}),()=>Object.entries(Jt).map(([er,Tr])=>`${er}: ${Tr};`).concat([We()]).join(" "),()=>prefixFilter(Ge,"surface$")]);var Rr=child(ro);snippet(Rr,()=>te.children??noop$1),bind_this(Zr,er=>Ze=er,()=>Ze),action(Zr,(er,Tr)=>useActions==null?void 0:useActions(er,Tr),se),append(ie,Zr);var fr=pop({attachScrollHandler:Uo,removeScrollHandler:Br,getElement:Vr,getInstance:Yr});return ne(),fr}var root_1$r=from_html("<div><!></div>");function Wrapper(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(pe,"$tooltip",ee),se=()=>store_get(Ae,"$anchor",ee);let ae=prop(te,"use",19,()=>[]),le=prop(te,"class",3,""),ce=prop(te,"rich",3,!1),he=rest_props(te,["$$slots","$$events","$$legacy","use","class","rich","children"]),fe;const Ae=writable(void 0),pe=writable(void 0);setContext("SMUI:tooltip:wrapper:anchor",Ae),setContext("SMUI:tooltip:wrapper:tooltip",pe),setContext("SMUI:tooltip:rich",ce()),user_effect(()=>{re()&&!se()&&store_set(Ae,re().previousElementSibling)});function Oe(){return fe}onDestroy(()=>{fe=null});var Fe=comment(),Ne=first_child(Fe);{var ze=je=>{var Ue=root_1$r();attribute_effect(Ue,Ze=>({class:Ze,...he}),[()=>classMap({[le()]:!0,"mdc-tooltip-wrapper--rich":!0})]);var Ge=child(Ue);snippet(Ge,()=>te.children??noop$1),bind_this(Ue,Ze=>fe=Ze,()=>fe),action(Ue,(Ze,Ye)=>useActions==null?void 0:useActions(Ze,Ye),ae),append(je,Ue)},He=je=>{var Ue=comment(),Ge=first_child(Ue);snippet(Ge,()=>te.children??noop$1),append(je,Ue)};if_block(Ne,je=>{ce()?je(ze):je(He,!1)})}append(ie,Fe);var We=pop({getElement:Oe});return ne(),We}function portal$1(ie,te="body"){let ee;async function ne(se){if(te=se,typeof te=="string"){if(ee=document.querySelector(te),ee===null&&(await tick(),ee=document.querySelector(te)),ee===null)throw new Error(`No element found matching css selector: "${te}"`)}else if(te instanceof HTMLElement)ee=te;else throw new TypeError(`Unknown portal target type: ${te===null?"null":typeof te}. Allowed types: string (CSS selector) or HTMLElement.`);ee.appendChild(ie),ie.hidden=!1}function re(){ie.parentNode&&ie.parentNode.removeChild(ie)}return ne(te),{update:ne,destroy:re}}var root$r=from_html("<div hidden><!></div>");function Portal$1(ie,te){push(te,!1);let ee=prop(te,"target",8,"body"),ne=prop(te,"style",8,"");init$1();var re=root$r(),se=child(re);slot(se,te,"default",{}),action(re,(ae,le)=>portal$1==null?void 0:portal$1(ae,le),ee),template_effect(()=>set_style(re,ne())),append(ie,re),pop()}const hoverColors={light:"#F5F5F5",dark:"#212121"};var root_3$i=from_html('<div class="tipContent svelte-1n4b3vy"> </div>'),root_2$h=from_html('<button class="button svelte-1n4b3vy"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="24" height="24" fill="currentColor"><path fill-rule="evenodd" d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path><path fill-rule="evenodd" d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z"></path></svg></button> <!>',1),root_8$2=from_svg('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M22 9.06 11 20 6 14.7l1.09-1.02 3.94 4.16L20.94 8 22 9.06Z"></path></svg>'),root_7$3=from_html('<div class="icon svelte-1n4b3vy"><!></div> <div class="content svelte-1n4b3vy"><span> </span> <span class="kb svelte-1n4b3vy"> </span></div>',1),root_4$b=from_html('<div class="axisMenu svelte-1n4b3vy"><!></div>'),root_1$q=from_html('<div class="settingPortal svelte-1n4b3vy"><!> <div class="anchor svelte-1n4b3vy"><!></div></div>');function AxisSetting(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(Oe,"$tooltipContent",ee),se=()=>store_get(fe,"$priceScaleOptions",ee),ae=useService(IThemeService),{t:le}=useTranslation(),ce=useService(IChartManagementService),he=ce.chart(te.chartIndex),fe=derived(ce.store,Ze=>Ze.instances[te.chartIndex].chartOptions.rightPriceScale),Ae=he.getContainerDomElement(),pe=ensure(Ae.querySelector("tr:last-of-type td:last-of-type"));Object.assign(pe.style,{position:"relative"});const Oe=derivedWithCache(he.getStore(),Ze=>{const{symbolInfo:Ye}=Ze;return`${Ye.name}·${Ye.exchange}·${Ze.resolution}`}),Fe=()=>{he.showPaneCursor(PaneCursor.arrow),he.chart.applyOptions({rightPriceScale:{background:{type:Ai.Solid,color:ae.isDark()?hoverColors.dark:hoverColors.light}}})},Ne=()=>{he.showPaneCursor(PaneCursor.unset),he.chart.applyOptions({rightPriceScale:{background:ae.isDark()?cloneDeep(chartConfigDark.rightPriceScale.background):cloneDeep(chartConfigLight.rightPriceScale.background)}})},ze=[{label:"priceAxis.mode.regular",value:pi.Normal},{label:"priceAxis.mode.percent",value:pi.Percentage,kb:kbPercent},{label:"priceAxis.mode.log",value:pi.Logarithmic,kb:kbLog}],He=()=>{je.setOpen(!0)},We=Ze=>{he.chart.applyOptions({rightPriceScale:{mode:get$1(fe).mode===Ze.value?pi.Normal:Ze.value}})};let je,Ue,Ge;onMount(()=>{PartFingerprints.write(Ue,PartFingerprint.AxisSetting),PartFingerprints.write(Ge,PartFingerprint.AxisSetting)}),onDestroy(()=>{Ue=null,je=null,Ge=null}),Portal$1(ie,{get target(){return pe},style:"position: absolute;top: 0;left: 0;right: 0;bottom: 0;z-index: 2;",children:(Ze,Ye)=>{var qe=root_1$q(),nr=child(qe);Wrapper(nr,{children:(or,Jt)=>{var rr=root_2$h(),lr=first_child(rr);lr.__pointerup=He,bind_this(lr,Sr=>Ue=Sr,()=>Ue);var ur=sibling(lr,2);Tooltip(ur,{yPos:"above",children:(Sr,xr)=>{var Pr=root_3$i(),mr=child(Pr);template_effect(()=>set_text(mr,re())),append(Sr,Pr)},$$slots:{default:!0}}),event("mouseenter",lr,Fe),event("mouseleave",lr,Ne),append(or,rr)},$$slots:{default:!0}});var ir=sibling(nr,2),tr=child(ir);bind_this(Menu(tr,{anchorCorner:"BOTTOM_RIGHT",quickOpen:!0,class:"cl-axis-setting-dropdown",children:(or,Jt)=>{var rr=root_4$b(),lr=child(rr);List(lr,{children:(ur,Sr)=>{var xr=comment(),Pr=first_child(xr);each(Pr,17,()=>ze,index,(mr,Er)=>{{let dr=user_derived(()=>get$2(Er).value===se().mode);Item(mr,{class:"row",get selected(){return get$2(dr)},onpointerup:()=>We(get$2(Er)),children:(Cr,Or)=>{var Ar=root_7$3(),Ir=first_child(Ar),wr=child(Ir);{var Dr=so=>{var ho=root_8$2();append(so,ho)};if_block(wr,so=>{get$2(Er).value===se().mode&&so(Dr)})}var Ur=sibling(Ir,2),zr=child(Ur),Fr=child(zr),Jr=sibling(zr,2),po=child(Jr);template_effect((so,ho)=>{set_text(Fr,so),set_text(po,ho)},[()=>le(get$2(Er).label),()=>get$2(Er).kb?getKeybindingLabel(get$2(Er).kb):""]),append(Cr,Ar)},$$slots:{default:!0}})}}),append(ur,xr)},$$slots:{default:!0}}),bind_this(rr,ur=>Ge=ur,()=>Ge),append(or,rr)},$$slots:{default:!0}}),or=>je=or,()=>je),append(Ze,qe)},$$slots:{default:!0}}),pop(),ne()}delegate(["pointerup"]);function useDisposable(ie){onDestroy(()=>ie.dispose())}var root_4$a=from_html('<div class="itemIcon svelte-9uavjd"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none" class="svelte-9uavjd"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M19.9792 16.6205C19.7396 16.8955 19.3241 16.9285 19.044 16.6948L14.3924 12.8117L14.072 12.5442L13.7516 12.8117L9.10009 16.6947C8.82008 16.9285 8.40456 16.8955 8.16495 16.6205C7.92467 16.3447 7.94981 15.9272 8.22144 15.6822L14.0721 10.4057L19.9227 15.6822C20.1943 15.9272 20.2195 16.3447 19.9792 16.6205ZM18.4032 17.4624C19.1009 18.0448 20.1362 17.9626 20.7332 17.2774C21.3318 16.5902 21.2692 15.55 20.5924 14.9396L14.407 9.36109L14.0721 9.05908L13.7373 9.36109L7.55171 14.9396C6.87492 15.55 6.81229 16.5902 7.41096 17.2774C8.00796 17.9626 9.04326 18.0448 9.74094 17.4624L14.072 13.8468L18.4032 17.4624Z" class="svelte-9uavjd"></path></svg></div> <div class="itemLabel svelte-9uavjd"> </div>',1),root_5$b=from_html('<div class="itemIcon svelte-9uavjd"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none" class="svelte-9uavjd"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M19.9792 12.2892C19.7396 12.0142 19.3241 11.9812 19.044 12.2149L14.3924 16.098L14.072 16.3655L13.7516 16.098L9.10009 12.2149C8.82008 11.9812 8.40456 12.0142 8.16495 12.2892C7.92467 12.565 7.94981 12.9825 8.22144 13.2275L14.0721 18.504L19.9227 13.2275C20.1943 12.9825 20.2195 12.565 19.9792 12.2892ZM18.4032 11.4472C19.1009 10.8648 20.1362 10.9471 20.7332 11.6323C21.3318 12.3195 21.2692 13.3597 20.5924 13.9701L14.407 19.5486L14.0721 19.8506L13.7373 19.5486L7.55171 13.9701C6.87492 13.3597 6.81229 12.3195 7.41096 11.6323C8.00796 10.9471 9.04326 10.8648 9.74094 11.4473L14.072 15.0628L18.4032 11.4472Z" class="svelte-9uavjd"></path></svg></div> <div class="itemLabel svelte-9uavjd"> </div>',1),root_6$6=from_html('<div class="itemIcon svelte-9uavjd"></div> <div class="itemLabel svelte-9uavjd"> </div> <div class="itemKeybinding svelte-9uavjd"> </div>',1),root_7$2=from_html('<div class="itemIcon svelte-9uavjd"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor" class="svelte-9uavjd"><path fill-rule="evenodd" d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" class="svelte-9uavjd"></path><path fill-rule="evenodd" d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z" class="svelte-9uavjd"></path></svg></div> <div class="itemLabel svelte-9uavjd"> </div>',1),root_3$h=from_html('<!> <!> <!> <div class="separator svelte-9uavjd"></div> <!> <div class="separator svelte-9uavjd"></div>',1),root_8$1=from_html('<div class="itemIcon svelte-9uavjd"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" class="svelte-9uavjd"><g fill="currentColor" fill-rule="nonzero" class="svelte-9uavjd"><path d="M4 15h8.5v-1h-8.5zM16.5 15h8.5v-1h-8.5z" class="svelte-9uavjd"></path><path d="M14.5 16c.828 0 1.5-.672 1.5-1.5s-.672-1.5-1.5-1.5-1.5.672-1.5 1.5.672 1.5 1.5 1.5zm0 1c-1.381 0-2.5-1.119-2.5-2.5s1.119-2.5 2.5-2.5 2.5 1.119 2.5 2.5-1.119 2.5-2.5 2.5z" class="svelte-9uavjd"></path></g></svg></div> <div class="itemLabel svelte-9uavjd"> </div> <div class="itemKeybinding svelte-9uavjd"> </div>',1),root_2$g=from_html("<!> <!>",1),root_1$p=from_html('<div class="menu svelte-9uavjd"><!></div>'),root$q=from_html('<div class="anchor svelte-9uavjd"><!></div>');function CrosshairButtonMenu(ie,te){push(te,!0);const ee=useService(IChartManagementService),{t:ne}=useTranslation(),re=useService(IChartGuiService),se=useService(ITradeService),ae=useService(ICommandService);let le=state(-1),ce=state(0);useDisposable(re.onCrosshairButtonMenuRequested(async Ue=>{set(le,Ue.priceVal,!0),set(ce,Ue.paneIndex,!0);const Ge=he.getElement().parentElement;should(Ge);const{anchor:Ze}=Ue;Object.assign(pe,{left:toPX(Ze.x),top:toPX(Ze.y),width:toPX(Ze.width),height:toPX(Ze.height)}),Object.assign(Oe,{symbol:Ue.symbol,price:Ue.price,bid:Ue.bid,ask:Ue.ask}),await wait(20),he.setOpen(!0)}));let he;const fe=KeyCode.KeyT|KeyMod.Shift,Ae=KeyCode.KeyH|KeyMod.Alt;let pe=proxy({top:"",left:"",width:"",height:""}),Oe=proxy({symbol:"",bid:"",ask:"",price:""});const Fe=()=>{se.showOrderDialog({symbol:Oe.symbol,side:Side.Buy,type:OrderType.Limit,qty:1,price:parseFloat(Oe.price)})},Ne=()=>{se.showOrderDialog({symbol:Oe.symbol,side:Side.Sell,type:OrderType.Stop,qty:1,price:parseFloat(Oe.price)})},ze=()=>{se.showOrderDialog({symbol:Oe.symbol,side:Side.Buy,type:OrderType.Market,qty:99999})},He=()=>{ae.executeCommand("tool.line.horizontalLine",ee.chart(te.chartIndex),get$2(ce),{points:[{price:get$2(le)}]})};onDestroy(()=>{he=null});var We=root$q(),je=child(We);bind_this(Menu(je,{anchorCorner:"BOTTOM_RIGHT",quickOpen:!0,children:(Ue,Ge)=>{var Ze=root_1$p(),Ye=child(Ze);List(Ye,{children:(qe,nr)=>{var ir=root_2$g(),tr=first_child(ir);{var or=rr=>{var lr=root_3$h(),ur=first_child(lr);Item(ur,{tag:"div",class:"item",onpointerup:Fe,children:(mr,Er)=>{var dr=root_4$a(),Cr=sibling(first_child(dr),2),Or=child(Cr);template_effect(Ar=>set_text(Or,Ar),[()=>ne("crosshairMenu.buyLimit",Oe)]),append(mr,dr)},$$slots:{default:!0}});var Sr=sibling(ur,2);Item(Sr,{tag:"div",class:"item",onpointerup:Ne,children:(mr,Er)=>{var dr=root_5$b(),Cr=sibling(first_child(dr),2),Or=child(Cr);template_effect(Ar=>set_text(Or,Ar),[()=>ne("crosshairMenu.sellStop",Oe)]),append(mr,dr)},$$slots:{default:!0}});var xr=sibling(Sr,2);Item(xr,{tag:"div",class:"item",onpointerup:ze,children:(mr,Er)=>{var dr=root_6$6(),Cr=sibling(first_child(dr),2),Or=child(Cr),Ar=sibling(Cr,2),Ir=child(Ar);template_effect((wr,Dr)=>{set_text(Or,wr),set_text(Ir,Dr)},[()=>ne("crosshairMenu.newOrder"),()=>getKeybindingLabel(fe)]),append(mr,dr)},$$slots:{default:!0}});var Pr=sibling(xr,4);Item(Pr,{tag:"div",class:"item",children:(mr,Er)=>{var dr=root_7$2(),Cr=sibling(first_child(dr),2),Or=child(Cr);template_effect(Ar=>set_text(Or,Ar),[()=>ne("crosshairMenu.settings")]),append(mr,dr)},$$slots:{default:!0}}),append(rr,lr)};if_block(tr,rr=>{Oe.symbol&&rr(or)})}var Jt=sibling(tr,2);Item(Jt,{tag:"div",class:"item",onpointerup:He,children:(rr,lr)=>{var ur=root_8$1(),Sr=sibling(first_child(ur),2),xr=child(Sr),Pr=sibling(Sr,2),mr=child(Pr);template_effect((Er,dr)=>{set_text(xr,Er),set_text(mr,dr)},[()=>ne("crosshairMenu.draw",Oe),()=>getKeybindingLabel(Ae)]),append(rr,ur)},$$slots:{default:!0}}),append(qe,ir)},$$slots:{default:!0}}),append(Ue,Ze)},$$slots:{default:!0}}),Ue=>he=Ue,()=>he),template_effect(Ue=>set_style(We,Ue),[()=>Object.entries(pe).map(([Ue,Ge])=>`${Ue}: ${Ge};`).join(" ")]),append(ie,We),pop()}function CustomComponents$1(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ae,"$components",ee),se=useService(IChartGuiService),ae=derived(se.store,he=>he.components);init$1();var le=comment(),ce=first_child(le);each(ce,1,re,he=>he.id,(he,fe)=>{get$2(fe).Component(he,spread_props(()=>get$2(fe).props))}),append(ie,le),pop(),ne()}var root$p=from_html('<div class="loader svelte-nbyf0j"><span class="item svelte-nbyf0j"></span> <span class="item svelte-nbyf0j"></span> <span class="item svelte-nbyf0j"></span></div>');function Loader(ie){var te=root$p();append(ie,te)}var root_2$f=from_html('<div class="valueItem svelte-1jf9nq0"><span> </span></div>'),root_1$o=from_html('<div class="values svelte-1jf9nq0"></div>');function StudySeriesValues(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(le,"$values",ee),se=useService(IChartManagementService),ae=se.chart(te.chartIndex).getStudyById(te.studyId).getStyleValues(),le=derived(se.store,pe=>pe.instances[te.chartIndex].studyLegend[te.studyId]),ce=pe=>{var Oe;return(Oe=ae.styles[pe])==null?void 0:Oe.color};var he=comment(),fe=first_child(he);{var Ae=pe=>{var Oe=root_1$o();each(Oe,5,()=>toPairs(re()),Fe=>Fe[0],(Fe,Ne)=>{var ze=root_2$f(),He=child(ze);let We;var je=child(He);template_effect(Ue=>{We=set_style(He,"",We,Ue),set_text(je,get$2(Ne)[1])},[()=>({color:ce(get$2(Ne)[0])})]),append(Fe,ze)}),append(pe,Oe)};if_block(fe,pe=>{re()&&pe(Ae)})}append(ie,he),pop(),ne()}async function removeStudy(ie,te,ee,ne){te.removeEntity(ne.studyId)}var root_1$n=from_html('<button class="button svelte-12xlpiv"><span class="svelte-12xlpiv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M7.5 4a.5.5 0 0 0-.5.5V5h4v-.5a.5.5 0 0 0-.5-.5h-3ZM12 5h3v1h-1.05l-.85 7.67A1.5 1.5 0 0 1 11.6 15H6.4a1.5 1.5 0 0 1-1.5-1.33L4.05 6H3V5h3v-.5C6 3.67 6.67 3 7.5 3h3c.83 0 1.5.67 1.5 1.5V5ZM5.06 6l.84 7.56a.5.5 0 0 0 .5.44h5.2a.5.5 0 0 0 .5-.44L12.94 6H5.06Z"></path></svg></span></button> <!>',1),root_3$g=from_html('<button class="button svelte-12xlpiv"><span class="svelte-12xlpiv"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6-1a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm7-2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"></path></svg></span></button> <!>',1),root$o=from_html('<div class="legendWrapper svelte-12xlpiv"><div class="series svelte-12xlpiv"><div><div class="texts svelte-12xlpiv"> </div> <div class="inputs svelte-12xlpiv"> </div> <div><!> <!></div></div> <div class="valueWrapper svelte-12xlpiv"><!></div></div></div>');function StudySeriesLegend(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(Ae,"$title",ee),se=()=>store_get(pe,"$inputs",ee),ae=()=>store_get(Oe,"$isWaitingData",ee),le=rest_props(te,["$$slots","$$events","$$legacy"]),{t:ce}=useTranslation(),he=useService(IChartManagementService),fe=he.chart(te.chartIndex),Ae=derived(he.store,rr=>{const lr=rr.instances[fe.index].studyList.find(ur=>ur.id===te.studyId);return lr?lr.title:""}),pe=derived(he.store,rr=>{const lr=rr.instances[fe.index].studyList.find(ur=>ur.id===te.studyId);return!lr||!lr.inputs?"":Object.values(lr.inputs).join(" ")}),Oe=derived(he.store,rr=>{var lr;return((lr=rr.instances[te.chartIndex])==null?void 0:lr.dataStatus)!==ChartDataStatus.dataLoaded});let Fe=state(!1),Ne=0;var ze=root$o(),He=child(ze),We=child(He),je=child(We),Ue=child(je),Ge=sibling(je,2),Ze=child(Ge),Ye=sibling(Ge,2),qe=child(Ye);Wrapper(qe,{children:(rr,lr)=>{var ur=root_1$n(),Sr=first_child(ur);Sr.__pointerup=[removeStudy,fe,le,te];var xr=sibling(Sr,2);Tooltip(xr,{showDelay:600,children:(Pr,mr)=>{var Er=text();template_effect(dr=>set_text(Er,dr),[()=>ce("legend.remove")]),append(Pr,Er)},$$slots:{default:!0}}),append(rr,ur)},$$slots:{default:!0}});var nr=sibling(qe,2);Wrapper(nr,{children:(rr,lr)=>{var ur=root_3$g(),Sr=sibling(first_child(ur),2);Tooltip(Sr,{showDelay:600,children:(xr,Pr)=>{var mr=text();template_effect(Er=>set_text(mr,Er),[()=>ce("legend.more")]),append(xr,mr)},$$slots:{default:!0}}),append(rr,ur)},$$slots:{default:!0}});var ir=sibling(We,2),tr=child(ir);{var or=rr=>{Loader(rr)},Jt=rr=>{StudySeriesValues(rr,{get chartIndex(){return te.chartIndex},get studyId(){return te.studyId}})};if_block(tr,rr=>{ae()?rr(or):rr(Jt,!1)})}template_effect((rr,lr)=>{set_class(We,1,rr,"svelte-12xlpiv"),set_text(Ue,re()),set_text(Ze,se()),set_class(Ye,1,lr,"svelte-12xlpiv")},[()=>clsx(clsx$1("display",get$2(Fe)&&"display--hover")),()=>clsx(clsx$1("buttons",get$2(Fe)&&"buttons--hover"))]),event("mouseenter",We,()=>{set(Fe,!0),Ne&&(clearTimeout(Ne),Ne=0)}),event("mouseleave",We,()=>{Ne=setTimeout(()=>{set(Fe,!1),Ne=0},150)}),append(ie,ze),pop(),ne()}delegate(["pointerup"]);var root_1$m=from_html('<div class="auxPanePortal svelte-17pfq9"><!></div>');function AuxPanePortal(ie,te){push(te,!0);const ee=rest_props(te,["$$slots","$$events","$$legacy"]),ne=useService(IChartManagementService);let re;const le=ne.chart(te.chartIndex).getStudyById(te.studyId).paneHTMLElement();le.style.position="relative";const ce=document.createElement("div");le.appendChild(ce),re=ce,re.id=ee.studyId,onMount(()=>{PartFingerprints.write(re,PartFingerprint.Legend)}),onDestroy(()=>{re.remove()}),Portal$1(ie,{get target(){return re},children:(he,fe)=>{var Ae=root_1$m(),pe=child(Ae);StudySeriesLegend(pe,{get chartIndex(){return te.chartIndex},get studyId(){return te.studyId}}),append(he,Ae)},$$slots:{default:!0}}),pop()}var root_2$e=from_html('<div class="valueItem svelte-ir8sbd"><span class="key svelte-ir8sbd"> </span> <span> </span></div> <div class="valueItem svelte-ir8sbd"><span class="key svelte-ir8sbd"> </span> <span> </span></div> <div class="valueItem svelte-ir8sbd"><span class="key svelte-ir8sbd"> </span> <span> </span></div> <div class="valueItem svelte-ir8sbd"><span class="key svelte-ir8sbd"> </span> <span> </span></div>',1),root_4$9=from_html('<div class="valueItem svelte-ir8sbd"><span> </span></div>'),root_1$l=from_html('<div class="values svelte-ir8sbd"><!> <span> </span></div>');function MainSeriesValues(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(ce,"$values",ee),se=()=>store_get(he,"$isOhlc",ee),{t:ae}=useTranslation(),le=useService(IChartManagementService),ce=derived(le.store,Oe=>{var Fe;return(Fe=Oe.instances[te.chartIndex])==null?void 0:Fe.mainLegend}),he=derived(le.store,Oe=>{var Ne;const Fe=(Ne=Oe.instances[te.chartIndex])==null?void 0:Ne.chartProperties["mainSeriesProperties.style"];return!!Fe&&isOhlcSeries(Fe)});var fe=comment(),Ae=first_child(fe);{var pe=Oe=>{var Fe=root_1$l(),Ne=child(Fe);{var ze=Ge=>{var Ze=root_2$e(),Ye=first_child(Ze),qe=child(Ye),nr=child(qe),ir=sibling(qe,2);let tr;var or=child(ir),Jt=sibling(Ye,2),rr=child(Jt),lr=child(rr),ur=sibling(rr,2);let Sr;var xr=child(ur),Pr=sibling(Jt,2),mr=child(Pr),Er=child(mr),dr=sibling(mr,2);let Cr;var Or=child(dr),Ar=sibling(Pr,2),Ir=child(Ar),wr=child(Ir),Dr=sibling(Ir,2);let Ur;var zr=child(Dr);template_effect((Fr,Jr,po,so,ho,Lo,bo,Uo)=>{var Br,Vr,Yr,Zr;set_text(nr,Fr),tr=set_style(ir,"",tr,Jr),set_text(or,(Br=re())==null?void 0:Br.open),set_text(lr,po),Sr=set_style(ur,"",Sr,so),set_text(xr,(Vr=re())==null?void 0:Vr.high),set_text(Er,ho),Cr=set_style(dr,"",Cr,Lo),set_text(Or,(Yr=re())==null?void 0:Yr.low),set_text(wr,bo),Ur=set_style(Dr,"",Ur,Uo),set_text(zr,(Zr=re())==null?void 0:Zr.close)},[()=>ae("legend.main.open"),()=>{var Fr;return{color:(Fr=re())==null?void 0:Fr.color}},()=>ae("legend.main.high"),()=>{var Fr;return{color:(Fr=re())==null?void 0:Fr.color}},()=>ae("legend.main.low"),()=>{var Fr;return{color:(Fr=re())==null?void 0:Fr.color}},()=>ae("legend.main.close"),()=>{var Fr;return{color:(Fr=re())==null?void 0:Fr.color}}]),append(Ge,Ze)},He=Ge=>{var Ze=comment(),Ye=first_child(Ze);{var qe=nr=>{var ir=root_4$9(),tr=child(ir);let or;var Jt=child(tr);template_effect(rr=>{var lr;or=set_style(tr,"",or,rr),set_text(Jt,(lr=re())==null?void 0:lr.value)},[()=>{var rr;return{color:(rr=re())==null?void 0:rr.color}}]),append(nr,ir)};if_block(Ye,nr=>{re().value&&nr(qe)},!0)}append(Ge,Ze)};if_block(Ne,Ge=>{se()&&re().open?Ge(ze):Ge(He,!1)})}var We=sibling(Ne,2);let je;var Ue=child(We);template_effect(Ge=>{var Ze;je=set_style(We,"",je,Ge),set_text(Ue,(Ze=re())==null?void 0:Ze.change)},[()=>{var Ge;return{color:(Ge=re())==null?void 0:Ge.color}}]),append(Oe,Fe)};if_block(Ae,Oe=>{re()&&Oe(pe)})}append(ie,fe),pop(),ne()}var root_1$k=from_html('<button class="symbolBtn svelte-1svbifb"><span class="svelte-1svbifb"> </span></button> <!>',1),root_3$f=from_html('<button class="resolutionBtn svelte-1svbifb"><span class="svelte-1svbifb"> </span></button> <!>',1),root_5$a=from_html('<button class="more svelte-1svbifb"><span class="svelte-1svbifb"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" fill-rule="evenodd" d="M3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6-1a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 1a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm7-2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"></path></svg></span></button> <!>',1),root$n=from_html('<div class="legendWrapper svelte-1svbifb"><div class="series svelte-1svbifb"><div><div class="texts svelte-1svbifb"><div class="titleWrapper"><!></div> <div class="interval svelte-1svbifb"><!></div></div> <div><!></div></div> <div class="valueWrapper svelte-1svbifb"><!></div></div></div>');function MainSeriesLegend(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(Ae,"$isWaitingData",ee),se=()=>store_get(fe,"$symbolInfo",ee),ae=()=>store_get(pe,"$resolution",ee),{t:le}=useTranslation(),ce=useService(IChartManagementService),he=te.chartIndex,fe=derivedWithCache(ce.store,Jt=>{var rr;return(rr=Jt.instances[he])==null?void 0:rr.symbolInfo}),Ae=derived(ce.store,Jt=>{var rr;return((rr=Jt.instances[he])==null?void 0:rr.dataStatus)!==ChartDataStatus.dataLoaded}),pe=derived(ce.store,Jt=>{var rr;return(rr=Jt.instances[he])==null?void 0:rr.resolution});let Oe=state(!1),Fe=0;var Ne=root$n(),ze=child(Ne),He=child(ze),We=child(He),je=child(We),Ue=child(je);Wrapper(Ue,{children:(Jt,rr)=>{var lr=root_1$k(),ur=first_child(lr),Sr=child(ur),xr=child(Sr),Pr=sibling(ur,2);Tooltip(Pr,{children:(mr,Er)=>{var dr=text();template_effect(Cr=>set_text(dr,Cr),[()=>le("legend.changeSymbol")]),append(mr,dr)},$$slots:{default:!0}}),template_effect(()=>{var mr;return set_text(xr,(mr=se())==null?void 0:mr.description)}),append(Jt,lr)},$$slots:{default:!0}});var Ge=sibling(je,2),Ze=child(Ge);Wrapper(Ze,{children:(Jt,rr)=>{var lr=root_3$f(),ur=first_child(lr),Sr=child(ur),xr=child(Sr),Pr=sibling(ur,2);Tooltip(Pr,{children:(mr,Er)=>{var dr=text();template_effect(Cr=>set_text(dr,Cr),[()=>le("legend.changeInterval")]),append(mr,dr)},$$slots:{default:!0}}),template_effect(()=>set_text(xr,ae())),append(Jt,lr)},$$slots:{default:!0}});var Ye=sibling(We,2),qe=child(Ye);Wrapper(qe,{children:(Jt,rr)=>{var lr=root_5$a(),ur=sibling(first_child(lr),2);Tooltip(ur,{children:(Sr,xr)=>{var Pr=text();template_effect(mr=>set_text(Pr,mr),[()=>le("legend.more")]),append(Sr,Pr)},$$slots:{default:!0}}),append(Jt,lr)},$$slots:{default:!0}});var nr=sibling(He,2),ir=child(nr);{var tr=Jt=>{Loader(Jt)},or=Jt=>{MainSeriesValues(Jt,{get chartIndex(){return he}})};if_block(ir,Jt=>{re()?Jt(tr):Jt(or,!1)})}template_effect((Jt,rr)=>{set_class(He,1,Jt,"svelte-1svbifb"),set_class(Ye,1,rr,"svelte-1svbifb")},[()=>clsx(clsx$1("display",get$2(Oe)&&"display--hover")),()=>clsx(clsx$1("buttons",get$2(Oe)&&"buttons--hover"))]),event("mouseenter",He,()=>{re()||(set(Oe,!0),Fe&&(clearTimeout(Fe),Fe=0))}),event("mouseleave",He,()=>{Fe=setTimeout(()=>{set(Oe,!1),Fe=0},200)}),append(ie,Ne),pop(),ne()}const toggleIndicatorLegend=(ie,te)=>{set(te,!get$2(te))};var root_5$9=from_html('<button class="toggleLegend svelte-1y8u07g"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" width="15" height="15"><path fill="currentColor" d="M3.5 5.58c.24-.28.65-.3.92-.07L7.5 8.14l3.08-2.63a.65.65 0 1 1 .84.98L7.5 9.86 3.58 6.49a.65.65 0 0 1-.07-.91z"></path></svg></span></button> <!>',1),root_1$j=from_html('<div class="mainPanePortal svelte-1y8u07g"><!> <!> <!></div>');function MainPanePortal(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(le,"$overlapStudyIdList",ee),{t:se}=useTranslation(),ae=useService(IChartManagementService),le=derivedWithCache(ae.store,Oe=>{var Fe;return(((Fe=Oe.instances[te.chartIndex])==null?void 0:Fe.studyList)??[]).filter(Ne=>!!Ne.overlap).map(Ne=>Ne.id)});let ce;const he=ae.chart(te.chartIndex),fe=ensure(he.mainSeriesWrapper.getSeries().getPane().getHTMLElement()),Ae=document.createElement("div");fe.appendChild(Ae),ce=Ae,onMount(()=>{PartFingerprints.write(ce,PartFingerprint.Legend)}),onDestroy(()=>{ce.remove()});let pe=state(!1);Portal$1(ie,{get target(){return ce},children:(Oe,Fe)=>{var Ne=root_1$j(),ze=child(Ne);MainSeriesLegend(ze,{get chartIndex(){return te.chartIndex}});var He=sibling(ze,2);{var We=Ge=>{var Ze=comment(),Ye=first_child(Ze);each(Ye,1,re,qe=>qe,(qe,nr)=>{StudySeriesLegend(qe,{get chartIndex(){return te.chartIndex},get studyId(){return get$2(nr)}})}),append(Ge,Ze)};if_block(He,Ge=>{get$2(pe)||Ge(We)})}var je=sibling(He,2);{var Ue=Ge=>{Wrapper(Ge,{children:(Ze,Ye)=>{var qe=root_5$9(),nr=first_child(qe);nr.__pointerup=[toggleIndicatorLegend,pe];var ir=child(nr),tr=sibling(nr,2);Tooltip(tr,{children:(or,Jt)=>{var rr=text();template_effect(lr=>set_text(rr,lr),[()=>se(get$2(pe)?"legend.main.showMore":"legend.main.showLess")]),append(or,rr)},$$slots:{default:!0}}),template_effect(()=>set_class(ir,1,clsx(["iconWrap",get$2(pe)&&"collapsed"]),"svelte-1y8u07g")),append(Ze,qe)},$$slots:{default:!0}})};if_block(je,Ge=>{re().length&&Ge(Ue)})}append(Oe,Ne)},$$slots:{default:!0}}),pop(),ne()}delegate(["pointerup"]);var root_2$d=from_html('<div class="tipContent svelte-f2r7jm"> </div>'),root_1$i=from_html('<div class="anchor svelte-f2r7jm"></div> <!>',1),root_4$8=from_html('<div class="tipContent svelte-f2r7jm"> </div>'),root_3$e=from_html('<div class="anchor svelte-f2r7jm"></div> <!>',1),root$m=from_html("<!> <!>",1);function PaneTooltip(ie,te){push(te,!0);const ee=useService(IChartGuiService);let ne,re,se,ae,le=proxy({1:{content:"",yPos:void 0,showDelay:100,hideDelay:100,show:!1},2:{content:"",yPos:void 0,showDelay:100,hideDelay:100,show:!1}}),ce=0,he={value:2,id:-1};function fe(){return he.value===2?re:ne}function Ae(We=!1){var je;We&&((je=pe().getInstance())==null||je.setHideDelay(0)),fe().dispatchEvent(new MouseEvent("mouseleave")),Oe().show=!1}function pe(){return he.value===2?ae:se}function Oe(){return he.value===2?le[2]:le[1]}function Fe(){return he.value=he.value===2?1:2,he.id=ce++}useDisposable(ee.onPaneTooltipRequested(async We=>{const je=!!Oe().show;Ae(!0);const Ue=Fe(),{anchor:Ge,content:Ze}=We;Object.assign(fe().style,{left:toPX(Ge.x),top:toPX(Ge.y),width:toPX(Ge.width),height:toPX(Ge.height)}),Object.assign(Oe(),{content:Ze,showDelay:je?0:100,hideDelay:100,yPos:We.yPos}),Oe().content=Ze,await tick(),he.id===Ue&&(fe().dispatchEvent(new MouseEvent("mouseenter")),Oe().show=!0)})),useDisposable(ee.onPaneTooltipCancelled(async()=>{Ae(),Fe()})),onDestroy(()=>{ne=null,se=null,re=null,ae=null});var Ne=root$m(),ze=first_child(Ne);Wrapper(ze,{children:(We,je)=>{var Ue=root_1$i(),Ge=first_child(Ue);bind_this(Ge,Ye=>ne=Ye,()=>ne);var Ze=sibling(Ge,2);bind_this(Tooltip(Ze,{persistent:!0,get showDelay(){return le[1].showDelay},get hideDelay(){return le[1].hideDelay},get yPos(){return le[1].yPos},children:(Ye,qe)=>{var nr=root_2$d(),ir=child(nr);template_effect(()=>set_text(ir,le[1].content)),append(Ye,nr)},$$slots:{default:!0}}),Ye=>se=Ye,()=>se),append(We,Ue)},$$slots:{default:!0}});var He=sibling(ze,2);Wrapper(He,{children:(We,je)=>{var Ue=root_3$e(),Ge=first_child(Ue);bind_this(Ge,Ye=>re=Ye,()=>re);var Ze=sibling(Ge,2);bind_this(Tooltip(Ze,{persistent:!0,get showDelay(){return le[2].showDelay},get hideDelay(){return le[2].hideDelay},get yPos(){return le[2].yPos},children:(Ye,qe)=>{var nr=root_4$8(),ir=child(nr);template_effect(()=>set_text(ir,le[2].content)),append(Ye,nr)},$$slots:{default:!0}}),Ye=>ae=Ye,()=>ae),append(We,Ue)},$$slots:{default:!0}}),append(ie,Ne),pop()}var root_1$h=from_html("<!> <!> <!> <!> <!> <!>",1),root$l=from_html('<div><div class="isolate svelte-7dwz1w" tabindex="-1"></div> <!></div>');function ChartSlot(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(Fe,"$isMulti",ee),se=()=>store_get(pe,"$isActive",ee),ae=()=>store_get(Oe,"$studyIdList",ee);let le=state(!1),ce;const he=useService(IChartManagementService),fe=te.chartIndex,Ae=String.fromCodePoint(Codepoint.a+te.chartIndex),pe=derivedWithCache(he.store,Ue=>Ue.activeIndex===te.chartIndex),Oe=derivedWithCache(he.store,Ue=>{var Ge;return(((Ge=Ue.instances[fe])==null?void 0:Ge.studyList)??[]).filter(Ze=>!Ze.overlap).map(Ze=>Ze.id)}),Fe=derivedWithCache(he.store,Ue=>chartLayoutRegistry.value(Ue.layout).slotCount>1);onMount(()=>{he.manage(ce,te.chartIndex);const Ue=he.chart(te.chartIndex);setContext(IChartService,Ue),set(le,!0),PartFingerprints.write(ce,PartFingerprint.Chart)}),onDestroy(()=>{he.unmanage(ce,te.chartIndex),ce=null});var Ne=root$l();let ze;var He=child(Ne);bind_this(He,Ue=>ce=Ue,()=>ce);var We=sibling(He,2);{var je=Ue=>{var Ge=root_1$h(),Ze=first_child(Ge);MainPanePortal(Ze,{get chartIndex(){return te.chartIndex}});var Ye=sibling(Ze,2);each(Ye,1,ae,or=>or,(or,Jt)=>{var rr=comment(),lr=first_child(rr);key(lr,()=>ae().length,ur=>{AuxPanePortal(ur,{get chartIndex(){return te.chartIndex},get studyId(){return get$2(Jt)}})}),append(or,rr)});var qe=sibling(Ye,2);AxisSetting(qe,{get chartIndex(){return te.chartIndex}});var nr=sibling(qe,2);CrosshairButtonMenu(nr,{get chartIndex(){return te.chartIndex}});var ir=sibling(nr,2);PaneTooltip(ir,{});var tr=sibling(ir,2);CustomComponents$1(tr,{}),append(Ue,Ge)};if_block(We,Ue=>{get$2(le)&&Ue(je)})}template_effect((Ue,Ge)=>{set_class(Ne,1,Ue,"svelte-7dwz1w"),ze=set_style(Ne,"",ze,Ge)},[()=>clsx(clsx$1("slot",re()&&"multiple",se()&&"active")),()=>({"grid-area":Ae})]),append(ie,Ne),pop(),ne()}var root$k=from_html("<div></div>");function Center(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(Ae,"$cursor",ee),se=()=>store_get(he,"$currentLayoutDeclaration",ee),ae=()=>store_get(fe,"$slotRangeArr",ee);let le=mutable_source();const ce=useService(IChartManagementService),he=derived(ce.store,Fe=>chartLayoutRegistry.value(Fe.layout).layout.gridTemplate);onMount(()=>{ce.restore(get$2(le))});const fe=derived(ce.store,Fe=>Array.from({length:chartLayoutRegistry.value(Fe.layout).slotCount},(Ne,ze)=>ze)),Ae=derivedWithCache(ce.store,Fe=>getCursorString(Fe.cursor));onDestroy(()=>{set(le,null)}),init$1();var pe=root$k();let Oe;each(pe,5,ae,index,(Fe,Ne)=>{ChartSlot(Fe,{get chartIndex(){return get$2(Ne)}})}),bind_this(pe,Fe=>set(le,Fe),()=>get$2(le)),template_effect((Fe,Ne)=>{set_class(pe,1,Fe,"svelte-cpm446"),Oe=set_style(pe,"",Oe,Ne)},[()=>clsx(clsx$1("center",`pane--cursor-${re()}`)),()=>({"grid-template":se()})]),append(ie,pe),pop(),ne()}function CustomComponents(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ae,"$components",ee),se=useService(IGuiService),ae=derived(se.store,he=>he.components);init$1();var le=comment(),ce=first_child(le);each(ce,1,re,he=>he.id,(he,fe)=>{get$2(fe).Component(he,spread_props(()=>get$2(fe).props))}),append(ie,le),pop(),ne()}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var cssClasses={CLOSING:"mdc-snackbar--closing",OPEN:"mdc-snackbar--open",OPENING:"mdc-snackbar--opening"},strings={ACTION_SELECTOR:".mdc-snackbar__action",ARIA_LIVE_LABEL_TEXT_ATTR:"data-mdc-snackbar-label-text",CLOSED_EVENT:"MDCSnackbar:closed",CLOSING_EVENT:"MDCSnackbar:closing",DISMISS_SELECTOR:".mdc-snackbar__dismiss",LABEL_SELECTOR:".mdc-snackbar__label",OPENED_EVENT:"MDCSnackbar:opened",OPENING_EVENT:"MDCSnackbar:opening",REASON_ACTION:"action",REASON_DISMISS:"dismiss",SURFACE_SELECTOR:".mdc-snackbar__surface"},numbers={DEFAULT_AUTO_DISMISS_TIMEOUT_MS:5e3,INDETERMINATE:-1,MAX_AUTO_DISMISS_TIMEOUT_MS:1e4,MIN_AUTO_DISMISS_TIMEOUT_MS:4e3,SNACKBAR_ANIMATION_CLOSE_TIME_MS:75,SNACKBAR_ANIMATION_OPEN_TIME_MS:150,ARIA_LIVE_DELAY_MS:1e3};/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var ARIA_LIVE_DELAY_MS=numbers.ARIA_LIVE_DELAY_MS,ARIA_LIVE_LABEL_TEXT_ATTR=strings.ARIA_LIVE_LABEL_TEXT_ATTR;function announce(ie,te){te===void 0&&(te=ie);var ee=ie.getAttribute("aria-live"),ne=te.textContent.trim();if(!(!ne||!ee)){ie.setAttribute("aria-live","off"),te.textContent="";var re=document.createElement("span");re.setAttribute("style","display: inline-block; width: 0; height: 1px;"),re.textContent=" ",te.appendChild(re),te.setAttribute(ARIA_LIVE_LABEL_TEXT_ATTR,ne),setTimeout(function(){ie.setAttribute("aria-live",ee),te.removeAttribute(ARIA_LIVE_LABEL_TEXT_ATTR),te.textContent=ne},ARIA_LIVE_DELAY_MS)}}/**
 * @license
 * Copyright 2018 Google Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */var OPENING=cssClasses.OPENING,OPEN=cssClasses.OPEN,CLOSING=cssClasses.CLOSING,REASON_ACTION=strings.REASON_ACTION,REASON_DISMISS=strings.REASON_DISMISS,MDCSnackbarFoundation=function(ie){__extends(te,ie);function te(ee){var ne=ie.call(this,__assign(__assign({},te.defaultAdapter),ee))||this;return ne.opened=!1,ne.animationFrame=0,ne.animationTimer=0,ne.autoDismissTimer=0,ne.autoDismissTimeoutMs=numbers.DEFAULT_AUTO_DISMISS_TIMEOUT_MS,ne.closeOnEscape=!0,ne}return Object.defineProperty(te,"cssClasses",{get:function(){return cssClasses},enumerable:!1,configurable:!0}),Object.defineProperty(te,"strings",{get:function(){return strings},enumerable:!1,configurable:!0}),Object.defineProperty(te,"numbers",{get:function(){return numbers},enumerable:!1,configurable:!0}),Object.defineProperty(te,"defaultAdapter",{get:function(){return{addClass:function(){},announce:function(){},notifyClosed:function(){},notifyClosing:function(){},notifyOpened:function(){},notifyOpening:function(){},removeClass:function(){}}},enumerable:!1,configurable:!0}),te.prototype.destroy=function(){this.clearAutoDismissTimer(),cancelAnimationFrame(this.animationFrame),this.animationFrame=0,clearTimeout(this.animationTimer),this.animationTimer=0,this.adapter.removeClass(OPENING),this.adapter.removeClass(OPEN),this.adapter.removeClass(CLOSING)},te.prototype.open=function(){var ee=this;this.clearAutoDismissTimer(),this.opened=!0,this.adapter.notifyOpening(),this.adapter.removeClass(CLOSING),this.adapter.addClass(OPENING),this.adapter.announce(),this.runNextAnimationFrame(function(){ee.adapter.addClass(OPEN),ee.animationTimer=setTimeout(function(){var ne=ee.getTimeoutMs();ee.handleAnimationTimerEnd(),ee.adapter.notifyOpened(),ne!==numbers.INDETERMINATE&&(ee.autoDismissTimer=setTimeout(function(){ee.close(REASON_DISMISS)},ne))},numbers.SNACKBAR_ANIMATION_OPEN_TIME_MS)})},te.prototype.close=function(ee){var ne=this;ee===void 0&&(ee=""),this.opened&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=0,this.clearAutoDismissTimer(),this.opened=!1,this.adapter.notifyClosing(ee),this.adapter.addClass(cssClasses.CLOSING),this.adapter.removeClass(cssClasses.OPEN),this.adapter.removeClass(cssClasses.OPENING),clearTimeout(this.animationTimer),this.animationTimer=setTimeout(function(){ne.handleAnimationTimerEnd(),ne.adapter.notifyClosed(ee)},numbers.SNACKBAR_ANIMATION_CLOSE_TIME_MS))},te.prototype.isOpen=function(){return this.opened},te.prototype.getTimeoutMs=function(){return this.autoDismissTimeoutMs},te.prototype.setTimeoutMs=function(ee){var ne=numbers.MIN_AUTO_DISMISS_TIMEOUT_MS,re=numbers.MAX_AUTO_DISMISS_TIMEOUT_MS,se=numbers.INDETERMINATE;if(ee===numbers.INDETERMINATE||ee<=re&&ee>=ne)this.autoDismissTimeoutMs=ee;else throw new Error(`
        timeoutMs must be an integer in the range `+ne+"–"+re+`
        (or `+se+" to disable), but got '"+ee+"'")},te.prototype.getCloseOnEscape=function(){return this.closeOnEscape},te.prototype.setCloseOnEscape=function(ee){this.closeOnEscape=ee},te.prototype.handleKeyDown=function(ee){var ne=ee.key==="Escape"||ee.keyCode===27;ne&&this.getCloseOnEscape()&&this.close(REASON_DISMISS)},te.prototype.handleActionButtonClick=function(ee){this.close(REASON_ACTION)},te.prototype.handleActionIconClick=function(ee){this.close(REASON_DISMISS)},te.prototype.clearAutoDismissTimer=function(){clearTimeout(this.autoDismissTimer),this.autoDismissTimer=0},te.prototype.handleAnimationTimerEnd=function(){this.animationTimer=0,this.adapter.removeClass(cssClasses.OPENING),this.adapter.removeClass(cssClasses.CLOSING)},te.prototype.runNextAnimationFrame=function(ee){var ne=this;cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(function(){ne.animationFrame=0,clearTimeout(ne.animationTimer),ne.animationTimer=setTimeout(ee,0)})},te}(MDCFoundation);let waiting=Promise.resolve();var root$j=from_html("<aside><div><!></div></aside>");function Snackbar(ie,te){push(te,!0);const{closest:ee}=ponyfill;let ne=()=>{};function re(dr){return dr===ne}let se=prop(te,"use",19,()=>[]),ae=prop(te,"class",3,""),le=prop(te,"openOnMount",3,!1),ce=prop(te,"leading",3,!1),he=prop(te,"timeoutMs",3,5e3),fe=prop(te,"closeOnEscape",3,!0),Ae=prop(te,"labelText",3,ne),pe=prop(te,"actionButtonText",3,ne),Oe=prop(te,"surface$use",19,()=>[]),Fe=prop(te,"surface$class",3,""),Ne=rest_props(te,["$$slots","$$events","$$legacy","use","class","variant","openOnMount","leading","timeoutMs","closeOnEscape","labelText","actionButtonText","surface$use","surface$class","children"]),ze,He=state(void 0),We=proxy({}),je,Ue=new Promise(dr=>je=dr);setContext("SMUI:label:context","snackbar"),user_effect(()=>{get$2(He)&&get$2(He).getTimeoutMs()!==he()&&get$2(He).setTimeoutMs(he())}),user_effect(()=>{get$2(He)&&get$2(He).getCloseOnEscape()!==fe()&&get$2(He).setCloseOnEscape(fe())}),user_effect(()=>{get$2(He)&&!re(Ae())&&Jt().textContent!==Ae()&&(Jt().textContent=Ae())}),user_effect(()=>{get$2(He)&&!re(pe())&&rr().textContent!==pe()&&(rr().textContent=pe())}),onMount(()=>(set(He,new MDCSnackbarFoundation({addClass:Ge,announce:()=>announce(Jt()),notifyClosed:dr=>dispatch(lr(),"SMUISnackbarClosed",dr?{reason:dr}:{}),notifyClosing:dr=>dispatch(lr(),"SMUISnackbarClosing",dr?{reason:dr}:{}),notifyOpened:()=>dispatch(lr(),"SMUISnackbarOpened"),notifyOpening:()=>dispatch(lr(),"SMUISnackbarOpening"),removeClass:Ze}),!0),get$2(He).init(),le()&&get$2(He).open(),()=>{var dr;(dr=get$2(He))==null||dr.destroy()}));function Ge(dr){We[dr]||(We[dr]=!0)}function Ze(dr){(!(dr in We)||We[dr])&&(We[dr]=!1)}function Ye(dr){const Cr=dr.target;get$2(He)&&(ee(Cr,".mdc-snackbar__action")?get$2(He).handleActionButtonClick(dr):ee(Cr,".mdc-snackbar__dismiss")&&get$2(He).handleActionIconClick(dr))}function qe(){je(),Ue=new Promise(dr=>je=dr)}function nr(){waiting=waiting.then(()=>{var dr;return(dr=get$2(He))==null||dr.open(),Ue})}function ir(){var dr;return(dr=get$2(He))==null?void 0:dr.open()}function tr(dr){var Cr;return(Cr=get$2(He))==null?void 0:Cr.close(dr)}function or(){if(get$2(He)==null)throw new Error("Instance is undefined.");return get$2(He).isOpen()}function Jt(){return lr().querySelector(".mdc-snackbar__label")??document.createElement("div")}function rr(){return lr().querySelector(".mdc-snackbar__action")??document.createElement("button")}function lr(){return ze}var ur=root$j(),Sr=dr=>{var Cr;get$2(He)&&get$2(He).handleKeyDown(dr),(Cr=te.onkeydown)==null||Cr.call(te,dr)},xr=dr=>{var Cr;qe(),(Cr=te.onSMUISnackbarClosed)==null||Cr.call(te,dr)};attribute_effect(ur,(dr,Cr)=>({class:dr,...Cr,onkeydown:Sr,onSMUISnackbarClosed:xr}),[()=>classMap({[ae()]:!0,"mdc-snackbar":!0,"mdc-snackbar--stacked":te.variant==="stacked","mdc-snackbar--leading":ce(),...We}),()=>exclude(Ne,["surface$"])]);var Pr=child(ur),mr=dr=>{var Cr;Ye(dr),(Cr=te.surface$onclick)==null||Cr.call(te,dr)};attribute_effect(Pr,(dr,Cr)=>({class:dr,role:"status","aria-relevant":"additions",...Cr,onclick:mr}),[()=>classMap({[Fe()]:!0,"mdc-snackbar__surface":!0}),()=>prefixFilter(Ne,"surface$")]);var Er=child(Pr);return snippet(Er,()=>te.children??noop$1),action(Pr,(dr,Cr)=>useActions==null?void 0:useActions(dr,Cr),Oe),bind_this(ur,dr=>ze=dr,()=>ze),action(ur,(dr,Cr)=>useActions==null?void 0:useActions(dr,Cr),se),append(ie,ur),pop({open:nr,forceOpen:ir,close:tr,isOpen:or,getLabelElement:Jt,getActionButtonElement:rr,getElement:lr})}const onClose=(ie,te,ee)=>{ee.item.close()};var root_1$g=from_html('<div class="label svelte-1jhsad5"> </div> <div class="actions"><button class="button svelte-1jhsad5"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"><path fill="currentColor" d="M9.707 9l4.647-4.646-.707-.708L9 8.293 4.354 3.646l-.708.708L8.293 9l-4.647 4.646.708.708L9 9.707l4.646 4.647.708-.707L9.707 9z"></path></svg></button></div>',1);function Toast(ie,te){push(te,!0);const ee=rest_props(te,["$$slots","$$events","$$legacy"]);{let ne=user_derived(()=>`cl-toast--${Severity.toString(te.item.severity)}`);Snackbar(ie,{openOnMount:!0,timeoutMs:-1,get surface$class(){return get$2(ne)},children:(re,se)=>{var ae=root_1$g(),le=first_child(ae),ce=child(le),he=sibling(le,2),fe=child(he);fe.__pointerup=[onClose,ee,te],template_effect(()=>set_text(ce,te.item.message.text)),append(re,ae)},$$slots:{default:!0}})}pop()}delegate(["pointerup"]);const Pa=class Pa extends Disposable{constructor(ee){super();Ee(this,"mapNotificationToToast",new Map);Ee(this,"mapNotificationToDisposable",new Map);Ee(this,"addedToastsIntervalCounter",new IntervalCounter(Pa.SPAM_PROTECTION.interval));Ee(this,"store",writable([]));this.model=ee,this._register(toDisposable(()=>Reflect.set(this,"store",null))),this.registerListeners()}registerListeners(){this._register(this.model.onDidChangeNotification(ee=>this.onDidChangeNotification(ee)))}onDidChangeNotification(ee){switch(ee.kind){case NotificationChangeType.ADD:return this.addToast(ee.item);case NotificationChangeType.REMOVE:return this.removeToast(ee.item)}}addToast(ee){if(this.addedToastsIntervalCounter.increment()>Pa.SPAM_PROTECTION.limit)return;const ne=new DisposableStore;this.mapNotificationToDisposable.set(ee,ne),ne.add(scheduleAtNextAnimationFrame(()=>this.doAddToast(ee,ne)))}doAddToast(ee,ne){const re={item:ee};this.mapNotificationToToast.set(ee,re),this.store.update(se=>(se.push(re),se)),Event$1.once(ee.onDidClose)(()=>{this.removeToast(ee)}),this.purgeNotification(ee,ne)}purgeNotification(ee,ne){let re,se;const ae=()=>{re=setTimeout(()=>{document.visibilityState==="hidden"?se||(se=addDisposableListener(document,"visibilitychange",()=>{document.visibilityState==="visible"&&ae()}),ne.add(se)):this.removeToast(ee)},Pa.PURGE_TIMEOUT[ee.severity])};ae(),ne.add(toDisposable(()=>clearTimeout(re)))}removeToast(ee){const ne=this.mapNotificationToToast.get(ee);ne&&(this.mapNotificationToToast.delete(ee),this.store.update(se=>{const ae=se.findIndex(le=>le.item.equals(ne.item));return ae>-1&&se.splice(ae,1),se}));const re=this.mapNotificationToDisposable.get(ee);re&&(dispose(re),this.mapNotificationToDisposable.delete(ee))}};Ee(Pa,"MAX_NOTIFICATIONS",3),Ee(Pa,"PURGE_TIMEOUT",{[Severity.Verbose]:3e3,[Severity.Info]:15e3,[Severity.Warning]:18e3,[Severity.Error]:2e4}),Ee(Pa,"SPAM_PROTECTION",{interval:800,limit:Pa.MAX_NOTIFICATIONS});let ToastsModel=Pa;function Toasts(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(le,"$list",ee),se=useService(INotificationService),ae=new ToastsModel(se.model);useDisposable(ae);const le=derived(ae.store,fe=>fe);init$1();var ce=comment(),he=first_child(ce);each(he,1,re,index,(fe,Ae)=>{Toast(fe,{get item(){return get$2(Ae).item}})}),append(ie,ce),pop(),ne()}var root$i=from_html("<!> <!>",1);function Float(ie){var te=root$i(),ee=first_child(te);CustomComponents(ee,{});var ne=sibling(ee,2);Toasts(ne,{}),append(ie,te)}const easingFunc={easeOutCubic:ie=>--ie*ie*ie+1,easeInOutCubic:ie=>ie<.5?4*ie*ie*ie:(ie-1)*(2*ie-2)*(2*ie-2)+1};function lerp(ie,te,ee){return ie*(1-ee)+te*ee}const defaultOptions={from:0,duration:250,easing:easingFunc.easeOutCubic};class Animator{constructor(te){Ee(this,"_doing");Ee(this,"_completed");Ee(this,"_options");this._doing=!0,this._completed=!1,this._options={...defaultOptions,...te};const ee=performance.now();requestAnimationFrame(ne=>{this._animation(ee,this._options.from,ne)})}stop(){this._doing=!1}completed(){return this._completed}_animation(te,ee,ne){if(!this._doing){this._finishAnimation();return}const se=(!ne||ne<1e12?performance.now():ne)-te,ae=se>=this._options.duration||ee===this._options.to,le=Math.min(se/this._options.duration,1),ce=lerp(this._options.from,this._options.to,this._options.easing(le)),he=ae?this._options.to:ce,fe=he-ee;this._options.onStep(fe,he),ae?this._finishAnimation():requestAnimationFrame(Ae=>{this._animation(te,he,Ae)})}_finishAnimation(){this._options.onComplete&&this._options.onComplete(),this._completed=!0}}function doAnimate(ie){return new Animator(ie)}const Chevron=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 10" width="20" height="10"><path fill="none" stroke="currentColor" stroke-width="1.5" d="M2 1l8 8 8-8"/></svg>
`;var root_1$f=from_html('<img class="emoji svelte-o6ddum" loading="lazy" decoding="async" width="24" height="24" alt="" draggable="false"/>'),root$h=from_html('<span class="icon svelte-o6ddum"><!></span>');function EmojiPreview(ie,te){push(te,!0);let ee=state("");onMount(()=>{runWhenIdle(()=>{set(ee,getTwemojiUrl(te.emoji,"png"),!0)})});var ne=root$h(),re=child(ne);{var se=ae=>{var le=root_1$f();template_effect(()=>set_attribute(le,"src",get$2(ee))),append(ae,le)};if_block(re,ae=>{get$2(ee)&&ae(se)})}append(ie,ne),pop()}var root_2$c=from_html("<div> </div>"),root_3$d=from_html("<div></div>");function EmojiList(ie,te){push(te,!0);const{t:ee}=useTranslation(),ne=[],re=9;function se(ce){const he=[];for(let fe=0;fe<ce.length;fe+=re)he.push(ce.slice(fe,fe+re));return he}Icons$1.forEach(ce=>{ne.push({type:"title",title:ce.title}),se(ce.icons).forEach(he=>{ne.push({type:"list",icons:he})})});var ae=comment(),le=first_child(ae);each(le,17,()=>ne,index,(ce,he)=>{var fe=comment(),Ae=first_child(fe);{var pe=Fe=>{var Ne=root_2$c(),ze=child(Ne);template_effect((He,We)=>{set_class(Ne,1,He,"svelte-ftuc3d"),set_text(ze,We)},[()=>clsx(clsx$1("row","title")),()=>ee(get$2(he).title)]),append(Fe,Ne)},Oe=Fe=>{var Ne=root_3$d();each(Ne,21,()=>get$2(he).icons,index,(ze,He,We,je)=>{Item(ze,{tag:"div",class:"item",onpointerup:()=>te.onpointerup(get$2(He)),children:(Ue,Ge)=>{EmojiPreview(Ue,{get emoji(){return get$2(He)}})},$$slots:{default:!0}})}),template_effect(ze=>set_class(Ne,1,ze,"svelte-ftuc3d"),[()=>clsx(clsx$1("row","icons"))]),append(Fe,Ne)};if_block(Ae,Fe=>{get$2(he).type==="title"?Fe(pe):Fe(Oe,!1)})}append(ce,fe)}),append(ie,ae),pop()}function portal(ie,te="body"){let ee;async function ne(se){if(te=se,typeof te=="string"){if(ee=document.querySelector(te),ee===null&&(await tick(),ee=document.querySelector(te)),ee===null)throw new Error(`No element found matching css selector: "${te}"`)}else if(te instanceof HTMLElement)ee=te;else throw new TypeError(`Unknown portal target type: ${te===null?"null":typeof te}. Allowed types: string (CSS selector) or HTMLElement.`);ee.appendChild(ie),ie.hidden=!1}function re(){ie.parentNode&&ie.parentNode.removeChild(ie)}return ne(te),{update:ne,destroy:re}}var root$g=from_html("<div hidden><!></div>");function Portal(ie,te){push(te,!1);let ee=prop(te,"target",8,"body");init$1();var ne=root$g(),re=child(ne);slot(re,te,"default",{}),action(ne,(se,ae)=>portal==null?void 0:portal(se,ae),ee),append(ie,ne),pop()}var root_1$e=from_html('<span class="separator svelte-enlgwa"></span> <span> </span>',1),root_2$b=from_html("<span> </span>"),root$f=from_html('<div class="tipContent svelte-enlgwa"><span> </span> <!> <!></div>');function TooltipContent(ie,te){push(te,!0);var ee=root$f(),ne=child(ee),re=child(ne),se=sibling(ne,2);{var ae=he=>{var fe=root_1$e(),Ae=sibling(first_child(fe),2),pe=child(Ae);template_effect(Oe=>set_text(pe,Oe),[()=>getKeybindingLabel(te.keybinding)]),append(he,fe)};if_block(se,he=>{te.keybinding&&he(ae)})}var le=sibling(se,2);{var ce=he=>{var fe=root_2$b(),Ae=child(fe);template_effect(()=>set_text(Ae,te.contentAfter)),append(he,fe)};if_block(le,he=>{te.contentAfter&&he(ce)})}template_effect(()=>set_text(re,te.content)),append(ie,ee),pop()}const onButtonClicked=(ie,te,ee,ne)=>{var re;ee.disabled||((re=ee.onselect)==null||re.call(ee),ee.asMenuTrigger&&ne())};var root_1$d=from_html('<button><span class="iconBg svelte-1a43njk"><!></span></button> <!>',1),root_5$8=from_html('<div class="svelte-1a43njk"> </div>'),root_4$7=from_html('<button class="arrow svelte-1a43njk"><span class="svelte-1a43njk"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 16" width="10" height="16" class="svelte-1a43njk"><path d="M.6 1.4l1.4-1.4 8 8-8 8-1.4-1.4 6.389-6.532-6.389-6.668z" class="svelte-1a43njk"></path></svg></span></button> <!>',1),root$e=from_html("<div><!> <!> <!></div>");function IconButton(ie,te){push(te,!0);const ee=rest_props(te,["$$slots","$$events","$$legacy"]);let ne,re,se=state(void 0);const{t:ae}=useTranslation(),le=()=>{ne.setOpen(!0)};onMount(()=>{ne==null||ne.getMenuSurface().setIsHoisted(!0),set(se,re,!0)}),onDestroy(()=>{re=null,ne=null});var ce=root$e(),he=child(ce);Wrapper(he,{children:(Fe,Ne)=>{var ze=root_1$d(),He=first_child(ze);He.__pointerup=[onButtonClicked,ee,te,le];var We=child(He),je=child(We);html(je,()=>te.icon);var Ue=sibling(He,2);Tooltip(Ue,{xPos:"side_end",yPos:"side",children:(Ge,Ze)=>{{let Ye=user_derived(()=>ae(te.tip)),qe=user_derived(()=>ae(te.contentAfterKb));TooltipContent(Ge,{get content(){return get$2(Ye)},get keybinding(){return te.keybinding},get contentAfter(){return get$2(qe)}})}},$$slots:{default:!0}}),template_effect(Ge=>set_class(He,1,Ge,"svelte-1a43njk"),[()=>clsx(clsx$1("icon",te.active&&"iconActive",te.disabled&&"iconDisabled",te.negativeColor&&"iconNegativeColor"))]),append(Fe,ze)},$$slots:{default:!0}});var fe=sibling(he,2);{var Ae=Fe=>{Wrapper(Fe,{children:(Ne,ze)=>{var He=root_4$7(),We=first_child(He);We.__pointerup=le;var je=sibling(We,2);Tooltip(je,{xPos:"side_end",yPos:"side",children:(Ue,Ge)=>{var Ze=root_5$8(),Ye=child(Ze);template_effect(qe=>set_text(Ye,qe),[()=>ae(te.moreTip)]),append(Ue,Ze)},$$slots:{default:!0}}),append(Ne,He)},$$slots:{default:!0}})};if_block(fe,Fe=>{te.moreTip&&Fe(Ae)})}var pe=sibling(fe,2);{var Oe=Fe=>{Portal(Fe,{children:(Ne,ze)=>{{let He=user_derived(()=>clsx$1(te.menuClass,"cl-tool-dropdown"));bind_this(Menu(Ne,{anchor:!1,anchorCorner:"TOP_RIGHT",get anchorElement(){return get$2(se)},quickOpen:!0,get class(){return get$2(He)},children:(We,je)=>{var Ue=comment(),Ge=first_child(Ue);snippet(Ge,()=>te.children),append(We,Ue)},$$slots:{default:!0}}),We=>ne=We,()=>ne)}},$$slots:{default:!0}})};if_block(pe,Fe=>{te.children&&Fe(Oe)})}bind_this(ce,Fe=>re=Fe,()=>re),template_effect(Fe=>set_class(ce,1,Fe,"svelte-1a43njk"),[()=>clsx(clsx$1(te.class,"control"))]),append(ie,ce),pop()}delegate(["pointerup"]);var root_2$a=from_html("<div> </div>"),root_5$7=from_html('<span class="icon svelte-12ytihu"><!></span>'),root_3$c=from_html("<div></div>");function IconList(ie,te){push(te,!0);const{t:ee}=useTranslation(),ne=[],re=9;function se(ce){const he=[];for(let fe=0;fe<ce.length;fe+=re)he.push(ce.slice(fe,fe+re));return he}Icons.forEach(ce=>{ne.push({type:"title",title:ce.title}),se(ce.icons).forEach(he=>{ne.push({type:"list",icons:he})})});var ae=comment(),le=first_child(ae);each(le,17,()=>ne,index,(ce,he)=>{var fe=comment(),Ae=first_child(fe);{var pe=Fe=>{var Ne=root_2$a(),ze=child(Ne);template_effect((He,We)=>{set_class(Ne,1,He,"svelte-12ytihu"),set_text(ze,We)},[()=>clsx(clsx$1("row","title")),()=>ee(get$2(he).title)]),append(Fe,Ne)},Oe=Fe=>{var Ne=root_3$c();each(Ne,21,()=>get$2(he).icons,index,(ze,He,We,je)=>{Item(ze,{tag:"div",class:"item",onpointerup:()=>te.onpointerup(get$2(He)),children:(Ue,Ge)=>{var Ze=root_5$7(),Ye=child(Ze);html(Ye,()=>get$2(He)),append(Ue,Ze)},$$slots:{default:!0}})}),template_effect(ze=>set_class(Ne,1,ze,"svelte-12ytihu"),[()=>clsx(clsx$1("row","icons"))]),append(Fe,Ne)};if_block(Ae,Fe=>{get$2(he).type==="title"?Fe(pe):Fe(Oe,!1)})}append(ce,fe)}),append(ie,ae),pop()}var on_pointerup$4=(ie,te,ee)=>te(get$2(ee)),root_5$6=from_html("<div> </div>"),root_1$c=from_html('<div class="preview-container svelte-uu57m0"><div class="menu svelte-uu57m0"><!></div></div> <div class="tab-bar svelte-uu57m0"></div>',1);function IconsMenu(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(fe,"$activeType",ee),{t:se}=useTranslation(),ae=useService(ICommandService),le=useService(IToolService),ce=[iconEmoji,iconIcon];let he=state(proxy(ce[0]));const fe=derived(le.store,Fe=>Fe.activeType),Ae=Fe=>{set(he,Fe,!0)},pe=async Fe=>{const Ne=getTwemojiUrl(Fe,"svg"),ze=await fetch(Ne).then(He=>He.text());ae.executeCommand("tool.emoji",void 0,void 0,{icon:ze})},Oe=Fe=>{ae.executeCommand("tool.icon",void 0,void 0,{icon:Fe})};{let Fe=user_derived(()=>re()===get$2(he).type);IconButton(ie,{get icon(){return get$2(he).icon},get tip(){return get$2(he).type},get active(){return get$2(Fe)},moreTip:"tool.more.icons",class:"icons",menuClass:"cl-icons-menu",asMenuTrigger:!0,children:(Ne,ze)=>{var He=root_1$c(),We=first_child(He),je=child(We),Ue=child(je);List(Ue,{children:(Ze,Ye)=>{var qe=comment(),nr=first_child(qe);{var ir=or=>{EmojiList(or,{onpointerup:pe})},tr=or=>{IconList(or,{onpointerup:Oe})};if_block(nr,or=>{get$2(he).type===iconEmoji.type?or(ir):or(tr,!1)})}append(Ze,qe)},$$slots:{default:!0}});var Ge=sibling(We,2);each(Ge,21,()=>ce,index,(Ze,Ye)=>{var qe=root_5$6();qe.__pointerup=[on_pointerup$4,Ae,Ye];var nr=child(qe);template_effect((ir,tr)=>{set_class(qe,1,ir,"svelte-uu57m0"),set_text(nr,tr)},[()=>clsx(clsx$1("tab",get$2(Ye).type===get$2(he).type&&"tabActive")),()=>se(get$2(Ye).type)]),append(Ze,qe)}),append(Ne,He)},$$slots:{default:!0}})}pop(),ne()}delegate(["pointerup"]);const iconKeepDraw=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M17.27 4.56a2.5 2.5 0 0 0-3.54 0l-.58.59-9 9-1 1-.15.14V20h4.7l.15-.15 1-1 9-9 .59-.58a2.5 2.5 0 0 0 0-3.54l-1.17-1.17Zm-2.83.7a1.5 1.5 0 0 1 2.12 0l1.17 1.18a1.5 1.5 0 0 1 0 2.12l-.23.23-3.3-3.29.24-.23Zm-.94.95 3.3 3.29-8.3 8.3-3.3-3.3 8.3-8.3Zm-9 9 3.3 3.29-.5.5H4v-3.3l.5-.5Zm16.5.29a1.5 1.5 0 0 0-3 0V18h4.5c.83 0 1.5.67 1.5 1.5v4c0 .83-.67 1.5-1.5 1.5h-6a1.5 1.5 0 0 1-1.5-1.5v-4c0-.83.67-1.5 1.5-1.5h.5v-2.5a2.5 2.5 0 0 1 5 0v.5h-1v-.5ZM16.5 19a.5.5 0 0 0-.5.5v4c0 .28.22.5.5.5h6a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 0-.5-.5h-6Zm2.5 4v-2h1v2h-1Z"></path></svg>
`;function KeepDrawingMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ae,"$keepDrawing",ee),se=useService(IToolService),ae=derived(se.store,ce=>ce.keepDrawingMode),le=()=>{se.setKeepDrawingMode(!get$1(ae))};init$1(),IconButton(ie,{tip:"tool.keepDraw",get icon(){return iconKeepDraw},get active(){return re()},onselect:le,negativeColor:!0}),pop(),ne()}const iconMagentStrong=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="nonzero" d="M14 5a7 7 0 0 0-7 7v3h4v-3a3 3 0 1 1 6 0v3h4v-3a7 7 0 0 0-7-7zm7 11h-4v3h4v-3zm-10 0H7v3h4v-3zm-5-4a8 8 0 1 1 16 0v8h-6v-8a2 2 0 1 0-4 0v8H6v-8zm3.293 11.294l-1.222-2.037.858-.514 1.777 2.963-2 1 1.223 2.037-.858.514-1.778-2.963 2-1zm9.778-2.551l.858.514-1.223 2.037 2 1-1.777 2.963-.858-.514 1.223-2.037-2-1 1.777-2.963z"></path></svg>
`,iconMagentWeak=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><g fill="currentColor" fill-rule="evenodd"><path fill-rule="nonzero" d="M14 10a2 2 0 0 0-2 2v11H6V12c0-4.416 3.584-8 8-8s8 3.584 8 8v11h-6V12a2 2 0 0 0-2-2zm-3 2a3 3 0 0 1 6 0v10h4V12c0-3.864-3.136-7-7-7s-7 3.136-7 7v10h4V12z"></path><path d="M6.5 18h5v1h-5zm10 0h5v1h-5z"></path></g></svg>
`;var root_3$b=from_html('<div class="itemIcon svelte-1npdbq"><!></div> <div class="itemLabel svelte-1npdbq"> </div>',1),root_4$6=from_html('<div class="itemIcon svelte-1npdbq"><!></div> <div class="itemLabel svelte-1npdbq"> </div>',1),root_2$9=from_html("<!> <!>",1),root_1$b=from_html('<div class="menu svelte-1npdbq"><!></div>');function MagnetMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(he,"$icon",ee),se=()=>store_get(ce,"$mode",ee),{t:ae}=useTranslation(),le=useService(IToolService),ce=derived(le.store,Fe=>Fe.tempMagnetMode??Fe.magnetMode),he=derived(ce,Fe=>Fe===MagnetMode.StrongMagnet?iconMagentStrong:iconMagentWeak),fe=()=>{get$1(ce)===MagnetMode.Normal?le.setMagnetMode(MagnetMode.WeakMagnet):le.setMagnetMode(MagnetMode.Normal)},Ae=()=>{le.setMagnetMode(MagnetMode.StrongMagnet)},pe=()=>{le.setMagnetMode(MagnetMode.WeakMagnet)},Oe=KeyMod.CtrlCmd;init$1();{let Fe=derived_safe_equal(()=>se()!==MagnetMode.Normal);IconButton(ie,{get icon(){return re()},tip:"tool.magnet",get active(){return get$2(Fe)},get keybinding(){return Oe},moreTip:"tool.more.magnet",onselect:fe,negativeColor:!0,children:(Ne,ze)=>{var He=root_1$b(),We=child(He);List(We,{children:(je,Ue)=>{var Ge=root_2$9(),Ze=first_child(Ge);{let qe=derived_safe_equal(()=>se()===MagnetMode.WeakMagnet);Item(Ze,{tag:"div",class:"item",get selected(){return get$2(qe)},onpointerup:pe,children:(nr,ir)=>{var tr=root_3$b(),or=first_child(tr),Jt=child(or);html(Jt,()=>iconMagentWeak);var rr=sibling(or,2),lr=child(rr);template_effect(ur=>set_text(lr,ur),[()=>ae("tool.magnet.weak")]),append(nr,tr)},$$slots:{default:!0}})}var Ye=sibling(Ze,2);{let qe=derived_safe_equal(()=>se()===MagnetMode.StrongMagnet);Item(Ye,{tag:"div",class:"item",get selected(){return get$2(qe)},onpointerup:Ae,children:(nr,ir)=>{var tr=root_4$6(),or=first_child(tr),Jt=child(or);html(Jt,()=>iconMagentStrong);var rr=sibling(or,2),lr=child(rr);template_effect(ur=>set_text(lr,ur),[()=>ae("tool.magnet.strong")]),append(nr,tr)},$$slots:{default:!0}})}append(je,Ge)},$$slots:{default:!0}}),append(Ne,He)},$$slots:{default:!0}})}pop(),ne()}function MeasureMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ae,"$activeType",ee),se=useService(IToolService),ae=derived(se.store,le=>le.activeType);init$1();{let le=derived_safe_equal(()=>re()===measure.type);IconButton(ie,{tip:"tool.measure",get icon(){return measure.icon},get keybinding(){return KeyMod.Shift},contentAfterKb:"tool.measure.after",get active(){return get$2(le)},onselect:()=>{se.switchTool(measure.type)}})}pop(),ne()}const iconRemoveAll=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M18 7h5v1h-2.01l-1.33 14.64a1.5 1.5 0 0 1-1.5 1.36H9.84a1.5 1.5 0 0 1-1.49-1.36L7.01 8H5V7h5V6c0-1.1.9-2 2-2h4a2 2 0 0 1 2 2v1Zm-6-2a1 1 0 0 0-1 1v1h6V6a1 1 0 0 0-1-1h-4ZM8.02 8l1.32 14.54a.5.5 0 0 0 .5.46h8.33a.5.5 0 0 0 .5-.46L19.99 8H8.02Z"></path></svg>
`;var root_3$a=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_4$5=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_5$5=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_2$8=from_html("<!> <!> <!>",1),root_1$a=from_html('<div class="menu svelte-1npdbq"><!></div>');function RemoveMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(he,"$drawingCount",ee),se=()=>store_get(ce,"$indicatorCount",ee),{t:ae}=useTranslation(),le=useService(IChartManagementService),ce=derived(le.store,Oe=>{var Fe;return((Fe=Oe.instances[Oe.activeIndex])==null?void 0:Fe.studyList.length)??0}),he=derived(le.store,Oe=>{var Fe;return((Fe=Oe.instances[Oe.activeIndex])==null?void 0:Fe.drawingInfos.length)??0}),fe=()=>{const Oe=le.activeChart().getContribution(DrawingContribId);ensure(Oe).removeAll()},Ae=()=>{le.activeChart().removeAllStudy()},pe=()=>{fe(),Ae()};init$1(),IconButton(ie,{get icon(){return iconRemoveAll},tip:"tool.removeObjects",moreTip:"tool.more.remove",asMenuTrigger:!0,children:(Oe,Fe)=>{var Ne=root_1$a(),ze=child(Ne);List(ze,{children:(He,We)=>{var je=root_2$8(),Ue=first_child(je);Item(Ue,{tag:"div",class:"item",onpointerup:fe,children:(Ye,qe)=>{var nr=root_3$a(),ir=child(nr);template_effect(tr=>set_text(ir,tr),[()=>ae("tool.remove.drawing",{draw:re()})]),append(Ye,nr)},$$slots:{default:!0}});var Ge=sibling(Ue,2);Item(Ge,{tag:"div",class:"item",onpointerup:Ae,children:(Ye,qe)=>{var nr=root_4$5(),ir=child(nr);template_effect(tr=>set_text(ir,tr),[()=>ae("tool.remove.indicator",{ind:se()})]),append(Ye,nr)},$$slots:{default:!0}});var Ze=sibling(Ge,2);Item(Ze,{tag:"div",class:"item",onpointerup:pe,children:(Ye,qe)=>{var nr=root_5$5(),ir=child(nr);template_effect(tr=>set_text(ir,tr),[()=>ae("tool.remove.drawingAndIndicator",{draw:re(),ind:se()})]),append(Ye,nr)},$$slots:{default:!0}}),append(He,je)},$$slots:{default:!0}}),append(Oe,Ne)},$$slots:{default:!0}}),pop(),ne()}var root_4$4=from_html('<div class="sectionTitle svelte-1npdbq"> </div>'),root_7$1=from_html('<div class="itemKeybinding svelte-1npdbq"> </div>'),root_6$5=from_html('<div class="itemIcon svelte-1npdbq"><!></div> <div class="itemLabel svelte-1npdbq"> </div> <!>',1),root_8=from_html('<div class="separator svelte-1npdbq"></div>'),root_3$9=from_html("<!> <!> <!>",1),root_1$9=from_html('<div class="menu svelte-1npdbq"><!></div>');function ToolMenu(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(fe,"$activeType",ee);let se=state(proxy(te.groups[0].items[0]));const{t:ae}=useTranslation(),le=useService(IToolService),ce=()=>{le.switchTool(get$2(se).type)},he=Ae=>{le.switchTool(Ae)},fe=derived(le.store,Ae=>Ae.activeType);useDisposable(le.onDidChangeTool(Ae=>{const{next:pe}=Ae;pe&&te.groups.forEach(Oe=>{const Fe=Oe.items.find(Ne=>Ne.type===pe.type);Fe&&get$2(se).type!==Fe.type&&set(se,Fe,!0)})}));{let Ae=user_derived(()=>re()===get$2(se).type);IconButton(ie,{get icon(){return get$2(se).icon},get tip(){return get$2(se).type},get disabled(){return get$2(se).disabled},get active(){return get$2(Ae)},get moreTip(){return te.moreTip},onselect:ce,children:(pe,Oe)=>{var Fe=root_1$9(),Ne=child(Fe);List(Ne,{children:(ze,He)=>{var We=comment(),je=first_child(We);each(je,17,()=>te.groups,index,(Ue,Ge,Ze)=>{var Ye=root_3$9(),qe=first_child(Ye);{var nr=Jt=>{var rr=root_4$4(),lr=child(rr);template_effect(ur=>set_text(lr,ur),[()=>ae(get$2(Ge).name)]),append(Jt,rr)};if_block(qe,Jt=>{get$2(Ge).name&&Jt(nr)})}var ir=sibling(qe,2);each(ir,17,()=>get$2(Ge).items,index,(Jt,rr,lr,ur)=>{{let Sr=user_derived(()=>re()===get$2(rr).type);Item(Jt,{tag:"div",get disabled(){return get$2(rr).disabled},get selected(){return get$2(Sr)},class:"item",onpointerup:()=>{get$2(rr).disabled||he(get$2(rr).type)},children:(xr,Pr)=>{var mr=root_6$5(),Er=first_child(mr),dr=child(Er);html(dr,()=>get$2(rr).icon);var Cr=sibling(Er,2),Or=child(Cr),Ar=sibling(Cr,2);{var Ir=wr=>{var Dr=root_7$1(),Ur=child(Dr);template_effect(zr=>set_text(Ur,zr),[()=>getKeybindingLabel(get$2(rr).keybinding)]),append(wr,Dr)};if_block(Ar,wr=>{get$2(rr).keybinding&&wr(Ir)})}template_effect(wr=>set_text(Or,wr),[()=>ae(get$2(rr).type)]),append(xr,mr)},$$slots:{default:!0}})}});var tr=sibling(ir,2);{var or=Jt=>{var rr=root_8();append(Jt,rr)};if_block(tr,Jt=>{Ze!==te.groups.length-1&&Jt(or)})}append(Ue,Ye)}),append(ze,We)},$$slots:{default:!0}}),append(pe,Fe)},$$slots:{default:!0}})}pop(),ne()}const iconHideAll=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" d="M18.15 7.02A9.05 9.05 0 0014 6c-3.45 0-6.08 2-7.8 3.92a18.18 18.18 0 00-2.64 3.84v.02h-.01L4 14l-.45-.21-.1.21.1.21L4 14l-.45.21.01.03a5.85 5.85 0 00.16.32c.11.2.28.51.5.87a18.18 18.18 0 002.4 3.12l.71-.71A17.18 17.18 0 014.56 14a10.05 10.05 0 01.52-.91c.41-.69 1.04-1.6 1.85-2.5C8.58 8.75 10.95 7 14 7a8 8 0 013.4.77l.75-.75zm-3.11 3.12a4 4 0 00-4.9 4.9l.86-.87V14a3 3 0 013.17-3l.87-.86zm1.96 3.7l.86-.88a4 4 0 01-4.9 4.9l.87-.86A3 3 0 0017 13.83zm-6.4 6.4A8 8 0 0014 21c3.05 0 5.42-1.76 7.07-3.58A17.18 17.18 0 0023.44 14a9.47 9.47 0 00-.52-.91 17.18 17.18 0 00-2.25-2.93l.7-.7a18.18 18.18 0 013.06 4.3l.02.02L24 14l.45.21-.01.03a7.03 7.03 0 01-.16.32c-.11.2-.28.51-.5.87-.44.72-1.1 1.69-1.97 2.65C20.08 20.01 17.45 22 14 22c-1.55 0-2.94-.4-4.15-1.02l.75-.75zM24 14l.45-.21.1.21-.1.21L24 14zM22.2 6.5L6.5 22.2l-.7-.7L21.5 5.8l.7.7z"></path></svg>
`,iconHideDrawings=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M19.76 6.07l-.7.7a13.4 13.4 0 011.93 2.47c.19.3.33.55.42.72l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-.98 0-1.88-.2-2.7-.52l-.77.76c1.03.47 2.18.76 3.47.76 3.12 0 5.5-1.75 7.06-3.44a16 16 0 002.38-3.38v-.02h.01L22 10l.45.22.1-.22-.1-.22L22 10l.45-.22-.01-.02a5.1 5.1 0 00-.15-.28 16 16 0 00-2.53-3.41zM6.24 13.93l.7-.7-.27-.29a15 15 0 01-2.08-2.9L4.56 10l.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12.98 0 1.88.2 2.7.52l.77-.76A8.32 8.32 0 0013 2.94c-3.12 0-5.5 1.75-7.06 3.44a16 16 0 00-2.38 3.38v.02h-.01L4 10l-.45-.22-.1.22.1.22L4 10l-.45.22.01.02a5.5 5.5 0 00.15.28 16 16 0 002.53 3.41zm6.09-.43a3.6 3.6 0 004.24-4.24l-.93.93a2.6 2.6 0 01-2.36 2.36l-.95.95zm-1.97-3.69l-.93.93a3.6 3.6 0 014.24-4.24l-.95.95a2.6 2.6 0 00-2.36 2.36zm11.29 7.84l-.8.79a1.5 1.5 0 000 2.12l.59.59a1.5 1.5 0 002.12 0l1.8-1.8-.71-.7-1.8 1.79a.5.5 0 01-.7 0l-.59-.59a.5.5 0 010-.7l.8-.8-.71-.7zm-5.5 3.5l.35.35-.35-.35.01-.02.02-.02.02-.02a4.68 4.68 0 01.65-.5c.4-.27 1-.59 1.65-.59.66 0 1.28.33 1.73.77.44.45.77 1.07.77 1.73a2.5 2.5 0 01-.77 1.73 2.5 2.5 0 01-1.73.77h-4a.5.5 0 01-.42-.78l1-1.5 1-1.5a.5.5 0 01.07-.07zm.74.67a3.46 3.46 0 01.51-.4c.35-.24.75-.42 1.1-.42.34 0 .72.17 1.02.48.3.3.48.68.48 1.02 0 .34-.17.72-.48 1.02-.3.3-.68.48-1.02.48h-3.07l.49-.72.97-1.46zM21.2 2.5L5.5 18.2l-.7-.7L20.5 1.8l.7.7z"></path></svg>
`,iconHideIndicators=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" d="M16.47 3.7A8.32 8.32 0 0013 2.94c-3.12 0-5.5 1.75-7.06 3.44a16 16 0 00-2.38 3.38v.02h-.01L4 10l-.45-.22-.1.22.1.22L4 10l-.45.22.01.02a5.5 5.5 0 00.15.28 16 16 0 002.53 3.41l.7-.7-.27-.29a15 15 0 01-2.08-2.9L4.56 10l.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12.98 0 1.88.2 2.7.52l.77-.76zm-7.04 7.04l.93-.93a2.6 2.6 0 012.36-2.36l.95-.95a3.6 3.6 0 00-4.24 4.24zm.1 5.56c1.03.47 2.18.76 3.47.76 3.12 0 5.5-1.75 7.06-3.44a16 16 0 002.38-3.38v-.02h.01L22 10l.45.22.1-.22-.1-.22L22 10l.45-.22-.01-.02-.02-.03-.01-.03a9.5 9.5 0 00-.57-1 16 16 0 00-2.08-2.63l-.7.7.27.29a15.01 15.01 0 012.08 2.9l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-.98 0-1.88-.2-2.7-.52l-.77.76zm2.8-2.8a3.6 3.6 0 004.24-4.24l-.93.93a2.6 2.6 0 01-2.36 2.36l-.95.95zm7.9 3.73c-.12.12-.23.35-.23.77v2h1v1h-1v2c0 .58-.14 1.1-.52 1.48-.38.38-.9.52-1.48.52s-1.1-.14-1.48-.52c-.38-.38-.52-.9-.52-1.48h1c0 .42.1.65.23.77.12.12.35.23.77.23.42 0 .65-.1.77-.23.12-.12.23-.35.23-.77v-2h-1v-1h1v-2c0-.58.14-1.1.52-1.48.38-.38.9-.52 1.48-.52s1.1.14 1.48.52c.38.38.52.9.52 1.48h-1c0-.42-.1-.65-.23-.77-.12-.12-.35-.23-.77-.23-.42 0-.65.1-.77.23zm2.56 6.27l-1.14-1.15.7-.7 1.15 1.14 1.15-1.14.7.7-1.14 1.15 1.14 1.15-.7.7-1.15-1.14-1.15 1.14-.7-.7 1.14-1.15zM21.2 2.5L5.5 18.2l-.7-.7L20.5 1.8l.7.7z"></path></svg>
`,iconHidePositionsAndOrders=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M5.5 18.2L21.2 2.5l-.7-.7L4.8 17.5l.7.7zM19.05 6.78l.71-.7a14.26 14.26 0 0 1 2.08 2.64 14.26 14.26 0 0 1 .6 1.05v.02h.01L22 10l.45.22-.01.02a5.18 5.18 0 0 1-.15.28 16 16 0 0 1-2.23 3.1c-1.56 1.69-3.94 3.44-7.06 3.44-1.29 0-2.44-.3-3.47-.76l.76-.76c.83.32 1.73.52 2.71.52 2.73 0 4.85-1.53 6.33-3.12a15.01 15.01 0 0 0 2.08-2.9l.03-.04-.03-.04a15 15 0 0 0-2.36-3.18zM22 10l.45-.22.1.22-.1.22L22 10zM6.94 13.23l-.7.7a14.24 14.24 0 0 1-2.08-2.64 14.28 14.28 0 0 1-.6-1.05v-.02h-.01L4 10l-.45-.22.01-.02a5.55 5.55 0 0 1 .15-.28 16 16 0 0 1 2.23-3.1C7.5 4.69 9.88 2.94 13 2.94c1.29 0 2.44.3 3.47.76l-.76.76A7.27 7.27 0 0 0 13 3.94c-2.73 0-4.85 1.53-6.33 3.12a15 15 0 0 0-2.08 2.9l-.03.04.03.04a15.01 15.01 0 0 0 2.36 3.18zM4 10l-.45.22-.1-.22.1-.22L4 10zm9 3.56c-.23 0-.46-.02-.67-.06l.95-.95a2.6 2.6 0 0 0 2.36-2.36l.93-.93a3.6 3.6 0 0 1-3.57 4.3zm-3.57-2.82l.93-.93a2.6 2.6 0 0 1 2.36-2.36l.95-.95a3.6 3.6 0 0 0-4.24 4.24zM17.5 21.9l3.28 2.18a.5.5 0 1 1-.56.84L17.5 23.1l-2.72 1.82a.5.5 0 1 1-.56-.84l3.28-2.18zM18.58 19.22a.5.5 0 0 1 .7-.14L22 20.9l2.72-1.82a.5.5 0 0 1 .56.84L22 22.1l-3.28-2.18a.5.5 0 0 1-.14-.7z"></path></svg>
`,iconShowAll=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M4.56 14a10.05 10.05 0 00.52.91c.41.69 1.04 1.6 1.85 2.5C8.58 19.25 10.95 21 14 21c3.05 0 5.42-1.76 7.07-3.58A17.18 17.18 0 0023.44 14a9.47 9.47 0 00-.52-.91c-.41-.69-1.04-1.6-1.85-2.5C19.42 8.75 17.05 7 14 7c-3.05 0-5.42 1.76-7.07 3.58A17.18 17.18 0 004.56 14zM24 14l.45-.21-.01-.03a7.03 7.03 0 00-.16-.32c-.11-.2-.28-.51-.5-.87-.44-.72-1.1-1.69-1.97-2.65C20.08 7.99 17.45 6 14 6c-3.45 0-6.08 2-7.8 3.92a18.18 18.18 0 00-2.64 3.84v.02h-.01L4 14l-.45-.21-.1.21.1.21L4 14l-.45.21.01.03a5.85 5.85 0 00.16.32c.11.2.28.51.5.87.44.72 1.1 1.69 1.97 2.65C7.92 20.01 10.55 22 14 22c3.45 0 6.08-2 7.8-3.92a18.18 18.18 0 002.64-3.84v-.02h.01L24 14zm0 0l.45.21.1-.21-.1-.21L24 14zm-10-3a3 3 0 100 6 3 3 0 000-6zm-4 3a4 4 0 118 0 4 4 0 01-8 0z"></path></svg>
`,iconShowDrawings=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M5 10.76l-.41-.72-.03-.04.03-.04a15 15 0 012.09-2.9c1.47-1.6 3.6-3.12 6.32-3.12 2.73 0 4.85 1.53 6.33 3.12a15.01 15.01 0 012.08 2.9l.03.04-.03.04a15 15 0 01-2.09 2.9c-1.47 1.6-3.6 3.12-6.32 3.12-2.73 0-4.85-1.53-6.33-3.12a15 15 0 01-1.66-2.18zm17.45-.98L22 10l.45.22-.01.02a5.04 5.04 0 01-.15.28 16.01 16.01 0 01-2.23 3.1c-1.56 1.69-3.94 3.44-7.06 3.44-3.12 0-5.5-1.75-7.06-3.44a16 16 0 01-2.38-3.38v-.02h-.01L4 10l-.45-.22.01-.02a5.4 5.4 0 01.15-.28 16 16 0 012.23-3.1C7.5 4.69 9.88 2.94 13 2.94c3.12 0 5.5 1.75 7.06 3.44a16.01 16.01 0 012.38 3.38v.02h.01zM22 10l.45-.22.1.22-.1.22L22 10zM3.55 9.78L4 10l-.45.22-.1-.22.1-.22zm6.8.22A2.6 2.6 0 0113 7.44 2.6 2.6 0 0115.65 10 2.6 2.6 0 0113 12.56 2.6 2.6 0 0110.35 10zM13 6.44A3.6 3.6 0 009.35 10 3.6 3.6 0 0013 13.56c2 0 3.65-1.58 3.65-3.56A3.6 3.6 0 0013 6.44zm7.85 12l.8-.8.7.71-.79.8a.5.5 0 000 .7l.59.59c.2.2.5.2.7 0l1.8-1.8.7.71-1.79 1.8a1.5 1.5 0 01-2.12 0l-.59-.59a1.5 1.5 0 010-2.12zM16.5 21.5l-.35-.35a.5.5 0 00-.07.07l-1 1.5-1 1.5a.5.5 0 00.42.78h4a2.5 2.5 0 001.73-.77A2.5 2.5 0 0021 22.5a2.5 2.5 0 00-.77-1.73A2.5 2.5 0 0018.5 20a3.1 3.1 0 00-1.65.58 5.28 5.28 0 00-.69.55v.01h-.01l.35.36zm.39.32l-.97 1.46-.49.72h3.07c.34 0 .72-.17 1.02-.48.3-.3.48-.68.48-1.02 0-.34-.17-.72-.48-1.02-.3-.3-.68-.48-1.02-.48-.35 0-.75.18-1.1.42a4.27 4.27 0 00-.51.4z"></path></svg>
`,iconShowIndicators=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M5 10.76a13.27 13.27 0 01-.41-.72L4.56 10l.03-.04a15 15 0 012.08-2.9c1.48-1.6 3.6-3.12 6.33-3.12s4.85 1.53 6.33 3.12a15.01 15.01 0 012.08 2.9l.03.04-.03.04a15 15 0 01-2.08 2.9c-1.48 1.6-3.6 3.12-6.33 3.12s-4.85-1.53-6.33-3.12a15 15 0 01-1.66-2.18zm17.45-.98L22 10l.45.22-.01.02a14.3 14.3 0 01-.6 1.05c-.4.64-1 1.48-1.78 2.33-1.56 1.7-3.94 3.44-7.06 3.44s-5.5-1.75-7.06-3.44a16 16 0 01-2.23-3.1 9.39 9.39 0 01-.15-.28v-.02h-.01L4 10l-.45-.22.01-.02a5.59 5.59 0 01.15-.28 16 16 0 012.23-3.1C7.5 4.69 9.87 2.94 13 2.94c3.12 0 5.5 1.75 7.06 3.44a16 16 0 012.23 3.1 9.5 9.5 0 01.15.28v.01l.01.01zM22 10l.45-.22.1.22-.1.22L22 10zM3.55 9.78L4 10l-.45.22-.1-.22.1-.22zm6.8.22A2.6 2.6 0 0113 7.44 2.6 2.6 0 0115.65 10 2.6 2.6 0 0113 12.56 2.6 2.6 0 0110.35 10zM13 6.44A3.6 3.6 0 009.35 10c0 1.98 1.65 3.56 3.65 3.56s3.65-1.58 3.65-3.56A3.6 3.6 0 0013 6.44zM20 18c0-.42.1-.65.23-.77.12-.13.35-.23.77-.23.42 0 .65.1.77.23.13.12.23.35.23.77h1c0-.58-.14-1.1-.52-1.48-.38-.38-.9-.52-1.48-.52s-1.1.14-1.48.52c-.37.38-.52.9-.52 1.48v2h-1v1h1v2c0 .42-.1.65-.23.77-.12.13-.35.23-.77.23-.42 0-.65-.1-.77-.23-.13-.12-.23-.35-.23-.77h-1c0 .58.14 1.1.52 1.48.38.37.9.52 1.48.52s1.1-.14 1.48-.52c.37-.38.52-.9.52-1.48v-2h1v-1h-1v-2zm1.65 4.35l1.14 1.15-1.14 1.15.7.7 1.15-1.14 1.15 1.14.7-.7-1.14-1.15 1.14-1.15-.7-.7-1.15 1.14-1.15-1.14-.7.7z"></path></svg>
`,iconShowPositionAndOrders=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M4.5 10a8.46 8.46 0 0 0 .46.8c.38.6.94 1.4 1.68 2.19 1.48 1.6 3.62 3.13 6.36 3.13s4.88-1.53 6.36-3.13A15.07 15.07 0 0 0 21.5 10a7.41 7.41 0 0 0-.46-.8c-.38-.6-.94-1.4-1.68-2.19-1.48-1.6-3.62-3.13-6.36-3.13S8.12 5.4 6.64 7A15.07 15.07 0 0 0 4.5 10zM22 10l.41-.19-.4.19zm0 0l.41.19-.4-.19zm.41.19l.09-.19-.09-.19-.01-.02a6.86 6.86 0 0 0-.15-.28c-.1-.18-.25-.45-.45-.76-.4-.64-.99-1.48-1.77-2.32C18.47 4.74 16.11 3 13 3 9.89 3 7.53 4.74 5.97 6.43A15.94 15.94 0 0 0 3.6 9.79v.02h-.01L3.5 10l.09.19.01.02a6.59 6.59 0 0 0 .15.28c.1.18.25.45.45.76.4.64.99 1.48 1.77 2.32C7.53 15.26 9.89 17 13 17c3.11 0 5.47-1.74 7.03-3.43a15.94 15.94 0 0 0 2.37-3.36v-.02h.01zM4 10l-.41-.19.4.19zm9-2.63c-1.5 0-2.7 1.18-2.7 2.63s1.2 2.63 2.7 2.63c1.5 0 2.7-1.18 2.7-2.63S14.5 7.37 13 7.37zM9.4 10C9.4 8.07 11 6.5 13 6.5s3.6 1.57 3.6 3.5S15 13.5 13 13.5A3.55 3.55 0 0 1 9.4 10zm8.1 11.9l3.28 2.18a.5.5 0 1 1-.56.84L17.5 23.1l-2.72 1.82a.5.5 0 1 1-.56-.84l3.28-2.18zm1.78-2.82a.5.5 0 0 0-.56.84L22 22.1l3.28-2.18a.5.5 0 1 0-.56-.84L22 20.9l-2.72-1.82z"></path></svg>
`;var root_3$8=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_4$3=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_5$4=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_6$4=from_html('<div class="itemLabel svelte-1npdbq"> </div>'),root_2$7=from_html("<!> <!> <!> <!>",1),root_1$8=from_html('<div class="menu svelte-1npdbq"><!></div>');function VisibilityMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(Fe,"$icon",ee),se=()=>store_get(Ne,"$tip",ee),ae=()=>store_get(Ue,"$active",ee),le=()=>store_get(ze,"$hideDrawings",ee),ce=()=>store_get(He,"$hideIndicators",ee),he=()=>store_get(We,"$hidePositionsAndOrders",ee),fe=()=>store_get(je,"$hideAll",ee),{t:Ae}=useTranslation(),pe=useService(IChartManagementService),Oe=useService(IKeybindingsRegistry);let Fe=writable(iconShowAll),Ne=writable("tool.hide.hideAll");const ze=derived(pe.store,tr=>tr.hideBits===HideDrawingsBit),He=derived(pe.store,tr=>tr.hideBits===HideIndicatorsBit),We=derived(pe.store,tr=>tr.hideBits===HidePositionsAndOrdersBit),je=derived(pe.store,tr=>tr.hideBits===(HideDrawingsBit|HideIndicatorsBit|HidePositionsAndOrdersBit)),Ue=derived([ze,He,We,je],([tr,or,Jt,rr])=>{const lr=get$1(Fe);return!!(lr===iconHideAll&&rr||lr===iconHideDrawings&&tr||lr===iconHideIndicators&&or||lr===iconHidePositionsAndOrders&&Jt)}),Ge=()=>{const tr=get$1(Fe);(tr===iconHideAll||tr===iconShowAll)&&nr(),(tr===iconHideDrawings||tr===iconShowDrawings)&&Ze(),(tr===iconHideIndicators||tr===iconShowIndicators)&&Ye(),(tr===iconHidePositionsAndOrders||tr===iconShowPositionAndOrders)&&qe()},Ze=()=>{const tr=get$1(ze)?0:HideDrawingsBit;Fe.set(tr?iconHideDrawings:iconShowDrawings),Ne.set(tr?"tool.hide.showDrawing":"tool.hide.hideDrawing"),pe.setHideBits(tr)},Ye=()=>{const tr=get$1(He)?0:HideIndicatorsBit;Fe.set(tr?iconHideIndicators:iconShowIndicators),Ne.set(tr?"tool.hide.showIndicator":"tool.hide.hideIndicator"),pe.setHideBits(tr)},qe=()=>{const tr=get$1(We)?0:HidePositionsAndOrdersBit;Fe.set(tr?iconHidePositionsAndOrders:iconShowPositionAndOrders),Ne.set(tr?"tool.hide.showPosition":"tool.hide.hidePosition"),pe.setHideBits(tr)},nr=()=>{const tr=get$1(je)?0:HideDrawingsBit|HideIndicatorsBit|HidePositionsAndOrdersBit;Fe.set(tr?iconHideAll:iconShowAll),Ne.set(tr?"tool.hide.showAll":"tool.hide.hideAll"),pe.setHideBits(tr)},ir=KeyCode.KeyH|KeyMod.CtrlCmd|KeyMod.Alt;useDisposable(Oe.registerCommandAndKeybindingRule({id:"hides",primary:ir,weight:KeybindingWeight.ChartContrib,handler(){Ge()}})),init$1(),IconButton(ie,{get icon(){return re()},get tip(){return se()},get active(){return ae()},get keybinding(){return ir},moreTip:"tool.more.hide",onselect:Ge,negativeColor:!0,children:(tr,or)=>{var Jt=root_1$8(),rr=child(Jt);List(rr,{children:(lr,ur)=>{var Sr=root_2$7(),xr=first_child(Sr);Item(xr,{tag:"div",class:"item",get selected(){return le()},onpointerup:Ze,children:(dr,Cr)=>{var Or=root_3$8(),Ar=child(Or);template_effect(Ir=>set_text(Ar,Ir),[()=>Ae("tool.hide.hideDrawing")]),append(dr,Or)},$$slots:{default:!0}});var Pr=sibling(xr,2);Item(Pr,{tag:"div",class:"item",get selected(){return ce()},onpointerup:Ye,children:(dr,Cr)=>{var Or=root_4$3(),Ar=child(Or);template_effect(Ir=>set_text(Ar,Ir),[()=>Ae("tool.hide.hideIndicator")]),append(dr,Or)},$$slots:{default:!0}});var mr=sibling(Pr,2);Item(mr,{tag:"div",class:"item",get selected(){return he()},onpointerup:qe,children:(dr,Cr)=>{var Or=root_5$4(),Ar=child(Or);template_effect(Ir=>set_text(Ar,Ir),[()=>Ae("tool.hide.hidePosition")]),append(dr,Or)},$$slots:{default:!0}});var Er=sibling(mr,2);Item(Er,{tag:"div",class:"item",get selected(){return fe()},onpointerup:nr,children:(dr,Cr)=>{var Or=root_6$4(),Ar=child(Or);template_effect(Ir=>set_text(Ar,Ir),[()=>Ae("tool.hide.hideAll")]),append(dr,Or)},$$slots:{default:!0}}),append(lr,Sr)},$$slots:{default:!0}}),append(tr,Jt)},$$slots:{default:!0}}),pop(),ne()}const iconZoomOut=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path d="M17.646 18.354l4 4 .708-.708-4-4z"></path><path d="M12.5 21a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17zm0-1a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15z"></path><path d="M9 13h7v-1H9z"></path></svg>
`;var root$d=from_html("<!> <!>",1);function ZoomMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ce,"$activeType",ee),se=()=>store_get(he,"$canZoomOut",ee),ae=useService(IChartManagementService),le=useService(IToolService),ce=derived(le.store,Fe=>Fe.activeType),he=derived(ae.store,Fe=>{const{activeIndex:Ne}=Fe;return isFinite(Ne)?Fe.instances[Ne].viewports.length>0:!1});init$1();var fe=root$d(),Ae=first_child(fe);{let Fe=derived_safe_equal(()=>re()===zoomIn.type);IconButton(Ae,{tip:"tool.zoomIn",get icon(){return zoomIn.icon},get active(){return get$2(Fe)},onselect:()=>{le.switchTool(zoomIn.type)}})}var pe=sibling(Ae,2);{var Oe=Fe=>{IconButton(Fe,{tip:"tool.zoomOut",get icon(){return iconZoomOut},onselect:()=>{ae.activeChart().zoomFromViewport()}})};if_block(pe,Fe=>{se()&&Fe(Oe)})}append(ie,fe),pop(),ne()}const handleMouseOver=(ie,te)=>{te()},handleScrollTop=(ie,te,ee,ne)=>{te(Math.max(0,ee()-(ne.heightOuter-50)))},handleScrollBot=(ie,te,ee,ne)=>{te(Math.min(ee.heightInner-ee.heightOuter,ne()+(ee.heightOuter-50)))};var root_3$7=from_html("<div> </div>"),root_2$6=from_html('<button class="leftToggle svelte-sohzyr"><span><svg xmlns="http://www.w3.org/2000/svg" width="9" height="27" viewBox="0 0 9 27"><g fill="none" fill-rule="evenodd"><path class="background svelte-sohzyr" d="M4.5.5a4 4 0 0 1 4 4v18a4 4 0 1 1-8 0v-18a4 4 0 0 1 4-4z"></path><path class="arrow svelte-sohzyr" d="M5.5 10l-2 3.5 2 3.5"></path></g></svg></span></button> <!>',1),root$c=from_html('<div><div class="drawingToolbar svelte-sohzyr"><div class="content svelte-sohzyr"><!> <!> <div class="separator svelte-sohzyr"></div> <!> <!> <div class="separator svelte-sohzyr"></div> <!> <!> <!> <div class="separator svelte-sohzyr"></div> <!></div></div> <div><div class="iconWrap svelte-sohzyr"><!></div></div> <div><div class="iconWrap"><!></div></div> <!></div>');function Left(ie,te){push(te,!0);const ee=[CursorTools,LineTools,FibAndGannTools,PatternTools,MeasureTools,ShapesTools,AnnotationTools],{t:ne}=useTranslation(),re=useService(IChartManagementService);let se=state(!1);const ae=proxy({heightOuter:0,heightInner:0,isTopButtonVisible:!1,isBotButtonVisible:!1});let le,ce;const he=()=>le.scrollTop,fe=()=>he()<=1,Ae=()=>he()+ae.heightOuter>=ae.heightInner-1,pe=()=>{const{isTopButtonVisible:mr,isBotButtonVisible:Er}=ae,dr=fe(),Cr=Ae();!dr&&!mr?ae.isTopButtonVisible=!0:dr&&Er&&(ae.isTopButtonVisible=!1),!Cr&&!Er?ae.isBotButtonVisible=!0:Cr&&Er&&(ae.isBotButtonVisible=!1)},Oe=mr=>{ae.heightOuter=mr.height},Fe=mr=>{ae.heightInner=mr.height},Ne=()=>{pe()},ze=(mr,Er=350)=>{le&&doAnimate({onStep:(dr,Cr)=>{le.scrollTop=Cr},from:le.scrollTop,to:Math.round(mr),easing:easingFunc.easeInOutCubic,duration:Er})},He=()=>{set(se,!get$2(se)),get$2(se)?ce.classList.add("collapsed"):ce.classList.remove("collapsed"),re.autoResizeNow()};onMount(()=>{pe()}),onDestroy(()=>{ce=null,le=null});var We=root$c(),je=child(We);je.__mouseover=[handleMouseOver,pe];var Ue=child(je),Ge=child(Ue);each(Ge,17,()=>ee,index,(mr,Er)=>{ToolMenu(mr,{get groups(){return get$2(Er).groups},get moreTip(){return get$2(Er).moreTip}})});var Ze=sibling(Ge,2);IconsMenu(Ze,{});var Ye=sibling(Ze,4);MeasureMenu(Ye,{});var qe=sibling(Ye,2);ZoomMenu(qe,{});var nr=sibling(qe,4);MagnetMenu(nr,{});var ir=sibling(nr,2);KeepDrawingMenu(ir,{});var tr=sibling(ir,2);VisibilityMenu(tr,{});var or=sibling(tr,4);RemoveMenu(or,{}),bind_this(je,mr=>le=mr,()=>le);var Jt=sibling(je,2);Jt.__pointerup=[handleScrollTop,ze,he,ae];var rr=child(Jt),lr=child(rr);html(lr,()=>Chevron);var ur=sibling(Jt,2);ur.__pointerup=[handleScrollBot,ze,ae,he];var Sr=child(ur),xr=child(Sr);html(xr,()=>Chevron);var Pr=sibling(ur,2);Wrapper(Pr,{children:(mr,Er)=>{var dr=root_2$6(),Cr=first_child(dr);Cr.__pointerup=He;var Or=child(Cr),Ar=child(Or),Ir=sibling(Cr,2);Tooltip(Ir,{xPos:"side_end",yPos:"side",children:(wr,Dr)=>{var Ur=root_3$7(),zr=child(Ur);template_effect(Fr=>set_text(zr,Fr),[()=>ne(get$2(se)?"drawingBar.show":"drawingBar.hide")]),append(wr,Ur)},$$slots:{default:!0}}),template_effect(()=>set_class(Ar,0,clsx(["container",get$2(se)&&"mirror"]),"svelte-sohzyr")),append(mr,dr)},$$slots:{default:!0}}),bind_this(We,mr=>ce=mr,()=>ce),template_effect(()=>{set_class(We,1,clsx(["left",get$2(se)&&"collapsed"]),"svelte-sohzyr"),set_class(Jt,1,clsx(["scrollBtn","scrollTop",ae.isTopButtonVisible&&ae.heightInner>ae.heightOuter&&"isVisible"]),"svelte-sohzyr"),set_class(ur,1,clsx(["scrollBtn","scrollBot",ae.isBotButtonVisible&&ae.heightInner>ae.heightOuter&&"isVisible"]),"svelte-sohzyr")}),event("scroll",je,Ne),bind_resize_observer(Ue,"contentRect",Fe),bind_resize_observer(je,"contentRect",Oe),append(ie,We),pop()}delegate(["mouseover","pointerup"]);var on_pointerup$3=(ie,te)=>get$2(te).setOpen(!0),root_2$5=from_html("<div> </div>"),root_1$7=from_html('<button class="chartStyle svelte-1pwlia1"><!></button> <!>',1),root_6$3=from_html('<span class="rowIcon svelte-1pwlia1"><!></span> <span class="rowLabel svelte-1pwlia1"> </span>',1),root_3$6=from_html('<div class="styleMenu svelte-1pwlia1"><!></div>'),root$b=from_html("<div><!> <!></div>");function ChartStyle(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(Ae,"$currentStyle",ee),se=()=>store_get(pe,"$label",ee),ae=()=>store_get(fe,"$disabled",ee),{t:le}=useTranslation(),ce=useService(IChartManagementService),he=chartStylePreset,fe=derived(ce.store,He=>{const{activeIndex:We}=He;return isFinite(We)?He.instances[We].dataStatus<ChartDataStatus.symbolInfoResolved:!0}),Ae=derived(ce.store,He=>{const{activeIndex:We}=He;if(!isFinite(We))return null;const je=He.instances[We].chartProperties["mainSeriesProperties.style"];return chartStyleRegistry.value(je)}),pe=derived(Ae,He=>He==null?void 0:He.label);let Oe=mutable_source();onDestroy(()=>{set(Oe,null)}),init$1();var Fe=root$b(),Ne=child(Fe);Wrapper(Ne,{children:(He,We)=>{var je=root_1$7(),Ue=first_child(je);Ue.__pointerup=[on_pointerup$3,Oe];var Ge=child(Ue);html(Ge,()=>{var Ye;return(Ye=re())==null?void 0:Ye.icon});var Ze=sibling(Ue,2);Tooltip(Ze,{children:(Ye,qe)=>{var nr=root_2$5(),ir=child(nr);template_effect(tr=>set_text(ir,tr),[()=>le(se())]),append(Ye,nr)},$$slots:{default:!0}}),append(He,je)},$$slots:{default:!0}});var ze=sibling(Ne,2);bind_this(Menu(ze,{anchorCorner:"BOTTOM_LEFT",quickOpen:!0,class:"cl-dropdown",children:(He,We)=>{var je=root_3$6(),Ue=child(je);List(Ue,{children:(Ge,Ze)=>{var Ye=comment(),qe=first_child(Ye);each(qe,1,()=>he,index,(nr,ir)=>{{let tr=derived_safe_equal(()=>{var Jt;return get$2(ir).id===((Jt=re())==null?void 0:Jt.id)}),or=derived_safe_equal(()=>{var Jt;return clsx$1("row",get$2(ir).id===((Jt=re())==null?void 0:Jt.id)&&"selected",ae()&&"disabled")});Item(nr,{tag:"div",get disabled(){return ae()},get selected(){return get$2(tr)},get class(){return get$2(or)},onpointerup:()=>{ae()||ce.activeChart().setChartType(get$2(ir).id)},children:(Jt,rr)=>{var lr=root_6$3(),ur=first_child(lr),Sr=child(ur);html(Sr,()=>get$2(ir).icon);var xr=sibling(ur,2),Pr=child(xr);template_effect(mr=>set_text(Pr,mr),[()=>le(get$2(ir).label)]),append(Jt,lr)},$$slots:{default:!0}})}}),append(Ge,Ye)},$$slots:{default:!0}}),append(He,je)},$$slots:{default:!0},$$legacy:!0}),He=>set(Oe,He),()=>get$2(Oe)),append(ie,Fe),pop(),ne()}delegate(["pointerup"]);var on_pointerup$2=(ie,te,ee)=>{var ne;return(ne=ee.onClick)==null?void 0:ne.call(ee)},root_2$4=from_html("<span> </span>"),root_4$2=from_html("<div> </div>"),root_1$6=from_html('<button class="customButton svelte-1pu4aed"><!></button> <!>',1),root$a=from_html("<div><!></div>");function CustomButton(ie,te){push(te,!0);const ee=rest_props(te,["$$slots","$$events","$$legacy"]),ne=useService(IGuiService);let re;onMount(()=>{ne.setButtonReady(te.id,re)}),onDestroy(()=>{re=null});var se=root$a(),ae=child(se);Wrapper(ae,{children:(le,ce)=>{var he=root_1$6(),fe=first_child(he);fe.__pointerup=[on_pointerup$2,ee,te];var Ae=child(fe);{var pe=Ne=>{var ze=root_2$4(),He=child(ze);template_effect(()=>set_text(He,te.text)),append(Ne,ze)};if_block(Ae,Ne=>{te.text&&Ne(pe)})}bind_this(fe,Ne=>re=Ne,()=>re);var Oe=sibling(fe,2);{var Fe=Ne=>{Tooltip(Ne,{children:(ze,He)=>{var We=root_4$2(),je=child(We);template_effect(()=>set_text(je,te.title)),append(ze,We)},$$slots:{default:!0}})};if_block(Oe,Ne=>{te.title&&Ne(Fe)})}append(le,he)},$$slots:{default:!0}}),append(ie,se),pop()}delegate(["pointerup"]);var root_1$5=from_html('<button class="fullscreen svelte-eor01u"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" class="svelte-eor01u"><path fill="currentColor" d="M8.5 6A2.5 2.5 0 0 0 6 8.5V11h1V8.5C7 7.67 7.67 7 8.5 7H11V6H8.5zM6 17v2.5A2.5 2.5 0 0 0 8.5 22H11v-1H8.5A1.5 1.5 0 0 1 7 19.5V17H6zM19.5 7H17V6h2.5A2.5 2.5 0 0 1 22 8.5V11h-1V8.5c0-.83-.67-1.5-1.5-1.5zM22 19.5V17h-1v2.5c0 .83-.67 1.5-1.5 1.5H17v1h2.5a2.5 2.5 0 0 0 2.5-2.5z"></path></svg></button> <!>',1),root$9=from_html("<div><!></div>");function Fullscreen(ie,te){push(te,!1);const{t:ee}=useTranslation(),ne=KeyCode.KeyF|KeyMod.Shift,re=useService(IChartManagementService),se=useService(IKeybindingsRegistry),ae=()=>{const he=re.getDomElement();if(!he)return;(he.requestFullscreen??he.webkitRequestFullscreen??he.mozRequestFullScreen??he.msRequestFullscreen).call(he)};useDisposable(se.registerCommandAndKeybindingRule({id:"ui.fullscreen",primary:ne,weight:KeybindingWeight.WorkbenchContrib,handler:()=>{ae()}})),init$1();var le=root$9(),ce=child(le);Wrapper(ce,{children:(he,fe)=>{var Ae=root_1$5(),pe=first_child(Ae);pe.__pointerup=ae;var Oe=sibling(pe,2);Tooltip(Oe,{children:(Fe,Ne)=>{{let ze=derived_safe_equal(()=>ee("topToolbar.fullscreen"));TooltipContent(Fe,{get content(){return get$2(ze)},get keybinding(){return ne}})}},$$slots:{default:!0}}),append(he,Ae)},$$slots:{default:!0}}),append(ie,le),pop()}delegate(["pointerup"]);function compareAnything(ie,te,ee){const ne=ie.toLowerCase(),re=te.toLowerCase(),se=compareByPrefix(ie,te,ee);if(se)return se;const ae=ne.endsWith(ee),le=re.endsWith(ee);return ae!==le?ae?-1:1:ne.localeCompare(re)}function compareByPrefix(ie,te,ee){const ne=ie.toLowerCase(),re=te.toLowerCase(),se=ne.startsWith(ee),ae=re.startsWith(ee);if(se!==ae)return se?-1:1;if(se&&ae){if(ne.length<re.length)return-1;if(ne.length>re.length)return 1}return 0}const matchesPrefix=_matchesPrefix.bind(void 0,!0);function _matchesPrefix(ie,te,ee){if(!ee||ee.length<te.length)return null;let ne;return ie?ne=startsWithIgnoreCase(ee,te):ne=ee.indexOf(te)===0,ne?te.length>0?[{start:0,end:te.length}]:[]:null}function isUpper(ie){return CharCode.A<=ie&&ie<=CharCode.Z}const wordSeparators=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(ie=>wordSeparators.add(ie.charCodeAt(0)));const _maxLen=128;function initTable(){const ie=[],te=[];for(let ee=0;ee<=_maxLen;ee++)te[ee]=0;for(let ee=0;ee<=_maxLen;ee++)ie.push(te.slice(0));return ie}initTable();initTable();initTable();var FuzzyScore;(ie=>{ie.Default=[-100,0];function te(ee){return!ee||ee.length===2&&ee[0]===-100&&ee[1]===0}ie.isDefault=te})(FuzzyScore||(FuzzyScore={}));function hash(ie){return doHash(ie,0)}function doHash(ie,te){switch(typeof ie){case"object":return ie===null?numberHash(349,te):Array.isArray(ie)?arrayHash(ie,te):objectHash(ie,te);case"string":return stringHash(ie,te);case"boolean":return booleanHash(ie,te);case"number":return numberHash(ie,te);case"undefined":return numberHash(937,te);default:return numberHash(617,te)}}function numberHash(ie,te){return(te<<5)-te+ie|0}function booleanHash(ie,te){return numberHash(ie?433:863,te)}function stringHash(ie,te){te=numberHash(149417,te);for(let ee=0,ne=ie.length;ee<ne;ee++)te=numberHash(ie.charCodeAt(ee),te);return te}function arrayHash(ie,te){return te=numberHash(104579,te),ie.reduce((ee,ne)=>doHash(ne,ee),te)}function objectHash(ie,te){return te=numberHash(181387,te),Object.keys(ie).sort().reduce((ee,ne)=>(ee=stringHash(ne,ee),doHash(ie[ne],ee)),te)}const NO_MATCH=0,NO_SCORE=[NO_MATCH,[]];function scoreFuzzy(ie,te,ee,ne){if(!ie||!te)return NO_SCORE;const re=ie.length,se=te.length;if(re<se)return NO_SCORE;const ae=ie.toLowerCase();return doScoreFuzzy(te,ee,se,ie,ae,re,ne)}function doScoreFuzzy(ie,te,ee,ne,re,se,ae){const le=[],ce=[];for(let pe=0;pe<ee;pe++){const Oe=pe*se,Fe=Oe-se,Ne=pe>0,ze=ie[pe],He=te[pe];for(let We=0;We<se;We++){const je=We>0,Ue=Oe+We,Ge=Ue-1,Ze=Fe+We-1,Ye=je?le[Ge]:0,qe=Ne&&je?le[Ze]:0,nr=Ne&&je?ce[Ze]:0;let ir;!qe&&Ne?ir=0:ir=computeCharScore(ze,He,ne,re,We,nr),ir&&qe+ir>=Ye&&(ae||Ne||re.startsWith(te,We))?(ce[Ue]=nr+1,le[Ue]=qe+ir):(ce[Ue]=NO_MATCH,le[Ue]=Ye)}}const he=[];let fe=ee-1,Ae=se-1;for(;fe>=0&&Ae>=0;){const pe=fe*se+Ae;ce[pe]===NO_MATCH||(he.push(Ae),fe--),Ae--}return[le[ee*se-1],he.reverse()]}function computeCharScore(ie,te,ee,ne,re,se){let ae=0;if(!considerAsEqual(te,ne[re]))return ae;if(ae+=1,se>0&&(ae+=se*5),ie===ee[re]&&(ae+=1),re===0)ae+=8;else{const le=scoreSeparatorAtPos(ee.charCodeAt(re-1));le?ae+=le:isUpper(ee.charCodeAt(re))&&se===0&&(ae+=2)}return ae}function considerAsEqual(ie,te){return ie===te?!0:ie==="/"||ie==="\\"?te==="/"||te==="\\":!1}function scoreSeparatorAtPos(ie){switch(ie){case CharCode.Slash:case CharCode.Backslash:return 5;case CharCode.Underline:case CharCode.Dash:case CharCode.Period:case CharCode.Space:case CharCode.SingleQuote:case CharCode.DoubleQuote:case CharCode.Colon:return 4;default:return 0}}const NO_ITEM_SCORE=Object.freeze({score:0}),LABEL_PREFIX_SCORE_THRESHOLD=1<<17,LABEL_SCORE_THRESHOLD=65536;function getCacheHash(ie,te,ee,ne){const re=ne.values?ne.values:[ne];return hash({[ne.normalized]:{values:re.map(ae=>({value:ae.normalized,expectContiguousMatch:ae.expectContiguousMatch})),label:ie,description:te,allowNonContiguousMatches:ee}})}function scoreItemFuzzy(ie,te,ee,ne,re){if(!ie||!te.normalized)return NO_ITEM_SCORE;const se=ne.getItemLabel(ie);if(!se)return NO_ITEM_SCORE;const ae=ne.getItemDescription(ie),le=getCacheHash(se,ae,ee,te),ce=re[le];if(ce)return ce;const he=doScoreItemFuzzy(se,ae,te);return re[le]=he,he}function doScoreItemFuzzy(ie,te,ee,ne){return ee.values&&ee.values.length>1?doScoreItemFuzzyMultiple(ie,te,ee.values):doScoreItemFuzzySingle(ie,te,ee)}function doScoreItemFuzzyMultiple(ie,te,ee,ne,re){let se=0;const ae=[],le=[];for(const ce of ee){const{score:he,labelMatch:fe,descriptionMatch:Ae}=doScoreItemFuzzySingle(ie,te,ce);if(he===NO_MATCH)return NO_ITEM_SCORE;se+=he,fe&&ae.push(...fe),Ae&&le.push(...Ae)}return{score:se,labelMatch:normalizeMatches(ae),descriptionMatch:normalizeMatches(le)}}function doScoreItemFuzzySingle(ie,te,ee,ne,re){{const[se,ae]=scoreFuzzy(ie,ee.normalized,ee.normalizedLowercase,!ee.expectContiguousMatch);if(se){const le=matchesPrefix(ee.normalized,ie);let ce;if(le){ce=LABEL_PREFIX_SCORE_THRESHOLD;const he=Math.round(ee.normalized.length/ie.length*100);ce+=he}else ce=LABEL_SCORE_THRESHOLD;return{score:ce+se,labelMatch:le||createMatches(ae)}}}if(te){const se=te,ae=se.length,le=`${se}${ie}`,[ce,he]=scoreFuzzy(le,ee.normalized,ee.normalizedLowercase,!ee.expectContiguousMatch);if(ce){const fe=createMatches(he),Ae=[],pe=[];return fe.forEach(Oe=>{Oe.start<ae&&Oe.end>ae?(Ae.push({start:0,end:Oe.end-ae}),pe.push({start:Oe.start,end:ae})):Oe.start>=ae?Ae.push({start:Oe.start-ae,end:Oe.end-ae}):pe.push(Oe)}),{score:ce,labelMatch:Ae,descriptionMatch:pe}}}return NO_ITEM_SCORE}function createMatches(ie){const te=[];if(!ie)return te;let ee;for(const ne of ie)ee&&ee.end===ne?ee.end+=1:(ee={start:ne,end:ne+1},te.push(ee));return te}function normalizeMatches(ie){const te=ie.sort((re,se)=>re.start-se.start),ee=[];let ne;for(const re of te)!ne||!matchOverlaps(ne,re)?(ne=re,ee.push(re)):(ne.start=Math.min(ne.start,re.start),ne.end=Math.max(ne.end,re.end));return ee}function matchOverlaps(ie,te){return!(ie.end<te.start||te.end<ie.start)}function compareItemsByFuzzyScore(ie,te,ee,ne,re,se){const ae=scoreItemFuzzy(ie,ee,ne,re,se),le=scoreItemFuzzy(te,ee,ne,re,se),ce=ae.score,he=le.score;if(ce>LABEL_SCORE_THRESHOLD||he>LABEL_SCORE_THRESHOLD){if(ce!==he)return ce>he?-1:1;if(ce<LABEL_PREFIX_SCORE_THRESHOLD&&he<LABEL_PREFIX_SCORE_THRESHOLD){const ze=compareByMatchLength(ae.labelMatch,le.labelMatch);if(ze!==0)return ze}const Fe=re.getItemLabel(ie)||"",Ne=re.getItemLabel(te)||"";if(Fe.length!==Ne.length)return Fe.length-Ne.length}if(ce!==he)return ce>he?-1:1;const fe=Array.isArray(ae.labelMatch)&&ae.labelMatch.length>0,Ae=Array.isArray(le.labelMatch)&&le.labelMatch.length>0;if(fe&&!Ae)return-1;if(Ae&&!fe)return 1;const pe=computeLabelAndDescriptionMatchDistance(ie,ae,re),Oe=computeLabelAndDescriptionMatchDistance(te,le,re);return pe&&Oe&&pe!==Oe?Oe>pe?-1:1:fallbackCompare(ie,te,ee,re)}function computeLabelAndDescriptionMatchDistance(ie,te,ee){let ne=-1,re=-1;if(te.descriptionMatch&&te.descriptionMatch.length?ne=te.descriptionMatch[0].start:te.labelMatch&&te.labelMatch.length&&(ne=te.labelMatch[0].start),te.labelMatch&&te.labelMatch.length){if(re=te.labelMatch[te.labelMatch.length-1].end,te.descriptionMatch&&te.descriptionMatch.length){const se=ee.getItemDescription(ie);se&&(re+=se.length)}}else te.descriptionMatch&&te.descriptionMatch.length&&(re=te.descriptionMatch[te.descriptionMatch.length-1].end);return re-ne}function compareByMatchLength(ie,te){if(!ie&&!te||(!ie||!ie.length)&&(!te||!te.length))return 0;if(!te||!te.length)return-1;if(!ie||!ie.length)return 1;const ee=ie[0].start,re=ie[ie.length-1].end-ee,se=te[0].start,le=te[te.length-1].end-se;return re===le?0:le<re?1:-1}function fallbackCompare(ie,te,ee,ne){const re=ne.getItemLabel(ie)||"",se=ne.getItemLabel(te)||"",ae=ne.getItemDescription(ie),le=ne.getItemDescription(te),ce=re.length+(ae?ae.length:0),he=se.length+(le?le.length:0);return ce!==he?ce-he:re!==se?compareAnything(re,se,ee.normalized):ae&&le&&ae!==le?compareAnything(ae,le,ee.normalized):0}function queryExpectsExactMatch(ie){return ie.startsWith('"')&&ie.endsWith('"')}const MULTIPLE_QUERY_VALUES_SEPARATOR=" ";function prepareQuery(ie){typeof ie!="string"&&(ie="");const te=ie.toLowerCase(),{normalized:ee,normalizedLowercase:ne}=normalizeQuery(ie),re=!1,se=queryExpectsExactMatch(ie);let ae;const le=ie.split(MULTIPLE_QUERY_VALUES_SEPARATOR);if(le.length>1)for(const ce of le){const he=queryExpectsExactMatch(ce),{normalized:fe,normalizedLowercase:Ae}=normalizeQuery(ce);fe&&(ae||(ae=[]),ae.push({original:ce,originalLowercase:ce.toLowerCase(),normalized:fe,normalizedLowercase:Ae,expectContiguousMatch:he}))}return{original:ie,originalLowercase:te,normalized:ee,normalizedLowercase:ne,values:ae,containsPathSeparator:re,expectContiguousMatch:se}}function normalizeQuery(ie){const te=stripWildcards(ie).replace(/\s|"/g,"");return{normalized:te,normalizedLowercase:te.toLowerCase()}}const ao={id:"ao",name:"Awesome Oscillator",abbr:"AO",overlap:!1,optionInfos:[{name:"shortPeriod",displayName:"Short Period",defaultValue:5,type:"Integer",range:{min:2,max:1e5}},{name:"longPeriod",displayName:"Long Period",defaultValue:5,type:"Integer",range:{min:2,max:1e5}}],styleValues:{styles:{output:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"}}},cal:(ie,te=Object.create(null))=>{const ee=te;ao.optionInfos.forEach(ce=>{ee[ce.name]=ce.defaultValue});const ne=Math.max(ee.shortPeriod,ee.longPeriod);let re=0,se=0,ae=0,le=0;return ie.map((ce,he)=>{const fe=Object.create(null);fe.time=ce.time;const Ae=(ce.customValues.low+ce.customValues.high)/2;if(re+=Ae,se+=Ae,he>=ee.shortPeriod-1){ae=re/ee.shortPeriod;const pe=ie[he-(ee.shortPeriod-1)];re-=(pe.customValues.low+pe.customValues.high)/2}if(he>=ee.longPeriod-1){le=se/ee.longPeriod;const pe=ie[he-(ee.longPeriod-1)];se-=(pe.customValues.low+pe.customValues.high)/2}return he>=ne-1&&(fe.study={output:ae-le}),fe})}},bbi={id:"bbi",name:"Bull And Bear Index",abbr:"BBI",overlap:!0,optionInfos:[{name:"n1",displayName:"N1",defaultValue:3,type:"Integer",range:{min:2,max:1e5}},{name:"n2",displayName:"N2",defaultValue:6,type:"Integer",range:{min:2,max:1e5}},{name:"n3",displayName:"N3",defaultValue:12,type:"Integer",range:{min:2,max:1e5}},{name:"n4",displayName:"N4",defaultValue:6,type:"Integer",range:{min:2,max:1e5}}],styleValues:{styles:{output:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"}}},cal:(ie,te=Object.create(null))=>{const ee=te;bbi.optionInfos.forEach(ae=>{ee[ae.name]=ae.defaultValue});const ne=Math.max(ee.n1,ee.n2,ee.n3,ee.n4),re=[],se=[];return ie.map((ae,le)=>{const ce=Object.create(null);ce.time=ae.time;const he=ae.customValues.close;if([ee.n1,ee.n2,ee.n3,ee.n4].forEach((fe,Ae)=>{re[Ae]=(re[Ae]??0)+he,le>=fe-1&&(se[Ae]=re[Ae]/fe,re[Ae]-=ie[le-(fe-1)].customValues.close)}),le>=ne-1){let fe=0;se.forEach(Ae=>{fe+=Ae}),ce.study={output:fe/4}}return ce})}},bias={id:"bias",name:"Bias Ratio(Price Oscillator)",abbr:"BIAS",overlap:!1,optionInfos:[],styleValues:{styles:{bias6:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},bias12:{linewidth:1,plottype:0,color:"rgb(8, 153, 129)"},bias24:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"}}},cal:ie=>{const te=[];return ie.map((ee,ne)=>{const re=Object.create(null);re.time=ee.time;const se=ee.customValues.close;return[6,12,24].forEach((ae,le)=>{if(te[le]=(te[le]??0)+se,ne>=ae-1){re.study=re.study||{};const ce=te[le]/ae;re.study[`bias${ae}`]=(se-ce)/ce*100,te[le]-=ie[ne-(ae-1)].customValues.close}}),re})}},brar={id:"brar",name:"BRAR",abbr:"BRAR",overlap:!1,optionInfos:[],styleValues:{styles:{br:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},ar:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"}}},cal:ie=>{const te=[26];let ee=0,ne=0,re=0,se=0;return ie.map((ae,le)=>{const ce=Object.create(null);ce.time=ae.time;const he=ae.customValues.high,fe=ae.customValues.low,Ae=ae.customValues.open,pe=(ie[le-1]??ae).customValues.close;if(re+=he-Ae,se+=Ae-fe,ee+=he-pe,ne+=pe-fe,le>=te[0]-1){ce.study=ce.study||{},se!==0?ce.study.ar=re/se*100:ce.study.ar=0,ne!==0?ce.study.br=ee/ne*100:ce.study.br=0;const Oe=ie[le-(te[0]-1)],Fe=Oe.customValues.high,Ne=Oe.customValues.low,ze=Oe.customValues.open,He=(ie[le-te[0]]??ie[le-(te[0]-1)]).customValues.close;ee-=Fe-He,ne-=He-Ne,re-=Fe-ze,se-=ze-Ne}return ce})}},cr={id:"cr",name:"CR",abbr:"CR",overlap:!1,optionInfos:[],styleValues:{styles:{cr:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},ma1:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"},ma2:{linewidth:1,plottype:0,color:"rgb(36,214,200)"},ma3:{linewidth:1,plottype:0,color:"rgb(255,38,0)"},ma4:{linewidth:1,plottype:0,color:"rgb(255,0,242)"}}},cal:ie=>{const te=[26,10,20,40,60],ee=Math.ceil(te[1]/2.5+1),ne=Math.ceil(te[2]/2.5+1),re=Math.ceil(te[3]/2.5+1),se=Math.ceil(te[4]/2.5+1);let ae=0;const le=[];let ce=0;const he=[];let fe=0;const Ae=[];let pe=0;const Oe=[],Fe=[];return ie.forEach((Ne,ze)=>{var Ze,Ye,qe;const He=Object.create(null);He.time=Ne.time;const We=ie[ze-1]??Ne,je=(We.customValues.high+We.customValues.close+We.customValues.low+We.customValues.open)/4,Ue=Math.max(0,Ne.customValues.high-je),Ge=Math.max(0,je-Ne.customValues.low);ze>=te[0]-1&&(He.study=He.study||{},Ge!==0?He.study.cr=Ue/Ge*100:He.study.cr=0,ae+=He.study.cr,ce+=He.study.cr,fe+=He.study.cr,pe+=He.study.cr,ze>=te[0]+te[1]-2&&(le.push(ae/te[1]),ze>=te[0]+te[1]+ee-3&&(He.study.ma1=le[le.length-1-ee]),ae-=((Ze=Fe[ze-(te[1]-1)].study)==null?void 0:Ze.cr)??0),ze>=te[0]+te[2]-2&&(he.push(ce/te[2]),ze>=te[0]+te[2]+ne-3&&(He.study.ma2=he[he.length-1-ne]),ce-=((Ye=Fe[ze-(te[2]-1)].study)==null?void 0:Ye.cr)??0),ze>=te[0]+te[3]-2&&(Ae.push(fe/te[3]),ze>=te[0]+te[3]+re-3&&(He.study.ma3=Ae[Ae.length-1-re]),fe-=Fe[ze-(te[3]-1)].study.cr??0),ze>=te[0]+te[4]-2&&(Oe.push(pe/te[4]),ze>=te[0]+te[4]+se-3&&(He.study.ma4=Oe[Oe.length-1-se]),pe-=((qe=Fe[ze-(te[4]-1)].study)==null?void 0:qe.cr)??0)),Fe.push(He)}),Fe}},emv={id:"emv",name:"Ease of Movement Value",abbr:"EMV",overlap:!1,optionInfos:[],styleValues:{styles:{emv:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},maEmv:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"}}},cal:ie=>{const te=[14,9];let ee=0;const ne=[];return ie.map((re,se)=>{const ae=Object.create(null);if(ae.time=re.time,se>0){const le=ie[se-1],ce=re.customValues.high,he=re.customValues.low,fe=re.customValues.volume??0,Ae=(ce+he)/2-(le.customValues.high+le.customValues.low)/2;if(ae.study=ae.study||{},fe===0||ce-he===0)ae.study.emv=0;else{const pe=fe/1e8/(ce-he);ae.study.emv=Ae/pe}ee+=ae.study.emv,ne.push(ae.study.emv),se>=te[0]&&(ae.study.maEmv=ee/te[0],ee-=ne[se-te[0]])}return ae})}},kdj={id:"kdj",name:"KDJ",abbr:"KDJ",overlap:!1,optionInfos:[],styleValues:{styles:{k:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"},d:{linewidth:1,plottype:0,color:"#A77DC9"},j:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"}}},cal:ie=>{const te=[9,3,3],ee=[];return ie.forEach((ne,re)=>{var le,ce,he,fe;const se=Object.create(null);se.time=ne.time;const ae=ne.customValues.close;if(re>=te[0]-1){const Ae=getMaxMin(ie.slice(re-(te[0]-1),re+1),"high","low"),pe=Ae[0],Oe=Ae[1],Fe=pe-Oe,Ne=(ae-Oe)/(Fe===0?1:Fe)*100,ze=((te[1]-1)*(((ce=(le=ee[re-1])==null?void 0:le.study)==null?void 0:ce.k)??50)+Ne)/te[1],He=((te[2]-1)*(((fe=(he=ee[re-1])==null?void 0:he.study)==null?void 0:fe.d)??50)+ze)/te[2],We=3*ze-2*He;se.study={k:ze,d:He,j:We}}ee.push(se)}),ee}};function getMaxMin(ie,te,ee){const ne=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],re=ie.length;let se=0;for(;se<re;){const ae=ie[se];ne[0]=Math.max(ae.customValues[te]??Number.MIN_SAFE_INTEGER,ne[0]),ne[1]=Math.min(ae.customValues[ee]??Number.MAX_SAFE_INTEGER,ne[1]),++se}return ne}const mtm={id:"mtm",name:"Momentum Index",abbr:"MTM",overlap:!1,optionInfos:[],styleValues:{styles:{mtm:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},maMtm:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"}}},cal:ie=>{const te=[12,6];let ee=0;const ne=[];return ie.forEach((re,se)=>{var le,ce;const ae=Object.create(null);if(ae.time=re.time,se>=te[0]){const he=re.customValues.close,fe=ie[se-te[0]].customValues.close,Ae=he-fe;ee+=Ae,ae.study={mtm:Ae},se>=te[0]+te[1]-1&&(ae.study.maMtm=ee/te[1],ee-=((ce=(le=ne[se-(te[1]-1)])==null?void 0:le.study)==null?void 0:ce.mtm)??0)}ne.push(ae)}),ne}},psy={id:"psy",name:"Psychological Line",abbr:"PSY",overlap:!1,optionInfos:[],styleValues:{styles:{psy:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},maPsy:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"}}},cal:ie=>{const te=[12,6],ee=[];let ne=0,re=0;const se=[];return ie.forEach((ae,le)=>{var Ae;const ce=Object.create(null);ce.time=ae.time;const he=(ie[le-1]??ae).customValues.close,fe=ae.customValues.close-he>0?1:0;if(se.push(fe),ne+=fe,le>=te[0]-1){const pe=ne/te[0]*100;re+=pe,ce.study={psy:pe},le>=te[0]+te[1]-2&&(ce.study.maPsy=re/te[1],re-=((Ae=ee[le-(te[1]-1)].study)==null?void 0:Ae.psy)??0),ne-=se[le-(te[0]-1)]}ee.push(ce)}),ee}},pvt={id:"pvt",name:"Price and Volume Trend",abbr:"PVT",overlap:!1,optionInfos:[],styleValues:{styles:{output:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"}}},cal:ie=>{let te=0;return ie.map((ee,ne)=>{const re=Object.create(null);re.time=ee.time;const se=ee.customValues.close,ae=ee.customValues.volume??1,le=(ie[ne-1]??ee).customValues.close;let ce=0;const he=le*ae;return he!==0&&(ce=(se-le)/he),te+=ce,re.study={output:te},re})}},vr={id:"vr",name:"Volatility Volume Ratio",abbr:"VR",overlap:!1,optionInfos:[],styleValues:{styles:{vr:{linewidth:1,plottype:0,color:"rgb(41, 98, 255)"},maVr:{linewidth:1,plottype:0,color:"rgb(255, 152, 0)"}}},cal:ie=>{const te=[26,6],ee=[];let ne=0,re=0,se=0,ae=0;return ie.forEach((le,ce)=>{var Oe;const he=Object.create(null);he.time=le.time;const fe=le.customValues.close,Ae=(ie[ce-1]??le).customValues.close,pe=le.customValues.volume??0;if(fe>Ae?ne+=pe:fe<Ae?re+=pe:se+=pe,ce>=te[0]-1){const Fe=se/2;he.study={},re+Fe===0?he.study.vr=0:he.study.vr=(ne+Fe)/(re+Fe)*100,ae+=he.study.vr,ce>=te[0]+te[1]-2&&(he.study.maVr=ae/te[1],ae-=((Oe=ee[ce-(te[1]-1)].study)==null?void 0:Oe.vr)??0);const Ne=ie[ce-(te[0]-1)],ze=ie[ce-te[0]]??Ne,He=Ne.customValues.close,We=Ne.customValues.volume??0;He>ze.customValues.close?ne-=We:He<ze.customValues.close?re-=We:se-=We}ee.push(he)}),ee}},json=JSON.parse(`[{"name":"ACCBANDS","camelCaseName":"accBands","group":"Overlap Studies","description":"Acceleration Bands","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":20,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"upperBand","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(242, 54, 69)","title":"upperBand"}},{"name":"middleBand","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":"middleBand"}},{"name":"lowerBand","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(8, 153, 129)","title":"lowerBand"}}]},{"name":"AD","camelCaseName":"ad","group":"Volume Indicators","description":"Chaikin A/D Line","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"},{"name":"volume","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ADOSC","camelCaseName":"adOsc","group":"Volume Indicators","description":"Chaikin A/D Oscillator","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"},{"name":"volume","type":"Double[]"}],"options":[{"name":"fastPeriod","displayName":"Fast Period","defaultValue":3,"hint":"Number of period for the fast MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"slowPeriod","displayName":"Slow Period","defaultValue":10,"hint":"Number of period for the slow MA","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ADX","camelCaseName":"adx","group":"Momentum Indicators","description":"Average Directional Movement Index","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ADXR","camelCaseName":"adxr","group":"Momentum Indicators","description":"Average Directional Movement Index Rating","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"APO","camelCaseName":"apo","group":"Momentum Indicators","description":"Absolute Price Oscillator","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"fastPeriod","displayName":"Fast Period","defaultValue":12,"hint":"Number of period for the fast MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"slowPeriod","displayName":"Slow Period","defaultValue":26,"hint":"Number of period for the slow MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"MAType","displayName":"MA Type","defaultValue":0,"hint":"Type of Moving Average","type":"MAType"}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"AROON","camelCaseName":"aroon","group":"Momentum Indicators","description":"Aroon","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"aroonDown","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":"aroonDown"}},{"name":"aroonUp","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(251, 140, 0)","title":"aroonUp"}}]},{"name":"AROONOSC","camelCaseName":"aroonOsc","group":"Momentum Indicators","description":"Aroon Oscillator","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ATR","camelCaseName":"atr","group":"Volatility Indicators","description":"Average True Range","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"AVGDEV","camelCaseName":"avgDev","group":"Price Transform","description":"Average Deviation","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"AVGPRICE","camelCaseName":"avgPrice","group":"Price Transform","description":"Average Price","inputs":[{"name":"open","type":"Double[]"},{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"BBANDS","camelCaseName":"bbands","group":"Overlap Studies","description":"Bollinger Bands","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":20,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}},{"name":"nbDevUp","displayName":"Deviations up","defaultValue":2,"hint":"Deviation multiplier for upper band","type":"Double","range":{"min":-3e+37,"max":3e+37}},{"name":"nbDevDn","displayName":"Deviations down","defaultValue":2,"hint":"Deviation multiplier for lower band","type":"Double","range":{"min":-3e+37,"max":3e+37}},{"name":"MAType","displayName":"MA Type","defaultValue":0,"hint":"Type of Moving Average","type":"MAType"}],"outputs":[{"name":"upperBand","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(242, 54, 69)","title":"upperBand"}},{"name":"middleBand","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":"middleBand"}},{"name":"lowerBand","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(8, 153, 129)","title":"lowerBand"}}]},{"name":"BOP","camelCaseName":"bop","group":"Momentum Indicators","description":"Balance Of Power","inputs":[{"name":"open","type":"Double[]"},{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"CCI","camelCaseName":"cci","group":"Momentum Indicators","description":"Commodity Channel Index","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"CMO","camelCaseName":"cmo","group":"Momentum Indicators","description":"Chande Momentum Oscillator","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"DEMA","camelCaseName":"dema","group":"Overlap Studies","description":"Double Exponential Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(67, 160, 71)","title":""}}]},{"name":"DX","camelCaseName":"dx","group":"Momentum Indicators","description":"Directional Movement Index","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"EMA","camelCaseName":"ema","group":"Overlap Studies","description":"Exponential Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"HT_DCPERIOD","camelCaseName":"htDcPeriod","group":"Cycle Indicators","description":"Hilbert Transform - Dominant Cycle Period","inputs":[{"name":"inReal","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"HT_DCPHASE","camelCaseName":"htDcPhase","group":"Cycle Indicators","description":"Hilbert Transform - Dominant Cycle Phase","inputs":[{"name":"inReal","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"HT_PHASOR","camelCaseName":"htPhasor","group":"Cycle Indicators","description":"Hilbert Transform - Phasor Components","inputs":[{"name":"inReal","type":"Double[]"}],"options":[],"outputs":[{"name":"inPhase","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":"inPhase"}},{"name":"quadrature","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(251, 140, 0)","title":"quadrature"}}]},{"name":"HT_SINE","camelCaseName":"htSine","group":"Cycle Indicators","description":"Hilbert Transform - SineWave","inputs":[{"name":"inReal","type":"Double[]"}],"options":[],"outputs":[{"name":"sine","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":"sine"}},{"name":"leadSine","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":"leadSine"}}]},{"name":"HT_TRENDLINE","camelCaseName":"htTrendline","group":"Overlap Studies","description":"Hilbert Transform - Instantaneous Trendline","inputs":[{"name":"inReal","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"HT_TRENDMODE","camelCaseName":"htTrendMode","group":"Cycle Indicators","description":"Hilbert Transform - Trend vs Cycle Mode","inputs":[{"name":"inReal","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Integer[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"IMI","camelCaseName":"imi","group":"Momentum Indicators","description":"Intraday Momentum Index","inputs":[{"name":"open","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"KAMA","camelCaseName":"kama","group":"Overlap Studies","description":"Kaufman Adaptive Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MA","camelCaseName":"movingAverage","group":"Overlap Studies","description":"Moving average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}},{"name":"MAType","displayName":"MA Type","defaultValue":0,"hint":"Type of Moving Average","type":"MAType"}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MACD","camelCaseName":"macd","group":"Momentum Indicators","description":"Moving Average Convergence/Divergence","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"fastPeriod","displayName":"Fast Period","defaultValue":12,"hint":"Number of period for the fast MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"slowPeriod","displayName":"Slow Period","defaultValue":26,"hint":"Number of period for the slow MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"signalPeriod","displayName":"Signal Period","defaultValue":9,"hint":"Smoothing for the signal line (nb of period)","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"MACDHist","type":"Double[]","style":{"plottype":5,"color":"#ff5252","title":"Histogram"}},{"name":"MACD","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#2196f3","title":"MACD"}},{"name":"MACDSignal","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#ff6d00","title":"Signal"}}]},{"name":"MACDEXT","camelCaseName":"macdExt","group":"Momentum Indicators","description":"MACD with controllable MA type","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"fastPeriod","displayName":"Fast Period","defaultValue":12,"hint":"Number of period for the fast MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"fastMAType","displayName":"Fast MA","defaultValue":0,"hint":"Type of Moving Average for fast MA","type":"MAType"},{"name":"slowPeriod","displayName":"Slow Period","defaultValue":26,"hint":"Number of period for the slow MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"slowMAType","displayName":"Slow MA","defaultValue":0,"hint":"Type of Moving Average for slow MA","type":"MAType"},{"name":"signalPeriod","displayName":"Signal Period","defaultValue":9,"hint":"Smoothing for the signal line (nb of period)","type":"Integer","range":{"min":1,"max":100000}},{"name":"signalMAType","displayName":"Signal MA","defaultValue":0,"hint":"Type of Moving Average for signal line","type":"MAType"}],"outputs":[{"name":"MACD","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#2196f3","title":"MACD"}},{"name":"MACDSignal","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#ff6d00","title":"MACDSignal"}},{"name":"MACDHist","type":"Double[]","style":{"plottype":5,"color":"#ff5252","title":"MACDHist"}}]},{"name":"MACDFIX","camelCaseName":"macdFix","group":"Momentum Indicators","description":"Moving Average Convergence/Divergence Fix 12/26","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"signalPeriod","displayName":"Signal Period","defaultValue":9,"hint":"Smoothing for the signal line (nb of period)","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"MACD","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#2196f3","title":"MACD"}},{"name":"MACDSignal","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#ff6d00","title":"MACDSignal"}},{"name":"MACDHist","type":"Double[]","style":{"plottype":5,"color":"#ff5252","title":"MACDHist"}}]},{"name":"MAMA","camelCaseName":"mama","group":"Overlap Studies","description":"MESA Adaptive Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"fastLimit","displayName":"Fast Limit","defaultValue":0.5,"hint":"Upper limit use in the adaptive algorithm","type":"Double","range":{"min":0.01,"max":0.99}},{"name":"slowLimit","displayName":"Slow Limit","defaultValue":0.05,"hint":"Lower limit use in the adaptive algorithm","type":"Double","range":{"min":0.01,"max":0.99}}],"outputs":[{"name":"MAMA","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(0, 0, 255)","title":"MAMA"}},{"name":"FAMA","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(128, 0, 0)","title":"FAMA"}}]},{"name":"MAVP","camelCaseName":"movingAverageVariablePeriod","group":"Overlap Studies","description":"Moving average with variable period","inputs":[{"name":"inReal","type":"Double[]"},{"name":"inPeriods","type":"Double[]"}],"options":[{"name":"minPeriod","displayName":"Minimum Period","defaultValue":2,"hint":"Value less than minimum will be changed to Minimum period","type":"Integer","range":{"min":2,"max":100000}},{"name":"maxPeriod","displayName":"Maximum Period","defaultValue":30,"hint":"Value higher than maximum will be changed to Maximum period","type":"Integer","range":{"min":2,"max":100000}},{"name":"MAType","displayName":"MA Type","defaultValue":0,"hint":"Type of Moving Average","type":"MAType"}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MEDPRICE","camelCaseName":"medPrice","group":"Price Transform","description":"Median Price","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MFI","camelCaseName":"mfi","group":"Momentum Indicators","description":"Money Flow Index","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"},{"name":"volume","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MIDPOINT","camelCaseName":"midPoint","group":"Overlap Studies","description":"MidPoint over period","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MIDPRICE","camelCaseName":"midPrice","group":"Overlap Studies","description":"Midpoint Price over period","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MINUS_DI","camelCaseName":"minusDI","group":"Momentum Indicators","description":"Minus Directional Indicator","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MINUS_DM","camelCaseName":"minusDM","group":"Momentum Indicators","description":"Minus Directional Movement","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"MOM","camelCaseName":"mom","group":"Momentum Indicators","description":"Momentum","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":10,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"OBV","camelCaseName":"obv","group":"Volume Indicators","description":"On Balance Volume","inputs":[{"name":"inReal","type":"Double[]"},{"name":"volume","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"PLUS_DI","camelCaseName":"plusDI","group":"Momentum Indicators","description":"Plus Directional Indicator","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"PLUS_DM","camelCaseName":"plusDM","group":"Momentum Indicators","description":"Plus Directional Movement","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"PPO","camelCaseName":"ppo","group":"Momentum Indicators","description":"Percentage Price Oscillator","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"fastPeriod","displayName":"Fast Period","defaultValue":12,"hint":"Number of period for the fast MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"slowPeriod","displayName":"Slow Period","defaultValue":26,"hint":"Number of period for the slow MA","type":"Integer","range":{"min":2,"max":100000}},{"name":"MAType","displayName":"MA Type","defaultValue":0,"hint":"Type of Moving Average","type":"MAType"}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ROC","camelCaseName":"roc","group":"Momentum Indicators","description":"Rate of change : ((price/prevPrice)-1)*100","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":10,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ROCP","camelCaseName":"rocP","group":"Momentum Indicators","description":"Rate of change Percentage: (price-prevPrice)/prevPrice","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":10,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ROCR","camelCaseName":"rocR","group":"Momentum Indicators","description":"Rate of change ratio: (price/prevPrice)","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":10,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ROCR100","camelCaseName":"rocR100","group":"Momentum Indicators","description":"Rate of change ratio 100 scale: (price/prevPrice)*100","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":10,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"RSI","camelCaseName":"rsi","group":"Momentum Indicators","description":"Relative Strength Index","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"SAR","camelCaseName":"sar","group":"Overlap Studies","description":"Parabolic SAR","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"acceleration","displayName":"Acceleration Factor","defaultValue":0.02,"hint":"Acceleration Factor used up to the Maximum value","type":"Double","range":{"min":0,"max":3e+37}},{"name":"maximum","displayName":"AF Maximum","defaultValue":0.2,"hint":"Acceleration Factor Maximum value","type":"Double","range":{"min":0,"max":3e+37}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":3,"color":"#2196F3","title":""}}]},{"name":"SAREXT","camelCaseName":"sarExt","group":"Overlap Studies","description":"Parabolic SAR - Extended","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"}],"options":[{"name":"startValue","displayName":"Start Value","defaultValue":0,"hint":"Start value and direction. 0 for Auto, >0 for Long, <0 for Short","type":"Double","range":{"min":-3e+37,"max":3e+37}},{"name":"offsetOnReverse","displayName":"Offset on Reverse","defaultValue":0,"hint":"Percent offset added/removed to initial stop on short/long reversal","type":"Double","range":{"min":0,"max":3e+37}},{"name":"accelerationInitLong","displayName":"AF Init Long","defaultValue":0.02,"hint":"Acceleration Factor initial value for the Long direction","type":"Double","range":{"min":0,"max":3e+37}},{"name":"accelerationLong","displayName":"AF Long","defaultValue":0.02,"hint":"Acceleration Factor for the Long direction","type":"Double","range":{"min":0,"max":3e+37}},{"name":"accelerationMaxLong","displayName":"AF Max Long","defaultValue":0.2,"hint":"Acceleration Factor maximum value for the Long direction","type":"Double","range":{"min":0,"max":3e+37}},{"name":"accelerationInitShort","displayName":"AF Init Short","defaultValue":0.02,"hint":"Acceleration Factor initial value for the Short direction","type":"Double","range":{"min":0,"max":3e+37}},{"name":"accelerationShort","displayName":"AF Short","defaultValue":0.02,"hint":"Acceleration Factor for the Short direction","type":"Double","range":{"min":0,"max":3e+37}},{"name":"accelerationMaxShort","displayName":"AF Max Short","defaultValue":0.2,"hint":"Acceleration Factor maximum value for the Short direction","type":"Double","range":{"min":0,"max":3e+37}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":3,"color":"#2196F3","title":""}}]},{"name":"SMA","camelCaseName":"sma","group":"Overlap Studies","description":"Simple Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"STDDEV","camelCaseName":"stdDev","group":"Statistic Functions","description":"Standard Deviation","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":5,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}},{"name":"nbDev","displayName":"Deviations","defaultValue":1,"hint":"Nb of deviations","type":"Double","range":{"min":-3e+37,"max":3e+37}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"STOCH","camelCaseName":"stoch","group":"Momentum Indicators","description":"Stochastic","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"fastK_Period","displayName":"Fast-K Period","defaultValue":5,"hint":"Time period for building the Fast-K line","type":"Integer","range":{"min":1,"max":100000}},{"name":"slowK_Period","displayName":"Slow-K Period","defaultValue":3,"hint":"Smoothing for making the Slow-K line. Usually set to 3","type":"Integer","range":{"min":1,"max":100000}},{"name":"slowK_MAType","displayName":"Slow-K MA","defaultValue":0,"hint":"Type of Moving Average for Slow-K","type":"MAType"},{"name":"slowD_Period","displayName":"Slow-D Period","defaultValue":3,"hint":"Smoothing for making the Slow-D line","type":"Integer","range":{"min":1,"max":100000}},{"name":"slowD_MAType","displayName":"Slow-D MA","defaultValue":0,"hint":"Type of Moving Average for Slow-D","type":"MAType"}],"outputs":[{"name":"slowK","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#2962FF","title":"slowK"}},{"name":"slowD","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#FF6D00","title":"slowD"}}]},{"name":"STOCHF","camelCaseName":"stochF","group":"Momentum Indicators","description":"Stochastic Fast","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"fastK_Period","displayName":"Fast-K Period","defaultValue":5,"hint":"Time period for building the Fast-K line","type":"Integer","range":{"min":1,"max":100000}},{"name":"fastD_Period","displayName":"Fast-D Period","defaultValue":3,"hint":"Smoothing for making the Fast-D line. Usually set to 3","type":"Integer","range":{"min":1,"max":100000}},{"name":"fastD_MAType","displayName":"Fast-D MA","defaultValue":0,"hint":"Type of Moving Average for Fast-D","type":"MAType"}],"outputs":[{"name":"fastK","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#2962FF","title":"fastK"}},{"name":"fastD","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#FF6D00","title":"fastD"}}]},{"name":"STOCHRSI","camelCaseName":"stochRsi","group":"Momentum Indicators","description":"Stochastic Relative Strength Index","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}},{"name":"fastK_Period","displayName":"Fast-K Period","defaultValue":5,"hint":"Time period for building the Fast-K line","type":"Integer","range":{"min":1,"max":100000}},{"name":"fastD_Period","displayName":"Fast-D Period","defaultValue":3,"hint":"Smoothing for making the Fast-D line. Usually set to 3","type":"Integer","range":{"min":1,"max":100000}},{"name":"fastD_MAType","displayName":"Fast-D MA","defaultValue":0,"hint":"Type of Moving Average for Fast-D","type":"MAType"}],"outputs":[{"name":"fastK","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#2962FF","title":"fastK"}},{"name":"fastD","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"#FF6D00","title":"fastD"}}]},{"name":"T3","camelCaseName":"t3","group":"Overlap Studies","description":"Triple Exponential Moving Average (T3)","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":5,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}},{"name":"VFactor","displayName":"Volume Factor","defaultValue":0.7,"hint":"Volume Factor","type":"Double","range":{"min":0,"max":1}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"TEMA","camelCaseName":"tema","group":"Overlap Studies","description":"Triple Exponential Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"TRANGE","camelCaseName":"trueRange","group":"Volatility Indicators","description":"True Range","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"TRIMA","camelCaseName":"trima","group":"Overlap Studies","description":"Triangular Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"TRIX","camelCaseName":"trix","group":"Momentum Indicators","description":"1-day Rate-Of-Change (ROC) of a Triple Smooth EMA","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"TSF","camelCaseName":"tsf","group":"Statistic Functions","description":"Time Series Forecast","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"TYPPRICE","camelCaseName":"typPrice","group":"Price Transform","description":"Typical Price","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"ULTOSC","camelCaseName":"ultOsc","group":"Momentum Indicators","description":"Ultimate Oscillator","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod1","displayName":"First Period","defaultValue":7,"hint":"Number of bars for 1st period.","type":"Integer","range":{"min":1,"max":100000}},{"name":"timePeriod2","displayName":"Second Period","defaultValue":14,"hint":"Number of bars fro 2nd period","type":"Integer","range":{"min":1,"max":100000}},{"name":"timePeriod3","displayName":"Third Period","defaultValue":28,"hint":"Number of bars for 3rd period","type":"Integer","range":{"min":1,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"VAR","camelCaseName":"variance","group":"Statistic Functions","description":"Variance","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":5,"hint":"Number of period","type":"Integer","range":{"min":1,"max":100000}},{"name":"nbDev","displayName":"Deviations","defaultValue":1,"hint":"Nb of deviations","type":"Double","range":{"min":-3e+37,"max":3e+37}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"WCLPRICE","camelCaseName":"wclPrice","group":"Price Transform","description":"Weighted Close Price","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"WILLR","camelCaseName":"willR","group":"Momentum Indicators","description":"Williams' %R","inputs":[{"name":"high","type":"Double[]"},{"name":"low","type":"Double[]"},{"name":"close","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":14,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]},{"name":"WMA","camelCaseName":"wma","group":"Overlap Studies","description":"Weighted Moving Average","inputs":[{"name":"inReal","type":"Double[]"}],"options":[{"name":"timePeriod","displayName":"Time Period","defaultValue":30,"hint":"Number of period","type":"Integer","range":{"min":2,"max":100000}}],"outputs":[{"name":"output","type":"Double[]","style":{"linewidth":1,"plottype":0,"color":"rgb(41, 98, 255)","title":""}}]}]`);function enumToOptions(ie){return Object.keys(ie).filter(te=>isNaN(Number(te))).map(te=>({title:te,value:ie[te]}))}function extractSource(ie,te){return ie.map(ee=>ee.customValues[te])}enumToOptions(MAType);const overlapGroupName="Overlap Studies",arrayInputType="Double[]",numberInputType="Integer",talibIndicators=json.map(ie=>({id:ie.name,name:ie.description,abbr:ie.name,overlap:ie.group===overlapGroupName,optionInfos:ie.options,styleValues:{styles:ie.outputs.reduce((ee,ne)=>(ee[ne.name]=ne.style||{},ee),{})},cal:(ee,ne=Object.create(null))=>{const re=Object.create(null);ie.inputs.forEach(le=>{switch(le.type){case numberInputType:{re[le.name]=ne[le.name];break}case arrayInputType:re[le.name]=extractSource(ee,le.name==="inReal"?"close":le.name)}}),ie.options.forEach(le=>{re[le.name]=ne[le.name]??le.defaultValue});const ae=Reflect.get(TA,ie.name)(re);return ee.map((le,ce)=>{const he=Object.create(null);return he.time=le.time,ce<ae.outBegIdx||(he.study=Object.create(null),ie.outputs.forEach(fe=>{he.study[fe.name]=ae[fe.name][ce-ae.outBegIdx]})),he})}})),indicators=talibIndicators.concat(ao,bbi,bias,brar,cr,emv,kdj,mtm,psy,pvt,vr).sort((ie,te)=>ie.name.localeCompare(te.name));indicators.forEach(ie=>studyRegistry.add(ie));var root_1$4=from_html('<button class="indicator svelte-w2jtue"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="none" class="svelte-w2jtue"><path stroke="currentColor" d="M20 17l-5 5M15 17l5 5M9 11.5h7M17.5 8a2.5 2.5 0 0 0-5 0v11a2.5 2.5 0 0 1-5 0"></path></svg> <span class="svelte-w2jtue"> </span></button> <!>',1),root_7=from_html("<span> </span>"),root_5$3=from_html('<div class="groupName svelte-w2jtue"> </div> <!>',1),root_3$5=from_html('<!> <div class="searchWrapper svelte-w2jtue"><div class="inputContainer svelte-w2jtue"><input type="text" class="input svelte-w2jtue" autocomplete="off" data-role="search" placeholder="Search"/></div> <div class="searchIcon svelte-w2jtue"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none"><path stroke="currentColor" d="M12.4 12.5a7 7 0 1 0-4.9 2 7 7 0 0 0 4.9-2zm0 0l5.101 5"></path></svg></div></div> <!>',1),root$8=from_html('<div class="indicatorWrapper svelte-w2jtue"><!> <!></div>');function Indicator(ie,te){push(te,!0);const[ee,ne]=setup_stores(),re=()=>store_get(pe,"$inputValue",ee),{t:se}=useTranslation(),ae=useService(IChartManagementService),le=useService(IConfigurationService),ce=useService(IKeybindingsRegistry),he=useService(IStudyService),fe=KeyCode.Slash;let Ae=state(!1),pe=writable(""),Oe,Fe;onDestroy(()=>{Oe&&Reflect.deleteProperty(Oe,"__on_r"),Oe=null,Fe=null});const Ne=derived(le.store,tr=>{switch(tr.studiesAccessType){case"white":return indicators.filter(or=>tr.studiesAccess[or.name]==="white");case"black":return indicators.filter(or=>tr.studiesAccess[or.name]!=="black");default:return indicators}});let ze=state(proxy(get$1(Ne)));const He={getItemLabel(tr){return`${tr.abbr} ${tr.name}`},getItemDescription(tr){return tr.abbr}},We=Object.create(null),je=pe.subscribe(tr=>{if(Fe==null||Fe.scrollIntoView(),tr){const or=prepareQuery(tr),Jt=(rr,lr)=>compareItemsByFuzzyScore(rr,lr,or,!0,He,We);set(ze,top(get$1(Ne),Jt,15),!0)}else set(ze,get$1(Ne),!0)});onDestroy(()=>{je()});function Ue(){set(Ae,!0),pe.set("")}function Ge(){Oe.focus()}function Ze(){set(Ae,!1),pe.set(""),Fe.scrollIntoView()}async function Ye(tr){await he.init(),ae.activeChart().createStudy(tr.id),Ze()}useDisposable(ce.registerCommandAndKeybindingRule({id:"ui.indicator.showDialog",primary:KeyCode.Slash,weight:KeybindingWeight.ChartCore,handler:()=>{Ue()}}));var qe=root$8(),nr=child(qe);Wrapper(nr,{children:(tr,or)=>{var Jt=root_1$4(),rr=first_child(Jt);rr.__pointerup=Ue;var lr=sibling(child(rr),2),ur=child(lr),Sr=sibling(rr,2);Tooltip(Sr,{children:(xr,Pr)=>{{let mr=user_derived(()=>se("topToolbar.indicator.tip"));TooltipContent(xr,{get content(){return get$2(mr)},get keybinding(){return fe}})}},$$slots:{default:!0}}),template_effect(xr=>set_text(ur,xr),[()=>se("topToolbar.indicator")]),append(tr,Jt)},$$slots:{default:!0}});var ir=sibling(nr,2);Dialog(ir,{get open(){return get$2(Ae)},onSMUIDialogClosed:Ze,onSMUIDialogOpened:Ge,children:(tr,or)=>{var Jt=root_3$5(),rr=first_child(Jt);{let Pr=user_derived(()=>se("indicator.dialog.title"));DialogTitle(rr,{get title(){return get$2(Pr)}})}var lr=sibling(rr,2),ur=child(lr),Sr=child(ur);bind_this(Sr,Pr=>Oe=Pr,()=>Oe);var xr=sibling(lr,2);Content(xr,{class:"content",children:(Pr,mr)=>{List(Pr,{class:"list",children:(Er,dr)=>{var Cr=root_5$3(),Or=first_child(Cr),Ar=child(Or);bind_this(Or,wr=>Fe=wr,()=>Fe);var Ir=sibling(Or,2);each(Ir,17,()=>get$2(ze),wr=>wr.id,(wr,Dr)=>{Item(wr,{class:"item",onpointerup:()=>Ye(get$2(Dr)),children:(Ur,zr)=>{var Fr=root_7(),Jr=child(Fr);template_effect(()=>set_text(Jr,get$2(Dr).name)),append(Ur,Fr)},$$slots:{default:!0}})}),template_effect(wr=>set_text(Ar,wr),[()=>se("indicator.dialog.script")]),append(Er,Cr)},$$slots:{default:!0}})},$$slots:{default:!0}}),bind_value(Sr,re,Pr=>store_set(pe,Pr)),append(tr,Jt)},$$slots:{default:!0}}),append(ie,qe),pop(),ne()}delegate(["pointerup"]);var on_pointerup$1=(ie,te)=>get$2(te).setOpen(!0),root_2$3=from_html("<div> </div>"),root_1$3=from_html('<button class="chartInterval svelte-1xizq08"><span> </span></button> <!>',1),root_6$2=from_html('<div class="separator svelte-1xizq08"></div>'),root_5$2=from_html('<!> <div class="sectionTitle svelte-1xizq08"> </div> <!>',1),root_3$4=from_html('<div class="intervalMenu svelte-1xizq08"><!></div>'),root$7=from_html("<div><!> <!></div>");function Interval(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ze,"$labelShort",ee),se=()=>store_get(He,"$labelLong",ee),ae=()=>store_get(Oe,"$resolutionGroups",ee),le=()=>store_get(Fe,"$disabled",ee),ce=()=>store_get(Ne,"$currentInterval",ee),{t:he}=useTranslation(),fe=useService(IChartManagementService),Ae=useService(IConfigurationService),pe=useService(IChartResolutionRegistry),Oe=derived(pe.store,Ye=>Ye.groups),Fe=derived(fe.store,Ye=>{const{activeIndex:qe}=Ye;return isFinite(qe)?Ye.instances[qe].dataStatus<ChartDataStatus.symbolInfoResolved:!0}),Ne=derived([fe.store,Ae.store,pe.store],([Ye,qe])=>{const{activeIndex:nr}=Ye,ir=isFinite(nr)?Ye.instances[nr].resolution:qe.interval;return pe.value(ir)}),ze=derived(Ne,Ye=>Ye==null?void 0:Ye.labelShort),He=derived(Ne,Ye=>Ye?We(Ye):""),We=Ye=>{const qe=Ye.label;return he(qe,{count:Ye.value})};let je=mutable_source();onDestroy(()=>{set(je,null)}),init$1();var Ue=root$7(),Ge=child(Ue);Wrapper(Ge,{children:(Ye,qe)=>{var nr=root_1$3(),ir=first_child(nr);ir.__pointerup=[on_pointerup$1,je];var tr=child(ir),or=child(tr),Jt=sibling(ir,2);Tooltip(Jt,{children:(rr,lr)=>{var ur=root_2$3(),Sr=child(ur);template_effect(()=>set_text(Sr,se())),append(rr,ur)},$$slots:{default:!0}}),template_effect(()=>set_text(or,re())),append(Ye,nr)},$$slots:{default:!0}});var Ze=sibling(Ge,2);bind_this(Menu(Ze,{anchorCorner:"BOTTOM_LEFT",quickOpen:!0,class:"cl-dropdown",children:(Ye,qe)=>{var nr=root_3$4(),ir=child(nr);List(ir,{children:(tr,or)=>{var Jt=comment(),rr=first_child(Jt);each(rr,1,ae,index,(lr,ur,Sr)=>{var xr=root_5$2(),Pr=first_child(xr);{var mr=Or=>{var Ar=root_6$2();append(Or,Ar)};if_block(Pr,Or=>{Sr!==0&&Or(mr)})}var Er=sibling(Pr,2),dr=child(Er),Cr=sibling(Er,2);each(Cr,1,()=>get$2(ur).items,index,(Or,Ar)=>{{let Ir=derived_safe_equal(()=>{var Dr;return get$2(Ar).resolutionString===((Dr=ce())==null?void 0:Dr.resolutionString)}),wr=derived_safe_equal(()=>{var Dr;return clsx$1("row",get$2(Ar).resolutionString===((Dr=ce())==null?void 0:Dr.resolutionString)&&"selected",le()&&"disabled")});Item(Or,{tag:"div",get disabled(){return le()},get selected(){return get$2(Ir)},get class(){return get$2(wr)},onpointerup:()=>{le()||fe.activeChart().setResolution(get$2(Ar).resolutionString)},children:(Dr,Ur)=>{var zr=text();template_effect(Fr=>set_text(zr,Fr),[()=>We(get$2(Ar))]),append(Dr,zr)},$$slots:{default:!0}})}}),template_effect(Or=>set_text(dr,Or),[()=>he(get$2(ur).i18nKey)]),append(lr,xr)}),append(tr,Jt)},$$slots:{default:!0}}),append(Ye,nr)},$$slots:{default:!0},$$legacy:!0}),Ye=>set(je,Ye),()=>get$2(je)),append(ie,Ue),pop(),ne()}delegate(["pointerup"]);var root_6$1=from_html('<div class="separator svelte-12mknzt"></div>'),root_3$3=from_html('<div class="row svelte-12mknzt"><div class="rowInner svelte-12mknzt"><div class="rowLabel svelte-12mknzt"></div> <!></div> <!></div>'),root$6=from_html('<div class="layoutMenu svelte-12mknzt"><!></div>');function LayoutMenu(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(le,"$currentLayout",ee),se=useService(IChartManagementService),ae=layoutPresets.length-1,le=derived(se.store,pe=>pe.layout);let ce=prop(te,"onSelected",8);function he(pe){se.setLayout(pe.id),ce()()}init$1();var fe=root$6(),Ae=child(fe);List(Ae,{children:(pe,Oe)=>{var Fe=comment(),Ne=first_child(Fe);each(Ne,1,()=>layoutPresets,index,(ze,He,We)=>{var je=comment(),Ue=first_child(je);{var Ge=Ze=>{var Ye=root_3$3(),qe=child(Ye),nr=child(qe);nr.textContent=We;var ir=sibling(nr,2);each(ir,1,()=>get$2(He),index,(Jt,rr)=>{{let lr=derived_safe_equal(()=>(deep_read_state(clsx$1),get$2(rr),re(),untrack(()=>clsx$1("layoutButton",get$2(rr).id===re()&&"selected",get$2(rr).disabled&&"disabled"))));Item(Jt,{get class(){return get$2(lr)},onpointerup:()=>{he(get$2(rr))},tag:"button",children:(ur,Sr)=>{var xr=comment(),Pr=first_child(xr);html(Pr,()=>(get$2(rr),untrack(()=>get$2(rr).icon))),append(ur,xr)},$$slots:{default:!0}})}});var tr=sibling(qe,2);{var or=Jt=>{var rr=root_6$1();append(Jt,rr)};if_block(tr,Jt=>{We!==ae&&Jt(or)})}append(Ze,Ye)};if_block(Ue,Ze=>{get$2(He)&&Ze(Ge)})}append(ze,je)}),append(pe,Fe)},$$slots:{default:!0}}),append(ie,fe),pop(),ne()}var on_pointerup=(ie,te)=>get$2(te).setOpen(!0),root_2$2=from_html("<div> </div>"),root_1$2=from_html('<button class="layout svelte-e0as8d"><div class="wrapper svelte-e0as8d"><!></div></button> <!>',1),root$5=from_html("<div><!> <!></div>");function Layout(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(le,"$currentLayoutIcon",ee),{t:se}=useTranslation(),ae=useService(IChartManagementService),le=derived(ae.store,Oe=>chartLayoutRegistry.value(Oe.layout).icon);let ce=mutable_source();function he(){get$2(ce).setOpen(!1)}onDestroy(()=>{set(ce,null)}),init$1();var fe=root$5(),Ae=child(fe);Wrapper(Ae,{children:(Oe,Fe)=>{var Ne=root_1$2(),ze=first_child(Ne);ze.__pointerup=[on_pointerup,ce];var He=child(ze),We=child(He);html(We,re);var je=sibling(ze,2);Tooltip(je,{children:(Ue,Ge)=>{var Ze=root_2$2(),Ye=child(Ze);template_effect(qe=>set_text(Ye,qe),[()=>se("topToolbar.layout")]),append(Ue,Ze)},$$slots:{default:!0}}),append(Oe,Ne)},$$slots:{default:!0}});var pe=sibling(Ae,2);bind_this(Menu(pe,{anchorCorner:"BOTTOM_LEFT",quickOpen:!0,class:"cl-dropdown",children:(Oe,Fe)=>{LayoutMenu(Oe,{onSelected:he})},$$slots:{default:!0},$$legacy:!0}),Oe=>set(ce,Oe),()=>get$2(ce)),append(ie,fe),pop(),ne()}delegate(["pointerup"]);var root$4=from_html('<div class="separator svelte-16cftpq"><div class="inner svelte-16cftpq"></div></div>');function Separator(ie){var te=root$4();append(ie,te)}function handleOpen(ie,te){set(te,!0)}var root_2$1=from_html("<div> </div>"),root_1$1=from_html('<button class="setting svelte-1x8jemh"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor" class="svelte-1x8jemh"><path fill-rule="evenodd" d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path><path fill-rule="evenodd" d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z"></path></svg></button> <!>',1),root_3$2=from_html("<!> <!> <!>",1),root$3=from_html("<div><!> <!></div>");function Setting(ie,te){push(te,!0);const{t:ee}=useTranslation();let ne=state(!1);function re(){set(ne,!1)}var se=root$3(),ae=child(se);Wrapper(ae,{children:(ce,he)=>{var fe=root_1$1(),Ae=first_child(fe);Ae.__pointerup=[handleOpen,ne];var pe=sibling(Ae,2);Tooltip(pe,{children:(Oe,Fe)=>{var Ne=root_2$1(),ze=child(Ne);template_effect(He=>set_text(ze,He),[()=>ee("topToolbar.setting")]),append(Oe,Ne)},$$slots:{default:!0}}),append(ce,fe)},$$slots:{default:!0}});var le=sibling(ae,2);Dialog(le,{get open(){return get$2(ne)},onSMUIDialogClosed:re,children:(ce,he)=>{var fe=root_3$2(),Ae=first_child(fe);{let Fe=user_derived(()=>ee("setting.title"));DialogTitle(Ae,{get title(){return get$2(Fe)}})}var pe=sibling(Ae,2);Content(pe,{children:(Fe,Ne)=>{var ze=text("empty");append(Fe,ze)},$$slots:{default:!0}});var Oe=sibling(pe,2);{let Fe=user_derived(()=>ee("common.ok")),Ne=user_derived(()=>ee("common.cancel"));DialogFooter(Oe,{get mainButtonText(){return get$2(Fe)},get cancelButtonText(){return get$2(Ne)},onConfirm:re,onCancel:re})}append(ce,fe)},$$slots:{default:!0}}),append(ie,se),pop()}delegate(["pointerup"]);function changeJpegDpi(ie,te){return ie[13]=1,ie[14]=te>>8,ie[15]=te&255,ie[16]=te>>8,ie[17]=te&255,ie}const _P=112,_H=72,_Y=89,_S=115;let pngDataTable;function createPngDataTable(){const ie=new Int32Array(256);for(let te=0;te<256;te++){let ee=te;for(let ne=0;ne<8;ne++)ee=ee&1?3988292384^ee>>>1:ee>>>1;ie[te]=ee}return ie}function calcCrc(ie){let te=-1;pngDataTable||(pngDataTable=createPngDataTable());for(let ee=0;ee<ie.length;ee++)te=pngDataTable[(te^ie[ee])&255]^te>>>8;return te^-1}function searchStartOfPhys(ie){const te=ie.length-1;for(let ee=te;ee>=4;ee--)if(ie[ee-4]===9&&ie[ee-3]===_P&&ie[ee-2]===_H&&ie[ee-1]===_Y&&ie[ee]===_S)return ee-3;return 0}function changePngDpi(ie,te,ee=!1){const ne=new Uint8Array(13);te*=39.3701,ne[0]=_P,ne[1]=_H,ne[2]=_Y,ne[3]=_S,ne[4]=te>>>24,ne[5]=te>>>16,ne[6]=te>>>8,ne[7]=te&255,ne[8]=ne[4],ne[9]=ne[5],ne[10]=ne[6],ne[11]=ne[7],ne[12]=1;const re=calcCrc(ne),se=new Uint8Array(4);if(se[0]=re>>>24,se[1]=re>>>16,se[2]=re>>>8,se[3]=re&255,ee){const ae=searchStartOfPhys(ie);return ie.set(ne,ae),ie.set(se,ae+13),ie}else{const ae=new Uint8Array(4);ae[0]=0,ae[1]=0,ae[2]=0,ae[3]=9;const le=new Uint8Array(54);return le.set(ie,0),le.set(ae,33),le.set(ne,37),le.set(se,50),le}}const b64PhysSignature1="AAlwSFlz",b64PhysSignature2="AAAJcEhZ",b64PhysSignature3="AAAACXBI";function detectPhysChunkFromDataUrl(ie){let te=ie.indexOf(b64PhysSignature1);return te===-1&&(te=ie.indexOf(b64PhysSignature2)),te===-1&&(te=ie.indexOf(b64PhysSignature3)),te}const PREFIX="[modern-screenshot]",IN_BROWSER=typeof window<"u",SUPPORT_WEB_WORKER=IN_BROWSER&&"Worker"in window,SUPPORT_ATOB=IN_BROWSER&&"atob"in window,SUPPORT_BTOA=IN_BROWSER&&"btoa"in window;var Ou;const USER_AGENT=IN_BROWSER?(Ou=window.navigator)==null?void 0:Ou.userAgent:"",IN_CHROME=USER_AGENT.includes("Chrome"),IN_SAFARI=USER_AGENT.includes("AppleWebKit")&&!IN_CHROME,IN_FIREFOX=USER_AGENT.includes("Firefox"),isContext=ie=>ie&&"__CONTEXT__"in ie,isCssFontFaceRule=ie=>ie.constructor.name==="CSSFontFaceRule",isCSSImportRule=ie=>ie.constructor.name==="CSSImportRule",isElementNode=ie=>ie.nodeType===1,isSVGElementNode=ie=>typeof ie.className=="object",isSVGImageElementNode=ie=>ie.tagName==="image",isSVGUseElementNode=ie=>ie.tagName==="use",isHTMLElementNode=ie=>isElementNode(ie)&&typeof ie.style<"u"&&!isSVGElementNode(ie),isCommentNode=ie=>ie.nodeType===8,isTextNode=ie=>ie.nodeType===3,isImageElement=ie=>ie.tagName==="IMG",isVideoElement=ie=>ie.tagName==="VIDEO",isCanvasElement=ie=>ie.tagName==="CANVAS",isTextareaElement=ie=>ie.tagName==="TEXTAREA",isInputElement=ie=>ie.tagName==="INPUT",isStyleElement=ie=>ie.tagName==="STYLE",isScriptElement=ie=>ie.tagName==="SCRIPT",isSelectElement=ie=>ie.tagName==="SELECT",isSlotElement=ie=>ie.tagName==="SLOT",isIFrameElement=ie=>ie.tagName==="IFRAME",consoleWarn=(...ie)=>console.warn(PREFIX,...ie);function supportWebp(ie){var ee;const te=(ee=ie==null?void 0:ie.createElement)==null?void 0:ee.call(ie,"canvas");return te&&(te.height=te.width=1),!!te&&"toDataURL"in te&&!!te.toDataURL("image/webp").includes("image/webp")}const isDataUrl=ie=>ie.startsWith("data:");function resolveUrl(ie,te){if(ie.match(/^[a-z]+:\/\//i))return ie;if(IN_BROWSER&&ie.match(/^\/\//))return window.location.protocol+ie;if(ie.match(/^[a-z]+:/i)||!IN_BROWSER)return ie;const ee=getDocument().implementation.createHTMLDocument(),ne=ee.createElement("base"),re=ee.createElement("a");return ee.head.appendChild(ne),ee.body.appendChild(re),te&&(ne.href=te),re.href=ie,re.href}function getDocument(ie){return(ie&&isElementNode(ie)?ie==null?void 0:ie.ownerDocument:ie)??window.document}const XMLNS="http://www.w3.org/2000/svg";function createSvg(ie,te,ee){const ne=getDocument(ee).createElementNS(XMLNS,"svg");return ne.setAttributeNS(null,"width",ie.toString()),ne.setAttributeNS(null,"height",te.toString()),ne.setAttributeNS(null,"viewBox",`0 0 ${ie} ${te}`),ne}function svgToDataUrl(ie,te){let ee=new XMLSerializer().serializeToString(ie);return te&&(ee=ee.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(ee)}`}async function canvasToBlob(ie,te="image/png",ee=1){try{return await new Promise((ne,re)=>{ie.toBlob(se=>{se?ne(se):re(new Error("Blob is null"))},te,ee)})}catch(ne){if(SUPPORT_ATOB)return dataUrlToBlob(ie.toDataURL(te,ee));throw ne}}function dataUrlToBlob(ie){var le;const[te,ee]=ie.split(","),ne=((le=te.match(/data:(.+);/))==null?void 0:le[1])??void 0,re=window.atob(ee),se=re.length,ae=new Uint8Array(se);for(let ce=0;ce<se;ce+=1)ae[ce]=re.charCodeAt(ce);return new Blob([ae],{type:ne})}function readBlob(ie,te){return new Promise((ee,ne)=>{const re=new FileReader;re.onload=()=>ee(re.result),re.onerror=()=>ne(re.error),re.onabort=()=>ne(new Error(`Failed read blob to ${te}`)),te==="dataUrl"?re.readAsDataURL(ie):te==="arrayBuffer"&&re.readAsArrayBuffer(ie)})}const blobToDataUrl=ie=>readBlob(ie,"dataUrl"),blobToArrayBuffer=ie=>readBlob(ie,"arrayBuffer");function createImage(ie,te){const ee=getDocument(te).createElement("img");return ee.decoding="sync",ee.loading="eager",ee.src=ie,ee}function loadMedia(ie,te){return new Promise(ee=>{const{timeout:ne,ownerDocument:re,onError:se,onWarn:ae}=te??{},le=typeof ie=="string"?createImage(ie,getDocument(re)):ie;let ce=null,he=null;function fe(){ee(le),ce&&clearTimeout(ce),he==null||he()}if(ne&&(ce=setTimeout(fe,ne)),isVideoElement(le)){const Ae=le.currentSrc||le.src;if(!Ae)return le.poster?loadMedia(le.poster,te).then(ee):fe();if(le.readyState>=2)return fe();const pe=fe,Oe=Fe=>{ae==null||ae("Failed video load",Ae,Fe),se==null||se(Fe),fe()};he=()=>{le.removeEventListener("loadeddata",pe),le.removeEventListener("error",Oe)},le.addEventListener("loadeddata",pe,{once:!0}),le.addEventListener("error",Oe,{once:!0})}else{const Ae=isSVGImageElementNode(le)?le.href.baseVal:le.currentSrc||le.src;if(!Ae)return fe();const pe=async()=>{if(isImageElement(le)&&"decode"in le)try{await le.decode()}catch(Fe){ae==null||ae("Failed to decode image, trying to render anyway",le.dataset.originalSrc||Ae,Fe)}fe()},Oe=Fe=>{ae==null||ae("Failed image load",le.dataset.originalSrc||Ae,Fe),fe()};if(isImageElement(le)&&le.complete)return pe();he=()=>{le.removeEventListener("load",pe),le.removeEventListener("error",Oe)},le.addEventListener("load",pe,{once:!0}),le.addEventListener("error",Oe,{once:!0})}})}async function waitUntilLoad(ie,te){isHTMLElementNode(ie)&&(isImageElement(ie)||isVideoElement(ie)?await loadMedia(ie,te):await Promise.all(["img","video"].flatMap(ee=>Array.from(ie.querySelectorAll(ee)).map(ne=>loadMedia(ne,te)))))}const uuid=function ie(){let te=0;const ee=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(te+=1,`u${ee()}${te}`)}();function splitFontFamily(ie){return ie==null?void 0:ie.split(",").map(te=>te.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}let uid=0;function createLogger(ie){const te=`${PREFIX}[#${uid}]`;return uid++,{time:ee=>ie&&console.time(`${te} ${ee}`),timeEnd:ee=>ie&&console.timeEnd(`${te} ${ee}`),warn:(...ee)=>ie&&consoleWarn(...ee)}}function getDefaultRequestInit(ie){return{cache:ie?"no-cache":"force-cache"}}async function orCreateContext(ie,te){return isContext(ie)?ie:createContext(ie,{...te,autoDestruct:!0})}async function createContext(ie,te){var Oe,Fe;const{scale:ee=1,workerUrl:ne,workerNumber:re=1}=te||{},se=!!(te!=null&&te.debug),ae=(te==null?void 0:te.features)??!0,le=ie.ownerDocument??(IN_BROWSER?window.document:void 0),ce=((Oe=ie.ownerDocument)==null?void 0:Oe.defaultView)??(IN_BROWSER?window:void 0),he=new Map,fe={width:0,height:0,quality:1,type:"image/png",scale:ee,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:se,fetch:{requestInit:getDefaultRequestInit((Fe=te==null?void 0:te.fetch)==null?void 0:Fe.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...te==null?void 0:te.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:re,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...te,__CONTEXT__:!0,log:createLogger(se),node:ie,ownerDocument:le,ownerWindow:ce,dpi:ee===1?null:96*ee,svgStyleElement:createStyleElement(le),svgDefsElement:le==null?void 0:le.createElementNS(XMLNS,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:SUPPORT_WEB_WORKER&&ne&&re?re:0})].map(()=>{try{const Ne=new Worker(ne);return Ne.onmessage=async ze=>{var je,Ue,Ge,Ze;const{url:He,result:We}=ze.data;We?(Ue=(je=he.get(He))==null?void 0:je.resolve)==null||Ue.call(je,We):(Ze=(Ge=he.get(He))==null?void 0:Ge.reject)==null||Ze.call(Ge,new Error(`Error receiving message from worker: ${He}`))},Ne.onmessageerror=ze=>{var We,je;const{url:He}=ze.data;(je=(We=he.get(He))==null?void 0:We.reject)==null||je.call(We,new Error(`Error receiving message from worker: ${He}`))},Ne}catch(Ne){return fe.log.warn("Failed to new Worker",Ne),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[supportWebp(le)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:he,drawImageCount:0,tasks:[],features:ae,isEnable:Ne=>Ne==="restoreScrollPosition"?typeof ae=="boolean"?!1:ae[Ne]??!1:typeof ae=="boolean"?ae:ae[Ne]??!0,shadowRoots:[]};fe.log.time("wait until load"),await waitUntilLoad(ie,{timeout:fe.timeout,onWarn:fe.log.warn}),fe.log.timeEnd("wait until load");const{width:Ae,height:pe}=resolveBoundingBox(ie,fe);return fe.width=Ae,fe.height=pe,fe}function createStyleElement(ie){if(!ie)return;const te=ie.createElement("style"),ee=te.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return te.appendChild(ee),te}function resolveBoundingBox(ie,te){let{width:ee,height:ne}=te;if(isElementNode(ie)&&(!ee||!ne)){const re=ie.getBoundingClientRect();ee=ee||re.width||Number(ie.getAttribute("width"))||0,ne=ne||re.height||Number(ie.getAttribute("height"))||0}return{width:ee,height:ne}}async function imageToCanvas(ie,te){const{log:ee,timeout:ne,drawImageCount:re,drawImageInterval:se}=te;ee.time("image to canvas");const ae=await loadMedia(ie,{timeout:ne,onWarn:te.log.warn}),{canvas:le,context2d:ce}=createCanvas(ie.ownerDocument,te),he=()=>{try{ce==null||ce.drawImage(ae,0,0,le.width,le.height)}catch(fe){te.log.warn("Failed to drawImage",fe)}};if(he(),te.isEnable("fixSvgXmlDecode"))for(let fe=0;fe<re;fe++)await new Promise(Ae=>{setTimeout(()=>{he(),Ae()},fe+se)});return te.drawImageCount=0,ee.timeEnd("image to canvas"),le}function createCanvas(ie,te){const{width:ee,height:ne,scale:re,backgroundColor:se,maximumCanvasSize:ae}=te,le=ie.createElement("canvas");le.width=Math.floor(ee*re),le.height=Math.floor(ne*re),le.style.width=`${ee}px`,le.style.height=`${ne}px`,ae&&(le.width>ae||le.height>ae)&&(le.width>ae&&le.height>ae?le.width>le.height?(le.height*=ae/le.width,le.width=ae):(le.width*=ae/le.height,le.height=ae):le.width>ae?(le.height*=ae/le.width,le.width=ae):(le.width*=ae/le.height,le.height=ae));const ce=le.getContext("2d");return ce&&se&&(ce.fillStyle=se,ce.fillRect(0,0,le.width,le.height)),{canvas:le,context2d:ce}}function cloneCanvas(ie,te){if(ie.ownerDocument)try{const se=ie.toDataURL();if(se!=="data:,")return createImage(se,ie.ownerDocument)}catch(se){te.log.warn("Failed to clone canvas",se)}const ee=ie.cloneNode(!1),ne=ie.getContext("2d"),re=ee.getContext("2d");try{return ne&&re&&re.putImageData(ne.getImageData(0,0,ie.width,ie.height),0,0),ee}catch(se){te.log.warn("Failed to clone canvas",se)}return ee}function cloneIframe(ie,te){var ee;try{if((ee=ie==null?void 0:ie.contentDocument)!=null&&ee.body)return cloneNode(ie.contentDocument.body,te)}catch(ne){te.log.warn("Failed to clone iframe",ne)}return ie.cloneNode(!1)}function cloneImage(ie){const te=ie.cloneNode(!1);return ie.currentSrc&&ie.currentSrc!==ie.src&&(te.src=ie.currentSrc,te.srcset=""),te.loading==="lazy"&&(te.loading="eager"),te}async function cloneVideo(ie,te){if(ie.ownerDocument&&!ie.currentSrc&&ie.poster)return createImage(ie.poster,ie.ownerDocument);const ee=ie.cloneNode(!1);ee.crossOrigin="anonymous",ie.currentSrc&&ie.currentSrc!==ie.src&&(ee.src=ie.currentSrc);const ne=ee.ownerDocument;if(ne){let re=!0;if(await loadMedia(ee,{onError:()=>re=!1,onWarn:te.log.warn}),!re)return ie.poster?createImage(ie.poster,ie.ownerDocument):ee;ee.currentTime=ie.currentTime,await new Promise(ae=>{ee.addEventListener("seeked",ae,{once:!0})});const se=ne.createElement("canvas");se.width=ie.offsetWidth,se.height=ie.offsetHeight;try{const ae=se.getContext("2d");ae&&ae.drawImage(ee,0,0,se.width,se.height)}catch(ae){return te.log.warn("Failed to clone video",ae),ie.poster?createImage(ie.poster,ie.ownerDocument):ee}return cloneCanvas(se,te)}return ee}function cloneElement(ie,te){return isCanvasElement(ie)?cloneCanvas(ie,te):isIFrameElement(ie)?cloneIframe(ie,te):isImageElement(ie)?cloneImage(ie):isVideoElement(ie)?cloneVideo(ie,te):ie.cloneNode(!1)}function getSandBox(ie){let te=ie.sandbox;if(!te){const{ownerDocument:ee}=ie;try{ee&&(te=ee.createElement("iframe"),te.id=`__SANDBOX__${uuid()}`,te.width="0",te.height="0",te.style.visibility="hidden",te.style.position="fixed",ee.body.appendChild(te),te.srcdoc='<!DOCTYPE html><meta charset="UTF-8"><title></title><body>',ie.sandbox=te)}catch(ne){ie.log.warn("Failed to getSandBox",ne)}}return te}const ignoredStyles=["width","height","-webkit-text-fill-color"],includedAttributes=["stroke","fill"];function getDefaultStyle(ie,te,ee){const{defaultComputedStyles:ne}=ee,re=ie.nodeName.toLowerCase(),se=isSVGElementNode(ie)&&re!=="svg",ae=se?includedAttributes.map(Ne=>[Ne,ie.getAttribute(Ne)]).filter(([,Ne])=>Ne!==null):[],le=[se&&"svg",re,ae.map((Ne,ze)=>`${Ne}=${ze}`).join(","),te].filter(Boolean).join(":");if(ne.has(le))return ne.get(le);const ce=getSandBox(ee),he=ce==null?void 0:ce.contentWindow;if(!he)return new Map;const fe=he==null?void 0:he.document;let Ae,pe;se?(Ae=fe.createElementNS(XMLNS,"svg"),pe=Ae.ownerDocument.createElementNS(Ae.namespaceURI,re),ae.forEach(([Ne,ze])=>{pe.setAttributeNS(null,Ne,ze)}),Ae.appendChild(pe)):Ae=pe=fe.createElement(re),pe.textContent=" ",fe.body.appendChild(Ae);const Oe=he.getComputedStyle(pe,te),Fe=new Map;for(let Ne=Oe.length,ze=0;ze<Ne;ze++){const He=Oe.item(ze);ignoredStyles.includes(He)||Fe.set(He,Oe.getPropertyValue(He))}return fe.body.removeChild(Ae),ne.set(le,Fe),Fe}function getDiffStyle(ie,te,ee){var le;const ne=new Map,re=[],se=new Map;if(ee)for(const ce of ee)ae(ce);else for(let ce=ie.length,he=0;he<ce;he++){const fe=ie.item(he);ae(fe)}for(let ce=re.length,he=0;he<ce;he++)(le=se.get(re[he]))==null||le.forEach((fe,Ae)=>ne.set(Ae,fe));function ae(ce){const he=ie.getPropertyValue(ce),fe=ie.getPropertyPriority(ce),Ae=ce.lastIndexOf("-"),pe=Ae>-1?ce.substring(0,Ae):void 0;if(pe){let Oe=se.get(pe);Oe||(Oe=new Map,se.set(pe,Oe)),Oe.set(ce,[he,fe])}te.get(ce)===he&&!fe||(pe?re.push(pe):ne.set(ce,[he,fe]))}return ne}function copyCssStyles(ie,te,ee,ne){var Ae,pe,Oe,Fe;const{ownerWindow:re,includeStyleProperties:se,currentParentNodeStyle:ae}=ne,le=te.style,ce=re.getComputedStyle(ie),he=getDefaultStyle(ie,null,ne);ae==null||ae.forEach((Ne,ze)=>{he.delete(ze)});const fe=getDiffStyle(ce,he,se);fe.delete("transition-property"),fe.delete("all"),fe.delete("d"),fe.delete("content"),ee&&(fe.delete("margin-top"),fe.delete("margin-right"),fe.delete("margin-bottom"),fe.delete("margin-left"),fe.delete("margin-block-start"),fe.delete("margin-block-end"),fe.delete("margin-inline-start"),fe.delete("margin-inline-end"),fe.set("box-sizing",["border-box",""])),((Ae=fe.get("background-clip"))==null?void 0:Ae[0])==="text"&&te.classList.add("______background-clip--text"),IN_CHROME&&(fe.has("font-kerning")||fe.set("font-kerning",["normal",""]),(((pe=fe.get("overflow-x"))==null?void 0:pe[0])==="hidden"||((Oe=fe.get("overflow-y"))==null?void 0:Oe[0])==="hidden")&&((Fe=fe.get("text-overflow"))==null?void 0:Fe[0])==="ellipsis"&&ie.scrollWidth===ie.clientWidth&&fe.set("text-overflow",["clip",""]));for(let Ne=le.length,ze=0;ze<Ne;ze++)le.removeProperty(le.item(ze));return fe.forEach(([Ne,ze],He)=>{le.setProperty(He,Ne,ze)}),fe}function copyInputValue(ie,te){(isTextareaElement(ie)||isInputElement(ie)||isSelectElement(ie))&&te.setAttribute("value",ie.value)}const pseudoClasses=[":before",":after"],scrollbarPseudoClasses=[":-webkit-scrollbar",":-webkit-scrollbar-button",":-webkit-scrollbar-thumb",":-webkit-scrollbar-track",":-webkit-scrollbar-track-piece",":-webkit-scrollbar-corner",":-webkit-resizer"];function copyPseudoClass(ie,te,ee,ne,re){const{ownerWindow:se,svgStyleElement:ae,svgStyles:le,currentNodeStyle:ce}=ne;if(!ae||!se)return;function he(fe){var je;const Ae=se.getComputedStyle(ie,fe);let pe=Ae.getPropertyValue("content");if(!pe||pe==="none")return;re==null||re(pe),pe=pe.replace(/(')|(")|(counter\(.+\))/g,"");const Oe=[uuid()],Fe=getDefaultStyle(ie,fe,ne);ce==null||ce.forEach((Ue,Ge)=>{Fe.delete(Ge)});const Ne=getDiffStyle(Ae,Fe,ne.includeStyleProperties);Ne.delete("content"),Ne.delete("-webkit-locale"),((je=Ne.get("background-clip"))==null?void 0:je[0])==="text"&&te.classList.add("______background-clip--text");const ze=[`content: '${pe}';`];if(Ne.forEach(([Ue,Ge],Ze)=>{ze.push(`${Ze}: ${Ue}${Ge?" !important":""};`)}),ze.length===1)return;try{te.className=[te.className,...Oe].join(" ")}catch(Ue){ne.log.warn("Failed to copyPseudoClass",Ue);return}const He=ze.join(`
  `);let We=le.get(He);We||(We=[],le.set(He,We)),We.push(`.${Oe[0]}:${fe}`)}pseudoClasses.forEach(he),ee&&scrollbarPseudoClasses.forEach(he)}const excludeParentNodes=new Set(["symbol"]);async function appendChildNode(ie,te,ee,ne,re){if(isElementNode(ee)&&(isStyleElement(ee)||isScriptElement(ee))||ne.filter&&!ne.filter(ee))return;excludeParentNodes.has(te.nodeName)||excludeParentNodes.has(ee.nodeName)?ne.currentParentNodeStyle=void 0:ne.currentParentNodeStyle=ne.currentNodeStyle;const se=await cloneNode(ee,ne,!1,re);ne.isEnable("restoreScrollPosition")&&restoreScrollPosition(ie,se),te.appendChild(se)}async function cloneChildNodes(ie,te,ee,ne){var se;let re=ie.firstChild;isElementNode(ie)&&ie.shadowRoot&&(re=(se=ie.shadowRoot)==null?void 0:se.firstChild,ee.shadowRoots.push(ie.shadowRoot));for(let ae=re;ae;ae=ae.nextSibling)if(!isCommentNode(ae))if(isElementNode(ae)&&isSlotElement(ae)&&typeof ae.assignedNodes=="function"){const le=ae.assignedNodes();for(let ce=0;ce<le.length;ce++)await appendChildNode(ie,te,le[ce],ee,ne)}else await appendChildNode(ie,te,ae,ee,ne)}function restoreScrollPosition(ie,te){if(!isHTMLElementNode(ie)||!isHTMLElementNode(te))return;const{scrollTop:ee,scrollLeft:ne}=ie;if(!ee&&!ne)return;const{transform:re}=te.style,se=new DOMMatrix(re),{a:ae,b:le,c:ce,d:he}=se;se.a=1,se.b=0,se.c=0,se.d=1,se.translateSelf(-ne,-ee),se.a=ae,se.b=le,se.c=ce,se.d=he,te.style.transform=se.toString()}function applyCssStyleWithOptions(ie,te){const{backgroundColor:ee,width:ne,height:re,style:se}=te,ae=ie.style;if(ee&&ae.setProperty("background-color",ee,"important"),ne&&ae.setProperty("width",`${ne}px`,"important"),re&&ae.setProperty("height",`${re}px`,"important"),se)for(const le in se)ae[le]=se[le]}const NORMAL_ATTRIBUTE_RE=/^[\w-:]+$/;async function cloneNode(ie,te,ee=!1,ne){var ce,he,fe,Ae;const{ownerDocument:re,ownerWindow:se,fontFamilies:ae}=te;if(re&&isTextNode(ie))return ne&&/\S/.test(ie.data)&&ne(ie.data),re.createTextNode(ie.data);if(re&&se&&isElementNode(ie)&&(isHTMLElementNode(ie)||isSVGElementNode(ie))){const pe=await cloneElement(ie,te);if(te.isEnable("removeAbnormalAttributes")){const We=pe.getAttributeNames();for(let je=We.length,Ue=0;Ue<je;Ue++){const Ge=We[Ue];NORMAL_ATTRIBUTE_RE.test(Ge)||pe.removeAttribute(Ge)}}const Oe=te.currentNodeStyle=copyCssStyles(ie,pe,ee,te);ee&&applyCssStyleWithOptions(pe,te);let Fe=!1;if(te.isEnable("copyScrollbar")){const We=[(ce=Oe.get("overflow-x"))==null?void 0:ce[0],(he=Oe.get("overflow-y"))==null?void 0:he[0]];Fe=We.includes("scroll")||(We.includes("auto")||We.includes("overlay"))&&(ie.scrollHeight>ie.clientHeight||ie.scrollWidth>ie.clientWidth)}const Ne=(fe=Oe.get("text-transform"))==null?void 0:fe[0],ze=splitFontFamily((Ae=Oe.get("font-family"))==null?void 0:Ae[0]),He=ze?We=>{Ne==="uppercase"?We=We.toUpperCase():Ne==="lowercase"?We=We.toLowerCase():Ne==="capitalize"&&(We=We[0].toUpperCase()+We.substring(1)),ze.forEach(je=>{let Ue=ae.get(je);Ue||ae.set(je,Ue=new Set),We.split("").forEach(Ge=>Ue.add(Ge))})}:void 0;return copyPseudoClass(ie,pe,Fe,te,He),copyInputValue(ie,pe),isVideoElement(ie)||await cloneChildNodes(ie,pe,te,He),pe}const le=ie.cloneNode(!1);return await cloneChildNodes(ie,le,te),le}function destroyContext(ie){if(ie.ownerDocument=void 0,ie.ownerWindow=void 0,ie.svgStyleElement=void 0,ie.svgDefsElement=void 0,ie.svgStyles.clear(),ie.defaultComputedStyles.clear(),ie.sandbox){try{ie.sandbox.remove()}catch(te){ie.log.warn("Failed to destroyContext",te)}ie.sandbox=void 0}ie.workers=[],ie.fontFamilies.clear(),ie.fontCssTexts.clear(),ie.requests.clear(),ie.tasks=[],ie.shadowRoots=[]}function baseFetch(ie){const{url:te,timeout:ee,responseType:ne,...re}=ie,se=new AbortController,ae=ee?setTimeout(()=>se.abort(),ee):void 0;return fetch(te,{signal:se.signal,...re}).then(le=>{if(!le.ok)throw new Error("Failed fetch, not 2xx response",{cause:le});switch(ne){case"arrayBuffer":return le.arrayBuffer();case"dataUrl":return le.blob().then(blobToDataUrl);case"text":default:return le.text()}}).finally(()=>clearTimeout(ae))}function contextFetch(ie,te){const{url:ee,requestType:ne="text",responseType:re="text",imageDom:se}=te;let ae=ee;const{timeout:le,acceptOfImage:ce,requests:he,fetchFn:fe,fetch:{requestInit:Ae,bypassingCache:pe,placeholderImage:Oe},font:Fe,workers:Ne,fontFamilies:ze}=ie;ne==="image"&&(IN_SAFARI||IN_FIREFOX)&&ie.drawImageCount++;let He=he.get(ee);if(!He){pe&&pe instanceof RegExp&&pe.test(ae)&&(ae+=(/\?/.test(ae)?"&":"?")+new Date().getTime());const We=ne.startsWith("font")&&Fe&&Fe.minify,je=new Set;We&&ne.split(";")[1].split(",").forEach(Ye=>{ze.has(Ye)&&ze.get(Ye).forEach(qe=>je.add(qe))});const Ue=We&&je.size,Ge={url:ae,timeout:le,responseType:Ue?"arrayBuffer":re,headers:ne==="image"?{accept:ce}:void 0,...Ae};He={type:ne,resolve:void 0,reject:void 0,response:null},He.response=(async()=>{if(fe&&ne==="image"){const Ze=await fe(ee);if(Ze)return Ze}return!IN_SAFARI&&ee.startsWith("http")&&Ne.length?new Promise((Ze,Ye)=>{Ne[he.size&Ne.length-1].postMessage({rawUrl:ee,...Ge}),He.resolve=Ze,He.reject=Ye}):baseFetch(Ge)})().catch(Ze=>{if(he.delete(ee),ne==="image"&&Oe)return ie.log.warn("Failed to fetch image base64, trying to use placeholder image",ae),typeof Oe=="string"?Oe:Oe(se);throw Ze}),he.set(ee,He)}return He.response}async function replaceCssUrlToDataUrl(ie,te,ee,ne){if(!hasCssUrl(ie))return ie;for(const[re,se]of parseCssUrls(ie,te))try{const ae=await contextFetch(ee,{url:se,requestType:ne?"image":"text",responseType:"dataUrl"});ie=ie.replace(toRE(re),`$1${ae}$3`)}catch(ae){ee.log.warn("Failed to fetch css data url",re,ae)}return ie}function hasCssUrl(ie){return/url\((['"]?)([^'"]+?)\1\)/.test(ie)}const URL_RE=/url\((['"]?)([^'"]+?)\1\)/g;function parseCssUrls(ie,te){const ee=[];return ie.replace(URL_RE,(ne,re,se)=>(ee.push([se,resolveUrl(se,te)]),ne)),ee.filter(([ne])=>!isDataUrl(ne))}function toRE(ie){const te=ie.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${te})(['"]?\\))`,"g")}const properties=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function embedCssStyleImage(ie,te){return properties.map(ee=>{const ne=ie.getPropertyValue(ee);return!ne||ne==="none"?null:((IN_SAFARI||IN_FIREFOX)&&te.drawImageCount++,replaceCssUrlToDataUrl(ne,null,te,!0).then(re=>{!re||ne===re||ie.setProperty(ee,re,ie.getPropertyPriority(ee))}))}).filter(Boolean)}function embedImageElement(ie,te){if(isImageElement(ie)){const ee=ie.currentSrc||ie.src;if(!isDataUrl(ee))return[contextFetch(te,{url:ee,imageDom:ie,requestType:"image",responseType:"dataUrl"}).then(ne=>{ne&&(ie.srcset="",ie.dataset.originalSrc=ee,ie.src=ne||"")})];(IN_SAFARI||IN_FIREFOX)&&te.drawImageCount++}else if(isSVGElementNode(ie)&&!isDataUrl(ie.href.baseVal)){const ee=ie.href.baseVal;return[contextFetch(te,{url:ee,imageDom:ie,requestType:"image",responseType:"dataUrl"}).then(ne=>{ne&&(ie.dataset.originalSrc=ee,ie.href.baseVal=ne||"")})]}return[]}function embedSvgUse(ie,te){const{ownerDocument:ee,svgDefsElement:ne}=te,re=ie.getAttribute("href")??ie.getAttribute("xlink:href");if(!re)return[];const[se,ae]=re.split("#");if(ae){const le=`#${ae}`,ce=te.shadowRoots.reduce((he,fe)=>he??fe.querySelector(`svg ${le}`),ee==null?void 0:ee.querySelector(`svg ${le}`));if(se&&ie.setAttribute("href",le),ne!=null&&ne.querySelector(le))return[];if(ce)return ne==null||ne.appendChild(ce.cloneNode(!0)),[];if(se)return[contextFetch(te,{url:se,responseType:"text"}).then(he=>{ne==null||ne.insertAdjacentHTML("beforeend",he)})]}return[]}function embedNode(ie,te){const{tasks:ee}=te;isElementNode(ie)&&((isImageElement(ie)||isSVGImageElementNode(ie))&&ee.push(...embedImageElement(ie,te)),isSVGUseElementNode(ie)&&ee.push(...embedSvgUse(ie,te))),isHTMLElementNode(ie)&&ee.push(...embedCssStyleImage(ie.style,te)),ie.childNodes.forEach(ne=>{embedNode(ne,te)})}async function embedWebFont(ie,te){const{ownerDocument:ee,svgStyleElement:ne,fontFamilies:re,fontCssTexts:se,tasks:ae,font:le}=te;if(!(!ee||!ne||!re.size))if(le&&le.cssText){const ce=filterPreferredFormat(le.cssText,te);ne.appendChild(ee.createTextNode(`${ce}
`))}else{const ce=Array.from(ee.styleSheets).filter(fe=>{try{return"cssRules"in fe&&!!fe.cssRules.length}catch(Ae){return te.log.warn(`Error while reading CSS rules from ${fe.href}`,Ae),!1}});await Promise.all(ce.flatMap(fe=>Array.from(fe.cssRules).map(async(Ae,pe)=>{if(isCSSImportRule(Ae)){let Oe=pe+1;const Fe=Ae.href;let Ne="";try{Ne=await contextFetch(te,{url:Fe,requestType:"text",responseType:"text"})}catch(He){te.log.warn(`Error fetch remote css import from ${Fe}`,He)}const ze=Ne.replace(URL_RE,(He,We,je)=>He.replace(je,resolveUrl(je,Fe)));for(const He of parseCss(ze))try{fe.insertRule(He,He.startsWith("@import")?Oe+=1:fe.cssRules.length)}catch(We){te.log.warn("Error inserting rule from remote css import",{rule:He,error:We})}}}))),ce.flatMap(fe=>Array.from(fe.cssRules)).filter(fe=>{var Ae;return isCssFontFaceRule(fe)&&hasCssUrl(fe.style.getPropertyValue("src"))&&((Ae=splitFontFamily(fe.style.getPropertyValue("font-family")))==null?void 0:Ae.some(pe=>re.has(pe)))}).forEach(fe=>{const Ae=fe,pe=se.get(Ae.cssText);pe?ne.appendChild(ee.createTextNode(`${pe}
`)):ae.push(replaceCssUrlToDataUrl(Ae.cssText,Ae.parentStyleSheet?Ae.parentStyleSheet.href:null,te).then(Oe=>{Oe=filterPreferredFormat(Oe,te),se.set(Ae.cssText,Oe),ne.appendChild(ee.createTextNode(`${Oe}
`))}))})}}const COMMENTS_RE=/(\/\*[\s\S]*?\*\/)/g,KEYFRAMES_RE=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function parseCss(ie){if(ie==null)return[];const te=[];let ee=ie.replace(COMMENTS_RE,"");for(;;){const se=KEYFRAMES_RE.exec(ee);if(!se)break;te.push(se[0])}ee=ee.replace(KEYFRAMES_RE,"");const ne=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,re=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let se=ne.exec(ee);if(se)re.lastIndex=ne.lastIndex;else if(se=re.exec(ee),se)ne.lastIndex=re.lastIndex;else break;te.push(se[0])}return te}const URL_WITH_FORMAT_RE=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,FONT_SRC_RE=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function filterPreferredFormat(ie,te){const{font:ee}=te,ne=ee?ee==null?void 0:ee.preferredFormat:void 0;return ne?ie.replace(FONT_SRC_RE,re=>{for(;;){const[se,,ae]=URL_WITH_FORMAT_RE.exec(re)||[];if(!ae)return"";if(ae===ne)return`src: ${se};`}}):ie}async function domToForeignObjectSvg(ie,te){const ee=await orCreateContext(ie,te);if(isElementNode(ee.node)&&isSVGElementNode(ee.node))return ee.node;const{ownerDocument:ne,log:re,tasks:se,svgStyleElement:ae,svgDefsElement:le,svgStyles:ce,font:he,progress:fe,autoDestruct:Ae,onCloneNode:pe,onEmbedNode:Oe,onCreateForeignObjectSvg:Fe}=ee;re.time("clone node");const Ne=await cloneNode(ee.node,ee,!0);if(ae&&ne){let Ue="";ce.forEach((Ge,Ze)=>{Ue+=`${Ge.join(`,
`)} {
  ${Ze}
}
`}),ae.appendChild(ne.createTextNode(Ue))}re.timeEnd("clone node"),await(pe==null?void 0:pe(Ne)),he!==!1&&isElementNode(Ne)&&(re.time("embed web font"),await embedWebFont(Ne,ee),re.timeEnd("embed web font")),re.time("embed node"),embedNode(Ne,ee);const ze=se.length;let He=0;const We=async()=>{for(;;){const Ue=se.pop();if(!Ue)break;try{await Ue}catch(Ge){ee.log.warn("Failed to run task",Ge)}fe==null||fe(++He,ze)}};fe==null||fe(He,ze),await Promise.all([...Array.from({length:4})].map(We)),re.timeEnd("embed node"),await(Oe==null?void 0:Oe(Ne));const je=createForeignObjectSvg(Ne,ee);return le&&je.insertBefore(le,je.children[0]),ae&&je.insertBefore(ae,je.children[0]),Ae&&destroyContext(ee),await(Fe==null?void 0:Fe(je)),je}function createForeignObjectSvg(ie,te){const{width:ee,height:ne}=te,re=createSvg(ee,ne,ie.ownerDocument),se=re.ownerDocument.createElementNS(re.namespaceURI,"foreignObject");return se.setAttributeNS(null,"x","0%"),se.setAttributeNS(null,"y","0%"),se.setAttributeNS(null,"width","100%"),se.setAttributeNS(null,"height","100%"),se.append(ie),re.appendChild(se),re}async function domToCanvas(ie,te){var ae;const ee=await orCreateContext(ie,te),ne=await domToForeignObjectSvg(ee),re=svgToDataUrl(ne,ee.isEnable("removeControlCharacter"));ee.autoDestruct||(ee.svgStyleElement=createStyleElement(ee.ownerDocument),ee.svgDefsElement=(ae=ee.ownerDocument)==null?void 0:ae.createElementNS(XMLNS,"defs"),ee.svgStyles.clear());const se=createImage(re,ne.ownerDocument);return await imageToCanvas(se,ee)}async function domToBlob(ie,te){const ee=await orCreateContext(ie,te),{log:ne,type:re,quality:se,dpi:ae}=ee,le=await domToCanvas(ee);ne.time("canvas to blob");const ce=await canvasToBlob(le,re,se);if(["image/png","image/jpeg"].includes(re)&&ae){const he=await blobToArrayBuffer(ce.slice(0,33));let fe=new Uint8Array(he);return re==="image/png"?fe=changePngDpi(fe,ae):re==="image/jpeg"&&(fe=changeJpegDpi(fe,ae)),ne.timeEnd("canvas to blob"),new Blob([fe,ce.slice(33)],{type:re})}return ne.timeEnd("canvas to blob"),ce}async function domToDataUrl(ie,te){const ee=await orCreateContext(ie,te),{log:ne,quality:re,type:se,dpi:ae}=ee,le=await domToCanvas(ee);ne.time("canvas to data url");let ce=le.toDataURL(se,re);if(["image/png","image/jpeg"].includes(se)&&ae&&SUPPORT_ATOB&&SUPPORT_BTOA){const[he,fe]=ce.split(",");let Ae=0,pe=!1;if(se==="image/png"){const je=detectPhysChunkFromDataUrl(fe);je>=0?(Ae=Math.ceil((je+28)/3)*4,pe=!0):Ae=33/3*4}else se==="image/jpeg"&&(Ae=18/3*4);const Oe=fe.substring(0,Ae),Fe=fe.substring(Ae),Ne=window.atob(Oe),ze=new Uint8Array(Ne.length);for(let je=0;je<ze.length;je++)ze[je]=Ne.charCodeAt(je);const He=se==="image/png"?changePngDpi(ze,ae,pe):changeJpegDpi(ze,ae),We=window.btoa(String.fromCharCode(...He));ce=[he,",",We,Fe].join("")}return ne.timeEnd("canvas to data url"),ce}async function domToPng(ie,te){return domToDataUrl(await orCreateContext(ie,{...te,type:"image/png"}))}const onpointerup=(ie,te)=>{get$2(te).setOpen(!0)};var root_1=from_html('<button class="snapshot svelte-1icyvc2"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="svelte-1icyvc2"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.118 6a.5.5 0 0 0-.447.276L9.809 8H5.5A1.5 1.5 0 0 0 4 9.5v10A1.5 1.5 0 0 0 5.5 21h16a1.5 1.5 0 0 0 1.5-1.5v-10A1.5 1.5 0 0 0 21.5 8h-4.309l-.862-1.724A.5.5 0 0 0 15.882 6h-4.764zm-1.342-.17A1.5 1.5 0 0 1 11.118 5h4.764a1.5 1.5 0 0 1 1.342.83L17.809 7H21.5A2.5 2.5 0 0 1 24 9.5v10a2.5 2.5 0 0 1-2.5 2.5h-16A2.5 2.5 0 0 1 3 19.5v-10A2.5 2.5 0 0 1 5.5 7h3.691l.585-1.17z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 18a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zm0 1a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9z"></path></svg></button> <!>',1),root_5$1=from_html('<span class="rowIcon svelte-1icyvc2"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none"><path stroke="currentColor" d="M6.5 16v4.5a1 1 0 001 1h14a1 1 0 001-1V16M14.5 5V17m-4-3.5l4 4l4-4"></path></svg></span> <span class="rowLabel svelte-1icyvc2"> </span> <span class="keyBinding svelte-1icyvc2"> </span>',1),root_6=from_html('<span class="rowIcon svelte-1icyvc2"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"></path><path d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"></path></g></svg></span> <span class="rowLabel svelte-1icyvc2"> </span> <span class="keyBinding svelte-1icyvc2"> </span>',1),root_4$1=from_html('<div class="title svelte-1icyvc2"> </div> <!> <!>',1),root_3$1=from_html('<div class="menu svelte-1icyvc2"><!></div>'),root$2=from_html("<div><!> <!></div>");function Snapshot(ie,te){push(te,!1);const{t:ee}=useTranslation(),ne=useService(IChartManagementService),re=useService(IClipboardService),se=useService(INotificationService),ae=useService(IKeybindingsRegistry),le=KeyCode.KeyS|KeyMod.Alt|KeyMod.CtrlCmd,ce=()=>{const Ne=ne.getDomElement();Ne&&domToPng(Ne).then(ze=>{const He=document.createElement("a");He.download="screenshot.png",He.href=ze,He.click()})};useDisposable(ae.registerCommandAndKeybindingRule({id:"snapshot.download",primary:le,weight:KeybindingWeight.ChartContrib,handler(){ce()}}));const he=KeyCode.KeyS|KeyMod.Shift|KeyMod.CtrlCmd,fe=()=>{const Ne=ne.getDomElement();Ne&&domToBlob(Ne).then(ze=>{const He=new File([ze],"screenshot.png",{type:"image/png",lastModified:Date.now()});re.writeClipboard({files:[He]}),se.verbose(ee("topToolbar.snapshot.copyImage.success"))})};useDisposable(ae.registerCommandAndKeybindingRule({id:"snapshot.copy",primary:he,weight:KeybindingWeight.ChartContrib,handler(){fe()}}));let Ae=mutable_source();onDestroy(()=>{set(Ae,null)}),init$1();var pe=root$2(),Oe=child(pe);Wrapper(Oe,{children:(Ne,ze)=>{var He=root_1(),We=first_child(He);We.__pointerup=[onpointerup,Ae];var je=sibling(We,2);Tooltip(je,{children:(Ue,Ge)=>{{let Ze=derived_safe_equal(()=>ee("topToolbar.snapshot"));TooltipContent(Ue,{get content(){return get$2(Ze)}})}},$$slots:{default:!0}}),append(Ne,He)},$$slots:{default:!0}});var Fe=sibling(Oe,2);bind_this(Menu(Fe,{anchorCorner:"BOTTOM_LEFT",quickOpen:!0,class:"cl-dropdown",children:(Ne,ze)=>{var He=root_3$1(),We=child(He);List(We,{children:(je,Ue)=>{var Ge=root_4$1(),Ze=first_child(Ge),Ye=child(Ze),qe=sibling(Ze,2);Item(qe,{tag:"div",class:"row",onpointerup:ce,children:(ir,tr)=>{var or=root_5$1(),Jt=sibling(first_child(or),2),rr=child(Jt),lr=sibling(Jt,2),ur=child(lr);template_effect((Sr,xr)=>{set_text(rr,Sr),set_text(ur,xr)},[()=>ee("topToolbar.snapshot.downloadImage"),()=>getKeybindingLabel(le)]),append(ir,or)},$$slots:{default:!0}});var nr=sibling(qe,2);Item(nr,{tag:"div",class:"row",onpointerup:fe,children:(ir,tr)=>{var or=root_6(),Jt=sibling(first_child(or),2),rr=child(Jt),lr=sibling(Jt,2),ur=child(lr);template_effect((Sr,xr)=>{set_text(rr,Sr),set_text(ur,xr)},[()=>ee("topToolbar.snapshot.copyImage"),()=>getKeybindingLabel(he)]),append(ir,or)},$$slots:{default:!0}}),template_effect(ir=>set_text(Ye,ir),[()=>ee("topToolbar.snapshot.menu.title")]),append(je,Ge)},$$slots:{default:!0}}),append(Ne,He)},$$slots:{default:!0},$$legacy:!0}),Ne=>set(Ae,Ne),()=>get$2(Ae)),append(ie,pe),pop()}delegate(["pointerup"]);var root_2=from_html("<!> <!>",1),root_3=from_html("<!> <!>",1),root_4=from_html("<!> <!>",1),root_5=from_html("<!> <!>",1),root_9=from_html("<!> <!>",1),root$1=from_html('<div class="top svelte-3jg4ln"><!> <!> <!> <!> <div class="space svelte-3jg4ln"></div> <!> <!> <!> <!> <!></div>');function Top(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(fe,"$features",ee),se=()=>store_get(he,"$leftButtons",ee),ae=()=>store_get(Ae,"$rightButtons",ee),le=useService(IGuiService),ce=useService(IConfigurationService),he=derived(le.store,Jt=>Jt.leftButtons),fe=derived(ce.store,Jt=>Jt.chartFeatures),Ae=derived(le.store,Jt=>Jt.rightButtons);onMount(()=>{le.setHeaderReady()}),init$1();var pe=root$1(),Oe=child(pe);{var Fe=Jt=>{Interval(Jt,{})};if_block(Oe,Jt=>{re().header_resolutions&&Jt(Fe)})}var Ne=sibling(Oe,2);{var ze=Jt=>{var rr=root_2(),lr=first_child(rr);Separator(lr);var ur=sibling(lr,2);ChartStyle(ur,{}),append(Jt,rr)};if_block(Ne,Jt=>{re().header_chart_type&&Jt(ze)})}var He=sibling(Ne,2);{var We=Jt=>{var rr=root_3(),lr=first_child(rr);Separator(lr);var ur=sibling(lr,2);Indicator(ur,{}),append(Jt,rr)};if_block(He,Jt=>{re().header_indicators&&Jt(We)})}var je=sibling(He,2);each(je,1,se,Jt=>Jt.id,(Jt,rr)=>{var lr=root_4(),ur=first_child(lr);Separator(ur);var Sr=sibling(ur,2);CustomButton(Sr,spread_props(()=>get$2(rr))),append(Jt,lr)});var Ue=sibling(je,4);{var Ge=Jt=>{var rr=root_5(),lr=first_child(rr);Layout(lr,{});var ur=sibling(lr,2);Separator(ur),append(Jt,rr)};if_block(Ue,Jt=>{re().header_layouttoggle&&Jt(Ge)})}var Ze=sibling(Ue,2);{var Ye=Jt=>{Setting(Jt,{})};if_block(Ze,Jt=>{re().header_settings&&Jt(Ye)})}var qe=sibling(Ze,2);{var nr=Jt=>{Fullscreen(Jt,{})};if_block(qe,Jt=>{re().header_fullscreen_button&&Jt(nr)})}var ir=sibling(qe,2);{var tr=Jt=>{Snapshot(Jt,{})};if_block(ir,Jt=>{re().header_screenshot&&Jt(tr)})}var or=sibling(ir,2);each(or,1,ae,Jt=>Jt.id,(Jt,rr)=>{var lr=root_9(),ur=first_child(lr);Separator(ur);var Sr=sibling(ur,2);CustomButton(Sr,spread_props(()=>get$2(rr))),append(Jt,lr)}),append(ie,pe),pop(),ne()}var root=from_html('<!> <div class="contentWrap svelte-1e54wn5"><!> <div class="centerWrap svelte-1e54wn5"><!></div></div> <!>',1);function App(ie,te){push(te,!1);const[ee,ne]=setup_stores(),re=()=>store_get(ae,"$features",ee),se=useService(IConfigurationService),ae=derived(se.store,Ne=>Ne.chartFeatures);init$1();var le=root(),ce=first_child(le);Top(ce,{});var he=sibling(ce,2),fe=child(he);{var Ae=Ne=>{Left(Ne,{})};if_block(fe,Ne=>{re().left_toolbar&&Ne(Ae)})}var pe=sibling(fe,2),Oe=child(pe);Center(Oe,{});var Fe=sibling(he,2);Float(Fe),append(ie,le),pop(),ne()}var __getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(ie,te,ee,ne)=>{for(var re=ne>1?void 0:ne?__getOwnPropDesc(te,ee):te,se=ie.length-1,ae;se>=0;se--)(ae=ie[se])&&(re=ae(re)||re);return re},__decorateParam=(ie,te)=>(ee,ne)=>te(ee,ne,ie);let Workbench=class extends Disposable{constructor(te,ee,ne,re,se,ae,le){super();Ee(this,"_app",null);Ee(this,"whenRestoredPromise",new DeferredPromise);Ee(this,"whenRestored",this.whenRestoredPromise.p);this._container=te,this.configurationService=ee,this.chartManagementService=ne,this.instantiationService=re,this.i18nService=se,this.registerFocusHandler(),this.registerWorkbenchContributions(ae),this.registerChartContributions(le),re.invokeFunction(ce=>ae.start(ce))}dispose(){super.dispose(),this.whenRestoredPromise=null,this.whenRestored=null,this._container=null}registerFocusHandler(){this._register(addDisposableListener(window,"focusin",()=>{const te=this.chartManagementService.activeChart().getContainerDomElement(),ee=document.activeElement,ne=ee==null?void 0:ee.ownerDocument.defaultView,re=ne&&(ee instanceof ne.HTMLInputElement||ee instanceof ne.HTMLTextAreaElement);ee&&!re&&this._container.contains(ee)&&ee!==te&&te.focus()}))}registerWorkbenchContributions(te){te.register("drawing.registry",DrawingRegistryContrib,LifecyclePhase.Ready),te.register("keybinding.drawing",DrawingKeybindingContrib,LifecyclePhase.Restored),te.register("keybinding.priceScale",PriceScaleKeybindingContrib,LifecyclePhase.Restored),te.register("keybinding.undoRedo",UndoRedoKeybindingContrib,LifecyclePhase.Restored)}registerChartContributions(te){te.register("crosshairButton",CrosshairButtonContrib,ChartContributionInstantiation.Eager),te.register("execution",ExecutionContrib,ChartContributionInstantiation.Eager),te.register("tradeLIne",TradeLineContrib,ChartContributionInstantiation.Eager),te.register(DrawingContribId,DrawingContrib,ChartContributionInstantiation.AfterFirstRender)}startup(){this._container.className=ROOT_CLASSNAME;const te=new Map;te.set(IConfigurationService,this.configurationService),te.set(IInstantiationService,this.instantiationService),te.set(II18nService,this.i18nService),this._register(toDisposable(()=>{te.clear()}));const ee=[];ee.push(this.chartManagementService.whenRestored),this._app=mount(App,{target:this._container,context:te}),Promises.settled(ee).finally(()=>{this.whenRestoredPromise.complete()})}async teardown(){this._container.className="",this._app&&(await unmount(this._app),this._app=null),this.dispose(),clear_event_propagation(),remove_form_reset_listener()}};Workbench=__decorateClass([__decorateParam(1,IConfigurationService),__decorateParam(2,IChartManagementService),__decorateParam(3,IInstantiationService),__decorateParam(4,II18nService),__decorateParam(5,IWorkbenchContributionsRegistry),__decorateParam(6,IChartContributionRegistry)],Workbench);class Widget extends Disposable{constructor(ee){super();Ee(this,"workbench");Ee(this,"instantiationService");Ee(this,"guiService");Ee(this,"lifecycleService");Ee(this,"datafeedService");const ne=isString(ee.container)?document.querySelector(ee.container):ee.container;should(ne),document.documentElement.style.setProperty("--cl-font-family",ee.custom_font_family??ChartFontFamily),this.guiService=this._register(new GuiService),this.lifecycleService=this._register(new LifecycleService),this.lifecycleService.phase=LifecyclePhase.Ready,this.datafeedService=this._register(new DatafeedService(ee.datafeed));const re=new ServiceCollection;re.set(ILifecycleService,this.lifecycleService),re.set(IGuiService,this.guiService),re.set(IDatafeedService,this.datafeedService),re.set(IConfigurationService,new SyncDescriptor(ConfigurationService,[ee])),re.set(IThemeService,new SyncDescriptor(ThemeService,[ee.theme])),re.set(IClipboardService,new SyncDescriptor(ClipboardService,[ne])),re.set(IContextKeyService,new SyncDescriptor(ContextKeyService)),re.set(IChartManagementService,new SyncDescriptor(ChartManagementService)),re.set(IStudyService,new SyncDescriptor(StudyService)),re.set(ILogService,new SyncDescriptor(LogService,[new ConsoleLogger])),re.set(ICommandService,new SyncDescriptor(CommandService)),re.set(II18nService,new SyncDescriptor(I18nService,[ee.locale])),re.set(IToolService,new SyncDescriptor(ToolService)),re.set(ITradeService,new SyncDescriptor(TradeService,[ee.brokerFactory,ee.brokerConfig])),re.set(IKeybindingService,new SyncDescriptor(KeybindingService)),re.set(INotificationService,new SyncDescriptor(NotificationService)),re.set(IUndoRedoService,new SyncDescriptor(UndoRedoService)),re.set(IWorkbenchContributionsRegistry,new SyncDescriptor(WorkbenchContributionsRegistry)),re.set(IChartContributionRegistry,new SyncDescriptor(ChartContributionRegistry));const se=new ChartResolutionRegistry;re.set(IChartResolutionRegistry,se),re.set(ICommandRegistry,new SyncDescriptor(CommandRegistry)),re.set(IKeybindingsRegistry,new SyncDescriptor(KeybindingsRegistry)),re.set(IToolRegistry,new SyncDescriptor(ToolRegistry));const ae=new InstantiationService(re,!0);re.set(IInstantiationService,ae),re.set(IInputService,ae.createInstance(InputService)),this.instantiationService=this._register(ae),this.workbench=this._register(ae.createInstance(Workbench,ne)),this.workbench.startup(),this.workbench.whenRestored.then(()=>{this.lifecycleService.phase=LifecyclePhase.Restored}),this._register(new RunOnceScheduler(()=>{this._register(runWhenIdle(()=>this.lifecycleService.phase=LifecyclePhase.Eventually,1e3))},1e3)).schedule(),this._register(this.datafeedService.onReady(ce=>{Array.isArray(ce.supported_resolutions)&&ce.supported_resolutions.forEach(he=>{se.registerResolution(he)})}))}async remove(){await this.workbench.teardown(),this.dispose()}headerReady(){return this.guiService.headerReady()}onChartReady(ee){this.instantiationService.invokeFunction(async ne=>{ne.get(IChartManagementService).whenRestored.then(ee)})}createButton(ee){return this.guiService.createButton(ee)}applyOverrides(ee){this.instantiationService.invokeFunction(ne=>{const re=ne.get(IConfigurationService),se=re.getValue("chartProperties");re.setValue("chartProperties",Object.assign(se,ee))})}applyStudiesOverrides(ee){}getTheme(){return this.instantiationService.invokeFunction(ee=>ee.get(IThemeService).getColorTheme().type)}async changeTheme(ee){return this.instantiationService.invokeFunction(ne=>ne.get(IThemeService).setTheme(ee))}defineTheme(ee,ne){return this.instantiationService.invokeFunction(re=>re.get(IThemeService).defineTheme(ee,ne))}activeChart(){return this.instantiationService.invokeFunction(ee=>ee.get(IChartManagementService).activeChart())}}class Broker{constructor(te){Ee(this,"_orders",[]);Ee(this,"_positions",[]);Ee(this,"_executions",[]);this.host=te}async orders(){return this._orders}async positions(){return this._positions}async executions(){return this._executions}async cancelOrder(te){const ee=ensure(this._orders.find(re=>re.id===te));ee.status=OrderStatus.Canceled,this._orders.filter(re=>re.parentId===te).forEach(re=>{re.status!==OrderStatus.Canceled&&(re.status=OrderStatus.Canceled,this.host.orderUpdate(re))}),this.host.orderUpdate(ee)}async modifyOrder(te){const ee=ensure(this._orders.find(ne=>ne.id===te.id));te.price===ee.price&&(te.qty+=1),this.host.orderUpdate(te)}async closePosition(te,ee){return alert("close position: "+te),NOTIMPLEMENTED(te,ee)}async placeOrder(te){const ee=generateUuid(),ne={id:ee,qty:te.qty,side:te.side,status:OrderStatus.Working,symbol:te.symbol,type:te.type,price:te.price,parentType:te.parentType,parentId:te.parentId};return this._orders.push(ne),setTimeout(()=>{if(!isBracketOrder(ne)&&ne.status!==OrderStatus.Canceled&&ne.price){const re={id:generateUuid(),symbol:te.symbol,qty:te.qty,side:te.side,avgPrice:ne.price};this._positions.push(re),this.host.positionUpdate(re),ne.status=OrderStatus.Filled,this._orders.filter(le=>le.parentId===ee).forEach(le=>{le.status!==OrderStatus.Canceled&&(le.status=OrderStatus.Canceled,this.host.orderUpdate(le))}),this.host.orderUpdate(ne);const ae={time:Math.floor(Date.now()/1e3),symbol:te.symbol,qty:te.qty,side:te.side,price:ne.price};this._executions.push(ae),this.host.executionUpdate(ae)}},2e3),this.host.orderUpdate(ne),{orderId:ee}}}const TIMES_TAMP=60*1e3,BASE_URL$1="https://api.itick.org";class Request{constructor(te){Ee(this,"token");Ee(this,"resolutionsMap",{1:TIMES_TAMP,2:5*TIMES_TAMP,3:10*TIMES_TAMP,4:30*TIMES_TAMP,5:60*TIMES_TAMP,6:120*TIMES_TAMP,7:240*TIMES_TAMP,8:24*60*TIMES_TAMP,9:7*24*60*TIMES_TAMP,10:30*24*60*TIMES_TAMP});this.token=te}getKline(te){return new Promise((ee,ne)=>{const{symbolType:re,region:se,symbol:ae,resolution:le,et:ce,limit:he}=te;fetch(`${BASE_URL$1}/${re}/kline?region=${se}&code=${ae}&kType=${le}&et=${ce}&limit=${he}`,{headers:{token:this.token}}).then(fe=>fe.json()).then(fe=>{const{code:Ae,data:pe}=fe,Oe=[],Fe={noData:Ae!==0};for(const{t:Ne,c:ze,o:He,h:We,l:je,v:Ue}of pe)Oe.push({time:Ne,close:ze,open:He,high:We,low:je,volume:Ue});ee({bars:Oe,meta:Fe})}).catch(fe=>ne(fe))})}getSymbolList(te){let ee=`${BASE_URL$1}/symbol/list?`;for(const ne in te)ee+=`${ne}=${te[ne]}&`;return ee=ee.slice(0,-1),new Promise((ne,re)=>{fetch(ee,{headers:{token:this.token}}).then(se=>se.json()).then(se=>{const{code:ae,data:le}=se;ae===200?ne(le):re("查询失败")})})}getSymbolInfo(te){const[ee,ne]=te.split(":");return new Promise((re,se)=>{fetch(`${BASE_URL$1}/symbol/info?code=${ne}&exchange=${ee==="BINANCE"?"Binance":ee}`,{headers:{token:this.token}}).then(ae=>ae.json()).then(ae=>{const{code:le,msg:ce,data:he}=ae;le===200||ce==="ok"?re(he):se("查询失败")})})}}const TYPE_MAP={crypto:"cws",stock:"sws",forex:"fws",indices:"iws"},BASE_URL="wss://api.itick.org",Xa=class Xa{constructor(te){Ee(this,"token","");Ee(this,"resolution","1");Ee(this,"socket",null);Ee(this,"type","");Ee(this,"symbol","");Ee(this,"region","");Ee(this,"reconnectMaxTimes",10);Ee(this,"reconnectInterval",5e3);Ee(this,"heartbeatInterval",3e4);Ee(this,"reconnectTimes",0);Ee(this,"heartbeatTimer",null);Ee(this,"onmessage",null);Ee(this,"dataMap",new Map);Ee(this,"lastBar",null);this.token=te}static getInstance(te){return Xa.instance||(Xa.instance=new Xa(te)),Xa.instance}connect(te,ee,ne,re,se){if(this.resolution=re,this.region=ne,this.lastBar=se,this.dataMap.clear(),!["1","5","10","30"].includes(re)){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.close();return}this.symbol===ee&&this.socket&&this.socket.readyState===WebSocket.OPEN||(this.socket&&this.socket.readyState===WebSocket.OPEN&&this.close(),this.socket=new WebSocket(`${BASE_URL}/${TYPE_MAP[te]}`),this.symbol=ee,this.type=te,this.reconnectTimes=0,this.socket.onopen=()=>{console.log("WebSocket 连接成功",ee),this.send({ac:"auth",params:this.token}),this.startHeartbeat()},this.socket.onmessage=le=>{try{const ce=JSON.parse(le.data);this.handleMessage(ce)}catch(ce){console.log("消息解析错误:",ce)}},this.socket.onclose=le=>{le.code!==1e3&&(console.log("WebSocket 连接异常关闭 将尝试重新连接:",le.code),this.reconnect())},this.socket.onerror=le=>{console.error("WebSocket 连接发生错误:",le)})}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{this.socket&&this.socket.readyState===WebSocket.OPEN&&this.send({ac:"ping",params:Date.now()})},this.heartbeatInterval)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=null)}reconnect(){if(this.stopHeartbeat(),this.reconnectTimes++,this.reconnectTimes>this.reconnectMaxTimes)return;const te=setTimeout(()=>{console.log("重新连接中..."),this.connect(this.type,this.symbol,this.region,this.resolution,this.lastBar),clearTimeout(te)},this.reconnectInterval)}handleSymbolName(){return this.symbol}getPreviousNearestFiveOrTenMinutesTimestamp(te,ee){const ne=new Date(te);if(ee==="1")return ne.setSeconds(0,0),ne.getTime();const re=ne.getMinutes(),se=parseInt(ee),ae=Math.floor(re/se)*se,le=new Date(ne);return le.setMinutes(ae),le.setSeconds(0),le.setMilliseconds(0),le.getTime()}handleMessage(te){var se,ae;const{code:ee,data:ne,resAc:re}=te;if(ee===1&&re==="auth"){this.send({ac:"subscribe",params:this.handleSymbolName(),types:"tick"});return}if(ee===1&&ne){const{t:le,ld:ce,v:he}=ne,fe=this.getPreviousNearestFiveOrTenMinutesTimestamp(le,this.resolution),Ae=this.dataMap.get(fe)||(((se=this.lastBar)==null?void 0:se.time)===fe?this.lastBar:void 0);Ae?this.dataMap.set(fe,{time:fe,close:ce,open:Ae.open,high:ce>Ae.high?ce:Ae.high,low:ce<Ae.low?ce:Ae.low,volume:he+Ae.volume}):(this.dataMap.clear(),this.dataMap.set(fe,{time:fe,close:ce,open:ce,high:ce,low:ce,volume:he})),(ae=this.onmessage)==null||ae.call(this,this.dataMap.get(fe))}}send(te){var ee;this.socket&&this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify(te)):console.log("WebSocket 未连接成功， 状态码:",(ee=this.socket)==null?void 0:ee.readyState)}onMessage(te){this.onmessage=te}close(){this.socket&&(this.socket.close(),this.stopHeartbeat())}};Ee(Xa,"instance",null);let SingletonSocket=Xa;class Datafeed{constructor(te){Ee(this,"token","");Ee(this,"symbolInfo",{});Ee(this,"configuration");Ee(this,"request");Ee(this,"lastBar");Ee(this,"subscription",new Map);this.token=te,this.request=new Request(te),this.configuration=this.defaultConfiguration()}onReady(te){setTimeout(()=>{te(this.configuration)},0)}async searchSymbols(te,ee,ne,re){const[se,ae]=ne.split("_"),le={...te?{code:te}:{},...se?{type:se}:{},...ae?{region:ae}:{}},he=(await this.request.getSymbolList(le)).slice(0,50),fe=[];for(const Ae of he)fe.push({symbol:Ae.c,exchange:Ae.e,description:Ae.n,type:Ae.t,ticker:`${Ae.e}:${Ae.c}`});re(fe)}async resolveSymbol(te,ee,ne,re){const[se]=te.split(":");if(this.symbolInfo[te]){const ce=setTimeout(()=>{ee(this.symbolInfo[te]),clearTimeout(ce)},0);return}const ae=await this.request.getSymbolInfo(te);if(re!=null&&re.isCancellationRequested)return;if(!ae){ne("查找不到产品");return}const le={name:ae.n,region:ae.r,timezone:ae.tz,exchange:ae.e,type:ae.t,subsessions:ae.sb,session:ae.sb.find(ce=>ce.id===ae.si).session,minmov:ae.m,subsession_id:ae.si,description:ae.b??ae.d,format:"price",visible_plots_set:"ohlcv",variable_tick_size:"",listed_exchange:se,pricescale:100,full_name:te,pro_name:te,base_name:[te],ticker:te,supported_resolutions:this.configuration.supported_resolutions,has_daily:!0,has_intraday:!0,daily_multipliers:["1"],has_weekly_and_monthly:!0,weekly_multipliers:["1"],monthly_multipliers:["1","12"],intraday_multipliers:["1","5","10","30","60"],data_status:"streaming"};this.symbolInfo[te]=le,ee(le)}async getBars(te,ee,ne,re,se){const{name:ae,type:le,region:ce}=te,{countBack:he,firstDataRequest:fe,to:Ae}=ne;try{const pe={symbolType:le,region:this.getSymbolRegion(le,ce),symbol:ae,et:Ae*1e3,limit:he,resolution:this.getResolution(ee)},Oe=await this.request.getKline(pe);if(se!=null&&se.isCancellationRequested)return;Oe.bars.forEach(Fe=>Fe.time=Fe.time/1e3),fe&&(this.lastBar=Oe.bars[Oe.bars.length-1]),re(Oe.bars,Oe.meta)}catch(pe){if(console.error(pe),se!=null&&se.isCancellationRequested)return;re([],{noData:!0})}}getSymbolRegion(te,ee){return te==="crypto"?"BA":te==="stock"?ee||"":"gb"}getResolution(te){return{1:1,5:2,10:3,30:4,60:5,120:6,240:7,"1D":8,"1W":9,"1M":10}[te]}unsubscribeBars(te){const ee=this.subscription.get(te);ee&&(ee.onMessage(()=>{}),this.subscription.delete(te))}subscribeBars(te,ee,ne,re){const{region:se,type:ae,name:le}=te,ce=SingletonSocket.getInstance(this.token);ce.connect(ae,le,se,ee,this.lastBar),ce.onMessage(he=>{he&&(he.time/=1e3,ne(he))}),this.subscription.set(re,ce)}defaultConfiguration(){return{supported_resolutions:["1","5","10","30","60","1D","1W","1M"],supports_marks:!1,supports_timescale_marks:!1,supports_time:!1,symbols_types:[{name:"全部",value:""},{name:"加密货币",value:"crypto"},{name:"SH股",value:"stock_sh"},{name:"SZ股",value:"stock_sz"},{name:"港股",value:"stock_hk"},{name:"SG股",value:"stock_sg"},{name:"美股",value:"stock_us"},{name:"日股",value:"stock_jp"},{name:"外汇",value:"forex"},{name:"指数",value:"indices"}]}}}let widget=null;const config={container:"#container",interval:"1",symbol:"BINANCE:BTCUSDT",locale:"en",theme:"light",datafeed:new Datafeed("a5ca43babf5e49c4b734bdcb6f51a4a4465d52bd3fbe48e1847ac9259ae290c8"),brokerFactory:ie=>new Broker(ie),brokerConfig:{customUI:{async showOrderDialog(){return await showDialog("Order dialog"),!0},async showCancelOrderDialog(){return await showDialog("Cancel order dialog"),!0},async showClosePositionDialog(){return await showDialog("Close position dialog"),!0},async showPositionDialog(){return await showDialog("Position dialog"),!0}}}};let counter=0;const start=()=>{widget=new Widget(config),counter++,counter>100&&widget.onChartReady(()=>{const ie=["#e39336","#9f63dd","#388def","#cf3673"];[5,10,30,60].forEach((te,ee)=>{widget.activeChart().createStudy("MA",!1,!1,{timePeriod:te},{output:{color:ie[ee],title:ee.toString()}})})})};Reflect.set(window,"start",start);start();Reflect.set(window,"stop",()=>{widget==null||widget.remove(),widget=null});function showDialog(ie){const te=new DeferredPromise,ee=document.createElement("dialog"),ne=document.createElement("p");ne.append(document.createTextNode(ie)),ee.append(ne);const re=document.createElement("p");return re.append(document.createTextNode("对话框由图表使用方实现，由图表调起")),ee.append(re),document.body.append(ee),ee.showModal(),ee.addEventListener("click",()=>{ee.close(),te.complete()}),te.p}const __viteBrowserExternal=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
